"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[10086],{10086:(t,i,s)=>{s.r(i),s.d(i,{execution:()=>n});var e=s(65812);class r{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.weights=[],this.bias=void 0,this.degree=3,this.leraningRate=.02,this.optimizer=void 0,this.degree=t;for(let i=0;i<5;++i){const t=e.variable(e.scalar(2*Math.random()-1));this.weights.push(t)}this.bias=e.variable(e.scalar(2*Math.random()-1)),this.optimizer=e.train.adam(this.leraningRate)}predict1d(t){return t.mul(this.weights[0]).add(this.bias)}predict2d(t){return t.square().mul(this.weights[1]).add(t.mul(this.weights[0])).add(this.bias)}predict3d(t){return t.pow(e.scalar(3)).mul(this.weights[2]).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict4d(t){return t.pow(e.scalar(4)).mul(this.weights[3]).add(t.pow(e.scalar(3)).mul(this.weights[2])).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict5d(t){return t.pow(e.scalar(5)).mul(this.weights[4]).add(t.pow(e.scalar(4)).mul(this.weights[3])).add(t.pow(e.scalar(3)).mul(this.weights[2])).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predictResult(t){return 5===this.degree?this.predict5d(t):4===this.degree?this.predict4d(t):3===this.degree?this.predict3d(t):2===this.degree?this.predict2d(t):(this.degree,this.predict1d(t))}loss(t,i){return t.sub(i).square().mean()}async predict(t){const i=e.tidy((()=>this.predictResult(e.tensor1d(t))));let s=i.dataSync();return i.dispose(),s}train(t,i){e.tidy((()=>{const s=e.tensor1d(t),r=e.tensor1d(i);this.optimizer.minimize((()=>this.loss(this.predictResult(s),r)))}))}}class h{constructor(){this.a=1,this.bias=0}predict(t){const i=[];for(let s=0;s<t.length;++s)i.push(this.predictByNum(t[s]));return i}predictByNum(t){return this.a*t+this.bias}fit(t,i){let s=0,e=0;for(let l=0;l<t.length;++l)s+=t[l],e+=i[l];let r=s/t.length,h=e/t.length,a=0,d=0;for(let l=0;l<t.length;++l)a+=(t[l]-r)*(i[l]-h),d+=(t[l]-r)*(t[l]-r);this.a=a/d,this.bias=h-this.a*r}}class a{constructor(){this.learningRate=.02,this.error=Number.MAX_SAFE_INTEGER,this.weight=1,this.bias=0}predict(t){const i=[];for(let s=0;s<t.length;++s)i.push(this.predictByNum(t[s]));return i}predictByNum(t){return this.weight*t+this.bias}train(t,i){for(let s=0;s<t.length;++s){let e=t[s],r=i[s],h=this.weight*e+this.bias;this.error=r-h,this.weight=this.weight+this.error*e*this.learningRate,this.bias=this.bias+this.error*this.learningRate}}}const d=t=>{let i=[],s=l(t);for(let e of t)i.push((e-s[0])/(s[1]-s[0]));return i},l=t=>{let i=Number.MAX_VALUE,s=Number.MIN_VALUE;for(let e of t)i>e&&(i=e),s<e&&(s=e);return[i,s]},n=async t=>{const i=d([1,3,5]),s=d([10,11.5,12]),e=d([1,3,5]);(new h).fit(i,s);const l=new a;for(let r=0;r<1e4;++r)if(l.train(i,s),r%1e3===0){await l.predict(e)}const n=new r(1);for(let r=0;r<2e3;++r)if(n.train(i,s),r%400===0){await n.predict(e)}await n.predict(e)}}}]);
//# sourceMappingURL=10086.c86db258.chunk.js.map