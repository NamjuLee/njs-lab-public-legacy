{"version":3,"file":"static/js/18278.f0543687.chunk.js","mappings":"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","sources":["njslab/Project/Project_04_Water/P-2-water/lib/MapboxGLWrapper.ts","njslab/Project/Project_04_Water/P-2-water/lib/Canvas.ts","njslab/Project/Project_04_Water/P-2-water/Core/Renderer/index.ts","njslab/Project/Project_04_Water/P-2-water/UI/index.ts","njslab/Project/Project_04_Water/P-2-water/Core/ActiveCommand.ts","njslab/Project/Project_04_Water/P-2-water/Core/Common.ts","njslab/Project/Project_04_Water/P-2-water/Core/Scene.ts","njslab/Project/Project_04_Water/P-2-water/Core/index.ts","njslab/Project/Project_04_Water/P-2-water/Project/Site/Agent/Agent.ts","njslab/Project/Project_04_Water/P-2-water/Project/Site/Agent/BoidContollerWander0.ts","njslab/Project/Project_04_Water/P-2-water/Project/Site/Boundary/index.ts","njslab/Project/Project_04_Water/P-2-water/Project/Site/index.ts","njslab/Project/Project_04_Water/P-2-water/Project/index.ts","njslab/Project/Project_04_Water/P-2-water/Addon/Tracer.ts","njslab/Project/Project_04_Water/P-2-water/Addon/index.ts","njslab/Project/Project_04_Water/P-2-water/index.ts","njslab/Tools/WaterQualityInspector/ChartVizWater/WaterQualityInspector.ts","njslab/Tools/WaterQualityInspector/ChartVizWater/index.ts"],"sourcesContent":["import mapboxgl from \"mapbox-gl\";\r\n\r\nexport class MapboxGLWrapper {\r\n    public map: mapboxgl.Map\r\n    constructor(id: string) {\r\n\r\n        this.initMap(id);\r\n    }\r\n    private initMap(id: string) {\r\n        // https://account.mapbox.com\r\n        mapboxgl.accessToken = 'pk.eyJ1IjoiZGVzaWduanUiLCJhIjoiY2xhNGU0YWo4MDlhYzNwdHBwenVvang4eiJ9.P3sX4l_3KjdPeRRbVS1VVg';\r\n        this.map = new mapboxgl.Map({\r\n            container: id,\r\n            zoom: 15,\r\n            // minZoom: 10,\r\n            center: [-71.093161, 42.358871],\r\n            style: 'mapbox://styles/mapbox/dark-v10' // 'mapbox://styles/mapbox/streets-v11' mapbox://styles/mapbox/dark-v10\r\n        });\r\n        this.map.dragRotate.disable();\r\n\r\n        // https://docs.mapbox.com/mapbox-gl-js/api/events/#mapmouseevent#type\r\n        this.map.on('mousemove', (e) => { this.mouseMove(e); });\r\n        this.map.on('click', (e) => { this.mouseClick(e); });\r\n        this.map.on('mousedown', (e) => { this.mouseDown(e); });\r\n        this.map.on('dblclick', (e) => { this.mouseDClick(e); });\r\n        this.map.on('mouseup', (e) => { this.mouseUp(e); });\r\n\r\n        let div = document.getElementsByClassName('mapboxgl-canvas')[0] as HTMLDivElement;\r\n        div.style.position = 'absolute';\r\n        \r\n        div = document.getElementsByClassName('mapboxgl-control-container')[0] as HTMLDivElement;\r\n        div.style.display = 'none';\r\n    }\r\n    get zoom() {\r\n        return this.map.getZoom();\r\n    }\r\n    set zoom(v : number) {\r\n        this.map.setZoom(v);\r\n    }\r\n    public center = (lng: number = -99.292649, lat: number = 39.043903) => {\r\n        // const v = new mapboxgl.LngLat(lon, lat);\r\n        // console.log(v);\r\n        this.map.setCenter({ lat, lng })\r\n    }\r\n    public toMap = (x: number, y: number) => {\r\n        const p = this.map.unproject({x, y} as any)\r\n        return [p.lng, p.lat];\r\n    }\r\n    public toScreen = (lon: number, lat: number) => {\r\n        const p = this.map.project([lon, lat])\r\n        return [p.x, p.y];\r\n    }\r\n    public mouseDown = (e) => {\r\n        // console.log(this.toScreen(-71.093161, 42.358871))\r\n        // console.log(JSON.stringify(e.point), e.lngLat.wrap())\r\n    }\r\n    public mouseUp = (e) => {\r\n        // console.log(JSON.stringify(e.point), e.lngLat.wrap())\r\n    }\r\n    public mouseMove = (e) => {\r\n        // console.log(JSON.stringify(e.point), e.lngLat.wrap())\r\n    }\r\n    public mouseClick = (e) => {\r\n        // console.log(e)\r\n        \r\n        // console.log(this.toMap(100, 100));\r\n        // console.log(e.point)\r\n        // this.center()\r\n        // this.map.zoomTo(0)\r\n        // console.log(JSON.stringify(e.point), e.lngLat.wrap())\r\n    }\r\n    public mouseDClick = (e) => {\r\n        // console.log(JSON.stringify(e.point), e.lngLat.wrap())\r\n    }\r\n}\r\n\r\n\r\n","import { RendererCanvasDynamicLight } from '.'\r\n\r\nexport class RendererCanvasDynamic extends RendererCanvasDynamicLight {\r\n    public time: number = 0.0;\r\n    public pts: number[][] = [];\r\n    constructor(div: any) {\r\n        super(div);\r\n        this.canvas.id = 'mapboxCustom'\r\n        this.canvas.style.position = 'absolute';\r\n        this.canvas.style.width = '100%';\r\n        this.canvas.style.height = '100%';\r\n        this.canvas.style.pointerEvents = 'none';\r\n\r\n        this.start();\r\n    }\r\n    public mouseDown = (x: number, y: number): void => {\r\n\r\n    }\r\n    public mouseUp = (x: number, y: number): void => {\r\n\r\n    }\r\n    public mouseDrag = (x: number, y: number): void => {\r\n\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D): void {\r\n        \r\n    }\r\n}\r\n","import { WaterHyacinth } from '../..';\r\nimport { MapboxGLWrapper } from '../../lib/MapboxGLWrapper';\r\nimport { RendererCanvasDynamic } from '../../lib/Canvas';\r\n\r\nexport class Renderer {\r\n    public app: WaterHyacinth;\r\n    public map: MapboxGLWrapper;\r\n    public canvasCustom: RendererCanvasDynamic;\r\n\r\n    private originalZoom = 3;\r\n    private originalCenter = [-98.292649, 39.043903];\r\n\r\n    constructor(app: WaterHyacinth) {\r\n        this.app = app;\r\n        app.divHost.style.position = 'relative';\r\n        this.map = new MapboxGLWrapper(app.divHost.id);\r\n        this.map.mouseClick = (e) => this.mouseClick(e);\r\n        // this.map.mouseDClick = this.mouseDClick;\r\n        this.map.mouseDown = (e) => this.mouseDown(e);\r\n        this.map.mouseUp = (e) => this.mouseUp(e);\r\n        this.map.mouseMove = (e) => this.mouseMove(e);\r\n\r\n        this.canvasCustom = new RendererCanvasDynamic(app.divHost)\r\n        this.canvasCustom.render = this.render; \r\n    }\r\n    public init() {\r\n        this.zoomOut();\r\n    }\r\n    public render = (ctx: CanvasRenderingContext2D) => {\r\n        ctx.globalCompositeOperation = 'screen'; // 'lighten';\r\n\r\n        this.app.core.scene.render(ctx);\r\n    }\r\n    public zoomOut() {\r\n        this.map.zoom = this.originalZoom;\r\n        this.map.center(this.originalCenter[0], this.originalCenter[1]);\r\n    }\r\n    private processEventData = (e: any): number[] => {\r\n        const lon = e['lngLat']['lng'];\r\n        const lat = e['lngLat']['lat'];\r\n        const x = e['point']['x'];\r\n        const y = e['point']['y'];\r\n        return [x, y , lon, lat];\r\n    }\r\n    public keyDown(k: KeyboardEvent): void {\r\n        // console.log('key pressed', k);\r\n    }\r\n    public mouseDown(e): void {\r\n        const m = this.processEventData(e);\r\n        this.app.core.activeCommand.mouseDown(m[0], m[1]);\r\n\r\n        this.canvasCustom.forceRender();\r\n    }\r\n    public mouseUp(e): void {\r\n        const m = this.processEventData(e);\r\n        this.app.core.activeCommand.mouseUp(m[0], m[1]);\r\n        // this.app.core.activeCommand.mouseUp(x, y);\r\n    }\r\n    public mouseClick(e): void {\r\n        const m = this.processEventData(e);\r\n        this.app.core.activeCommand.mouseClick(m[0], m[1]);\r\n        // this.app.core.activeCommand.mouseClick(x, y);\r\n    }\r\n    public mouseMove(e): void {\r\n        const m = this.processEventData(e);\r\n        this.app.core.activeCommand.mouseMove(m[0], m[1], m[2], m[3]);\r\n        // this.app.core.activeCommand.mouseMove(x, y);\r\n    }\r\n}\r\n","import { WaterHyacinth } from '..';\r\nexport class UI {\r\n    solution: WaterHyacinth;\r\n\r\n    constructor(solution: WaterHyacinth) {\r\n        this.solution = solution;\r\n\r\n        const style = {\r\n            menuMain: {\r\n                color: '#fff',\r\n                background: 'rgba(173, 216, 230, 0.2)',\r\n                backdropFilter: 'blur(10px)',\r\n            }\r\n        }\r\n\r\n        let container = document.createElement('div');\r\n        container.style.position = 'absolute';\r\n        container.style.width = '200px';\r\n        container.style.height = '100%';\r\n        container.style.padding = '10px';\r\n\r\n        container.style.color = style.menuMain.color;\r\n        container.style.background = style.menuMain.background;\r\n        container.style.backdropFilter = style.menuMain.backdropFilter\r\n        this.solution.divHost.append(container);\r\n\r\n        const divTitle = getDivBtn(container, 'Map');\r\n\r\n        const zoomTo = getDivBtn(container, 'Zoom out');\r\n        zoomTo.onclick = () => {\r\n            this.solution.core.activeCommand.zoomOut()\r\n        }\r\n\r\n        const separate = getDivBtn(container, ' ');\r\n        const Addon = getDivBtn(container, 'Addon');\r\n        const Tracer = getDivBtn(container, 'BoundaryTracer');\r\n        Tracer.onclick = () => {\r\n            this.solution.addon.appendTracer();\r\n        };\r\n        \r\n    }\r\n}\r\n\r\n\r\nconst getDivBtn = (host: HTMLDivElement, title: string) => {\r\n    const div = document.createElement('div')\r\n    host.appendChild(div);\r\n    div.style.borderTop = '5px';\r\n    div.style.margin = '5px';\r\n    div.textContent = title;\r\n    return div;\r\n}","import { Core } from '.';\r\nimport { Site } from '../Project/Site';\r\n\r\nexport class ActiveCommand {\r\n    public core: Core;\r\n    public m = [0, 0, 0, 0];\r\n    constructor(core: Core) {\r\n        this.core = core;\r\n    }\r\n    public mouseDown(x: number, y: number) {\r\n\r\n    }\r\n    public mouseUp(x: number, y: number) {\r\n        \r\n    }\r\n    public mouseDrag(x: number, y: number) {\r\n        \r\n    }\r\n    public mouseMove(x: number, y: number, lon: number, lat: number) {\r\n        this.m[0] = x;\r\n        this.m[1] = y;\r\n        this.m[2] = lon;\r\n        this.m[3] = lat;\r\n        this.core.common.checkHover(x, y);\r\n    }\r\n    public mouseClick(x: number, y: number) {\r\n        if (this.core.app.addon.click(x, y)) {\r\n            return;\r\n        }\r\n\r\n        if(this.core.scene.capture) {\r\n            this.core.scene.capture.click(x,y);\r\n            return;\r\n        }\r\n\r\n        const sites: Site[] = this.core.common.getCloseSite(x, y);\r\n        if (sites.length === 1) {\r\n            this.core.scene.capture = sites[0];\r\n        } else if (sites.length >1) {\r\n            // when you click overlapping points we want to zoom in \r\n            this.core.common.zoom += this.core.common.zoom;\r\n            this.core.common.center(sites[0].properties.lon, sites[0].properties.lat);\r\n        }\r\n        // const mapProjected = this.toMap(x, y);\r\n        // // this.pts.push(mapProjected);\r\n        // if (this.ptsGeoTracing !== undefined) {\r\n        //     this.ptsGeoTracing.push(mapProjected[0], mapProjected[1])\r\n        // }\r\n\r\n        // if (this.app.siteFocused === undefined) {\r\n        //     const selSite = this.app.core.getCloseSite(x, y);\r\n\r\n        //     if (selSite) {\r\n        //         selSite.focus();\r\n        //         this.app.siteFocused = selSite;\r\n        //     }\r\n\r\n        // } else {\r\n        //     this.app.siteFocused.click(x, y);\r\n        // }\r\n    }\r\n    public zoomOut(){\r\n        this.core.app.renderer.zoomOut();\r\n    }\r\n}","import { distanceTo } from '../lib';\r\nimport { Core } from '.';\r\nexport class Common {\r\n    public core: Core;\r\n    constructor(core: Core) {\r\n        this.core = core;\r\n    }\r\n    public getCloseSite(x: number, y: number) {\r\n        const sites = [];\r\n        for (let i = 0; i < this.core.app.project.sites.length; ++i) {\r\n            const site = this.core.app.project.sites[i];\r\n            const dis = distanceTo(site.vec.x, site.vec.y, 0, x, y, 0);\r\n            if (dis < site.r) {\r\n                // console.log(dis, site.r);\r\n                sites.push(site);\r\n            }\r\n        }\r\n        return sites;\r\n    }\r\n    public toScreen = (lon: number, lat: number) => {\r\n        return this.core.app.renderer.map.toScreen(lon, lat);\r\n    }\r\n    public toMap = (x: number, y: number) => {\r\n        return this.core.app.renderer.map.toMap(x, y);\r\n    }\r\n    public get zoom() {\r\n        return this.core.app.renderer.map.zoom\r\n    }\r\n    public set zoom(v) {\r\n        this.core.app.renderer.map.zoom = v;\r\n    }\r\n    public center(lon: number, lat: number) {\r\n        return this.core.app.renderer.map.center(lon, lat);\r\n    }\r\n    public checkHover(x: number, y: number) {\r\n        this.core.app.project.sites.forEach((site) => {\r\n            site.isHover(x, y)\r\n        });\r\n    }\r\n}","\r\nimport { Core } from '.';\r\nimport { Site } from '../Project/Site';\r\nimport { getFalseColor } from 'njscore';\r\n\r\nexport class Scene {\r\n    public core: Core;\r\n    public scene: Scene;\r\n    public colorArray1: number[][] = [];\r\n    public colorArray2: number[][] = [];\r\n\r\n    private _capture: Site | undefined;\r\n\r\n    constructor(core: Core) {\r\n        this.core = core;\r\n    }\r\n    public init() {\r\n       this.colorArray1 = [];\r\n        for (let i = 0; i < 255; ++i) {\r\n            const result = getFalseColor(i / 255);\r\n            this.colorArray1.push(result);\r\n        }\r\n\r\n        this.colorArray2 = [];\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D) {\r\n\r\n        const xOff = ctx.canvas.width - 300;\r\n        const yOff = ctx.canvas.height - 50;\r\n\r\n        const w = 1;\r\n        const h = 10;\r\n        for (let i = 0; i < this.colorArray1.length; ++i) {\r\n            ctx.beginPath();\r\n            ctx.rect(i * w + xOff, yOff, w, h);\r\n            ctx.closePath();\r\n            ctx.fillStyle = `rgba(${this.colorArray1[i][0]}, ${this.colorArray1[i][1]}, ${this.colorArray1[i][2]}, 1)`;\r\n            ctx.fill();\r\n        }\r\n\r\n        // if (this._capture !== undefined) {\r\n        //     this._capture.render(ctx);\r\n        // } else {\r\n        this.core.app.project.sites.forEach((site) => {\r\n            site.renderDot(ctx);\r\n        });\r\n        // }\r\n\r\n        if (this._capture !== undefined) {\r\n            this._capture.render(ctx);\r\n        }\r\n\r\n        this.core.app.addon.render(ctx);\r\n\r\n        ctx.beginPath();\r\n        ctx.font = \"14px Arial\";\r\n        ctx.fillStyle = '#fff';\r\n        const log = `latitude: ${this.core.activeCommand.m[3].toFixed(4)}, longitude: ${this.core.activeCommand.m[2].toFixed(4)}`;\r\n        ctx.fillText(log, ctx.canvas.width * 0.5 - 100, 50);\r\n\r\n        if (this.capture) {\r\n            const logSite = this.capture.getLog();\r\n            ctx.fillText(logSite, ctx.canvas.width * 0.5 - 100, 80);\r\n        }\r\n    }\r\n    public set capture(v: Site | undefined) {\r\n        // console.trace();\r\n        if (this._capture !== undefined) {\r\n            this._capture.isActivated = false;\r\n            this._capture.blur();\r\n        }\r\n\r\n        this._capture = v;\r\n        if (this._capture !== undefined) {\r\n            this._capture.isActivated = true;\r\n            this._capture.focus();\r\n        } \r\n        // console.log(this._capture)\r\n\r\n    }\r\n    public get capture(): Site | undefined {\r\n        return this._capture;\r\n    }\r\n}","\r\nimport { WaterHyacinth } from '..';\r\nimport { ActiveCommand } from './ActiveCommand'\r\nimport { Common } from './Common'\r\nimport { Scene } from './Scene'\r\n// import { ActiveCommand } from '../Core/ActiveCommand'\r\n\r\n\r\nexport class Core {\r\n    public app: WaterHyacinth;\r\n    public activeCommand: ActiveCommand;\r\n    public common: Common;\r\n    public scene: Scene;\r\n\r\n    constructor(app: WaterHyacinth) {\r\n        this.app = app;\r\n        this.activeCommand = new ActiveCommand(this);\r\n        this.common = new Common(this);\r\n        this.scene = new Scene(this);\r\n    }\r\n\r\n}","// import { MathUtility, NVector3 } from '../../../../../../lib/NJSCore';\r\n\r\nimport { Vector3, isInsideOfVecs } from '../../../lib';\r\n// import { Vector3, MathUtility } from '../../../../../lib';\r\nimport { BoidContollerWander0 } from './BoidContollerWander0';\r\nexport class Boid {\r\n\r\n    static list: Boid[] = [];\r\n    BoidContollerWander0: BoidContollerWander0;\r\n    maxForce = 0.0001; // 1; // 5;\r\n    maxVelocity = 0.0001; // 1; // 8;\r\n    maxSpeed = 0.0001; // 1; // 13.0;\r\n    mass = 10;\r\n\r\n    isRenderable = true;\r\n\r\n    p: Vector3;\r\n\r\n    targets: Vector3[];\r\n    target: Vector3;\r\n    targetID = 0;\r\n\r\n    col: boolean = false;\r\n    desiredVelocity: Vector3;\r\n    steering: Vector3;\r\n    velocity: Vector3 = new Vector3(0, 0, 0);\r\n\r\n    // .......................\r\n    wanderAngle: number = 0;\r\n    CIRCLE_DISTANCE = 50;\r\n    CIRCLE_RADIUS = 50;\r\n    ANGLE_CHANGE = 15;\r\n\r\n    t: number = 0.0;\r\n\r\n    MAX_QUEUE_AHEAD = 15;\r\n    MAX_QUEUE_RADIUS = 10;\r\n    trajectory: Vector3[] = [];\r\n    timerTrajectory = 0.0;\r\n\r\n    scaleBounding = 0.0;\r\n    boundary: Vector3[];\r\n\r\n    constructor(BoidContollerWander0: BoidContollerWander0, p: Vector3, boundary: Vector3[]) {\r\n        this.BoidContollerWander0 = BoidContollerWander0;\r\n        Boid.list.push(this);\r\n        this.p = p;\r\n\r\n        if (boundary) {\r\n            this.boundary = boundary;\r\n        }\r\n        this.UpdateTarget();\r\n    }\r\n    public Update() {\r\n        // this.UpdateVec0();\r\n        this.UpdateVec1();\r\n        // this.UpdateVecSlowDown1();\r\n        // this.UpdateVecSlowDown2();\r\n\r\n    }\r\n    public UpdateTarget() {\r\n        \r\n\r\n            this.target = this.BoidContollerWander0.site.boundary.getRandomSpot();\r\n    }\r\n    public UpdateVec1() {\r\n        this.desiredVelocity = new Vector3(this.target.x - this.p.x, this.target.y - this.p.y, this.target.z - this.p.z);\r\n        this.desiredVelocity.unitize();\r\n        this.desiredVelocity.x *= this.maxVelocity;\r\n        this.desiredVelocity.y *= this.maxVelocity;\r\n        this.desiredVelocity.z *= this.maxVelocity;\r\n\r\n        let x = (this.desiredVelocity.x - this.velocity.x) < this.maxForce ? this.desiredVelocity.x - this.velocity.x : this.maxForce;\r\n        let y = (this.desiredVelocity.y - this.velocity.y) < this.maxForce ? this.desiredVelocity.y - this.velocity.y : this.maxForce;\r\n        let z = (this.desiredVelocity.z - this.velocity.z) < this.maxForce ? this.desiredVelocity.z - this.velocity.z : this.maxForce;\r\n\r\n        this.steering = new Vector3(x / this.mass, y / this.mass, z / this.mass);\r\n\r\n        this.velocity.x = (this.velocity.x + this.steering.x) < this.maxSpeed ? this.velocity.x + this.steering.x : this.maxSpeed;\r\n        this.velocity.y = (this.velocity.y + this.steering.y) < this.maxSpeed ? this.velocity.y + this.steering.y : this.maxSpeed;\r\n        this.velocity.z = (this.velocity.z + this.steering.z) < this.maxSpeed ? this.velocity.z + this.steering.z : this.maxSpeed;\r\n\r\n        this.Queue();\r\n\r\n        this.p.x += this.velocity.x;\r\n        this.p.y += this.velocity.y;\r\n        this.p.z += this.velocity.z;\r\n        this.t += 0.01;\r\n        if (this.t > 3) {\r\n            this.t = 0.0;\r\n            this.UpdateTarget();\r\n        }\r\n    }\r\n    public UpdateVec0() {\r\n        // this.desiredVelocity = new Vector3(this.target.x - this.p.x, this.target.y - this.p.y, this.target.z - this.p.z);\r\n        // this.desiredVelocity.Unitize();\r\n        // this.desiredVelocity.x *= this.maxVelocity;\r\n        // this.desiredVelocity.y *= this.maxVelocity;\r\n        // this.desiredVelocity.z *= this.maxVelocity;\r\n\r\n        // let x = (this.desiredVelocity.x - this.velocity.x) < this.maxForce ? this.desiredVelocity.x - this.velocity.x : this.maxForce;\r\n        // let y = (this.desiredVelocity.y - this.velocity.y) < this.maxForce ? this.desiredVelocity.y - this.velocity.y : this.maxForce;\r\n        // let z = (this.desiredVelocity.z - this.velocity.z) < this.maxForce ? this.desiredVelocity.z - this.velocity.z : this.maxForce;\r\n\r\n        // this.steering = ;\r\n\r\n        this.steering = this.Wander(new Vector3(this.velocity.x, this.velocity.y, this.velocity.z));\r\n\r\n        this.steering.x = this.steering.x < this.maxForce ? this.steering.x : this.maxForce;\r\n        this.steering.y = this.steering.y < this.maxForce ? this.steering.y : this.maxForce;\r\n        this.steering.z = this.steering.z < this.maxForce ? this.steering.z : this.maxForce;\r\n\r\n        this.steering.x /= this.mass;\r\n        this.steering.y /= this.mass;\r\n        this.steering.z /= this.mass;\r\n\r\n        if (this.velocity.x + this.steering.x < this.maxSpeed) {\r\n            this.velocity.x = this.velocity.x + this.steering.x;\r\n        } else {\r\n            this.velocity.x = this.maxSpeed;\r\n        }\r\n        if (this.velocity.y + this.steering.y < this.maxSpeed) {\r\n            this.velocity.y = this.velocity.y + this.steering.y;\r\n        } else {\r\n            this.velocity.y = this.maxSpeed;\r\n        }\r\n        if (this.velocity.z + this.steering.z < this.maxSpeed) {\r\n            this.velocity.z = this.velocity.z + this.steering.z;\r\n        } else {\r\n            this.velocity.z = this.maxSpeed;\r\n        }\r\n        // this.velocity.x = this.velocity.x + this.steering.x < this.maxSpeed ? this.velocity.x + this.steering.x : this.maxSpeed;\r\n        // this.velocity.y = this.velocity.y + this.steering.y < this.maxSpeed ? this.velocity.y + this.steering.y : this.maxSpeed;\r\n        // this.velocity.z = this.velocity.z + this.steering.z < this.maxSpeed ? this.velocity.z + this.steering.z : this.maxSpeed;\r\n\r\n        // steering = wander()\r\n        // steering = truncate (steering, max_force)\r\n        // steering = steering / mass\r\n        // velocity = truncate (velocity + steering , max_speed)\r\n        // position = position + velocity\r\n        this.Queue();\r\n\r\n        // console.log(this.maxSpeed);\r\n\r\n        this.p.x += this.velocity.x;\r\n        this.p.y += this.velocity.y;\r\n        this.p.z += this.velocity.z;\r\n\r\n    }\r\n    public Wander(velocity: Vector3) {\r\n        // Calculate the circle center\r\n        let circleCenter = new Vector3(velocity.x, velocity.y, velocity.z);\r\n        circleCenter.normalize();\r\n        circleCenter.scale(this.CIRCLE_DISTANCE);\r\n        //\r\n        // Calculate the displacement force\r\n        let displacement = new Vector3(0, -1);\r\n        displacement.scale(this.CIRCLE_RADIUS);\r\n        //\r\n        // Randomly change the vector direction\r\n        // by making it change its current angle\r\n        displacement = this.setAngle(displacement, this.wanderAngle);\r\n        //\r\n        // Change wanderAngle just a bit, so it\r\n        // won't have the same value in the\r\n        // next game frame.\r\n        this.wanderAngle += Math.random() * this.ANGLE_CHANGE - this.ANGLE_CHANGE * .5;\r\n        //\r\n        // Finally calculate and return the wander force\r\n        var wanderForce: Vector3;\r\n        wanderForce = circleCenter.add(displacement);\r\n        return wanderForce;\r\n    }\r\n    public setAngle(v: Vector3, value: number) {\r\n        let len: number = v.length();\r\n        v.x = Math.cos(value) * len;\r\n        v.y = Math.sin(value) * len;\r\n        return v;\r\n    }\r\n    public GetNeighborAhead() {\r\n        // var i:int;\r\n        var ret: Boid | undefined = undefined;\r\n        var qa: Vector3 = this.velocity.clone();\r\n\r\n        qa.normalize();\r\n        qa.scale(this.MAX_QUEUE_AHEAD);\r\n\r\n        let ahead = this.p.clone().add(qa);\r\n\r\n        for (let i = 0; i < Boid.list.length; i++) {\r\n            let neighbor: Boid = Boid.list[i];\r\n            let d = Vector3.distanceTo(ahead, neighbor.p);\r\n            if (neighbor !== this && d <= this.MAX_QUEUE_RADIUS) {\r\n                ret = neighbor;\r\n                break;\r\n            }\r\n        }\r\n\r\n        return ret;\r\n    }\r\n    public Queue() {\r\n        var neighbor = this.GetNeighborAhead();\r\n\r\n        if (neighbor !== undefined) {\r\n            this.velocity.scale(0.3);\r\n        }\r\n\r\n        return new Vector3(0, 0);\r\n    }\r\n\r\n    // .......................................................................................................................\r\n    public Render(ctx: CanvasRenderingContext2D) {\r\n        // this.RenderDesiredVelocity(ctx);\r\n        // this.RenderCurrentVelocity(ctx);\r\n        this.RenderCircle(ctx);\r\n    }\r\n    public RenderDesiredVelocity(ctx: CanvasRenderingContext2D) {\r\n        // let scale = 20;\r\n        // ctx.lineWidth = 0.5;\r\n        // ctx.strokeStyle = '#00ff00';\r\n        // ctx.beginPath();\r\n        // ctx.moveTo(this.p.x, this.p.y);\r\n        // ctx.lineTo(this.p.x + this.desiredVelocity.x * scale, this.p.y + this.desiredVelocity.y * scale);\r\n        // ctx.closePath();\r\n        // ctx.stroke();\r\n    }\r\n    public RenderCurrentVelocity(ctx: CanvasRenderingContext2D) {\r\n        // let scale = 20;\r\n        // ctx.lineWidth = 0.5;\r\n        // ctx.strokeStyle = '#ff0000';\r\n        // ctx.beginPath();\r\n        // ctx.moveTo(this.p.x, this.p.y);\r\n        // ctx.lineTo(this.p.x + this.velocity.x * scale, this.p.y + this.velocity.y * scale);\r\n        // ctx.closePath();\r\n        // ctx.stroke();\r\n    }\r\n    public RenderCircle(ctx: CanvasRenderingContext2D) {\r\n        // console.log(this.p)\r\n\r\n        const vec = this.BoidContollerWander0.site.project.app.core.common.toScreen(this.p.x, this.p.y);\r\n        // console.log(vec)\r\n\r\n        this.t += 0.05\r\n        this.timerTrajectory += 1;\r\n        if (this.timerTrajectory % 5 === 0) {\r\n            if (this.trajectory.length > 30) {\r\n                this.trajectory.shift();\r\n            }\r\n            this.trajectory.push(new Vector3(this.p.x, this.p.y));\r\n\r\n            this.timerTrajectory = 0;\r\n        }\r\n        for (let i = 0; i < this.trajectory.length; ++i) {\r\n            ctx.fillStyle = 'rgba(100, 100, 100 ,0.1)';\r\n            ctx.beginPath();\r\n            ctx.arc(this.trajectory[i].x, this.trajectory[i].y, (i) * 0.2, 0, 3.14 * 2);\r\n            ctx.closePath();\r\n            ctx.fill();\r\n        }\r\n\r\n        ctx.strokeStyle = '#000000';\r\n        ctx.lineWidth = 0.5;\r\n        // ctx.beginPath();\r\n        // ctx.moveTo(this.targets[0].x , this.targets[0].y);\r\n        // for (let i = 1 ; i < this.targets.length; ++i) {\r\n        //   ctx.lineTo(this.targets[i].x , this.targets[i].y);\r\n        // }\r\n        // ctx.closePath();\r\n        // ctx.stroke();\r\n\r\n        // const target = this.BoidContollerWander0.site.project.app.core.common.toScreen(this.target.x, this.target.y);\r\n\r\n        // ctx.beginPath();\r\n        // ctx.moveTo(vec[0], vec[1]);\r\n        // ctx.lineTo(target[0], target[1]);\r\n        // ctx.stroke();\r\n  \r\n        // ctx.fillStyle = '#000000';\r\n        // ctx.beginPath();\r\n        // ctx.arc(this.target.x, this.target.y, 2.5, 0, 3.14 * 2);\r\n        // ctx.closePath();\r\n        // ctx.fill();\r\n\r\n\r\n\r\n        ctx.fillStyle = '#000000';\r\n        ctx.beginPath();\r\n        ctx.arc(this.target.x, this.target.y, 2.5, 0, 3.14 * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n\r\n\r\n        ctx.fillStyle = '#fff';\r\n        ctx.beginPath();\r\n        ctx.arc(vec[0], vec[1], 2.5, 0, 3.14 * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        ctx.beginPath();\r\n        ctx.arc(vec[0], vec[1], 10 + Math.sin(this.t) * 5, 0, 3.14 * 2);\r\n        ctx.closePath();\r\n        // ctx.fill();\r\n        ctx.stroke();\r\n\r\n        // animation\r\n        ctx.lineWidth = 0.5;\r\n        ctx.strokeStyle = `rgba(${255}, ${255}, ${0}, ${1 - this.scaleBounding * 0.07})`;\r\n        ctx.fillStyle = `rgba(${255}, ${255}, ${0}, ${1 - this.scaleBounding * 0.07})`;\r\n        ctx.beginPath();\r\n        ctx.arc(vec[0], vec[1], this.scaleBounding, 0, 3.14 * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        ctx.stroke();\r\n        this.scaleBounding += 0.2;\r\n        if (1 - this.scaleBounding * 0.07 < 0) {\r\n            this.scaleBounding = 0;\r\n        }\r\n\r\n\r\n    }\r\n}\r\n","// import { MathUtility, NVector3 } from '../../../../../../lib/NJSCore';\r\n\r\nimport { Vector3, isInsideOfVecs } from '../../../lib';\r\n// import { Vector3, MathUtility } from '../../../../../lib';\r\nimport { Boid } from './Agent';\r\nimport { Site } from '..';\r\n\r\nexport class BoidContollerWander0 {\r\n  site: Site;\r\n  boids: Boid[] = [];\r\n\r\n  vsBoundary: Vector3[];\r\n\r\n  constructor(site: Site) {\r\n    this.site = site;\r\n    this.boids = [];\r\n    this.vsBoundary = site.boundary.vsBoundary;\r\n\r\n  }\r\n  public AddAgent(x: number, y: number) {\r\n    const geoPos = this.site.project.app.core.common.toMap(x, y);\r\n    console.log(geoPos)\r\n    let boid = new Boid(this, new Vector3(geoPos[0], geoPos[1]), this.vsBoundary);\r\n    this.boids.push(boid);\r\n  }\r\n  public Update() {\r\n    for (let b of this.boids) {\r\n      b.Update();\r\n    }\r\n\r\n  }\r\n  public GetPoint() {\r\n    let pts: Vector3[] = [];\r\n    for (let b of this.boids) {\r\n      if (b.isRenderable) {\r\n        pts.push(b.p);\r\n      }\r\n    }\r\n    return pts;\r\n  }\r\n\r\n  // .......................................................................................................................\r\n\r\n  public Render(ctx: CanvasRenderingContext2D) {\r\n    // console.log(this.boids)\r\n    // this.boids.forEach((b) => { b.Render(ctx); });\r\n\r\n\r\n\r\n    // ctx.beginPath()\r\n    // ctx.moveTo(this.vsBoundary[0].x, this.vsBoundary[0].y)\r\n    // for (let i = 1; i < this.vsBoundary.length; ++i) {\r\n    //   ctx.lineTo(this.vsBoundary[i].x, this.vsBoundary[i].y)\r\n    // }\r\n    // ctx.stroke();\r\n  }\r\n}\r\n\r\n","\r\nimport { remap, Vector3, isInsideOfVecs, distanceTo, RendererCanvas } from '../../../lib';\r\n// import { MathUtility, NVector3 } from '../../../../../lib/NJSCore';\r\n\r\nimport { ChartVizWater } from '../../../../../../Tools/WaterQualityInspector/ChartVizWater';\r\n\r\nimport { Site } from '..'\r\n\r\n\r\nexport class Boundary {\r\n    site: Site;\r\n    lon: number;\r\n    lat: number;\r\n\r\n    vsBoundary: Vector3[] = [];\r\n\r\n    pMin: Vector3 = new Vector3(180, 90, 0);\r\n    pMax: Vector3 = new Vector3(-180, -90, 0);\r\n    pCenter: Vector3 = new Vector3(0, 0, 0);\r\n\r\n    ctxTemp: CanvasRenderingContext2D;\r\n\r\n    selID: number[] = [];\r\n    selVal: number = 0;\r\n    selInside: boolean = false;\r\n\r\n    divViz: HTMLDivElement[] | undefined = undefined;\r\n    chartVizWaters: ChartVizWater[] = [];\r\n\r\n    constructor(site: Site, boundary: number[]) {\r\n        this.site = site;\r\n\r\n        for (let i = 0; i < boundary.length; i += 2) {\r\n\r\n            this.pCenter.x += boundary[i];\r\n            this.pCenter.y += boundary[i + 1];\r\n\r\n            if (boundary[i] < this.pMin.x) { this.pMin.x = boundary[i]; }\r\n            if (boundary[i + 1] < this.pMin.y) { this.pMin.y = boundary[i + 1]; }\r\n\r\n            if (boundary[i] > this.pMax.x) { this.pMax.x = boundary[i]; }\r\n            if (boundary[i + 1] > this.pMax.y) { this.pMax.y = boundary[i + 1]; }\r\n\r\n            this.vsBoundary.push(new Vector3(boundary[i], boundary[i + 1], 0))\r\n        }\r\n\r\n        this.pCenter.x /= boundary.length * 0.2\r\n        this.pCenter.y /= boundary.length * 0.2\r\n\r\n        const img = new Image(); // Create new img element\r\n        img.src = process.env.PUBLIC_URL + '/static/data/Watabot/freshPond.jpg';\r\n        img.crossOrigin = \"Anonymous\";\r\n        img.onload = () => {\r\n            const xNum = 50;\r\n            const yNum = 50;\r\n\r\n            const width = img.width;\r\n            const height = img.height;\r\n            const zScale = 5.5;\r\n\r\n            const xInterval = width / (xNum - 1.0);\r\n            const yInterval = height / (yNum - 1.0);\r\n\r\n            const canvas = document.createElement('canvas');\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n            // this.hostDiv.append(canvas);\r\n            const ctx = canvas.getContext('2d', { willReadFrequently: true });\r\n\r\n            ctx.drawImage(img, 0, 0);\r\n            this.ctxTemp = ctx;\r\n\r\n            // console.log('done loading image');\r\n            // const vertices = [];\r\n            // for (let y = 0; y < yNum; ++y) {\r\n            //     for (let x = 0; x < xNum; ++x) {\r\n            //         let col = ctx.getImageData(x * xInterval, y * yInterval, 1, 1).data;\r\n            //         let zVal = RGBtoGray(col[0] / 255, col[1] / 255, col[2] / 255);\r\n            //         let z = -zVal * zScale;\r\n            //         vertices.push(x - (xNum * 0.5), y - (yNum * 0.5), z);\r\n            //     }\r\n            // }\r\n        }\r\n\r\n    }\r\n    public getRandomSpot() {\r\n        let x = remap(Math.random(), 0, 1, this.pMin.x, this.pMax.x);\r\n        let y = remap(Math.random(), 0, 1, this.pMin.y, this.pMax.y);\r\n        let vec = new Vector3(x, y);\r\n        let i = 0\r\n        while (!isInsideOfVecs(vec, this.vsBoundary)) {\r\n            vec.x = remap(Math.random(), 0, 1, this.pMin.x, this.pMax.x);\r\n            vec.y = remap(Math.random(), 0, 1, this.pMin.y, this.pMax.y);\r\n            if (i++ > 1000) {\r\n                break\r\n            }\r\n        }\r\n        // console.trace();\r\n        return vec;\r\n    }\r\n    public click(x: number, y: number) {\r\n        // if (this.selInside) {\r\n        // console.log(this.selID);\r\n\r\n        if (this.divViz === undefined) {\r\n            // console.log('dd');\r\n            this.appendViz();\r\n        }\r\n        // }\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D) {\r\n        if (this.vsBoundary.length < 1) {\r\n\r\n            let col = '#ff0000'\r\n            if (this.site.properties.probability < 0.3) {\r\n                col = '#00ff00'\r\n            }\r\n\r\n            ctx.fillStyle = col;\r\n            ctx.beginPath();\r\n            ctx.arc(this.site.vec.x, this.site.vec.y, 10, 0, Math.PI * 2);\r\n            ctx.closePath();\r\n            ctx.fill();\r\n\r\n        } else {\r\n            let pos = this.site.project.app.core.common.toScreen(this.vsBoundary[0].x, this.vsBoundary[0].y)\r\n            ctx.moveTo(pos[0], pos[1])\r\n            for (let i = 1; i < this.vsBoundary.length; i += 1) {\r\n                pos = this.site.project.app.core.common.toScreen(this.vsBoundary[i].x, this.vsBoundary[i].y)\r\n                ctx.lineTo(pos[0], pos[1])\r\n            }\r\n            ctx.lineWidth = 2;\r\n            ctx.strokeStyle = '#000000';\r\n            ctx.stroke();\r\n        }\r\n\r\n        const res = 20\r\n        const intervalX = (this.pMax.x - this.pMin.x) / (res - 1);\r\n        const intervalY = (this.pMax.y - this.pMin.y) / (res - 1);\r\n\r\n        const interXImage = this.ctxTemp.canvas.width / (res - 1);\r\n        const interYImage = this.ctxTemp.canvas.height / (res - 1);\r\n\r\n        let minDis = Number.MAX_SAFE_INTEGER;\r\n        let id = [0, 0];\r\n        for (let i = 0; i < res; ++i) {\r\n            const x = this.pMin.x + intervalX * i\r\n            for (let j = 0; j < res; ++j) {\r\n                const y = this.pMin.y + intervalY * j\r\n\r\n                if (isInsideOfVecs(new Vector3(x, y), this.vsBoundary)) {\r\n                    const sp = this.site.project.app.core.common.toScreen(x, y)\r\n                    // console.log(sp);\r\n\r\n                    let col = this.ctxTemp.getImageData(i * interXImage, j * interYImage, 1, 1).data;\r\n                    // console.log(col);\r\n\r\n                    ctx.strokeStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, 1)`;\r\n                    ctx.beginPath();\r\n                    ctx.arc(sp[0], sp[1], 10, 0, Math.PI * 2.);\r\n                    ctx.stroke();\r\n\r\n                    let dis = distanceTo(this.site.project.app.core.activeCommand.m[0], this.site.project.app.core.activeCommand.m[1], 0, sp[0], sp[1], 0);\r\n                    if (dis < minDis) {\r\n                        minDis = dis;\r\n                        id = [i, j];\r\n                        this.selVal = col[0] / 255;\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n        // console.log(minDis);\r\n        if (minDis < 10) {\r\n            this.selInside = true;\r\n            this.site.project.updatePopup(this.site.project.app.core.activeCommand.m[0], this.site.project.app.core.activeCommand.m[1]);\r\n        } else {\r\n            this.selInside = false;\r\n        }\r\n        this.site.project.setHidePopup(this.selInside);\r\n\r\n        if (this.selInside) {\r\n            this.selID = id;\r\n            let col = this.ctxTemp.getImageData(id[0] * interXImage, id[1] * interYImage, 1, 1).data;\r\n            ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, 1)`;\r\n\r\n            let xHover = this.pMin.x + intervalX * id[0];\r\n            let yHover = this.pMin.y + intervalY * id[1];\r\n            const sp = this.site.project.app.core.common.toScreen(xHover, yHover);\r\n            ctx.strokeStyle = `rgba(255, 255,255, 1)`;\r\n            ctx.beginPath();\r\n            ctx.arc(sp[0], sp[1], 10, 0, Math.PI * 2.);\r\n            ctx.fill();\r\n        }\r\n    }\r\n    public appendViz() {\r\n        this.chartVizWaters = [];\r\n        this.divViz = [];\r\n        const width = 300;\r\n\r\n        for (let i = 0; i < 5; ++i) {\r\n            const div = document.createElement('div');\r\n            div.style.width = `${width}px`;\r\n            div.style.height = '150px';\r\n            div.style.margin = '15px';\r\n            // div.style.background = 'rgba(255, 255, 255, 1.0)';\r\n            div.style.position = 'absolute';\r\n            // div.style.top = '200px';\r\n            div.style.left = `${200 + ((width + 10) * i)}px`;\r\n            this.divViz.push(div);\r\n            this.site.project.app.divHost.appendChild(div);\r\n            this.chartVizWaters.push(new ChartVizWater(div, i));\r\n        }\r\n    }\r\n    public destroy() {\r\n        // console.log('destroy');\r\n        for (let i = 0; i < this.chartVizWaters.length; ++i) {\r\n            this.chartVizWaters[i].destroy();\r\n            // this.chartVizWaters[i] = undefined;\r\n        }\r\n\r\n        for (let i = 0; i < this.divViz.length; ++i) {\r\n            this.divViz[i].parentElement.removeChild(this.divViz[i]);\r\n            // this.divViz[i] = undefined;\r\n        }\r\n        this.divViz = undefined;\r\n    }\r\n}\r\n\r\n// export class VizWater {\r\n//     waterQualityInspector: Solution;\r\n//     constructor(div: any) {\r\n\r\n//         // div.style.position = 'relative';\r\n//         // div.style.width = '100%';\r\n//         // div.style.height = '100%';\r\n//         // div.style.background = '#fff';\r\n\r\n//         // TODO\r\n//         // You code goes here for one time operation\r\n//         //\r\n\r\n//         // this.canvas.onwheel = (e) => {\r\n//         //     // console.log(e.deltaY);\r\n//         //     this.waterQualityInspector.wheel(e);\r\n//         // }\r\n\r\n\r\n//         this.waterQualityInspector = new Solution(div);\r\n\r\n//         // this.start();\r\n//     }\r\n\r\n//     public render(ctx: CanvasRenderingContext2D): void {\r\n//         // ctx.beginPath();\r\n//         // ctx.arc(0, 0, 10, 0, Math.PI * 2);\r\n//         // ctx.closePath();\r\n//         // ctx.fill();\r\n\r\n//         // this.waterQualityInspector.render(this.ctx);\r\n//     }\r\n// }","import { Project } from '..';\r\nimport { distanceTo, Vector3, isInsideOfVecs, remap, renderPoint } from '../../lib';\r\nimport { BoidContollerWander0 } from './Agent/BoidContollerWander0';\r\n// import { MathUtility, NVector3 } from '../../../../../lib/NJSCore';\r\n\r\nimport { Boundary } from './Boundary';\r\n\r\nclass Properties {\r\n    probability: number = 0.0;\r\n    lon: number;\r\n    lat: number;\r\n    zoom: number;\r\n    name: string;\r\n}\r\n\r\nexport class Site {\r\n    project: Project;\r\n\r\n    properties: Properties;\r\n\r\n    vec: Vector3 = new Vector3(0, 0, 0);\r\n    r: number = 15;\r\n\r\n    boundary: Boundary;\r\n    // boundary: Vector3[] = [];\r\n\r\n    pMin: Vector3 = new Vector3(180, 90, 0);\r\n    pMax: Vector3 = new Vector3(-180, -90, 0);\r\n\r\n    BoidContollerWander0: BoidContollerWander0;\r\n    needAgent = false;\r\n\r\n    isActivated = false;\r\n\r\n    hover: boolean = false;\r\n\r\n    constructor(solution: Project, properties) {\r\n        this.project = solution;\r\n\r\n        this.properties = new Properties();\r\n        this.properties.lon = properties.loc[0];\r\n        this.properties.lat = properties.loc[1];\r\n        this.properties.zoom = properties.zoom;\r\n        this.properties.name = properties.name;\r\n        this.properties.probability = properties.probability;\r\n\r\n        this.r = 15;\r\n\r\n        this.boundary = new Boundary(this, properties.boundary);\r\n    }\r\n    public initAgent() {\r\n        this.BoidContollerWander0 = new BoidContollerWander0(this)\r\n        this.needAgent = true;\r\n    }\r\n    public focus() {\r\n        this.project.app.core.common.center(this.properties.lon, this.properties.lat);\r\n        this.project.app.core.common.zoom = this.properties.zoom;\r\n    }\r\n    public blur() {\r\n        this.destroy();\r\n    }\r\n    public getLog() {\r\n        return `${this.properties.name}, id: ${this.boundary.selID}, probability: ${this.boundary.selVal.toFixed(2)}`\r\n    }\r\n    public click(x: number, y: number) {\r\n        // console.log(x, y);\r\n\r\n        if (this.BoidContollerWander0 === undefined) {\r\n            this.initAgent();\r\n            this.BoidContollerWander0.AddAgent(this.vec.x, this.vec.y)\r\n        }\r\n\r\n        this.boundary.click(x, y);\r\n\r\n        // const dis = distanceTo(x, y, 0, this.sx, this.sy, 0);\r\n        // if (dis < this.r) {\r\n        //     this.isActivate = true;\r\n        //     this.focus();\r\n        // this.initAgent();\r\n        // } else {\r\n        //     this.isActivate = false;\r\n        // }\r\n\r\n\r\n        // if(!this.isActivate) { return; }\r\n\r\n\r\n        // console.log(dis, this.r)\r\n\r\n        if (this.BoidContollerWander0 && this.needAgent) {\r\n            // let pos = this.project.app.core.common.toMap(x, y)\r\n            // console.log(pos)\r\n            this.BoidContollerWander0.AddAgent(x, y)\r\n        }\r\n\r\n        // console.log(this.getRandomSpot())\r\n    }\r\n    public isHover(x: number, y: number) {\r\n        if (distanceTo(x, y, 0, this.vec.x, this.vec.y, 0) < this.r) {\r\n            this.hover = true;\r\n        } else {\r\n            this.hover = false;\r\n        }\r\n    }\r\n    public renderDot(ctx: CanvasRenderingContext2D) {\r\n        let pos = this.project.app.core.common.toScreen(this.properties.lon, this.properties.lat);\r\n        this.vec.x = pos[0];\r\n        this.vec.y = pos[1];\r\n\r\n        if (this.project.app.core.common.zoom < this.properties.zoom - 2) {\r\n            let col = '#ff0000'\r\n            if (this.properties.probability < 0.3) {\r\n                col = '#00ff00'\r\n            }\r\n\r\n            let t = 1;\r\n            ctx.fillStyle = col;\r\n            ctx.beginPath();\r\n            ctx.arc(this.vec.x, this.vec.y, (Math.sin(t * 0.8) + 4) * 2, 0, Math.PI * 2);\r\n            ctx.closePath();\r\n            ctx.fill();\r\n\r\n            if (this.hover) {\r\n                ctx.lineWidth = 3\r\n                ctx.strokeStyle = '#ffffff';\r\n                ctx.stroke();\r\n            }\r\n\r\n            if (this.hover) {\r\n                ctx.beginPath();\r\n                ctx.font = \"12px Arial\";\r\n                ctx.fillText(this.properties.name, this.vec.x + 15, this.vec.y);\r\n            }\r\n\r\n        }\r\n\r\n\r\n        if (this.project.app.core.common.zoom < this.properties.zoom - 2) {\r\n            if (this.project.app.core.scene.capture === this) {\r\n                this.project.app.core.scene.capture = undefined;\r\n            }\r\n        }\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D) {\r\n        // console.log(this.isActivated)\r\n        if (!this.isActivated) { return; }\r\n        // if (this.project.app.core.common.zoom < this.properties.zoom - 2) {\r\n        //     let col = '#ff0000'\r\n        //     if (this.properties.probability < 0.3) {\r\n        //         col = '#00ff00'\r\n        //     }\r\n\r\n        //     let t = 1;\r\n        //     ctx.fillStyle = col;\r\n        //     ctx.beginPath();\r\n        //     ctx.arc(this.vec.x, this.vec.y, (Math.sin(t * 0.8) + 4) * 2, 0, Math.PI * 2);\r\n        //     ctx.closePath();\r\n        //     ctx.fill();\r\n\r\n        //     if (this.hover) {\r\n        //         ctx.lineWidth = 3\r\n        //         ctx.strokeStyle = '#ffffff';\r\n        //         ctx.stroke();\r\n        //     }\r\n\r\n        //     if (this.project.app.core.scene.capture === this){\r\n        //         this.project.app.core.scene.capture = undefined;\r\n        //     }\r\n\r\n        // }\r\n\r\n        // console.log(this.project.app.core.common.getZoomLevel())\r\n\r\n        // if(!this.isActivate) { return; }\r\n\r\n        // if (this.needAgent === false) {\r\n        //     this.initAgent();\r\n        // }\r\n\r\n        if (this.project.app.core.common.zoom >= this.properties.zoom - 2) {\r\n           this.boundary.render(ctx);\r\n\r\n        }\r\n        // console.log(this.BoidContollerWander0)\r\n        if (this.BoidContollerWander0) {\r\n            this.BoidContollerWander0.Update();\r\n            this.BoidContollerWander0.Render(ctx);\r\n        }\r\n    }\r\n    public destroy() {\r\n        this.boundary.destroy();\r\n    }\r\n}","import { WaterHyacinth  } from '..';\r\nimport { Site } from './Site';\r\n\r\nexport class Project {\r\n    public rawSiteData: any\r\n    public app: WaterHyacinth;\r\n    public sites: Site[] = [];\r\n\r\n    public divPopup: HTMLDivElement;\r\n    public divText: HTMLDivElement;\r\n    public divTextProb: HTMLDivElement;\r\n\r\n    private _popup: boolean = false;\r\n\r\n    constructor(app: WaterHyacinth, siteData: any) {\r\n        this.app = app;\r\n        this.initSite(siteData);\r\n    }\r\n    public initSite(siteData: any) {\r\n        this.rawSiteData = siteData;\r\n        for (let i = 0; i < siteData.length; ++i) {\r\n            const siteObj = new Site(this, siteData[i]);\r\n            this.sites.push(siteObj);\r\n        }\r\n\r\n        this.divPopup = document.createElement('div');\r\n        this.divPopup.style.width = '220px';\r\n        this.divPopup.style.height = '70px';\r\n        this.divPopup.style.zIndex = '1';\r\n        this.divPopup.style.position = 'absolute';\r\n        this.divPopup.style.pointerEvents = 'none';\r\n        this.divPopup.style.borderRadius = '10px';\r\n        this.divPopup.style.display = 'none';\r\n        // this.divPopup.style.margin = '10px';\r\n        this.divPopup.style.padding = '10px';\r\n        this.divPopup.style.background = '#fff';\r\n        this.app.divHost.appendChild(this.divPopup);\r\n\r\n        this.divText = document.createElement('div');\r\n        this.divText.style.fontWeight = '500';\r\n        this.divText.style.color = '#000';\r\n        this.divText.textContent = 'Probability of algae bloom';\r\n        this.divPopup.appendChild(this.divText);\r\n\r\n        this.divTextProb = document.createElement('div');\r\n        this.divTextProb.style.fontWeight = '500';\r\n        this.divTextProb.style.color = '#000';\r\n        this.divTextProb.style.fontSize = '24px';\r\n        this.divTextProb.style.textAlign = 'center';\r\n        this.divTextProb.textContent = '00.00%';\r\n\r\n        this.divPopup.appendChild(this.divTextProb);\r\n    }\r\n    updatePopup(x: number, y: number) {\r\n        this.divPopup.style.left = x - 110 + 'px';\r\n        this.divPopup.style.top = y - 90 + 'px';\r\n    }\r\n    setHidePopup(v: boolean) {\r\n        if (v === this._popup) { return; }\r\n\r\n        if (v) {\r\n            this.divPopup.style.display = 'block';\r\n        } else {\r\n            this.divPopup.style.display = 'none';\r\n        }\r\n        this._popup = v;\r\n    }\r\n\r\n}","import { Scene } from '../Core/Scene';\r\nexport class Tracer {\r\n    scene: Scene;\r\n    divHost: HTMLElement;\r\n    div: HTMLElement\r\n    ptsGeoTracing: number[] = undefined;\r\n    toMap: (x: number, y: number) => number[];\r\n    toScreen: (x: number, y: number) => number[];\r\n    destroyApp: () => void;\r\n    constructor(divHost: HTMLElement, toMap: (x: number, y: number) => number[], toScreen: (x: number, y: number) => number[], destroy: () => void ) {\r\n        this.divHost = divHost;\r\n        this.toScreen = toScreen;\r\n        this.toMap = toMap;\r\n        this.destroyApp = destroy;\r\n        this.ptsGeoTracing = [];\r\n        this.initHTML();\r\n    }\r\n    public initHTML() {\r\n        const div = document.createElement('div');\r\n        this.div = div;\r\n        div.style.left = '200px';\r\n        div.style.width = '100px';\r\n        div.style.height = '200px';\r\n        div.style.padding = '10px';\r\n        div.style.position = 'absolute';\r\n        div.style.background = '#000';\r\n        this.divHost.appendChild(div);\r\n\r\n\r\n        let divBtn = document.createElement('div');\r\n        divBtn.style.marginBottom = '5px';\r\n        divBtn.style.width = '20px';\r\n        divBtn.style.height = '20px';\r\n        divBtn.textContent = 'Tracer';\r\n        divBtn.style.color = '#fff';\r\n        div.appendChild(divBtn);\r\n\r\n        divBtn = document.createElement('div');\r\n        divBtn.style.marginBottom = '5px';\r\n        divBtn.style.height = '20px';\r\n        divBtn.textContent = 'X';\r\n        divBtn.style.color = '#fff';\r\n        div.appendChild(divBtn);\r\n        divBtn.onclick = () => {\r\n            this.ptsGeoTracing = [];\r\n            this.destroy();\r\n        }\r\n\r\n        divBtn = document.createElement('div');\r\n        divBtn.style.marginBottom = '5px';\r\n        divBtn.style.height = '20px';\r\n        divBtn.textContent = 'Reset';\r\n        divBtn.style.color = '#fff';\r\n        divBtn.onclick = () => {\r\n            this.ptsGeoTracing = [];\r\n        }\r\n        div.appendChild(divBtn);\r\n\r\n\r\n        divBtn = document.createElement('div');\r\n        divBtn.style.marginBottom = '5px';\r\n        divBtn.style.height = '20px';\r\n        divBtn.textContent = 'Print';\r\n        divBtn.style.color = '#fff';\r\n        divBtn.onclick = () => {\r\n            console.log(this.ptsGeoTracing);\r\n        }\r\n        div.appendChild(divBtn);\r\n    }\r\n    public click(x: number, y: number) {\r\n        const mp = this.toMap(x, y);\r\n        console.log(`Lon:${mp[0]}, Lat:${mp[1]}`);\r\n        this.ptsGeoTracing.push(mp[0], mp[1]);\r\n    }\r\n    public startCapture() {\r\n        this.ptsGeoTracing = [];\r\n    }\r\n    public endCapture() {\r\n        this.ptsGeoTracing = undefined;\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D) {\r\n        if (this.ptsGeoTracing !== undefined) {\r\n\r\n            if (this.ptsGeoTracing.length > 3) {\r\n                // console.log(this.ptsGeo.length)\r\n                ctx.beginPath();\r\n                let pos = this.toScreen(this.ptsGeoTracing[0], this.ptsGeoTracing[1])\r\n                // console.log(pos)\r\n                ctx.moveTo(pos[0], pos[1])\r\n                for (let i = 2; i < this.ptsGeoTracing.length; i += 2) {\r\n                    pos = this.toScreen(this.ptsGeoTracing[i], this.ptsGeoTracing[i + 1])\r\n                    ctx.lineTo(pos[0], pos[1])\r\n                }\r\n                ctx.lineWidth = 2;\r\n                ctx.strokeStyle = '#000000';\r\n                ctx.stroke();\r\n                // console.log(pos)\r\n\r\n\r\n            }\r\n\r\n            for (let i = 0; i < this.ptsGeoTracing.length; i += 2) {\r\n                let pos = this.toScreen(this.ptsGeoTracing[i], this.ptsGeoTracing[i + 1])\r\n                ctx.beginPath();\r\n                ctx.arc(pos[0], pos[1], 10, 0, Math.PI * 2.);\r\n                ctx.closePath();\r\n                ctx.fillStyle = '#fff';\r\n                ctx.fill();\r\n            }\r\n        }\r\n    }\r\n    public destroy = () => {\r\n        this.div.parentElement.removeChild(this.div);\r\n        this.destroyApp();\r\n    }\r\n}","\r\nimport { WaterHyacinth } from '../';\r\n\r\nimport { Tracer } from './Tracer';\r\n\r\nexport class Addon {\r\n    public app: WaterHyacinth;\r\n    public tracer: Tracer;\r\n    constructor(app: WaterHyacinth) {\r\n        this.app = app;\r\n\r\n        // console.log(this.app.param['dev'])\r\n        if (this.app.param['dev']) {\r\n            this.initDev();\r\n        }\r\n    }\r\n\r\n    public initDev() {\r\n        this.appendTracer();\r\n    }\r\n    public appendTracer() {\r\n        this.tracer = new Tracer(\r\n            this.app.divHost, this.app.core.common.toMap, this.app.core.common.toScreen,\r\n            () => { this.tracer = undefined; }\r\n            );\r\n    }\r\n    public click(x: number, y: number) {\r\n        if (this.tracer) {\r\n            this.tracer.click(x, y);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D) {\r\n        if (this.tracer) {\r\n            this.tracer.render(ctx);\r\n        }\r\n    }\r\n}","import { Renderer } from './Core/Renderer';\r\nimport { UI } from './UI';\r\nimport { Core } from './Core';\r\nimport { Project } from './Project';\r\nimport { Addon } from './Addon';\r\nimport { PARAM } from '../../../../App';\r\n\r\nconst siteData = [\r\n    {\r\n        name: 'Lake, Hills Pond',\r\n        loc: [-71.16562914640474, 42.410989862313016],\r\n        zoom: 18,\r\n        boundary: [ ],\r\n        probability: 0.2\r\n    },\r\n    {\r\n        name: 'Fresh Pond, MA',\r\n        loc: [-71.149732, 42.384607],\r\n        zoom: 15,\r\n        boundary: [-71.1471427741205, 42.38369829310599, -71.1454147151241, 42.3832249146333, -71.144831067490, 42.3832249146333, -71.1443618590280, 42.38337707280340, -71.1441215328383, 42.383732105164675, -71.14404142410845, 42.383918074064034, -71.14333189076628, 42.38393498100385, -71.14304578890791, 42.38390962107612, -71.14250791563302, 42.38439990023337, -71.14218748071345, 42.38483100457135, -71.14194715583345, 42.385515693014376, -71.1419242679991, 42.38611584616517, -71.14195859975062, 42.38675825758481, -71.14258802305322, 42.38719779779073, -71.14291990319965, 42.38732458778373, -71.14453352040498, 42.386800521078975, -71.14480817834618, 42.386682182643234, -71.1458152574639, 42.386614560234314, -71.14628446723574, 42.38642014715624, -71.14731443549749, 42.386310260185624, -71.1480583005912, 42.386825879355264, -71.14865339345197, 42.38736685138028, -71.14920271064405, 42.38786555599473, -71.14972913869208, 42.38809377527334, -71.15045011595143, 42.38839806619294, -71.150770550871, 42.38855866418817, -71.15119398235481, 42.38851640139403, -71.15201795748807, 42.38808532284766, -71.152601605122, 42.387831745678575, -71.1531280344797, 42.38768805126903, -71.15357435379786, 42.38762888291559, -71.15443266068266, 42.38764578837241, -71.15494764481353, 42.387510546041405, -71.15566862272772, 42.38729077717622, -71.15596616784842, 42.38674135140531, -71.15580595169831, 42.38591297834076, -71.15579450647148, 42.38537199330331, -71.15533674389097, 42.38487326936299, -71.15510786096365, 42.38474647441903, -71.15506208529494, 42.38436608756697, -71.15518797034836, 42.38398569889383, -71.1550048643994, 42.383698293105994, -71.15437543978712, 42.38314883589375, -71.15383756651222, 42.382548654862966, -71.15368879427928, 42.382109081622424, -71.15355146596352, 42.381661052013705, -71.152897722045, 42.38158391447455, -71.15219963196516, 42.3816473151721, -71.1516159836764, 42.38149092663678, -71.1510380566914, 42.38128804386745, -71.15056884888406, 42.38108515995885, -71.1502713024538, 42.380882275394804, -71.15031135681876, 42.38053990659923, -71.1502713024538, 42.380205989424546, -71.15002525430553, 42.37991856585079, -71.14973915179233, 42.37980021492652, -71.1489151773139, 42.379817122007765, -71.1484173590588, 42.380003102503316, -71.1477135476752, 42.38003691703571, -71.14716995244171, 42.380015782773704, -71.14683807425982, 42.380176401728896, -71.14592826974774, 42.380844234617186, -71.14588249276937, 42.381038665446106, -71.14597976737502, 42.3811739212357, -71.14702690151253, 42.381672675046346, -71.14758194000835, 42.381985450580224, -71.14785087664579, 42.38231935829161, -71.14782798881144, 42.382619450861974, -71.14754188629824, 42.383080153525164, -71.14754188629824, 42.383342202953166, -71.14743888907917, 42.38349858687732, -71.14730156010857, 42.38364651714675, -71.1471427741205, 42.38369829310599],\r\n        probability: 0.8\r\n    },\r\n    {\r\n        name: 'Lake, Atkinson County',\r\n        loc: [-82.716073, 31.205917], // 31.205917,-82.716073\r\n        zoom: 18,\r\n        boundary: [1, 18],\r\n        probability: 0.2\r\n    }\r\n];\r\n\r\nexport class WaterHyacinth {\r\n    public divHost: HTMLElement\r\n    public core: Core;\r\n    public renderer: Renderer;\r\n    public ui: UI;\r\n    public project: Project;\r\n    public param: any;\r\n    public addon: Addon;\r\n    constructor(view: any) {\r\n\r\n        if (Boolean(PARAM['demo']) === true) {\r\n            this.init(view);\r\n        }\r\n    }\r\n    private init(view: any) {\r\n        this.divHost = view;\r\n        this.divHost.id = 'mapboxgl-container'\r\n        this.param = PARAM;\r\n\r\n        this.renderer = new Renderer(this);\r\n        this.core = new Core(this);\r\n        this.project = new Project(this, siteData);\r\n        this.addon = new Addon(this);\r\n        this.ui = new UI(this);\r\n        this.renderer.init();\r\n    }\r\n    public destroy() {\r\n        // this.renderer.destroy();\r\n        if (this.divHost){\r\n            while (this.divHost.lastElementChild) {\r\n                this.divHost.removeChild(this.divHost.lastElementChild);\r\n            }\r\n        }\r\n\r\n    }\r\n}\r\n","import { getCSVFromURL, remap } from 'njscore';\r\n\r\nexport class WaterQualityInspector {\r\n    public data = {};\r\n\r\n    public day = 24;\r\n\r\n    public scale = 0.25\r\n    public dataSampling = 4;\r\n    public margin = 25;\r\n    public ctx: CanvasRenderingContext2D;\r\n\r\n    public m: number[] = [0, 0];\r\n    public selVal: number = 0;\r\n    public selID: number = 0;\r\n\r\n    public dataRaw: string[] = [];\r\n\r\n    public index = 0;\r\n    public id = [\r\n        'mass_concentration_of_blue_green_algae_in_sea_water_rfu (RFU)', // 0.10000000149011612   3.700000047683716\r\n        'chlorophyll_fluorescence (RFU)',  // 0.10000000149011612   8\r\n        'sea_water_turbidity (1)', // 0.009999999776482582   335.9800109863281\r\n        'sea_water_temperature (K)', // 255.37222290039062   300.00555419921875\r\n        'sea_water_ph_reported_on_total_scale (1)', // 255.37222290039062   300.00555419921875\r\n    ];\r\n\r\n    constructor(ctx: CanvasRenderingContext2D, i = 0) {\r\n        this.ctx = ctx;\r\n        this.index = i;\r\n        document.onkeydown = (k) => {\r\n            this.dataSampling++;\r\n            // console.log(this.dataSampling)\r\n        }\r\n        getCSVFromURL(process.env.PUBLIC_URL + '/static/data/Watabot/obs_104_1928_d047_15c7.csv').then((d) => {\r\n            const lines = d.split(/\\r\\n|\\r|\\n/g);\r\n            this.dataRaw = lines;\r\n\r\n            const index = lines[0].split(',');\r\n\r\n            const dataDic = {}\r\n            let needComputeData = true;\r\n            for (let i = 0; i < index.length; ++i) {\r\n                // console.log(index[i]);\r\n                if (needComputeData && index[i] === 'time (UTC)') {\r\n                    dataDic[index[i]] = [];\r\n                    needComputeData = false;\r\n                } else {\r\n                    dataDic[index[i]] = new Float32Array(lines.length - 1);\r\n                }\r\n            }\r\n\r\n            for (let i = 1; i < lines.length; ++i) {\r\n                const row = lines[i].split(',');\r\n                for (let j = 0; j < index.length; ++j) {\r\n                    const theIndex = index.indexOf(index[j]);\r\n                    if (theIndex !== -1) {\r\n                        dataDic[index[j]][i - 1] = row[theIndex];\r\n                    }\r\n                }\r\n\r\n            }\r\n            this.data = dataDic;\r\n            // console.log(dataDic);\r\n            // const divContainer = this.ctx.canvas.parentElement;\r\n            // const domRect = this.ctx.canvas.getBoundingClientRect();\r\n\r\n            const div = document.createElement('div');\r\n            div.style.zIndex = '1';\r\n            div.style.color = '#000';\r\n            div.style.fontSize = '11px';\r\n            div.style.position = 'absolute';\r\n            div.style.left = '10px';\r\n            div.style.top = '5px';\r\n            div.textContent = this.id[i];\r\n\r\n            this.ctx.canvas.parentElement.appendChild(div);\r\n\r\n            this.render(this.ctx);\r\n        });\r\n    }\r\n    public Offset(v) {\r\n        if (v < 0) {\r\n            // this.offsetData -= this.offsetData * 0.5;\r\n        } else {\r\n            // this.offsetData += this.offsetData * 0.5;\r\n        }\r\n    }\r\n    public wheel(e: WheelEvent) {\r\n        if (e.deltaY < 0) {\r\n            this.scale += this.scale * .25;\r\n        } else {\r\n            this.scale -= this.scale * .25;\r\n        }\r\n        this.scale = this.scale < 0.012 ? 0.012 : this.scale;\r\n        // console.log(this.scale);\r\n    }\r\n    public mouseMove(x: number, y: number) {\r\n        this.m[0] = x;\r\n        this.m[1] = y;\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D) {\r\n        // console.log(this.m[0], this.m[1]);\r\n        // console.trace();\r\n        // ctx.save();\r\n        // ctx.scale(-1,1)\r\n        // ctx.translate(-this.ctx.canvas.width, 0)\r\n\r\n        // console.log('o')\r\n\r\n        // let index = ;\r\n\r\n        const xP = (this.m[0] * -1) + this.ctx.canvas.width;\r\n\r\n\r\n        let d = this.data[this.id[this.index]]; // sea_water_temperature (K) sea_water_turbidity (1)\r\n        if (d === undefined) { return; }\r\n\r\n        // console.log('this.index', this.index);\r\n\r\n        vizBG(ctx, d, this.scale, this.day, this.margin);\r\n\r\n        const domain = getMinMax(d, this.dataSampling);\r\n        // console.log('domain', domain);\r\n\r\n        ctx.lineWidth = 4;\r\n        ctx.strokeStyle = '#000';\r\n        this.vizData(ctx, d, domain, this.scale, this.day, this.dataSampling, this.margin, xP);\r\n\r\n        // d = this.data['sea_water_turbidity (1)'];\r\n        // vizData(ctx, d, '#0f0', this.scale, this.day, this.dataSampling, this.margin);\r\n\r\n        // d = this.data['chlorophyll_fluorescence (RFU)'];\r\n        // vizData(ctx, d, '#00f', this.scale, this.day, this.dataSampling, this.margin);\r\n\r\n        // d = this.data['oxidation_reduction_potential (mV)'];\r\n        // vizData(ctx, d, '#0ff', this.scale, this.day, this.dataSampling, this.margin);\r\n        // ctx.restore();\r\n        // ctx.scale(1,1);\r\n\r\n        ctx.lineWidth = 0.5;\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(xP, 0);\r\n        ctx.lineTo(xP, this.ctx.canvas.height);\r\n        ctx.stroke();\r\n\r\n        ctx.beginPath();\r\n        ctx.arc(xP, this.m[1], 1, 0, Math.PI * 2);\r\n        ctx.fill();\r\n\r\n        // let scaleLocalY = ctx.canvas.height - this.margin;\r\n        \r\n        // let id = Math.floor(xP * this.scale);\r\n        // console.log('id', id);\r\n        // const yP = remap(d[id], domain[0], domain[1], scaleLocalY, this.margin);\r\n        // console.log(yP);\r\n\r\n        ctx.fillStyle = '#f00';\r\n        ctx.beginPath();\r\n        ctx.arc(xP, this.selVal, 7, 0, Math.PI * 2);\r\n        ctx.fill();\r\n\r\n        // ctx.fillText(id[this.index], this.ctx.canvas.width * 0.5, 10);\r\n    }\r\n    public vizData = (ctx: CanvasRenderingContext2D, d, domain, scale, day, dataSampling, margin, mX) => {\r\n        let scaleLocalY = ctx.canvas.height - margin;\r\n        // console.log(ctx.canvas.height);\r\n\r\n        ctx.beginPath();\r\n        let x = margin;\r\n        let y = remap(d[0], domain[0], domain[1], scaleLocalY, margin);\r\n\r\n        mX = Math.floor((mX - margin) / scale);\r\n\r\n        // console.log('mX', mX);\r\n\r\n        ctx.moveTo(x, y);\r\n\r\n        for (let i = 1; i < d.length; i += dataSampling) {\r\n            x += 1;\r\n\r\n            const xP = margin + (x * scale * dataSampling);\r\n\r\n            let yP = 0 + margin;\r\n            let val = 0;\r\n            let key = 'max'; // max\r\n\r\n            switch (key) {\r\n                case 'mean':\r\n                    for (let j = 0; j < dataSampling; ++j) {\r\n                        val += d[i + j];\r\n                    }\r\n\r\n                    yP = val / dataSampling * scaleLocalY;\r\n                    yP = remap(yP, domain[0], domain[1], scaleLocalY, margin);\r\n                    ctx.lineTo(xP, yP);\r\n                    break;\r\n\r\n                default:\r\n                    let hover = false;\r\n                    for (let j = 0; j < dataSampling; ++j) {\r\n                        const id = i + j;\r\n\r\n                        // console.log(id);\r\n                        \r\n                        if (id === mX) {\r\n                            hover = true;\r\n                            this.selID = id;\r\n                        }\r\n\r\n                        if (val < d[id]) {\r\n                            val = d[id];\r\n                        }\r\n                    }\r\n\r\n                    yP = remap(val, domain[0], domain[1], scaleLocalY, margin); // offsetData;\r\n\r\n                    if (hover) {\r\n                        this.selVal = yP;\r\n                        // console.log(this.selID);\r\n                    }\r\n                    // const dd = mX * dataSampling * scaleLocalY;\r\n                    // if (dd === xP) {\r\n                    //     console.log('yP', yP);\r\n                    //     this.val = yP;\r\n                    // }\r\n\r\n                    ctx.lineTo(xP, yP);\r\n                    break;\r\n            }\r\n        }\r\n        ctx.stroke();\r\n\r\n        // console.log(d[this.selID], this.dataRaw[this.selID]);\r\n\r\n        // console.log(this.dataRaw[this.selID].split(',')[0]);\r\n\r\n        ctx.save();\r\n\r\n        ctx.scale(-1, 1);\r\n\r\n        ctx.fillText(this.dataRaw[this.selID].split(',')[0], 10, 10);\r\n\r\n        ctx.restore();\r\n    };\r\n}\r\n\r\n// Possibility of harmful algae bloom (to be calculated based on prediction model)\r\n// blue_green_algae_in_sea_water_rfu (RFU)\r\n// chlorophyll_fluorescence (RFU)\r\n// sea_water_turbidity\r\n// sea_water_temperature (K)\r\n// Sea_water_ph\r\n\r\n// time (UTC)\r\n// mass_concentration_of_chlorophyll_in_sea_water (kg m-3)\r\n// chlorophyll_fluorescence (RFU)\r\n// sea_water_electrical_conductivity (S m-1)\r\n// mass_concentration_of_oxygen_in_sea_water (kg m-3)\r\n// oxidation_reduction_potential (mV)\r\n// sea_water_ph_reported_on_total_scale (1)\r\n// mass_concentration_of_blue_green_algae_in_sea_water (ug L-1)\r\n// mass_concentration_of_blue_green_algae_in_sea_water_rfu (RFU)\r\n// sea_water_turbidity (1)\r\n// sea_water_temperature (K)\r\n// platform\r\n\r\nconst getMinMax = (d: number[], dataSampling: number) => {\r\n    let min = Number.MAX_VALUE;\r\n    let max = Number.MIN_VALUE;\r\n    // dataSampling = 1;\r\n\r\n    for (let i = 1; i < d.length; i += dataSampling) {\r\n        let val = d[i];\r\n        let key = 'max';\r\n        switch (key) {\r\n            case 'mean':\r\n                for (let j = 0; j < dataSampling; ++j) {\r\n                    min = min > val ? val : min;\r\n                    max = max < val ? val : max;\r\n                }\r\n                break;\r\n            default:\r\n                for (let j = 0; j < dataSampling; ++j) {\r\n                    min = min > val ? val : min;\r\n                    max = max < val ? val : max;\r\n                }\r\n                break;\r\n        }\r\n\r\n    }\r\n    return [min, max];\r\n};\r\n\r\nconst vizBG = (ctx: CanvasRenderingContext2D, d, scale, day, margin) => {\r\n    const hourRes = 12;\r\n\r\n    ctx.setLineDash([2, 2]);\r\n    ctx.lineWidth = 1;\r\n\r\n    for (let i = 0; i < d.length; i++) {\r\n        ctx.strokeStyle = `rgba(200, 200, 200, 0.8)`;\r\n\r\n        if (scale > 0.1) {\r\n            if (i % (hourRes * day) === 0) {\r\n                const x = margin + i * scale;\r\n                ctx.beginPath();\r\n                ctx.moveTo(x, margin);\r\n                ctx.lineTo(x, ctx.canvas.height - margin);\r\n                ctx.stroke();\r\n            }\r\n        }\r\n\r\n        ctx.strokeStyle = `rgba(0, 0, 255, 0.8)`;\r\n        if (scale > 0.02) {\r\n            if (i % (hourRes * day * 7) === 0) {\r\n                const x = margin + i * scale;\r\n                ctx.beginPath();\r\n                ctx.moveTo(x, margin);\r\n                ctx.lineTo(x, ctx.canvas.height - margin);\r\n                ctx.stroke();\r\n                // console.log(i)\r\n            }\r\n        }\r\n\r\n        ctx.strokeStyle = `rgba(0, 255, 0, 0.8)`;\r\n        if (i % (hourRes * day * 30) === 0) {\r\n            const x = margin + i * scale;\r\n            ctx.beginPath();\r\n            ctx.moveTo(x, margin);\r\n            ctx.lineTo(x, ctx.canvas.height - margin);\r\n            ctx.stroke();\r\n            // console.log(i)\r\n        }\r\n\r\n    }\r\n    ctx.setLineDash([]);\r\n};","import { WaterQualityInspector } from './WaterQualityInspector';\nexport class ChartVizWater {\n    public divHost: HTMLDivElement;\n    public canvas: HTMLCanvasElement;\n    public ctx: CanvasRenderingContext2D;\n    public isDown: boolean = false;\n    public debugMode: boolean = false;\n    public isStatic: boolean = false\n\n    public waterQualityInspector: WaterQualityInspector;\n\n    private prevent: boolean = false;\n    private delay: number = 250;\n    private timer: NodeJS.Timer | number;\n    private isDrag: boolean = false;\n\n    constructor(div: HTMLDivElement, i: number = 3) {\n        this.divHost = div;\n\n        const bounding = this.divHost.getBoundingClientRect();\n        this.canvas = document.createElement('canvas') as HTMLCanvasElement;\n\n        this.canvas.style.position = 'relative';\n        this.canvas.style.width = '100%';\n        this.canvas.style.height = '100%';\n        this.canvas.style.background = 'rgba(255, 255, 255, 1.0)';\n        this.canvas.style.borderRadius = '15px';\n        // this.canvas.style.filter = 'blur(10px)'\n\n        // this.canvas.style.position = 'absolute';\n        this.canvas.width = bounding.width;\n        this.canvas.height = bounding.height;\n        this.divHost.appendChild(this.canvas);\n\n        this.ctx = this.canvas.getContext('2d') as CanvasRenderingContext2D;\n        this.ctx.scale(-1,1)\n        this.ctx.translate(-this.ctx.canvas.width, 0);\n\n        this.canvas.onclick = (e: MouseEvent) => {\n            this.timer = setTimeout(() => {\n                if (!this.prevent) {\n                    this.mouseClick(e.offsetX, e.offsetY);\n                }\n                this.isDrag = false;\n                this.prevent = false;\n            },this.delay);\n            this.loop(this.ctx);\n        };\n        // this.canvas.onwheel = (e: WheelEvent) => {\n        //     this.mouseWheel(e);\n        //     this.loop(this.ctx);\n        // };\n        this.canvas.ondblclick = (e: MouseEvent) => {\n            clearTimeout(this.timer as number);\n            this.prevent = true;\n            this.mouseDoubleClick(e.offsetX, e.offsetY);\n            this.loop(this.ctx);\n        };\n        this.canvas.onmousedown = (e: MouseEvent) => {\n            this.isDown = true;\n            this.mouseDown(e.offsetX, e.offsetY);\n            this.loop(this.ctx);\n        };\n        this.canvas.onmouseup = (e: MouseEvent) => {\n            this.isDown = false;\n            this.isDrag = false;\n            this.mouseUp(e.offsetX, e.offsetY);\n            this.loop(this.ctx);\n        };\n        this.canvas.onmousemove = (e: MouseEvent) => {\n            if (this.isDown) {\n                this.isDrag = true;\n                this.prevent = true;\n                this.mouseDrag(e.offsetX, e.offsetY);\n            } else {\n                this.mouseMove(e.offsetX, e.offsetY);\n            }\n            // this.loop(this.ctx);\n        };\n\n        this.canvas.onwheel = (e) => {\n            this.waterQualityInspector.wheel(e);\n            this.loop(this.ctx);\n        };\n\n        this.waterQualityInspector = new WaterQualityInspector(this.ctx, i);\n        window.addEventListener('resize', this.resize);\n        // this.loop(this.ctx);\n        this.start();\n    }\n    public start() {\n        this.loop(this.ctx);\n    }\n    private resize = () => {\n        const bounding = this.divHost.getBoundingClientRect();\n        this.canvas.width = bounding.width;\n        this.canvas.height = bounding.height;\n        this.loop(this.ctx);\n    }\n    public destroy() {\n        window.removeEventListener('resize', this.resize);\n        this.isStatic = true;\n        try {\n            while (this.divHost !== undefined && this.divHost.lastElementChild !== undefined) {\n                this.divHost.removeChild(this.divHost.lastElementChild);\n            }\n        } catch (error) { }\n    }\n    public renderUpdate(ctx: CanvasRenderingContext2D) {\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n        this.render(ctx);\n    }\n    public loop(ctx: CanvasRenderingContext2D) {\n        if (this.isStatic) { return; }\n        requestAnimationFrame(() => { this.renderUpdate(ctx); });\n    }\n    public render(ctx: CanvasRenderingContext2D) {\n\n        // this.ctx.save();\n        // this.ctx.translate(-400, 0)\n        // this.ctx.scale(-1, 0);\n        this.waterQualityInspector.render(this.ctx);\n        // this.ctx.restore();\n    }\n    public mouseClick(x: number, y: number) {\n        // Binding needed\n        if (this.debugMode) { console.log('click'); }\n    }\n    public mouseDoubleClick(x: number, y: number) {\n        // Binding needed\n        if (this.debugMode) { console.log('d-click'); }\n    }\n    public mouseDown(x: number, y: number) {\n        // Binding needed\n        if (this.debugMode) { console.log('down'); }\n    }\n    public mouseUp(x: number, y: number) {\n        // Binding needed\n        if (this.debugMode) { console.log('up'); }\n    }\n    public mouseMove(x: number, y: number) {\n        // Binding needed\n        if (this.debugMode) { console.log('move'); }\n\n        this.waterQualityInspector.mouseMove(x, y);\n        this.loop(this.ctx);\n    }\n    public mouseDrag(x: number, y: number) {\n        // Binding needed\n        if (this.debugMode) { console.log('drag'); }\n    }\n    public mouseWheel(v: WheelEvent) {\n        // Binding needed\n        if (this.debugMode) { console.log('wheel', v); }\n    }\n}\n\n"],"names":["MapboxGLWrapper","constructor","id","map","center","lng","lat","setCenter","toMap","x","y","p","this","unproject","toScreen","lon","project","mouseDown","e","mouseUp","mouseMove","mouseClick","mouseDClick","initMap","mapboxgl","container","zoom","style","dragRotate","disable","on","div","document","getElementsByClassName","position","display","getZoom","v","setZoom","RendererCanvasDynamic","RendererCanvasDynamicLight","super","time","pts","mouseDrag","canvas","width","height","pointerEvents","start","render","ctx","Renderer","app","canvasCustom","originalZoom","originalCenter","globalCompositeOperation","core","scene","processEventData","divHost","init","zoomOut","keyDown","k","m","activeCommand","forceRender","UI","solution","color","background","backdropFilter","createElement","padding","append","getDivBtn","onclick","addon","appendTracer","host","title","appendChild","borderTop","margin","textContent","ActiveCommand","common","checkHover","click","capture","sites","getCloseSite","length","properties","renderer","Common","i","site","distanceTo","vec","r","push","forEach","isHover","Scene","colorArray1","colorArray2","_capture","result","getFalseColor","xOff","yOff","beginPath","rect","closePath","fillStyle","fill","renderDot","undefined","font","log","toFixed","fillText","logSite","getLog","isActivated","blur","focus","Core","Boid","BoidContollerWander0","boundary","maxForce","maxVelocity","maxSpeed","mass","isRenderable","targets","target","targetID","col","desiredVelocity","steering","velocity","Vector3","wanderAngle","CIRCLE_DISTANCE","CIRCLE_RADIUS","ANGLE_CHANGE","t","MAX_QUEUE_AHEAD","MAX_QUEUE_RADIUS","trajectory","timerTrajectory","scaleBounding","list","UpdateTarget","Update","UpdateVec1","getRandomSpot","z","unitize","Queue","UpdateVec0","Wander","circleCenter","normalize","scale","displacement","setAngle","Math","random","add","value","len","cos","sin","GetNeighborAhead","ret","qa","clone","ahead","neighbor","d","Render","RenderCircle","RenderDesiredVelocity","RenderCurrentVelocity","shift","arc","strokeStyle","lineWidth","stroke","boids","vsBoundary","AddAgent","geoPos","console","boid","b","GetPoint","Boundary","pMin","pMax","pCenter","ctxTemp","selID","selVal","selInside","divViz","chartVizWaters","img","Image","src","process","crossOrigin","onload","getContext","willReadFrequently","drawImage","remap","isInsideOfVecs","appendViz","probability","PI","pos","moveTo","lineTo","res","intervalX","intervalY","interXImage","interYImage","minDis","Number","MAX_SAFE_INTEGER","j","sp","getImageData","data","dis","updatePopup","setHidePopup","xHover","yHover","left","ChartVizWater","destroy","parentElement","removeChild","Properties","name","Site","needAgent","hover","loc","initAgent","Project","siteData","rawSiteData","divPopup","divText","divTextProb","_popup","initSite","siteObj","zIndex","borderRadius","fontWeight","fontSize","textAlign","top","Tracer","ptsGeoTracing","destroyApp","initHTML","divBtn","marginBottom","mp","startCapture","endCapture","Addon","tracer","param","initDev","WaterHyacinth","view","ui","Boolean","PARAM","lastElementChild","WaterQualityInspector","day","dataSampling","dataRaw","index","vizData","domain","mX","scaleLocalY","floor","xP","yP","val","save","split","restore","onkeydown","getCSVFromURL","then","lines","dataDic","needComputeData","Float32Array","row","theIndex","indexOf","Offset","wheel","deltaY","vizBG","getMinMax","min","MAX_VALUE","max","MIN_VALUE","setLineDash","isDown","debugMode","isStatic","waterQualityInspector","prevent","delay","timer","isDrag","resize","bounding","getBoundingClientRect","loop","translate","setTimeout","offsetX","offsetY","ondblclick","clearTimeout","mouseDoubleClick","onmousedown","onmouseup","onmousemove","onwheel","window","addEventListener","removeEventListener","error","renderUpdate","clearRect","requestAnimationFrame","mouseWheel"],"sourceRoot":""}