"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[43574],{85610:(t,e,i)=>{i.d(e,{h:()=>o,z:()=>r});var n=i(39880);const r=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1];const o=n.Ue(),s=n.Ue(),a=n.Ue(),u=n.Ue(),c=n.Ue();n.vc(u,e),n.aC(o,i[0]),n.gT(s,i[1]),n.QO(a,i[2]),n.xJ(c,r),n.Jp(t,o,c),n.Jp(t,s,t),n.Jp(t,a,t),n.Jp(t,u,t)},o=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[2,2,4],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,1,0];const o=n.Ue(),s=n.Ue(),a=n.Ue();n.G3(s,2*Math.PI/5,t,.1,100),n.zB(o,e,i,r),n.Jp(a,s,o);return{viewMatrix:o,projectionMatrix:s,viewProjectionMatrix:a,cameraOption:{eye:e,center:i,zoomMax:100,zoomSpeed:2}}}},43574:(t,e,i)=>{i.r(e),i.d(e,{Solution:()=>f});var n=i(88679),r=i(39880);const o=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST;const n=t.createBuffer({size:e.byteLength,usage:i,mappedAtCreation:!0});return new Float32Array(n.getMappedRange()).set(e),n.unmap(),n};var s=i(85610);const a=function(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0,0];const o=Math.sin(e*Math.PI/180),s=Math.cos(e*Math.PI/180),a=Math.sin(i*Math.PI/180),u=Math.cos(i*Math.PI/180);return n.al(t*o*u+r[0],t*s+r[1],-t*o*a+r[2])},u=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0,0];if(e<2||i<2)return;let r,o=[];for(let v=0;v<e;v++){let s=[];for(let o=0;o<i;o++)r=a(t,180*v/(e-1),360*o/(i-1),n),s.push(r);o.push(s)}let s,u,c,h,f=[],l=[];for(let a=0;a<e-1;a++)for(let e=0;e<i-1;e++)s=o[a][e],u=o[a+1][e],c=o[a+1][e+1],h=o[a][e+1],f.push([s[0],s[1],s[2],u[0],u[1],u[2],h[0],h[1],h[2],u[0],u[1],u[2],c[0],c[1],c[2],h[0],h[1],h[2]]),l.push([s[0]/t,s[1]/t,s[2]/t,u[0]/t,u[1]/t,u[2]/t,h[0]/t,h[1]/t,h[2]/t,u[0]/t,u[1]/t,u[2]/t,c[0]/t,c[1]/t,c[2]/t,h[0]/t,h[1]/t,h[2]/t]);return{vertexData:new Float32Array(f.flat()),normalData:new Float32Array(l.flat())}},c=t=>{t.color=void 0===t.color?"(1.0, 0.0, 0.0)":t.color,t.ambientIntensity=void 0===t.ambientIntensity?"0.2":t.ambientIntensity,t.diffuseIntensity=void 0===t.diffuseIntensity?"0.8":t.diffuseIntensity,t.specularIntensity=void 0===t.specularIntensity?"0.4":t.specularIntensity,t.shininess=void 0===t.shininess?"30.0":t.shininess,t.specularColor=void 0===t.specularColor?"(1.0, 1.0, 1.0)":t.specularColor,t.isPhong=void 0===t.isPhong?"0":t.isPhong;return{vertex:"\n         struct Uniforms {\n             viewProjectionMatrix : mat4x4<f32>,\n             modelMatrix : mat4x4<f32>,               \n             normalMatrix : mat4x4<f32>,            \n         };\n         @binding(0) @group(0) var<uniform> uniforms : Uniforms;\n \n         struct Output {\n             @builtin(position) Position : vec4<f32>,\n             @location(0) vPosition : vec4<f32>,\n             @location(1) vNormal : vec4<f32>,\n         };\n \n         @vertex\n         fn main(@location(0) position: vec4<f32>, @location(1) normal: vec4<f32>) -> Output {    \n             var output: Output;            \n             let mPosition:vec4<f32> = uniforms.modelMatrix * position; \n             output.vPosition = mPosition;                  \n             output.vNormal =  uniforms.normalMatrix*normal;\n             output.Position = uniforms.viewProjectionMatrix * mPosition;               \n             return output;\n         }",fragment:"\n         struct Uniforms {\n             lightPosition : vec4<f32>,   \n             eyePosition : vec4<f32>,\n         };\n         @binding(1) @group(0) var<uniform> uniforms : Uniforms;\n \n         @fragment\n         fn main(@location(0) vPosition: vec4<f32>, @location(1) vNormal: vec4<f32>) -> @location(0) vec4<f32> {\n             let N:vec3<f32> = normalize(vNormal.xyz);                \n             let L:vec3<f32> = normalize(uniforms.lightPosition.xyz - vPosition.xyz);     \n             let V:vec3<f32> = normalize(uniforms.eyePosition.xyz - vPosition.xyz);          \n             let H:vec3<f32> = normalize(L + V);\n             let diffuse:f32 = ".concat(t.diffuseIntensity," * max(dot(N, L), 0.0);\n             var specular:f32;\n             var isp:i32 = ").concat(t.isPhong,";\n             if(isp === 1){\n                 specular = ").concat(t.specularIntensity," * pow(max(dot(V, reflect(-L, N)),0.0), ").concat(t.shininess,");\n             } else {\n                 specular = ").concat(t.specularIntensity," * pow(max(dot(N, H),0.0), ").concat(t.shininess,");\n             }               \n             let ambient:f32 = ").concat(t.ambientIntensity,";               \n             let finalColor:vec3<f32> = vec3<f32>").concat(t.color,"*(ambient + diffuse) + vec3<f32>").concat(t.specularColor,"*specular; \n             return vec4<f32>(finalColor, 1.0);\n         }")}},h=i(27089);class f{constructor(t){this.divHost=void 0,this.canvas=void 0,this.ctx=void 0,this.device=void 0,this.format=void 0,this.size=void 0,this.pipeline=void 0,this.isAnimation=!0,this.camera=void 0,this.uniformBuffer=void 0,this.uniformBindGroup=void 0,this.textureView=void 0,this.depthTexture=void 0,this.renderPassDescription=void 0,this.numberOfVertices=void 0,this.vertexBuffer=void 0,this.normalBuffer=void 0,this.colorBuffer=void 0,this.rotation=n.al(0,0,0),this.requestAni=void 0,this.loop=()=>{this.isAnimation?(this.rotation[0]+=.01,this.rotation[1]+=.01,this.rotation[2]+=.01):this.rotation=[0,0,0],this.drawing(),this.isAnimation&&(this.requestAni=requestAnimationFrame(this.loop))},this.divHost=document.getElementById(t),this.canvas=document.createElement("canvas"),this.divHost.appendChild(this.canvas),this.initWebGPU()}async initWebGPU(){if(!navigator.gpu)throw new Error("Not Support WebGPU");const t=await navigator.gpu.requestAdapter({powerPreference:"high-performance"});if(!t)throw new Error("No Adapter Found");const e=await t.requestDevice();this.ctx=this.canvas.getContext("webgpu");const i=navigator.gpu.getPreferredCanvasFormat?navigator.gpu.getPreferredCanvasFormat():this.ctx.getPreferredFormat(t);window.devicePixelRatio;this.canvas.width=this.divHost.clientWidth,this.canvas.height=this.divHost.clientHeight,this.ctx.configure({device:e,format:i,alphaMode:"opaque"}),this.size={width:this.canvas.width,height:this.canvas.height},this.device=e,this.format=i,this.camera=new l(this),this.initPipeline(this.device,this.format)}async initPipeline(t,e){const i={color:"[1.0,0.0,0.0]"};i.color=void 0===i.color?"[1.0,0.0,0.0]":i.color,i.ambientIntensity=void 0===i.ambientIntensity?"0.2":i.ambientIntensity,i.diffuseIntensity=void 0===i.diffuseIntensity?"0.8":i.diffuseIntensity,i.specularIntensity=void 0===i.specularIntensity?"0.4":i.specularIntensity,i.shininess=void 0===i.shininess?"30.0":i.shininess,i.specularColor=void 0===i.specularColor?"[1.0, 1.0, 1.0]":i.specularColor;let n=(t=>({shader:c(t),vertex:u(1,20,20,[0,0,0])}))(i);this.vertexBuffer=o(t,n.vertex.vertexData),this.normalBuffer=o(t,n.vertex.normalData),this.numberOfVertices=n.vertex.vertexData.length/3;const r=n.shader;this.pipeline=t.createRenderPipeline({layout:"auto",vertex:{module:t.createShaderModule({code:r.vertex}),entryPoint:"main",buffers:[{arrayStride:12,attributes:[{shaderLocation:0,format:"float32x3",offset:0}]},{arrayStride:12,attributes:[{shaderLocation:1,format:"float32x3",offset:0}]}]},fragment:{module:t.createShaderModule({code:r.fragment}),entryPoint:"main",targets:[{format:this.format}]},primitive:{topology:"triangle-list"},depthStencil:{format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"}}),this.uniformBuffer=t.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.uniformBindGroup=t.createBindGroup({layout:this.pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.uniformBuffer,offset:0,size:64}}]});let s=new Float32Array(this.camera.vp.cameraOption.eye),a=s;const h=t.createBuffer({size:192,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),f=t.createBuffer({size:32,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});t.queue.writeBuffer(h,0,this.camera.vp.viewProjectionMatrix),t.queue.writeBuffer(f,0,a),t.queue.writeBuffer(f,16,s);t.createBindGroup({layout:this.pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:h,offset:0,size:192}},{binding:1,resource:{buffer:f,offset:0,size:32}}]});this.textureView=this.ctx.getCurrentTexture().createView(),this.renderPassDescription={colorAttachments:[{view:this.textureView,clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]},this.requestAni=requestAnimationFrame(this.loop)}drawing(){this.camera.update();const t=this.device.createBuffer({size:192,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});this.device.createBuffer({size:32,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});r.U_(this.camera.normalMatrix,this.camera.modelMatrix),r.p4(this.camera.normalMatrix,this.camera.normalMatrix),this.device.queue.writeBuffer(t,64,this.camera.modelMatrix),this.device.queue.writeBuffer(t,128,this.camera.normalMatrix),this.textureView=this.ctx.getCurrentTexture().createView(),this.renderPassDescription.colorAttachments[0].view=this.textureView;const e=this.device.createCommandEncoder(),i=e.beginRenderPass(this.renderPassDescription);i.setPipeline(this.pipeline),i.setVertexBuffer(0,this.vertexBuffer),i.setVertexBuffer(1,this.normalBuffer),i.setBindGroup(0,this.uniformBindGroup),i.draw(this.numberOfVertices),i.end(),this.device.queue.submit([e.finish()])}destroy(){for(this.device.destroy(),cancelAnimationFrame(this.requestAni);this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}}class l{constructor(t){this.solution=void 0,this.canvas=void 0,this.normalMatrix=void 0,this.modelMatrix=void 0,this.mvpMatrix=void 0,this.vMatrix=void 0,this.vpMatrix=void 0,this.rotation=n.al(0,0,0),this.translation=n.al(0,0,0),this.camera=void 0,this.vp=void 0,this.solution=t,this.canvas=t.canvas,this.normalMatrix=r.Ue(),this.modelMatrix=r.Ue(),this.mvpMatrix=r.Ue(),this.vMatrix=r.Ue(),this.vpMatrix=r.Ue(),this.vp=(0,s.h)(this.canvas.width/this.canvas.height),this.vpMatrix=this.vp.viewProjectionMatrix,this.camera=h(this.canvas,this.vp.cameraOption)}update(){const t=this.vp.projectionMatrix;this.vMatrix=this.camera.matrix,r.Jp(this.vpMatrix,t,this.vMatrix),(0,s.z)(this.modelMatrix,this.translation,this.rotation),r.Jp(this.mvpMatrix,this.vpMatrix,this.modelMatrix)}}},88679:(t,e,i)=>{i.d(e,{$X:()=>a,EU:()=>x,Fv:()=>h,IH:()=>s,Ue:()=>r,VC:()=>d,al:()=>o,fF:()=>l,jI:()=>g,kC:()=>f,kK:()=>v,lM:()=>m,lu:()=>M,od:()=>u,tk:()=>c,uD:()=>p});var n=i(50907);function r(){var t=new n.WT(3);return n.WT!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function o(t,e,i){var r=new n.WT(3);return r[0]=t,r[1]=e,r[2]=i,r}function s(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function a(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function u(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t}function c(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function h(t,e){var i=e[0],n=e[1],r=e[2],o=i*i+n*n+r*r;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function f(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[0],a=i[1],u=i[2];return t[0]=r*u-o*a,t[1]=o*s-n*u,t[2]=n*a-r*s,t}function l(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[3]*n+i[7]*r+i[11]*o+i[15];return s=s||1,t[0]=(i[0]*n+i[4]*r+i[8]*o+i[12])/s,t[1]=(i[1]*n+i[5]*r+i[9]*o+i[13])/s,t[2]=(i[2]*n+i[6]*r+i[10]*o+i[14])/s,t}function v(t,e,i){var n=e[0],r=e[1],o=e[2];return t[0]=n*i[0]+r*i[3]+o*i[6],t[1]=n*i[1]+r*i[4]+o*i[7],t[2]=n*i[2]+r*i[5]+o*i[8],t}function d(t,e,i){var n=i[0],r=i[1],o=i[2],s=i[3],a=e[0],u=e[1],c=e[2],h=r*c-o*u,f=o*a-n*c,l=n*u-r*a,v=r*l-o*f,d=o*h-n*l,m=n*f-r*h,p=2*s;return h*=p,f*=p,l*=p,v*=2,d*=2,m*=2,t[0]=a+h+v,t[1]=u+f+d,t[2]=c+l+m,t}function m(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[0],o[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),o[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t}function p(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),o[1]=r[1],o[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t}function g(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),o[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),o[2]=r[2],t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t}function x(t,e){var i=t[0],n=t[1],r=t[2],o=e[0],s=e[1],a=e[2],u=Math.sqrt(i*i+n*n+r*r)*Math.sqrt(o*o+s*s+a*a),c=u&&function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}var M=a;!function(){var t=r()}()}}]);
//# sourceMappingURL=43574.bf5f47da.chunk.js.map