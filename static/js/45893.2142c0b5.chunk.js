"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[45893,86818],{45893:(t,e,s)=>{s.r(e),s.d(e,{AppSmartDrawing:()=>o});var i=s(86818),r=s(87968);class o{constructor(t){this.rendererCanvas=void 0,this.smartDrawing=void 0,this.vec=[],this.divHost=void 0,this.divText=void 0,this.render=t=>{for(let e=0;e<this.vec.length;++e)t.fillStyle="rgba(255, 0, 0, 0.15)",t.beginPath(),t.arc(this.vec[e][0],this.vec[e][1],5,0,2*Math.PI),t.closePath(),t.fill()},this.mouseDrag=(t,e)=>{this.vec.push([t,e])},this.mouseUp=(t,e)=>{this.Predict(this.vec),this.vec=[]},this.divHost=document.getElementById(t);const e=document.createElement("div");this.divHost.appendChild(e),e.style.alignItems="center",e.style.marginTop="80px",e.style.marginLeft="auto",e.style.marginRight="auto",e.style.width="300px",e.style.height="400px",this.smartDrawing=new i.SmartDrawing,this.rendererCanvas=new r.RendererCanvas(e),this.rendererCanvas.canvas.style.position="unset",this.rendererCanvas.canvas.width=300,this.rendererCanvas.canvas.height=300,this.rendererCanvas.canvas.style.background="#999",this.divText=document.createElement("div"),this.divText.textContent="*** FROM DEEP LEARNING MODEL B ***",e.append(this.divText),this.rendererCanvas.start(),this.rendererCanvas.render=t=>this.render(t),this.rendererCanvas.mouseDrag=(t,e)=>this.mouseDrag(t,e),this.rendererCanvas.mouseUp=(t,e)=>this.mouseUp(t,e)}Predict(t){const e=[];for(let n of t)e.push(new r.Vector3(n[0],n[1],0));const s=n(e),i=(0,r.getInterpolatedArray)(s,501),o=this.smartDrawing.predictByLogisticRegression(i);console.debug("pridiction:%c ".concat(o," from LR Model"),"background: #ddb137; color: black");const[a,d]=this.smartDrawing.predictByMultiClassification(i);return console.debug("pridiction:%c ".concat(a," from MC model"),"background: #4e2c7e; color: white"),this.updateDivWithText(d),a}updateDivWithText(t){let e="<p>*** FROM DEEP LEARNING MODEL B *** </p>";for(let s=0;s<t.length;++s)e+="<p> ".concat(t[s],"</p>");this.divText.innerHTML=e}destroy(){try{for(;void 0!==this.divHost&&void 0!==this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}catch(t){}}}const n=t=>{let e=[];for(let s=0;s<t.length;++s)if(s<t.length-1){let i=new r.Vector3(t[s].x,t[s].y,t[s].z),o=new r.Vector3(t[s+1].x,t[s+1].y,t[s+1].z);o.x-=i.x,o.y-=i.y,o.z-=i.z;let n=(0,r.dotProduct)(new r.Vector3(1,0,0),(0,r.normalize)(o));Number.isNaN(n)?e.push(e[e.length-1]):e.push(n)}else{let i=new r.Vector3(t[s].x,t[s].y,t[s].z),o=new r.Vector3(t[0].x,t[0].y,t[0].z);o.x-=i.x,o.y-=i.y,o.z-=i.z;let n=(0,r.dotProduct)(new r.Vector3(1,0,0),(0,r.normalize)(o));Number.isNaN(n)?e.push(e[e.length-1]):e.push(n)}return e}},86818:(t,e,s)=>{s.r(e),s.d(e,{SmartDrawing:()=>r});var i=s(65812);class r{constructor(){this.modelLogisticRegression=void 0,this.modelMultiClassification=void 0,this.isLoaded=!1,o().then((t=>{[this.modelLogisticRegression,this.modelMultiClassification]=t,this.isLoaded=!0}))}predictByLogisticRegression(t){if(void 0!==this.modelLogisticRegression)return(0,i.tidy)((()=>{const e=(0,i.tensor2d)([t]),s=this.modelLogisticRegression.predict(e).dataSync();return this.PredictionPostProcessingLogisticRegression(s[0])}));console.error("no model loaded")}PredictionPostProcessingLogisticRegression(t){const e=Math.floor(t+.5);return r.CLASS_TYPE[e]}predictByMultiClassification(t){if(void 0!==this.modelMultiClassification)return(0,i.tidy)((()=>{const e=i.tensor2d([t]),s=this.modelMultiClassification.predict(e),o=[];{const t=Array.from(s.dataSync()),e=n(t);for(let s of e){const e=t[s],i="class:"+r.CLASS_TYPE[s]+", probability:"+e.toFixed(5);o.push(i)}}const a=s.argMax(-1).dataSync()[0];return[r.CLASS_TYPE[a],o]}));console.error("no model loaded")}}r.CLASS_TYPE={0:"CIRCLE",1:"TRI-GON",2:"ARROW_SINGLE",3:"ARROW_DOUBLE",4:"RECTANGLE",5:"TEXT",6:"CURVE",7:"HEART",8:"CLOUD"};const o=async()=>{let t="https://raw.githubusercontent.com/NamjuLee/data/master/smart-drawing/model/modelLogisticRegression0/model.json";const e=await(0,i.loadLayersModel)(t);t="https://raw.githubusercontent.com/NamjuLee/data/master/smart-drawing/model/modelMultiClassification0/model.json";return[e,await(0,i.loadLayersModel)(t)]},n=t=>{const e=new Array(t.length);for(let s=0;s<t.length;++s)e[s]=s;return e.sort(((e,s)=>t[e]>t[s]?-1:t[e]<t[s]?1:0)),e}}}]);
//# sourceMappingURL=45893.2142c0b5.chunk.js.map