"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[13012],{13012:(t,e,s)=>{s.r(e),s.d(e,{Solution:()=>h});var o=s(17760),r=s(55913),i=s(87968);class h extends r.TF{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main"),this.streetOSM=[],this.routesTreated=[],this.routesControl=[],this.zones30=[],this.meshStreet=void 0,this.meshSpike=void 0,this.raycaster=new o.iMs,this.pointer=new o.FM8,this.sphere=void 0;const t=new o.cek(16777215,.8);this.camera.add(t),this.scene.add(t),this.raycaster=new o.iMs,this.raycaster.params.Line.threshold=3,this.raycaster.far=1e3;const e=new o.xo$(.2,32,32),s=new o.vBJ({color:16777215}),r=new o.Kj0(e,s);this.sphere=r,this.scene.add(r),this.camera.position.set(0,20,20),(0,i.getJSONFromURL)("https://raw.githubusercontent.com/NamjuLee/data/master/Paris/street_osm.geojson").then((t=>{for(let e=0;e<t.features.length;++e)this.streetOSM.push(t.features[e].geometry.coordinates);this.meshStreet=a(this.scene,this.streetOSM,[0,1,1]),(0,i.getJSONFromURL)("https://raw.githubusercontent.com/NamjuLee/data/master/Paris/treated-st.geojson").then((t=>{for(let e=0;e<t.features.length;++e)this.routesTreated.push(t.features[e].geometry.coordinates);this.meshSpike=n(this.scene,this.routesTreated,[1,0,0])})),(0,i.getJSONFromURL)("https://raw.githubusercontent.com/NamjuLee/data/master/Paris/control-st.geojson").then((t=>{for(let e=0;e<t.features.length;++e)this.routesControl.push(t.features[e].geometry.coordinates);a(this.scene,this.routesControl,[0,1,0])})),this.start()}))}update(t){this.raycaster.setFromCamera(this.pointer,this.camera);const e=this.raycaster.intersectObjects([this.meshStreet,this.meshSpike],!0);e.length>0?(this.sphere.visible=!0,this.sphere.position.copy(e[0].point)):this.sphere.visible=!1;for(let s=1;s<this.meshSpike.geometry.attributes.position.count;s+=2){let t=this.meshSpike.geometry.attributes.position,e=t.getX(s),r=t.getY(s),h=t.getZ(s);r=9*Math.sin(5*e*h+5*this.t),r=r<0?0:r;let n=new o.Pa4(e,r,h);this.meshSpike.geometry.attributes.position.setXYZ(s,n.x,n.y,n.z);(0,i.getColorByCelsius)(40*r);this.meshSpike.geometry.attributes.color.setXYZ(s-1,0,r,0),this.meshSpike.geometry.attributes.color.setXYZ(s,r,0,0)}this.meshSpike.geometry.attributes.position.needsUpdate=!0,this.meshSpike.geometry.attributes.color.needsUpdate=!0,this.meshSpike.geometry.computeVertexNormals()}mouseMove(t){this.pointer.x=(t.offsetX+2)/this.hostDiv.clientWidth*2-1,this.pointer.y=-(t.offsetY-70)/this.hostDiv.clientHeight*2+1}}const n=(t,e,s)=>{const i=new o.u9r,h=new o.nls({vertexColors:!0}),n=[],a=[];let u=0,c=0,l=0;for(let o=0;o<e.length;++o){const t=e[o];for(let e=0;e<t.length;++e)for(let o=0;o<t[e].length;++o){const[i,h]=(0,r._Y)(t[e][o][0],t[e][o][1]);u+=i,c+=h,l+=1;const p=.01*(i+-15478803.88731685),m=.01*(h+-4766681.448690384);n.push(p,0,m),n.push(p,10,m),a.push(s[0],s[1],s[2]),a.push(s[0],s[1],s[2])}}i.setAttribute("position",new o.a$l(n,3)),i.setAttribute("color",new o.a$l(a,3)),i.computeBoundingSphere();const p=new o.ejS(i,h);return t.add(p),p},a=(t,e,s)=>{const i=new o.u9r,h=new o.nls({vertexColors:!0}),n=[],a=[],u=[];let c=0,l=0,p=0;for(let o=0;o<e.length;++o){const t=e[o];for(let e=0;e<t.length;++e)for(let o=0;o<t[e].length;++o){const[i,h]=(0,r._Y)(t[e][o][0],t[e][o][1]);c+=i,l+=h,p+=1;const m=.01*(i+-15478803.88731685),g=.01*(h+-4766681.448690384);n.push(m,0,g),a.push(s[0],s[1],s[2]),o<t[e].length-1&&u.push(Math.floor(n.length/3)-1,Math.floor(n.length/3))}}i.setIndex(u),i.setAttribute("position",new o.a$l(n,3)),i.setAttribute("color",new o.a$l(a,3)),i.computeBoundingSphere();const m=new o.ejS(i,h);return t.add(m),m}}}]);
//# sourceMappingURL=13012.4aee5448.chunk.js.map