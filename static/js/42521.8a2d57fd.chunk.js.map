{"version":3,"file":"static/js/42521.8a2d57fd.chunk.js","mappings":"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","sources":["njslab/Workshop/workshop-graph/07_Graph-modify/index.ts"],"sourcesContent":["import { RendererCanvas } from '../../../../lib';\r\n\r\nexport class Solution extends RendererCanvas {\r\n    divText: HTMLDivElement;\r\n    divSel: HTMLDivElement;\r\n    graphController: GraphController;\r\n\r\n\r\n    constructor(id: string) {\r\n        super(document.getElementById(id) as HTMLDivElement);\r\n\r\n        this.canvas.style.position = 'absolute'\r\n        const divMenu = document.createElement('div');\r\n        divMenu.style.position = 'absolute'\r\n        this.divHost.appendChild(divMenu);\r\n\r\n        const divBtn = document.createElement('button');\r\n        divBtn.textContent = 'run'\r\n        divBtn.onclick = () => {\r\n            this.graphController.needPopulate = !this.graphController.needPopulate;\r\n        }\r\n        divMenu.appendChild(divBtn);\r\n\r\n        const divRemove = document.createElement('button');\r\n        divRemove.textContent = 'remove'\r\n        divRemove.onclick = () => {\r\n            this.graphController.removeSelection();\r\n        }\r\n        divMenu.appendChild(divRemove);\r\n\r\n        const divText = document.createElement('div');\r\n        divText.textContent = 'N:0, E:0'\r\n        divMenu.appendChild(divText);\r\n        this.divText = divText;\r\n\r\n        const divSel = document.createElement('div');\r\n        divSel.textContent = 'undefined'\r\n        divMenu.appendChild(divSel);\r\n        this.divSel = divSel;\r\n\r\n        const divDes = document.createElement('div');\r\n        divDes.innerHTML = '1 Add a node on edge <br> 2 Remove a selected node ';\r\n        divMenu.appendChild(divDes);\r\n\r\n        this.init();\r\n    }\r\n    public init() {\r\n        // TODO\r\n        this.graphController = new GraphController(this.canvas);\r\n        this.graphController.divLog = this.divText;\r\n        this.graphController.divSel = this.divSel;\r\n        this.mouseClick(200, 200);\r\n\r\n        this.start()\r\n    }\r\n\r\n    public render(ctx: CanvasRenderingContext2D): void {\r\n        this.graphController.render(ctx);\r\n    }\r\n    public mouseClick(x: number, y: number): void {\r\n\r\n\r\n        this.graphController.mouseClick(x, y);\r\n    }\r\n    public mouseDown(x: number, y: number): void {\r\n        this.graphController.mouseDown(x, y)\r\n    }\r\n    public mouseMove(x: number, y: number): void {\r\n        this.graphController.mouseMove(x, y);\r\n    }\r\n    public mouseDrag(x: number, y: number): void {\r\n        this.graphController.mouseDrag(x, y)\r\n    }\r\n    public mouseUp() {\r\n        this.graphController.mouseUp();\r\n    }\r\n}\r\n\r\n\r\nclass GraphController {\r\n    public graph: Graph;\r\n    public canvas: HTMLCanvasElement;\r\n    public divLog: HTMLDivElement;\r\n    public divSel: HTMLDivElement;\r\n\r\n    public needPopulate = false;\r\n    public m = new Vector3(0, 0, 0);\r\n\r\n    private nodePre: Node | Edge | undefined = undefined\r\n\r\n    constructor(canvas: HTMLCanvasElement) {\r\n        this.graph = new Graph();\r\n        this.canvas = canvas;\r\n    }\r\n    public populate() {\r\n        const x = Math.random() * this.canvas.width;\r\n        const y = Math.random() * this.canvas.height;\r\n        this.mouseClick(x, y);\r\n    }\r\n    public removeSelection() {\r\n        // console.log(this.graph.captured)\r\n        if (this.graph.captured) {\r\n            this.graph.captured.remove();\r\n            this.graph.captured = undefined;\r\n        }\r\n    }\r\n    // ..........................................................\r\n    public mouseDown(x: number, y: number): void {\r\n        const node = this.graph.getNodeVec(x, y);\r\n\r\n        if (this.graph.captured &&  this.graph.captured !== node ) {\r\n            this.nodePre = this.graph.captured;\r\n        };\r\n\r\n        this.graph.captured = node\r\n    }\r\n\r\n    public mouseClick(x: number, y: number): void {\r\n\r\n        if (this.nodePre &&  this.graph.captured) {\r\n            // console.log('connection needed')\r\n            this.graph.addEdge(this.nodePre as Node, this.graph.captured as Node)\r\n            return;\r\n        }\r\n\r\n\r\n\r\n        const closeEdge = this.graph.getEdgeVec(x, y);\r\n\r\n        // connect selected nodes\r\n\r\n\r\n        // add node by edge\r\n        if (closeEdge && this.graph.captured === undefined) {\r\n            const node = this.graph.addNode(closeEdge.vec.x, closeEdge.vec.y);\r\n            this.graph.edgeSplitByNode(node, closeEdge.edge);\r\n            return\r\n        }\r\n\r\n        if (this.graph.captured === undefined) {\r\n            // console.log(this.graph.captured)\r\n            const node = this.graph.addNode(x, y, 0);\r\n            this.graph.addEdgeClosestByNode(node);\r\n        } \r\n    }\r\n\r\n    public mouseMove(x: number, y: number): void {\r\n        this.m.x = x;\r\n        this.m.y = y;\r\n    }\r\n    public mouseUp() {\r\n        if (this.graph.captured && this.graph.captured.type === 'node') {\r\n            const node = this.graph.captured as Node;\r\n            node.edges.forEach((e, i) => {\r\n                setTimeout(() => {\r\n                    this.graph.edgeSplitByEdge(e)\r\n                }, 50);\r\n\r\n            })\r\n        }\r\n    }\r\n    public mouseDrag(x: number, y: number): void {\r\n        if (this.graph.captured && this.graph.captured.type === 'node') {\r\n            const node = this.graph.captured as Node;\r\n            node.vec.x = x;\r\n            node.vec.y = y;\r\n        }\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D) {\r\n        if (this.needPopulate) {\r\n            this.populate();\r\n        }\r\n\r\n        this.graph.render(ctx);\r\n\r\n        this.divLog.textContent = this.graph.log;\r\n        // this.divSel.textContent = JSON.stringify(this.graph.captured);\r\n\r\n        if (this.graph.captured) {\r\n            this.divSel.textContent = this.graph.captured.type;\r\n        } else {\r\n            this.divSel.textContent = 'undefined';\r\n        }\r\n\r\n        ctx.beginPath();\r\n        ctx.arc(this.m.x, this.m.y, 2, 0, 3.14 * 2);\r\n        ctx.closePath();\r\n        ctx.fillStyle = '#888';\r\n        ctx.fill();\r\n\r\n\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nclass Graph {\r\n    public log: string = '';\r\n    public nodes: Node[] = [];\r\n    public edges: Edge[] = [];\r\n\r\n    private _captured: Node | Edge | undefined = undefined;\r\n    constructor() {\r\n\r\n    }\r\n    public updatePost() {\r\n        // this.divLog.textContent = `N:${this.nodes.length}, E:${this.edges.length}`;\r\n    }\r\n    public get captured() {\r\n        return this._captured\r\n    }\r\n    public set captured(v) {\r\n        if (this._captured) {\r\n            this._captured.isSelected = false;\r\n        }\r\n\r\n        this._captured = v;\r\n        if (v) {\r\n            this._captured.isSelected = true;\r\n        }\r\n\r\n    }\r\n    public addNode(x: number, y: number, z: number = 0) {\r\n        // console.trace()\r\n        const node = new Node(this, x, y, 0);\r\n        this.nodes.push(node);\r\n        this.updatePost();\r\n        return node;\r\n    }\r\n    public addEdgeClosestByNode(node: Node) {\r\n        const nn = this.getNode(node);\r\n        if (nn) this.addEdge(node, nn);\r\n    }\r\n    public addEdge(n0: Node, n1: Node) {\r\n        const edge = new Edge(n0, n1);\r\n        n0.edges.push(edge);\r\n        n1.edges.push(edge);\r\n        this.edges.push(edge);\r\n\r\n        this.edgeSplitByEdge(edge);\r\n        this.updatePost();\r\n        return edge;\r\n    }\r\n    public edgeSplitByNode(node: Node, edge:Edge) {\r\n        const n0 = edge.n0;\r\n        const n1 = edge.n1;\r\n\r\n        this.addEdge(n0, node);\r\n        this.addEdge(node, n1);\r\n\r\n        this.removeEdge(edge);\r\n    }\r\n    public edgeSplitByEdge(edge: Edge) {\r\n        const nodes: Node[] = [];\r\n        for (let i = this.edges.length - 1; i > -1; --i) {\r\n            const other = this.edges[i];\r\n            // if (edge === other) continue;\r\n            if (edge.n0 !== other.n0 && edge.n0 !== other.n1 && edge.n1 !== other.n0 && edge.n1 !== other.n1) {\r\n                const inter = getIntersectEdge(edge, other);\r\n                if (inter) {\r\n                    const nn = new Node(this, inter[0], inter[1])\r\n                    this.nodes.push(nn);\r\n                    this.addEdgeSlipt(nn, other.n0);\r\n                    this.addEdgeSlipt(nn, other.n1);\r\n                    this.removeEdge(other);\r\n                    nodes.push(nn);\r\n                }\r\n            }\r\n        }\r\n        // console.log('dd', nodes.length);\r\n        if (nodes.length > 0) {\r\n            let nodeFirst = edge.n0;\r\n            nodes.push(edge.n1);\r\n            const disList = nodes.map((n) => { return distance(n.vec, edge.n0.vec); });\r\n            const indices = disList.map((val, index) => index);\r\n            const sortedDis = indices.sort((a, b) => disList[a] - disList[b]);\r\n            this.addEdgeSlipt(nodeFirst, nodes[sortedDis[0]]);\r\n            for (let i = 0; i < sortedDis.length - 1; ++i) {\r\n                this.addEdgeSlipt(nodes[sortedDis[i]], nodes[sortedDis[i + 1]]);\r\n            }\r\n            this.removeEdge(edge);\r\n        }\r\n    }\r\n    public addEdgeSlipt(n0: Node, n1: Node) {\r\n        const edge = new Edge(n0, n1);\r\n        n0.edges.push(edge);\r\n        n1.edges.push(edge);\r\n        this.edges.push(edge);\r\n        return edge;\r\n    }\r\n    public removeEdge(other) {\r\n        other.n0.removeEdge(other);\r\n        other.n1.removeEdge(other);\r\n        this.edges.splice(this.edges.indexOf(other), 1);\r\n    }\r\n    public removeNode(node: Node) {\r\n        node.edges.forEach((edge) => {\r\n            setTimeout(() => {\r\n                this.removeEdge(edge)\r\n            }, 50);\r\n        })\r\n        this.nodes.splice(this.nodes.indexOf(node), 1);\r\n    }\r\n    public getNode(node: Node) {\r\n        let theDis = Number.MAX_VALUE;\r\n        let index = -1;\r\n        for (let i = 0; i < this.nodes.length; ++i) {\r\n            if (this.nodes[i] === node) continue;\r\n            const vec = this.nodes[i].vec;\r\n            const dis = distance(vec, node.vec)\r\n            if (theDis > dis) {\r\n                theDis = dis;\r\n                index = i;\r\n            }\r\n        }\r\n        if (index > -1) { return this.nodes[index]; }\r\n        return undefined;\r\n    }\r\n    public getNodeVec(x: number, y: number, minDis = 8) {\r\n        let theDis = Number.MAX_VALUE;\r\n        let index = -1;\r\n        const v = new Vector3(x, y)\r\n        for (let i = 0; i < this.nodes.length; ++i) {\r\n            const vec = this.nodes[i].vec;\r\n            const dis = distance(vec, v)\r\n            if (theDis > dis) {\r\n                theDis = dis;\r\n                index = i;\r\n            }\r\n        }\r\n        if (index > -1 && theDis < minDis) { return this.nodes[index]; }\r\n        return undefined;\r\n    }\r\n    public getEdgeVec(x: number, y: number, minDis = 8) {\r\n        const mv = new Vector3(x, y, 0)\r\n        for (let i = 0; i < this.edges.length; ++i) {\r\n            const edge = this.edges[i];\r\n            const cp = pointOnLine(mv, edge.n0.vec, edge.n1.vec)\r\n\r\n            const dis = distance(mv, cp);\r\n            if (dis < minDis) {\r\n                return { edge, vec: cp}\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D): void {\r\n        this.log = `N:${this.nodes.length}, E:${this.edges.length}`;\r\n        // console.log(`N:${this.nodes.length}, E:${this.edges.length}`)\r\n        this.edges.forEach((e: Edge) => { e.render(ctx); })\r\n        this.nodes.forEach((n: Node) => { n.render(ctx); })\r\n    }\r\n}\r\n\r\nclass Edge {\r\n    public type = 'edge'\r\n    public n0: Node;\r\n    public n1: Node;\r\n    public isSelected = false;\r\n    constructor(n0: Node, n1: Node) {\r\n        this.n0 = n0;\r\n        this.n1 = n1;\r\n    }\r\n    public remove() {\r\n        this.n0.removeEdge(this);\r\n        this.n1.removeEdge(this);\r\n    }\r\n    public render(ctx) {\r\n        if (this.isSelected) {\r\n            ctx.lineWidth = 3;\r\n            ctx.strokeStyle = '#00f';\r\n            ctx.beginPath();\r\n            ctx.moveTo(this.n0.vec.x, this.n0.vec.y);\r\n            ctx.lineTo(this.n1.vec.x, this.n1.vec.y);\r\n            ctx.stroke();\r\n        }\r\n        ctx.lineWidth = 1;\r\n        ctx.beginPath();\r\n        ctx.moveTo(this.n0.vec.x, this.n0.vec.y);\r\n        ctx.lineTo(this.n1.vec.x, this.n1.vec.y);\r\n        ctx.strokeStyle = '#0f0';\r\n        ctx.stroke();\r\n    }\r\n}\r\n\r\nclass Node {\r\n    public type = 'node'\r\n    public graph: Graph;\r\n    public vec: Vector3;\r\n    public r: number = 5;\r\n    public edges: Edge[] = [];\r\n    public isSelected = false;\r\n    constructor(graph: Graph, x: number, y: number, z: number = 0) {\r\n        this.graph = graph;\r\n        this.vec = new Vector3(x, y, z);\r\n    }\r\n    public remove() {\r\n        this.graph.removeNode(this);\r\n    }\r\n    public removeEdge(other) {\r\n        this.edges.splice(this.edges.indexOf(other), 1);\r\n    }\r\n    public render(ctx: CanvasRenderingContext2D) {\r\n        ctx.beginPath();\r\n        ctx.arc(this.vec.x, this.vec.y, this.r, 0, 3.14 * 2)\r\n        ctx.closePath();\r\n        ctx.fillStyle = '#ff0000';\r\n        ctx.fill();\r\n        if (this.isSelected) {\r\n            ctx.lineWidth = 3;\r\n            ctx.strokeStyle = '#00f';\r\n            ctx.stroke();\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass Vector3 {\r\n    public x: number;\r\n    public y: number;\r\n    public z: number;\r\n    constructor(x: number, y: number, z: number = 0) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z\r\n    }\r\n}\r\n\r\nconst distance = (v0: Vector3, v1: Vector3) => {\r\n    return Math.sqrt(distance2(v0, v1));\r\n}\r\nconst distance2 = (v0: Vector3, v1: Vector3) => {\r\n    return (v0.x - v1.x) * (v0.x - v1.x) + (v0.y - v1.y) * (v0.y - v1.y) + (v0.z - v1.z) * (v0.z - v1.z);\r\n}\r\n\r\nconst getIntersectEdge = (e0: Edge, e1: Edge) => {\r\n    return getIntersect(e0.n0, e0.n1, e1.n0, e1.n1)\r\n}\r\n\r\nconst getIntersect = (n0: Node, n1: Node, n2: Node, n3: Node) => {\r\n    return getLineIntersectPlane(n0.vec.x, n0.vec.y, n1.vec.x, n1.vec.y, n2.vec.x, n2.vec.y, n3.vec.x, n3.vec.y)\r\n}\r\n\r\nconst getLineIntersectPlane = (x1: number, y1: number, x2: number, y2: number, x3: number, y3: number, x4: number, y4: number) => {\r\n    // Check if none of the lines are of length 0\r\n    if ((x1 === x2 && y1 === y2) || (x3 === x4 && y3 === y4)) {\r\n        return undefined;\r\n    }\r\n\r\n    const denominator = ((y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1));\r\n\r\n    // Lines are parallel\r\n    if (denominator === 0) {\r\n        return undefined;\r\n    }\r\n\r\n    const ua = ((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / denominator;\r\n    const ub = ((x2 - x1) * (y1 - y3) - (y2 - y1) * (x1 - x3)) / denominator;\r\n\r\n    // is the intersection along the segments\r\n    if (ua < 0 || ua > 1 || ub < 0 || ub > 1) {\r\n        return undefined;\r\n    }\r\n\r\n    // Return a object with the x and y coordinates of the intersection\r\n    const x = x1 + ua * (x2 - x1);\r\n    const y = y1 + ua * (y2 - y1);\r\n\r\n    return [x, y];\r\n};\r\n\r\nconst lerp = (a: number, b: number, t: number) => { return a + t * (b - a); }\r\n\r\nconst pointOnLine = (p: Vector3, p0: Vector3, p1: Vector3) => {\r\n    let dx = p1.x - p0.x,\r\n        dy = p1.y - p0.y,\r\n        t = ((p.x - p0.x) * dx + (p.y - p0.y) * dy) / (dx * dx + dy * dy),\r\n        x = lerp(p0.x, p1.x, t),\r\n        y = lerp(p0.y, p1.y, t);\r\n    return new Vector3(x, y);\r\n}"],"names":["Solution","RendererCanvas","constructor","id","super","document","getElementById","divText","divSel","graphController","this","canvas","style","position","divMenu","createElement","divHost","appendChild","divBtn","textContent","onclick","needPopulate","divRemove","removeSelection","divDes","innerHTML","init","GraphController","divLog","mouseClick","start","render","ctx","x","y","mouseDown","mouseMove","mouseDrag","mouseUp","graph","m","Vector3","nodePre","undefined","Graph","populate","Math","random","width","height","captured","remove","node","getNodeVec","addEdge","closeEdge","getEdgeVec","addNode","vec","edgeSplitByNode","edge","addEdgeClosestByNode","type","edges","forEach","e","i","setTimeout","edgeSplitByEdge","log","beginPath","arc","closePath","fillStyle","fill","nodes","_captured","updatePost","v","isSelected","Node","push","nn","getNode","n0","n1","Edge","removeEdge","length","other","inter","getIntersectEdge","addEdgeSlipt","nodeFirst","disList","map","n","distance","sortedDis","val","index","sort","a","b","splice","indexOf","removeNode","theDis","Number","MAX_VALUE","dis","minDis","mv","cp","pointOnLine","lineWidth","strokeStyle","moveTo","lineTo","stroke","z","r","v0","v1","sqrt","distance2","e0","e1","getIntersect","n2","n3","getLineIntersectPlane","x1","y1","x2","y2","x3","y3","x4","y4","denominator","ua","ub","lerp","t","p","p0","p1","dx","dy"],"sourceRoot":""}