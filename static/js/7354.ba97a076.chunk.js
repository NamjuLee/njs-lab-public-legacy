"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[7354],{7354:(t,s,i)=>{i.r(s),i.d(s,{Solution:()=>m});var e=i(5483),o=i.n(e);class a{constructor(t){var s=this;this.solution=void 0,this.map=void 0,this.canvasMapbox=void 0,this.center=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-99.292649,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:39.043903;new(o().LngLat)(t,i);s.map.setCenter({lat:i,lng:t})},this.toMap=(t,s)=>{const i=this.map.unproject({x:t,y:s});return[i.lng,i.lat]},this.toScreen=(t,s)=>{const i=this.map.project([t,s]);return[i.x,i.y]},this.mouseDown=t=>{},this.mouseUp=t=>{},this.mouseMove=t=>{},this.mouseClick=t=>{},this.mouseDClick=t=>{},this.solution=t,this.initMap(t.divHost.id)}initMap(t){o().accessToken="pk.eyJ1IjoiZGVzaWduanUiLCJhIjoiY2xhNGU0YWo4MDlhYzNwdHBwenVvang4eiJ9.P3sX4l_3KjdPeRRbVS1VVg",this.map=new(o().Map)({preserveDrawingBuffer:!0,container:t,zoom:6,center:[-77.430815,37.801833],style:"mapbox://styles/mapbox/dark-v10"}),this.map.dragRotate.disable(),this.map.on("mousemove",(t=>{this.mouseMove(t)})),this.map.on("click",(t=>{this.mouseClick(t)})),this.map.on("mousedown",(t=>{this.mouseDown(t)})),this.map.on("dblclick",(t=>{this.mouseDClick(t)})),this.map.on("mouseup",(t=>{this.mouseUp(t)})),window.addEventListener("keydown",(t=>{}));let s=document.getElementsByClassName("mapboxgl-canvas")[0];s.style.position="absolute",s=document.getElementsByClassName("mapboxgl-control-container")[0],s.style.display="none",this.map.on("load",(()=>{this.initPost()}))}initPost(){this.solution.initPost(),this.canvasMapbox=this.map.getCanvas()}initCustomCanvas(){this.solution.renderer.canvas.width=this.canvasMapbox.width,this.solution.renderer.canvas.height=this.canvasMapbox.height,this.solution.renderer.canvas.style.display="none";this.map.getBounds();this.map.addSource("canvas-source",{type:"canvas",canvas:this.solution.renderer.canvas,coordinates:[[-125.618336,48.944262],[-125.618336,24.786775],[-65.591812,24.786775],[-65.591812,48.944262]],animate:!0}),this.map.addLayer({id:"canvas-layer",type:"raster",source:"canvas-source"})}downloadImage(){!function(t,s){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"map.png",e=document.createElement("canvas");e.width=t.width,e.height=t.height;let o=e.getContext("2d");o.globalAlpha=1,o.drawImage(t,0,0),o.drawImage(s,0,0,t.width,t.height);let a=new Image;a.width=t.width,a.height=t.height,a.src=e.toDataURL();let n=document.createElement("a");n.download=i,n.href=e.toDataURL(),n.click()}(this.map.getCanvas(),this.solution.renderer.canvas)}}var n=i(72070),h=i(88410),r=i(99764);class p{constructor(t){this.solution=void 0,this.deckLayer=void 0,this.deckLayer2=void 0,this.map=void 0,this.solution=t}initPost(){this.map=this.solution.mapboxWrapper.map,this.deckLayer=new n.Z({id:"my-scatterplot",type:h.Z,data:[{position:[-74.5,40],size:1e4},{position:[-74.5,40.5],size:5e3},{position:[-74.6,40.5],size:5800},{position:[-74.7,40.5],size:100}],getPosition:t=>t.position,getRadius:t=>t.size,getFillColor:t=>[255,140,0],getLineColor:t=>[255,255,0]}),this.map.addLayer(this.deckLayer,"waterway-label");this.deckLayer2=new n.Z({id:"my-scatterplot2",type:r.Z,data:[{pickup:[-122.42,37.8],dropoff:[-74.5,40.5]},{pickup:[-122.43,37.8],dropoff:[-122.42,37.75]}],getSourcePosition:t=>t.pickup,getTargetPosition:t=>t.dropoff,getSourceColor:t=>[255,128,0],getTargetColor:t=>[0,128,255],strokeWidth:5}),this.map.addLayer(this.deckLayer2)}}var d=i(55913);class l extends d.bb{constructor(t,s){super(t),this.app=void 0,this.time=0,this.pts=[],this.isActive=!1,this.mouseDown=(t,s)=>{},this.mouseUp=(t,s)=>{},this.mouseDrag=(t,s)=>{},this.app=s,this.canvas.id="mapboxCustom",this.canvas.style.position="absolute",this.canvas.style.pointerEvents="none",this.canvas.style.mixBlendMode="color-dodge",this.start()}initPost(){this.ctx.globalCompositeOperation="color-dodge",this.isActive=!0}render(t){if(!this.isActive)return;this.time+=.1;const s=this.app.mapboxWrapper.map.getZoom(),i=.1*Math.pow(2,s);for(let e=0;e<this.pts.length;++e){const s=this.pts[e],o=this.app.mapboxWrapper.toScreen(s[0],s[1]),a=.25*i;t.beginPath(),t.arc(o[0],o[1],a+(Math.sin(this.time+e)+3)*i,0,2*Math.PI),t.closePath(),t.fillStyle="rgba(0, 255, 0, 0.7)",t.fill()}}}class c{constructor(t){this.solution=void 0,this.divHost=void 0,this.solution=t,this.divHost=t.divHost,this.initUI()}initUI(){const t=document.createElement("div");this.divHost.appendChild(t);const s=document.createElement("div");s.textContent="download",s.style.position="relative",s.style.margin="10px",s.onclick=()=>{this.solution.mapboxWrapper.downloadImage()},t.appendChild(s)}}class m{constructor(t){this.divHost=void 0,this.mapboxWrapper=void 0,this.deckGL=void 0,this.renderer=void 0,this.uiWrapper=void 0,this.mouseDown=t=>{},this.mouseUp=t=>{},this.mouseDrag=t=>{},this.mouseClick=t=>{this.renderer.pts.push([t.lngLat.lng,t.lngLat.lat])},this.mouseMove=t=>{},this.divHost=document.getElementById(t),this.divHost.style.position="relative",this.deckGL=new p(this),this.mapboxWrapper=new a(this),this.mapboxWrapper.mouseDown=this.mouseDown,this.mapboxWrapper.mouseUp=this.mouseUp,this.mapboxWrapper.mouseClick=this.mouseClick,this.mapboxWrapper.mouseMove=this.mouseMove,this.renderer=new l(this.divHost,this),this.uiWrapper=new c(this)}initPost(){this.renderer.initPost(),this.deckGL.initPost()}keyDown(t){}destroy(){for(this.renderer.destroy();this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}}}}]);
//# sourceMappingURL=7354.ba97a076.chunk.js.map