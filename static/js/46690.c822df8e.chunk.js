"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[46690],{46690:(t,s,i)=>{i.r(s),i.d(s,{Edge:()=>n,Graph:()=>h,Node:()=>o});var e=i(458);class h{constructor(){this.nodes=[],this.edges=[],this.dt=0,this.mouse=new e.h9(0,0),this.damping=.96,this.gravity=-.032,this.timeStep=.16,this.groundZ=-9.26,this.capture=void 0}Init(t,s){this.InitGridR(t,s),this.nodes[0].fixed=!0,this.nodes[9].fixed=!0,this.nodes[this.nodes.length-1].fixed=!0,this.nodes[this.nodes.length-1-9].fixed=!0}updateOptionA(t){this.damping=.1*t,console.log(this.damping,"damping")}updateOptionB(t){this.timeStep=.05*t,console.log(this.timeStep,"timeStep")}updateOptionC(t){}shrinkage(t,s){this.nodes[t].fixed=!0;for(let i=0;i<this.nodes[t].edge.length;++i)this.nodes[t].edge[i].targetLengthShrinkage(s)}InitGridR(t,s){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;const n=t/i+1,o=s/h+1,d=this.nodes.length;for(let r=0;r<h;++r)for(let h=0;h<i;++h){let i=0+n*h-.5*t,d=0+o*r-.5*s;this.AddNode(i,0,d,e.h9.Zero(),1)}for(let e=0;e<h;++e)for(let t=0;t<i;++t){let s=e*i+t;0!==t&&this.AddEdge(this.nodes[d+s-1],this.nodes[d+s]),0!==e&&this.AddEdge(this.nodes[d+s-i],this.nodes[d+s])}}Clear(){this.nodes=[],this.edges=[]}AddNode(t,s,i){let h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new e.h9(0,0,0),n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const d=new o(new e.h9(t,s,i),h,n);return this.nodes.push(d),d.id=this.nodes.length-1,d}AddEdge(t,s){const i=new n(t,s);return t.edge.push(i),s.edge.push(i),this.edges.push(i),i}MouseMove(t,s){this.mouse.x=t,this.mouse.y=s}MouseDClick(t,s){this.mouse.x=t,this.mouse.y=s;const i=this.FindNode(this.mouse);i&&(i.fixed=!i.fixed)}MouseDown(t,s){this.mouse.x=t,this.mouse.y=s,this.capture=this.FindNode(this.mouse),this.capture&&(this.capture.fixed=!0,this.capture.isCapture=!0),console.log("down",t,s,this.capture)}MouseLeftClick(t,s){console.log("click",t,s,this.capture)}MouseUp(t,s){this.mouse.x=t,this.mouse.y=s,this.capture&&(this.capture.isCapture=!1,this.capture=void 0),console.log("up",t,s)}MouseDrag(t,s){this.mouse.x=t,this.mouse.y=s,this.capture&&(this.capture.v.x=t,this.capture.v.y=s),console.log("drag",t,s)}Render(t){this.dt+=.1,this.Move(this.mouse.x,this.mouse.y,this.mouse.z,this.damping,0,this.timeStep,this.groundZ,1)}FindNode(t){for(let s of this.nodes)if(s.v.Distance(t)<s.m+3)return s}Move(t,s,i,h){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.01,d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-10,r=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1;const g=new e.h9(t,s,i);for(let a=0;a<r;++a){for(const t of this.nodes){const s=e.h9.Sub(g,t.v),i=s.Length();s.Unitize(),t.f=e.h9.Add(e.h9.Scale(s,.1*Math.exp(-.1*i*i)),e.h9.Scale(e.h9.YAxis(),n))}for(const t of this.edges)t.ApplySpringForce();for(const t of this.nodes)t.Move(o,h,d)}}}class n{constructor(t,s){this.n0=void 0,this.n1=void 0,this.targetLength=0,this.isModified=!1,this.springConstant=.8,this._targetLengthOriginal=0,this.n0=t,this.n1=s,this.targetLength=.95*this.n0.v.Distance(this.n1.v),this._targetLengthOriginal=this.targetLength}Render(t){t.strokeStyle="#ff0000",e.h9.Distance(this.n0.v,this.n1.v)<2*this.targetLength&&(t.strokeStyle="#0000ff"),t.beginPath(),t.moveTo(this.n0.v.x,this.n0.v.y),t.lineTo(this.n1.v.x,this.n1.v.y),t.closePath(),t.stroke()}targetLengthShrinkage(t){this.isModified||(this.isModified=!0,this.targetLength*=t)}ApplySpringForce(){let t=e.h9.Sub(this.n1.v,this.n0.v),s=t.Length();t.Unitize();const i=e.h9.Scale(t,(s-this.targetLength)*this.springConstant);this.n0.f=e.h9.Add(this.n0.f,i),this.n1.f=e.h9.Sub(this.n1.f,i)}}class o{constructor(t,s,i){this.id=-1,this.edge=[],this.nNodes=[],this.v=e.h9.Origin(),this.f=e.h9.Origin(),this.u=e.h9.Origin(),this.m=0,this.fixed=!1,this.isCapture=!1,this.v=new e.h9(t.x,t.y,t.z),this.u=new e.h9(s.x,s.y,s.z),this.m=i}Move(t,s){if(this.fixed||this.isCapture)return;this.u.Mult(s),this.u.Add(e.h9.Scale(this.f,t/this.m));const i=e.h9.Scale(this.u,t);this.v.x+=i.x,this.v.y+=i.y}Render(t,s){t.beginPath(),s.Distance(this.v)<this.m+3?(t.fillStyle="#000000",t.arc(this.v.x,this.v.y,this.m+6,0,2*Math.PI)):(t.fillStyle="#f90000",t.arc(this.v.x,this.v.y,this.m+3,0,2*Math.PI)),this.fixed&&(t.fillStyle="#000000",t.arc(this.v.x,this.v.y,this.m+7.5,0,2*Math.PI)),t.closePath(),t.fill()}}}}]);
//# sourceMappingURL=46690.c822df8e.chunk.js.map