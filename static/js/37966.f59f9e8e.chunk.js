"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[37966],{37966:(t,e,s)=>{s.r(e),s.d(e,{Renderer:()=>m,Solution:()=>h});var i=s(5483),o=s.n(i);class n{constructor(t){var e=this;this.map=void 0,this.center=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-99.292649,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:39.043903;e.map.setCenter({lat:s,lng:t})},this.toMap=(t,e)=>{const s=this.map.unproject({x:t,y:e});return[s.lng,s.lat]},this.toScreen=(t,e)=>{const s=this.map.project([t,e]);return[s.x,s.y]},this.mouseDown=t=>{},this.mouseUp=t=>{},this.mouseMove=t=>{},this.mouseClick=t=>{},this.mouseDClick=t=>{},this.initMap(t)}initMap(t){o().accessToken="pk.eyJ1IjoiZGVzaWduanUiLCJhIjoiY2xhNGU0YWo4MDlhYzNwdHBwenVvang4eiJ9.P3sX4l_3KjdPeRRbVS1VVg",this.map=new(o().Map)({container:t,zoom:15,pitch:60,bearing:120,center:[-71.093161,42.358871],style:"mapbox://styles/mapbox/dark-v10"}),this.map.on("mousemove",(t=>{this.mouseMove(t)})),this.map.on("click",(t=>{this.mouseClick(t)})),this.map.on("mousedown",(t=>{this.mouseDown(t)})),this.map.on("dblclick",(t=>{this.mouseDClick(t)})),this.map.on("mouseup",(t=>{this.mouseUp(t)}));let e=document.getElementsByClassName("mapboxgl-canvas")[0];e.style.position="absolute",e=document.getElementsByClassName("mapboxgl-control-container")[0],e.style.display="none"}}var a=s(55913),r=s(17760);class h{constructor(t){this.divHost=void 0,this.mapboxWrapper=void 0,this.renderer=void 0,this.mouseDown=t=>{},this.mouseUp=t=>{},this.mouseDrag=t=>{},this.mouseClick=t=>{console.log("dddd"),console.log(t),console.log(t.lngLat),this.renderer.pts.push([t.lngLat.lng,t.lngLat.lat])},this.mouseMove=t=>{},this.divHost=document.getElementById(t),this.divHost.style.position="relative",this.mapboxWrapper=new n(this.divHost.id),this.mapboxWrapper.mouseDown=this.mouseDown,this.mapboxWrapper.mouseUp=this.mouseUp,this.mapboxWrapper.mouseClick=this.mouseClick,this.mapboxWrapper.mouseMove=this.mouseMove,setTimeout((()=>{this.renderer=new m(this.divHost,this);let t=new l("box");this.mapboxWrapper.map.on("load",(()=>{this.mapboxWrapper.map.addLayer(t)})),this.mapboxWrapper.map.addLayer({id:"custom-threebox-model",type:"custom",renderingMode:"3d",onAdd:function(){},render:function(){}})}),200)}keyDown(t){}destroy(){for(this.renderer.destroy();this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}}class m extends a.bb{constructor(t,e){super(t),this.app=void 0,this.time=0,this.pts=[],this.mouseDown=(t,e)=>{},this.mouseUp=(t,e)=>{},this.mouseDrag=(t,e)=>{},this.app=e,this.canvas.id="mapboxCustom",this.canvas.style.position="absolute",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.pointerEvents="none",this.pts.push([-71.093161,42.358871]),this.start()}render(t){this.time+=.1;for(let e=0;e<this.pts.length;++e){const s=this.pts[e],i=this.app.mapboxWrapper.toScreen(s[0],s[1]);t.beginPath(),t.arc(i[0],i[1],3*Math.sin(this.time)+15,0,2*Math.PI),t.closePath(),t.fillStyle="#0f0",t.fill()}}}class l{constructor(t){this.type="custom",this.renderingMode="3d",this.id=void 0,this.camera=void 0,this.center=void 0,this.cameraTransform=void 0,this.map=void 0,this.scene=void 0,this.ball=void 0,this.controls=void 0,this.renderer=void 0,this.id=t}async onAdd(t,e){this.camera=new r.cPb(28,window.innerWidth/window.innerHeight,.1,1e6);const{MercatorCoordinate:s}=o(),i=t.getCenter();this.center=s.fromLngLat(i,0);const{x:n,y:a,z:h}=this.center;console.log(n,a,h);const m=this.center.meterInMercatorCoordinateUnits(),l=(new r.yGw).makeScale(m,m,-m),c=(new r.yGw).multiplyMatrices((new r.yGw).makeRotationX(-.5*Math.PI),(new r.yGw).makeRotationY(Math.PI));this.cameraTransform=(new r.yGw).multiplyMatrices(l,c).setPosition(n,a,h),this.map=t,this.scene=this.makeScene();var d=[Math.PI/2,0,0],p=o().MercatorCoordinate.fromLngLat([126.735901,37.34898],0),u={translateX:p.x,translateY:p.y,translateZ:p.z,rotateX:d[0],rotateY:d[1],rotateZ:d[2],scale:p.meterInMercatorCoordinateUnits()};console.log(u),this.ball=new r.Kj0(new r.xo$(100,8,8),new r.vBJ({color:"red"})),this.ball.position.set(0,0,0),this.scene.add(this.ball),this.renderer=new r.CP7({canvas:t.getCanvas(),context:e,antialias:!0}),this.renderer.autoClear=!1}makeScene(){const t=new r.xsS;t.add(new r.Mig(16777215,.25)),t.add(new r.vmT(11657727,12155424,.25));const e=new r.Ox3(16777215,.5);return e.position.set(-70,-70,100).normalize(),t.add(e),t}render(t,e){this.camera.projectionMatrix=(new r.yGw).fromArray(e).multiply(this.cameraTransform),this.renderer.state.reset(),this.renderer.render(this.scene,this.camera),this.map.triggerRepaint()}}}}]);
//# sourceMappingURL=37966.f59f9e8e.chunk.js.map