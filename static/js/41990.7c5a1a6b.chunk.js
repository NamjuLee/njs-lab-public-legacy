"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[41990],{41990:(t,i,s)=>{s.r(i),s.d(i,{Renderer:()=>n,Solution:()=>o});var e=s(55913);class h{constructor(t,i){if(this.maxForce=void 0,this.genes=void 0,this.maxForce=.1,i)this.genes=i;else{this.genes=[];for(let i=0;i<t;i++){let t=Math.random()*Math.PI*2;this.genes[i]=new e.P(Math.cos(t),Math.sin(t)),this.genes[i].multi(Math.random()*this.maxForce)}}this.genes[0].normalize()}crossover(t){let i=new Array(this.genes.length),s=Math.floor(Math.random()*this.genes.length);for(let e=0;e<this.genes.length;e++)i[e]=e>s?this.genes[e]:t.genes[e];return new h(i)}mutate(t){for(let i=0;i<this.genes.length;i++)if(Math.random()<t){let t=Math.random()*Math.PI;this.genes[i]=new e.P(Math.cos(t),Math.sin(t)),this.genes[i].multi(Math.random()*this.maxForce),0===i&&this.genes[i].normalize()}}}class o{constructor(t){this.divHost=void 0,this.out=void 0,this.outHis=void 0,this.renderer=void 0,this.divHost=document.getElementById(t)}destroy(){for(;this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}}class n extends e.bb{constructor(t){super(t),this.live=!1,this.m=[0,0],this.t=0,this.lifecycle=void 0,this.recordTime=void 0,this.target=void 0,this.population=void 0,this.obstacles=void 0,this.canvas.style.position="relative",this.canvas.style.width="100%",this.canvas.style.height="100%",this.lifecycle=0,this.recordTime=50,this.target=new l(this.canvas.width/2-12,24,24,24);this.population=new r(this.target,.01,100),this.obstacles=[],this.obstacles.push(new l(this.canvas.width/2-100,this.canvas.height/2,200,10)),this.start()}mouseClick(t,i){}mouseMove(t,i){this.m[0]=t,this.m[1]=i}render(t){this.t+=.01,this.update(t)}update(t){this.lifecycle<50?(this.population.live(this.obstacles,t),this.population.targetReached()&&this.lifecycle<this.recordTime&&(this.recordTime=this.lifecycle),this.lifecycle++):(this.lifecycle=0,this.population.calcFitness(),this.population.selection(),this.population.reproduction());for(let i=0;i<this.obstacles.length;i++)this.obstacles[i].display(t);t.beginPath(),t.arc(this.m[0],this.m[1],10,0,2*Math.PI),t.closePath(),t.fill(),this.target.display(t)}}class a{constructor(t,i,s,h){this.acceleration=void 0,this.velocity=void 0,this.position=void 0,this.r=void 0,this.dna=void 0,this.finishTime=void 0,this.recordDist=void 0,this.fitness=void 0,this.geneCounter=void 0,this.hitObstacle=void 0,this.hitTarget=void 0,this.target=void 0,this.ctx=void 0,this.target=i,this.acceleration=new e.P(0,0,0),this.velocity=new e.P(0,0,0),this.position=(0,e.p$)(t),this.r=4,this.dna=s,this.finishTime=0,this.recordDist=1e4,this.fitness=0,this.geneCounter=0,this.hitObstacle=!1,this.hitTarget=!1}calcFitness(){this.recordDist<1&&(this.recordDist=1),this.fitness=1/(this.finishTime*this.recordDist),this.fitness=Math.pow(this.fitness,4),this.hitObstacle&&(this.fitness*=.1),this.hitTarget&&(this.fitness*=2)}run(t,i){(0>this.position.x||i.canvas.width<this.position.x||0>this.position.y||i.canvas.height<this.position.y)&&(this.hitObstacle=!0),this.hitObstacle||this.hitTarget||(this.applyForce(this.dna.genes[this.geneCounter]),this.geneCounter=(this.geneCounter+1)%this.dna.genes.length,this.update(),this.obstacles(t)),this.hitObstacle||this.display(i)}checkTarget(t){let i=(0,e.zp)(this.position.x,this.position.y,0,this.target.position.x,this.target.position.y,0);i<this.recordDist&&(this.recordDist=i),this.target.contains(this.position)&&!this.hitTarget?this.hitTarget=!0:this.hitTarget||this.finishTime++}obstacles(t){for(let i=0;i<t.length;i++){t[i].contains(this.position)&&(this.hitObstacle=!0)}}applyForce(t){this.acceleration.add(t)}update(){this.velocity.add(this.acceleration),this.position.add(this.velocity),this.acceleration.multi(0)}display(t){t.beginPath(),t.arc(this.position.x,this.position.y,10,0,2*Math.PI),t.closePath(),t.fill()}getFitness(){return this.fitness}getDNA(){return this.dna}stopped(){return this.hitObstacle}}class l{constructor(t,i,s,h){this.position=void 0,this.w=void 0,this.h=void 0,this.position=new e.P(t,i,0),this.w=s,this.h=h}display(t){t.beginPath(),t.rect(this.position.x,this.position.y,this.w,this.h),t.closePath(),t.fill()}contains(t){return t.x>this.position.x&&t.x<this.position.x+this.w&&t.y>this.position.y&&t.y<this.position.y+this.h}}class r{constructor(t,i,s){this.mutationRate=void 0,this.population=void 0,this.matingPool=void 0,this.generations=void 0,this.target=void 0,this.target=t,this.mutationRate=i,this.population=new Array(s),this.matingPool=[],this.generations=0;for(let o=0;o<this.population.length;o++){let t=new e.P(250,520);this.population[o]=new a(t,this.target,new h(50),this.population.length)}}live(t,i){for(let s=0;s<this.population.length;s++)this.population[s].checkTarget(i),this.population[s].run(t,i)}targetReached(){for(let t=0;t<this.population.length;t++)if(this.population[t].hitTarget)return!0;return!1}calcFitness(){for(let t=0;t<this.population.length;t++)this.population[t].calcFitness()}selection(){this.matingPool=[];let t=this.getMaxFitness();for(let i=0;i<this.population.length;i++){let s=(0,e.a2)(this.population[i].getFitness(),0,t,0,1),h=Math.floor(100*s);for(let t=0;t<h;t++)this.matingPool.push(this.population[i])}}reproduction(){for(let t=0;t<this.population.length;t++){let i=Math.floor(Math.random()*this.matingPool.length),s=Math.floor(Math.random()*this.matingPool.length),h=this.matingPool[i],o=this.matingPool[s],n=h.getDNA(),l=o.getDNA(),r=n.crossover(l);r.mutate(this.mutationRate);let c=new e.P(250,520);this.population[t]=new a(c,this.target,r,this.population.length)}this.generations++}getGenerations(){return this.generations}getMaxFitness(){let t=0;for(let i=0;i<this.population.length;i++)this.population[i].getFitness()>t&&(t=this.population[i].getFitness());return t}}}}]);
//# sourceMappingURL=41990.7c5a1a6b.chunk.js.map