"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[67213],{47615:(e,t,n)=>{n.d(t,{O3:()=>v,lG:()=>S,my:()=>I,q9:()=>l});var o=n(10064),i=n(3182),r=n(80457),s=n(80031);const a={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};function l(e){return a[e]}function*c(e){switch(e.type){case"Feature":yield e;break;case"FeatureCollection":for(const t of e.features)t&&(yield t)}}function*u(e){if(!e)return null;switch(e.type){case"Point":yield e.coordinates;break;case"LineString":case"MultiPoint":yield*e.coordinates;break;case"MultiLineString":case"Polygon":for(const t of e.coordinates)yield*t;break;case"MultiPolygon":for(const t of e.coordinates)for(const e of t)yield*e}}function p(e){for(const t of e)if(t.length>2)return!0;return!1}function d(e){let t=0;for(let n=0;n<e.length;n++){const o=e[n],i=e[(n+1)%e.length];t+=o[0]*i[1]-i[0]*o[1]}return t<=0}function f(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]||e.push(t),e}function y(e,t,n){switch(t.type){case"LineString":case"MultiPoint":return function(e,t,n){return h(e,t.coordinates,n),e}(e,t,n);case"MultiLineString":return function(e,t,n){for(const o of t.coordinates)h(e,o,n);return e}(e,t,n);case"MultiPolygon":return function(e,t,n){for(const o of t.coordinates){m(e,o[0],n);for(let t=1;t<o.length;t++)g(e,o[t],n)}return e}(e,t,n);case"Point":return function(e,t,n){return b(e,t.coordinates,n),e}(e,t,n);case"Polygon":return function(e,t,n){const o=t.coordinates;m(e,o[0],n);for(let i=1;i<o.length;i++)g(e,o[i],n);return e}(e,t,n)}}function m(e,t,n){const o=f(t);!function(e){return!d(e)}(o)?h(e,o,n):w(e,o,n)}function g(e,t,n){const o=f(t);!function(e){return d(e)}(o)?h(e,o,n):w(e,o,n)}function h(e,t,n){for(const o of t)b(e,o,n);e.lengths.push(t.length)}function w(e,t,n){for(let o=t.length-1;o>=0;o--)b(e,t[o],n);e.lengths.push(t.length)}function b(e,t,n){const[o,i,r]=t;e.coords.push(o,i),n.hasZ&&e.coords.push(r||0)}function F(e){switch(typeof e){case"string":return"esriFieldTypeString";case"number":return"esriFieldTypeDouble";default:return"unknown"}}function v(e){if(!e)throw new o.Z("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==e.type&&"FeatureCollection"!==e.type)throw new o.Z("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:e});const{crs:t}=e;if(!t)return;const n="string"==typeof t?t:"name"===t.type?t.properties.name:"EPSG"===t.type?t.properties.code:null,i=new RegExp(".*(CRS84H?|4326)$","i");if(!n||!i.test(n))throw new o.Z("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:t})}function I(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=[],i=new Set,r=new Set;let a,d=!1,f=null,y=!1,{geometryType:m=null}=n,g=!1;for(const w of c(e)){const{geometry:e,properties:t,id:n}=w;if((!e||(m||(m=l(e.type)),l(e.type)===m))&&(d||(d=p(u(e))),y||(y=null!=n,y&&(a=typeof n,f=Object.keys(t).filter((e=>t[e]===n)))),y&&null!=n&&(f.length>1?f=f.filter((e=>t[e]===n)):1===f.length&&(f=t[f[0]]===n?f:[])),!g&&t)){let e=!0;for(const n in t){if(i.has(n))continue;const a=t[n];if(null==a){e=!1,r.add(n);continue}const l=F(a);"unknown"!==l?(r.delete(n),i.add(n),o.push({name:(0,s.q6)(n),alias:n,type:l})):r.add(n)}g=e}}const h=(0,s.q6)(1===(null===(t=f)||void 0===t?void 0:t.length)&&f[0]||null);if(h)for(const l of o)if(l.name===h&&(0,s.H7)(l)){l.type="esriFieldTypeOID";break}return{fields:o,geometryType:m,hasZ:d,objectIdFieldName:h,objectIdFieldType:a,unknownFields:Array.from(r)}}function S(e,t){return Array.from(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const{geometryType:n,objectIdField:o}=t;for(const a of e){var s;const{geometry:e,properties:c,id:u}=a;if(e&&l(e.type)!==n)continue;const p=c||{};let d=null!==(s=p[o])&&void 0!==s?s:null;o&&null!=u&&!p[o]&&(p[o]=d=u);const f=new i.u_(e?y(new r.Z,e,t):null,p,null,d);yield f}}()}(c(e),t))}},63543:(e,t,n)=>{n.d(t,{Dm:()=>u,Hq:()=>p,MS:()=>d,bU:()=>a});var o=n(93169),i=n(84652),r=n(60480),s=n(76115);function a(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?s.I4:"esriGeometryPolyline"===e?s.ET:s.lF}}}const l=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let c=1;function u(e,t){if((0,o.Z)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let n="this.".concat(t," = null;");for(const t in e)n+="this".concat(l.test(t)?".".concat(t):'["'.concat(t,'"]')," = ").concat(JSON.stringify(e[t]),";");const o=new Function("\n      return class AttributesClass$".concat(c++," {\n        constructor() {\n          ").concat(n,";\n        }\n      }\n    "))();return()=>new o}catch(n){return()=>({[t]:null,...e})}}function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,i.d9)(e)}}]}function d(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0},query:r.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}}},67213:(e,t,n)=>{n.d(t,{$9:()=>w,G4:()=>v,Lu:()=>h,WW:()=>j,d:()=>T,eS:()=>S,gp:()=>I,j:()=>F,w9:()=>b,yN:()=>k});n(59486);var o=n(76200),i=n(10064),r=n(32718),s=n(92026),a=n(92975),l=n(81753),c=n(83406),u=n(6908),p=n(47615),d=n(63543),f=n(52410),y=n(85249),m=n(78952);const g=r.Z.getLogger("esri.layers.graphics.sources.ogcfeature"),h="http://www.opengis.net/def/crs/",w="".concat(h,"OGC/1.3/CRS84");async function b(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const{links:a}=e,l=x(a,"items","application/geo+json")||x(a,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if((0,s.Wi)(l))throw new i.Z("ogc-feature-layer:missing-items-page","Missing items url");const{data:c}=await(0,o.default)(l.href,{signal:n.signal,query:{limit:r,...n.customParameters,token:n.apiKey},headers:{accept:"application/geo+json"}});await(0,p.O3)(c);const u=(0,p.my)(c,{geometryType:t.geometryType}),m=t.fields||u.fields||[],h=null!=t.hasZ?t.hasZ:u.hasZ,w=u.geometryType,b=t.objectIdField||u.objectIdFieldName||"OBJECTID";let F=t.timeInfo;const v=m.find((e=>{let{name:t}=e;return t===b}));if(v)v.editable=!1,v.nullable=!1;else{if(!u.objectIdFieldType)throw new i.Z("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");m.unshift({name:b,alias:b,type:"number"===u.objectIdFieldType?"esriFieldTypeOID":"esriFieldTypeString",editable:!1,nullable:!1})}if(b!==u.objectIdFieldName){const e=m.find((e=>{let{name:t}=e;return t===u.objectIdFieldName}));e&&(e.type="esriFieldTypeInteger")}m===u.fields&&u.unknownFields.length>0&&g.warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:u.unknownFields}});for(const o of m){if(null==o.name&&(o.name=o.alias),null==o.alias&&(o.alias=o.name),"esriFieldTypeOID"!==o.type&&"esriFieldTypeGlobalID"!==o.type&&(o.editable=null==o.editable||!!o.editable,o.nullable=null==o.nullable||!!o.nullable),!o.name)throw new i.Z("ogc-feature-layer:invalid-field-name","field name is missing",{field:o});if(!y.v.jsonValues.includes(o.type))throw new i.Z("ogc-feature-layer:invalid-field-type",'invalid type for field "'.concat(o.name,'"'),{field:o})}if(F){const e=new f.Z(m);if(F.startTimeField){const t=e.get(F.startTimeField);t?(F.startTimeField=t.name,t.type="esriFieldTypeDate"):F.startTimeField=null}if(F.endTimeField){const t=e.get(F.endTimeField);t?(F.endTimeField=t.name,t.type="esriFieldTypeDate"):F.endTimeField=null}if(F.trackIdField){const t=e.get(F.trackIdField);t?F.trackIdField=t.name:(F.trackIdField=null,g.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:F}}))}F.startTimeField||F.endTimeField||(g.warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:F}}),F=null)}return{drawingInfo:w?(0,d.bU)(w):null,extent:C(e),geometryType:w,fields:m,hasZ:!!h,objectIdField:b,timeInfo:F}}async function F(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{links:n}=e,r=x(n,"data","application/json")||x(n,"http://www.opengis.net/def/rel/ogc/1.0/data","application/json");if((0,s.Wi)(r))throw new i.Z("ogc-feature-layer:missing-collections-page","Missing collections url");const{apiKey:a,customParameters:l,signal:c}=t,{data:u}=await(0,o.default)(r.href,{signal:c,headers:{accept:"application/json"},query:{...l,token:a}});return u}async function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{links:n}=e,r=x(n,"conformance","application/json")||x(n,"http://www.opengis.net/def/rel/ogc/1.0/conformance","application/json");if((0,s.Wi)(r))throw new i.Z("ogc-feature-layer:missing-conformance-page","Missing conformance url");const{apiKey:a,customParameters:l,signal:c}=t,{data:u}=await(0,o.default)(r.href,{signal:c,headers:{accept:"application/json"},query:{...l,token:a}});return u}async function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{apiKey:n,customParameters:i,signal:r}=t,{data:s}=await(0,o.default)(e,{signal:r,headers:{accept:"application/json"},query:{...i,token:n}});return s}async function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n="application/vnd.oai.openapi+json;version=3.0",i=x(e.links,"service-desc",n);if((0,s.Wi)(i))return g.warn("ogc-feature-layer:missing-openapi-page","The OGC API-Features server does not have an OpenAPI page."),null;const{apiKey:r,customParameters:a,signal:l}=t,{data:c}=await(0,o.default)(i.href,{signal:l,headers:{accept:n},query:{...a,token:r}});return c}function T(e){var t;const n=null===(t=/^http:\/\/www\.opengis.net\/def\/crs\/(?<authority>.*)\/(?<version>.*)\/(?<code>.*)$/i.exec(e))||void 0===t?void 0:t.groups;if(!n)return null;const{authority:o,code:i}=n;switch(o.toLowerCase()){case"ogc":switch(i.toLowerCase()){case"crs27":return m.Z.GCS_NAD_1927.wkid;case"crs83":return 4269;case"crs84":case"crs84h":return m.Z.WGS84.wkid;default:return null}case"esri":case"epsg":{const e=Number.parseInt(i,10);return Number.isNaN(e)?null:e}default:return null}}async function k(e,t,n){const o=await j(e,t,n);return(0,c.cn)(o)}async function j(e,t,n){const{collection:r,layerDefinition:d,maxRecordCount:f,queryParameters:{apiKey:y,customParameters:g},spatialReference:h,supportedCrs:w}=e,{links:b}=r,F=x(b,"items","application/geo+json")||x(b,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if((0,s.Wi)(F))throw new i.Z("ogc-feature-layer:missing-items-page","Missing items url");const{geometry:v,num:I,start:S,timeExtent:T,where:k}=t;if(t.objectIds)throw new i.Z("ogc-feature-layer:query-by-objectids-not-supported","Queries with objectids are not supported");const j=m.Z.fromJSON(h),P=(0,s.Pt)(t.outSpatialReference,j),C=P.isWGS84?null:Z(P,w),M=G(v,w),N=function(e){if((0,s.Wi)(e))return null;const{start:t,end:n}=e;return"".concat((0,s.pC)(t)?t.toISOString():"..","/").concat((0,s.pC)(n)?n.toISOString():"..")}(T),O=(R=k,(0,s.Wi)(R)||!R||"1=1"===R?null:R),W=null!==I&&void 0!==I?I:null!=S&&void 0!==S?10:f,{data:q}=await(0,o.default)(F.href,{...n,query:{...g,...M,crs:C,datetime:N,query:O,limit:W,startindex:S,token:y},headers:{accept:"application/geo+json"}});var R;let A=!1;if(q.links){A=!!q.links.find((e=>"next"===e.rel))}!A&&Number.isInteger(q.numberMatched)&&Number.isInteger(q.numberReturned)&&(A=q.numberReturned<q.numberMatched);const{fields:D,geometryType:L,hasZ:J,objectIdField:E}=d,U=(0,p.lG)(q,{geometryType:L,hasZ:J,objectIdField:E});if(!C&&P.isWebMercator)for(const o of U)if((0,s.pC)(o.geometry)){const e=(0,c.di)(o.geometry,L,J,!1);e.spatialReference=m.Z.WGS84,o.geometry=(0,c.GH)((0,l.iV)(e,P))}for(const o of U)o.objectId=o.attributes[E];const H=C||!C&&P.isWebMercator?P.toJSON():a.Zn,$=new u.Z;return $.exceededTransferLimit=A,$.features=U,$.fields=D,$.geometryType=L,$.hasZ=J,$.objectIdFieldName=E,$.spatialReference=H,$}function Z(e,t){var n,o,i;const{isWebMercator:r,wkid:s}=e;if(!s)return null;const a=r?null!==(n=null!==(o=null!==(i=t[3857])&&void 0!==i?i:t[102100])&&void 0!==o?o:t[102113])&&void 0!==n?n:t[900913]:t[e.wkid];return a?"".concat(h).concat(a):null}function P(e){if((0,s.Wi)(e))return"";const{xmin:t,ymin:n,xmax:o,ymax:i}=e;return"".concat(t,",").concat(n,",").concat(o,",").concat(i)}function G(e,t){if(!function(e){return(0,s.pC)(e)&&"extent"===e.type}(e))return null;const{spatialReference:n}=e;if(!n||n.isWGS84)return{bbox:P(e)};const o=Z(n,t);return(0,s.pC)(o)?{bbox:P(e),"bbox-crs":o}:n.isWebMercator?{bbox:P((0,l.iV)(e,m.Z.WGS84))}:null}function C(e){var t;const n=null===(t=e.extent)||void 0===t?void 0:t.spatial;if(!n)return null;const o=n.bbox[0],i=4===o.length,r=o[0],s=o[1],a=i?void 0:o[2];return{xmin:r,ymin:s,xmax:i?o[2]:o[3],ymax:i?o[3]:o[4],zmin:a,zmax:i?void 0:o[5],spatialReference:m.Z.WGS84.toJSON()}}function x(e,t,n){return e.find((e=>e.rel===t&&e.type===n))||e.find((e=>e.rel===t&&!e.type))}}}]);
//# sourceMappingURL=67213.7f41d45a.chunk.js.map