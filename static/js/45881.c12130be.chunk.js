"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[45881],{45881:(t,e,i)=>{i.r(e),i.d(e,{Renderer:()=>a,Solution:()=>n});var s=i(55913),h=i(458);class o{constructor(){this.boids=[],this.boundary=void 0,this._toggleTargetRendering=!1,this.boids=[],this.boundary=[new s.P(50,50,0),new s.P(300,70,0),new s.P(400,400,0),new s.P(50,300,0),new s.P(50,50,0)]}toggleTargetRendering(t){this._toggleTargetRendering=t}updateTargetDelay(t){for(let e=0;e<this.boids.length;++e)this.boids[e].targetDelay=t}updateMass(t){for(let e=0;e<this.boids.length;++e)this.boids[e].mass=t}updateVelocity(t){for(let e=0;e<this.boids.length;++e)this.boids[e].maxVelocity=t}AddAgent(t,e,i,h){let o=new r(this,new s.P(t,e),new s.P(0,0),new s.P(i,h),this.boundary);this.boids.push(o)}Update(){for(let t of this.boids)t.Update()}GetPoint(){let t=[];for(let e of this.boids)e.isRenderable&&t.push(e.p);return t}Render(t){this.boids.forEach((e=>{e.Render(t)})),t.beginPath(),t.moveTo(this.boundary[0].x,this.boundary[0].y);for(let e=1;e<this.boundary.length;++e)t.lineTo(this.boundary[e].x,this.boundary[e].y);t.stroke()}}class r{constructor(t,e,i,h,o){this.maxForce=2,this.maxVelocity=2,this.maxSpeed=.9,this.mass=100.2,this.isRenderable=!0,this.p=void 0,this.p0=void 0,this.p1=void 0,this.targets=void 0,this.target=void 0,this.targetID=0,this.col=!1,this.desiredVelocity=void 0,this.steering=void 0,this.velocity=new s.P(0,0,0),this.wanderAngle=0,this.CIRCLE_DISTANCE=50,this.CIRCLE_RADIUS=50,this.ANGLE_CHANGE=15,this.t=0,this.MAX_QUEUE_AHEAD=15,this.MAX_QUEUE_RADIUS=10,this.trajectory=[],this.timerTrajectory=0,this.scaleBounding=0,this.boundary=void 0,this.controller=void 0,this.targetDelay=3,this.controller=t,r.list.push(this),this.p=e,this.p0=i,this.p1=h,o&&(this.boundary=o),this.UpdateTarget()}Update(){this.UpdateVec1()}UpdateTarget(){let t=this.getRandomVecInSide();if(void 0!==this.boundary)for(;!(0,s.X0)(t,this.boundary);)t=this.getRandomVecInSide();this.target=t}getRandomVecInSide(){let t=h.$H.GetRandomInt(this.p0.x,this.p1.x),e=h.$H.GetRandomInt(this.p0.y,this.p1.y);return new s.P(t,e)}UpdateVec1(){this.desiredVelocity=new s.P(this.target.x-this.p.x,this.target.y-this.p.y,this.target.z-this.p.z),this.desiredVelocity.unitize(),this.desiredVelocity.x*=this.maxVelocity,this.desiredVelocity.y*=this.maxVelocity,this.desiredVelocity.z*=this.maxVelocity;let t=this.desiredVelocity.x-this.velocity.x<this.maxForce?this.desiredVelocity.x-this.velocity.x:this.maxForce,e=this.desiredVelocity.y-this.velocity.y<this.maxForce?this.desiredVelocity.y-this.velocity.y:this.maxForce,i=this.desiredVelocity.z-this.velocity.z<this.maxForce?this.desiredVelocity.z-this.velocity.z:this.maxForce;this.steering=new s.P(t/this.mass,e/this.mass,i/this.mass),this.velocity.x=this.velocity.x+this.steering.x<this.maxSpeed?this.velocity.x+this.steering.x:this.maxSpeed,this.velocity.y=this.velocity.y+this.steering.y<this.maxSpeed?this.velocity.y+this.steering.y:this.maxSpeed,this.velocity.z=this.velocity.z+this.steering.z<this.maxSpeed?this.velocity.z+this.steering.z:this.maxSpeed,this.Queue(),this.p.x+=this.velocity.x,this.p.y+=this.velocity.y,this.p.z+=this.velocity.z,this.t+=.01,this.t>this.targetDelay&&(this.t=0,this.UpdateTarget())}UpdateVec0(){this.steering=this.Wander(new s.P(this.velocity.x,this.velocity.y,this.velocity.z)),this.steering.x=this.steering.x<this.maxForce?this.steering.x:this.maxForce,this.steering.y=this.steering.y<this.maxForce?this.steering.y:this.maxForce,this.steering.z=this.steering.z<this.maxForce?this.steering.z:this.maxForce,this.steering.x/=this.mass,this.steering.y/=this.mass,this.steering.z/=this.mass,this.velocity.x+this.steering.x<this.maxSpeed?this.velocity.x=this.velocity.x+this.steering.x:this.velocity.x=this.maxSpeed,this.velocity.y+this.steering.y<this.maxSpeed?this.velocity.y=this.velocity.y+this.steering.y:this.velocity.y=this.maxSpeed,this.velocity.z+this.steering.z<this.maxSpeed?this.velocity.z=this.velocity.z+this.steering.z:this.velocity.z=this.maxSpeed,this.Queue(),console.log(this.maxSpeed),this.p.x+=this.velocity.x,this.p.y+=this.velocity.y,this.p.z+=this.velocity.z}Wander(t){let e=new s.P(t.x,t.y,t.z);e.normalize(),e.scale(this.CIRCLE_DISTANCE);let i=new s.P(0,-1);return i.scale(this.CIRCLE_RADIUS),i=this.setAngle(i,this.wanderAngle),this.wanderAngle+=Math.random()*this.ANGLE_CHANGE-.5*this.ANGLE_CHANGE,e.add(i)}setAngle(t,e){let i=t.length();return t.x=Math.cos(e)*i,t.y=Math.sin(e)*i,t}GetNeighborAhead(){var t=void 0,e=this.velocity.clone();e.normalize(),e.scale(this.MAX_QUEUE_AHEAD);let i=this.p.clone().add(e);for(let h=0;h<r.list.length;h++){let e=r.list[h],o=s.P.distanceTo(i,e.p);if(e!==this&&o<=this.MAX_QUEUE_RADIUS){t=e;break}}return t}Queue(){return void 0!==this.GetNeighborAhead()&&this.velocity.scale(.3),new s.P(0,0)}Render(t){this.RenderCircle(t)}RenderDesiredVelocity(t){}RenderCurrentVelocity(t){}RenderCircle(t){this.t+=.05,this.timerTrajectory+=1,this.timerTrajectory%5===0&&(this.trajectory.length>30&&this.trajectory.shift(),this.trajectory.push(new s.P(this.p.x,this.p.y)),this.timerTrajectory=0);for(let e=0;e<this.trajectory.length;++e)t.fillStyle="rgba(100, 100, 100 ,0.1)",t.beginPath(),t.arc(this.trajectory[e].x,this.trajectory[e].y,.2*e,0,6.28),t.closePath(),t.fill();t.strokeStyle="#000000",t.lineWidth=.5,this.controller._toggleTargetRendering&&(t.beginPath(),t.moveTo(this.p.x,this.p.y),t.lineTo(this.target.x,this.target.y),t.stroke(),t.fillStyle="#000000",t.beginPath(),t.arc(this.target.x,this.target.y,2.5,0,6.28),t.closePath(),t.fill()),t.fillStyle="#000000",t.beginPath(),t.arc(this.p.x,this.p.y,2.5,0,6.28),t.closePath(),t.fill(),t.beginPath(),t.arc(this.p.x,this.p.y,10+5*Math.sin(this.t),0,6.28),t.closePath(),t.stroke(),t.lineWidth=.5,t.strokeStyle="rgba(".concat(255,", ",255,", ",0,", ",1-.07*this.scaleBounding,")"),t.beginPath(),t.arc(this.p.x,this.p.y,this.scaleBounding,0,6.28),t.closePath(),t.stroke(),this.scaleBounding+=.2,1-.07*this.scaleBounding<0&&(this.scaleBounding=0)}}r.list=[];class n{constructor(t){this.divHost=void 0,this.renderer=void 0,this.divHost=divHost;const e=document.createElement("div");e.style.marginLeft="auto",e.style.marginRight="auto",e.style.backgroundColor="#333",e.style.width="500px",e.style.height="500px",this.divHost.appendChild(e),this.renderer=new a(e);const i=document.createElement("div");e.append(i),i.textContent="Click or drag on canvas to populate agents";const h=document.createElement("div");e.append(h);const o=(0,s.Du)("Delay",1,10);e.appendChild(o.div),o.slider.defaultValue="3",o.slider.oninput=()=>{this.renderer.BoidContoller.updateTargetDelay(+o.slider.value)};const r=(0,s.Du)("Mass",1,500);e.appendChild(r.div),r.slider.defaultValue="3",r.slider.oninput=()=>{this.renderer.BoidContoller.updateMass(+r.slider.value)};const n=(0,s.Du)("Velocity",1,10);e.appendChild(n.div),n.slider.defaultValue="3",n.slider.oninput=()=>{this.renderer.BoidContoller.updateVelocity(+n.slider.value)};const l=(0,s.Vv)("target");h.appendChild(l.div),l.checkBox.checked=!1,l.checkBox.onchange=()=>{!0===l.checkBox.checked?this.renderer.toggleTargetRendering(!0):this.renderer.toggleTargetRendering(!1)}}destroy(){for(this.renderer.destroy();this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}}class a extends s.bb{constructor(t){super(t),this.BoidContoller=void 0,this.dragTime=0,this.canvas.style.position="relative",this.canvas.style.width="100%",this.canvas.style.height="100%",this.BoidContoller=new o,this.start()}toggleTargetRendering(t){this.BoidContoller.toggleTargetRendering(t)}mouseDown(t,e){}mouseUp(t,e){this.BoidContoller.AddAgent(t,e,this.canvas.width,this.canvas.height)}mouseDrag(t,e){this.dragTime>5&&(this.BoidContoller.AddAgent(t,e,this.canvas.width,this.canvas.height),this.dragTime=0),this.dragTime++}render(t){this.BoidContoller.Update(),this.BoidContoller.Render(t)}}}}]);
//# sourceMappingURL=45881.c12130be.chunk.js.map