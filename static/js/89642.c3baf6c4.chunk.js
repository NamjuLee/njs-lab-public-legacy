"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[89642],{63870:(t,s,e)=>{e.d(s,{G:()=>l});var i=e(87968);class o{constructor(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.data={},this.day=24,this.scale=.25,this.dataSampling=4,this.margin=25,this.ctx=void 0,this.m=[0,0],this.selVal=0,this.selID=0,this.dataRaw=[],this.index=0,this.id=["mass_concentration_of_blue_green_algae_in_sea_water_rfu (RFU)","chlorophyll_fluorescence (RFU)","sea_water_turbidity (1)","sea_water_temperature (K)","sea_water_ph_reported_on_total_scale (1)"],this.vizData=(t,s,e,o,h,a,l,n)=>{let c=t.canvas.height-l;t.beginPath();let r=l,d=(0,i.remap)(s[0],e[0],e[1],c,l);n=Math.floor((n-l)/o),t.moveTo(r,d);for(let v=1;v<s.length;v+=a){r+=1;const h=l+r*o*a;let d=0+l,m=0;if("mean"==="max"){for(let t=0;t<a;++t)m+=s[v+t];d=m/a*c,d=(0,i.remap)(d,e[0],e[1],c,l),t.lineTo(h,d)}else{let o=!1;for(let t=0;t<a;++t){const e=v+t;e===n&&(o=!0,this.selID=e),m<s[e]&&(m=s[e])}d=(0,i.remap)(m,e[0],e[1],c,l),o&&(this.selVal=d),t.lineTo(h,d)}}t.stroke(),t.save(),t.scale(-1,1),t.fillText(this.dataRaw[this.selID].split(",")[0],10,10),t.restore()},this.ctx=t,this.index=s,document.onkeydown=t=>{this.dataSampling++},(0,i.getCSVFromURL)("/njs-lab-public/static/data/Watabot/obs_104_1928_d047_15c7.csv").then((t=>{const e=t.split(/\r\n|\r|\n/g);this.dataRaw=e;const i=e[0].split(","),o={};let h=!0;for(let s=0;s<i.length;++s)h&&"time (UTC)"===i[s]?(o[i[s]]=[],h=!1):o[i[s]]=new Float32Array(e.length-1);for(let s=1;s<e.length;++s){const t=e[s].split(",");for(let e=0;e<i.length;++e){const h=i.indexOf(i[e]);-1!==h&&(o[i[e]][s-1]=t[h])}}this.data=o;const a=document.createElement("div");a.style.zIndex="1",a.style.color="#000",a.style.fontSize="11px",a.style.position="absolute",a.style.left="10px",a.style.top="5px",a.textContent=this.id[s],this.ctx.canvas.parentElement.appendChild(a),this.render(this.ctx)}))}Offset(t){}wheel(t){t.deltaY<0?this.scale+=.25*this.scale:this.scale-=.25*this.scale,this.scale=this.scale<.012?.012:this.scale}mouseMove(t,s){this.m[0]=t,this.m[1]=s}render(t){const s=-1*this.m[0]+this.ctx.canvas.width;let e=this.data[this.id[this.index]];if(void 0===e)return;a(t,e,this.scale,this.day,this.margin);const i=h(e,this.dataSampling);t.lineWidth=4,t.strokeStyle="#000",this.vizData(t,e,i,this.scale,this.day,this.dataSampling,this.margin,s),t.lineWidth=.5,t.beginPath(),t.moveTo(s,0),t.lineTo(s,this.ctx.canvas.height),t.stroke(),t.beginPath(),t.arc(s,this.m[1],1,0,2*Math.PI),t.fill(),t.fillStyle="#f00",t.beginPath(),t.arc(s,this.selVal,7,0,2*Math.PI),t.fill()}}const h=(t,s)=>{let e=Number.MAX_VALUE,i=Number.MIN_VALUE;for(let o=1;o<t.length;o+=s){let h=t[o];if("mean"==="max")for(let t=0;t<s;++t)e=e>h?h:e,i=i<h?h:i;else for(let t=0;t<s;++t)e=e>h?h:e,i=i<h?h:i}return[e,i]},a=(t,s,e,i,o)=>{t.setLineDash([2,2]),t.lineWidth=1;for(let h=0;h<s.length;h++){if(t.strokeStyle="rgba(200, 200, 200, 0.8)",e>.1&&h%(12*i)===0){const s=o+h*e;t.beginPath(),t.moveTo(s,o),t.lineTo(s,t.canvas.height-o),t.stroke()}if(t.strokeStyle="rgba(0, 0, 255, 0.8)",e>.02&&h%(12*i*7)===0){const s=o+h*e;t.beginPath(),t.moveTo(s,o),t.lineTo(s,t.canvas.height-o),t.stroke()}if(t.strokeStyle="rgba(0, 255, 0, 0.8)",h%(12*i*30)===0){const s=o+h*e;t.beginPath(),t.moveTo(s,o),t.lineTo(s,t.canvas.height-o),t.stroke()}}t.setLineDash([])};class l{constructor(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;this.divHost=void 0,this.canvas=void 0,this.ctx=void 0,this.isDown=!1,this.debugMode=!1,this.isStatic=!1,this.waterQualityInspector=void 0,this.prevent=!1,this.delay=250,this.timer=void 0,this.isDrag=!1,this.resize=()=>{const t=this.divHost.getBoundingClientRect();this.canvas.width=t.width,this.canvas.height=t.height,this.loop(this.ctx)},this.divHost=t;const e=this.divHost.getBoundingClientRect();this.canvas=document.createElement("canvas"),this.canvas.style.position="relative",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.background="rgba(255, 255, 255, 1.0)",this.canvas.style.borderRadius="15px",this.canvas.width=e.width,this.canvas.height=e.height,this.divHost.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.ctx.scale(-1,1),this.ctx.translate(-this.ctx.canvas.width,0),this.canvas.onclick=t=>{this.timer=setTimeout((()=>{this.prevent||this.mouseClick(t.offsetX,t.offsetY),this.isDrag=!1,this.prevent=!1}),this.delay),this.loop(this.ctx)},this.canvas.ondblclick=t=>{clearTimeout(this.timer),this.prevent=!0,this.mouseDoubleClick(t.offsetX,t.offsetY),this.loop(this.ctx)},this.canvas.onmousedown=t=>{this.isDown=!0,this.mouseDown(t.offsetX,t.offsetY),this.loop(this.ctx)},this.canvas.onmouseup=t=>{this.isDown=!1,this.isDrag=!1,this.mouseUp(t.offsetX,t.offsetY),this.loop(this.ctx)},this.canvas.onmousemove=t=>{this.isDown?(this.isDrag=!0,this.prevent=!0,this.mouseDrag(t.offsetX,t.offsetY)):this.mouseMove(t.offsetX,t.offsetY)},this.canvas.onwheel=t=>{this.waterQualityInspector.wheel(t),this.loop(this.ctx)},this.waterQualityInspector=new o(this.ctx,s),window.addEventListener("resize",this.resize),this.start()}start(){this.loop(this.ctx)}destroy(){window.removeEventListener("resize",this.resize),this.isStatic=!0;try{for(;void 0!==this.divHost&&void 0!==this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}catch(t){}}renderUpdate(t){t.clearRect(0,0,t.canvas.width,t.canvas.height),this.render(t)}loop(t){this.isStatic||requestAnimationFrame((()=>{this.renderUpdate(t)}))}render(t){this.waterQualityInspector.render(this.ctx)}mouseClick(t,s){this.debugMode&&console.log("click")}mouseDoubleClick(t,s){this.debugMode&&console.log("d-click")}mouseDown(t,s){this.debugMode&&console.log("down")}mouseUp(t,s){this.debugMode&&console.log("up")}mouseMove(t,s){this.debugMode&&console.log("move"),this.waterQualityInspector.mouseMove(t,s),this.loop(this.ctx)}mouseDrag(t,s){this.debugMode&&console.log("drag")}mouseWheel(t){this.debugMode&&console.log("wheel",t)}}},89642:(t,s,e)=>{e.r(s),e.d(s,{Solution:()=>o});var i=e(63870);class o{constructor(t){this.divHost=void 0,this.chartVizWater=void 0,this.divHost=document.getElementById(t),this.divHost.style.display="flex",this.divHost.style.alignItems="center";const s=document.createElement("div");s.style.marginLeft="auto",s.style.marginRight="auto",s.style.width="900px",s.style.height="500px",this.divHost.appendChild(s),this.chartVizWater=new i.G(s)}destroy(){for(this.chartVizWater.destroy();this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}}}}]);
//# sourceMappingURL=89642.c3baf6c4.chunk.js.map