{"version":3,"file":"static/js/58968.a7b2ed33.chunk.js","mappings":"qKAEO,MAAMA,EAGXC,cAAsC,IAA1BC,EAAO,uDAAG,GAAIC,EAAI,uDAAG,GAAE,KAF5BD,aAAO,OACPC,UAAI,EAETC,KAAKF,QAAUA,EACfE,KAAKD,KAAOA,CACd,EAEK,MAAME,EAIXJ,YAAYK,EAAYC,EAAYC,GAAa,KAH1CF,QAAE,OACFC,QAAE,OACFC,QAAE,EAEPJ,KAAKE,GAAKA,EACVF,KAAKG,GAAKA,EACVH,KAAKI,GAAKA,CACZ,EAEK,MAAMC,EAYXR,YAAYS,EAAYC,EAAaC,EAAqBC,EAAiBC,GAAoB,KAXxFJ,QAAE,OACFC,UAAI,OACJI,iBAAW,OACXH,gBAAU,OACVC,YAAM,OACNC,cAAQ,OACRE,WAAK,OAELC,YAAM,OAENC,UAAI,EAETd,KAAKM,GAAKA,EACVN,KAAKO,KAAOA,EACZP,KAAKQ,WAAaA,EAClBR,KAAKS,OAASA,EACdT,KAAKU,SAAWA,EAChBV,KAAKY,MAAQ,GACbZ,KAAKc,KAAO,CAAC,CACf,CACOC,SAASC,GACdhB,KAAKY,MAAQ,GACb,IAAK,IAAIK,EAAI,EAAGA,EAAID,EAAGE,SAAUD,EAC/BjB,KAAKY,MAAMO,KAAK,IAAIlB,EAASe,EAAGC,GAAGG,EAAGJ,EAAGC,GAAGI,EAAGL,EAAGC,GAAGK,GAEzD,CACOC,SAAST,EAAcf,GAC5BC,KAAKc,KAAO,IAAIlB,EAAOkB,EAAMf,EAC/B,EChDK,MAAeyB,EACpB3B,cACO,ECDF,MAAM4B,EAyBX5B,YAAY6B,GAAqB,KAxB1BC,eAAkC,GAAG,KACrCC,UAAY,EAAE,KACdC,QAAU,EAAE,KACZC,WAAY,EAAM,KAElBC,SAAU,EAAM,KAChBC,cAAe,EAAK,KAEnBC,KAAO,uBAAuB,KAC9BC,KAAO,uBAAuB,KAC9BC,KAAO,qBAAqB,KAG5BC,KAAiB,IAAIC,EAAAA,GAAS,EAAG,GAAG,KAIpCC,aAAO,OACPC,aAAO,OAEfb,SAAG,OACHc,YAAa,EAAM,KACnBC,cAAe,EAAK,KACpBC,iBAAyCC,EAEvC3C,KAAK0B,IAAMA,EACX1B,KAAKsC,QAAU,IAAID,EAAAA,GAASX,EAAIkB,IAAIxB,EAAI,EAAGM,EAAIkB,IAAIvB,EAAI,GACvDrB,KAAKuC,QAAU,IAAIF,EAAAA,GAASX,EAAIkB,IAAIxB,EAAI,EAAGM,EAAIkB,IAAIvB,EAAI,EACzD,CACOwB,QACL7C,KAAK2B,eAAiB,GACtB3B,KAAK4B,UAAY,EACjB5B,KAAK0B,IAAIoB,SAAW,EACpB9C,KAAKwC,YAAa,EAClBxC,KAAK8B,WAAY,EACjB9B,KAAK0B,IAAIqB,YAAa,CACxB,CACOC,aACA,CAEIC,WAAOC,GAChBlD,KAAKsC,QAAQlB,EAAI8B,EAAE9B,EAAIpB,KAAK6B,OAC5B7B,KAAKsC,QAAQjB,EAAI6B,EAAE7B,EAAIrB,KAAK6B,MAC9B,CACWoB,aACT,OAAOjD,KAAKsC,OACd,CACWa,WAAOD,GAChBlD,KAAKuC,QAAQnB,EAAI8B,EAAE9B,EAAIpB,KAAK6B,OAC5B7B,KAAKuC,QAAQlB,EAAI6B,EAAE7B,EAAIrB,KAAK6B,MAC9B,CACWsB,aACT,OAAOnD,KAAKuC,OACd,CACOa,cAAcF,GACnBlD,KAAKsC,QAAQlB,EAAIpB,KAAK0B,IAAIkB,IAAIxB,EAAMpB,KAAK0B,IAAI2B,eAAe1C,YAAY2C,MAAQJ,EAAI,IACpFlD,KAAKuC,QAAQnB,EAAIpB,KAAK0B,IAAIkB,IAAIxB,EAAMpB,KAAK0B,IAAI2B,eAAe1C,YAAY2C,MAAQJ,EAAI,IAEpFlD,KAAKsC,QAAQjB,EAAIrB,KAAK0B,IAAIkB,IAAIvB,EAAIrB,KAAK0B,IAAI2B,eAAe1C,YAAY4C,OAASL,CACjF,CACOM,SACDxD,KAAK+B,UAIT/B,KAAKoC,KAAKhB,EAAIpB,KAAKsC,QAAQlB,EAAwC,IAAnCpB,KAAKuC,QAAQnB,EAAIpB,KAAKsC,QAAQlB,GAC9DpB,KAAKoC,KAAKf,EAAIrB,KAAKsC,QAAQjB,EAAwC,IAAnCrB,KAAKuC,QAAQlB,EAAIrB,KAAKsC,QAAQjB,GAgChE,CACOoC,OAAOC,GACP1D,KAAK0B,IAAIiC,MAAMC,mBAAmBC,gBAAgBC,IAAIC,YAGtD/D,KAAKgC,eAINhC,KAAKwC,WACPkB,EAAIM,UAAYhE,KAAKkC,KAErBwB,EAAIM,UAAYhE,KAAKiC,KAEnBjC,KAAK+B,UACP2B,EAAIM,UAAYhE,KAAKmC,MAGvBuB,EAAIO,YACJP,EAAIQ,KACFlE,KAAKiD,OAAO7B,EACZpB,KAAKiD,OAAO5B,EACZrB,KAAKmD,OAAO/B,EAAIpB,KAAKiD,OAAO7B,EAC5BpB,KAAKmD,OAAO9B,EAAIrB,KAAKiD,OAAO5B,GAE9BqC,EAAIS,YACJT,EAAIU,OACN,EC/HK,MAAMC,EAEXxE,YAAYyE,GAAsB,KAD3BA,UAAI,EAETtE,KAAKsE,KAAOA,CACd,CACOd,OAAOE,GACP1D,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIC,aAI5DL,EAAI3D,KAAI,aACRC,KAAKuE,WAAWb,GAClB,CACOa,WAAWb,GAChB,MAAMc,EAAMxE,KAAKsE,KAAK1B,IACtBc,EAAIO,YACJP,EAAIe,IAAID,EAAIpD,EAAGoD,EAAInD,EAAG,EAAG,EAAG,MAC5BqC,EAAIS,YACJT,EAAIM,UAAY,UAChBN,EAAIU,OACJ,MAAMM,EAAI,uBAAmB1E,KAAKsE,KAAKK,aACvCjB,EAAIkB,SAASF,EAAMF,EAAIpD,EAAI,GAAIoD,EAAInD,EAAI,IAEvC,MAAMd,EAAI,gBAAYP,KAAKsE,KAAK/D,MAChCmD,EAAIkB,SAASrE,EAAMiE,EAAIpD,EAAI,IAAKoD,EAAInD,EAAI,IAExC,MAAMwD,EAAK,iBAAa7E,KAAKsE,KAAKQ,UAClCpB,EAAIkB,SAASC,EAAOL,EAAIpD,EAAI,GAAIoD,EAAInD,EAAI,IAExCqC,EAAIM,UAAY,UAChB,MAAMe,EAAY,qBAAiB/E,KAAKsE,KAAKU,UAAUrD,eAAeT,QACtEwC,EAAIkB,SAASG,EAAcP,EAAIpD,EAAI,IAAKoD,EAAInD,EAAI,GAClD,ECRK,MAAe4D,UAAsBzD,EA6E1C3B,YAAY8D,GACVuB,QAAQ,KA5EH7B,oBAAc,OACd8B,cAAQ,OACRC,oBAAc,OACdC,iBAAW,OACXL,eAAS,OACT1E,QAAE,OAGFgF,QAAS,EAAM,KACfC,SAAU,EAAM,KAChBC,kBAAmB,EAAM,KACzBC,2BAA4B,EAAK,KACjC3D,eAAS,OACT4D,gBAAU,OACVC,cAAQ,OACR7C,SAAW,EAAE,KACb8C,kBAAY,OACZC,gBAAU,OACVC,cAAQ,OACRC,qBAAe,OACfC,kBAAY,OACZhE,kBAAY,OACZiE,oBAAc,OACdC,iBAAW,OACXC,YAAM,OACNC,aAAO,OACPC,mBAAa,OACbC,iBAAW,OACXC,gBAAU,OACVC,iBAAW,OACXC,qBAAe,OACfC,kBAAY,OACZC,YAAM,OACNC,oBAAc,OACdC,cAAQ,OACRC,uBAAiB,OACjBC,YAAM,OACNC,iBAAW,OACXC,qBAAe,OACfC,qBAAe,OACfC,yBAAmB,OACnBC,kBAAY,OACZC,oBAAc,OACd9G,UAAI,OACJ+G,aAAO,OAEPC,mBAAa,OACbC,cAAQ,OACRC,cAAQ,OACR7E,SAAG,OACH8E,UAAI,OAEJC,OAAC,OAEDC,cAAQ,OACRC,iBAAW,OACRC,mBAAa,OAChBC,iBAAW,OACXC,mBAAa,OACbC,sBAAgB,OAChBC,WAAK,OACLC,eAAS,OACTxE,WAAK,OACLyE,eAAS,OAETtD,SAAW,EAAE,KACbuD,eAAiB,EAAI,KACrBC,kBAAmB,EAAM,KACzBC,eAAiB,IAAI,KACrBC,yBAA4C7F,EAAU,KACnD8F,cAAe,EAAM,KACrBC,UAAkBC,EAAAA,GAAAA,OAAY,KAC9BC,yBAA0DjG,EAAU,KACpEkG,iBAAW,OACXC,yBAAmB,EAG3B9I,KAAK2D,MAAQA,EACb3D,KAAK2D,MAAMoF,YAAY/I,MACvBA,KAAK4C,KAAMoG,EAAAA,EAAAA,MACXhJ,KAAKM,GAAKN,KAAK2D,MAAMsF,UACrBjJ,KAAKmI,UAAYnI,KAAK2D,MAAMuF,aAAalJ,MACzCA,KAAK2F,UAAW,EAChB3F,KAAK4F,cAAe,EACpB5F,KAAK8F,UAAW,EAChB9F,KAAK+F,iBAAkB,EACvB/F,KAAK0F,YAAa,EAClB1F,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EACpBhC,KAAKiG,gBAAiB,EACtBjG,KAAKkG,aAAc,EACnBlG,KAAKoG,SAAU,EACfpG,KAAK4G,gBAAiB,EACtB5G,KAAKqG,eAAgB,EACrBrG,KAAKsG,aAAc,EACnBtG,KAAKwG,aAAc,EACnBxG,KAAKuG,YAAa,EAClBvG,KAAKyG,iBAAkB,EACvBzG,KAAK0G,cAAe,EACpB1G,KAAKmH,qBAAsB,EAC3BnH,KAAK8B,WAAY,EACjB9B,KAAKgH,aAAc,EACnBhH,KAAK2G,QAAS,EACd3G,KAAKmG,QAAS,EACdnG,KAAK+F,iBAAkB,EACvB/F,KAAK8G,mBAAoB,EAEzB9G,KAAK4F,cAAe,EACpB5F,KAAKiH,iBAAkB,EAEvBjH,KAAK4H,UAAW,EAChB5H,KAAK6I,YAAc,GAEnB7I,KAAKqH,eAAiB,GACtBrH,KAAKwH,SAAW,EAChBxH,KAAKyH,SAAW,EAChBzH,KAAK6H,aAAc,EACnB7H,KAAK6G,UAAW,EAChB7G,KAAK+G,QAAS,EACd/G,KAAKiI,iBAAmB,EAExBjI,KAAKqI,eAAiB,EACtBrI,KAAKkH,gBAAkB,EACvBlH,KAAKuH,eAAgB,EACrBvH,KAAKoI,UAAY,IAAI/D,EAAUrE,MAE/BA,KAAKgF,UAAY,IAAIvD,EAAmBzB,MACxCA,KAAKmJ,WACP,CAQOC,UACL,MAAMlG,EAAgB,GAEtB,OADAA,EAAE/B,KAAKnB,KAAK4C,KACLM,CACT,CACOmG,UACL,OAAOC,OAAOC,gBAChB,CACOC,SACL,MAAMC,EAAI,IAAIpJ,EACZL,KAAKM,GACLN,KAAKO,KACLP,KAAK+F,gBACL/F,KAAK4F,aACL5F,KAAKqG,eAGP,OADAoD,EAAE1I,SAASf,KAAKoJ,WACTK,CACT,CAEOC,mBAAmB1I,GACxB,OAAO2I,EAAAA,EAAAA,IAAe3J,KAAK4C,IAAK5B,EAClC,CACO4I,qBAAqB5I,GAC1B,OAAO6I,EAAAA,EAAAA,IAAyB7J,KAAK4C,IAAK,EAAG,EAAG5B,EAClD,CACO8I,sBAAsB5G,GAE7B,CAEWA,QACT,OAAOlD,KAAK4C,GACd,CACWM,MAAEA,GACXlD,KAAK4C,IAAMM,CACb,CACWxC,eACT,OAAOV,KAAKqG,aACd,CACW3F,aAASwC,GAClBlD,KAAKsG,YAActG,KAAKqG,cACxBrG,KAAKqG,cAAgBnD,EAErBlD,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBC,UAAUjK,KAAKwJ,SAC1E,CACWU,WACT,OAAOlK,KAAK0I,SACd,CACWwB,SAAKhH,GACdlD,KAAK0I,UAAYxF,CACnB,CACWiH,gBACT,OAAOnK,KAAKiG,cACd,CACWkE,cAAUjH,GACnBlD,KAAKiG,eAAiB/C,CACxB,CACWkH,cACT,OAAOpK,KAAK4F,YACd,CACWwE,YAAQlH,GACZA,IACHlD,KAAK8G,mBAAoB,GAE3B9G,KAAK4F,aAAe1C,CACtB,CACWmH,iBACT,OAAOrK,KAAKkH,eACd,CACWmD,eAAWnH,GACpBlD,KAAKkH,gBAAkBhE,CAMzB,CACWH,eAAWG,GACpBlD,KAAKsI,iBAAmBpF,CAC1B,CACWH,iBACT,OAAO/C,KAAKsI,gBACd,CACWgC,qBACT,OAAOtK,KAAK4I,mBACd,CACW0B,mBAAeC,GAGpBA,IAAMvK,KAAK4I,sBAGX2B,GAAKvK,KAAKwK,mBAAmBD,KAG7BvK,KAAK4I,qBACH2B,GAGFvK,KAAK4I,oBAAoB6B,mBAQ7BzK,KAAK4I,oBAAsB2B,GAE7B,CACOG,YAAYC,GACjB3K,KAAKqD,eAAeqH,YAAYC,EAClC,CACOH,mBAAmBD,GACxB,OAAO,CACT,CACOK,qBAAqB1H,EAAa2H,GACvC,CAESC,YACT,OAAO9K,KAAK0F,UACd,CACWoF,UAAM5H,GACflD,KAAK0F,WAAaxC,CACpB,CACW1C,iBACT,OAAOR,KAAK+F,eACd,CACWvF,eAAW0C,GACpBlD,KAAK+F,gBAAkB7C,CACzB,CACW6H,iBACT,OAAO/K,KAAKyG,eACd,CACWsE,eAAW7H,GACpBlD,KAAKyG,gBAAkBvD,CACzB,CACW8H,kBACT,OAAOhL,KAAKiH,eACd,CACW+D,gBAAY9H,GACrBlD,KAAKiH,gBAAkB/D,CACzB,CACWyB,kBACT,OAAO3E,KAAKwF,gBACd,CACWb,gBAAYzB,GAGrBlD,KAAKwF,iBAAmBtC,CAC1B,CACW+H,aACT,OAAOjL,KAAK0G,YACd,CACWuE,WAAO/H,GAChBlD,KAAK0G,aAAexD,CACtB,CACWgI,cACT,OAAOlL,KAAKyI,YACd,CACWyC,YAAQhI,GACjBlD,KAAKyI,aAAevF,CACtB,CAEWiI,eACT,OAAOnL,KAAK8H,aACd,CACWqD,aAASjI,GAClBlD,KAAK8H,cAAgB5E,CACvB,CACOkI,eAEP,CACOC,cACL,MAAO,CAACrL,KAAK4C,IACf,CACO0I,qBACL,CAEKC,mBACL,GAAKvL,KAAK2D,MAAMC,mBAAmB4H,wBAAwBC,cAKvDzL,KAAK8H,gBAAiB9H,KAAKuF,QAA/B,CAiBA,GAZAvF,KAAK8H,eAAgB,EACrB9H,KAAKkI,MAAQwD,SAASC,cAAc,OACpC3L,KAAKkI,MAAM5H,GAAK,MAAQN,KAAKM,GAC7BN,KAAKkI,MAAM0D,MAAMC,SAAW,WAC5B7L,KAAKkI,MAAM0D,MAAME,OAAS,OAC1B9L,KAAKkI,MAAM0D,MAAMrI,OAAS,MAC1BvD,KAAKkI,MAAM0D,MAAMtI,MAAQ,MACzBtD,KAAKkI,MAAM0D,MAAMG,gBAAkB,MACnC/L,KAAK2D,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAIC,YAC3EnM,KAAKkI,OAILlI,KAAKO,OAAS6L,EAAAA,GAAAA,UACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,kBACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,SACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,WACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,OACd,CACA,MAAMC,EAAYrM,KAAKoL,eAEvBpL,KAAKkI,MAAM0D,MAAMU,IAAMD,EAAEzJ,IAAIvB,EAAI,KACjCrB,KAAKkI,MAAM0D,MAAMW,KAAOF,EAAEzJ,IAAIxB,EAAI,IACpC,MACEpB,KAAKkI,MAAM0D,MAAMU,IAAMtM,KAAK4C,IAAIvB,EAAI,KACpCrB,KAAKkI,MAAM0D,MAAMW,KAAOvM,KAAK4C,IAAIxB,EAAI,KAGnCpB,KAAK8I,qBACP0D,aAAaxM,KAAK8I,qBAEpB9I,KAAK8I,oBAAsB2D,YAAW,KAChCzM,KAAKkI,OACPlI,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB0C,eAAe1M,KAAKwJ,SAC/E,GACCxJ,KAAKuI,eAtCR,CAuCF,CACOoE,UACL,MAAO,CAAC3M,KAAK4C,IACf,CACOgK,mBACL,GAAI5M,KAAKkI,OAASlI,KAAKkI,MAAM2E,WAAY,CAGvC,GAFA7M,KAAKmF,SAAS2H,kBAAoB,EAClC9M,KAAKkI,MAAM2E,WAAWE,YAAY/M,KAAKkI,OACnClI,KAAKO,OAAS6L,EAAAA,GAAAA,MAAa,CAC7B,MAAM3C,EAAI,IAAIpJ,EACZL,KAAKM,GACLN,KAAKO,KACLP,KAAK+F,gBACL/F,KAAK4F,aACL5F,KAAKqG,eAEPoD,EAAE1I,SAASf,KAAKoJ,WAChBpJ,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBgD,eAAevD,EAC1E,MACEzJ,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBgD,eAAehN,KAAKwJ,UAE/ExJ,KAAK+H,aAAc,EACnB/H,KAAKkI,WAAQvF,EACb3C,KAAK8H,eAAgB,CACvB,CACF,CAEOmF,aAAa/J,GAClB,MAAO,EAACgK,EAAAA,EAAAA,IAAYlN,KAAK4C,IAAKM,GAAIlD,KAAK4C,IACzC,CACOuK,oBACL,OAAOnN,KAAK4C,GACd,CAEOwK,KAAKhM,EAAWC,IACjBrB,KAAK2F,UAAa3F,KAAKgC,cAAgBhC,KAAKqG,aAGlD,CACOgH,eAAeC,EAAmBC,GAClC,CAEAC,SACA,CAEAC,eACA,CAEAC,gBAAgBtM,EAAWC,GAElC,CACOsM,UAAUjK,GACf1D,KAAKqD,eAAe1C,YAAYiN,YAAc5N,KAAK2D,MAAMC,mBAAmB4H,wBAAwBoC,WAEtG,CACOC,QAAQ3K,GACb,OAAOlD,KAAKqD,eAAewK,QAAQ3K,EACrC,CACO4K,oBACA,CAEAC,mBACA,CAEAC,YACA,CAEAC,WACA,CAEAC,cACA,CAGAC,YAAYC,GACZ,CAGAC,kBAAkBzC,GACvB,OAAO5L,KAAKqD,eAAegL,kBAAkBzC,EAC/C,CACOzC,UAAUjG,GACVlD,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAaC,mBAItEvO,KAAK8E,SADH5B,GAGclD,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAaE,SAEvF,CACOC,cAAcC,GACnB1O,KAAKqD,eAAe1C,YAAYgO,WAAaD,EAC7C1O,KAAK2D,MAAMC,mBAAmBgL,oBAAoBC,aAEpD,CACOC,yBACL,IAAK9O,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAaC,iBACtE,OAEF,MAAMrL,EACJlD,KAAK8E,SAAW9E,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAaE,SAChFxO,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAaS,qBAKtE/O,KAAKqI,eADHnF,EAAI,EACgB,EACbA,EAAI,IACS,EAEAA,EARtBlD,KAAKqI,eAAiB,CAW1B,CACO5E,OAAOC,GACZ1D,KAAK2N,UAAUjK,GACX4F,OAAO0F,MAAMhP,KAAK4C,IAAIxB,GACxBpB,KAAKgO,YAELhO,KAAKiO,YAEHjO,KAAK2F,UAAa3F,KAAKgC,eAGvBhC,KAAKqG,eAAiBrG,KAAKkH,gBAAkB,MAG7ClH,KAAKwG,aACPxG,KAAKwN,SAEHxN,KAAKuG,YACPvG,KAAKyN,eAEHzN,KAAK+G,QAAU/G,KAAKmF,WACtBnF,KAAKmF,SAASoF,EAAI,EAClBvK,KAAKmF,SAAS8J,OAAS,EACvBjP,KAAKmF,SAAS+J,OAAS,GAErBlP,KAAKuH,eACPvH,KAAKmP,oBAEPnP,KAAKoP,eACLpP,KAAKqP,cACLrP,KAAKsP,kBACDtP,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAaiB,uBAGvEvP,KAAKwP,WAAW9L,IAClB,CACO2L,cACL,GAAIrP,KAAK8H,oBAAgCnF,IAAf3C,KAAKkI,MAC7B,GAAIlI,KAAKgI,cACPhI,KAAKkI,MAAM0D,MAAMU,IACftM,KAAK4C,IAAIvB,EACTrB,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAOpM,OAChEvD,KAAKiI,iBACL,KACFjI,KAAKkI,MAAM0D,MAAMW,KAAOvM,KAAK4C,IAAIxB,EAAI,UAErC,GACEpB,KAAKO,OAAS6L,EAAAA,GAAAA,UACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,kBACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,SACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,WACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,OACd,CACA,MAAMC,EAAYrM,KAAKoL,eACvBpL,KAAKkI,MAAM0D,MAAMU,IAAMD,EAAEzJ,IAAIvB,EAAI,KACjCrB,KAAKkI,MAAM0D,MAAMW,KAAOF,EAAEzJ,IAAIxB,EAAI,IACpC,MACEpB,KAAKkI,MAAM0D,MAAMU,IAAMtM,KAAK4C,IAAIvB,EAAI,KACpCrB,KAAKkI,MAAM0D,MAAMW,KAAOvM,KAAK4C,IAAIxB,EAAI,IAI7C,CACOkO,kBAEDtP,KAAKmF,SAAS2H,kBAAoB,IAChC9M,KAAK8G,oBAGP9G,KAAKuL,mBACLvL,KAAK4P,qBACL5P,KAAK8G,mBAAoB,EAG/B,CACOsI,eAGHpP,KAAKO,OAAS6L,EAAAA,GAAAA,OACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,cACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,YACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,YACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,YACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,YAIZpM,KAAK6I,YAAY3H,OAAS,KAK1B2O,EAAAA,EAAAA,IAAkB7P,KAAK6I,YAAY7I,KAAK6I,YAAY3H,OAAS,GAAIlB,KAAK4C,KAExE5C,KAAKiL,QAAS,GAGdjL,KAAKiL,QAAS,EACdjL,KAAK2E,aAAc,IAOvB,CACOmL,kBACL9P,KAAK6I,YAAc,GACnB7I,KAAK6I,YAAY1H,MAAK4O,EAAAA,EAAAA,IAAS/P,KAAK4C,MAAMmN,EAAAA,EAAAA,IAAS/P,KAAK4C,MAAMmN,EAAAA,EAAAA,IAAS/P,KAAK4C,KAC9E,CACOoN,oBAEL,IADAhQ,KAAK6I,YAAY1H,MAAK4O,EAAAA,EAAAA,IAAS/P,KAAK4C,MAC7B5C,KAAK6I,YAAY3H,OAAS,GAC/BlB,KAAK6I,YAAYoH,OAErB,CACOF,SAAS3O,EAAWC,GAE3B,CACO6O,gBACA,CAEAC,2BACA,CAEAC,SAASC,GACT,CAEAC,QACA,CAEAnB,qBAEHoB,EAAAA,EAAAA,IACE,CACEvQ,KAAK2D,MAAMC,mBAAmBuB,SAASqL,UAAUtN,EAAE9B,EACnDpB,KAAK2D,MAAMC,mBAAmBuB,SAASqL,UAAUtN,EAAE7B,EACnDrB,KAAK2D,MAAMC,mBAAmBuB,SAASqL,UAAUtN,EAAE5B,GAErD,CAACtB,KAAK4C,IAAIxB,EAAGpB,KAAK4C,IAAIvB,EAAGrB,KAAK4C,IAAItB,IAChC,IAEJtB,KAAKyQ,OAAOzQ,KAAKyF,0BAErB,CACOiL,eAAetP,EAAWC,GAC1B,CAEAsP,gBAAgBrD,GAChB,CAEAsD,UACA,CAEAC,eACL7Q,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiB9Q,KAAKwJ,SACjF,CACOoG,qBACL5P,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB+G,eAAe/Q,KAAKwJ,SAC/E,EA7nBoBvE,EACN+L,KAAuB,GCfhC,MAAMC,UAAmBhM,EAqB9B,uBAA8BqI,GACvB,CAEP,wBAA+BA,GACxB,CAEP,sBAA6B3J,EAAc2J,EAAmB/M,GACvD,CAEP,mBAA0B+M,GACnB,CAEP,iBAAwBA,GACjB,CAEP,eAAsBA,GACf,CAGPzN,YAAY8D,GAA4E,IAA9DvC,EAAC,uDAAG,EAAGC,EAAC,uDAAG,EAAGC,EAAC,uDAAG,EAAGf,EAAW,uDAAG6L,EAAAA,GAAAA,OAAc8E,EAAM,uDAAG,EAClFhM,MAAMvB,GAAO,KAvCRyD,kBAAY,OACZC,oBAAc,OACdM,OAAC,OACDwJ,aAAO,OACPC,aAAO,OACP7Q,UAAI,OACJ8Q,WAAK,OACLC,eAAgB,EAAM,KACtBC,WAAK,OACL3Q,WAAK,OAEL4Q,WAAK,OACLC,gBAAU,OACVC,gBAAU,OACVC,iBAAW,OAEXC,aAAO,OACP1J,WAAK,EAuBVlI,KAAK4C,IAAM,IAAIP,EAAAA,GAASjB,EAAGC,EAAGC,GAC9BtB,KAAKqH,eAAiB,GACtBrH,KAAKuR,MAAQ,GACbvR,KAAKY,MAAQ,GACbZ,KAAK2H,EAAIuJ,EACTlR,KAAKmR,QAAUD,EACflR,KAAKoR,QAAUF,EAAS,GACxBlR,KAAK0R,WAAa,EAClB1R,KAAK2R,YAAc,EACnB3R,KAAKO,KAAOA,EAEZP,KAAKqR,OAAQ,EACbrR,KAAK8F,UAAW,EAChB9F,KAAKyR,YAAa,EAClBzR,KAAK4R,SAAU,EACf5R,KAAK8H,eAAgB,EACrB9H,KAAK2D,MAAMkO,aAAa7R,MACxBA,KAAKmH,qBAAsB,EAK3BnH,KAAKoH,cAAe,EACpBpH,KAAKgF,UAAUjD,SAAU,EACzB/B,KAAKqI,eAAiB,EACtBrI,KAAK8N,oBACL9N,KAAK8P,kBACL9P,KAAKmJ,YACLnJ,KAAK8R,MACP,CACOA,OACL,CAEKtO,SAAqB,wDAExBxD,KAAKmQ,2BAKQ,IADbnQ,KAAK2D,MAAMC,mBAAmBgL,oBAAoBmD,cAAcC,QAAQC,qBACrEC,OAEClS,KAAK0F,aACP1F,KAAKmS,wBACLnS,KAAKmQ,2BAGX,CAOOgC,wBACLnS,KAAK8O,wBACP,CAEOsD,gBACL,MAAO,YACT,CACOC,SAASjR,EAAWC,GAEzB,OAAOiR,KAAKC,MAAMvS,KAAK4C,IAAIxB,EAAIA,IAAMpB,KAAK4C,IAAIxB,EAAIA,IAAMpB,KAAK4C,IAAIvB,EAAIA,IAAMrB,KAAK4C,IAAIvB,EAAIA,GAC1F,CACOmR,QAAQlF,IAEkB,IAA3BtN,KAAKuR,MAAMkB,QAAQnF,IAIvBtN,KAAKuR,MAAMpQ,KAAKmM,EAClB,CAEOoF,WAAWpF,GAChB,CAEKD,eAAeC,EAAmBC,GACvCvN,KAAK2D,MAAMC,mBAAmBD,MAAMgP,aAAUhQ,EAC9C3C,KAAK0H,KAAO,IAAIrF,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,EAAG,GACnCrB,KAAKwG,aAAc,CACrB,CACOgH,SACDxN,KAAKwG,cACPxG,KAAK4C,KAAMgQ,EAAAA,EAAAA,KAAK/N,EAAAA,EAAAA,IAAM7E,KAAK4C,IAAK,MAAOiC,EAAAA,EAAAA,IAAM7E,KAAK0H,KAAM,OACpDwF,EAAAA,EAAAA,IAAYlN,KAAK4C,IAAK5C,KAAK0H,MAAQ,IACrC1H,KAAKwG,aAAc,GAGzB,CAGOiH,eACLzN,KAAK4C,KAAMgQ,EAAAA,EAAAA,KACT/N,EAAAA,EAAAA,IAAM7E,KAAK4C,IAAK,KAChBiC,EAAAA,EAAAA,IAAM7E,KAAK0H,KAAM,MAEfwF,EAAAA,EAAAA,IAAYlN,KAAK4C,IAAK5C,KAAK0H,MAAQ,IACrC1H,KAAKwG,aAAc,GAGrBxG,KAAKmF,SAASoF,GAAK,GACrB,CACWO,YACT,OAAO9K,KAAK0F,UACd,CACWoF,UAAM5H,GACflD,KAAK0F,WAAaxC,CACpB,CAEOuN,SACA,CAEArD,KAAKhM,EAAWC,GACrBrB,KAAK4C,IAAIxB,EAAIA,EACbpB,KAAK4C,IAAIvB,EAAIA,CACf,CACOwR,cAAczR,EAAWC,GAC9B,QAAIrB,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,gBAIzCrG,KAAKqS,SAASjR,EAAGC,IAAMrB,KAAK2H,EAAI3H,KAAKqI,eAAiB,EAAIrI,KAAKqI,cACxE,CAYO0H,WAIuB,IAH5B3O,EAAS,uDAAGpB,KAAK4C,IAAIxB,EACrBC,EAAS,uDAAGrB,KAAK4C,IAAIvB,EAGjBoI,GAFK,2CAAGzJ,KAAK4C,IAAItB,EAEb,IAAI2P,EAAWjR,KAAK2D,MAAOvC,EAAGC,EAAGrB,KAAK4C,IAAItB,EAAGtB,KAAKO,KAAMP,KAAK2H,IACrE,GAAI8B,EACF,OAAOA,CAGX,CACWvG,QACT,OAAOlD,KAAK4C,GACd,CACWM,MAAEA,GACXlD,KAAK4C,IAAMM,CACb,CACWkH,cACT,OAAOpK,KAAK4F,YACd,CACWwE,YAAQlH,GACjBlD,KAAK4F,aAAe1C,CACtB,CACW1C,iBACT,OAAOR,KAAK+F,eACd,CACWvF,eAAW0C,GACpBlD,KAAK+F,gBAAkB7C,CACzB,CACO4P,SAuCL,MArCE,UACA9S,KAAKM,GADL,WAIAN,KAAKO,KAAKwS,WAJV,qBAaA/S,KAAK2H,EAbL,iBAkBA3H,KAAKuR,MAAMrQ,OAAO6R,WAlBlB,WAqBA/S,KAAKyG,gBArBL,YAwBAzG,KAAK+F,gBAxBL,YA2BA/F,KAAKqG,cA3BL,YA8BArG,KAAKmG,OA9BL,gBAiCAnG,KAAKgG,aAjCL,wBAoCAhG,KAAKsK,cAET,CACO0I,YAyBL,MAvBE,iBACAhT,KAAKM,GADL,6DASAN,KAAK2H,EATL,oBAYA3H,KAAKO,KAZL,oBAiBAP,KAAK+F,gBAjBL,sBAoBA/F,KAAKgG,aACL,MAGJ,CACOkK,gBACLlQ,KAAKuH,eAAgB,EACrBvH,KAAK0H,KAAO1H,KAAK2D,MAAMC,mBAAmBuB,SAASqL,UAAUtN,EAC7DlD,KAAKuG,YAAa,CACpB,CACO0M,OAELjT,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,CACtB,CACOkR,0BAA0B5F,GAC3BtN,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,eAAiBrG,KAAKuF,UAGtEvF,KAAK4C,IAAIxB,GAAKkM,EAAElM,EAAIkM,EAAE6F,KACtBnT,KAAK4C,IAAIvB,GAAKiM,EAAEjM,EAAIiM,EAAE8F,KACtBpT,KAAKmG,QAAS,EAEVnG,KAAKsK,iBACPtK,KAAKsK,eAAe4I,0BAA0B5F,GAC1CtN,KAAKsK,gBAAkBtK,KAAKsK,eAAe+I,aAE7CrT,KAAKsK,eAAe+I,WAAWC,GAAGlS,EAAIpB,KAAK4C,IAAIxB,EAC/CpB,KAAKsK,eAAe+I,WAAWC,GAAGjS,EAAIrB,KAAK4C,IAAIvB,IAInDrB,KAAKmQ,2BACP,CACOoD,UAAUnS,EAAWC,GAC1B,CAEK+H,UACL,MAAMlG,EAAgB,GAEtB,OADAA,EAAE/B,KAAKnB,KAAK4C,KACLM,CACT,CACOsG,SACL,GAAIxJ,KAAKuF,QACP,OAEF,GACEvF,KAAKO,OAAS6L,EAAAA,GAAAA,OACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,cACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,WACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,QACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,WAEd,OAGF,MAAM3C,EAAI,IAAIpJ,EACZL,KAAKM,GACLN,KAAKO,KACLP,KAAK+F,gBACL/F,KAAK4F,aACL5F,KAAKqG,eAEHrG,KAAKO,OAAS6L,EAAAA,GAAAA,eACZpM,KAAKqD,eAAe1C,YAAY6S,MAClC/J,EAAE3I,KAAO,CACP0S,IAAKxT,KAAKqD,eAAe1C,YAAY6S,MAG3C/J,EAAE1I,SAASf,KAAKoJ,WAEhB,MAAMvI,EAASb,KAAKqD,eAAeoQ,SAKnC,OAJI5S,IACF4I,EAAE5I,OAASA,GAGN4I,CACT,CACOiK,gBACL,OAAO1T,KAAKwJ,QACd,CACOmK,cAAcjQ,EAA+BR,GAClDlD,KAAKqH,eAAelG,KAAK+B,GACrBlD,KAAKqH,eAAenG,OAAS,GAC/BlB,KAAKqH,eAAe4I,OAGxB,CACOjC,YACDhO,KAAK4G,iBACH5G,KAAKmL,WACPnL,KAAK4M,mBACL5M,KAAK+H,aAAc,GAErB/H,KAAK4G,gBAAiB,EAE1B,CACOqH,WACAjO,KAAK4G,iBACJ5G,KAAK+H,aACP/H,KAAKuL,mBAEPvL,KAAK4G,gBAAiB,EAE1B,CACO4I,WAAW9L,GACX,CAEAkQ,eACD,CAECzD,2BACLnQ,KAAK8N,mBACP,CACW5C,YAAQhI,GACjBlD,KAAKyI,aAAevF,EAChBlD,KAAKyI,aACPzI,KAAK+F,iBAAkB,EAEvB/F,KAAK+F,iBAAkB,CAE3B,EC/YK,MAAM8N,EAOXhU,YAAYyE,GAAsB,KAN3BoK,MAAQ,EAAI,KACTpK,UAAI,OACJwP,UAAY,EAAI,KAChBC,UAAY,EAAI,KAChBC,4BAAsB,OACxBC,SAAW,EAEjBjU,KAAKsE,KAAOA,EACRtE,KAAKsE,KAAKjB,eAAe1C,YAAYuT,mBACvClU,KAAKmU,kBAET,CACO3Q,SACLxD,KAAKmU,mBACLnU,KAAKoU,wBACLpU,KAAKsE,KAAKjB,eAAe1C,YAAY0T,iBAAmBrU,KAAKiU,QAC/D,CACOG,wBACDpU,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmP,WAC9CtU,KAAKiU,UAAYjU,KAAK0O,MACtB1O,KAAKiU,SAAWjU,KAAKiU,SAAW,GAAM,GAAMjU,KAAKiU,WAEjDjU,KAAKiU,UAAYjU,KAAK0O,MACtB1O,KAAKiU,SAAWjU,KAAKiU,SAAW,EAAM,EAAMjU,KAAKiU,SAErD,CACOE,mBACL,IACGnU,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmP,WAC7CtU,KAAKsE,KAAK8F,SACVpK,KAAKsE,KAAK9D,YAKV,GAHAR,KAAK8T,WAAa9T,KAAKsE,KAAKX,MAAMC,mBAAmB6L,cAAcC,aAAa6E,WAAWC,gBAC3FxU,KAAK+T,UAAY,EACjB/T,KAAK0O,MAAQ1O,KAAK8T,UACd9T,KAAK8T,UAAY,EAAK,CACxB,MAAMW,GAAMC,EAAAA,EAAAA,IACV1U,KAAKsE,KAAKjB,eAAe1C,YAAYuT,kBAAkBS,WACvD3U,KAAKsE,KAAKjB,eAAe1C,YAAYiU,OAAOD,WAC5C3U,KAAK8T,WAEP9T,KAAKsE,KAAKjB,eAAe1C,YAAYuT,kBAAkBvM,EAAI8M,EAAI,GAC/DzU,KAAKsE,KAAKjB,eAAe1C,YAAYuT,kBAAkB7D,EAAIoE,EAAI,GAC/DzU,KAAKsE,KAAKjB,eAAe1C,YAAYuT,kBAAkBW,EAAIJ,EAAI,GAC/DzU,KAAKsE,KAAKjB,eAAe1C,YAAYuT,kBAAkBY,EAAIL,EAAI,GAC/DzU,KAAK0O,MAAQ1O,KAAK8T,SAEpB,OAKA,GAHA9T,KAAK8T,UAAY,EACjB9T,KAAK+T,WAAa/T,KAAKsE,KAAKX,MAAMC,mBAAmB6L,cAAcC,aAAa6E,WAAWQ,gBAC3F/U,KAAK0O,MAAQ1O,KAAK+T,UACd/T,KAAK+T,UAAY,EAAK,CACxB,MAAMU,GAAMC,EAAAA,EAAAA,IACV1U,KAAKsE,KAAKjB,eAAe1C,YAAYuT,kBAAkBS,WACvD3U,KAAKsE,KAAKjB,eAAe1C,YAAYqU,OAAOL,WAC5C3U,KAAK+T,WAEP/T,KAAKsE,KAAKjB,eAAe1C,YAAYuT,kBAAkBvM,EAAI8M,EAAI,GAC/DzU,KAAKsE,KAAKjB,eAAe1C,YAAYuT,kBAAkB7D,EAAIoE,EAAI,GAC/DzU,KAAKsE,KAAKjB,eAAe1C,YAAYuT,kBAAkBW,EAAIJ,EAAI,GAC/DzU,KAAKsE,KAAKjB,eAAe1C,YAAYuT,kBAAkBY,EAAIL,EAAI,GAC/DzU,KAAK0O,MAAQ1O,KAAK+T,SAEpB,CAEJ,CACWkB,cACT,OAAOjV,KAAKiU,QACd,ECvEK,MAAMiB,EAGXrV,YAAYyE,GAA0B,KAF/BA,UAAI,OACJ6Q,+BAAyB,EAE9BnV,KAAKsE,KAAOA,EACZtE,KAAKmV,0BAA4B,GACnC,CACO3R,SACDxD,KAAKsE,KAAK5C,IAAIyE,QAChBnG,KAAKsE,KAAK8Q,KAA4D,GAArDpV,KAAKsE,KAAK5C,IAAIiC,MAAMC,mBAAmBuB,SAASkQ,GACjErV,KAAKsE,KAAK4K,OAAS,IAEflP,KAAKsE,KAAK5C,IAAIqE,iBAChB/F,KAAKsE,KAAKgR,OAAStV,KAAKsE,KAAK5C,IAAIiC,MAAMC,mBAAmBuB,SAASkQ,GACnErV,KAAKsE,KAAK2K,OAAS,EACfjP,KAAKsE,KAAK5C,IAAIkE,aAChB5F,KAAKsE,KAAKwI,mBAAqB9M,KAAKmV,0BAEpCnV,KAAKsE,KAAKwI,kBAAoB,EAEhC9M,KAAKsE,KAAK5C,IAAI0E,SAAU,GACfpG,KAAKsE,KAAK5C,IAAIkE,cACvB5F,KAAKsE,KAAKgR,OAA8D,GAArDtV,KAAKsE,KAAK5C,IAAIiC,MAAMC,mBAAmBuB,SAASkQ,GACnErV,KAAKsE,KAAKwI,mBAAqB9M,KAAKmV,0BACpCnV,KAAKsE,KAAK2K,OAAS,EACnBjP,KAAKsE,KAAK5C,IAAI0E,SAAU,GAEpBpG,KAAKsE,KAAK5C,IAAI0E,UAAYpG,KAAKsE,KAAK5C,IAAIyE,QAC1CnG,KAAKsE,KAAK2K,QAAUjP,KAAKsE,KAAK5C,IAAIiC,MAAMC,mBAAmBuB,SAASkQ,GACpErV,KAAKsE,KAAKgR,MAAQtV,KAAKsE,KAAKwI,kBAAoB,EAC5C9M,KAAKsE,KAAK2K,OAAS,MACrBjP,KAAKsE,KAAK5C,IAAI0E,SAAU,IAEhBpG,KAAKsE,KAAK5C,IAAIyE,SACxBnG,KAAKsE,KAAK2K,QAAUjP,KAAKsE,KAAK5C,IAAIiC,MAAMC,mBAAmBuB,SAASkQ,GACpErV,KAAKsE,KAAKgR,MAAQtV,KAAKsE,KAAKwI,kBAAoB,GAGpD9M,KAAKsE,KAAK8Q,IAAM,EAChBpV,KAAKsE,KAAK4K,QAAU,KAEtBlP,KAAKsE,KAAKiG,GAAK,GACjB,CACOgL,qBACDvV,KAAKsE,KAAK5C,IAAIyE,SAGZnG,KAAKsE,KAAK5C,IAAIqE,gBAEZ/F,KAAKsE,KAAK5C,IAAIkE,aAChB5F,KAAKsE,KAAKwI,mBAAqB9M,KAAKmV,0BAEpCnV,KAAKsE,KAAKwI,kBAAoB,EAGvB9M,KAAKsE,KAAK5C,IAAIkE,aAEvB5F,KAAKsE,KAAKwI,mBAAqB9M,KAAKmV,0BAIhCnV,KAAKsE,KAAK5C,IAAI0E,UAAYpG,KAAKsE,KAAK5C,IAAIyE,QAE1CnG,KAAKsE,KAAKwI,kBAAoB,EAC1B9M,KAAKsE,KAAK2K,OAAS,MACrBjP,KAAKsE,KAAK5C,IAAI0E,SAAU,IAEhBpG,KAAKsE,KAAK5C,IAAIyE,SAExBnG,KAAKsE,KAAKwI,kBAAoB,GAOtC,EC1EK,MAAM0I,EAYX3V,YAAY6B,GAAqB,KAX1BA,SAAG,OACH+T,WAAK,OACLlL,EAAI,EAAI,KACR+K,MAAQ,EAAI,KACZxI,kBAAoB,EAAI,KACxBmC,OAAS,EAAI,KACbC,OAAS,EAAI,KACbkG,IAAM,EAAI,KAEVjB,sBAAgB,EAGrBnU,KAAK0B,IAAMA,EACX1B,KAAKyV,MAAQ,IAAIP,EAAMlV,MACvBA,KAAKmU,iBAAmB,IAAIN,EAAiB7T,KAAK0B,KAClD1B,KAAK0B,IAAIM,cAAe,CAC1B,CACOwN,WAAW9L,GACX,ECnBF,MAAM8R,UAA0BE,EAErC7V,YAAYyE,GACVY,MAAMZ,GAAM,KAFPA,UAAI,EAGTtE,KAAKsE,KAAOA,CACd,CACOkL,WAAW9L,GAchB,GAbA1D,KAAKyV,MAAMjS,SAGXxD,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKX,MAAMC,mBAAmBgL,oBAAoB+G,4BAQlFjS,EAAIkS,QAAUC,EAAAA,GAAAA,KAEV7V,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAAoBC,OAASC,EAAAA,GAAAA,QAC3G,OAGF,GAAIjW,KAAKsE,KAAK6C,oBACZ,OAGF,GAAInH,KAAKsE,KAAK/D,OAAS6L,EAAAA,GAAAA,YAErB,OAIEpM,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAa4H,UAAYlW,KAAKsE,KAAK6B,SAChGnG,KAAKsE,KAAK6B,QAAS,GAYrB,MAAMvD,EAAM5C,KAAKsE,KAAKX,MAAMC,mBAAmBuS,eAAeC,eAAeC,sBAAsBrW,KAAKsE,KAAK1B,KAEzG5C,KAAKsE,KAAK/D,OAAS6L,EAAAA,GAAAA,UAEjB,EAAIpM,KAAKsV,OAcPtV,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAKyB,gBAVxC/F,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKC,aAC1D/S,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBiC,EAAIxB,EACJwB,EAAIvB,EACJrB,KAAKsE,KAAK+D,eACVrI,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAA6B,EAAb3W,KAAKsV,OAChFtV,KAAKsE,KAAKsS,gBAkBN5W,KAAKsE,KAAKiN,MAAM,KAEhBvR,KAAKsE,KAAKiN,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,cAC5BpM,KAAKsE,KAAKiN,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,cAE5BpM,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKK,qBAC1DnT,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBiC,EAAIxB,EACJwB,EAAIvB,EACJrB,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAA6B,EAAb3W,KAAKsV,OAChFtV,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAAa8G,KAAKM,QAAU9W,KAAKsE,KAAK+D,eACtFrI,KAAKsE,KAAKsS,eACV5W,KAAKsE,KAAKiN,MAAM,GAAGlO,eAAe0T,MAAMC,eAQ9C,EAAIhX,KAAKsV,MACPtV,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAKyB,gBACtC/F,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKS,UAC1DvT,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBiC,EAAIxB,EACJwB,EAAIvB,EACJrB,KAAKsE,KAAK+D,eACVrI,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAC5C,EAAb3W,KAAKsV,QAITtV,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKA,KAC1D9S,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBiC,EAAIxB,EACJwB,EAAIvB,EACJrB,KAAKsE,KAAK+D,gBAKVrI,KAAKsE,KAAKiN,MAAM,KAEhBvR,KAAKsE,KAAKiN,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,cAC5BpM,KAAKsE,KAAKiN,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,cAE5BpM,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKU,UAC1DxT,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBiC,EAAIxB,EACJwB,EAAIvB,EACJrB,KAAKsE,KAAK+D,eACVrI,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAC5C,EAAb3W,KAAKsV,OAEPtV,KAAKsE,KAAKiN,MAAM,GAAGlO,eAAe0T,MAAMC,cAe5ChX,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKU,UAC1DxT,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBiC,EAAIxB,EACJwB,EAAIvB,EACJrB,KAAKsE,KAAK+D,eACVrI,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAC5C,EAAb3W,KAAKsV,QAOXtV,KAAKsE,KAAKsS,gBAAkB5W,KAAKsE,KAAK/D,OAAS6L,EAAAA,GAAAA,OACjDpM,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKW,aAC1DzT,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBiC,EAAIxB,EACJwB,EAAIvB,EACJrB,KAAKsE,KAAK+D,gBAEZrI,KAAKsE,KAAK8S,eAAiB,KAE3BpX,KAAKsE,KAAK8S,cAAgB,EAK5BpX,KAAKuK,GAAKvK,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,EACxD,EC1LK,IAAKgC,EAKAC,GADX,SAJWD,GAAAA,EAAU,cAAVA,EAAU,cAAVA,EAAU,wBAIrB,CAJWA,IAAAA,EAAU,KAYrB,SAPWC,GAAAA,EAAY,0BAAZA,EAAY,0BAAZA,EAAY,0BAAZA,EAAY,kCAAZA,EAAY,wBAAZA,EAAY,4BAOvB,CAPWA,IAAAA,EAAY,KCDjB,MAAMC,EAOX,eAAsBrU,GAA8B,IAAnBmH,EAAU,uDAAG,EAC5C,MAAMoK,GAAM+C,EAAAA,EAAAA,IAAStU,EAAGmH,GACxB,OAAO,IAAIkN,EAAO9C,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAChD,CACA,gBAAuB9M,EAAW0I,EAAWwE,GAC3C,OAAO,IAAI0C,EAAO5P,EAAG0I,EAAGwE,EAD+B,uDAAG,EAE5D,CACA,aAAoBlK,GAClB,OAAO8M,EAAAA,EAAAA,IAAQ9M,EAAEhD,EAAGgD,EAAE0F,EAAG1F,EAAEkK,EAC7B,CACAhV,YAAY8H,EAAW0I,EAAWwE,GAAqB,IAAVC,EAAC,uDAAG,EAAG,KAhB5C4C,QAAE,OACFC,QAAE,OACFC,QAAE,OACFC,QAAE,OACFC,qBAAe,EAarB9X,KAAK+X,aAAapQ,EAAG0I,EAAGwE,EAAGC,EAC7B,CACOiD,aAAapQ,EAAW0I,EAAWwE,GAAqB,IAAVC,EAAC,uDAAG,EACvD9U,KAAK0X,GAAK/P,EACV3H,KAAK2X,GAAKtH,EACVrQ,KAAK4X,GAAK/C,EACV7U,KAAK6X,GAAK/C,EACV9U,KAAKgY,cACP,CAEWrQ,QACT,OAAO3H,KAAK0X,EACd,CACW/P,MAAEzE,GACXlD,KAAK0X,GAAKxU,EACVlD,KAAKgY,cACP,CACW3H,QACT,OAAOrQ,KAAK2X,EACd,CACWtH,MAAEnN,GACXlD,KAAK2X,GAAKzU,EACVlD,KAAKgY,cACP,CACWnD,QACT,OAAO7U,KAAK4X,EACd,CACW/C,MAAE3R,GACXlD,KAAK4X,GAAK1U,EACVlD,KAAKgY,cACP,CACWlD,QACT,OAAO9U,KAAK6X,EACd,CACW/C,MAAE5R,GACXlD,KAAK6X,GAAK3U,EACVlD,KAAKgY,cACP,CACOC,WAIL,OAHAjY,KAAK2H,GAAK,IACV3H,KAAKqQ,GAAK,IACVrQ,KAAK6U,GAAK,IACH7U,IACT,CACO+P,WACL,OAAO,IAAIwH,EAAOvX,KAAK0X,GAAI1X,KAAK2X,GAAI3X,KAAK4X,GAAI5X,KAAK6X,GACpD,CACOlD,WACL,MAAO,CAAC3U,KAAK0X,GAAI1X,KAAK2X,GAAI3X,KAAK4X,GAAI5X,KAAK6X,GAC1C,CAEOK,gBACL,OAAOlY,KAAK8X,eACd,CACQE,eACNhY,KAAK8X,gBAAe,eAAW9X,KAAK0X,GAAE,aAAK1X,KAAK2X,GAAE,aAAK3X,KAAK4X,GAAE,aAAK5X,KAAK6X,GAAE,IAC5E,EC1EK,MAAMM,EAmBX,+BAAsCC,EAAiBC,GACrD,MAAMC,EAAOD,EAAME,OACnBH,EAAGI,gBAAgBT,aACjBO,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,IAE3BL,EAAGM,iBAAiBX,aAClBO,EAAKK,qBAAqB,GAC1BN,EAAME,OAAOI,qBAAqB,GAClCN,EAAME,OAAOI,qBAAqB,GAClCN,EAAME,OAAOI,qBAAqB,IAEpCP,EAAGQ,WAAaP,EAAME,OAAOM,UAC7BT,EAAG9U,MAAQ+U,EAAME,OAAOjV,MACxB8U,EAAG7U,OAAS8U,EAAME,OAAOhV,OACzB6U,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,qCACEX,EACAC,EACA5D,GAEA2D,EAAGI,gBAAgBT,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAC5D2D,EAAGM,iBAAiBX,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAI4D,EAAM9D,WAAWU,SAC1EmD,EAAGQ,WAAaP,EAAME,OAAOM,UAC7BT,EAAG9U,MAAQ+U,EAAME,OAAOjV,MACxB8U,EAAG7U,OAAS8U,EAAME,OAAOhV,OACzB6U,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,+BAAsCX,EAAiBC,GACrD,MAAMC,EAAOD,EAAM1I,OACnByI,EAAGI,gBAAgBT,aACjBO,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,IAE3BL,EAAGM,iBAAiBX,aAClBO,EAAKK,qBAAqB,GAC1BL,EAAKK,qBAAqB,GAC1BL,EAAKK,qBAAqB,GAC1BL,EAAKK,qBAAqB,IAG5BP,EAAGQ,WAAaP,EAAM1I,OAAOkJ,UAC7BT,EAAG9U,MAAQ+U,EAAM1I,OAAOrM,MACxB8U,EAAG7U,OAAS8U,EAAM1I,OAAOpM,OACzB6U,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,+BAAsCX,EAAiBC,EAAgCC,GAErFF,EAAGI,gBAAgBT,aAAaO,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAChEF,EAAGM,iBAAiBX,aAAaO,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAID,EAAM9D,WAAWU,QAAU,IAGvFmD,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,iCAAwCX,EAAiBC,GACvD,MAAMC,EAAOD,EAAMW,SACnBZ,EAAGa,kBAAkBlB,aACnBO,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,IAE7Bd,EAAGe,mBAAmBpB,aACpBO,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,IAE9BhB,EAAGQ,WAAaP,EAAMW,SAASH,UAC/BT,EAAGiB,wBAAwBhB,EAAM9D,WAAWwE,kBAC9C,CACA,iCAAwCX,EAAiBC,EAAgCC,GAEvFF,EAAGa,kBAAkBlB,aAAaO,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAClEF,EAAGe,mBAAmBpB,aAAaO,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAID,EAAM9D,WAAWU,QAAU,IACzFmD,EAAGQ,WAAaP,EAAMW,SAASH,UAC/BT,EAAGiB,wBAAwBhB,EAAM9D,WAAWwE,kBAC9C,CACA,qCAA4CX,EAAiBC,GAC3D,MAAMC,EAAOD,EAAMW,SACnBZ,EAAGa,kBAAkBlB,aACnBO,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,IAE7Bd,EAAGe,mBAAmBpB,aACpBO,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,IAE9BhB,EAAGQ,WAAaP,EAAMW,SAASH,UAC3BR,EAAM9D,WAAW+E,SACnBlB,EAAGI,gBAAgBT,aAAa,EAAG,EAAG,EAAG,GAEzCK,EAAGI,gBAAgBT,aAAa,IAAK,IAAK,IAAK,GAEjDK,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,qCAA4CX,EAAiBC,EAAgCC,GAE3FF,EAAGa,kBAAkBlB,aAAaO,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAClEF,EAAGe,mBAAmBpB,aAAaO,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAID,EAAM9D,WAAWU,QAAU,IACzFmD,EAAGQ,WAAaP,EAAMW,SAASH,UAC3BR,EAAM9D,WAAW+E,SACnBlB,EAAGI,gBAAgBT,aAAa,EAAG,EAAG,EAAG,GAEzCK,EAAGI,gBAAgBT,aAAa,IAAK,IAAK,IAAK,GAEjDK,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,uCACEX,EACAC,EACA5D,GAEA2D,EAAGa,kBAAkBlB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAC9D2D,EAAGe,mBAAmBpB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAI4D,EAAM9D,WAAWU,SAC5EmD,EAAGQ,WAAaP,EAAMW,SAASH,UAC/BT,EAAGiB,wBAAwBhB,EAAM9D,WAAWwE,kBAC9C,CACA,2CACEX,EACAC,EACA5D,GAEA2D,EAAGa,kBAAkBlB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAC9D2D,EAAGe,mBAAmBpB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAI4D,EAAM9D,WAAWU,SAC5EmD,EAAGQ,WAAaP,EAAMW,SAASH,UAC3BR,EAAM9D,WAAW+E,SACnBlB,EAAGI,gBAAgBT,aAAa,EAAG,EAAG,EAAG,GAEzCK,EAAGI,gBAAgBT,aAAa,IAAK,IAAK,IAAK,GAEjDK,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CAEA,8BAAqCX,EAAiBC,GACpD,MAAMC,EAAOD,EAAMkB,MACnBnB,EAAGI,gBAAgBT,aACjBO,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,IAE3BL,EAAGM,iBAAiBX,aAClBO,EAAKK,qBAAqB,GAC1BL,EAAKK,qBAAqB,GAC1BL,EAAKK,qBAAqB,GAC1BL,EAAKK,qBAAqB,IAE5BP,EAAGa,kBAAkBlB,aACnBO,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,IAE7Bd,EAAGe,mBAAmBpB,aACpBO,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,IAE9BhB,EAAGQ,WAAaN,EAAKO,UACrBT,EAAGiB,wBAAwBhB,EAAM9D,WAAWwE,kBAC9C,CACA,kCAAyCX,EAAiBC,GACxD,MAAMC,EAAOD,EAAMkB,MAGnBnB,EAAGa,kBAAkBlB,aACnBO,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,IAE7Bd,EAAGe,mBAAmBpB,aACpBO,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,IAE9BhB,EAAGQ,WAAaN,EAAKO,UACjBR,EAAM9D,WAAW+E,SACnBlB,EAAGI,gBAAgBT,aAAa,EAAG,EAAG,EAAG,GAEzCK,EAAGI,gBAAgBT,aAAa,IAAK,IAAK,IAAK,GAEjDK,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,oCACEX,EACAC,EAEAmB,GAEA,MAAM/E,EAAM+E,EAAYC,UACxBrB,EAAGI,gBAAgBT,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAC5D2D,EAAGM,iBAAiBX,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAI4D,EAAM9D,WAAWU,QAAU,IACpFmD,EAAGa,kBAAkBlB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAC9D2D,EAAGe,mBAAmBpB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAI4D,EAAM9D,WAAWU,SAC5EmD,EAAGQ,WAAaY,EAAYlW,MAC5B8U,EAAGiB,wBAAwBhB,EAAM9D,WAAWwE,kBAC9C,CACA,oCAA2CX,EAAiBC,EAAgC5D,GAC1F2D,EAAGI,gBAAgBT,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAC5D2D,EAAGM,iBAAiBX,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAI4D,EAAM9D,WAAWU,QAAU,IACpFmD,EAAGa,kBAAkBlB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAC9D2D,EAAGe,mBAAmBpB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAI4D,EAAM9D,WAAWU,SAC5EmD,EAAGQ,WAAaP,EAAMkB,MAAMV,UAC5BT,EAAGiB,wBAAwBhB,EAAM9D,WAAWwE,kBAC9C,CACA,wCACEX,EACAC,EAEAmB,GAEA,MAAM/E,EAAM+E,EAAYC,UACxBrB,EAAGa,kBAAkBlB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAC9D2D,EAAGe,mBAAmBpB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAC/D2D,EAAGQ,WAAaY,EAAYlW,MACxB+U,EAAM9D,WAAW+E,SACnBlB,EAAGI,gBAAgBT,aAAa,EAAG,EAAG,EAAG,GAEzCK,EAAGI,gBAAgBT,aAAa,IAAK,IAAK,IAAK,GAEjDK,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,wCAA+CX,EAAiBC,EAAgC5D,GAC9F2D,EAAGa,kBAAkBlB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAC9D2D,EAAGe,mBAAmBpB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAE3D4D,EAAM9D,WAAW+E,SACnBlB,EAAGI,gBAAgBT,aAAa,EAAG,EAAG,EAAG,GAEzCK,EAAGI,gBAAgBT,aAAa,IAAK,IAAK,IAAK,GAEjDK,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,gCAAuCX,EAAiBC,GACtD,MAAMC,EAAOD,EAAMqB,QACnBtB,EAAGI,gBAAgBT,aACjBO,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,IAE3BL,EAAGM,iBAAiBX,aAClBO,EAAKK,qBAAqB,GAC1BL,EAAKK,qBAAqB,GAC1BL,EAAKK,qBAAqB,GAC1BL,EAAKK,qBAAqB,IAE5BP,EAAGa,kBAAkBlB,aACnBO,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,IAE7Bd,EAAGe,mBAAmBpB,aACpBO,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,IAE9BhB,EAAGQ,WAAaN,EAAKO,UACrBT,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,gCAAuCX,EAAiBC,EAAgCsB,EAAsBC,GAE5GxB,EAAGI,gBAAgBT,aAAa6B,EAAS,GAAIA,EAAS,GAAIA,EAAS,GAAIA,EAAS,IAChFxB,EAAGM,iBAAiBX,aAAa6B,EAAS,GAAIA,EAAS,GAAIA,EAAS,GAAIvB,EAAM9D,WAAWU,QAAU,IACnGmD,EAAGa,kBAAkBlB,aAAa4B,EAAW,GAAIA,EAAW,GAAIA,EAAW,GAAIA,EAAW,IAC1FvB,EAAGe,mBAAmBpB,aAAa4B,EAAW,GAAIA,EAAW,GAAIA,EAAW,GAAItB,EAAM9D,WAAWU,QAAU,IAC3GmD,EAAGQ,WAAaP,EAAMqB,QAAQb,UAC9BT,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,oCAA2CX,EAAiBC,GAC1D,MAAMC,EAAOD,EAAMqB,QACnBtB,EAAGa,kBAAkBlB,aACnBO,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,IAE7Bd,EAAGe,mBAAmBpB,aACpBO,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,IAE9BhB,EAAGQ,WAAaN,EAAKO,UACjBR,EAAM9D,WAAW+E,SACnBlB,EAAGI,gBAAgBT,aAAa,EAAG,EAAG,EAAG,GAEzCK,EAAGI,gBAAgBT,aAAa,IAAK,IAAK,IAAK,GAEjDK,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,oCAA2CX,EAAiBC,EAAgCC,GAE1FF,EAAGa,kBAAkBlB,aAAaO,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAClEF,EAAGe,mBAAmBpB,aAAaO,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAID,EAAM9D,WAAWU,QAAU,IAErFoD,EAAM9D,WAAW+E,SACnBlB,EAAGI,gBAAgBT,aAAa,EAAG,EAAG,EAAG,GAEzCK,EAAGI,gBAAgBT,aAAa,IAAK,IAAK,IAAK,GAEjDK,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,sCACEX,EACAC,EACA5D,EACArQ,GAEA,MAAMkU,EAAOD,EAAMqB,QACnBtB,EAAGI,gBAAgBT,aAAa3T,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAE5DA,EAAK,GAAKiU,EAAM9D,WAAWU,QAAU,EACvCmD,EAAGM,iBAAiBX,aAClB3T,EAAK,GACLA,EAAK,GACLA,EAAK,GACLA,EAAK,GAAKiU,EAAM9D,WAAWU,SAG7BmD,EAAGM,iBAAiBX,aAAa3T,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAI,IAG9DgU,EAAGa,kBAAkBlB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAC9D2D,EAAGe,mBAAmBpB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAI4D,EAAM9D,WAAWU,SAC5EmD,EAAGQ,WAAaN,EAAKO,UACrBT,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,0CACEX,EACAC,EACA5D,EACArQ,GAEA,MAAMkU,EAAOD,EAAMqB,QACnBtB,EAAGa,kBAAkBlB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAC9D2D,EAAGe,mBAAmBpB,aAAatD,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAI4D,EAAM9D,WAAWU,SAC5EmD,EAAGQ,WAAaN,EAAKO,UACjBR,EAAM9D,WAAW+E,SACnBlB,EAAGI,gBAAgBT,aAAa,EAAG,EAAG,EAAG,GAEzCK,EAAGI,gBAAgBT,aAAa,IAAK,IAAK,IAAK,GAEjDK,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CAEA,2BAAkCX,EAAiBC,GACjD,MAAMC,EAAOD,EAAMwB,SACnBzB,EAAGI,gBAAgBT,aACjBO,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,IAE3BL,EAAGa,kBAAkBlB,aACnBO,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,IAE7Bd,EAAGQ,WAAaN,EAAKO,UACrBT,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,mCAA0CX,EAAiBC,GACzD,MAAMC,EAAOD,EAAMW,SACbc,EAAazB,EAAM9D,WAAWU,QACpCmD,EAAGa,kBAAkBlB,aACnBO,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BY,GAEF1B,EAAGe,mBAAmBpB,aACpBO,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5BU,GAEF1B,EAAGQ,WAAaP,EAAMW,SAASH,UAC/BT,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,uCAA8CX,EAAiBC,GAC7D,MAAMC,EAAOD,EAAMW,SACbc,EAAazB,EAAM9D,WAAWU,QACpCmD,EAAGa,kBAAkBlB,aACnBO,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BY,GAEF1B,EAAGe,mBAAmBpB,aACpBO,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5BU,GAEF1B,EAAGQ,WAAaP,EAAMW,SAASH,UAC3BR,EAAM9D,WAAW+E,SACnBlB,EAAGI,gBAAgBT,aAAa,EAAG,EAAG,EAAG+B,GAEzC1B,EAAGI,gBAAgBT,aAAa,IAAK,IAAK,IAAK+B,GAEjD1B,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,kCAAyCX,EAAiBC,GACxD,MAAMC,EAAOD,EAAMqB,QACbI,EAAazB,EAAM9D,WAAWU,QACpCmD,EAAGI,gBAAgBT,aACjBO,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,GACzBH,EAAKG,oBAAoB,GACzBqB,GAEF1B,EAAGM,iBAAiBX,aAClBO,EAAKK,qBAAqB,GAC1BL,EAAKK,qBAAqB,GAC1BL,EAAKK,qBAAqB,GAC1BmB,GAEF1B,EAAGa,kBAAkBlB,aACnBO,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BY,GAEF1B,EAAGe,mBAAmBpB,aACpBO,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5BU,GAEF1B,EAAGQ,WAAaN,EAAKO,UACrBT,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CACA,sCAA6CX,EAAiBC,GAC5D,MAAMC,EAAOD,EAAMqB,QACbI,EAAazB,EAAM9D,WAAWU,QACpCmD,EAAGa,kBAAkBlB,aACnBO,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BZ,EAAKY,sBAAsB,GAC3BY,GAEF1B,EAAGe,mBAAmBpB,aACpBO,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5Bd,EAAKc,uBAAuB,GAC5BU,GAEF1B,EAAGQ,WAAaN,EAAKO,UACjBR,EAAM9D,WAAW+E,SACnBlB,EAAGI,gBAAgBT,aAAa,EAAG,EAAG,EAAG+B,GAEzC1B,EAAGI,gBAAgBT,aAAa,IAAK,IAAK,IAAK+B,GAEjD1B,EAAGU,kBAAkBT,EAAM9D,WAAWwE,kBACxC,CAwBA,sBAA6BX,EAAiB2B,GAC5CA,EAAMvB,gBAAkBJ,EAAGa,kBAAkBlJ,WAC7CgK,EAAMd,kBAAoBb,EAAGI,gBAAgBzI,UAC/C,CACA,4BAAmCqI,EAAiB2B,GAClDA,EAAMvB,gBAAkBJ,EAAGa,kBAAkBlJ,WAC7CgK,EAAMd,kBAAoBb,EAAGI,gBAAgBzI,UAC/C,CAEA,gBAAuBqI,EAAiB2B,GACtCA,EAAMvB,gBAAkBJ,EAAGI,gBAAgBzI,WAC3CgK,EAAMrB,iBAAmBN,EAAGM,iBAAiB3I,WAC7CgK,EAAMd,kBAAoBb,EAAGa,kBAAkBlJ,WAC/CgK,EAAMZ,mBAAqBf,EAAGe,mBAAmBpJ,WACjDgK,EAAMC,SAAW5B,EAAG4B,SACpBD,EAAMnB,WAAaR,EAAGQ,UACxB,CACA/Y,YAAYwD,GAAkC,KAlhBvCA,oBAAc,OACdgR,sBAAgB,OAChBH,uBAAiB,OACjBU,YAAM,OACNI,YAAM,OACN1R,MAAQ,GAAG,KACXC,OAAS,GAAG,KACZoL,WAAa,EAAE,KACff,YAAc,EAAE,KACfqM,UAA2BtX,EAAU,KACrC6V,qBAAe,OACfE,sBAAgB,OAChBO,uBAAiB,OACjBE,wBAAkB,OAClBP,gBAAU,OACVoB,SAAoBnE,EAAAA,GAAAA,MAAc,KAClCqE,MAAkB,GAAG,KACrBC,MAAcxR,EAAAA,GAAAA,OAkgBhBtF,IACFrD,KAAKqD,eAAiBA,EACtBrD,KAAK4N,YAAcvK,EAAe3B,IAAIiC,MAAMC,mBAAmB4H,wBAAwBoC,aAEzF5N,KAAKwY,gBAAkB,IAAIjB,EAAO,EAAG,EAAG,GACxCvX,KAAK0Y,iBAAmB,IAAInB,EAAO,EAAG,EAAG,GACzCvX,KAAKiZ,kBAAoB,IAAI1B,EAAO,EAAG,EAAG,GAC1CvX,KAAKmZ,mBAAqB,IAAI5B,EAAO,EAAG,EAAG,GAC3CvX,KAAK4Y,WAAa,CACpB,CACOE,kBAAkBsB,GACvBpa,KAAKkU,kBAAoBlU,KAAKwY,gBAAgBzI,WAC9C/P,KAAK4U,OAAS5U,KAAKwY,gBAAgBzI,WACnC/P,KAAKgV,OAAShV,KAAK0Y,iBAAiB3I,WACpC,MAAM0E,GAAM4F,EAAAA,EAAAA,IACV,CAACra,KAAKgV,OAAOrN,EAAG3H,KAAKgV,OAAO3E,EAAGrQ,KAAKgV,OAAOH,EAAG7U,KAAKgV,OAAOF,GAC1D,EACAsF,EACA,GAEFpa,KAAKgV,OAAOrN,EAAI8M,EAAI,GACpBzU,KAAKgV,OAAO3E,EAAIoE,EAAI,GACpBzU,KAAKgV,OAAOH,EAAIJ,EAAI,GACpBzU,KAAKgV,OAAOF,EAAIL,EAAI,EACtB,CACO4E,wBAAwBe,GAC7Bpa,KAAKkU,kBAAoBlU,KAAKiZ,kBAAkBlJ,WAChD/P,KAAK4U,OAAS5U,KAAKiZ,kBAAkBlJ,WACrC/P,KAAKgV,OAAShV,KAAKmZ,mBAAmBpJ,WACtC,MAAM0E,GAAM4F,EAAAA,EAAAA,IACV,CAACra,KAAKgV,OAAOrN,EAAG3H,KAAKgV,OAAO3E,EAAGrQ,KAAKgV,OAAOH,EAAG7U,KAAKgV,OAAOF,GAC1D,EACAsF,EACA,GAEFpa,KAAKgV,OAAOrN,EAAI8M,EAAI,GACpBzU,KAAKgV,OAAO3E,EAAIoE,EAAI,GACpBzU,KAAKgV,OAAOH,EAAIJ,EAAI,GACpBzU,KAAKgV,OAAOF,EAAIL,EAAI,EACtB,CACW6F,8BACT,OAAOta,KAAKkU,kBAAkBgE,eAChC,CACWqC,gBACT,OAAOva,KAAKwY,gBAAgBN,eAC9B,CACWsC,qBACT,OAAOxa,KAAK0Y,iBAAiBR,eAC/B,CACWuC,kBACT,OAAOza,KAAKiZ,kBAAkBf,eAChC,CACWwC,uBACT,OAAO1a,KAAKmZ,mBAAmBjB,eACjC,CACWW,gBACT,OAAO7Y,KAAK4Y,UACd,CACWhD,cACT,OAAO5V,KAAKga,QACd,CACWW,WACT,OAAO3a,KAAKka,KACd,CACWS,SAAKzX,GACdlD,KAAKka,MAAQhX,CACf,CACWsQ,UACT,OAAOxT,KAAKia,IACd,CACWzG,QAAItQ,GACblD,KAAKia,KAAO/W,EACZlD,KAAKqD,eAAe3B,IAAIiC,MAAMC,mBAAmB6L,cAAcmL,UAAUC,QAAQ3X,EACnF,CACWgH,WACT,OAAOlK,KAAKma,KACd,CACWjQ,SAAKhH,GACdlD,KAAKma,MAAQjX,CACf,ECpmBK,MAAM4X,EAAO,cAAD,KACVjW,MAAQ,EAAE,KACVvB,MAAQ,EAAE,KACV0T,aAA6BM,EAAayD,WAAW,KACrDC,WAAyB3D,EAAW4D,UAAW,EAEjD,MAAMC,EASXrb,YAAY6B,GAAqB,KAR1BA,SAAG,OACHf,iBAAW,OACXwa,qBAAe,OACfC,UAAW,EAAM,KACjBrE,WAAK,OACFsE,cAA0B,CAAC,EAAG,EAAG,EAAG,GAAG,KACvCC,aAAyB,CAAC,EAAG,EAAG,EAAG,GAG3Ctb,KAAK0B,IAAMA,EACX1B,KAAK+W,MAAQ,IAAI+D,EACjB9a,KAAKW,YAAc,IAAIwX,EACvBnY,KAAKmb,gBAAkB,IAAIhD,CAC7B,CACOzN,cAEP,CACOyD,cACA,CAGAE,kBAAkBzC,GACvB,OAAO,CACT,CACOiC,QAAQ3K,GACR,CAGAuQ,SAEP,CAEU8H,YAAY3P,GACpB,OAAO,CACT,ECzCK,MAAMsP,UAAuBM,EAMlC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KANN+Z,aAAO,OACP9a,iBAAW,OACXwa,qBAAe,OACdO,uBAAiB,OACjBC,yBAAmB,EAGzB3b,KAAKW,YAAc,IAAIwX,EACvBnY,KAAKmb,gBAAkB,IAAIhD,EAC3BnY,KAAK0b,kBAAoB,IAAIvD,EAC7BnY,KAAK2b,oBAAsB,IAAIxD,EAC/BnY,KAAKmO,aACP,CACOA,cACL,CAEKyN,mBAAmBxD,GACxBpY,KAAKW,YAAcyX,EACnBD,EAAYpI,SAASqI,EAAIpY,KAAK0b,mBAC9BvD,EAAY0D,eAAezD,EAAIpY,KAAK2b,oBACtC,CACOE,eAAe3Y,GAElBlD,KAAKW,YADHuC,EACiBlD,KAAK2b,oBAEL3b,KAAK0b,iBAE5B,EC9BK,MAAMrX,EAEXxE,YAAYyE,GAAe,KADpBA,UAAI,EAETtE,KAAKsE,KAAOA,CACd,CACOd,OAAOE,GACP1D,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIC,YAI5D/D,KAAKuE,WAAWb,EAClB,CACOoY,KAAKpY,GACV,IAAIc,EAAMxE,KAAKsE,KAAK1B,IACpBc,EAAIO,YACJP,EAAIe,IAAID,EAAIpD,EAAGoD,EAAInD,EAAG,EAAG,EAAG,MAC5BqC,EAAIS,YACJT,EAAIM,UAAY,UAChBN,EAAIU,OAEJV,EAAIkB,SADS,IACMJ,EAAIpD,EAAGoD,EAAInD,EAAI,GAElCmD,EAAMxE,KAAKsE,KAAK1B,IAChBc,EAAIO,YACJP,EAAIe,IAAID,EAAIpD,EAAGoD,EAAInD,EAAG,EAAG,EAAG,MAC5BqC,EAAIS,YACJT,EAAIM,UAAY,UAChBN,EAAIU,OAEJV,EAAIkB,SAVS,IAUMJ,EAAIpD,EAAGoD,EAAInD,EAAI,GACpC,CACOkD,WAAWb,GAChB,MAAMc,EAAMxE,KAAKsE,KAAK1B,IACtBc,EAAIO,YACJP,EAAIe,IAAID,EAAIpD,EAAGoD,EAAInD,EAAG,EAAG,EAAG,MAC5BqC,EAAIS,YACJT,EAAIM,UAAY,UAChBN,EAAIU,OACJ,MAAMM,EAAI,uBAAmB1E,KAAKsE,KAAKK,aACvCjB,EAAIkB,SAASF,EAAMF,EAAIpD,EAAI,GAAIoD,EAAInD,EAAI,IAEvC,MAAMd,EAAI,gBAAYP,KAAKsE,KAAK/D,MAChCmD,EAAIkB,SAASrE,EAAMiE,EAAIpD,EAAI,IAAKoD,EAAInD,EAAI,GAC1C,EC5BK,MAAM0a,UAAe9K,EAe1B+K,iCAAiCrY,GAC/B,IAAK,IAAI1C,EAAI,EAAGA,EAAI0C,EAAMsY,WAAW/a,OAAS,IAAKD,EAEjD,IAAK,IAAIib,EAAIjb,EAAI,EAAGib,EAAIvY,EAAMsY,WAAW/a,SAAUgb,EAAG,EACxChP,EAAAA,EAAAA,IAAYvJ,EAAMsY,WAAWhb,GAAG2B,IAAKe,EAAMsY,WAAWC,GAAGtZ,KAC3D,IACRe,EAAMsY,WAAWC,GAAGtZ,IAAMe,EAAMsY,WAAWhb,GAAG2B,IAElD,CAEJ,CACAoZ,8BAA8BvS,GAyB5B,CAGFuS,eAAeG,GACb,MAAMnb,EAAiB,GACvB,IAAIC,EAAIkb,EAAIjb,OACZ,KAAOD,KACLD,EAAGG,KAAKgb,EAAIlb,GAAG2B,KAEjB,OAAO5B,CACT,CACAgb,0BAA0BvS,GACxB,MAAMvF,EAAOuF,EAAE8H,MAAM,GACrB,OAAIrN,EAAKiY,IAAI,KAAO1S,EACX,EACEvF,EAAKiY,IAAI,KAAO1S,EAClB,EACEvF,EAAKiY,IAAI,KAAO1S,EAClB,EACEvF,EAAKiY,IAAI,KAAO1S,EAClB,GAED,CACV,CACAuS,mBAAmBrY,EAAcvC,EAAWC,GAC1C,IAAK,IAAIJ,EAAI0C,EAAMsY,WAAW/a,OAAS,EAAGD,GAAK,IAAKA,EAClD,GAAI0C,EAAMsY,WAAWhb,GAAG+E,cAAgBrC,EAAMsY,WAAWhb,GAAG4R,cAAczR,EAAGC,GAC3E,OAAOsC,EAAMsY,WAAWhb,EAI9B,CACA+a,4BAA4BrY,GAC1B,MAAMyY,EAAOzY,EAAMsY,WACnB,IAAK,IAAIhb,EAAI,EAAGA,EAAImb,EAAKlb,SAAUD,GACW,IAAxC0C,EAAMsY,WAAWhb,GAAG8E,iBACtBpC,EAAMsY,WAAWhb,GAAGwP,QAG1B,CACAuL,+BAA+BrY,GAC7B,IAAK,IAAI1C,EAAI,EAAGA,EAAI0C,EAAMsY,WAAW/a,SAAUD,EAC7C0C,EAAMsY,WAAWhb,GAAG8E,iBAAkB,CAE1C,CACAiW,uBAAuBrY,EAAc2J,GACnC,IAAK,IAAIrM,EAAI,EAAGA,EAAI0C,EAAMsY,WAAW/a,SAAUD,GACD,IAAxC0C,EAAMsY,WAAWhb,GAAG8E,iBAA6BpC,EAAMsY,WAAWhb,GAAG2E,cACvEjC,EAAMsY,WAAWhb,GAAGiS,0BAA0B5F,IAEP,IAArC3J,EAAMsY,WAAWhb,GAAG2E,cACtBjC,EAAMsY,WAAWhb,GAAGiS,0BAA0B5F,EAGpD,CACA0O,4BAA4BrY,EAAc0M,GAAkD,IAArCtJ,EAAM,wDAC3D,MAAMyP,EAAO,IAAIuF,EAAOpY,EAAO0M,EAAEjP,EAAGiP,EAAEhP,EAAGgP,EAAE/O,EAAGyF,GAK9C,OAJAyP,EAAK5T,IAAIyZ,EAAIhM,EAAEgM,EACf7F,EAAK9E,WAAarB,EAAEgM,EACpB7F,EAAK7E,YAActB,EAAEgM,EACrB7F,EAAKrP,qBAAsB,EACpBqP,CACT,CACAwF,uBAAuBrY,EAAc0M,GAAkD,IAArCtJ,EAAM,wDACtD,MAAMyP,EAAO,IAAIuF,EAAOpY,EAAO0M,EAAEnQ,GAAImQ,EAAElQ,GAAI,EAAG4G,GAK9C,OADAyP,EAAKrP,qBAAsB,EACpBqP,CACT,CACAwF,sBAAsBrY,EAAc0M,GAAkD,IAArCtJ,EAAM,wDAAUuV,EAAU,wDACzE,OAAOP,EAAOQ,qBAAqB5Y,EAAO0M,EAAGtJ,EAAQuV,EACvD,CACAN,gBAAgBrY,EAAc0M,GAQjB,IAAI0L,EAAOpY,EAAO0M,EAAEzP,MAAM,GAAGV,GAAImQ,EAAEzP,MAAM,GAAGT,GAAI,GACxDI,KAAO6L,EAAAA,GAAMiE,EAAE9P,KAGpB,CAEA,uBAA8B+M,GACvB,CAEP,wBAA+BA,GACxB,CAEP,sBAA6B3J,EAAc2J,GACzC,QAAsB3K,IAAlBgB,EAAMgP,aASH,CACK,IAAIoJ,EAAOpY,EAAO2J,EAAElM,EAAGkM,EAAEjM,EAAG,GACpCiP,OACJ,CACF,CACAzQ,YACE8D,GAOC,IANDvC,EAAC,uDAAG,EACJC,EAAC,uDAAG,EACJC,EAAC,uDAAG,EACJyF,EAAM,wDACNxG,EAAW,uDAAG6L,EAAAA,GAAAA,MAGdlH,MAAMvB,EAAOvC,EAAGC,EAAGC,EAAGf,GAAM,KAvKvB8C,oBAAc,OACd8B,cAAQ,OACRqX,OAA0B,GAAG,KAE7BC,iBAAW,OACXC,QAAU,EAAE,KAEZ9b,WAAK,OAELwW,cAAgB,EAAI,KACpBhP,eAAS,OACRuU,iBAAkB,EA6JxB3c,KAAK4c,gBAEL5c,KAAK+G,OAASA,EACd/G,KAAKwc,OAAS,GACdxc,KAAKyc,aAAc,EACnBzc,KAAKoI,UAAY,IAAI/D,EAAUrE,MAI/BA,KAAK2D,MAAMkZ,UAAU7c,KACvB,CACO8R,OAEL9R,KAAKyR,YAAa,CAEpB,CACOmL,gBACL5c,KAAKqD,eAAiB,IAAI6X,EAAelb,MACzCA,KAAKmF,SAAW,IAAIqQ,EAAkBxV,KACxC,CACOoS,gBACL,MAAO,QACT,CACOI,QAAQlF,IAEkB,IAA3BtN,KAAKuR,MAAMkB,QAAQnF,KAGvBtN,KAAKO,KAAO6L,EAAAA,GAAAA,MACZpM,KAAKuR,MAAMpQ,KAAKmM,GACZtN,KAAKuR,MAAM,IACbvR,KAAKqD,eAAeuY,mBAAmB5b,KAAKuR,MAAM,GAAGlO,eAAe8X,iBAExE,CACO2B,QAAQzQ,IACkB,IAA3BrM,KAAKY,MAAM6R,QAAQpG,KAGvBA,EAAE9L,KAAO6L,EAAAA,GAAAA,MACTpM,KAAKY,MAAMO,KAAKkL,GAClB,CACO0Q,cAAc1Q,GACnB,IAAK,MAAM2Q,KAAMhd,KAAKuR,MAAO,CAC3B,MAAMjE,EAAe0P,EACrB,IAAIC,GAAM/P,EAAAA,EAAAA,IAAYI,EAAE4P,GAAGta,IAAKyJ,EAAEzJ,KAClC,GAAIqa,EAAM,IACR,OAAO3P,EAAE4P,GAGX,GADAD,GAAM/P,EAAAA,EAAAA,IAAYI,EAAE6P,GAAGva,IAAKyJ,EAAEzJ,KAC1Bqa,EAAM,IACR,OAAO3P,EAAE6P,EAEb,CAEF,CAEOzK,WAAWpF,GAGhBtN,KAAKuR,MAAM6L,OAAOpd,KAAKuR,MAAMkB,QAAQnF,GAAW,EAClD,CACO+P,oBAAoB/P,GACzBtN,KAAKwc,OAAOY,OAAOpd,KAAKwc,OAAO/J,QAAQnF,GAAI,EAC7C,CACOD,eAAeC,EAAmBC,GACvCvN,KAAK2D,MAAMgP,aAAUhQ,EACrB3C,KAAK0H,KAAO,IAAIrF,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,EAAG,GACnCrB,KAAKwG,aAAc,CACrB,CACO8W,aACL,IAAK,MAAMN,KAAMhd,KAAKuR,MAAO,CAC3B,MAAMjE,EAAe0P,EACjB1P,EAAE4P,GAAG5c,KAAON,KAAKM,KACnBgN,EAAE4P,GAAGta,IAAM,IAAIP,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAGpB,KAAK4C,IAAIvB,EAAGrB,KAAK4C,IAAItB,IAEvDgM,EAAE6P,GAAG7c,KAAON,KAAKM,KACnBgN,EAAE6P,GAAGva,IAAM,IAAIP,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAGpB,KAAK4C,IAAIvB,EAAGrB,KAAK4C,IAAItB,GAE7D,CACF,CACOkM,SACDxN,KAAKwG,cACPxG,KAAK4C,KAAMgQ,EAAAA,EAAAA,KAAK/N,EAAAA,EAAAA,IAAM7E,KAAK4C,IAAK,MAAOiC,EAAAA,EAAAA,IAAM7E,KAAK0H,KAAM,OACpDwF,EAAAA,EAAAA,IAAYlN,KAAK4C,IAAK5C,KAAK0H,MAAQ,IACrC1H,KAAKwG,aAAc,GAIzB,CACOiH,eACLzN,KAAK4C,KAAMgQ,EAAAA,EAAAA,KACT/N,EAAAA,EAAAA,IAAM7E,KAAK4C,IAAK,KAChBiC,EAAAA,EAAAA,IAAM7E,KAAK0H,KAAM,MAEfwF,EAAAA,EAAAA,IAAYlN,KAAK4C,IAAK5C,KAAK0H,MAAQ,MACrC1H,KAAKgC,cAAe,EACpBhC,KAAKwG,aAAc,GAErBxG,KAAKmF,SAASoF,GAAK,GACrB,CAYO6C,KAAKhM,EAAWC,GACjBrB,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,gBAGhDrG,KAAK4C,IAAIxB,EAAIA,EACbpB,KAAK4C,IAAIvB,EAAIA,EAEf,CACOkc,UAAUjQ,GACftN,KAAKwc,OAAOrb,KAAKmM,GACbtN,KAAKwc,OAAO,IACdxc,KAAKqD,eAAeuY,mBAAmB5b,KAAKwc,OAAO,GAAGgB,OAAOna,eAAe8X,iBAG9Enb,KAAKyc,aAAc,CACrB,CAEWvZ,QACT,OAAOlD,KAAK4C,GACd,CACWM,MAAEA,GACXlD,KAAK4C,IAAMM,CACb,CACWkH,cACT,OAAOpK,KAAK4F,YACd,CACWwE,YAAQlH,GACblD,KAAKuR,MAAM,IAAMvR,KAAKuR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,kBAExCpM,KAAK6S,cACH7S,KAAK2D,MAAMC,mBAAmB4H,wBAAwBiS,EAAErc,EACxDpB,KAAK2D,MAAMC,mBAAmB4H,wBAAwBiS,EAAEpc,IAGtDrB,KAAKmF,SAASmQ,MAAQ,KACxBtV,KAAKmF,SAASmQ,MAAQ,GAI5BtV,KAAK4F,aAAe1C,CAEtB,CACW1C,iBACT,OAAOR,KAAK+F,eACd,CACWvF,eAAW0C,GAEpBlD,KAAK+F,gBAAkB7C,EAClBA,IACHlD,KAAK4W,eAAiB1T,EAE1B,CACW0T,qBACT,OAAO5W,KAAK2c,eACd,CACW/F,mBAAe1T,GACxBlD,KAAK2c,gBAAkBzZ,EACvBlD,KAAKqD,eAAewY,eAAe3Y,EAGrC,CAEOqI,mBACDvL,KAAKuR,MAAM,IACbvR,KAAKuR,MAAM,GAAGhG,kBAElB,CACOqB,mBACD5M,KAAKuR,MAAM,IACbvR,KAAKuR,MAAM,GAAG3E,kBAElB,CAEOiG,cAAczR,EAAWC,GAC9B,QAAKrB,KAAKuR,MAAM,KAIZvR,KAAKqS,SAASjR,EAAGC,IAAMrB,KAAK2H,EAAI,EAAI3H,KAAK2D,MAAMC,mBAAmB4H,wBAAwBoC,cACxF5N,KAAKuR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,QAAgBpM,KAAKuR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,YAChEpM,KAAK2D,MAAM+Z,UAAY1d,OAElB,GAIX,CACO2d,eACL,GAAI3d,KAAKwc,OAAOtb,OAAS,EAAG,CAC1B,IAAI0c,EACAC,EAgBJ,GAfI7d,KAAKwc,OAAO,GAAGU,KAAOld,MACxB4d,EAAU5d,KAAKwc,OAAO,GAAGW,GACzBnd,KAAKwc,OAAO,GAAGsB,GAAGC,eAElBH,EAAU5d,KAAKwc,OAAO,GAAGU,GACzBld,KAAKwc,OAAO,GAAGsB,GAAGC,cAEhB/d,KAAKwc,OAAO,GAAGU,KAAOld,MACxB6d,EAAU7d,KAAKwc,OAAO,GAAGW,GACzBnd,KAAKwc,OAAO,GAAGsB,GAAGC,eAElBF,EAAU7d,KAAKwc,OAAO,GAAGU,GACzBld,KAAKwc,OAAO,GAAGsB,GAAGC,cAGhBH,GAAWC,EAAS,CACtBD,EAAQP,oBAAoBrd,KAAKwc,OAAO,IACxCqB,EAAQR,oBAAoBrd,KAAKwc,OAAO,IAExC,MAAMwB,EAAKhe,KAAKwc,OAAO,GAAGgB,OAAOhL,QAAQoL,EAASC,GAClD7d,KAAKwc,OAAO,GAAGgB,OAAOjM,MAAMpQ,KAAK6c,GAEjCA,EAAGR,OAAO9K,WAAW1S,KAAKwc,OAAO,IACjCwB,EAAGR,OAAO9K,WAAW1S,KAAKwc,OAAO,IACjCwB,EAAGR,OAAOS,aAOVD,EAAGR,OAAOU,mBACVF,EAAGR,OAAO1N,iBACZ,CACF,MACE9P,KAAKwc,OAAO,GAAGsB,GAAGrN,SAClBzQ,KAAKwc,OAAO,GAAGgB,OAAO9K,WAAW1S,KAAKwc,OAAO,GAQjD,CACO/L,SACL,IAAIzQ,KAAK2F,SAAT,CASA,GALI3F,KAAKkI,OACPlI,KAAK4M,mBAIH5M,KAAKwc,OAAO,GAAI,CAClB,GAAIxc,KAAKO,OAAS6L,EAAAA,GAAAA,OAAepM,KAAKwc,OAAOtb,OAAS,IAAMlB,KAAK2F,SAAU,CAKzE,GAAI3F,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAa6P,UAEjEne,KAAKwc,OAAO,GAAGgB,OACjB,GAA+C,IAA3Cxd,KAAKwc,OAAO,GAAGgB,OAAO7Q,UAAUzL,OAE9BlB,KAAKwc,OAAO,GAAGU,KAAOld,MACxBA,KAAKwc,OAAO,GAAGU,GAAGa,aAEhB/d,KAAKwc,OAAO,GAAGW,KAAOnd,MACxBA,KAAKwc,OAAO,GAAGW,GAAGY,aAEpB/d,KAAK+d,aACL/d,KAAKwc,OAAO,GAAGgB,OAAO/M,QAAO,GAC7BzQ,KAAKwc,OAAO,GAAGgB,OAAOO,iBACjB,CACL/d,KAAKwc,OAAO,GAAGgB,OAAO/M,QAAO,GAC7B,MAAM2N,EAAQpe,KAAKwc,OAAO,GAAGgB,OAAOhU,SAChC4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBqU,eAAe,CAACD,GAE7E,CAGJ,MACF,CACA,GAAIpe,KAAKO,OAAS6L,EAAAA,GAAAA,WAAmBpM,KAAKwc,OAAOtb,OAAS,IAAMlB,KAAK2F,SAAU,CAG7E,GAAI3F,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAa6P,WAErEne,KAAK2F,UAAW,EACZ3F,KAAKwc,OAAO,GAAGgB,QAAQ,CACzBxd,KAAKwc,OAAO,GAAGgB,OAAO/M,SACtB,MAAM2N,EAAQpe,KAAKwc,OAAO,GAAGgB,OAAOhU,SAChC4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBqU,eAAe,CAACD,GAE7E,CAEF,MACF,CACF,CAIA,GAAIpe,KAAKuR,MAAM,GAAI,CACjB,GACEvR,KAAKO,OAAS6L,EAAAA,GAAAA,OACdpM,KAAKuR,MAAMrQ,OAAS,IACnBlB,KAAK2F,WACL3F,KAAKuR,MAAM,GAAGpK,oBACf,CAMAnH,KAAK2F,UAAW,EAChB3F,KAAKuR,MAAM,GAAGd,SACd,MAAM2N,EAAQpe,KAAKuR,MAAM,GAAG/H,SAI5B,YAHI4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBqU,eAAe,CAACD,IAG7E,CAEA,IAAKpe,KAAKO,OAAS6L,EAAAA,GAAAA,OAAepM,KAAKO,OAAS6L,EAAAA,GAAAA,YAAoBpM,KAAKuR,MAAMrQ,OAAS,IAIpFlB,KAAKuR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,cACvBpM,KAAKuR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,cACvB,CAGA,GAFApM,KAAK2F,UAAW,EAEZ3F,KAAKuR,MAAM,GAAI,CACjBvR,KAAKuR,MAAM,GAAGd,SAEd,MAAM2N,EAAQpe,KAAKuR,MAAM,GAAG/H,SACxB4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBqU,eAAe,CAACD,GAE7E,CACA,MACF,CAEJ,CAEApe,KAAK+d,YArGL,CAsGF,CACOA,aACD/d,KAAK2F,WAGL3F,KAAKsK,iBACPtK,KAAKsK,eAAegU,wBACpBte,KAAKsK,oBAAiB3H,GAGxB3C,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EACpBhC,KAAK2F,UAAW,EAChB3F,KAAK2D,MAAM4a,gBAAgBve,MAC3BA,KAAK2D,MAAM6a,aAAaxe,MACxBA,KAAK2D,MAAM8a,eAAeze,MAC5B,CAKOkQ,gBACLlQ,KAAKgG,cAAe,EACpBhG,KAAK0H,KAAO1H,KAAK2D,MAAMC,mBAAmBuB,SAASqL,UAAUtN,EAC7DlD,KAAKuG,YAAa,CACpB,CACO0M,OAELjT,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,CACtB,CACOkR,0BAA0B5F,GAE3BtN,KAAKO,OAAS6L,EAAAA,GAAAA,YAGdpM,KAAKO,OAAS6L,EAAAA,GAAAA,eAKdpM,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,gBAM5CrG,KAAKsK,gBACPtK,KAAKsK,eAAe4I,0BAA0B5F,GAkB5CtN,KAAKwc,OAAOtb,OAAS,EACvBlB,KAAK0e,2BAA2BpR,GAK9BtN,KAAKO,OAAS6L,EAAAA,GAAAA,iBAMdpM,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAaqQ,aACrE3e,KAAK4e,mBAAmBtR,EAAElM,EAAGkM,EAAEjM,IAI/BrB,KAAK4C,IAAIxB,EAAIkM,EAAElM,EACfpB,KAAK4C,IAAIvB,EAAIiM,EAAEjM,EACfrB,KAAKmG,QAAS,GAIZnG,KAAKO,OAAS6L,EAAAA,GAAAA,OAAepM,KAAKuR,MAAM,IAAMvR,KAAKuR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,SAMrEpM,KAAKuR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,cAAsBpM,KAAKuR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,cAMpEpM,KAAKuR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,YAAoBpM,KAAKuR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,cAMlEpM,KAAKuR,MAAM,GAAGhR,KAAS6L,EAAAA,GAAAA,QAlCzBpM,KAAK6e,yBAAyBvR,IAyClC,CACOiG,UAAUnS,EAAWC,GAC1B,CAEKud,mBAAmBxd,EAAWC,GACnC,MAAM8a,EAAMnc,KAAK2D,MAAMsY,WACvB,IAAK,IAAIhb,EAAI,EAAGA,EAAIkb,EAAIjb,SAAUD,GAC5BiM,EAAAA,EAAAA,IAAYiP,EAAIlb,GAAG2B,IAAK5C,KAAK4C,KAAO,IACtC5C,KAAK4C,IAAM,IAAIP,EAAAA,GAASjB,EAAGC,GAE3BrB,KAAK2D,MAAMmb,QAAU3C,EAAIlb,GACzBjB,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAaqQ,cAAe,EAGxF,CACOjO,iBAoBL,GAAI1Q,KAAKwc,OAAOtb,OAAS,EAAG,CAC1B,IAAKlB,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAayQ,WAAY,CAClF,MAAMC,EAAKhf,KAAKwc,OAAO,GACvB,IAAK,IAAIvb,EAAI,EAAGA,EAAI+d,EAAGxB,OAAOjM,MAAMrQ,SAAUD,EACxC+d,EAAGxB,OAAOjM,MAAMtQ,GAAGic,KAAOld,MAAQgf,EAAGxB,OAAOjM,MAAMtQ,GAAGic,GAAGtG,iBAC1DoI,EAAGxB,OAAOjM,MAAMtQ,GAAGic,GAAGtG,gBAAiB,GAErCoI,EAAGxB,OAAOjM,MAAMtQ,GAAGkc,KAAOnd,MAAQgf,EAAGxB,OAAOjM,MAAMtQ,GAAGkc,GAAGvG,iBAC1DoI,EAAGxB,OAAOjM,MAAMtQ,GAAGkc,GAAGvG,gBAAiB,GAErCoI,EAAGxB,OAAOjM,MAAMtQ,GAAG6c,KAAO9d,MAAQgf,EAAGxB,OAAOjM,MAAMtQ,GAAG6c,GAAGlH,iBAC1DoI,EAAGxB,OAAOjM,MAAMtQ,GAAG6c,GAAGlH,gBAAiB,EAG7C,CAGA,OAFA5W,KAAK4W,gBAAkB5W,KAAK4W,oBAC5B5W,KAAKwc,OAAO,GAAGgB,OAAOhd,YAAa,EAErC,CAEA,GAAIR,KAAKuR,MAAMrQ,OAAS,EAAG,CAEzB,GAAIlB,KAAKuR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,cAAsBpM,KAAKuR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,aAGtE,OAFApM,KAAKQ,YAAa,OAClBR,KAAKuR,MAAM,GAAG/Q,YAAcR,KAAKuR,MAAM,GAAG/Q,YAK5C,IAAKR,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAayQ,WAAY,CAClF,MAAMC,EAAKhf,KAAKuR,MAAM,GACtB,IAAK,IAAItQ,EAAI,EAAGA,EAAI+d,EAAG7C,IAAIjb,SAAUD,EAC/B+d,EAAG7C,IAAIlb,KAAOjB,MAAQgf,EAAG7C,IAAIlb,GAAG2V,iBAClCoI,EAAG7C,IAAIlb,GAAG2V,gBAAiB,EAGjC,CAGA,OAFA5W,KAAK4W,gBAAkB5W,KAAK4W,oBAC5B5W,KAAKuR,MAAM,GAAG/Q,YAAa,EAE7B,CACF,CAoBOqe,yBAAyBvR,GAa9B,CAEK2R,sBAAsB7d,EAAWC,GAGtC,CAEKqd,2BAA2BpR,GAMhC,GALAtN,KAAK4C,IAAIxB,GAAKkM,EAAElM,EAAIkM,EAAE6F,KACtBnT,KAAK4C,IAAIvB,GAAKiM,EAAEjM,EAAIiM,EAAE8F,KACtBpT,KAAKmG,QAAS,EAGVnG,KAAKO,OAAS6L,EAAAA,GAAAA,UAChB,GAAIpM,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAaqQ,aACrE3e,KAAKwc,OAAO,GAAG0C,oBACV,CACL,MAAMC,EAAKnf,KAAKwc,OAAO,GAAG4C,UAAUpf,MAChCmf,IACFA,EAAG3e,YAAa,EAChBR,KAAK2D,MAAMmb,QAAUK,EAEzB,MAEA,IAAK,IAAIle,EAAI,EAAGA,EAAIjB,KAAKwc,OAAOtb,SAAUD,EACxCjB,KAAKwc,OAAOvb,GAAGoe,UAAU/R,EAM/B,CACOyC,WAIuB,IAH5B3O,EAAS,uDAAGpB,KAAK4C,IAAIxB,EACrBC,EAAS,uDAAGrB,KAAK4C,IAAIvB,EACZ,2CAAGrB,KAAK4C,IAAItB,EAErB,GAAItB,KAAKO,OAAS6L,EAAAA,GAAAA,WAAmBpM,KAAKO,OAAS6L,EAAAA,GAAAA,MACjD,OAEF,MAAM3C,EAAI,IAAIsS,EAAO/b,KAAK2D,MAAOvC,EAAGC,EAAGrB,KAAK4C,IAAItB,GAAG,EAAOtB,KAAKO,KAAMP,KAAK2H,GAC1E,OAAI8B,QAAJ,CAIF,CACOkH,gBAAgBrD,GACrB,CAEKkC,WAAW9L,GAChB1D,KAAKoI,UAAU5E,OAAOE,GACtB1D,KAAKmF,SAASqK,WAAW9L,EAC3B,CACOkN,UACA,CAEApG,mBAAmBD,GACxB,QAAIvK,KAAKO,OAAS6L,EAAAA,GAAAA,cAAsBpM,KAAKO,OAAS6L,EAAAA,GAAAA,YAChDpM,KAAKuR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,QAAgBpM,KAAKuR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,aAChEpM,KAAKuR,MAAM,GAAGjH,eAAiBC,GACxB,EAIb,EAzyBWwR,EACJzb,GAAK,ECbP,MAAMkV,UAA0BE,EAIrC7V,YAAYyE,GACVY,MAAMZ,GAAM,KAJPA,UAAI,OACJ3D,iBAAW,OACXwa,qBAAe,EAGpBnb,KAAKsE,KAAOA,EACZtE,KAAKsf,iBACP,CACOA,kBACL,CAEK9P,WAAW9L,IAEX1D,KAAKsE,KAAKib,cAAgBvf,KAAKsE,KAAKsB,cAAiB5F,KAAKsE,KAAK9D,cAClEkD,EAAI8b,UAAY,SAChB9b,EAAIM,UAAY,UAChBN,EAAIkB,SAAS,4BAAD,OACkB5E,KAAKsE,KAAKmb,yBAAwB,SAC9Dzf,KAAKsE,KAAKob,KAAK,GAAGte,EAClBpB,KAAKsE,KAAKob,KAAK,GAAGre,EAAI,KAGtBrB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAaqR,WACrE3f,KAAKsE,KAAKib,eACTvf,KAAKsE,KAAK/D,OAAS6L,EAAAA,GAAAA,SACjBpM,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAK6C,uBACtCnH,KAAKsE,KAAKsb,UAAUC,aAAanc,GAAK,EAAM1D,KAAKsE,KAAKob,MACtD1f,KAAKsE,KAAKsb,UAAUE,gBAAgBpc,EAAK1D,KAAKsE,KAAKob,QAGjD1f,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAK6C,uBACtCnH,KAAKsE,KAAKsb,UAAUC,aAAanc,GAAK,EAAO1D,KAAKsE,KAAKob,MACvD1f,KAAKsE,KAAKsb,UAAUG,kBAAkBrc,EAAK1D,KAAKsE,KAAKob,SAUzD1f,KAAKsE,KAAKib,aACZvf,KAAKggB,6BAA6Btc,GAElC1D,KAAKigB,mBAAmBvc,GAE1B1D,KAAKkgB,kBAGLlgB,KAAKsE,KAAKa,SAASoF,GAAKvK,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,EACtE,CACQ2K,6BAA6Btc,GACnC,GAAI1D,KAAKsE,KAAK/D,OAAS6L,EAAAA,GAAAA,SAAgB,CACrC,GAAIpM,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAKyB,iBAAmB/F,KAAKsE,KAAK6C,oBAAqB,CACxFzD,EAAIyc,gBAAkBngB,KAAKsE,KAAKa,SAASoF,EACzC7G,EAAI0c,YAAY,CAAC,EAAG,IACpB1c,EAAI2c,YAAcrgB,KAAKsE,KAAKjB,eAAe1C,YAAY8Z,YACvD/W,EAAImV,UAAY,EAChBnV,EAAIO,YACJP,EAAI4c,OAAOtgB,KAAKsE,KAAKob,KAAK,GAAGte,EAAGpB,KAAKsE,KAAKob,KAAK,GAAGre,GAClD,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAKsE,KAAKob,KAAKxe,SAAUD,EAC3CyC,EAAI6c,OAAOvgB,KAAKsE,KAAKob,KAAKze,GAAGG,EAAGpB,KAAKsE,KAAKob,KAAKze,GAAGI,GAEpDqC,EAAI8c,SACJ9c,EAAI0c,YAAY,CAAC,EAAG,GAEtB,CACIpgB,KAAKsE,KAAKib,eACRvf,KAAKsE,KAAKmc,+BAGVzgB,KAAKsE,KAAKoc,0CAIZ1gB,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAK6C,mBAG1C,MAAWnH,KAAKsE,KAAK/D,OAAS6L,EAAAA,GAAAA,SACxBpM,KAAKsE,KAAKib,YAIlB,CAEQU,mBAAmBvc,GACrB1D,KAAKsE,KAAK/D,OAAS6L,EAAAA,GAAAA,SACjBpM,KAAKsE,KAAK6C,qBACZnH,KAAK2gB,eAAejd,GAElB1D,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAC1DC,oBAAoBC,OAASC,EAAAA,GAAAA,SAEhCjW,KAAK4gB,aAAald,IAGhB1D,KAAKsE,KAAKuc,mBAmBZ7gB,KAAK2gB,eAAejd,GAElB1D,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAC1DC,oBAAoBC,OAASC,EAAAA,GAAAA,SAEhCjW,KAAK4gB,aAAald,IAKxB1D,KAAK8gB,cAAcpd,EAAK1D,KAAKsE,KAAKqI,UAEtC,CACQgU,eAAejd,GAEjB1D,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAKyB,iBACtC/F,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAKC,cAC1Dtd,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAKqI,UACV3M,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,OAChFtV,KAAKsE,KAAKsB,cAEZ5F,KAAKsV,OAAS,KACdtV,KAAKiP,OAAS,EACdjP,KAAKsE,KAAK8B,SAAU,EACpBpG,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAK/H,SAC1DtV,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAKqI,UACV3M,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,mBAGZ/F,KAAKsV,MAAQ,EACbtV,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAK/H,SAC1DtV,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAKqI,UACV3M,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,iBAGhB,CACQ+a,cAAcpd,EAA+Bud,GACnDjhB,KAAKkgB,kBACDlgB,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAKyB,iBACtC/F,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2K,KAAKC,aAC1Dzd,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBsgB,EACAjhB,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,OAChFtV,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,iBAEZ/F,KAAKsV,OAAS,IACdtV,KAAKiP,OAAS,EACdjP,KAAKsE,KAAK8B,SAAU,EACpBpG,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2K,KAAKxH,QAC1DhW,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBsgB,EACAjhB,KAAKsE,KAAK6C,oBACVnH,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKgB,OACVtF,KAAKsE,KAAK8F,QACVpK,KAAKsE,KAAKyB,mBAGZ/F,KAAKsV,MAAQ,EACbtV,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2K,KAAKxH,QAC1DhW,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBsgB,EACAjhB,KAAKsE,KAAK6C,oBACVnH,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKgB,OACVtF,KAAKsE,KAAK8F,QACVpK,KAAKsE,KAAKyB,iBAGhB,CACQ6a,aAAald,GACnB,GAAI1D,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAKyB,iBAAmB/F,KAAKsE,KAAK6C,oBAAqB,CACxFnH,KAAKsE,KAAK8c,eACV,IAAIC,EAAIrhB,KAAKsE,KAAKgd,OAAOpgB,OACzB,KAAOmgB,KACLrhB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKC,aAC1D/S,EACA1D,KAAKsE,KAAKjB,eAAe8X,gBACzBnb,KAAKsE,KAAKgd,OAAOD,GAAGjgB,EACpBpB,KAAKsE,KAAKgd,OAAOD,GAAGhgB,EACpBrB,KAAKsE,KAAK+D,eACVrI,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,OAGtF,CACF,CACQ4K,kBACFlgB,KAAKsE,KAAK/D,OAAS6L,EAAAA,GAAAA,SACrBpM,KAAKuhB,wBAET,CACQA,yBACNvhB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASqc,UAAUC,iBACpDzhB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAC5C1hB,KAAKsE,KAAK6D,UACVnI,KAAKsE,KAAKqI,UAEd,EC7OK,MAAMuO,UAAuBM,EAElC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KAFNA,SAAG,EAGR1B,KAAKmO,aACP,CACOA,cASL,GARAgK,EAAYwJ,0BACV3hB,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElDyI,EAAYyJ,8BACV5hB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAE9C1P,KAAK0B,IAAIya,IACX,IAAK,IAAIlb,EAAI,EAAGA,EAAIjB,KAAK0B,IAAIya,IAAIjb,SAAUD,EACzCjB,KAAK0B,IAAIya,IAAIlb,GAAGoC,eAAeuY,mBAAmB5b,KAAKmb,gBAG7D,ECEK,MAAM0G,UAAyB5c,EAwCpC,mBAA0BtB,EAAc2J,GACtC,IAAK,IAAIrM,EAAI0C,EAAMme,qBAAqB5gB,OAAS,EAAGD,GAAK,IAAKA,EAC5D,GACE0C,EAAMme,qBAAqB7gB,GAAG+E,cAC9BrC,EAAMme,qBAAqB7gB,GAAG4R,cAAcvF,EAAElM,EAAGkM,EAAEjM,GAEnD,OAAOsC,EAAMme,qBAAqB7gB,EAIxC,CACA,0BAAiC0C,GAC/B,IAAI1C,EAAI0C,EAAMme,qBAAqB5gB,OAC/B6gB,EAAQ,EACZ,KAAO9gB,KACD0C,EAAMme,qBAAqB7gB,GAAGT,aAChCuhB,GAAS,GAGb,OAAOA,CACT,CACA,mBAA0Bpe,EAAc2J,GACtC,MAAM0U,EAAKH,EAAiBI,YAAYte,EAAO2J,QACpC3K,IAAPqf,IACFA,EAAGpc,cAAe,EAEtB,CAEA,gBAAuBjC,EAAc0M,GAAoD,IAArCtJ,EAAM,wDAAUuV,EAAU,wDACxEiD,GAAe,EAGjBA,IADElP,EAAEvP,KAAmB,aAMzB,MAAMY,EAAM,IAAImgB,EACdle,EACAoY,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAM,GAAImG,GAC1CA,EACAwY,GAQF,GAJIA,IACF7d,EAAI+d,0BAA4BpP,EAAEvP,KAA+B,0BAG/DiG,EAAQ,CACVrF,EAAIqF,OAASA,EACb,IAAK,IAAI9F,EAAI,EAAGA,EAAIoP,EAAEzP,MAAMM,SAAUD,EACpCS,EAAIygB,MAAMpG,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAMK,GAAI8F,GAExD,MACE,IAAK,IAAI9F,EAAI,EAAGA,EAAIoP,EAAEzP,MAAMM,SAAUD,EACpCS,EAAIygB,MAAMpG,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAMK,KA0BpD,OAvBAS,EAAInB,KAAO6L,EAAAA,GAAMiE,EAAE9P,MAGjBmB,EAAIpB,GADFgc,EACO3Y,EAAMsF,UAENoH,EAAE/P,GAEboB,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EAC1BzF,EAAI0I,SAAU,EAEd1I,EAAI2E,cAAgBgK,EAAE3P,SAClB2P,EAAE3P,SACJgB,EAAIwF,gBAAkB,EAEtBxF,EAAIwF,gBAAkB,EAGxBxF,EAAIoO,kBACC/I,GACHpD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,UAGpE9H,CACT,CACA,yBAAgCiC,EAAcT,GAC5C,MAAMyH,EAAI,IAAIkX,EAAiBle,EAAO,IAAIoY,EAAOpY,EAAOT,EAAE,GAAG9B,EAAG8B,EAAE,GAAG7B,EAAG,IACxE,IAAK,IAAIJ,EAAI,EAAGA,EAAIiC,EAAEhC,SAAUD,EAC9B0J,EAAEwX,MAAM,IAAIpG,EAAOpY,EAAOT,EAAEjC,GAAGG,EAAG8B,EAAEjC,GAAGI,EAAG,IAE5CsJ,EAAEuT,mBACFvT,EAAEyX,cAAe,EACjBzX,EAAExD,qBAAsB,EACxBxD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBnG,EAAEnB,SACzE,CACA,kBAAyB8D,GAAkC,2CAAGlB,EAAAA,GAAAA,WACtBzJ,IAAlCkf,EAAiBQ,cACnBR,EAAiBQ,aAAalG,IAAI0F,EAAiBQ,aAAalG,IAAIjb,OAAS,GAAGkM,KAC9EE,EAAElM,EACFkM,EAAEjM,EAeR,CACA,eAAsBsC,EAAc2J,GAA0C,IAAvBiS,EAAY,6DAC3B5c,IAAlCkf,EAAiBQ,eAGnBR,EAAiBQ,aAAe,IAAIR,EAClCle,EACA,IAAIoY,EAAOpY,EAAO2J,EAAElM,EAAGkM,EAAEjM,IACzB,EACAke,GAEFsC,EAAiBQ,aAAalG,IAAI,GAAGnW,cAAe,GARpD6b,EAAiBQ,aAAaF,MAAM,IAAIpG,EAAOpY,EAAO2J,EAAElM,EAAGkM,EAAEjM,GAWjE,CACA,mBAA0BoI,GACnB,CAEP,YAAmB9F,EAAc2J,GAC/B,IAAKuU,EAAiBQ,aACpB,OAEF,IAAIphB,EAAI4gB,EAAiBQ,aAAalG,IAAIjb,OAAS,EACzC,IAAND,GAIJ4gB,EAAiBQ,aAAaC,SAAST,EAAiBQ,aAAalG,MAAMlb,IAC3E4gB,EAAiBQ,aAAalG,IAAIlb,GAAG2B,IAAIxB,EAAIkM,EAAElM,EAC/CygB,EAAiBQ,aAAalG,IAAIlb,GAAG2B,IAAIvB,EAAIiM,EAAEjM,GAL7CwgB,EAAiBU,OAAO5e,EAM5B,CACA,YAAmBA,QACqBhB,IAAlCkf,EAAiBQ,eACnBR,EAAiBQ,aAAaD,cAAe,EAC7CP,EAAiBQ,aAAalb,qBAAsB,EACpD0a,EAAiBQ,aAAaC,SAC5BT,EAAiBQ,aAAalG,IAAI0F,EAAiBQ,aAAalG,IAAIjb,OAAS,KAG7EgM,EAAAA,EAAAA,IACE2U,EAAiBQ,aAAalG,IAAI0F,EAAiBQ,aAAalG,IAAIjb,OAAS,GAAG0B,IAChFif,EAAiBQ,aAAalG,IAAI,GAAGvZ,KACnC,GAEJif,EAAiBQ,aAAaC,SAC5BT,EAAiBQ,aAAalG,IAAI0F,EAAiBQ,aAAalG,IAAIjb,OAAS,IAIjF2gB,EAAiBQ,aAAanE,mBAE9B2D,EAAiBQ,aAAaC,SAC5BT,EAAiBQ,aAAalG,IAAI0F,EAAiBQ,aAAalG,IAAIjb,OAAS,IAG/E2gB,EAAiBQ,aAAalb,qBAAsB,EAEpDxD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAClD+Q,EAAiBQ,aAAa7Y,UAKhCqY,EAAiBQ,kBAAe1f,EAChCgB,EAAMC,mBAAmB4H,wBAAwBgX,cAEnD7e,EAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMyW,UAAUC,iBAAiBC,2BAA4B,CAC5G,CACA,sBAA6Bhf,QACWhB,IAAlCkf,EAAiBQ,eACnBR,EAAiBQ,aAAaD,cAAe,EAE7CP,EAAiBQ,aAAaC,SAC5BT,EAAiBQ,aAAalG,IAAI0F,EAAiBQ,aAAalG,IAAIjb,OAAS,IAE/E2gB,EAAiBQ,aAAalb,qBAAsB,EAEpD0a,EAAiBQ,aAAanE,mBAC9Bva,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAClD+Q,EAAiBQ,aAAa7Y,UAEhCqY,EAAiBQ,kBAAe1f,EAChCgB,EAAMC,mBAAmB4H,wBAAwBgX,aAErD,CACA,cAAqB7e,QACmBhB,IAAlCkf,EAAiBQ,eACnBR,EAAiBQ,aAAaxb,UAAW,EACzCgb,EAAiBQ,aAAa5R,SAC9BoR,EAAiBQ,kBAAe1f,EAEpC,CAIA,iBAAwBgB,EAAc2J,GAA0C,IAAvBiS,EAAY,wDACnE,GAAI5b,EAAMC,mBAAmB4H,wBAAwB8C,aAAasU,4BAA6B,CAC7F,MAAMC,EAAOlf,EAAMC,mBAAmBuS,eAAe2M,eAAeb,YAAY3U,GAC5EuU,EAAiBQ,eACnBR,EAAiBkB,QAAQpf,EAAO2J,GAC5BuV,IAEFhB,EAAiBQ,aAAa9hB,KAAO6L,EAAAA,GAAAA,QACrCyV,EAAiBQ,aAAaW,UAAW,EACzCnB,EAAiBQ,aAAaC,SAC5BT,EAAiBQ,aAAalG,IAAI0F,EAAiBQ,aAAalG,IAAIjb,OAAS,IAE/E2gB,EAAiBQ,aAAaC,SAC5BT,EAAiBQ,aAAalG,IAAI0F,EAAiBQ,aAAalG,IAAIjb,OAAS,IAG/E2hB,EAAK9c,iBAAkB,EACvB8c,EAAKjd,cAAe,EACpBid,EAAKpc,iBAAkB,EACvBoc,EAAK7c,cAAe,EAEpB6b,EAAiBQ,aAAaD,cAAe,EAC7CP,EAAiBQ,aAAalb,qBAAsB,EACpD0a,EAAiBQ,aAAanE,mBAC9B2D,EAAiBQ,aAAavS,kBAC9BnM,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAClD+Q,EAAiBQ,aAAa7Y,UAQhCqY,EAAiBQ,kBAAe1f,GAGtC,MACEkf,EAAiBkB,QAAQpf,EAAO2J,EAAGiS,EAEvC,CACA,sBAA6B5b,EAAc2J,GAA0C,IAAvBiS,EAAY,wDACxE,QAAsB5c,IAAlBgB,EAAMgP,QAGV,YAAsChQ,IAAlCkf,EAAiBQ,cAA8BR,EAAiBoB,QAClEpB,EAAiBQ,aAAatc,iBAAkB,EAChD8b,EAAiBQ,kBAAe1f,OAChCkf,EAAiBoB,QAAS,cAEiBtgB,IAAlCkf,EAAiBQ,cAC1BR,EAAiBkB,QAAQpf,EAAO2J,EAAGiS,GAEvC,CACA,iBAAwBjS,QACgB3K,IAAlCkf,EAAiBQ,cACnBR,EAAiBqB,WAAW5V,EAEhC,CACA,wBAA+B3J,EAAc2J,QACL3K,IAAlCkf,EAAiBQ,cACnBR,EAAiBsB,KAAKxf,EAE1B,CAEA9D,YAAY8D,EAAc8F,GAAkD,IAAvC1C,EAAM,wDAAUwY,EAAY,wDAC/Dra,MAAMvB,GAAO,KAtTR2B,YAAM,OACNub,sBAAgB,OAEhBje,SAAG,OACH8c,UAAI,OACJ4B,YAAM,OACN8B,iBAAW,OAEXjH,SAAG,OACHkH,UAAI,OACJL,cAAQ,OACRnK,eAAS,OAET+G,eAAS,OAGTL,kBAAY,OACZ+D,qBAAuB,IAAI,KAM3BC,aAAe,EAAE,KACjBC,eAAS,OAETC,OAAQ,EAAM,KAEd/C,0CAA2C,EAAM,KACjDD,gCAAiC,EAAM,KACtCiD,oCAAsC,GAAI,KAC1CC,0BAA4B,IAwRlC3jB,KAAKsF,QAAS,EACdtF,KAAKmc,IAAM,GACXnc,KAAK+G,OAASA,EACd/G,KAAKuf,aAAeA,EAGpBvf,KAAK6Y,UAAY,EACjB7Y,KAAKmH,qBAAsB,EAC3BnH,KAAK4C,IAAM,IAAIP,EAAAA,GAASoH,EAAE7G,IAAIxB,EAAGqI,EAAE7G,IAAIvB,EAAGoI,EAAE7G,IAAItB,GAEhDtB,KAAKiL,QAAS,EACdjL,KAAK4c,gBACL5c,KAAKmiB,MAAM1Y,GACXzJ,KAAK8P,kBACL9P,KAAK4jB,eACL5jB,KAAK2D,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMyW,UAAUC,iBAAiBC,2BAA4B,CACjH,CACQ/F,gBACN5c,KAAKqD,eAAiB,IAAI6X,EAAelb,MACzCA,KAAKmF,SAAW,IAAIqQ,EAAkBxV,KACxC,CACO4jB,eAML5jB,KAAK6gB,kBAAmB,EACxB7gB,KAAKO,KAAO6L,EAAAA,GAAAA,SACZpM,KAAK2D,MAAMkgB,oBAAoB7jB,KACjC,CACO8jB,kBACD,CAECC,YACD,CAECC,aACD,CAEClR,SACL,GAAI9S,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,cAC9C,MAAO,GAET,IAAI3B,EAAO,GACX,OAAI1E,KAAKO,OAAS6L,EAAAA,GAAAA,SAChB1H,GACE,UACA1E,KAAKM,GADL,WAIAN,KAAKO,KAAKwS,WAJV,oBAYA/S,KAAKmc,IAAIjb,OAZT,WAeAlB,KAAKqJ,UAAU4a,QAAQ,GAAGlR,WAf1B,eAqBA/S,KAAK+F,gBArBL,gBAwBA/F,KAAKgG,aACAtB,GAEL1E,KAAKO,OAAS6L,EAAAA,GAAAA,UAChB1H,GACE,UACA1E,KAAKM,GADL,WAIAN,KAAKO,KAAKwS,WAJV,oBAYA/S,KAAKmc,IAAIjb,OAZT,aAeAlB,KAAKqJ,UAAU4a,QAAQ,GAAGlR,WAf1B,eAqBA/S,KAAK+F,gBArBL,gBAwBA/F,KAAKgG,aACAtB,GAEFA,CACT,CACOsO,YAeL,MAbE,iBACAhT,KAAKM,GADL,wDAUAN,KAAK2H,EACL,YAGJ,CACOuc,UACA,CAEArR,cAAczR,EAAWC,GAC9B,QAAIrB,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,kBAGf,IAA7BrG,KAAKmH,0BAA6DxE,IAA7B3C,KAAKmH,sBAG1CnH,KAAKmkB,cAAc/iB,EAAGC,IACxBrB,KAAKoK,SAAU,GACR,IAETpK,KAAKoK,SAAU,GACR,IACT,CACO+Z,cAAc/iB,EAAWC,GAE9B,MAAM+iB,EAAMpkB,KAAKmc,IAAIjb,OACrB,IAAK,IAAID,EAAI,EAAGA,EAAImjB,IAAOnjB,EACzB,GAAIA,EAAImjB,EAAM,GACZ,IACEC,EAAAA,EAAAA,IAAyB,IAAIhiB,EAAAA,GAASjB,EAAGC,GAAIrB,KAAKmc,IAAIlb,GAAG2B,IAAK5C,KAAKmc,IAAIlb,EAAI,GAAG2B,KAC9E5C,KAAK6Y,UAEL,OAAO,OAGT,GAAI7Y,KAAKO,OAAS6L,EAAAA,GAAAA,WAEdiY,EAAAA,EAAAA,IAAyB,IAAIhiB,EAAAA,GAASjB,EAAGC,GAAIrB,KAAKmc,IAAIlb,GAAG2B,IAAK5C,KAAKmc,IAAI,GAAGvZ,KAC1E5C,KAAK6Y,UAEL,OAAO,EAQf,QACE7Y,KAAK2D,MAAMC,mBAAmBuS,eAAe2M,eAAewB,yBAC1DljB,EACAC,EACArB,KAAKmI,UAMX,CACOoc,wBACL,IAAK,IAAItjB,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrC,GAAIjB,KAAKmc,IAAIlb,KAAOjB,KAAK2D,MAAMgP,QAC7B,OAAO,EAGX,OAAO,CACT,CACOO,0BAA0B5F,GAC/B,GAAItN,KAAKukB,wBACP,OAGF,IAA0B,IAAtBvkB,KAAKujB,YAGP,YAFAvjB,KAAKmc,IAAInc,KAAKujB,aAAarQ,0BAA0B5F,GAIvD,GAAItN,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,cAC9C,OAEF,MAAMme,EAAKlX,EAAElM,EAAIkM,EAAE6F,KACbsR,EAAKnX,EAAEjM,EAAIiM,EAAE8F,KACnB,IAAK,IAAInS,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EAIrC,GAHAjB,KAAKmc,IAAIlb,GAAG2B,IAAIxB,GAAKojB,EACrBxkB,KAAKmc,IAAIlb,GAAG2B,IAAIvB,GAAKojB,EAEjBzkB,KAAKmc,IAAIlb,GAAGqJ,eAAgB,CAC9B,MAAMb,EAAIzJ,KAAKmc,IAAIlb,GACnBjB,KAAK0kB,2BAA2BpX,EAAG7D,EACrC,CAEF,GAAIzJ,KAAK6gB,kBAAoB7gB,KAAKqjB,KAChC,IAAK,IAAIpiB,EAAI,EAAGA,EAAIjB,KAAKqjB,KAAKniB,SAAUD,EACtCjB,KAAKqjB,KAAKpiB,GAAG2B,IAAIxB,GAAKojB,EACtBxkB,KAAKqjB,KAAKpiB,GAAG2B,IAAIvB,GAAKojB,CAI5B,CACQC,2BAA2BpX,EAAmB7D,GACpD,SAAIA,EAAEa,iBACJb,EAAEa,eAAe4I,0BAA0B5F,IACvC7D,EAAEa,eAAe+I,eAEnB5J,EAAEa,eAAe+I,WAAWC,GAAGlS,EAAIqI,EAAE7G,IAAIxB,EACzCqI,EAAEa,eAAe+I,WAAWC,GAAGjS,EAAIoI,EAAE7G,IAAIvB,GAElC,EAIb,CACOkS,UAAUnS,EAAWC,GAC1B,CAEK+L,KAAKhM,EAAWC,GACrB,GAAIrB,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,cAC9C,OAEFrG,KAAKke,mBACL,MAAMsG,EAAKpjB,EAAIpB,KAAK4C,IAAIxB,EAClBqjB,EAAKpjB,EAAIrB,KAAK4C,IAAIvB,EACxB,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAG2B,IAAIxB,GAAKojB,EACrBxkB,KAAKmc,IAAIlb,GAAG2B,IAAIvB,GAAKojB,CAEzB,CACOhU,SAA+B,IAAxB5J,IAAQ,yDACpB,IAAI7G,KAAK2F,UAAa3F,KAAKgC,eAAgBhC,KAAKqG,cAAhD,CAGA,IAAK,IAAIpF,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAG8c,aAMd,GAJA/d,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EAEpBhC,KAAK4M,mBACD/F,EAAU,CACZ,MAAMuX,EAAQpe,KAAKwJ,SACf4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB,CAACvG,GAElF,CAEApe,KAAK2D,MAAMihB,uBAAuB5kB,MAClCA,KAAK2D,MAAM8a,eAAeze,KAhB1B,CAiBF,CACOiT,OACL,CAEK4R,YACL,GAAI7kB,KAAKmc,IAAIjb,OAAS,EACpB,OAAO,EAET,IAAI4jB,EAAM,EACV,IAAK,IAAI7jB,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,OAAS,IAAKD,EACzC6jB,GAAO,EAET,OAAOxS,KAAKyS,IAAID,EAClB,CACOpX,gBAAgBtM,EAAWC,GAChC,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrC,GAAIjB,KAAKmc,IAAIlb,GAAG4R,cAAczR,EAAGC,GAC/B,OAAOrB,KAAKmc,IAAIlb,EAItB,CACOkO,oBACLnP,KAAKke,oBAEH3N,EAAAA,EAAAA,IACE,CACEvQ,KAAK2D,MAAMC,mBAAmBuB,SAASqL,UAAUtN,EAAE9B,EACnDpB,KAAK2D,MAAMC,mBAAmBuB,SAASqL,UAAUtN,EAAE7B,EACnDrB,KAAK2D,MAAMC,mBAAmBuB,SAASqL,UAAUtN,EAAE5B,GAErD,CAACtB,KAAK4C,IAAIxB,EAAGpB,KAAK4C,IAAIvB,EAAGrB,KAAK4C,IAAItB,IAChC,IAGJtB,KAAKyQ,QAAO,EAEhB,CACOpH,UACLrJ,KAAK0f,KAAO,GACZ,IAAK,IAAIze,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAK0f,KAAKve,KAAKnB,KAAKmc,IAAIlb,GAAG2B,KAS7B,OAPaoiB,EAAAA,EAAAA,IAAWhlB,KAAK0f,KAQ/B,CAEWD,+BACT,OAAOzf,KAAK2jB,yBACd,CACWlE,6BAAyBvc,GAClClD,KAAKygB,gCAAiC,EACtCzgB,KAAK0gB,0CAA2C,EAChD1gB,KAAK2jB,0BAA4BzgB,CACnC,CACW+hB,yCACT,OAAOjlB,KAAK0jB,mCACd,CACWuB,uCAAmC/hB,GAC5ClD,KAAKygB,gCAAiC,EACtCzgB,KAAK0gB,0CAA2C,EAE9C1gB,KAAK0jB,oCADHxgB,GAAK,EACoC,KAEAA,CAE/C,CAEOkI,eACL,IAAI8Z,EAAMllB,KAAKmc,IAAI,GACnB,IAAK,IAAIlb,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACjCjB,KAAKmc,IAAIlb,GAAG2B,IAAIxB,EAAI8jB,EAAItiB,IAAIxB,IAC9B8jB,EAAMllB,KAAKmc,IAAIlb,IAGnB,OAAOikB,CACT,CACO/C,MAAM1Y,GACPzJ,KAAKO,OAAS6L,EAAAA,GAAAA,SAChB3C,EAAElJ,KAAO6L,EAAAA,GAAAA,MACApM,KAAKO,OAAS6L,EAAAA,GAAAA,UACvB3C,EAAElJ,KAAO6L,EAAAA,GAAAA,QAGX3C,EAAEzD,cAAe,EACjByD,EAAE+I,QAAQxS,MAeVA,KAAKmc,IAAIhb,KAAKsI,EAEhB,CACOD,SACL,MAAMC,EAAI,IAAIpJ,EACZL,KAAKM,GACLN,KAAKO,KACLP,KAAK+F,gBACL/F,KAAK4F,aACL5F,KAAKqG,eAOP,OALAoD,EAAE1I,SAASf,KAAK2M,WAGhBlD,EAAE3I,KAAmB,aAAId,KAAKuf,aAC9B9V,EAAE3I,KAA+B,yBAAId,KAAKyf,yBACnChW,CACT,CACO0b,sBACLnlB,KAAK6kB,YACL,IAAK,IAAI5jB,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,OAAS,IAAKD,EAAG,CAC5C,MAAMmkB,EAASplB,KAAKmc,IAAIlb,GAAG2B,IACrByiB,GAASC,EAAAA,EAAAA,IAAqBF,EAAOhkB,EAAGgkB,EAAO/jB,GAC/CkkB,EAAQvlB,KAAK2D,MAAMC,mBAAmBuS,eAAeC,eAAeoP,SACxEH,EAAOjkB,EACPikB,EAAOhkB,GAKHokB,EAAyE,IAAjEvY,EAAAA,EAAAA,IAAY,IAAI7K,EAAAA,GAASkjB,EAAM,GAAIA,EAAM,IAAKvlB,KAAKmc,IAAIlb,GAAG2B,KAAa,EAE/E8iB,EAAK1lB,KAAKmc,IAAIlb,GAAG2B,IACrB+iB,EAAK3lB,KAAKmc,IAAIlb,EAAI,GAAG2B,IACvB,IAAIM,GAAI2B,EAAAA,EAAAA,KAAM+gB,EAAAA,EAAAA,KAAUC,EAAAA,EAAAA,IAAIH,EAAIC,IAAMF,GAEtCviB,GAAI0P,EAAAA,EAAAA,IAAK8S,EAAIxiB,GACH,IAAI6Y,EAAO/b,KAAK2D,MAAOT,EAAE9B,EAAG8B,EAAE7B,EAAG6B,EAAE5B,GAC3CgP,OACJ,CACF,CACOwV,oBAA0B,IAARzZ,EAAC,uDAAG,EAC3B,IAAK,IAAIpL,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,OAAS,IAAKD,EAAG,CAC5C,MAAMykB,EAAK1lB,KAAKmc,IAAIlb,GAAG2B,IACjB+iB,EAAK3lB,KAAKmc,IAAIlb,EAAI,GAAG2B,KAChBmjB,EAAAA,EAAAA,IAAeL,EAAIC,EAAItZ,GAC/B2Z,SAAS9iB,IACA,IAAI6Y,EAAO/b,KAAK2D,MAAOT,EAAE9B,EAAG8B,EAAE7B,EAAG6B,EAAE5B,GAC3CgP,OAAO,GAEb,CACF,CACOjF,cACL,OAAOrL,KAAK2M,SACd,CACOsZ,aACLjmB,KAAKke,mBACLle,KAAKkmB,qBACP,CACOhW,gBACLlQ,KAAKgG,cAAe,EACpBhG,KAAKuH,eAAgB,EACrBvH,KAAKmc,IAAI6J,SAASvc,IAChBA,EAAEyG,eAAe,GAErB,CACOkR,eAEL,GADAphB,KAAKshB,OAAS,GACVthB,KAAKO,OAAS6L,EAAAA,GAAAA,SAChB,IAAK,IAAInL,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,OAAS,IAAKD,EACzCjB,KAAKshB,OAAOngB,MAAKglB,EAAAA,EAAAA,IAAOnmB,KAAKmc,IAAIlb,GAAG2B,IAAK5C,KAAKmc,IAAIlb,EAAI,GAAG2B,KAG/D,CACOwjB,gBACL,IAAInlB,EAAIjB,KAAKmc,IAAIjb,OACjB,KAAOD,KACL,GAAIjB,KAAKmc,IAAIlb,GAAGoQ,MAAO,CACrB,MAAM5H,EAAIzJ,KAAKmc,IAAIlb,GACnBwI,EAAE7G,KAAMujB,EAAAA,EAAAA,IAAO1c,EAAE7I,MAAM,GAAGgC,IAAK6G,EAAE7I,MAAM,GAAGgC,IAC5C,CAEJ,CACOsb,mBACL,MAAMld,EAAiB,GACvB,IAAK,IAAIC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCD,EAAGG,KAAKnB,KAAKmc,IAAIlb,GAAG2B,KAOtB,OALA5C,KAAK4C,KAAMyjB,EAAAA,EAAAA,IAAqBrlB,GAKzBhB,KAAK4C,GACd,CACOsjB,sBACLlmB,KAAK0f,KAAO,GACZ,IAAK,IAAIze,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAK0f,KAAKve,KAAKnB,KAAKmc,IAAIlb,GAAG2B,KAE7B5C,KAAKwjB,WAAY8C,EAAAA,EAAAA,IAAqBtmB,KAAK0f,KAC7C,CACO6G,aAAatlB,GAClB,GAAIjB,KAAKmc,IAAIjb,OAAS,EACpB,OAEF,MAAMslB,EAAKxmB,KAAKmc,IAAIlb,GACdwlB,GAAKN,EAAAA,EAAAA,IAAOnmB,KAAKmc,IAAIlb,EAAI,GAAG2B,IAAK5C,KAAKmc,IAAIlb,EAAI,GAAG2B,KACvD4jB,EAAG5jB,IAAM6jB,CACX,CACOnE,SAAS7Y,GACdzJ,KAAKmc,IAAIiB,OAAOpd,KAAKmc,IAAI1J,QAAQhJ,GAAI,GACrCA,EAAEgH,QACJ,CAIO9D,UACL,MAAM3L,EAAiB,GACvB,IAAK,IAAIC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCD,EAAGG,KAAKnB,KAAKmc,IAAIlb,GAAG2B,KAGtB,OADA5C,KAAK0f,KAAO1e,EACLA,CACT,CACO+O,SAAS3O,EAAWC,GACzB,MAAMgP,EAAIrQ,KAAKwJ,SAETkd,EAAK7E,EAAiBzR,SAASpQ,KAAK2D,MAAO0M,GAAG,GAAM,GAK1D,OAJAqW,EAAGtZ,KAAKhM,EAAGC,GACXqlB,EAAG9gB,cAAe,EAClB8gB,EAAG7V,eAEI6V,CACT,CACWhmB,eACT,OAAOV,KAAKqG,aACd,CACW3F,aAASwC,GAClBlD,KAAKsG,YAActG,KAAKqG,cACxBrG,KAAKqG,cAAgBnD,EACrB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGoF,cAAgBnD,EAC5BlD,KAAKmc,IAAIlb,GAAGoJ,WAAa,EAE3BrK,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBC,UAAUjK,KAAKwJ,SAC1E,CACW4Y,iBAAalf,GACtBlD,KAAKgG,aAAe9C,EACpB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAG+E,aAAe9C,CAE/B,CACWkf,mBACT,OAAOpiB,KAAKgG,YACd,CACW9C,QACT,OAAOlD,KAAK4C,GACd,CACWM,MAAEA,GACXlD,KAAK4C,IAAMM,CACb,CACW1C,iBACT,OAAOR,KAAK+F,eACd,CACWvF,eAAW0C,GACpB,IAAIlD,KAAK2F,UAAa3F,KAAKgC,eAAgBhC,KAAKqG,cAAhD,CAGArG,KAAK+F,gBAAkB7C,EACvB,IAAK,MAAMuG,KAAKzJ,KAAKmc,IACnB1S,EAAEzH,aAAekB,EAEnBlD,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2c,eAAe3mB,KAAKwJ,SAL7E,CAMF,CACWY,cACT,OAAOpK,KAAK4F,YACd,CAgBWwE,YAAQlH,GACjB,IAAIlD,KAAKmH,oBAAT,CAWA,GARAnH,KAAK4F,aAAe1C,GAEhBlD,KAAK4F,eAAiB5F,KAAK6F,aAEnB7F,KAAK4F,cAAgB5F,KAAK6F,aADpC7F,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB4c,WAAW5mB,KAAKwJ,UAI3ExJ,KAAK6F,WAAa7F,KAAK4F,cAClB5F,KAAK+F,gBACR,IAAK,MAAM0D,KAAKzJ,KAAKmc,IACnB1S,EAAEzH,aAAekB,EAkBhBA,IACHlD,KAAK8G,mBAAoB,EACzB9G,KAAK4M,mBA/BP,CAuCF,CAEO8D,iBAEL1Q,KAAK2D,MAAMC,mBAAmBuS,eAAe2M,eAAe+D,iBAC5D7mB,KAAKuL,mBAILvL,KAAK4f,UAAUkH,wBACjB,CACOnW,kBAGL,CAEKnN,SACL,CAsDKgM,WAAW9L,GAEhB1D,KAAKwD,SACLxD,KAAKimB,aAGLjmB,KAAKmF,SAASsQ,MAAMF,qBAGhBvV,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAayY,UAOvE/mB,KAAKmF,SAASqK,WAAW9L,EAC3B,EA/+BWme,EACGmF,OAAQ,EADXnF,EAEGoB,QAAS,EAFZpB,EAGGQ,kBAAY,ECzBrB,MAAMnH,UAAuBM,EAElC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KAFNA,SAAG,CAGV,CACOyM,cASL,GARAgK,EAAY8O,yBACVjnB,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElDyI,EAAY+O,6BACVlnB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAE9C1P,KAAK0B,IAAIya,IACX,IAAK,IAAIlb,EAAI,EAAGA,EAAIjB,KAAK0B,IAAIya,IAAIjb,SAAUD,EACzCjB,KAAK0B,IAAIya,IAAIlb,GAAGoC,eAAeuY,mBAAmB5b,KAAKmb,gBAG7D,ECVK,MAAMgM,UAAwBtF,EAKnC,gBAAuBzgB,EAAWC,GAGhC,CAEF,mBAA0BsC,EAAc2J,GACtC,IAAK,IAAIrM,EAAI0C,EAAMyjB,oBAAoBlmB,OAAS,EAAGD,GAAK,IAAKA,EAC3D,GACE0C,EAAMyjB,oBAAoBnmB,GAAG+E,cAC7BrC,EAAMyjB,oBAAoBnmB,GAAG4R,cAAcvF,EAAElM,EAAGkM,EAAEjM,GAElD,OAAOsC,EAAMyjB,oBAAoBnmB,EAIvC,CACA,mBAA0B0C,EAAc2J,GACtC,MAAM0U,EAAKre,EAAMC,mBAAmBuS,eAAe2M,eAAeb,YAAY3U,QACnE3K,IAAPqf,IACFA,EAAGpc,cAAe,EAEtB,CACA,wBAA+BjC,EAAc+iB,GAC3C,MAAMhlB,EAAM,IAAIylB,EAAgBxjB,EAAO+iB,EAAGvK,IAAI,GAAGpM,YACjD,IAAK,IAAI9O,EAAI,EAAGA,EAAIylB,EAAGvK,IAAIjb,SAAUD,EACnCS,EAAIygB,MAAMuE,EAAGvK,IAAIlb,GAAG8O,YAMtB,OAJArO,EAAInB,KAAO6L,EAAAA,GAAAA,QACX1K,EAAIpB,GAAKomB,EAAGpmB,GACZoB,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EACnBzF,CACT,CACA,wBAA+BiC,EAAc3C,GAC3C,MAAMU,EAAM,IAAIylB,EAAgBxjB,EAAO,IAAIoY,EAAOpY,EAAO3C,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,IACxE,IAAK,IAAIJ,EAAI,EAAGA,EAAID,EAAGE,OAAS,IAAKD,EACnCS,EAAIygB,MAAM,IAAIpG,EAAOpY,EAAO3C,EAAGC,GAAGG,EAAGJ,EAAGC,GAAGI,IAW7C,OATAK,EAAInB,KAAO6L,EAAAA,GAAAA,QACX1K,EAAIwc,mBACJxc,EAAIoO,kBACJnM,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,UACzE9H,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EAC1BzF,EAAI0I,SAAU,EACd1I,EAAIwF,gBAAkB,EACtBxF,EAAIM,cAAe,EACZN,CACT,CAYA,gBAAuBiC,EAAc0M,GAAoD,IAArCtJ,EAAM,wDAAUuV,EAAU,wDAC5E,MAAM5a,EAAM,IAAIylB,EAAgBxjB,EAAOoY,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAM,GAAImG,IACjF,GAAIA,EAAQ,CACVrF,EAAIqF,OAASA,EACb,IAAK,IAAI9F,EAAI,EAAGA,EAAIoP,EAAEzP,MAAMM,SAAUD,EACpCS,EAAIygB,MAAMpG,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAMK,GAAI8F,GAExD,MACE,IAAK,IAAI9F,EAAI,EAAGA,EAAIoP,EAAEzP,MAAMM,SAAUD,EACpCS,EAAIygB,MAAMpG,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAMK,KA0BpD,OAvBAS,EAAInB,KAAO6L,EAAAA,GAAMiE,EAAE9P,MAGjBmB,EAAIpB,GADFgc,EACO3Y,EAAMsF,UAENoH,EAAE/P,GAEboB,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EAC1BzF,EAAI0I,SAAU,EACd1I,EAAI2E,cAAgBgK,EAAE3P,SAClB2P,EAAE3P,SACJgB,EAAIwF,gBAAkB,EAEtBxF,EAAIwF,gBAAkB,EAIxBxF,EAAIwc,mBACJxc,EAAIoO,kBACC/I,GACHpD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,UAEpE9H,CACT,CACA,kBAAyB4L,QACc3K,IAAjCwkB,EAAgB9E,cAClB8E,EAAgB9E,aAAalG,IAAIgL,EAAgB9E,aAAalG,IAAIjb,OAAS,GAAGkM,KAAKE,EAAElM,EAAGkM,EAAEjM,EAE9F,CACA,eACEsC,EACA2J,GAGC,IAFDiS,EAAY,wDACD,2CAAGnT,EAAAA,GAAAA,YAEuBzJ,IAAjCwkB,EAAgB9E,aAClB8E,EAAgB9E,aAAaF,MAAM,IAAIpG,EAAOpY,EAAO2J,EAAElM,EAAGkM,EAAEjM,EAAG,GAAG,EAAO+K,EAAAA,GAAAA,cAEzE+a,EAAgB9E,aAAe,IAAI8E,EACjCxjB,EACA,IAAIoY,EAAOpY,EAAO2J,EAAElM,EAAGkM,EAAEjM,IACzB,EACAke,GAEF4H,EAAgB9E,aAAalG,IAAI,GAAGnW,cAAe,EAEnDmhB,EAAgB9E,aAAaF,MAAM,IAAIpG,EAAOpY,EAAO2J,EAAElM,EAAGkM,EAAEjM,EAAG,GAAG,EAAO+K,EAAAA,GAAAA,aACzE+a,EAAgB9E,aAAalb,qBAAsB,EAEvD,CACA,mBAA0BsC,GACpB,CAEN,YAAmB9F,EAAc2J,GAC/B,IAAK6Z,EAAgB9E,aACnB,OAEF,IAAIphB,EAAIkmB,EAAgB9E,aAAalG,IAAIjb,OAAS,EACxC,IAAND,GAIJkmB,EAAgB9E,aAAaC,SAAS6E,EAAgB9E,aAAalG,MAAMlb,IACzEkmB,EAAgB9E,aAAalG,IAAIlb,GAAG2B,IAAIxB,EAAIkM,EAAElM,EAC9C+lB,EAAgB9E,aAAalG,IAAIlb,GAAG2B,IAAIvB,EAAIiM,EAAEjM,GAL5C8lB,EAAgB5E,OAAO5e,EAO3B,CACA,YAAmBA,GACbA,EAAMC,mBAAmB4H,wBAAwB6b,aACnDrnB,KAAKsnB,YAAY3jB,GAEjB3D,KAAKunB,iBAAiB5jB,GAExBA,EAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMyW,UAAUC,iBAAiBC,2BAA4B,CAC5G,CACA,mBAA0Bhf,QACahB,IAAjCwkB,EAAgB9E,eAClB8E,EAAgB9E,aAAaD,cAAe,EAE5C+E,EAAgB9E,aAAaC,SAAS6E,EAAgB9E,aAAalG,IAAI,KAErEjP,EAAAA,EAAAA,IACEia,EAAgB9E,aAAalG,IAAIgL,EAAgB9E,aAAalG,IAAIjb,OAAS,GAAG0B,IAC9EukB,EAAgB9E,aAAalG,IAAI,GAAGvZ,KAClC,IAEJukB,EAAgB9E,aAAaC,SAC3B6E,EAAgB9E,aAAalG,IAAIgL,EAAgB9E,aAAalG,IAAIjb,OAAS,IAG/EimB,EAAgB9E,aAAaC,SAC3B6E,EAAgB9E,aAAalG,IAAIgL,EAAgB9E,aAAalG,IAAIjb,OAAS,IAE7EimB,EAAgB9E,aAAanE,mBAC7BiJ,EAAgB9E,aAAavS,kBAE7BqX,EAAgB9E,aAAalb,qBAAsB,EACnDxD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAClDqW,EAAgB9E,aAAa7Y,UAG3B2d,EAAgB9E,aAAalG,IAAIjb,OAAS,GAC5CimB,EAAgB9E,aAAa5R,SAE/B0W,EAAgB9E,kBAAe1f,EAC/BgB,EAAMC,mBAAmB4H,wBAAwBgX,aAGrD,CACA,wBAA+B7e,QACQhB,IAAjCwkB,EAAgB9E,eAClB8E,EAAgB9E,aAAaD,cAAe,EAE5C+E,EAAgB9E,aAAaC,SAC3B6E,EAAgB9E,aAAalG,IAAIgL,EAAgB9E,aAAalG,IAAIjb,OAAS,KAG3EgM,EAAAA,EAAAA,IACEia,EAAgB9E,aAAalG,IAAIgL,EAAgB9E,aAAalG,IAAIjb,OAAS,GAAG0B,IAC9EukB,EAAgB9E,aAAalG,IAAI,GAAGvZ,KAClC,GAEJukB,EAAgB9E,aAAaC,SAC3B6E,EAAgB9E,aAAalG,IAAIgL,EAAgB9E,aAAalG,IAAIjb,OAAS,IAG/EimB,EAAgB9E,aAAaC,SAC3B6E,EAAgB9E,aAAalG,IAAIgL,EAAgB9E,aAAalG,IAAIjb,OAAS,IAE7EimB,EAAgB9E,aAAanE,mBAE7BiJ,EAAgB9E,aAAalb,qBAAsB,EACnDxD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAClDqW,EAAgB9E,aAAa7Y,UAG3B2d,EAAgB9E,aAAalG,IAAIjb,OAAS,GAC5CimB,EAAgB9E,aAAa5R,SAE/B0W,EAAgB9E,kBAAe1f,EAC/BgB,EAAMC,mBAAmB4H,wBAAwBgX,aAErD,CACA,sBAA6B7e,QACUhB,IAAjCwkB,EAAgB9E,eAClB8E,EAAgB9E,aAAaD,cAAe,EAE5C+E,EAAgB9E,aAAaC,SAC3B6E,EAAgB9E,aAAalG,IAAIgL,EAAgB9E,aAAalG,IAAIjb,OAAS,IAE7EimB,EAAgB9E,aAAalb,qBAAsB,EACnDggB,EAAgB9E,aAAanE,mBAC7Bva,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAClDqW,EAAgB9E,aAAa7Y,UAG3B2d,EAAgB9E,aAAalG,IAAIjb,OAAS,GAC5CimB,EAAgB9E,aAAa5R,SAE/B0W,EAAgB9E,kBAAe1f,EAC/BgB,EAAMC,mBAAmB4H,wBAAwBgX,aAErD,CACA,cAAqB7e,QACkBhB,IAAjCwkB,EAAgB9E,eAClB8E,EAAgB9E,aAAaxb,UAAW,EACxCsgB,EAAgB9E,aAAa5R,SAC7B0W,EAAgB9E,kBAAe1f,EAC/BgB,EAAMC,mBAAmB4H,wBAAwBgX,aAErD,CAKA,iBAAwB7e,EAAc2J,GACpC,GAAI3J,EAAMC,mBAAmB4H,wBAAwB8C,aAAasU,4BAA6B,CAC7F,MAAMC,EAAOlf,EAAMC,mBAAmBuS,eAAe2M,eAAeb,YAAY3U,GAC5E6Z,EAAgB9E,eAClB8E,EAAgBpE,QAAQpf,EAAO2J,GAC3BuV,IAEFsE,EAAgB9E,aAAa9hB,KAAO6L,EAAAA,GAAAA,QACpC+a,EAAgB9E,aAAaW,UAAW,EACxCmE,EAAgB9E,aAAaC,SAC3B6E,EAAgB9E,aAAalG,IAAIgL,EAAgB9E,aAAalG,IAAIjb,OAAS,IAE7EimB,EAAgB9E,aAAaC,SAC3B6E,EAAgB9E,aAAalG,IAAIgL,EAAgB9E,aAAalG,IAAIjb,OAAS,IAE7E2hB,EAAK9c,iBAAkB,EACvB8c,EAAKjd,cAAe,EACpBid,EAAKpc,iBAAkB,EACvBoc,EAAK7c,cAAe,EAEpBmhB,EAAgB9E,aAAaD,cAAe,EAC5C+E,EAAgB9E,aAAalb,qBAAsB,EAEnDggB,EAAgB9E,aAAanE,mBAC7Bva,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAClDqW,EAAgB9E,aAAa7Y,UAQ/B2d,EAAgB9E,kBAAe1f,GAGrC,MACEwkB,EAAgBpE,QAAQpf,EAAO2J,EAEnC,CACA,sBAA6B3J,EAAc2J,GAAkF,IAA/DiS,EAAY,wDAAUhf,EAAW,uDAAG6L,EAAAA,GAAAA,QAChG,QAAsBzJ,IAAlBgB,EAAMgP,QAGV,YAAqChQ,IAAjCwkB,EAAgB9E,cAA8B8E,EAAgBlE,QAChEkE,EAAgB9E,aAAatc,iBAAkB,EAC/CohB,EAAgB9E,kBAAe1f,OAC/BwkB,EAAgBlE,QAAS,cAEiBtgB,IAAjCwkB,EAAgB9E,cACzB8E,EAAgBpE,QAAQpf,EAAO2J,EAAGiS,EAAchf,GAGpD,CACA,iBAAwB+M,GACtB,QAAqC3K,IAAjCwkB,EAAgB9E,aAApB,CAGA,GACE8E,EAAgB9E,aAAa1e,MAAMC,mBAAmB4H,wBAAwB8C,aAC3EyQ,YACHoI,EAAgB9E,aAAalG,IAAIjb,OAAS,EAC1C,CACA,MAAMgc,EAAKiK,EAAgB9E,aAAalG,IAAIgL,EAAgB9E,aAAalG,IAAIjb,OAAS,IAClFgM,EAAAA,EAAAA,IAAYgQ,EAAGta,IAAK,IAAIP,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,IAAM,IAChDrB,KAAKwnB,UAAUL,EAAgB9E,aAAa1e,MAAO2J,EAEvD,CACA6Z,EAAgBjE,WAAW5V,EAX3B,CAaF,CACA,wBAA+B3J,EAAc2J,QACN3K,IAAjCwkB,EAAgB9E,cAClB8E,EAAgBhE,KAAKxf,EAEzB,CAEA9D,YAAY8D,EAAc8F,GAAkD,IAAvB8V,EAAY,wDAC/Dra,MAAMvB,EAAO8F,EAD4B,yDAEzCzJ,KAAKynB,uBACLhe,EAAEpG,eAAeuY,mBAAmB5b,KAAKqD,eAAe8X,iBAExDnb,KAAKuf,aAAeA,EACpBvf,KAAKsF,QAAS,EACd3B,EAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMyW,UAAUC,iBAAiBC,2BAA4B,EAC1G3iB,KAAK0nB,aACP,CACQD,uBACNznB,KAAKqD,eAAiB,IAAI6X,EAAelb,KAC3C,CACQ0nB,cACN1nB,KAAKO,KAAO6L,EAAAA,GAAAA,QACZpM,KAAK2D,MAAMgkB,mBAAmB3nB,KAChC,CACO8S,SACL,GAAI9S,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,cAC9C,MAAO,GA4BT,MAzBE,UACArG,KAAKM,GADL,WAIAN,KAAKO,KAAKwS,WAJV,oBAYA/S,KAAKmc,IAAIjb,OAZT,WAeAlB,KAAKqJ,UAAU4a,QAAQ,GAAGlR,WAf1B,eAqBA/S,KAAK+F,gBArBL,gBAwBA/F,KAAKgG,YAET,CACOgN,YAeL,MAbE,iBACAhT,KAAKM,GADL,wDAUAN,KAAK2H,EACL,YAGJ,CAEWya,iBAAalf,GACtBlD,KAAKgG,aAAe9C,EACpB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAG+E,aAAe9C,CAE/B,CACWkf,mBACT,OAAOpiB,KAAKgG,YACd,CACWtF,aAASwC,GAClBlD,KAAKsG,YAActG,KAAKqG,cACxBrG,KAAKqG,cAAgBnD,EACrB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGoF,cAAgBnD,EAC5BlD,KAAKmc,IAAIlb,GAAGoJ,WAAa,EAE3BrK,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBC,UAAUjK,KAAKwJ,SAC1E,CACW9I,eACT,OAAOV,KAAKqG,aACd,CACOsK,kBACL,CAEKjD,gBAAgBtM,EAAWC,GAChC,IAAIrB,KAAK2F,UAAa3F,KAAKgC,eAAgBhC,KAAKqG,cAGhD,IAAK,IAAIpF,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrC,GAAIjB,KAAKmc,IAAIlb,GAAG4R,cAAczR,EAAGC,GAC/B,OAAOrB,KAAKmc,IAAIlb,EAItB,CACOwP,SAA+B,IAAxB5J,IAAQ,yDACpB,IAAI7G,KAAK2F,UAAa3F,KAAKgC,eAAgBhC,KAAKqG,cAAhD,CAGA,IAAK,IAAIpF,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAG8c,aAKd,GAHA/d,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EACpBhC,KAAK4M,oBACA5M,KAAKmH,qBAAuBN,EAAU,CACzC,MAAMuX,EAAQpe,KAAKwJ,SACf4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB,CAACvG,GAElF,CACApe,KAAK2D,MAAMikB,sBAAsB5nB,MACjCA,KAAK2D,MAAM8a,eAAeze,KAd1B,CAeF,CACO+P,SAAS3O,EAAWC,GACzB,MAAMgP,EAAIrQ,KAAKwJ,SAETkd,EAAKS,EAAgB/W,SAASpQ,KAAK2D,MAAO0M,GAAG,GAAM,GAIzD,OAHAqW,EAAGtZ,KAAKhM,EAAGC,GACXqlB,EAAG9gB,cAAe,EAClB8gB,EAAG7V,eACI6V,CACT,EA3cWS,EACGH,OAAQ,EADXG,EAEGlE,QAAS,EAFZkE,EAGG9E,kBAAY,ECZrB,MAAMwF,EAGXhoB,YAAYioB,GAA8C,IAAjBC,EAAU,uDAAG,EAAC,KAFhDD,kBAAY,OACZC,WAAa,EAElB/nB,KAAK8nB,aAAeA,EACpB9nB,KAAK+nB,WAAaA,CACpB,CACOtkB,OAAOC,EAA+Bsf,EAAmBhiB,GAC9DhB,KAAK6f,aAAanc,EAAKsf,EAAUhiB,GACjChB,KAAKgoB,eAAetkB,EAAK1C,GACzBhB,KAAK8f,gBAAgBpc,EAAK1C,EAC5B,CACO6e,aAAanc,EAA+Bsf,EAAmBhiB,GACpE,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAGE,OAAS,IAAKD,EAC/BD,EAAGC,GAAGG,EAAIJ,EAAGC,EAAI,GAAGG,EACtBpB,KAAK8nB,aAAankB,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAKkH,QAClEvkB,EACA1D,KAAK8nB,aAAazkB,eAAe1C,YACjCK,EAAGC,GAAGG,EACNJ,EAAGC,GAAGI,EACNL,EAAGC,EAAI,GAAGG,EACVJ,EAAGC,EAAI,GAAGI,EACV,GAGFrB,KAAK8nB,aAAankB,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAKkH,QAClEvkB,EACA1D,KAAK8nB,aAAazkB,eAAe1C,YACjCK,EAAGC,EAAI,GAAGG,EACVJ,EAAGC,EAAI,GAAGI,EACVL,EAAGC,GAAGG,EACNJ,EAAGC,GAAGI,EACN,GA4BN,GAxBI2hB,IACEhiB,EAAGA,EAAGE,OAAS,GAAGE,EAAIJ,EAAG,GAAGI,EAC9BpB,KAAK8nB,aAAankB,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAKkH,QAClEvkB,EACA1D,KAAK8nB,aAAazkB,eAAe1C,YACjCK,EAAGA,EAAGE,OAAS,GAAGE,EAClBJ,EAAGA,EAAGE,OAAS,GAAGG,EAClBL,EAAG,GAAGI,EACNJ,EAAG,GAAGK,EACN,GAGFrB,KAAK8nB,aAAankB,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAKkH,QAClEvkB,EACA1D,KAAK8nB,aAAazkB,eAAe1C,YACjCK,EAAG,GAAGI,EACNJ,EAAG,GAAGK,EACNL,EAAGA,EAAGE,OAAS,GAAGE,EAClBJ,EAAGA,EAAGE,OAAS,GAAGG,EAClB,IAKF2hB,EACF,IAAK,IAAI/hB,EAAI,EAAGA,EAAID,EAAGE,SAAUD,EAC3BA,IAAMD,EAAGE,OAAS,EACpBlB,KAAK8nB,aAAankB,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAKkH,QAClEvkB,EACA1D,KAAK8nB,aAAazkB,eAAe1C,YACjCK,EAAGC,GAAGG,EACNJ,EAAGC,GAAGI,EACNL,EAAG,GAAGI,EACNJ,EAAG,GAAGK,EACN,GAGEL,EAAGC,GAAGG,EAAIJ,EAAGC,EAAI,GAAGG,EACtBpB,KAAK8nB,aAAankB,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAKkH,QAClEvkB,EACA1D,KAAK8nB,aAAazkB,eAAe1C,YACjCK,EAAGC,GAAGG,EACNJ,EAAGC,GAAGI,EACNL,EAAGC,EAAI,GAAGG,EACVJ,EAAGC,EAAI,GAAGI,EACV,GAGFrB,KAAK8nB,aAAankB,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAKkH,QAClEvkB,EACA1D,KAAK8nB,aAAazkB,eAAe1C,YACjCK,EAAGC,EAAI,GAAGG,EACVJ,EAAGC,EAAI,GAAGI,EACVL,EAAGC,GAAGG,EACNJ,EAAGC,GAAGI,EACN,QAMR,IAAK,IAAIJ,EAAI,EAAGA,EAAID,EAAGE,OAAS,IAAKD,EAC/BD,EAAGC,GAAGG,EAAIJ,EAAGC,EAAI,GAAGG,EACtBpB,KAAK8nB,aAAankB,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAKkH,QAClEvkB,EACA1D,KAAK8nB,aAAazkB,eAAe1C,YACjCK,EAAGC,GAAGG,EACNJ,EAAGC,GAAGI,EACNL,EAAGC,EAAI,GAAGG,EACVJ,EAAGC,EAAI,GAAGI,EACV,GAGFrB,KAAK8nB,aAAankB,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAKkH,QAClEvkB,EACA1D,KAAK8nB,aAAazkB,eAAe1C,YACjCK,EAAGC,EAAI,GAAGG,EACVJ,EAAGC,EAAI,GAAGI,EACVL,EAAGC,GAAGG,EACNJ,EAAGC,GAAGI,EACN,EA0BV,CACO2mB,eAAetkB,EAA+B1C,GAC/CA,EAAGE,OAAS,GAAKlB,KAAK8nB,aAAavnB,OAAS6L,EAAAA,GAAAA,UAC9CpM,KAAK+f,kBAAkBrc,EAAK1C,EAGhC,CACO8e,gBAAgBpc,EAA+B1C,GAGtD,CACO+e,kBAAkBrc,EAA+B1C,GAMtD,CAGKknB,mBAAmBxkB,EAA+BR,EAAalC,GAIpE,CAEKmnB,sBAAsBzkB,EAA+BR,EAAalC,GAOvE,CAGKonB,iBAAiB1kB,EAA+B1C,GAGrD,CAEKqnB,oBAAoB3kB,EAA+B1C,GAM1D,CAEOsnB,kBAAkB5kB,EAA+B1C,EAAgBgiB,GACtE,CAEKuF,uBAAuB7kB,EAA+B1C,EAAgBgiB,GAE3E,IAAK,IAAI/hB,EAAI,EAAGA,EAAID,EAAGE,OAAS,IAAKD,GAOvC,CACOunB,0BAA0B9kB,EAA+BR,EAAWulB,GAM3E,CACOC,qBAAqBhlB,EAA+B1C,EAAgBgiB,GAEzE,IAAK,IAAI/hB,EAAI,EAAGA,EAAID,EAAGE,OAAS,IAAKD,GAOvC,CAEO6lB,yBACL,EC9NG,MAAM6B,EAGX9oB,YAAY6B,GAAqB,KAF1BA,SAAG,OACH4C,UAAI,EAETtE,KAAK0B,IAAMA,EACX1B,KAAKsE,KAAO5C,CACd,CACOmR,cAAczR,EAAWC,GAC9B,MAAMolB,EAAK,IAAIpkB,EAAAA,GAASjB,EAAGC,GAE3B,QAAIrB,KAAKsE,KAAKqB,WAAa3F,KAAKsE,KAAKtC,cAAgBhC,KAAKsE,KAAK+B,kBAGzB,IAAlCrG,KAAKsE,KAAK6C,0BAAkExE,IAAlC3C,KAAKsE,KAAK6C,uBAGpDnH,KAAK0B,IAAIqB,aAGb/C,KAAKsE,KAAKskB,UAAW,IAEjB5oB,KAAK6oB,gBAAgBpC,KAIrBzmB,KAAK8oB,mBAAmBrC,IAAOzmB,KAAK+oB,gBAAgBtC,IACtDzmB,KAAKsE,KAAK8F,SAAU,GACb,IAGL8C,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK0kB,mBAAoBvC,GAAM,IAClDzmB,KAAKsE,KAAKskB,UAAW,EACrB5oB,KAAKsE,KAAK8F,SAAU,GACb,GAGLpK,KAAKmkB,cAAc/iB,EAAGC,IACxBrB,KAAKsE,KAAK8F,SAAU,GACb,MAGL6e,EAAAA,EAAAA,IAAgBjpB,KAAKsE,KAAK1B,IAAK6jB,EAAsB,GAAlBzmB,KAAKsE,KAAKhB,MAAgC,GAAnBtD,KAAKsE,KAAKf,UAIxEvD,KAAKsE,KAAK8F,SAAU,GACb,MACT,CACO0I,SAyBL,MAtBE,UACA9S,KAAKsE,KAAKhE,GADV,WAIAN,KAAKsE,KAAK/D,KAAKwS,WAJf,qBAYA/S,KAAKsE,KAAK+E,UAAU4a,QAAQ,GAAGlR,WAZ/B,eAkBA/S,KAAKsE,KAAKyB,gBAlBV,gBAqBA/F,KAAKsE,KAAK0B,YAEd,CACOiN,OACL,CAEM6V,mBAAmBrL,GACzB,IAAK,IAAIxc,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK4kB,OAAOhoB,SAAUD,EAC7C,IAAIiM,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK4kB,OAAOjoB,GAAIwc,GAAK,GAGxC,OAFAzd,KAAKsE,KAAK6kB,cAAgBloB,EAC1BjB,KAAKsE,KAAK8kB,uBAAwB,GAC3B,EAKX,OADAppB,KAAKsE,KAAK6kB,eAAiB,GACpB,CACT,CACQJ,gBAAgBtL,GACtB,IAAK,IAAIxc,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK6X,IAAIjb,OAAS,IAAKD,EAC9C,IAAIojB,EAAAA,EAAAA,IAAyB5G,EAAGzd,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAK5C,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,KAAO,GAEhF,OADA5C,KAAKsE,KAAK8kB,uBAAwB,GAC3B,EAGX,OAAO,CACT,CACQP,gBAAgBpL,GACtB,IAAK,IAAIxc,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK6X,IAAIjb,SAAUD,EAC1C,IAAIiM,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAK6a,GAAK,GAEzC,OADAzd,KAAKsE,KAAKif,YAActiB,GACjB,EAIX,OADAjB,KAAKsE,KAAKif,aAAe,GAClB,CACT,CACQY,cAAc/iB,EAAWC,GAC/B,OAAOrB,KAAK0B,IAAIiC,MAAMC,mBAAmBuS,eAAe2M,eAAewB,yBACrEljB,EAAIpB,KAAK0B,IAAIiC,MAAM0lB,cAAcC,mBAAmBloB,EACpDC,EAAIrB,KAAK0B,IAAIiC,MAAM0lB,cAAcC,mBAAmBjoB,EACpDrB,KAAK0B,IAAIyG,UAuBb,CACOohB,0BACDvpB,KAAKsE,KAAK6kB,eAAiB,EAC7BnpB,KAAKwpB,sBAELxpB,KAAKypB,kBAET,CACQA,mBACN,GAAIzpB,KAAKsE,KAAKX,MAAM+Z,UAAW,CACf1d,KAAKsE,KAAK6X,IAAI1J,QAAQzS,KAAKsE,KAAKX,MAAM+Z,WACxC,IAAM,EAChB1d,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBke,kBAAkBC,gBAC3EC,EAAAA,GAAAA,YAGF5pB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBke,kBAAkBC,gBAC3EC,EAAAA,GAAAA,WAGN,MACE5pB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBke,kBAAkBG,qBAEjF,CACQL,uBAC2B,IAA7BxpB,KAAKsE,KAAK6kB,eACZnpB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBke,kBAAkBG,sBAE3E7pB,KAAKsE,KAAK6kB,cAAgB,IAAM,EAClCnpB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBke,kBAAkBC,gBAC3EC,EAAAA,GAAAA,UAGF5pB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBke,kBAAkBC,gBAC3EC,EAAAA,GAAAA,SAGN,CAGO9f,sBAAsB5G,GAC3BlD,KAAKsE,KAAKkE,yBAAsB7F,EAChC,IAAK,IAAI1B,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK4kB,OAAOhoB,OAAQD,GAAK,EAAG,CAEnD,IADYiM,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK4kB,OAAOjoB,GAAIiC,GAG3ClD,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAawb,kBAOxE,OADA9pB,KAAKsE,KAAKkE,oBAAsBxI,KAAKsE,KAAK4kB,OAAOjoB,GAC1CjB,KAAKsE,KAAKkE,mBAErB,CAEA,IADY0E,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK1B,IAAKM,GAGrClD,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAawb,kBAGxE,OADA9pB,KAAKsE,KAAKkE,oBAAsBxI,KAAKsE,KAAK1B,IACnC5C,KAAKsE,KAAKkE,mBAGrB,CACOuhB,8BACL,IAAK/pB,KAAKsE,KAAKgG,iBAAmBtK,KAAKsE,KAAKgG,eAAe+I,WACzD,OAAO,EAGT,IAAI2W,GAAgB,GAGhB9c,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK1B,IAAK5C,KAAKsE,KAAKgG,eAAe+I,WAAWC,IAAM,IACvE0W,GAAgB,GAIlB,IAAK,IAAI/oB,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK4kB,OAAOhoB,SAAUD,GACzCiM,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK4kB,OAAOjoB,GAAIjB,KAAKsE,KAAKgG,eAAe+I,WAAWC,IAAM,IAC7E0W,GAAgB,GAGpB,QAAIA,IAGJhqB,KAAKsE,KAAKgG,eAAe2f,mBAAgBtnB,EACzC3C,KAAKsE,KAAKgG,oBAAiB3H,GACpB,EACT,CACOiI,qBAAqB1H,EAAa2H,GAGvC,GAFA7K,KAAKsE,KAAK4Z,mBACVle,KAAKsE,KAAK4lB,gBACNhd,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK1B,IAAKM,GAAK,EAClClD,KAAKsE,KAAKkE,oBAAsBxI,KAAKsE,KAAK1B,SAG5C,IAAK,IAAI3B,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK4kB,OAAOhoB,SAAUD,EAC7C,IAAIiM,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK4kB,OAAOjoB,GAAIiC,GAAK,EAExC,YADAlD,KAAKsE,KAAKkE,oBAAsBxI,KAAKsE,KAAK4kB,OAAOjoB,GAIvD,EChPK,MAAMuU,UAA0BE,EAMrC7V,YAAYyE,GACVY,MAAMZ,GAAM,KANPA,UAAI,OACJ3D,iBAAW,OACXwa,qBAAe,EAKpBnb,KAAKsE,KAAOA,CACd,CACOkL,WAAW9L,GAChB1D,KAAKmU,iBAAiB3Q,SACtBxD,KAAKyV,MAAMjS,SACXxD,KAAKyV,MAAMF,qBAGXvV,KAAKsE,KAAKc,eAAe+kB,0BAIvBnqB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAayY,WACxE/mB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAa8b,iBAExEpqB,KAAKsE,KAAK2hB,aAIVjmB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAaqR,UACxE3f,KAAKsE,KAAK+lB,mBACVrqB,KAAKsE,KAAKsB,eAEVlC,EAAI8b,UAAY,SAChB9b,EAAIM,UAAY,UACZ,IAAMsO,KAAKyS,IAAI/kB,KAAKsE,KAAKhB,QAC3BI,EAAIkB,SAAS,uBAAwB5E,KAAKsE,KAAK1B,IAAIxB,EAAGpB,KAAKsE,KAAK1B,IAAIvB,IAKpErB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAaqR,WACtE3f,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAK6C,uBACtCnH,KAAKsE,KAAKsb,UAAUwI,iBAAiB1kB,EAAK1D,KAAKsE,KAAKob,MAChD1f,KAAKsE,KAAK+lB,kBACZrqB,KAAKsE,KAAKsb,UAAUyI,oBAAoB3kB,EAAK1D,KAAKsE,KAAKob,KAAM,0BAE7D1f,KAAKsE,KAAKsb,UAAUyI,oBAAoB3kB,EAAK1D,KAAKsE,KAAKob,OA6B7D1f,KAAKigB,mBAAmBvc,EAAK1D,KAAKsE,KAAKX,MAAMC,mBAAmBuS,eAAeC,eAAekU,uBAAuBtqB,KAAKsE,KAAKqI,WACjI,CACQsT,mBAAmBvc,EAA+Bgc,GAKxD,MAAM6K,EAAKvqB,KAAKsE,KAAKX,MAAMC,mBAAmBuS,eAAeC,eAAeC,sBAAsBrW,KAAKsE,KAAK1B,KAEtGU,EAAQgP,KAAKyS,IAAI/kB,KAAKsE,KAAK4kB,OAAO,GAAG9nB,EAAIpB,KAAKsE,KAAK4kB,OAAO,GAAG9nB,GAC7DmC,EAAS+O,KAAKyS,IAAsD,IAAjD/kB,KAAKsE,KAAK4kB,OAAO,GAAG7nB,EAAIrB,KAAKsE,KAAK4kB,OAAO,GAAG7nB,IAErErB,KAAKsE,KAAK4lB,eAKNlqB,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAKyB,iBACtC/F,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2K,KAAKsJ,aAC1D9mB,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzB4pB,EAAGnpB,EACHmpB,EAAGlpB,EACHiC,EACAC,EACAvD,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsE,KAAKa,SAASmQ,OAC/FtV,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,iBAEZ/F,KAAKsE,KAAKa,SAASmQ,OAAStV,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GACxErV,KAAKsE,KAAKa,SAAS8J,OAAS,EAC5BjP,KAAKsE,KAAK8B,SAAU,EAElBpG,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBACzEC,OAASC,EAAAA,GAAAA,SAERjW,KAAKsE,KAAKmmB,cACZzqB,KAAK0qB,sBAAsBhnB,IAI/B1D,KAAKsE,KAAKa,SAASmQ,MAAQ,EAgB3BtV,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2K,KAAKyJ,QAC1DjnB,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzB4pB,EAAGnpB,EACHmpB,EAAGlpB,EACHiC,EACAC,GACA,GACA,GACA,IAIAvD,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAKyB,iBAAmB/F,KAAKsE,KAAK6C,sBAC/DnH,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAAoBC,OAASC,EAAAA,GAAAA,UAC3GjW,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMqU,MAAMC,kBAAkBnnB,EAAK6mB,EAAGnpB,EAAGmpB,EAAGlpB,GAC7FrB,KAAK8qB,kBAAkBpnB,EAAKgc,GAC5B1f,KAAK+qB,SAASrnB,EAAK1D,KAAKsE,KAAK4kB,SAGjClpB,KAAKuK,GAAKvK,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GACtDrV,KAAKgrB,4BAA4BT,EACnC,CACQQ,SAASrnB,EAA+BwlB,GAC9C,GACGlpB,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAAoBC,OAASC,EAAAA,GAAAA,SAC1GjW,KAAKsE,KAAKsB,cACV5F,KAAKsE,KAAKyB,iBACV/F,KAAKsE,KAAK6C,oBAEV,IAAK,IAAIlG,EAAI,EAAGA,EAAIioB,EAAOhoB,SAAUD,EAAG,CACtC,MAAMiC,EAAIlD,KAAKsE,KAAKX,MAAMC,mBAAmBuS,eAAeC,eAAeC,sBAAsB6S,EAAOjoB,IACxGjB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKS,UAC1DvT,EACA1D,KAAKsE,KAAK6X,IAAI,GAAG9Y,eAAe1C,YAChCuC,EAAE9B,EACF8B,EAAE7B,EACFrB,KAAKsE,KAAKX,MAAMC,mBAAmBgL,oBAAoB+G,4BAEvD,EAEJ,CAEJ,CACQqV,4BAA4B9nB,GAClClD,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASqc,UAAUyJ,iBACpDjrB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAC5C1hB,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK6D,UACVjF,EAAE9B,EACF8B,EAAE7B,EAC0B,GAA5BiR,KAAKyS,IAAI/kB,KAAKsE,KAAKhB,OACU,GAA7BgP,KAAKyS,IAAI/kB,KAAKsE,KAAKf,QACnBvD,KAAKsE,KAAKgB,OAEd,CACQwlB,kBAAkBpnB,EAA+B1C,GACvD0C,EAAIwnB,YAAc,EAClBxnB,EAAImV,UAAY,EAChBnV,EAAI2c,YAAcrgB,KAAKsE,KAAKjB,eAAe1C,YAAY8Z,YACvD/W,EAAIO,YACJP,EAAI4c,OAAOtf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GAC1BqC,EAAI6c,OAAOvf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GAC1BqC,EAAI6c,OAAOvf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GAC1BqC,EAAI6c,OAAOvf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GAC1BqC,EAAIS,YACJT,EAAI8c,QACN,CACQkK,sBAAsBhnB,GACxB1D,KAAKsE,KAAK8F,UACRpK,KAAKsE,KAAKmmB,cACZzqB,KAAKsE,KAAKc,eAAe+lB,wBAE3BznB,EAAI2c,YAAcrgB,KAAKsE,KAAKjB,eAAe1C,YAAY8Z,YACvD/W,EAAIO,YACJP,EAAI4c,OAAOtgB,KAAKsE,KAAK0kB,mBAAmB5nB,EAAGpB,KAAKsE,KAAK0kB,mBAAmB3nB,GACxEqC,EAAI6c,OACFvgB,KAAKsE,KAAKob,KAAK,GAAGte,EAAkD,IAA7CpB,KAAKsE,KAAKob,KAAK,GAAGte,EAAIpB,KAAKsE,KAAKob,KAAK,GAAGte,GAC/DpB,KAAKsE,KAAKob,KAAK,GAAGre,EAAkD,IAA7CrB,KAAKsE,KAAKob,KAAK,GAAGre,EAAIrB,KAAKsE,KAAKob,KAAK,GAAGre,IAEjEqC,EAAIS,YACJT,EAAI8c,SAMJ9c,EAAIM,UAAYhE,KAAKsE,KAAKjB,eAAe1C,YAAY8Z,YACrD/W,EAAIO,YACJP,EAAIe,IAAIzE,KAAKsE,KAAK0kB,mBAAmB5nB,EAAGpB,KAAKsE,KAAK0kB,mBAAmB3nB,EAAG,EAAG,EAAa,EAAViR,KAAK8Y,IACnF1nB,EAAIS,YACJT,EAAIU,OAER,EClOK,MAAM8W,UAAuBM,EAElC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KAFNA,SAAG,EAGR1B,KAAKmO,cACLnO,KAAK0K,aACP,CACOyD,cACL,IAAKnO,KAAKob,SAAU,CAClBpb,KAAK+W,MAAMC,aAAeM,EAAa+T,aACvCrrB,KAAKob,UAAW,EAChBjD,EAAY8O,yBACVjnB,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElDyI,EAAY+O,6BACVlnB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElD,IAAK,IAAIzO,EAAI,EAAGA,EAAIjB,KAAK0B,IAAIya,IAAIjb,SAAUD,EACzCjB,KAAK0B,IAAIya,IAAIlb,GAAGoC,eAAeuY,mBAAmB5b,KAAKmb,gBAE3D,CACF,CACOzQ,cAAsD,IAA1C4gB,EAA2B,4DAAG3oB,EAC/C3C,KAAKob,UAAW,OACFzY,IAAV2oB,IACFA,EAAQtrB,KAAK0B,IAAIiC,MAAMC,mBAAmB4H,wBAAwB+f,sBAAsBC,aAE1FrT,EAAYsT,yBACVzrB,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD4b,EACA,CAAC,EAAE,EAAE,EAAE,IAETnT,EAAYuT,6BACV1rB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD4b,GAEF,IAAK,IAAIrqB,EAAI,EAAGA,EAAIjB,KAAK0B,IAAIya,IAAIjb,SAAUD,EACzCjB,KAAK0B,IAAIya,IAAIlb,GAAGoC,eAAeuY,mBAAmB5b,KAAKmb,iBAEzDnb,KAAKqb,cAAgBiQ,CACvB,CAEOjd,kBAAkBzC,GAavB,GAPIA,EAAMtI,QACRtD,KAAK+W,MAAMzT,MAAQsI,EAAMtI,YAEPX,IAAhBiJ,EAAM0f,QACRtrB,KAAK+W,MAAMC,aAAepL,EAAM0f,OAG9B1f,EAAM6N,UAAUvY,OAAS,GAAK0K,EAAMxH,KAAKlD,OAAS,EAAG,CACvDlB,KAAKqb,cAAgBzP,EAAM6N,UAC3BzZ,KAAKsb,aAAe1P,EAAMxH,KAC1B+T,EAAYwT,+BACV3rB,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD9D,EAAM6N,UACN7N,EAAMxH,MAER+T,EAAYyT,mCACV5rB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD9D,EAAM6N,UACN7N,EAAMxH,MAER,IAAK,IAAInD,EAAI,EAAGA,EAAIjB,KAAK0B,IAAIya,IAAIjb,SAAUD,EACzCjB,KAAK0B,IAAIya,IAAIlb,GAAGoC,eAAeuY,mBAAmB5b,KAAKmb,gBAE3D,CASA,OARIvP,EAAM/G,QACR7E,KAAKW,YAAYgO,WAAa/C,EAAM/G,MACpC7E,KAAK+W,MAAMlS,MAAQ+G,EAAM/G,OAE3B7E,KAAKob,UAAW,GAIT,CACT,CACOvN,QAAQ3K,GACblD,KAAKW,YAAYga,KAAOzX,EACxBlD,KAAK0B,IAAIiC,MAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAC3D9Q,KAAK0B,IAAI8H,SAEb,CAEOiK,SACL,IAAKzT,KAAKob,SACR,OAIF,MAAMyQ,EAAc,CAClBvoB,MAAOtD,KAAK+W,MAAMzT,MAClBuB,MAAO7E,KAAKW,YAAYgO,WAExB8K,UAAWzZ,KAAKqb,cAChBjX,KAAMpE,KAAKsb,cAKb,OAHItb,KAAK+W,MAAMC,eAAiBM,EAAa+T,eAC3CQ,EAAOP,MAAQtrB,KAAK+W,MAAMC,cAErB6U,CACT,CAEUtQ,YAAY3P,GACpB,GACEA,EAAM6N,UAAUvY,SAAWlB,KAAKqb,cAAcna,QAC9C0K,EAAMxH,KAAKlD,SAAWlB,KAAKsb,aAC3B,CACA,IAAK,IAAIra,EAAI,EAAGA,EAAI2K,EAAM6N,UAAUvY,OAAQD,IAC1C,GAAI2K,EAAM6N,UAAUxY,KAAOjB,KAAKqb,cAAcpa,GAC5C,OAAO,EAGX,IAAK,IAAIA,EAAI,EAAGA,EAAI2K,EAAMxH,KAAKlD,OAAQD,IACrC,GAAI2K,EAAMxH,KAAKnD,KAAOjB,KAAKsb,aAAara,GACtC,OAAO,CAGb,CACA,OAAO,CACT,ECrIK,MAAM6qB,EAEXjsB,YAAY6B,GAAqB,KAD1BA,SAAG,EAER1B,KAAK0B,IAAMA,CACb,CACOwR,0BAA0B5F,GAC1B,CAEAiG,UAAUnS,EAAWC,GACrB,CAEA+L,KAAKhM,EAAWC,GAChB,ECDF,MAAMyqB,UAAgCC,EAM3ClsB,YAAY6B,GACVwD,MAAMxD,GAAK,KANNA,SAAG,OACH4C,UAAI,OACJpB,OAAC,OACD8oB,SAAW,EAAI,KACfC,MAAQ,EAGbjsB,KAAK0B,IAAMA,EACX1B,KAAKsE,KAAO5C,CACd,CACOwR,0BAA0B5F,GAG/B,GAAItN,KAAKsE,KAAKif,aAAe,EAE3B,YADAvjB,KAAKksB,8BAA8B5e,EAAGtN,KAAKsE,KAAKif,aAIlD,GAAIvjB,KAAKsE,KAAKskB,SAEZ,YADA5oB,KAAKmsB,cAAc7e,EAAElM,EAAGkM,EAAEjM,GAG5B,GAAIrB,KAAKsE,KAAKqB,WAAa3F,KAAKsE,KAAKtC,cAAgBhC,KAAKsE,KAAK+B,cAC7D,OAEF,MAAMme,EAAKlX,EAAElM,EAAIkM,EAAE6F,KACbsR,EAAKnX,EAAEjM,EAAIiM,EAAE8F,KAEnB,IAAiC,IAA7BpT,KAAKsE,KAAK6kB,cAIZ,OAHAnpB,KAAKosB,4BAA4B9e,GACjCtN,KAAKsE,KAAK4Z,wBACVle,KAAKqsB,0BAGP,IAA+B,IAA3BrsB,KAAKsE,KAAKif,YAIZ,OAHAvjB,KAAKsE,KAAK6X,IAAInc,KAAKsE,KAAKif,aAAarQ,0BAA0B5F,GAC/DtN,KAAKsE,KAAK4Z,wBACVle,KAAKqsB,0BAIP,IAAK,IAAIprB,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK6X,IAAIjb,SAAUD,EAC1CjB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKojB,EAC1BxkB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKojB,EAG5BzkB,KAAKsE,KAAK4Z,mBAENle,KAAKsE,KAAKgG,iBAGPtK,KAAKsE,KAAKkE,qBACbxI,KAAKsE,KAAKsG,qBAAqB5K,KAAKsE,KAAKgG,eAAe1H,IAAK,GAI/D5C,KAAKqsB,0BACLrsB,KAAKsE,KAAKgG,eAAe4I,0BAA0B5F,GAEvD,CACOiG,UAAUnS,EAAWC,GAa1B,CAEK8oB,yBACLnqB,KAAKisB,MAKD,IAJD3Z,KAAKga,MACJtsB,KAAKsE,KAAK0kB,mBAAmB3nB,EAAIrB,KAAKsE,KAAK1B,IAAIvB,EAC/CrB,KAAKsE,KAAK0kB,mBAAmB5nB,EAAIpB,KAAKsE,KAAK1B,IAAIxB,GAGjDkR,KAAK8Y,EACT,CACQgB,4BAA4B9e,GAClC,GAAgC,IAA5BtN,KAAKsE,KAAK6kB,cAAqB,CACjC,MAAM9nB,EAAIiM,EAAEjM,EAAIrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,EACrCrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EAC1BrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EACtBrB,KAAKsE,KAAKf,OAAS,KACrBvD,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EAC1BrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EAI9B,MAAO,GAAgC,IAA5BrB,KAAKsE,KAAK6kB,cAAqB,CACxC,MAAM9nB,EAAIiM,EAAEjM,EAAIrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,EACrCrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EAC1BrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EACtBrB,KAAKsE,KAAKf,OAAS,KACrBvD,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EAC1BrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EAI9B,MAAO,GAAgC,IAA5BrB,KAAKsE,KAAK6kB,cAAqB,CACxC,MAAM/nB,EAAIpB,KAAKsE,KAAK8kB,sBAAwB9b,EAAElM,EAAIkM,EAAElM,EAAIpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,EAC7EpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EAC1BpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EACtBpB,KAAKsE,KAAKhB,MAAQ,KACpBtD,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EAC1BpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EAI9B,MAAO,GAAgC,IAA5BpB,KAAKsE,KAAK6kB,cAAqB,CACxC,MAAM/nB,EAAIpB,KAAKsE,KAAK8kB,sBAAwB9b,EAAElM,EAAIkM,EAAElM,EAAIpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,EAC7EpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EAC1BpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EACtBpB,KAAKsE,KAAKhB,MAAQ,KACpBtD,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EAC1BpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EAI9B,CACF,CACO8qB,8BAA8B5e,EAAmBrM,GACtD,IAAK,IAAIA,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK6X,IAAIjb,SAAUD,EAC1CjB,KAAKsE,KAAK6X,IAAIlb,GAAGe,cAAe,EAK9BhC,KAAKsE,KAAKgG,iBAAmBtK,KAAKsE,KAAKkE,qBACzCxI,KAAKsE,KAAKsG,qBAAqB5K,KAAKsE,KAAKgG,eAAe1H,IAAK,GAI/D,IAAI2pB,EAAOjf,EAAElM,EAAIkM,EAAE6F,KACfqZ,EAAOlf,EAAEjM,EAAIiM,EAAE8F,KAET,IAANnS,GAAiB,IAANA,EACTqR,KAAKyS,IAAIwH,GAAQja,KAAKyS,IAAIyH,GAC5BA,EAAOD,EAEPA,EAAOC,EAEM,IAANvrB,GAAiB,IAANA,IAChBqR,KAAKyS,IAAIwH,GAAQja,KAAKyS,IAAIyH,GAC5BA,GAAe,EAARD,EAEPA,GAAe,EAARC,GAIPxsB,KAAKsE,KAAK+lB,kBACZrqB,KAAKysB,uBAAuBxrB,EAAGsrB,EAAMC,GAE3B,IAANvrB,GACFjB,KAAK0sB,YAAY,EAAGH,EAAMC,GAC1BxsB,KAAK0sB,YAAY,EAAGH,EAAM,GAC1BvsB,KAAK0sB,YAAY,EAAG,EAAGF,IACnBxsB,KAAKsE,KAAKhB,MAAQ,IAAMtD,KAAKsE,KAAKf,OAAS,MAC7CvD,KAAK0sB,YAAY,GAAIH,GAAOC,GAC5BxsB,KAAK0sB,YAAY,GAAIH,EAAM,GAC3BvsB,KAAK0sB,YAAY,EAAG,GAAIF,KAEX,IAANvrB,GACTjB,KAAK0sB,YAAY,EAAGH,EAAMC,GAC1BxsB,KAAK0sB,YAAY,EAAGH,EAAM,GAC1BvsB,KAAK0sB,YAAY,EAAG,EAAGF,IACnBxsB,KAAKsE,KAAKhB,MAAQ,IAAMtD,KAAKsE,KAAKf,OAAS,MAC7CvD,KAAK0sB,YAAY,GAAIH,GAAOC,GAC5BxsB,KAAK0sB,YAAY,GAAIH,EAAM,GAC3BvsB,KAAK0sB,YAAY,EAAG,GAAIF,KAEX,IAANvrB,GACTjB,KAAK0sB,YAAY,EAAGH,EAAMC,GAC1BxsB,KAAK0sB,YAAY,EAAGH,EAAM,GAC1BvsB,KAAK0sB,YAAY,EAAG,EAAGF,IACnBxsB,KAAKsE,KAAKhB,MAAQ,IAAMtD,KAAKsE,KAAKf,OAAS,MAC7CvD,KAAK0sB,YAAY,GAAIH,GAAOC,GAC5BxsB,KAAK0sB,YAAY,GAAIH,EAAM,GAC3BvsB,KAAK0sB,YAAY,EAAG,GAAIF,KAEX,IAANvrB,IACTjB,KAAK0sB,YAAY,EAAGH,EAAMC,GAC1BxsB,KAAK0sB,YAAY,EAAGH,EAAM,GAC1BvsB,KAAK0sB,YAAY,EAAG,EAAGF,IACnBxsB,KAAKsE,KAAKhB,MAAQ,IAAMtD,KAAKsE,KAAKf,OAAS,MAC7CvD,KAAK0sB,YAAY,GAAIH,GAAOC,GAC5BxsB,KAAK0sB,YAAY,GAAIH,EAAM,GAC3BvsB,KAAK0sB,YAAY,EAAG,GAAIF,KAI9BxsB,KAAKsE,KAAK4Z,mBAIVle,KAAKsE,KAAKc,eAAeinB,yBAE3B,CACQK,YAAYzrB,GAAgC,IAArBG,EAAC,uDAAG,EAAGC,EAAC,uDAAG,EACxCrB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKA,EAC1BpB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKA,CAE5B,CACOgrB,0BACL,IAAIxqB,EAAS,EAEX7B,KAAKsE,KAAKkE,qBACVxI,KAAKsE,KAAKgG,gBACVtK,KAAKsE,KAAKgG,eAAe+I,aAEzBxR,EAAS7B,KAAKsE,KAAKgG,eAAe+I,WAAWC,GAAGlS,EAAIpB,KAAKsE,KAAKkE,oBAAoBpH,EAClFpB,KAAKsE,KAAKgG,eAAe+I,WAAWC,GAAGlS,EAAIpB,KAAKsE,KAAKkE,oBAAoBpH,EACzEpB,KAAKsE,KAAKgG,eAAeqiB,aAAe9qB,EAExCA,EAAS7B,KAAKsE,KAAKgG,eAAe+I,WAAWC,GAAGjS,EAAIrB,KAAKsE,KAAKkE,oBAAoBnH,EAClFrB,KAAKsE,KAAKgG,eAAe+I,WAAWC,GAAGjS,EAAIrB,KAAKsE,KAAKkE,oBAAoBnH,EACzErB,KAAKsE,KAAKgG,eAAesiB,cAAgB/qB,EAEzC7B,KAAKsE,KAAKgG,eAAe4T,mBAE7B,CACQiO,cAAc/qB,EAAWC,GAC/B,MAGMwrB,EAHgE,IAAvDva,KAAKga,MAAMjrB,EAAIrB,KAAKsE,KAAK1B,IAAIvB,EAAGD,EAAIpB,KAAKsE,KAAK1B,IAAIxB,GAAYkR,KAAK8Y,GAGpDprB,KAAKisB,MAEnC,IAAIvM,EAAO1f,KAAK8sB,eAAe,CAAC9sB,KAAKsE,KAAK0kB,oBAAqBhpB,KAAKsE,KAAK1B,IAAKiqB,GAC9E7sB,KAAKsE,KAAK0kB,mBAAmB5nB,EAAIse,EAAK,GAAGte,EACzCpB,KAAKsE,KAAK0kB,mBAAmB3nB,EAAIqe,EAAK,GAAGre,EACzCrB,KAAKsE,KAAK0kB,mBAAmB1nB,EAAIoe,EAAK,GAAGpe,EAEzCoe,EAAO1f,KAAK8sB,eAAe9sB,KAAKsE,KAAKob,KAAM1f,KAAKsE,KAAK1B,IAAKiqB,GAC1D7sB,KAAKsE,KAAKob,KAAK,GAAGte,EAAIse,EAAK,GAAGte,EAC9BpB,KAAKsE,KAAKob,KAAK,GAAGre,EAAIqe,EAAK,GAAGre,EAC9BrB,KAAKsE,KAAKob,KAAK,GAAGpe,EAAIoe,EAAK,GAAGpe,EAC9BtB,KAAKsE,KAAKob,KAAK,GAAGte,EAAIse,EAAK,GAAGte,EAC9BpB,KAAKsE,KAAKob,KAAK,GAAGre,EAAIqe,EAAK,GAAGre,EAC9BrB,KAAKsE,KAAKob,KAAK,GAAGpe,EAAIoe,EAAK,GAAGpe,EAC9BtB,KAAKsE,KAAKob,KAAK,GAAGte,EAAIse,EAAK,GAAGte,EAC9BpB,KAAKsE,KAAKob,KAAK,GAAGre,EAAIqe,EAAK,GAAGre,EAC9BrB,KAAKsE,KAAKob,KAAK,GAAGpe,EAAIoe,EAAK,GAAGpe,EAC9BtB,KAAKsE,KAAKob,KAAK,GAAGte,EAAIse,EAAK,GAAGte,EAC9BpB,KAAKsE,KAAKob,KAAK,GAAGre,EAAIqe,EAAK,GAAGre,EAC9BrB,KAAKsE,KAAKob,KAAK,GAAGpe,EAAIoe,EAAK,GAAGpe,EAE9BtB,KAAKisB,OAASY,CAEhB,CACQC,eAAepN,EAAkB6K,EAAc0B,GACrD,MAAMc,EAAa,IAAI1qB,EAAAA,IAAUkoB,EAAGnpB,GAAImpB,EAAGlpB,GAAIkpB,EAAGjpB,GAClD,IAAI8a,GAAmB4Q,EAAAA,EAAAA,IAAStN,EAAMqN,GAGtC,OAFA3Q,GAAO6Q,EAAAA,EAAAA,IAAW7Q,EAAM6P,GACxB7P,GAAO4Q,EAAAA,EAAAA,IAAS5Q,EAAMmO,GACfnO,CACT,CACO+O,wBACLnrB,KAAKsE,KAAK0kB,mBAAmB5nB,EAC3BpB,KAAKsE,KAAKob,KAAK,GAAGte,EAAkD,IAA7CpB,KAAKsE,KAAKob,KAAK,GAAGte,EAAIpB,KAAKsE,KAAKob,KAAK,GAAGte,GACjEpB,KAAKsE,KAAK0kB,mBAAmB3nB,EAC3BrB,KAAKsE,KAAKob,KAAK,GAAGre,EAAkD,IAA7CrB,KAAKsE,KAAKob,KAAK,GAAGre,EAAIrB,KAAKsE,KAAKob,KAAK,GAAGre,GAEjE,MAAM6rB,GAAKC,EAAAA,EAAAA,IAAantB,KAAKsE,KAAKob,KAAK,GAAI1f,KAAKsE,KAAKob,KAAK,IAEpD0N,EAAO,IAAI/qB,EAAAA,GACfrC,KAAKsE,KAAKob,KAAK,GAAGte,EAAIpB,KAAKsE,KAAKob,KAAK,GAAGte,EACxCpB,KAAKsE,KAAKob,KAAK,GAAGre,EAAIrB,KAAKsE,KAAKob,KAAK,GAAGre,EACxCrB,KAAKsE,KAAKob,KAAK,GAAGpe,EAAItB,KAAKsE,KAAKob,KAAK,GAAGpe,GAEpC+rB,GAAOF,EAAAA,EAAAA,IAAaD,EAAIE,GAC9BC,EAAKC,UAELttB,KAAKsE,KAAK0kB,mBAAmB5nB,GAAc,GAATisB,EAAKjsB,EACvCpB,KAAKsE,KAAK0kB,mBAAmB3nB,GAAc,GAATgsB,EAAKhsB,GAEnC6L,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK1B,IAAK5C,KAAKsE,KAAK0kB,oBAAyC,GAAnBhpB,KAAKsE,KAAKf,SACvEvD,KAAKsE,KAAK0kB,mBAAmB5nB,GAAe,IAATisB,EAAKjsB,EACxCpB,KAAKsE,KAAK0kB,mBAAmB3nB,GAAe,IAATgsB,EAAKhsB,EAK5C,CAmBOorB,uBAAuBxrB,EAAWsrB,EAAcC,GACrD,MAAMe,EAAQvtB,KAAKwtB,wBAEnB,GAAU,IAANvsB,EACF,GAAIqR,KAAKyS,IAAIwH,GAAQja,KAAKyS,IAAIyH,GAAO,CACnC,MAAMiB,GAAWC,EAAAA,EAAAA,IAAmBH,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKhB,GACnEvsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKmrB,EAC1BvsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKksB,EAAM,GAAKE,EAAS,GAC9CztB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,GAAKksB,EAAM,GAAKE,EAAS,GAClDztB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIxB,GAAKmrB,CAChC,KAAO,CACL,MAAMkB,GAAWE,EAAAA,EAAAA,IAAoBJ,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKf,GACpExsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKmsB,EAAM,GAAKE,EAAS,GAC9CztB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKmrB,EAC1BxsB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,GAAKmrB,EAC9BxsB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIxB,GAAKmsB,EAAM,GAAKE,EAAS,EACpD,MACK,GAAU,IAANxsB,EACT,GAAIqR,KAAKyS,IAAIwH,GAAQja,KAAKyS,IAAIyH,GAAO,CACnCxsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKmrB,EAC1B,MAAMkB,GAAWC,EAAAA,EAAAA,IAAmBH,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKhB,GACnEvsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKksB,EAAM,GAAKE,EAAS,GAC9CztB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIxB,GAAKmrB,EAC9BvsB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,GAAKksB,EAAM,GAAKE,EAAS,EACpD,KAAO,CACL,MAAMA,GAAWE,EAAAA,EAAAA,IAAoBJ,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKf,GACpExsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKmsB,EAAM,GAAKE,EAAS,GAC9CztB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKmrB,EAC1BxsB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIxB,GAAKmsB,EAAM,GAAKE,EAAS,GAClDztB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,GAAKmrB,CAChC,MACK,GAAU,IAANvrB,EACT,GAAIqR,KAAKyS,IAAIwH,GAAQja,KAAKyS,IAAIyH,GAAO,CACnC,MAAMiB,GAAWC,EAAAA,EAAAA,IAAmBH,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKhB,GACnEvsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKmrB,EAC1BvsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,EAAIrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,EAAIosB,EAAS,GAC3DztB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIxB,GAAKmrB,EAC9BvsB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,EAAIrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,EAAIosB,EAAS,EACjE,KAAO,CACL,MAAMA,GAAWE,EAAAA,EAAAA,IAAoBJ,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKf,GACpExsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,EAAIpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,EAAIqsB,EAAS,GAC3DztB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKmrB,EAC1BxsB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIxB,EAAIpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,EAAIqsB,EAAS,GAC/DztB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,GAAKmrB,CAChC,MACK,GAAU,IAANvrB,EACT,GAAIqR,KAAKyS,IAAIwH,GAAQja,KAAKyS,IAAIyH,GAAO,CACnC,MAAMiB,GAAWC,EAAAA,EAAAA,IAAmBH,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKhB,GACnEvsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKmrB,EAC1BvsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKksB,EAAM,GAAKE,EAAS,GAC9CztB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,GAAKksB,EAAM,GAAKE,EAAS,GAClDztB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKmrB,CAC5B,KAAO,CACL,MAAMkB,GAAWE,EAAAA,EAAAA,IAAoBJ,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKf,GACpExsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKmsB,EAAM,GAAKE,EAAS,GAC9CztB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKmrB,EAC1BxsB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,GAAKmrB,EAC9BxsB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKmsB,EAAM,GAAKE,EAAS,EAChD,CAEJ,CACQD,wBAGN,MAAO,CAFIxtB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,EAC9CpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,EAE3D,EC/WK,MAAMusB,UAAuB3oB,EAyBlC,6BAAoCtB,GAClC,MAAM4mB,EAAK,IAAIloB,EAAAA,GACkD,GAA/DsB,EAAMC,mBAAmBuS,eAAe2M,eAAexf,MACS,GAAhEK,EAAMC,mBAAmBuS,eAAe2M,eAAevf,QAEzDvD,KAAK6tB,cAAclqB,EAAO,CACxB,IAAItB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,KAChC,IAAIgB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,KAChC,IAAIgB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,KAChC,IAAIgB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,MAEpC,CACA,mBAA0BiM,GAE1B,CACA,mBAA0BA,GAEZsgB,EAAe3L,YAAY3U,EAOzC,CACA,qBAA4B3J,EAAc3C,GACxC,MAAMupB,GAAKuD,EAAAA,EAAAA,IAAkB9sB,GACvBU,EAAM,IAAIksB,EAAejqB,EAAO4mB,EAAG,GAAGnpB,EAAGmpB,EAAG,GAAGlpB,EAAG,GAAG,GACrD0sB,EAAKxD,EAAG,GAAGnpB,EAAImpB,EAAG,GAAGnpB,EACrB4sB,EAAKzD,EAAG,GAAGlpB,EAAIkpB,EAAG,GAAGlpB,EAC3BK,EAAIya,IAAI,GAAGvZ,IAAIxB,GAAK2sB,EACpBrsB,EAAIya,IAAI,GAAGvZ,IAAIxB,GAAK2sB,EACpBrsB,EAAIya,IAAI,GAAGvZ,IAAIvB,GAAK2sB,EACpBtsB,EAAIya,IAAI,GAAGvZ,IAAIvB,GAAK2sB,EAGpBtsB,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EAE1BzF,EAAIusB,UAAU,EAAGvsB,EAAIya,IAAI,GAAGvZ,IAAIxB,EAAI,EAAGM,EAAIya,IAAI,GAAGvZ,IAAIvB,EAAI,EAAG,GAC7DsC,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,SAC3E,CAWA,sBAA6B7F,EAAc2J,GACzC,MAAMid,EAAK,IAAIloB,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,EAAG,GAClCrB,KAAK6tB,cAAclqB,EAAO,CACxB,IAAItB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,KAChC,IAAIgB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,KAChC,IAAIgB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,KAChC,IAAIgB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,MAEpC,CACA,eAAsBsC,EAAc2J,GAClC,QAAoC3K,IAAhCirB,EAAevL,aAGjB,OAFAuL,EAAevL,aAAe,IAAIuL,EAAejqB,EAAO2J,EAAElM,EAAGkM,EAAEjM,QAC/DusB,EAAevL,aAAaD,cAAe,GAG7CwL,EAAevL,aAAalb,qBAAsB,EAClDymB,EAAevL,aAAaD,cAAe,EAK3CwL,EAAevL,aAAa4L,UAC1B,EACAL,EAAevL,aAAalG,IAAI,GAAGvZ,IAAIxB,EACvCwsB,EAAevL,aAAalG,IAAI,GAAGvZ,IAAIvB,EAAI,GAC3C,GAKFsC,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAClD8c,EAAevL,aAAa7Y,UAE9BokB,EAAevL,kBAAe1f,CAEhC,CACA,mBAA0B8G,GACnB,CAEP,kBAAyB9F,EAAc2J,GACrC,QAAoC3K,IAAhCirB,EAAevL,aAA4B,CAClC,IAAItG,EAAOpY,EAAO2J,EAAElM,EAAGkM,EAAEjM,EAAG,GACpC2E,cAAe,CACpB,MAEE4nB,EAAevL,aAAalG,IAAI,GAAG/O,KAAKE,EAAElM,EAAGwsB,EAAevL,aAAalG,IAAI,GAAGvZ,IAAIvB,GACpFusB,EAAevL,aAAalG,IAAI,GAAG/O,KAAKE,EAAElM,EAAGkM,EAAEjM,GAC/CusB,EAAevL,aAAalG,IAAI,GAAG/O,KAAKwgB,EAAevL,aAAalG,IAAI,GAAGvZ,IAAIxB,EAAGkM,EAAEjM,GACpFusB,EAAevL,aAAanE,kBAIhC,CAEA,gBAAuBva,EAAc0M,GAAoD,IAArCtJ,EAAM,wDAAUuV,EAAU,wDAC5E,MAAM7S,EAAIsS,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAM,GAAImG,GAC9CrF,EAAM,IAAIksB,EAAejqB,EAAO8F,EAAE7G,IAAIxB,EAAGqI,EAAE7G,IAAIvB,EAAG,EAAG0F,GAC3D0C,EAAEgH,SACF,IAAK,IAAIxP,EAAI,EAAGA,EAAIS,EAAIya,IAAIjb,SAAUD,EAAG,CACvC,MAAMiC,EAAI6Y,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAMK,GAAI8F,GACpDrF,EAAIya,IAAIlb,GAAG2B,IAAIxB,EAAI8B,EAAEN,IAAIxB,EACzBM,EAAIya,IAAIlb,GAAG2B,IAAIvB,EAAI6B,EAAEN,IAAIvB,EACzBK,EAAIya,IAAIlb,GAAGV,KAAO6L,EAAAA,GAAAA,aAClBlJ,EAAEuN,QACJ,CAiCA,OA/BA/O,EAAInB,KAAO6L,EAAAA,GAAMiE,EAAE9P,MAEnBmB,EAAI2E,cAAgBgK,EAAE3P,SAClB2P,EAAE3P,SACJgB,EAAI2I,WAAa,EAEjB3I,EAAI2I,WAAa,EAGfgG,EAAExP,QAAUwP,EAAExP,OAAO8Z,OACvBjZ,EAAI2B,eAAe1C,YAAYga,KAAOtK,EAAExP,OAAO8Z,MAI/CjZ,EAAIpB,GADFgc,EACO3Y,EAAMsF,UAENoH,EAAE/P,GAEboB,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EAC1BzF,EAAI0I,SAAU,EACViG,EAAExP,QACJa,EAAI2M,kBAAkBgC,EAAExP,QAG1Ba,EAAIoO,kBACJpO,EAAIwc,mBACCnX,GACHpD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,UAGpE9H,CACT,CACA,qBACsCiB,IAAhCirB,EAAevL,cACjBuL,EAAevL,aAAa5R,SAE9Bmd,EAAevL,kBAAe1f,CAChC,CAIA,iBAAwBgB,EAAc2J,GAGpC,CAQF,wBAA+B3J,EAAc2J,GAA+C,IAA5BhK,EAAK,uDAAG,IAAKC,EAAM,uDAAG,IAChFqqB,EAAevL,cACjBuL,EAAevL,aAAa5R,SAE9B,MAAM8F,EAAQ,IAAIqX,EAAejqB,EAAO2J,EAAElM,EAAY,GAARkC,EAAagK,EAAEjM,EAAa,GAATkC,GACjEgT,EAAM4F,IAAI,GAAGvZ,IAAIxB,GAAKkC,EACtBiT,EAAM4F,IAAI,GAAGvZ,IAAIxB,GAAKkC,EACtBiT,EAAM4F,IAAI,GAAGvZ,IAAIvB,GAAKkC,EACtBgT,EAAM4F,IAAI,GAAGvZ,IAAIvB,GAAKkC,EAEtBgT,EAAM2H,mBACN3H,EAAM6L,cAAe,EACrB7L,EAAMpP,qBAAsB,EAC5BoP,EAAMnM,SAAU,EAChBmM,EAAM1F,eACNlN,EAAMC,mBAAmB4H,wBAAwBgX,YAmBnD,CACA,0BAAiClV,GAC1B,CAEP,yBAAgCA,GACzB,CAEP,0BAAiCA,GAC1B,CAGP,mBAA0B3J,EAAc2J,QACF3K,IAAhCirB,EAAevL,cACjBuL,EAAe1K,WAAWvf,EAAO2J,EAErC,CACA,mBAA0B3J,EAAc2J,QACF3K,IAAhCirB,EAAevL,aACjBuL,EAAe1K,WAAWvf,EAAO2J,IAEjC3J,EAAMC,mBAAmBuS,eAAe+X,cAAcC,qBACtDP,EAAeQ,QAAQzqB,EAAO2J,GAElC,CACA,iBAAwB3J,EAAc2J,GAChCsgB,EAAevL,eACjBuL,EAAeS,KAAKT,EAAevL,cACnC1e,EAAMC,mBAAmB4H,wBAAwBgX,aACjDoL,EAAevL,aAAaD,cAAe,EAC3CwL,EAAevL,aAAalb,qBAAsB,EAClDymB,EAAevL,aAAajY,SAAU,GAGpC8C,EAAAA,EAAAA,IACE0gB,EAAevL,aAAalG,IAAI,GAAGvZ,IACnCgrB,EAAevL,aAAalG,IAAI,GAAGvZ,KACjC,IAGJgrB,EAAevL,aAAalG,IAAI,GAAGvZ,IAAIxB,IAAM,GAC7CwsB,EAAevL,aAAalG,IAAI,GAAGvZ,IAAIvB,IAAM,GAC7CusB,EAAevL,aAAalG,IAAI,GAAGvZ,IAAIxB,GAAK,GAC5CwsB,EAAevL,aAAalG,IAAI,GAAGvZ,IAAIvB,IAAM,GAC7CusB,EAAevL,aAAalG,IAAI,GAAGvZ,IAAIxB,GAAK,GAC5CwsB,EAAevL,aAAalG,IAAI,GAAGvZ,IAAIvB,GAAK,GAC5CusB,EAAevL,aAAalG,IAAI,GAAGvZ,IAAIxB,IAAM,GAC7CwsB,EAAevL,aAAalG,IAAI,GAAGvZ,IAAIvB,GAAK,IAG9CusB,EAAevL,aAAatc,iBAAkB,EAC9C6nB,EAAevL,aAAa7hB,YAAa,EACzCotB,EAAevL,aAAanE,mBAC5B0P,EAAevL,aAAaxR,eAC5B+c,EAAevL,kBAAe1f,EAC9BirB,EAAe3K,QAAS,EAG5B,CACA,YAAmB1M,GACjB,IAAInV,EACFC,EACAC,EAAI,EACFiV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EAAImV,EAAM4F,IAAI,GAAGvZ,IAAIxB,IACxCA,EAAImV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EACrBC,EAAIkV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EACrBC,EAAIiV,EAAM4F,IAAI,GAAGvZ,IAAItB,EACrBiV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EAAImV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EACtCmV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EAAIkV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EACtCkV,EAAM4F,IAAI,GAAGvZ,IAAItB,EAAIiV,EAAM4F,IAAI,GAAGvZ,IAAItB,EACtCiV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EAAIA,EACrBmV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EAAIA,EACrBkV,EAAM4F,IAAI,GAAGvZ,IAAItB,EAAIA,EACrBF,EAAImV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EACrBC,EAAIkV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EACrBC,EAAIiV,EAAM4F,IAAI,GAAGvZ,IAAItB,EACrBiV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EAAImV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EACtCmV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EAAIkV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EACtCkV,EAAM4F,IAAI,GAAGvZ,IAAItB,EAAIiV,EAAM4F,IAAI,GAAGvZ,IAAItB,EACtCiV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EAAIA,EACrBmV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EAAIA,EACrBkV,EAAM4F,IAAI,GAAGvZ,IAAItB,EAAIA,GAEnBiV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EAAIkV,EAAM4F,IAAI,GAAGvZ,IAAIvB,IACxCD,EAAImV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EACrBC,EAAIkV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EACrBC,EAAIiV,EAAM4F,IAAI,GAAGvZ,IAAItB,EACrBiV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EAAImV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EACtCmV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EAAIkV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EACtCkV,EAAM4F,IAAI,GAAGvZ,IAAItB,EAAIiV,EAAM4F,IAAI,GAAGvZ,IAAItB,EACtCiV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EAAIA,EACrBmV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EAAIA,EACrBkV,EAAM4F,IAAI,GAAGvZ,IAAItB,EAAIA,EACrBF,EAAImV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EACrBC,EAAIkV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EACrBC,EAAIiV,EAAM4F,IAAI,GAAGvZ,IAAItB,EACrBiV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EAAImV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EACtCmV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EAAIkV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EACtCkV,EAAM4F,IAAI,GAAGvZ,IAAItB,EAAIiV,EAAM4F,IAAI,GAAGvZ,IAAItB,EACtCiV,EAAM4F,IAAI,GAAGvZ,IAAIxB,EAAIA,EACrBmV,EAAM4F,IAAI,GAAGvZ,IAAIvB,EAAIA,EACrBkV,EAAM4F,IAAI,GAAGvZ,IAAItB,EAAIA,EAEzB,CACAzB,YAAY8D,EAAcvC,EAAWC,GAAkD,IAAhC0F,EAAM,wDAAU8R,EAAS,uDAAG,EACjF3T,MAAMvB,GAAO,KAxUR0B,iBAAW,OACXD,oBAAc,OAEd+W,SAAG,OACH+M,OAAqB,GAAG,KACxBrQ,eAAS,OACTvT,YAAM,OACN0jB,mBAA+B,IAAI3mB,EAAAA,GAAS,EAAG,EAAG,GAAG,KACrDqd,UAAI,OACJkJ,UAAW,EAAM,KACjByB,uBAAiB,OACjBjB,uBAAwB,EAAM,KAI9B7F,aAAe,EAAE,KACjB4F,eAAiB,EAAE,KACnBvJ,eAAS,OACT6K,cAAe,EAuTpBzqB,KAAKO,KAAO6L,EAAAA,GAAAA,OACZpM,KAAKmc,IAAM,GACXnc,KAAKmc,IAAIhb,KAAK,IAAI4a,EAAOpY,EAAOvC,EAAGC,EAAG,EAAG0F,IACzC/G,KAAKmc,IAAIhb,KAAK,IAAI4a,EAAOpY,EAAOvC,EAAGC,EAAG,EAAG0F,IACzC/G,KAAKmc,IAAIhb,KAAK,IAAI4a,EAAOpY,EAAOvC,EAAGC,EAAG,EAAG0F,IACzC/G,KAAKmc,IAAIhb,KAAK,IAAI4a,EAAOpY,EAAOvC,EAAGC,EAAG,EAAG0F,IACzC,IAAK,IAAI9F,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACjC8F,IACF/G,KAAKmc,IAAIlb,GAAG2E,cAAe,GAE7B5F,KAAKmc,IAAIlb,GAAGV,KAAO6L,EAAAA,GAAAA,aAErBpM,KAAK6Y,UAAYA,EACjB7Y,KAAK4c,gBACL5c,KAAKsuB,aACLtuB,KAAKuuB,gBAGLvuB,KAAKqqB,mBAAoB,EACzBrqB,KAAKwuB,WAKP,CACQ5R,gBACN5c,KAAKqD,eAAiB,IAAI6X,EAAelb,MACzCA,KAAKmF,SAAW,IAAIqQ,EAAkBxV,MACtCA,KAAKqF,YAAc,IAAIsjB,EAAqB3oB,MAC5CA,KAAKoF,eAAiB,IAAI0mB,EAAwB9rB,KACpD,CACQwuB,YACNxuB,KAAK4f,UAAY,IAAIiI,EAAU7nB,MAE/BA,KAAKsF,QAAS,EACdtF,KAAK2D,MAAM8qB,kBAAkBzuB,KAC/B,CACOke,mBACL,MAAMtb,GAAMyjB,EAAAA,EAAAA,IAAqB,CAC/BrmB,KAAKmc,IAAI,GAAGvZ,IACZ5C,KAAKmc,IAAI,GAAGvZ,IACZ5C,KAAKmc,IAAI,GAAGvZ,IACZ5C,KAAKmc,IAAI,GAAGvZ,MAKd,OAFA5C,KAAK4C,IAAIxB,EAAIwB,EAAIxB,EACjBpB,KAAK4C,IAAIvB,EAAIuB,EAAIvB,EACVrB,KAAK4C,GACd,CACO2rB,gBACL,MAAM7I,EAAK1lB,KAAKmc,IAAI,GAAGvZ,IACjB+iB,EAAK3lB,KAAKmc,IAAI,GAAGvZ,IACvB,IAAIxB,EAAI,EACJC,EAAI,EACJC,EAAI,EAENF,EADEskB,EAAGtkB,EAAIukB,EAAGvkB,EACRskB,EAAGtkB,EAEHukB,EAAGvkB,EAGPC,EADEqkB,EAAGrkB,EAAIskB,EAAGtkB,EACRqkB,EAAGrkB,EAEHskB,EAAGtkB,EAGPC,EADEokB,EAAGpkB,EAAIqkB,EAAGrkB,EACRokB,EAAGpkB,EAEHqkB,EAAGrkB,EAET,MAAMotB,EAAM,IAAIrsB,EAAAA,GAASjB,EAAGC,EAAGC,GAE7BF,EADEskB,EAAGtkB,EAAIukB,EAAGvkB,EACRskB,EAAGtkB,EAEHukB,EAAGvkB,EAGPC,EADEqkB,EAAGrkB,EAAIskB,EAAGtkB,EACRqkB,EAAGrkB,EAEHskB,EAAGtkB,EAGPC,EADEokB,EAAGpkB,EAAIqkB,EAAGrkB,EACRokB,EAAGpkB,EAEHqkB,EAAGrkB,EAET,MAAMqtB,EAAM,IAAItsB,EAAAA,GAASjB,EAAGC,EAAGC,GAC/BtB,KAAKiuB,UAAU,EAAGU,EAAIvtB,EAAGstB,EAAIrtB,EAAGqtB,EAAIptB,GACpCtB,KAAKiuB,UAAU,EAAGS,EAAIttB,EAAGutB,EAAIttB,EAAGqtB,EAAIptB,GACpC,IAAK,IAAIL,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGuR,QAAQxS,MACpBA,KAAKmc,IAAIlb,GAAGV,KAAO6L,EAAAA,GAAAA,aAErBpM,KAAKkqB,cACP,CACO0E,gBACL,MAAM5tB,EAAK,GACX,IAAK,IAAIC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EAAG,CACxC,MAAMwI,EAAIzJ,KAAKmc,IAAIlb,GACnBD,EAAGG,KAAK,IAAIkB,EAAAA,GAASoH,EAAE7G,IAAIxB,EAAIpB,KAAK4C,IAAIxB,EAAGqI,EAAE7G,IAAIvB,EAAIrB,KAAK4C,IAAIvB,EAAGoI,EAAE7G,IAAItB,EAAItB,KAAK4C,IAAItB,GACtF,CACF,CACO2sB,UAAUhtB,EAAWG,EAAWC,EAAWC,GAChDtB,KAAKmc,IAAIlb,GAAG2B,IAAIxB,EAAIA,EACpBpB,KAAKmc,IAAIlb,GAAG2B,IAAIvB,EAAIA,EACpBrB,KAAKmc,IAAIlb,GAAG2B,IAAItB,EAAIA,CACtB,CACO8J,eACL,OAAOpL,KAAKmc,IAAInc,KAAKmc,IAAIjb,OAAS,EACpC,CACOmI,UACL,OAAQrJ,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,IAAMpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EACxF,CACOyR,SACL,OAAO9S,KAAKqF,YAAYyN,QAC1B,CACWzI,eAAWnH,GACpBlD,KAAKkH,gBAAkBhE,EACvB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGiG,gBAAkBhE,CAElC,CACW2rB,qBAAiB3rB,GAC1BlD,KAAKsG,YAActG,KAAKqG,cACxBrG,KAAKqG,cAAgBnD,EACrB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGoF,cAAgBnD,CAEhC,CACWxC,aAASwC,GAClBlD,KAAKsG,YAActG,KAAKqG,cACxBrG,KAAKqG,cAAgBnD,EACrBlD,KAAK6uB,iBAAmB3rB,EAExBlD,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBC,UAAUjK,KAAKwJ,SAC1E,CACO4D,KAAKhM,EAAWC,GACrB,GAAIrB,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,cAC9C,OAEF,MAAMme,EAAKpjB,EAAIpB,KAAK4C,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAC3DqjB,EAAKpjB,EAAIrB,KAAK4C,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GACjE,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAG2B,IAAIxB,GAAKojB,EACrBxkB,KAAKmc,IAAIlb,GAAG2B,IAAIvB,GAAKojB,EAGvBzkB,KAAKke,kBACP,CACOhO,gBACLlQ,KAAKgG,cAAe,EACpBhG,KAAKuH,eAAgB,EACrBvH,KAAKmc,IAAI6J,SAASvc,IAChBA,EAAEyG,eAAe,GAErB,CACOgD,0BAA0B5F,GAC/B,OAAOtN,KAAKoF,eAAe8N,0BAA0B5F,EACvD,CACOiG,UAAUnS,EAAWC,GAC1B,OAAOrB,KAAKoF,eAAemO,UAAUnS,EAAGC,EAC1C,CACOorB,uBAAuBxrB,EAAWsrB,EAAcC,GACrD,OAAOxsB,KAAKoF,eAAeqnB,uBAAuBxrB,EAAGsrB,EAAMC,EAC7D,CACO3Z,cAAczR,EAAWC,GAC9B,OAAOrB,KAAKqF,YAAYwN,cAAczR,EAAGC,EAC3C,CACOytB,qBAAqBrlB,EAAe8iB,EAAcC,GACvD,IAAIuC,GAAS,EACb,IAAK,IAAI9tB,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACjCwI,IAAMzJ,KAAKmc,IAAIlb,KACjB8tB,EAAQ9tB,GAGE,IAAV8tB,GACF/uB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GAAKmrB,EACrBxsB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAAKmrB,GACF,IAAVwC,GACT/uB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GAAKmrB,EACrBxsB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAAKmrB,GACF,IAAVwC,GACT/uB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GAAKmrB,EACrBxsB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAAKmrB,GACF,IAAVwC,IACT/uB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GAAKmrB,EACrBxsB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAAKmrB,GAGvBvsB,KAAKke,kBAEP,CACQoQ,aACNtuB,KAAKkpB,OAAO/nB,KACV,IAAIkB,EAAAA,GACFrC,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GACzDpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GACzD,IAGJrB,KAAKkpB,OAAO/nB,KACV,IAAIkB,EAAAA,GACFrC,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GACzDpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GACzD,IAGJrB,KAAKkpB,OAAO/nB,KACV,IAAIkB,EAAAA,GACFrC,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GACzDpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GACzD,IAGJrB,KAAKkpB,OAAO/nB,KACV,IAAIkB,EAAAA,GACFrC,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GACzDpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GACzD,GAGN,CACO6oB,eACLlqB,KAAKkpB,OAAO,GAAG9nB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAC5EpB,KAAKkpB,OAAO,GAAG7nB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GAE5ErB,KAAKkpB,OAAO,GAAG9nB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAC5EpB,KAAKkpB,OAAO,GAAG7nB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GAE5ErB,KAAKkpB,OAAO,GAAG9nB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAC5EpB,KAAKkpB,OAAO,GAAG7nB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GAE5ErB,KAAKkpB,OAAO,GAAG9nB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAC5EpB,KAAKkpB,OAAO,GAAG7nB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAC9E,CACOsL,UACL3M,KAAK0f,KAAO,GACZ,IAAK,IAAIze,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAK0f,KAAKve,KAAKnB,KAAKmc,IAAIlb,GAAG2B,KAG7B,OAAO5C,KAAK0f,IACd,CACOjP,SAA+B,IAAxB5J,IAAQ,yDACpB,IAAK,IAAI5F,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGwP,SAEd,GAAI5J,EAAU,CACZ,MAAMuX,EAAQpe,KAAKwJ,SACf4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB,CAACvG,GAElF,CACApe,KAAK+d,YACP,CACOA,aACL/d,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EACpBhC,KAAK4M,mBACL5M,KAAK2D,MAAMqrB,cAAchvB,MACzBA,KAAK2D,MAAM8a,eAAeze,KAC5B,CACOoS,gBACL,MAAO,cAAgBpS,KAAKM,EAC9B,CACO2S,OACL,MAAM,IAAIgc,MAAM,0BAClB,CACW7M,iBAAalf,GACtBlD,KAAKgG,aAAe9C,EACpB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAG+E,aAAe9C,CAE/B,CACWkf,mBACT,OAAOpiB,KAAKgG,YACd,CACWkpB,iBAAaC,GACtBnvB,KAAKgC,aAAemtB,EACpB,IAAK,IAAIluB,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGe,aAAemtB,CAE/B,CAEW3uB,iBACT,OAAOR,KAAK+F,eACd,CACWvF,eAAW0C,GACpBlD,KAAK+F,gBAAkB7C,EACvB,IAAK,MAAMuG,KAAKzJ,KAAKmc,IACnB1S,EAAEzH,aAAekB,EACjBuG,EAAEzD,aAAe9C,EACjBuG,EAAE1D,gBAAkB7C,EAGtBlD,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2c,eAAe3mB,KAAKwJ,SAG/E,CACWY,cACT,OAAOpK,KAAK4F,YACd,CACWwE,YAAQlH,GACjB,IAAIlD,KAAKmH,oBAAT,CAWA,GARAnH,KAAK4F,aAAe1C,GAEhBlD,KAAK4F,eAAiB5F,KAAK6F,aAEnB7F,KAAK4F,cAAgB5F,KAAK6F,aADpC7F,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB4c,WAAW5mB,KAAKwJ,UAI3ExJ,KAAK6F,WAAa7F,KAAK4F,cAClB5F,KAAK+F,gBACR,IAAK,MAAM0D,KAAKzJ,KAAKmc,IACnB1S,EAAEzH,aAAekB,EACjBuG,EAAEzD,aAAe9C,EAGhBA,IACHlD,KAAK8G,mBAAoB,EACzB9G,KAAK4M,mBAjBP,CAmBF,CACOxD,UACL,MAAMlG,EAAgB,GACtB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCiC,EAAE/B,KAAKnB,KAAKmc,IAAIlb,GAAG2B,KAErB,OAAOM,CACT,CACOsG,SACL,MAAMC,EAAI,IAAIpJ,EACZL,KAAKM,GACLN,KAAKO,KACLP,KAAK+F,gBACL/F,KAAK4F,aACL5F,KAAKqG,eAEPoD,EAAE1I,SAASf,KAAKoJ,WAEhB,MAAMvI,EAASb,KAAKqD,eAAeoQ,SAKnC,OAJI5S,IACF4I,EAAE5I,OAASA,GAGN4I,CACT,CACOsG,SAAS3O,EAAWC,GACzB,MAAMgP,EAAIrQ,KAAKwJ,SAETkd,EAAKkH,EAAexd,SAASpQ,KAAK2D,MAAO0M,GAAG,GAAM,GAGxD,OAFAqW,EAAGtZ,KAAKhM,EAAGC,GACXqlB,EAAG7V,eACI6V,CACT,CACWpjB,YACT,OAAOtD,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,CAC7C,CACWmC,aACT,OAAOvD,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,CAC7C,CACO6kB,sBACLlmB,KAAK0f,KAAO,GACZ,IAAK,IAAIze,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAK0f,KAAKve,KAAKnB,KAAKmc,IAAIlb,GAAG2B,IAE/B,CACOyI,cACL,OAAOrL,KAAK2M,SACd,CACOsZ,aACLjmB,KAAKke,mBACLle,KAAKkmB,sBACLlmB,KAAKkqB,cACP,CACOvZ,kBACL3Q,KAAKsF,QAAUtF,KAAKsF,OACpBtF,KAAKqqB,mBAAqBrqB,KAAKqqB,iBACjC,CACO/e,qBACLtL,KAAKqF,YAAYkkB,yBACnB,CACO/Z,WAAW9L,GAChB1D,KAAKmF,SAASqK,WAAW9L,EAC3B,CACOyJ,oBACL,OAAOnN,KAAKwI,mBACd,CAEOsB,sBAAsB5G,GAC3B,OAAOlD,KAAKqF,YAAYyE,sBAAsB5G,EAChD,CACOksB,8BACL,OAAOpvB,KAAKqF,YAAY0kB,6BAC1B,CACOnf,qBAAqB1H,EAAa2H,GACvC,OAAO7K,KAAKqF,YAAYuF,qBAAqB1H,EAAG2H,EAClD,EA9tBW+iB,EACG3K,QAAS,EADZ2K,EAEG5G,OAAQ,EAFX4G,EAGGvL,kBAAY,EAHfuL,EAIGvD,mBAAoB,ECd7B,MAAM1B,EAGX9oB,YAAY6B,GAAqB,KAF1BA,SAAG,OACH4C,UAAI,EAETtE,KAAK0B,IAAMA,EACX1B,KAAKsE,KAAO5C,CACd,CACOmR,cAAczR,EAAWC,GAC9B,MAAMolB,EAAK,IAAIpkB,EAAAA,GAASjB,EAAGC,GAC3B,QAAIrB,KAAKsE,KAAKqB,WAAa3F,KAAKsE,KAAKtC,cAAgBhC,KAAKsE,KAAK+B,kBAGzB,IAAlCrG,KAAKsE,KAAK6C,0BAAkExE,IAAlC3C,KAAKsE,KAAK6C,uBAGpDnH,KAAK0B,IAAIqB,aAGb/C,KAAKsE,KAAKskB,UAAW,GACjB1b,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK0kB,mBAAoBvC,GAAM,IAClDzmB,KAAKsE,KAAKskB,UAAW,EACrB5oB,KAAKsE,KAAK8F,SAAU,GACb,KAELpK,KAAK6oB,gBAAgBpC,OAGrBzmB,KAAK+oB,gBAAgBtC,KAGrBzmB,KAAKmkB,cAAc/iB,EAAGC,IACxBrB,KAAKsE,KAAK8F,SAAU,GACb,IAETpK,KAAKsE,KAAK8F,SAAU,GACb,OACT,CACO0I,SAyBL,MAtBE,UACA9S,KAAKsE,KAAKhE,GADV,WAIAN,KAAKsE,KAAK/D,KAAKwS,WAJf,qBAYA/S,KAAKsE,KAAK+E,UAAU4a,QAAQ,GAAGlR,WAZ/B,eAkBA/S,KAAKsE,KAAKyB,gBAlBV,gBAqBA/F,KAAKsE,KAAK0B,YAEd,CACOiN,OACL,CAEM4V,gBAAgBpL,GACtB,IAAK,IAAIxc,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK6X,IAAIjb,SAAUD,EAC1C,IAAIiM,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAK6a,GAAK,GAEzC,OADAzd,KAAKsE,KAAKif,YAActiB,GACjB,EAqBX,OADAjB,KAAKsE,KAAKif,aAAe,GAClB,CACT,CACQwF,gBAAgBtL,GACtB,IAAK,IAAIxc,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK4kB,OAAOhoB,SAAUD,EAC7C,IAAIiM,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK4kB,OAAOjoB,GAAIwc,GAAK,GAGxC,OAFAzd,KAAKsE,KAAK6kB,cAAgBloB,EAC1BjB,KAAKsE,KAAK8kB,uBAAwB,GAC3B,EAsBX,OADAppB,KAAKsE,KAAK6kB,eAAiB,GACpB,CACT,CACQhF,cAAc/iB,EAAWC,GAC/B,MAAMguB,EAAQ,IAAIhtB,EAAAA,GAASjB,EAAGC,GAGxB+iB,EAAMpkB,KAAKsE,KAAK6X,IAAIjb,OAC1B,IAAK,IAAID,EAAI,EAAGA,EAAImjB,IAAOnjB,EACzB,GAAIA,EAAImjB,EAAM,GACZ,IACEC,EAAAA,EAAAA,IAAyBgL,EAAOrvB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAK5C,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,KAC3E5C,KAAKsE,KAAKuU,UAEV,OAAO,OAGT,IACEwL,EAAAA,EAAAA,IAAyBgL,EAAOrvB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAK5C,KAAKsE,KAAK6X,IAAI,GAAGvZ,KACvE5C,KAAKsE,KAAKuU,UAEV,OAAO,EAQb,SAAI7Y,KAAKsE,KAAKgB,UACRqE,EAAAA,EAAAA,IAAe0lB,EAAOrvB,KAAKsE,KAAKob,MAKxC,CACO6J,0BACDvpB,KAAKsE,KAAK6kB,eAAiB,EAC7BnpB,KAAKwpB,sBAELxpB,KAAKypB,kBAET,CACQA,mBACN,GAAIzpB,KAAKsE,KAAKX,MAAM+Z,UAAW,CACf1d,KAAKsE,KAAK6X,IAAI1J,QAAQzS,KAAKsE,KAAKX,MAAM+Z,WACxC,IAAM,EAChB1d,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBke,kBAAkBC,gBAC3EC,EAAAA,GAAAA,YAGF5pB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBke,kBAAkBC,gBAC3EC,EAAAA,GAAAA,WAGN,MACE5pB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBke,kBAAkBG,qBAEjF,CACQL,uBAC2B,IAA7BxpB,KAAKsE,KAAK6kB,eACZnpB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBke,kBAAkBG,sBAE3E7pB,KAAKsE,KAAK6kB,cAAgB,IAAM,EAClCnpB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBke,kBAAkBC,gBAC3EC,EAAAA,GAAAA,UAGF5pB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBke,kBAAkBC,gBAC3EC,EAAAA,GAAAA,SAGN,CAEO9f,sBAAsB5G,GAC3BlD,KAAKsE,KAAKkE,yBAAsB7F,EAEhC,IAAK,IAAI1B,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK6X,IAAIjb,OAAQD,GAAK,EAAG,CAEhD,IADYiM,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAKM,GAG5ClD,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAawb,kBAGxE,OADA9pB,KAAKsE,KAAKkE,oBAAsBxI,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAC1C5C,KAAKsE,KAAKkE,mBAErB,CAEA,IADY0E,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK1B,IAAKM,GAGrClD,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAawb,kBAGxE,OADA9pB,KAAKsE,KAAKkE,oBAAsBxI,KAAKsE,KAAK1B,IACnC5C,KAAKsE,KAAKkE,mBAGrB,CACOuhB,8BAEL,IAAK/pB,KAAKsE,KAAKgG,iBAAmBtK,KAAKsE,KAAKgG,eAAe+I,WACzD,OAAO,EAET,IAAI2W,GAAgB,EAepB,IAAK,IAAI/oB,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK6X,IAAIjb,SAAUD,GACtCiM,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAK5C,KAAKsE,KAAKgG,eAAe+I,WAAWC,IAAM,IAC9E0W,GAAgB,IAKhB9c,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK1B,IAAK5C,KAAKsE,KAAKgG,eAAe+I,WAAWC,IAAM,IACvE0W,GAAgB,GAIlB,IAAK,IAAI/oB,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK4kB,OAAOhoB,SAAUD,GACzCiM,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK4kB,OAAOjoB,GAAIjB,KAAKsE,KAAKgG,eAAe+I,WAAWC,IAAM,IAC7E0W,GAAgB,GAGpB,QAAIA,IAGJhqB,KAAKsE,KAAKgG,eAAe2f,mBAAgBtnB,EACzC3C,KAAKsE,KAAKgG,oBAAiB3H,GACpB,EACT,CACOiI,qBAAqB1H,EAAa2H,GAEvC,GADA7K,KAAKsE,KAAK4Z,oBACNhR,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK1B,IAAKM,GAAK,EAClClD,KAAKsE,KAAKkE,oBAAsBxI,KAAKsE,KAAK1B,SAG5C,IAAK,IAAI3B,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK6X,IAAIjb,SAAUD,EAC1C,IAAIiM,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAKM,GAAK,EAEzC,YADAlD,KAAKsE,KAAKkE,oBAAsBxI,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAIvD,ECtRK,MAAM4S,UAA0BE,EAIrC7V,YAAYyE,GACVY,MAAMZ,GAAM,KAJPA,UAAI,OACJ3D,iBAAW,OACXwa,qBAAe,EAGpBnb,KAAKsE,KAAOA,CACd,CACOkL,WAAW9L,GAChB1D,KAAKmU,iBAAiB3Q,SACtBxD,KAAKyV,MAAMjS,SACXxD,KAAKyV,MAAMF,qBAGXvV,KAAKsE,KAAKc,eAAe+kB,yBAIrBnqB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAayY,WAC1E/mB,KAAKsE,KAAK2hB,aAKVjmB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAaqR,UACxE3f,KAAKsE,KAAK+lB,mBACVrqB,KAAKsE,KAAKsB,eAEVlC,EAAI8b,UAAY,SAChB9b,EAAIM,UAAY,UACZ,IAAMsO,KAAKyS,IAAI/kB,KAAKsE,KAAKhB,QAC3BI,EAAIkB,SAAS,uBAAwB5E,KAAKsE,KAAK1B,IAAIxB,EAAGpB,KAAKsE,KAAK1B,IAAIvB,IAKpErB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAaqR,WACtE3f,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAK6C,uBACtCnH,KAAKsE,KAAKsb,UAAUwI,iBAAiB1kB,EAAK1D,KAAKsE,KAAKob,MAChD1f,KAAKsE,KAAK+lB,kBACZrqB,KAAKsE,KAAKsb,UAAUyI,oBAAoB3kB,EAAK1D,KAAKsE,KAAKob,KAAM,0BAE7D1f,KAAKsE,KAAKsb,UAAUyI,oBAAoB3kB,EAAK1D,KAAKsE,KAAKob,OA4B7D1f,KAAKigB,mBACHvc,EACA1D,KAAKsE,KAAKX,MAAMC,mBAAmBuS,eAAeC,eAAekU,uBAAuBtqB,KAAKsE,KAAKqI,WAStG,CACQsT,mBAAmBvc,EAA+Bgc,GAKxD,MAAM6K,EAAKvqB,KAAKsE,KAAKX,MAAMC,mBAAmBuS,eAAeC,eAAeC,sBAAsBrW,KAAKsE,KAAK1B,KAKxG5C,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAKyB,iBACtC/F,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2K,KAAKoO,eAC1D5rB,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzB+e,EACA1f,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAC1D3W,KAAKsE,KAAKa,SAASmQ,OAErBtV,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,iBAEZ/F,KAAKsE,KAAKa,SAASmQ,OAAStV,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GACxErV,KAAKsE,KAAKa,SAAS8J,OAAS,EAC5BjP,KAAKsE,KAAK8B,SAAU,EAElBpG,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBACzEC,OAASC,EAAAA,GAAAA,SAERjW,KAAKsE,KAAKmmB,cACZzqB,KAAK0qB,sBAAsBhnB,IAI/B1D,KAAKsE,KAAKa,SAASmQ,MAAQ,EAgB7BtV,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2K,KAAKqO,UAC1D7rB,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzB+e,EACA1f,KAAKsE,KAAK1B,KACV,GACA,GACA,IAGE5C,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAKyB,iBAAmB/F,KAAKsE,KAAK6C,sBAEjEnH,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAAoBC,OAASC,EAAAA,GAAAA,UACzGjW,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMqU,MAAMC,kBAAkBnnB,EAAK6mB,EAAGnpB,EAAGmpB,EAAGlpB,GAC7FrB,KAAK+qB,SAASrnB,EAAKgc,IAGvB1f,KAAKuK,GAAKvK,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GACtDrV,KAAKgrB,4BAA4BtL,EACnC,CACQqL,SAASrnB,EAA+Bgc,GAC9C1f,KAAKsE,KAAK4lB,eACV,IAAI9oB,EAAI,EACNC,EAAI,EACN,IAAK,IAAIJ,EAAI,EAAGA,EAAIye,EAAKxe,SAAUD,EAC7BA,IAAMye,EAAKxe,OAAS,GACtBE,EAAIse,EAAKze,GAAGG,EAA8B,IAAzBse,EAAK,GAAGte,EAAIse,EAAKze,GAAGG,GACrCC,EAAIqe,EAAKze,GAAGI,EAA8B,IAAzBqe,EAAK,GAAGre,EAAIqe,EAAKze,GAAGI,KAErCD,EAAIse,EAAKze,GAAGG,EAAkC,IAA7Bse,EAAKze,EAAI,GAAGG,EAAIse,EAAKze,GAAGG,GACzCC,EAAIqe,EAAKze,GAAGI,EAAkC,IAA7Bqe,EAAKze,EAAI,GAAGI,EAAIqe,EAAKze,GAAGI,IAE3CrB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKS,UAC1DvT,EACA1D,KAAKsE,KAAK6X,IAAI,GAAG9Y,eAAe1C,YAChCS,EACAC,EAEArB,KAAKsE,KAAKX,MAAMC,mBAAmBgL,oBAAoB+G,4BACvD,EAGN,CACQqV,4BAA4BtL,GAClC1f,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASqc,UAAUgO,mBACpDxvB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAC5C1hB,KAAKsE,KAAK6D,UACVuX,EAEJ,CACQgL,sBAAsBhnB,GACxB1D,KAAKsE,KAAK8F,UACRpK,KAAKsE,KAAKmmB,cACZzqB,KAAKsE,KAAKc,eAAe+lB,wBAE3BznB,EAAI2c,YAAcrgB,KAAKsE,KAAKjB,eAAe1C,YAAY8Z,YACvD/W,EAAIO,YACJP,EAAI4c,OAAOtgB,KAAKsE,KAAK0kB,mBAAmB5nB,EAAGpB,KAAKsE,KAAK0kB,mBAAmB3nB,GACxEqC,EAAI6c,OACFvgB,KAAKsE,KAAKob,KAAK,GAAGte,EAAkD,IAA7CpB,KAAKsE,KAAKob,KAAK,GAAGte,EAAIpB,KAAKsE,KAAKob,KAAK,GAAGte,GAC/DpB,KAAKsE,KAAKob,KAAK,GAAGre,EAAkD,IAA7CrB,KAAKsE,KAAKob,KAAK,GAAGre,EAAIrB,KAAKsE,KAAKob,KAAK,GAAGre,IAEjEqC,EAAIS,YACJT,EAAI8c,SAMJ9c,EAAIM,UAAYhE,KAAKsE,KAAKjB,eAAe1C,YAAY8Z,YACrD/W,EAAIO,YACJP,EAAIe,IAAIzE,KAAKsE,KAAK0kB,mBAAmB5nB,EAAGpB,KAAKsE,KAAK0kB,mBAAmB3nB,EAAG,EAAG,EAAa,EAAViR,KAAK8Y,IACnF1nB,EAAIS,YACJT,EAAIU,OAER,EChNK,MAAM8W,UAAuBM,EAElC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KAFNA,SAAG,EAGR1B,KAAKmO,cACLnO,KAAK0K,aACP,CACOyD,cACL,IAAKnO,KAAKob,SAAU,CAClBpb,KAAK+W,MAAMC,aAAeM,EAAa+T,aACvCrrB,KAAKob,UAAW,EAChBjD,EAAY8O,yBACVjnB,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElDyI,EAAY+O,6BACVlnB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElD,IAAK,IAAIzO,EAAI,EAAGA,EAAIjB,KAAK0B,IAAIya,IAAIjb,SAAUD,EACzCjB,KAAK0B,IAAIya,IAAIlb,GAAGoC,eAAeuY,mBAAmB5b,KAAKmb,gBAE3D,CACF,CACOzQ,cAAsD,IAA1C4gB,EAA2B,4DAAG3oB,EAC/C3C,KAAKob,UAAW,OACFzY,IAAV2oB,IACFA,EAAQtrB,KAAK0B,IAAIiC,MAAMC,mBAAmB4H,wBAAwB+f,sBAAsBC,aAE1FrT,EAAYsT,yBACVzrB,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD4b,EACA,CAAC,EAAE,EAAE,EAAE,IAETnT,EAAYuT,6BACV1rB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD4b,GAEF,IAAK,IAAIrqB,EAAI,EAAGA,EAAIjB,KAAK0B,IAAIya,IAAIjb,SAAUD,EACzCjB,KAAK0B,IAAIya,IAAIlb,GAAGoC,eAAeuY,mBAAmB5b,KAAKmb,iBAEzDnb,KAAKqb,cAAgBiQ,CACvB,CAEOjd,kBAAkBzC,GAavB,GAPIA,EAAMtI,QACRtD,KAAK+W,MAAMzT,MAAQsI,EAAMtI,YAEPX,IAAhBiJ,EAAM0f,QACRtrB,KAAK+W,MAAMC,aAAepL,EAAM0f,OAG9B1f,EAAM6N,UAAUvY,OAAS,GAAK0K,EAAMxH,KAAKlD,OAAS,EAAG,CACvDlB,KAAKqb,cAAgBzP,EAAM6N,UAC3BzZ,KAAKsb,aAAe1P,EAAMxH,KAC1B+T,EAAYwT,+BACV3rB,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD9D,EAAM6N,UACN7N,EAAMxH,MAER+T,EAAYyT,mCACV5rB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD9D,EAAM6N,UACN7N,EAAMxH,MAER,IAAK,IAAInD,EAAI,EAAGA,EAAIjB,KAAK0B,IAAIya,IAAIjb,SAAUD,EACzCjB,KAAK0B,IAAIya,IAAIlb,GAAGoC,eAAeuY,mBAAmB5b,KAAKmb,gBAE3D,CASA,OARIvP,EAAM/G,QACR7E,KAAKW,YAAYgO,WAAa/C,EAAM/G,MACpC7E,KAAK+W,MAAMlS,MAAQ+G,EAAM/G,OAE3B7E,KAAKob,UAAW,GAIT,CACT,CACOvN,QAAQ3K,GACblD,KAAKW,YAAYga,KAAOzX,EACxBlD,KAAK0B,IAAIiC,MAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAC3D9Q,KAAK0B,IAAI8H,SAEb,CAEOiK,SACL,IAAKzT,KAAKob,SACR,OAGF,MAAMyQ,EAAc,CAClBvoB,MAAOtD,KAAK+W,MAAMzT,MAClBuB,MAAO7E,KAAKW,YAAYgO,WAExB8K,UAAWzZ,KAAKqb,cAChBjX,KAAMpE,KAAKsb,cAKb,OAHItb,KAAK+W,MAAMC,eAAiBM,EAAa+T,eAC3CQ,EAAOP,MAAQtrB,KAAK+W,MAAMC,cAErB6U,CACT,CAEUtQ,YAAY3P,GACpB,GACEA,EAAM6N,UAAUvY,SAAWlB,KAAKqb,cAAcna,QAC9C0K,EAAMxH,KAAKlD,SAAWlB,KAAKsb,aAC3B,CACA,IAAK,IAAIra,EAAI,EAAGA,EAAI2K,EAAM6N,UAAUvY,OAAQD,IAC1C,GAAI2K,EAAM6N,UAAUxY,KAAOjB,KAAKqb,cAAcpa,GAC5C,OAAO,EAGX,IAAK,IAAIA,EAAI,EAAGA,EAAI2K,EAAMxH,KAAKlD,OAAQD,IACrC,GAAI2K,EAAMxH,KAAKnD,KAAOjB,KAAKsb,aAAara,GACtC,OAAO,CAGb,CACA,OAAO,CACT,ECzHK,MAAM6qB,UAAgCC,EAM3ClsB,YAAY6B,GACVwD,MAAMxD,GAAK,KANNA,SAAG,OACH4C,UAAI,OACJpB,OAAC,OACD8oB,SAAW,EAAI,KACfC,MAAQ,EAGbjsB,KAAK0B,IAAMA,EACX1B,KAAKsE,KAAO5C,CACd,CACOwR,0BAA0B5F,GAG/B,GAAItN,KAAKsE,KAAKif,aAAe,EAE3B,YADAvjB,KAAKksB,8BAA8B5e,EAAGtN,KAAKsE,KAAKif,aAIlD,GAAIvjB,KAAKsE,KAAKskB,SAEZ,YADA5oB,KAAKmsB,cAAc7e,EAAElM,EAAGkM,EAAEjM,GAG5B,MAAMmjB,EAAKlX,EAAElM,EAAIkM,EAAE6F,KACbsR,EAAKnX,EAAEjM,EAAIiM,EAAE8F,KAEnB,IAAiC,IAA7BpT,KAAKsE,KAAK6kB,cAIZ,OAHAnpB,KAAKosB,4BAA4B9e,GACjCtN,KAAKsE,KAAK4Z,wBACVle,KAAKqsB,0BAGP,IAA+B,IAA3BrsB,KAAKsE,KAAKif,YAIZ,OAHAvjB,KAAKsE,KAAK6X,IAAInc,KAAKsE,KAAKif,aAAarQ,0BAA0B5F,GAC/DtN,KAAKsE,KAAK4Z,wBACVle,KAAKqsB,0BAIP,IAAK,IAAIprB,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK6X,IAAIjb,SAAUD,EAC1CjB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKojB,EAC1BxkB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKojB,EAE5BzkB,KAAKsE,KAAK4Z,mBAENle,KAAKsE,KAAKgG,iBAGPtK,KAAKsE,KAAKkE,qBACbxI,KAAKsE,KAAKsG,qBAAqB5K,KAAKsE,KAAKgG,eAAe1H,IAAK,GAI/D5C,KAAKqsB,0BACLrsB,KAAKsE,KAAKgG,eAAe4I,0BAA0B5F,GAEvD,CACO4e,8BAA8B5e,EAAmBrM,GACtD,IAAK,IAAIA,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK6X,IAAIjb,SAAUD,EAC1CjB,KAAKsE,KAAK6X,IAAIlb,GAAGe,cAAe,EAK9BhC,KAAKsE,KAAKgG,iBAAmBtK,KAAKsE,KAAKkE,qBACzCxI,KAAKsE,KAAKsG,qBAAqB5K,KAAKsE,KAAKgG,eAAe1H,IAAK,GAI/D,IAAI2pB,EAAOjf,EAAElM,EAAIkM,EAAE6F,KACfqZ,EAAOlf,EAAEjM,EAAIiM,EAAE8F,KAET,IAANnS,GAAiB,IAANA,EACTqR,KAAKyS,IAAIwH,GAAQja,KAAKyS,IAAIyH,GAC5BA,EAAOD,EAEPA,EAAOC,EAEM,IAANvrB,GAAiB,IAANA,IAChBqR,KAAKyS,IAAIwH,GAAQja,KAAKyS,IAAIyH,GAC5BA,GAAe,EAARD,EAEPA,GAAe,EAARC,GAIPxsB,KAAKsE,KAAK+lB,kBACZrqB,KAAKysB,uBAAuBxrB,EAAGsrB,EAAMC,GAE3B,IAANvrB,GACFjB,KAAK0sB,YAAY,EAAGH,EAAMC,GAC1BxsB,KAAK0sB,YAAY,EAAGH,EAAM,GAC1BvsB,KAAK0sB,YAAY,EAAG,EAAGF,IACnBxsB,KAAKsE,KAAKhB,MAAQ,IAAMtD,KAAKsE,KAAKf,OAAS,MAC7CvD,KAAK0sB,YAAY,GAAIH,GAAOC,GAC5BxsB,KAAK0sB,YAAY,GAAIH,EAAM,GAC3BvsB,KAAK0sB,YAAY,EAAG,GAAIF,KAEX,IAANvrB,GACTjB,KAAK0sB,YAAY,EAAGH,EAAMC,GAC1BxsB,KAAK0sB,YAAY,EAAGH,EAAM,GAC1BvsB,KAAK0sB,YAAY,EAAG,EAAGF,IACnBxsB,KAAKsE,KAAKhB,MAAQ,IAAMtD,KAAKsE,KAAKf,OAAS,MAC7CvD,KAAK0sB,YAAY,GAAIH,GAAOC,GAC5BxsB,KAAK0sB,YAAY,GAAIH,EAAM,GAC3BvsB,KAAK0sB,YAAY,EAAG,GAAIF,KAEX,IAANvrB,GACTjB,KAAK0sB,YAAY,EAAGH,EAAMC,GAC1BxsB,KAAK0sB,YAAY,EAAGH,EAAM,GAC1BvsB,KAAK0sB,YAAY,EAAG,EAAGF,IACnBxsB,KAAKsE,KAAKhB,MAAQ,IAAMtD,KAAKsE,KAAKf,OAAS,MAC7CvD,KAAK0sB,YAAY,GAAIH,GAAOC,GAC5BxsB,KAAK0sB,YAAY,GAAIH,EAAM,GAC3BvsB,KAAK0sB,YAAY,EAAG,GAAIF,KAEX,IAANvrB,IACTjB,KAAK0sB,YAAY,EAAGH,EAAMC,GAC1BxsB,KAAK0sB,YAAY,EAAGH,EAAM,GAC1BvsB,KAAK0sB,YAAY,EAAG,EAAGF,IACnBxsB,KAAKsE,KAAKhB,MAAQ,IAAMtD,KAAKsE,KAAKf,OAAS,MAC7CvD,KAAK0sB,YAAY,GAAIH,GAAOC,GAC5BxsB,KAAK0sB,YAAY,GAAIH,EAAM,GAC3BvsB,KAAK0sB,YAAY,EAAG,GAAIF,KAI9BxsB,KAAKsE,KAAK4Z,mBAEVle,KAAKsE,KAAKc,eAAeinB,yBAE3B,CACO9Y,UAAUnS,EAAWC,GAa1B,CAEK8oB,yBACLnqB,KAAKisB,MAKD,IAJD3Z,KAAKga,MACJtsB,KAAKsE,KAAK0kB,mBAAmB3nB,EAAIrB,KAAKsE,KAAK1B,IAAIvB,EAC/CrB,KAAKsE,KAAK0kB,mBAAmB5nB,EAAIpB,KAAKsE,KAAK1B,IAAIxB,GAGjDkR,KAAK8Y,EACT,CACQsB,YAAYzrB,GAAgC,IAArBG,EAAC,uDAAG,EAAGC,EAAC,uDAAG,EACxCrB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKA,EAC1BpB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKA,CAE5B,CACQ+qB,4BAA4B9e,GAClC,GAAgC,IAA5BtN,KAAKsE,KAAK6kB,cAAqB,CACjC,MAAM9nB,EAAIiM,EAAEjM,EAAIrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,EACrCrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EAC1BrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EACtBrB,KAAKsE,KAAKf,OAAS,KACrBvD,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EAC1BrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EAE9B,MAAO,GAAgC,IAA5BrB,KAAKsE,KAAK6kB,cAAqB,CACxC,MAAM9nB,EAAIiM,EAAEjM,EAAIrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,EACrCrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EAC1BrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EACtBrB,KAAKsE,KAAKf,OAAS,KACrBvD,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EAC1BrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,GAAKA,EAE9B,MAAO,GAAgC,IAA5BrB,KAAKsE,KAAK6kB,cAAqB,CACxC,MAAM/nB,EAAIpB,KAAKsE,KAAK8kB,sBAAwB9b,EAAElM,EAAIkM,EAAElM,EAAIpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,EAC7EpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EAC1BpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EACtBpB,KAAKsE,KAAKhB,MAAQ,KACpBtD,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EAC1BpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EAE9B,MAAO,GAAgC,IAA5BpB,KAAKsE,KAAK6kB,cAAqB,CACxC,MAAM/nB,EAAIpB,KAAKsE,KAAK8kB,sBAAwB9b,EAAElM,EAAIkM,EAAElM,EAAIpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,EAC7EpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EAC1BpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EACtBpB,KAAKsE,KAAKhB,MAAQ,KACpBtD,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EAC1BpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKA,EAE9B,CACF,CACQ+qB,cAAc/qB,EAAWC,GAC/B,MAGMwrB,EAHgE,IAAvDva,KAAKga,MAAMjrB,EAAIrB,KAAKsE,KAAK1B,IAAIvB,EAAGD,EAAIpB,KAAKsE,KAAK1B,IAAIxB,GAAYkR,KAAK8Y,GAGpDprB,KAAKisB,MAEnC,IAAIvM,EAAO1f,KAAK8sB,eAAe,CAAC9sB,KAAKsE,KAAK0kB,oBAAqBhpB,KAAKsE,KAAK1B,IAAKiqB,GAC9E7sB,KAAKsE,KAAK0kB,mBAAmB5nB,EAAIse,EAAK,GAAGte,EACzCpB,KAAKsE,KAAK0kB,mBAAmB3nB,EAAIqe,EAAK,GAAGre,EACzCrB,KAAKsE,KAAK0kB,mBAAmB1nB,EAAIoe,EAAK,GAAGpe,EAEzCoe,EAAO1f,KAAK8sB,eAAe9sB,KAAKsE,KAAKob,KAAM1f,KAAKsE,KAAK1B,IAAKiqB,GAC1D7sB,KAAKsE,KAAKob,KAAK,GAAGte,EAAIse,EAAK,GAAGte,EAC9BpB,KAAKsE,KAAKob,KAAK,GAAGre,EAAIqe,EAAK,GAAGre,EAC9BrB,KAAKsE,KAAKob,KAAK,GAAGpe,EAAIoe,EAAK,GAAGpe,EAC9BtB,KAAKsE,KAAKob,KAAK,GAAGte,EAAIse,EAAK,GAAGte,EAC9BpB,KAAKsE,KAAKob,KAAK,GAAGre,EAAIqe,EAAK,GAAGre,EAC9BrB,KAAKsE,KAAKob,KAAK,GAAGpe,EAAIoe,EAAK,GAAGpe,EAC9BtB,KAAKsE,KAAKob,KAAK,GAAGte,EAAIse,EAAK,GAAGte,EAC9BpB,KAAKsE,KAAKob,KAAK,GAAGre,EAAIqe,EAAK,GAAGre,EAC9BrB,KAAKsE,KAAKob,KAAK,GAAGpe,EAAIoe,EAAK,GAAGpe,EAC9BtB,KAAKsE,KAAKob,KAAK,GAAGte,EAAIse,EAAK,GAAGte,EAC9BpB,KAAKsE,KAAKob,KAAK,GAAGre,EAAIqe,EAAK,GAAGre,EAC9BrB,KAAKsE,KAAKob,KAAK,GAAGpe,EAAIoe,EAAK,GAAGpe,EAE9BtB,KAAKisB,OAASY,CAChB,CACQC,eAAepN,EAAkB6K,EAAc0B,GACrD,MAAMc,EAAa,IAAI1qB,EAAAA,IAAUkoB,EAAGnpB,GAAImpB,EAAGlpB,GAAIkpB,EAAGjpB,GAClD,IAAI8a,GAAmB4Q,EAAAA,EAAAA,IAAStN,EAAMqN,GAGtC,OAFA3Q,GAAO6Q,EAAAA,EAAAA,IAAW7Q,EAAM6P,GACxB7P,GAAO4Q,EAAAA,EAAAA,IAAS5Q,EAAMmO,GACfnO,CACT,CACOiQ,0BACL,IAAIxqB,EAAS,EAEX7B,KAAKsE,KAAKkE,qBACVxI,KAAKsE,KAAKgG,gBACVtK,KAAKsE,KAAKgG,eAAe+I,aAEzBxR,EAAS7B,KAAKsE,KAAKgG,eAAe+I,WAAWC,GAAGlS,EAAIpB,KAAKsE,KAAKkE,oBAAoBpH,EAClFpB,KAAKsE,KAAKgG,eAAe+I,WAAWC,GAAGlS,EAAIpB,KAAKsE,KAAKkE,oBAAoBpH,EACzEpB,KAAKsE,KAAKgG,eAAeqiB,aAAe9qB,EAExCA,EAAS7B,KAAKsE,KAAKgG,eAAe+I,WAAWC,GAAGjS,EAAIrB,KAAKsE,KAAKkE,oBAAoBnH,EAClFrB,KAAKsE,KAAKgG,eAAe+I,WAAWC,GAAGjS,EAAIrB,KAAKsE,KAAKkE,oBAAoBnH,EACzErB,KAAKsE,KAAKgG,eAAesiB,cAAgB/qB,EAEzC7B,KAAKsE,KAAKgG,eAAe4T,mBAE7B,CACOiN,wBACLnrB,KAAKsE,KAAK0kB,mBAAmB5nB,EAC3BpB,KAAKsE,KAAKob,KAAK,GAAGte,EAAkD,IAA7CpB,KAAKsE,KAAKob,KAAK,GAAGte,EAAIpB,KAAKsE,KAAKob,KAAK,GAAGte,GACjEpB,KAAKsE,KAAK0kB,mBAAmB3nB,EAC3BrB,KAAKsE,KAAKob,KAAK,GAAGre,EAAkD,IAA7CrB,KAAKsE,KAAKob,KAAK,GAAGre,EAAIrB,KAAKsE,KAAKob,KAAK,GAAGre,GAEjE,MAAM6rB,GAAKC,EAAAA,EAAAA,IAAantB,KAAKsE,KAAKob,KAAK,GAAI1f,KAAKsE,KAAKob,KAAK,IAEpD0N,EAAO,IAAI/qB,EAAAA,GACfrC,KAAKsE,KAAKob,KAAK,GAAGte,EAAIpB,KAAKsE,KAAKob,KAAK,GAAGte,EACxCpB,KAAKsE,KAAKob,KAAK,GAAGre,EAAIrB,KAAKsE,KAAKob,KAAK,GAAGre,EACxCrB,KAAKsE,KAAKob,KAAK,GAAGpe,EAAItB,KAAKsE,KAAKob,KAAK,GAAGpe,GAEpC+rB,GAAOF,EAAAA,EAAAA,IAAaD,EAAIE,GAC9BC,EAAKC,UAELttB,KAAKsE,KAAK0kB,mBAAmB5nB,GAAc,GAATisB,EAAKjsB,EACvCpB,KAAKsE,KAAK0kB,mBAAmB3nB,GAAc,GAATgsB,EAAKhsB,GAEnC6L,EAAAA,EAAAA,IAAYlN,KAAKsE,KAAK1B,IAAK5C,KAAKsE,KAAK0kB,oBAAyC,GAAnBhpB,KAAKsE,KAAKf,SACvEvD,KAAKsE,KAAK0kB,mBAAmB5nB,GAAe,IAATisB,EAAKjsB,EACxCpB,KAAKsE,KAAK0kB,mBAAmB3nB,GAAe,IAATgsB,EAAKhsB,EAK5C,CACOorB,uBAAuBxrB,EAAWsrB,EAAcC,GACrD,MAAMe,EAAQvtB,KAAKwtB,wBAEnB,GAAU,IAANvsB,EACF,GAAIqR,KAAKyS,IAAIwH,GAAQja,KAAKyS,IAAIyH,GAAO,CACnC,MAAMiB,GAAWC,EAAAA,EAAAA,IAAmBH,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKhB,GACnEvsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKmrB,EAC1BvsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKksB,EAAM,GAAKE,EAAS,GAC9CztB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,GAAKksB,EAAM,GAAKE,EAAS,GAClDztB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIxB,GAAKmrB,CAChC,KAAO,CACL,MAAMkB,GAAWE,EAAAA,EAAAA,IAAoBJ,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKf,GACpExsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKmsB,EAAM,GAAKE,EAAS,GAC9CztB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKmrB,EAC1BxsB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,GAAKmrB,EAC9BxsB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIxB,GAAKmsB,EAAM,GAAKE,EAAS,EACpD,MACK,GAAU,IAANxsB,EACT,GAAIqR,KAAKyS,IAAIwH,GAAQja,KAAKyS,IAAIyH,GAAO,CACnCxsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKmrB,EAC1B,MAAMkB,GAAWC,EAAAA,EAAAA,IAAmBH,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKhB,GACnEvsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKksB,EAAM,GAAKE,EAAS,GAC9CztB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIxB,GAAKmrB,EAC9BvsB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,GAAKksB,EAAM,GAAKE,EAAS,EACpD,KAAO,CACL,MAAMA,GAAWE,EAAAA,EAAAA,IAAoBJ,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKf,GACpExsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKmsB,EAAM,GAAKE,EAAS,GAC9CztB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKmrB,EAC1BxsB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIxB,GAAKmsB,EAAM,GAAKE,EAAS,GAClDztB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,GAAKmrB,CAChC,MACK,GAAU,IAANvrB,EACT,GAAIqR,KAAKyS,IAAIwH,GAAQja,KAAKyS,IAAIyH,GAAO,CACnC,MAAMiB,GAAWC,EAAAA,EAAAA,IAAmBH,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKhB,GACnEvsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKmrB,EAC1BvsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,EAAIrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,EAAIosB,EAAS,GAC3DztB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIxB,GAAKmrB,EAC9BvsB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,EAAIrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,EAAIosB,EAAS,EACjE,KAAO,CACL,MAAMA,GAAWE,EAAAA,EAAAA,IAAoBJ,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKf,GACpExsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,EAAIpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,EAAIqsB,EAAS,GAC3DztB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKmrB,EAC1BxsB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIxB,EAAIpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,EAAIqsB,EAAS,GAC/DztB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,GAAKmrB,CAChC,MACK,GAAU,IAANvrB,EACT,GAAIqR,KAAKyS,IAAIwH,GAAQja,KAAKyS,IAAIyH,GAAO,CACnC,MAAMiB,GAAWC,EAAAA,EAAAA,IAAmBH,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKhB,GACnEvsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKmrB,EAC1BvsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKksB,EAAM,GAAKE,EAAS,GAC9CztB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,GAAKksB,EAAM,GAAKE,EAAS,GAClDztB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKmrB,CAC5B,KAAO,CACL,MAAMkB,GAAWE,EAAAA,EAAAA,IAAoBJ,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAKf,GACpExsB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKmsB,EAAM,GAAKE,EAAS,GAC9CztB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKmrB,EAC1BxsB,KAAKsE,KAAK6X,IAAIlb,EAAI,GAAG2B,IAAIvB,GAAKmrB,EAC9BxsB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,GAAKmsB,EAAM,GAAKE,EAAS,EAChD,CAEJ,CACQD,wBAGN,MAAO,CAFIxtB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIxB,EAC9CpB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKsE,KAAK6X,IAAI,GAAGvZ,IAAIvB,EAE3D,EC7UK,MAAMouB,UAA0BxqB,EAyBrC,6BAAoCtB,GAClC,MAAM4mB,EAAK,IAAIloB,EAAAA,GACkD,GAA/DsB,EAAMC,mBAAmBuS,eAAe2M,eAAexf,MACS,GAAhEK,EAAMC,mBAAmBuS,eAAe2M,eAAevf,QAEzDvD,KAAK6tB,cAAclqB,EAAO,CACxB,IAAItB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,KAChC,IAAIgB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,KAChC,IAAIgB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,KAChC,IAAIgB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,MAEpC,CACA,mBAA0BiM,GAE1B,CACA,oBAA2BA,GAEbmiB,EAAkBxN,YAAY3U,EAO5C,CACA,qBAA4B3J,EAAc3C,GACxC,MAAMupB,GAAKuD,EAAAA,EAAAA,IAAkB9sB,GACvBU,EAAM,IAAI+tB,EAAkB9rB,EAAO4mB,EAAG,GAAGnpB,EAAGmpB,EAAG,GAAGlpB,EAAG,GAAG,GACxD0sB,EAAKxD,EAAG,GAAGnpB,EAAImpB,EAAG,GAAGnpB,EACrB4sB,EAAKzD,EAAG,GAAGlpB,EAAIkpB,EAAG,GAAGlpB,EAC3BK,EAAIya,IAAI,GAAGvZ,IAAIxB,GAAK2sB,EACpBrsB,EAAIya,IAAI,GAAGvZ,IAAIxB,GAAK2sB,EACpBrsB,EAAIya,IAAI,GAAGvZ,IAAIvB,GAAK2sB,EACpBtsB,EAAIya,IAAI,GAAGvZ,IAAIvB,GAAK2sB,EAEpBtsB,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EAE1BzF,EAAIusB,UAAU,EAAGvsB,EAAIya,IAAI,GAAGvZ,IAAIxB,EAAI,EAAGM,EAAIya,IAAI,GAAGvZ,IAAIvB,EAAI,EAAG,GAC7DsC,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,SAC3E,CAWA,sBAA6B7F,EAAc2J,GACzC,MAAMid,EAAK,IAAIloB,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,EAAG,GAClCrB,KAAK6tB,cAAclqB,EAAO,CACxB,IAAItB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,KAChC,IAAIgB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,KAChC,IAAIgB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,KAChC,IAAIgB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,EAAI,MAEpC,CACA,eAAsBsC,EAAc2J,GAClC,QAAuC3K,IAAnC8sB,EAAkBpN,aAGpB,OAFAoN,EAAkBpN,aAAe,IAAIoN,EAAkB9rB,EAAO2J,EAAElM,EAAGkM,EAAEjM,QACrEouB,EAAkBpN,aAAaD,cAAe,GAGhDqN,EAAkBpN,aAAalb,qBAAsB,EACrDsoB,EAAkBpN,aAAaD,cAAe,EAG9CqN,EAAkBpN,aAAa4L,UAC7B,EACAwB,EAAkBpN,aAAalG,IAAI,GAAGvZ,IAAIxB,EAC1CquB,EAAkBpN,aAAalG,IAAI,GAAGvZ,IAAIvB,EAAI,GAC9C,GAKFsC,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAClD2e,EAAkBpN,aAAa7Y,UAEjCimB,EAAkBpN,kBAAe1f,CAEnC,CACA,mBAA0B8G,GACnB,CAEP,kBAAyB9F,EAAc2J,GACrC,QAAuC3K,IAAnC8sB,EAAkBpN,aAA4B,CACrC,IAAItG,EAAOpY,EAAO2J,EAAElM,EAAGkM,EAAEjM,EAAG,GACpC2E,cAAe,CACpB,MAEEypB,EAAkBpN,aAAalG,IAAI,GAAG/O,KAAKE,EAAElM,EAAGquB,EAAkBpN,aAAalG,IAAI,GAAGvZ,IAAIvB,GAC1FouB,EAAkBpN,aAAalG,IAAI,GAAG/O,KAAKE,EAAElM,EAAGkM,EAAEjM,GAClDouB,EAAkBpN,aAAalG,IAAI,GAAG/O,KAAKqiB,EAAkBpN,aAAalG,IAAI,GAAGvZ,IAAIxB,EAAGkM,EAAEjM,GAC1FouB,EAAkBpN,aAAanE,kBAInC,CAEA,gBAAuBva,EAAc0M,GAAoD,IAArCtJ,EAAM,wDAAUuV,EAAU,wDAC5E,MAAM7S,EAAIsS,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAM,GAAImG,GAC9CrF,EAAM,IAAI+tB,EAAkB9rB,EAAO8F,EAAE7G,IAAIxB,EAAGqI,EAAE7G,IAAIvB,EAAG,EAAG0F,GAC9D0C,EAAEgH,SACF,IAAK,IAAIxP,EAAI,EAAGA,EAAIS,EAAIya,IAAIjb,SAAUD,EAAG,CACvC,MAAMiC,EAAI6Y,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAMK,GAAI8F,GACpDrF,EAAIya,IAAIlb,GAAG2B,IAAIxB,EAAI8B,EAAEN,IAAIxB,EACzBM,EAAIya,IAAIlb,GAAG2B,IAAIvB,EAAI6B,EAAEN,IAAIvB,EACzBK,EAAIya,IAAIlb,GAAGV,KAAO6L,EAAAA,GAAAA,WAClBlJ,EAAEuN,QACJ,CAgCA,OA/BA/O,EAAInB,KAAO6L,EAAAA,GAAMiE,EAAE9P,MAEnBmB,EAAI2E,cAAgBgK,EAAE3P,SAClB2P,EAAE3P,SACJgB,EAAI2I,WAAa,EAEjB3I,EAAI2I,WAAa,EAGfgG,EAAExP,QAAUwP,EAAExP,OAAO8Z,OACvBjZ,EAAI2B,eAAe1C,YAAYga,KAAOtK,EAAExP,OAAO8Z,MAI/CjZ,EAAIpB,GADFgc,EACO3Y,EAAMsF,UAENoH,EAAE/P,GAEboB,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EAC1BzF,EAAI0I,SAAU,EACViG,EAAExP,QACJa,EAAI2M,kBAAkBgC,EAAExP,QAG1Ba,EAAIoO,kBAEC/I,GACHpD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,UAGpE9H,CACT,CACA,qBACyCiB,IAAnC8sB,EAAkBpN,cACpBoN,EAAkBpN,aAAa5R,SAEjCgf,EAAkBpN,kBAAe1f,CACnC,CAIA,iBAAwBgB,EAAc2J,GAGpC,CAQF,wBAA+B3J,EAAc2J,GAA+C,IAA5BhK,EAAK,uDAAG,IAAKC,EAAM,uDAAG,IAChFksB,EAAkBpN,cACpBoN,EAAkBpN,aAAa5R,SAEjC,MAAM8F,EAAQ,IAAIkZ,EAAkB9rB,EAAO2J,EAAElM,EAAY,GAARkC,EAAagK,EAAEjM,EAAa,GAATkC,GACpEgT,EAAM4F,IAAI,GAAGvZ,IAAIxB,GAAKkC,EACtBiT,EAAM4F,IAAI,GAAGvZ,IAAIxB,GAAKkC,EACtBiT,EAAM4F,IAAI,GAAGvZ,IAAIvB,GAAKkC,EACtBgT,EAAM4F,IAAI,GAAGvZ,IAAIvB,GAAKkC,EACtBgT,EAAM6L,cAAe,EACrB7L,EAAMpP,qBAAsB,EAC5BoP,EAAMnM,SAAU,EAChBmM,EAAM1F,eACNlN,EAAMC,mBAAmB4H,wBAAwBgX,YAmBnD,CACA,0BAAiClV,GAC1B,CAEP,yBAAgCA,GACzB,CAEP,0BAAiCA,GAC1B,CAGP,mBAA0B3J,EAAc2J,QACC3K,IAAnC8sB,EAAkBpN,cACpBoN,EAAkBvM,WAAWvf,EAAO2J,EAExC,CACA,mBAA0B3J,EAAc2J,QACC3K,IAAnC8sB,EAAkBpN,aACpBoN,EAAkBvM,WAAWvf,EAAO2J,IAEpC3J,EAAMC,mBAAmBuS,eAAe+X,cAAcC,qBACtDsB,EAAkBrB,QAAQzqB,EAAO2J,GAErC,CACA,iBAAwB3J,EAAc2J,GAChCmiB,EAAkBpN,eACpBuL,EAAeS,KAAKoB,EAAkBpN,cACtC1e,EAAMC,mBAAmB4H,wBAAwBgX,aACjDiN,EAAkBpN,aAAaD,cAAe,EAC9CqN,EAAkBpN,aAAalb,qBAAsB,EACrDsoB,EAAkBpN,aAAajY,SAAU,GAGvC8C,EAAAA,EAAAA,IACEuiB,EAAkBpN,aAAalG,IAAI,GAAGvZ,IACtC6sB,EAAkBpN,aAAalG,IAAI,GAAGvZ,KACpC,IAGJ6sB,EAAkBpN,aAAalG,IAAI,GAAGvZ,IAAIxB,IAAM,GAChDquB,EAAkBpN,aAAalG,IAAI,GAAGvZ,IAAIvB,IAAM,GAChDouB,EAAkBpN,aAAalG,IAAI,GAAGvZ,IAAIxB,GAAK,GAC/CquB,EAAkBpN,aAAalG,IAAI,GAAGvZ,IAAIvB,IAAM,GAChDouB,EAAkBpN,aAAalG,IAAI,GAAGvZ,IAAIxB,GAAK,GAC/CquB,EAAkBpN,aAAalG,IAAI,GAAGvZ,IAAIvB,GAAK,GAC/CouB,EAAkBpN,aAAalG,IAAI,GAAGvZ,IAAIxB,IAAM,GAChDquB,EAAkBpN,aAAalG,IAAI,GAAGvZ,IAAIvB,GAAK,IAEjDouB,EAAkBpN,aAAa7hB,YAAa,EAC5CivB,EAAkBpN,aAAanE,mBAC/BuR,EAAkBpN,aAAaxR,eAC/B4e,EAAkBpN,kBAAe1f,EACjC8sB,EAAkBxM,QAAS,EAG/B,CACApjB,YAAY8D,EAAcvC,EAAWC,GAAkD,IAAhC0F,EAAM,wDAAU8R,EAAS,uDAAG,EACjF3T,MAAMvB,GAAO,KAnRR0B,iBAAW,OACXD,oBAAc,OAEd+W,SAAG,OACH+M,OAAqB,GAAG,KACxBrQ,eAAS,OACTvT,YAAM,OACN0jB,mBAA+B,IAAI3mB,EAAAA,GAAS,EAAG,EAAG,GAAG,KACrDqd,UAAI,OACJkJ,UAAW,EAAM,KACjByB,uBAAiB,OACjBjB,uBAAwB,EAAM,KAI9B7F,aAAe,EAAE,KACjB4F,eAAiB,EAAE,KACnBvJ,eAAS,OACT6K,cAAe,EAkQpBzqB,KAAKO,KAAO6L,EAAAA,GAAAA,UACZpM,KAAKmc,IAAM,GACXnc,KAAKmc,IAAIhb,KAAK,IAAI4a,EAAOpY,EAAOvC,EAAGC,EAAG,EAAG0F,IACzC/G,KAAKmc,IAAIhb,KAAK,IAAI4a,EAAOpY,EAAOvC,EAAGC,EAAG,EAAG0F,IACzC/G,KAAKmc,IAAIhb,KAAK,IAAI4a,EAAOpY,EAAOvC,EAAGC,EAAG,EAAG0F,IACzC/G,KAAKmc,IAAIhb,KAAK,IAAI4a,EAAOpY,EAAOvC,EAAGC,EAAG,EAAG0F,IACzC,IAAK,IAAI9F,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACjC8F,IACF/G,KAAKmc,IAAIlb,GAAG2E,cAAe,GAE7B5F,KAAKmc,IAAIlb,GAAGV,KAAO6L,EAAAA,GAAAA,WAErBpM,KAAK6Y,UAAYA,EACjB7Y,KAAK4c,gBACL5c,KAAKsuB,aACLtuB,KAAKuuB,gBACLvuB,KAAKimB,aAGLjmB,KAAKqqB,mBAAoB,EACzBrqB,KAAKwuB,WAKP,CACQ5R,gBACN5c,KAAKqD,eAAiB,IAAI6X,EAAelb,MACzCA,KAAKmF,SAAW,IAAIqQ,EAAkBxV,MACtCA,KAAKqF,YAAc,IAAIsjB,EAAqB3oB,MAC5CA,KAAKoF,eAAiB,IAAI0mB,EAAwB9rB,KACpD,CACQwuB,YACNxuB,KAAK4f,UAAY,IAAIiI,EAAU7nB,MAE/BA,KAAKsF,QAAS,EACdtF,KAAK2D,MAAM+rB,qBAAqB1vB,KAClC,CACOke,mBAUL,OANAle,KAAK4C,KAAMyjB,EAAAA,EAAAA,IAAqB,CAC9BrmB,KAAKmc,IAAI,GAAGvZ,IACZ5C,KAAKmc,IAAI,GAAGvZ,IACZ5C,KAAKmc,IAAI,GAAGvZ,IACZ5C,KAAKmc,IAAI,GAAGvZ,MAEP5C,KAAK4C,GACd,CACO2rB,gBACL,MAAM7I,EAAK1lB,KAAKmc,IAAI,GAAGvZ,IACjB+iB,EAAK3lB,KAAKmc,IAAI,GAAGvZ,IACvB,IAAIxB,EAAI,EACJC,EAAI,EACJC,EAAI,EAENF,EADEskB,EAAGtkB,EAAIukB,EAAGvkB,EACRskB,EAAGtkB,EAEHukB,EAAGvkB,EAGPC,EADEqkB,EAAGrkB,EAAIskB,EAAGtkB,EACRqkB,EAAGrkB,EAEHskB,EAAGtkB,EAGPC,EADEokB,EAAGpkB,EAAIqkB,EAAGrkB,EACRokB,EAAGpkB,EAEHqkB,EAAGrkB,EAET,MAAMotB,EAAM,IAAIrsB,EAAAA,GAASjB,EAAGC,EAAGC,GAE7BF,EADEskB,EAAGtkB,EAAIukB,EAAGvkB,EACRskB,EAAGtkB,EAEHukB,EAAGvkB,EAGPC,EADEqkB,EAAGrkB,EAAIskB,EAAGtkB,EACRqkB,EAAGrkB,EAEHskB,EAAGtkB,EAGPC,EADEokB,EAAGpkB,EAAIqkB,EAAGrkB,EACRokB,EAAGpkB,EAEHqkB,EAAGrkB,EAET,MAAMqtB,EAAM,IAAItsB,EAAAA,GAASjB,EAAGC,EAAGC,GAC/BtB,KAAKiuB,UAAU,EAAGU,EAAIvtB,EAAGstB,EAAIrtB,EAAGqtB,EAAIptB,GACpCtB,KAAKiuB,UAAU,EAAGS,EAAIttB,EAAGutB,EAAIttB,EAAGqtB,EAAIptB,GACpC,IAAK,IAAIL,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGuR,QAAQxS,MACpBA,KAAKmc,IAAIlb,GAAGV,KAAO6L,EAAAA,GAAAA,WAErBpM,KAAKkqB,cACP,CACO0E,gBACL,MAAM5tB,EAAK,GACX,IAAK,IAAIC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EAAG,CACxC,MAAMwI,EAAIzJ,KAAKmc,IAAIlb,GACnBD,EAAGG,KAAK,IAAIkB,EAAAA,GAASoH,EAAE7G,IAAIxB,EAAIpB,KAAK4C,IAAIxB,EAAGqI,EAAE7G,IAAIvB,EAAIrB,KAAK4C,IAAIvB,EAAGoI,EAAE7G,IAAItB,EAAItB,KAAK4C,IAAItB,GACtF,CACF,CACO2sB,UAAUhtB,EAAWG,EAAWC,EAAWC,GAChDtB,KAAKmc,IAAIlb,GAAG2B,IAAIxB,EAAIA,EACpBpB,KAAKmc,IAAIlb,GAAG2B,IAAIvB,EAAIA,EACpBrB,KAAKmc,IAAIlb,GAAG2B,IAAItB,EAAIA,CACtB,CACO8J,eACL,OAAOpL,KAAKmc,IAAInc,KAAKmc,IAAIjb,OAAS,EACpC,CACOmI,UACL,OAAQrJ,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,IAAMpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EACxF,CACOyR,SACL,OAAO9S,KAAKqF,YAAYyN,QAC1B,CACWzI,eAAWnH,GACpBlD,KAAKkH,gBAAkBhE,EACvB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGiG,gBAAkBhE,CAElC,CACW2rB,qBAAiB3rB,GAC1BlD,KAAKsG,YAActG,KAAKqG,cACxBrG,KAAKqG,cAAgBnD,EACrB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGoF,cAAgBnD,CAEhC,CACWxC,aAASwC,GAClBlD,KAAKsG,YAActG,KAAKqG,cACxBrG,KAAKqG,cAAgBnD,EACrBlD,KAAK6uB,iBAAmB3rB,EAExBlD,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBC,UAAUjK,KAAKwJ,SAC1E,CACO4D,KAAKhM,EAAWC,GACrB,GAAIrB,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,cAC9C,OAEF,MAAMme,EAAKpjB,EAAIpB,KAAK4C,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAC3DqjB,EAAKpjB,EAAIrB,KAAK4C,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GACjE,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAG2B,IAAIxB,GAAKojB,EACrBxkB,KAAKmc,IAAIlb,GAAG2B,IAAIvB,GAAKojB,EAEvBzkB,KAAKke,kBACP,CACOhO,gBACLlQ,KAAKgG,cAAe,EACpBhG,KAAKuH,eAAgB,EACrBvH,KAAKmc,IAAI6J,SAASvc,IAChBA,EAAEyG,eAAe,GAErB,CACOgD,0BAA0B5F,GAC/B,OAAOtN,KAAKoF,eAAe8N,0BAA0B5F,EACvD,CACOiG,UAAUnS,EAAWC,GAC1B,OAAOrB,KAAKoF,eAAemO,UAAUnS,EAAGC,EAC1C,CACOorB,uBAAuBxrB,EAAWsrB,EAAcC,GACrD,OAAOxsB,KAAKoF,eAAeqnB,uBAAuBxrB,EAAGsrB,EAAMC,EAC7D,CACO3Z,cAAczR,EAAWC,GAC9B,OAAOrB,KAAKqF,YAAYwN,cAAczR,EAAGC,EAC3C,CACOytB,qBAAqBrlB,EAAe8iB,EAAcC,GACvD,IAAIuC,GAAS,EACb,IAAK,IAAI9tB,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACjCwI,IAAMzJ,KAAKmc,IAAIlb,KACjB8tB,EAAQ9tB,GAGE,IAAV8tB,GACF/uB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GAAKmrB,EACrBxsB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAAKmrB,GACF,IAAVwC,GACT/uB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GAAKmrB,EACrBxsB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAAKmrB,GACF,IAAVwC,GACT/uB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GAAKmrB,EACrBxsB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAAKmrB,GACF,IAAVwC,IACT/uB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GAAKmrB,EACrBxsB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAAKmrB,GAGvBvsB,KAAKke,kBACP,CACQoQ,aACNtuB,KAAKkpB,OAAO/nB,KACV,IAAIkB,EAAAA,GACFrC,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GACzDpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GACzD,IAGJrB,KAAKkpB,OAAO/nB,KACV,IAAIkB,EAAAA,GACFrC,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GACzDpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GACzD,IAGJrB,KAAKkpB,OAAO/nB,KACV,IAAIkB,EAAAA,GACFrC,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GACzDpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GACzD,IAGJrB,KAAKkpB,OAAO/nB,KACV,IAAIkB,EAAAA,GACFrC,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GACzDpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GACzD,GAGN,CACO6oB,eACLlqB,KAAKkpB,OAAO,GAAG9nB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAC5EpB,KAAKkpB,OAAO,GAAG7nB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GAE5ErB,KAAKkpB,OAAO,GAAG9nB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAC5EpB,KAAKkpB,OAAO,GAAG7nB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GAE5ErB,KAAKkpB,OAAO,GAAG9nB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAC5EpB,KAAKkpB,OAAO,GAAG7nB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,GAE5ErB,KAAKkpB,OAAO,GAAG9nB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAA8C,IAAzCpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,GAC5EpB,KAAKkpB,OAAO,GAAG7nB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAA8C,IAAzCrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAC9E,CACOsL,UACL3M,KAAK0f,KAAO,GACZ,IAAK,IAAIze,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAK0f,KAAKve,KAAKnB,KAAKmc,IAAIlb,GAAG2B,KAG7B,OAAO5C,KAAK0f,IACd,CACOjP,SAA+B,IAAxB5J,IAAQ,yDACpB,IAAK,IAAI5F,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGwP,SAEd,GAAI5J,EAAU,CACZ,MAAMuX,EAAQpe,KAAKwJ,SACf4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB,CAACvG,GAElF,CACApe,KAAK+d,YACP,CACOA,aACL/d,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EACpBhC,KAAK4M,mBACL5M,KAAK2D,MAAMgsB,wBAAwB3vB,MACnCA,KAAK2D,MAAM8a,eAAeze,KAC5B,CACOoS,gBACL,MAAO,iBAAmBpS,KAAKM,EACjC,CACO2S,OACL,MAAM,IAAIgc,MAAM,0BAClB,CACW7M,iBAAalf,GACtBlD,KAAKgG,aAAe9C,EACpB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAG+E,aAAe9C,CAE/B,CACWkf,mBACT,OAAOpiB,KAAKgG,YACd,CACWkpB,iBAAaC,GACtBnvB,KAAKgC,aAAemtB,EACpB,IAAK,IAAIluB,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGe,aAAemtB,CAE/B,CAEW3uB,iBACT,OAAOR,KAAK+F,eACd,CACWvF,eAAW0C,GACpBlD,KAAK+F,gBAAkB7C,EACvB,IAAK,MAAMuG,KAAKzJ,KAAKmc,IACnB1S,EAAEzH,aAAekB,EACjBuG,EAAEzD,aAAe9C,EACjBuG,EAAE1D,gBAAkB7C,EAGtBlD,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2c,eAAe3mB,KAAKwJ,SAG/E,CACWY,cACT,OAAOpK,KAAK4F,YACd,CACWwE,YAAQlH,GACjB,IAAIlD,KAAKmH,oBAAT,CAWA,GARAnH,KAAK4F,aAAe1C,GAEhBlD,KAAK4F,eAAiB5F,KAAK6F,aAEnB7F,KAAK4F,cAAgB5F,KAAK6F,aADpC7F,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB4c,WAAW5mB,KAAKwJ,UAI3ExJ,KAAK6F,WAAa7F,KAAK4F,cAClB5F,KAAK+F,gBACR,IAAK,MAAM0D,KAAKzJ,KAAKmc,IACnB1S,EAAEzH,aAAekB,EACjBuG,EAAEzD,aAAe9C,EAGhBA,IACHlD,KAAK8G,mBAAoB,EACzB9G,KAAK4M,mBAjBP,CAmBF,CACOxD,UACL,MAAMlG,EAAgB,GACtB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCiC,EAAE/B,KAAKnB,KAAKmc,IAAIlb,GAAG2B,KAErB,OAAOM,CACT,CACOsG,SACL,MAAMC,EAAI,IAAIpJ,EACZL,KAAKM,GACLN,KAAKO,KACLP,KAAK+F,gBACL/F,KAAK4F,aACL5F,KAAKqG,eAEPoD,EAAE1I,SAASf,KAAKoJ,WAEhB,MAAMvI,EAASb,KAAKqD,eAAeoQ,SAKnC,OAJI5S,IACF4I,EAAE5I,OAASA,GAGN4I,CACT,CACOsG,SAAS3O,EAAWC,GACzB,MAAMgP,EAAIrQ,KAAKwJ,SAETkd,EAAK+I,EAAkBrf,SAASpQ,KAAK2D,MAAO0M,GAAG,GAAM,GAG3D,OAFAqW,EAAGtZ,KAAKhM,EAAGC,GACXqlB,EAAG7V,eACI6V,CACT,CACWpjB,YACT,OAAOtD,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAKmc,IAAI,GAAGvZ,IAAIxB,CAC7C,CACWmC,aACT,OAAOvD,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAKmc,IAAI,GAAGvZ,IAAIvB,CAC7C,CACO6kB,sBACLlmB,KAAK0f,KAAO,GACZ,IAAK,IAAIze,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAK0f,KAAKve,KAAKnB,KAAKmc,IAAIlb,GAAG2B,IAE/B,CACOyI,cACL,OAAOrL,KAAK2M,SACd,CACOsZ,aACLjmB,KAAKkmB,sBACLlmB,KAAKkqB,eACLlqB,KAAKke,kBACP,CACOvN,kBACL3Q,KAAKsF,QAAUtF,KAAKsF,OACpBtF,KAAKqqB,mBAAqBrqB,KAAKqqB,iBACjC,CACO7a,WAAW9L,GAChB1D,KAAKmF,SAASqK,WAAW9L,EAC3B,CACOyJ,oBACL,OAAOnN,KAAKwI,mBACd,CACO8C,qBACLtL,KAAKqF,YAAYkkB,yBACnB,CAEOzf,sBAAsB5G,GAC3B,OAAOlD,KAAKqF,YAAYyE,sBAAsB5G,EAChD,CACO6mB,8BACL,OAAO/pB,KAAKqF,YAAY0kB,6BAC1B,CACOnf,qBAAqB1H,EAAa2H,GACvC,OAAO7K,KAAKqF,YAAYuF,qBAAqB1H,EAAG2H,EAClD,CAEWP,mBAAeC,GAGpBA,IAAMvK,KAAK4I,sBAGX5I,KAAK4I,qBACH2B,GAGFvK,KAAK4I,oBAAoB6B,mBAQ7BzK,KAAK4I,oBAAsB2B,EAE7B,CACWD,qBAET,OAAOtK,KAAK4I,mBACd,EAlsBW6mB,EACGxM,QAAS,EADZwM,EAEGzI,OAAQ,EAFXyI,EAGGpN,kBAAY,EAHfoN,EAIGpF,mBAAoB,ECV7B,MAAMuF,EA4BX,kBAAyBjsB,EAAcD,EAA+B0U,EAAiBpX,EAAgBoJ,EAAkB5J,GAA8F,IAApB2H,EAAiB,uCAClN,IAAK,IAAIlH,EAAI,EAAGA,EAAID,EAAGE,OAAS,EAAGD,GAAK,EAAG,CACzC,MAAM4uB,EAAK,CAAC7uB,EAAGC,GAAGG,EAAGJ,EAAGC,GAAGI,EAAGL,EAAGC,EAAI,GAAGG,EAAGJ,EAAGC,EAAI,GAAGI,EAAGL,EAAGC,EAAI,GAAGG,EAAGJ,EAAGC,EAAI,GAAGI,GACzEyuB,EAAS,CAAC,GAAK,GAAK,GAAK,GAAK,GAAK,IACnCC,EAAK/vB,KAAKgwB,iBACdhvB,EAAGC,GAAGG,EACNJ,EAAGC,GAAGI,EACNL,EAAGC,EAAI,GAAGG,EACVJ,EAAGC,EAAI,GAAGI,EACVL,EAAGC,EAAI,GAAGG,EACVJ,EAAGC,EAAI,GAAGI,EACV,IAEFrB,KAAKiwB,WAAWtsB,EAAOD,EAAK0U,EAAIyX,EAAIE,EAAID,EAAQ1lB,EAAS5J,GACzDR,KAAKkgB,gBAAgBvc,EAAOyU,EAAIjQ,EAAW0nB,EAAIE,EAAIF,EAAG3uB,OACxD,CACF,CACA,wBAA+BgvB,EAAYC,EAAYC,EAAYC,EAAYC,EAAYC,EAAYhmB,GACrG,MAAMimB,EAAMle,KAAKC,KAAKD,KAAKme,IAAIL,EAAKF,EAAI,GAAK5d,KAAKme,IAAIJ,EAAKF,EAAI,IAEzDO,EAAMnmB,EAAIimB,GAAQA,EADZle,KAAKC,KAAKD,KAAKme,IAAIH,EAAKF,EAAI,GAAK9d,KAAKme,IAAIF,EAAKF,EAAI,KAEzDM,EAAKpmB,EAAImmB,EAKf,MAAO,CAJKN,EAAKM,GAAMR,EAAKI,GAChBD,EAAKK,GAAMP,EAAKI,GAChBH,EAAKO,GAAMT,EAAKI,GAChBD,EAAKM,GAAMR,EAAKI,GAE9B,CACA,kBAAyB5sB,EAAcD,EAA+B0U,EAAiBwY,EAAmBC,EAAeC,EAAmB1mB,EAAkB5J,GAC5J,MAAM2b,EAAMyU,EACNb,EAAKc,EACLxkB,EAAI8P,EAAIjb,OAEVkJ,GAAW5J,GAEbmD,EAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAMC,wBACjDttB,EACA0U,EACA+D,EAAI,GACJA,EAAI,GACJ4T,EAAG,GACHA,EAAG,GACH5T,EAAI,GACJA,EAAI,GACJxY,EAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,OACvElL,EACA5J,GAEFmD,EAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAMC,wBACjDttB,EACA0U,EACA+D,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACR0jB,EAAG,EAAI1jB,EAAI,IACX0jB,EAAG,EAAI1jB,EAAI,GACX8P,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACR1I,EAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,OACvElL,EACA5J,GAEFR,KAAKsV,OAAS,KACdtV,KAAKiP,OAAS,EACdjP,KAAKoG,SAAU,GAEfpG,KAAKsV,MAAQ,EAEf3R,EAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAME,eACjDvtB,EACA0U,EACA+D,EAAI,GACJA,EAAI,GACJ4T,EAAG,GACHA,EAAG,GACH5T,EAAI,GACJA,EAAI,GACJ/R,EACA5J,GAEFmD,EAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAME,eACjDvtB,EACA0U,EACA+D,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACR0jB,EAAG,EAAI1jB,EAAI,IACX0jB,EAAG,EAAI1jB,EAAI,GACX8P,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACRjC,EACA5J,EAEJ,CACA,uBAA8BmD,EAAayU,EAAgBjQ,EAAkBgU,EAAc4T,EAAa1jB,GACtG1I,EAAMC,mBAAmBuB,SAASqc,UAAU0P,6BAC1CvtB,EAAMC,mBAAmBuB,SAASuc,aAClCtJ,EACAjQ,EACAgU,EAAI,GACJA,EAAI,GACJ4T,EAAG,GACHA,EAAG,GACH5T,EAAI,GACJA,EAAI,IAENxY,EAAMC,mBAAmBuB,SAASqc,UAAU0P,6BAC1CvtB,EAAMC,mBAAmBuB,SAASuc,aAClCtJ,EACAjQ,EACAgU,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACR0jB,EAAG,EAAI1jB,EAAI,IACX0jB,EAAG,EAAI1jB,EAAI,GACX8P,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GAGZ,CAEAxM,YAAY8D,EAAcwtB,EAA2BjU,EAAYY,EAAYX,GAAa,KA9InFxZ,WAAK,OACL6Z,YAAM,OAENN,QAAE,OACFY,QAAE,OACFX,QAAE,OACFiU,kBAAY,OACZC,iBAAW,OACXC,uBAAiB,OACjBlnB,aAAO,OACP5J,gBAAU,OACV+wB,cAAQ,OACR5rB,cAAQ,OACR3D,kBAAY,OACZgE,kBAAY,OACZwrB,mBAAqB,GAAG,KACxBC,eAAiB,EAAE,KACnBC,UAAW,EAAK,KAChBpc,WAAK,OACLrG,YAAM,OACN7I,aAAO,OACP1F,cAAQ,OACR4F,iBAAW,OACX+D,gBAAU,EAwHfrK,KAAK2D,MAAQA,EACb3D,KAAKwd,OAAS2T,EAEdnxB,KAAKsV,MAAQ,EACbtV,KAAKiP,OAAS,EACdjP,KAAKoG,SAAU,EACfpG,KAAKsG,aAAc,EACnBtG,KAAK2F,UAAW,EAChB3F,KAAKqK,WAAa,EAElB6S,EAAGK,UAAUvd,MACb8d,EAAGP,UAAUvd,MACbmd,EAAGI,UAAUvd,MAEbA,KAAKkd,GAAKA,EACVld,KAAK8d,GAAKA,EACV9d,KAAKmd,GAAKA,EAEVnd,KAAKkd,GAAG3c,KAAO6L,EAAAA,GAAAA,MACfpM,KAAK8d,GAAGvd,KAAO6L,EAAAA,GAAAA,UACfpM,KAAKmd,GAAG5c,KAAO6L,EAAAA,GAAAA,MAIfpM,KAAKuxB,UAAW,EAChBvxB,KAAK8R,MACP,CACOA,OACL9R,KAAK2xB,UAAW,EAChB3xB,KAAKkvB,cAAe,EACpBlvB,KAAKoiB,cAAe,CACtB,CACWwP,cACT,OAAO5xB,KAAKoK,OACd,CACWwnB,YAAQ1uB,GACjBlD,KAAKoK,QAAUlH,EACflD,KAAKkd,GAAG9S,QAAUlH,EAClBlD,KAAK8d,GAAG1T,QAAUlH,EAClBlD,KAAKmd,GAAG/S,QAAUlH,CACpB,CACWgsB,mBACT,OAAOlvB,KAAKgC,YACd,CACWktB,iBAAahsB,GACtBlD,KAAKgC,aAAekB,EAgBlBlD,KAAKkd,GAAGlb,aAAekB,EACvBlD,KAAK8d,GAAG9b,aAAekB,EACvBlD,KAAKmd,GAAGnb,aAAekB,CAM3B,CACWyuB,eACT,OAAO3xB,KAAKU,QACd,CACWixB,aAASzuB,GAClBlD,KAAKsG,YAActG,KAAKU,SACxBV,KAAKU,SAAWwC,EAEhBlD,KAAKkd,GAAGxc,SAAWwC,EACnBlD,KAAK8d,GAAGpd,SAAWwC,EACnBlD,KAAKmd,GAAGzc,SAAWwC,CACrB,CACW2uB,iBACT,OAAO7xB,KAAKqK,UACd,CACWwnB,eAAW3uB,GACpBlD,KAAKqK,WAAanH,EAElBlD,KAAKkd,GAAG7S,WAAa,EACrBrK,KAAK8d,GAAGzT,WAAa,EACrBrK,KAAKmd,GAAG9S,WAAa,CACvB,CACWynB,iBACT,OAAO9xB,KAAKQ,UACd,CACWsxB,eAAW5uB,GACpBlD,KAAKQ,WAAa0C,EAElBlD,KAAKkd,GAAGlb,aAAekB,EACvBlD,KAAK8d,GAAG9b,aAAekB,EACvBlD,KAAKmd,GAAGnb,aAAekB,CAEzB,CACO6uB,WAAW3wB,EAAWC,GAE3B,OAAIrB,KAAKkd,GAAG7K,SAASjR,EAAGC,GADZ,GAEHrB,KAAKkd,GAEVld,KAAKmd,GAAG9K,SAASjR,EAAGC,GAJZ,GAKHrB,KAAKmd,GAEVnd,KAAK8d,GAAGzL,SAASjR,EAAGC,GAPZ,GAQHrB,KAAK8d,QADd,CAIF,CACO5K,0BAA0B5F,GAG1BtN,KAAKkd,GAAGpb,YACX9B,KAAKkd,GAAGpb,WAAY,EACpB9B,KAAKkd,GAAGhK,0BAA0B5F,GAC9BtN,KAAKkd,GAAG5S,gBACVtK,KAAK0kB,2BAA2BpX,EAAGtN,KAAKkd,KAIvCld,KAAKmd,GAAGrb,YACX9B,KAAKmd,GAAGrb,WAAY,EACpB9B,KAAKmd,GAAGjK,0BAA0B5F,GAC9BtN,KAAKmd,GAAG7S,gBACVtK,KAAK0kB,2BAA2BpX,EAAGtN,KAAKmd,KAIxCnd,KAAKuxB,WACFvxB,KAAK8d,GAAGhc,YACX9B,KAAK8d,GAAGhc,WAAY,EAEpB9B,KAAK8d,GAAGlb,IAAIxB,GAAKkM,EAAElM,EAAIkM,EAAE6F,KACzBnT,KAAK8d,GAAGlb,IAAIvB,GAAKiM,EAAEjM,EAAIiM,EAAE8F,KAErBpT,KAAK8d,GAAGxT,iBACVtK,KAAK8d,GAAGxT,eAAe4I,0BAA0B5F,GACjDtN,KAAK0kB,2BAA2BpX,EAAGtN,KAAK8d,MAIhD,CACQ4G,2BAA2BpX,EAAmB7D,GACpD,SAAIA,EAAEa,iBAEAb,EAAEa,eAAe+I,cAEnB5J,EAAEa,eAAe+I,WAAWC,GAAGlS,EAAIqI,EAAE7G,IAAIxB,EACzCqI,EAAEa,eAAe+I,WAAWC,GAAGjS,EAAIoI,EAAE7G,IAAIvB,GAElC,EAIb,CACO+d,UAAU3V,GACf,GAAIA,EAAElJ,OAAS6L,EAAAA,GAAAA,UACb,OAGF,MAAM2iB,EAAQ/uB,KAAKwd,OAAOjM,MAAMkB,QAAQzS,MACxCA,KAAKwd,OAAOjM,MAAM6L,OAAO2R,EAAO,GAEhC,MAAM5P,EAAK,IAAIpD,EAAO/b,KAAK2D,MAAO8F,EAAE7G,IAAIxB,EAAGqI,EAAE7G,IAAIvB,EAAGoI,EAAE7G,IAAItB,GAC1D6d,EAAG5e,KAAO6L,EAAAA,GAAAA,MAEV,MAAM4lB,EAAKhyB,KAAKwd,OAAOhL,QAAQxS,KAAKkd,GAAIiC,GAClC8S,EAAKjyB,KAAKwd,OAAOhL,QAAQ2M,EAAInf,KAAKmd,IAWxC,OATAnd,KAAKkd,GAAGV,OAAOY,OAAOpd,KAAKkd,GAAGV,OAAO/J,QAAQzS,MAAO,GACpDA,KAAKmd,GAAGX,OAAOY,OAAOpd,KAAKmd,GAAGX,OAAO/J,QAAQzS,MAAO,GAEpDA,KAAKwd,OAAOjM,MAAM6L,OAAO2R,EAAO,EAAGkD,GACnCjyB,KAAKwd,OAAOjM,MAAM6L,OAAO2R,EAAO,EAAGiD,GAGnCvoB,EAAEsU,aACF/d,KAAKwd,OAAO0U,oBACL/S,CACT,CAEOgT,eAA4B,IAAfrC,EAAM,uDAAG,GAC3B9vB,KAAKoyB,cAActC,GACnB9vB,KAAKqyB,cAAcvC,GACnB9vB,KAAKsyB,qBACP,CACOpT,gBACL,MAAMuH,GAAKN,EAAAA,EAAAA,IAAOnmB,KAAKkd,GAAGta,IAAK5C,KAAKmd,GAAGva,KAGvC,OAFYsK,EAAAA,EAAAA,IAAYuZ,EAAIzmB,KAAK8d,GAAGlb,KAE1B5C,KAAKyxB,gBACbzxB,KAAK8d,GAAGlb,IAAIxB,EAAIqlB,EAAGrlB,EACnBpB,KAAK8d,GAAGlb,IAAIvB,EAAIolB,EAAGplB,EACnBrB,KAAKuxB,UAAW,GAET,IAETvxB,KAAKuxB,UAAW,GAET,EACT,CACOgB,sBACDvyB,KAAKuxB,UACPvxB,KAAK0xB,UAAW,EAChB1xB,KAAKyxB,eAAiB,IAEtBzxB,KAAK0xB,UAAW,EAChB1xB,KAAKyxB,eAAiB,EAE1B,CACOe,qBAAqBpxB,EAAWC,GAErC,OADArB,KAAKmyB,aAAa,IACdnyB,KAAKyyB,2BAA2BrxB,EAAGC,IACrCrB,KAAK4xB,SAAU,GACR,IAET5xB,KAAK4xB,SAAU,GACR,EACT,CACO/e,cAAczR,EAAWC,GAC9B,GAAIrB,KAAKuxB,UACP,GAAIvxB,KAAKwyB,qBAAqBpxB,EAAGC,GAC/B,OAAO,OAGT,GAAIrB,KAAKqS,SAASjR,EAAGC,GAAKrB,KAAKwxB,mBAAqBxxB,KAAK2D,MAAMC,mBAAmB4H,wBAAwBoC,YACxG,OAAO,EAGX,OAAO,CACT,CACO8kB,WAAWjpB,GAChB,OAAIzJ,KAAKkd,KAAOzT,EACPzJ,KAAKmd,GAEPnd,KAAKkd,EACd,CACO7K,SAASjR,EAAWC,GACzB,OAAOgjB,EAAAA,EAAAA,IAAyB,IAAIhiB,EAAAA,GAASjB,EAAGC,GAAIrB,KAAKkd,GAAGta,IAAK5C,KAAKmd,GAAGva,IAC3E,CACOyc,UAAU/R,GACf,GAAItN,KAAKuxB,cAEF,CACL,MAAMruB,GAAIijB,EAAAA,EAAAA,IAAOnmB,KAAKkd,GAAGta,IAAK5C,KAAKmd,GAAGva,KACtC5C,KAAK8d,GAAGlb,IAAIxB,EAAI8B,EAAE9B,EAClBpB,KAAK8d,GAAGlb,IAAIvB,EAAI6B,EAAE7B,CACpB,CAEF,CACOoP,SACLzQ,KAAK2F,UAAW,EAChB3F,KAAKgC,cAAe,EACpBhC,KAAKkd,GAAGa,aACR/d,KAAK8d,GAAGC,aACR/d,KAAKmd,GAAGY,aACR/d,KAAK2yB,kBACP,CACOC,YACL,OAAO,IAAIvwB,EAAAA,IACRrC,KAAKkd,GAAGta,IAAIxB,EAAIpB,KAAK8d,GAAGlb,IAAIxB,EAAIpB,KAAKmd,GAAGva,IAAIxB,GAAK,GACjDpB,KAAKkd,GAAGta,IAAIvB,EAAIrB,KAAK8d,GAAGlb,IAAIvB,EAAIrB,KAAKmd,GAAGva,IAAIvB,GAAK,GACjDrB,KAAKkd,GAAGta,IAAItB,EAAItB,KAAK8d,GAAGlb,IAAItB,EAAItB,KAAKmd,GAAGva,IAAItB,GAAK,EAEtD,CACOqL,UACL,MAAO,CAAC3M,KAAKkd,GAAGta,IAAK5C,KAAK8d,GAAGlb,IAAK5C,KAAKmd,GAAGva,IAC5C,CACOmb,aACL,CAEK4U,mBACL3yB,KAAKwd,OAAO9K,WAAW1S,KACzB,CACWoiB,mBACT,OAAOpiB,KAAKgG,YACd,CACWoc,iBAAalf,GACtBlD,KAAKgG,aAAe9C,EACpBlD,KAAKkd,GAAGlX,aAAe9C,EACvBlD,KAAK8d,GAAG9X,aAAe9C,EACvBlD,KAAKmd,GAAGnX,aAAe9C,CACzB,CACOke,eACL,IAAKphB,KAAKuxB,SAAU,CAClB,MAAM9K,GAAKN,EAAAA,EAAAA,IAAOnmB,KAAKkd,GAAGta,IAAK5C,KAAKmd,GAAGva,KACvC5C,KAAK8d,GAAGlb,IAAIxB,EAAIqlB,EAAGrlB,EACnBpB,KAAK8d,GAAGlb,IAAIvB,EAAIolB,EAAGplB,CACrB,CACF,CAEOwxB,gBAAgBnvB,GACjB1D,KAAKwd,OAAOsV,SACT9yB,KAAKoK,UAKRpK,KAAKuxB,UACPvxB,KAAKmyB,eACLnyB,KAAK+yB,gBACHrvB,EACA1D,KAAKwd,OAAOna,eAAe1C,YAC3BX,KAAKoxB,aACLpxB,KAAKsxB,kBACLtxB,KAAKqxB,YACLrxB,KAAKoK,QACLpK,KAAKQ,aAGPR,KAAKgzB,cACHtvB,EACA1D,KAAKwd,OAAOna,eAAe1C,YAC3BX,KAAKoK,QACLpK,KAAKQ,YAGX,CACOgP,WAAW9L,GAChB,GAAI1D,KAAKwd,OAAOsV,SACT9yB,KAAKoK,QACR,OAGJ,MAAMmiB,EAAOvsB,KAAK2D,MAAM0lB,cAAcC,mBAAmBloB,EACnDorB,EAAOxsB,KAAK2D,MAAM0lB,cAAcC,mBAAmBjoB,EAGzD,GAAIrB,KAAKuxB,SACPvxB,KAAKmyB,eACLnyB,KAAKiwB,WACHvsB,EACA1D,KAAKwd,OAAOna,eAAe1C,YAC3BX,KAAKoxB,aACLpxB,KAAKsxB,kBACLtxB,KAAKqxB,YACLrxB,KAAKoK,QACLpK,KAAKQ,YAIPovB,EAAc1P,gBACZlgB,KAAK2D,MACL3D,KAAKwd,OAAOna,eAAe1C,YAC3BX,KAAKwd,OAAOrV,UACZnI,KAAKoxB,aACLpxB,KAAKsxB,kBACLtxB,KAAKoxB,aAAalwB,YAGf,CACLlB,KAAKizB,SAASvvB,EAAK1D,KAAKwd,OAAOna,eAAe1C,YAAaX,KAAKoK,QAASpK,KAAKQ,YAG9E,MAAMqvB,EAAK,CACT7vB,KAAKkd,GAAGta,IAAIxB,EAAImrB,EAChBvsB,KAAKkd,GAAGta,IAAIvB,EAAImrB,EAChBxsB,KAAK8d,GAAGlb,IAAIxB,EAAImrB,EAChBvsB,KAAK8d,GAAGlb,IAAIvB,EAAImrB,EAChBxsB,KAAKmd,GAAGva,IAAIxB,EAAImrB,EAChBvsB,KAAKmd,GAAGva,IAAIvB,EAAImrB,GAEZuD,EAAKH,EAAcI,iBACvBhwB,KAAKkd,GAAGta,IAAIxB,EAAImrB,EAChBvsB,KAAKkd,GAAGta,IAAIvB,EAAImrB,EAChBxsB,KAAK8d,GAAGlb,IAAIxB,EAAImrB,EAChBvsB,KAAK8d,GAAGlb,IAAIvB,EAAImrB,EAChBxsB,KAAKmd,GAAGva,IAAIxB,EAAImrB,EAChBvsB,KAAKmd,GAAGva,IAAIvB,EAAImrB,EAChB,IAEFoD,EAAc1P,gBACZlgB,KAAK2D,MACL3D,KAAKwd,OAAOna,eAAe1C,YAC3BX,KAAKwd,OAAOrV,UACZ0nB,EACAE,EACAF,EAAG3uB,OAGP,CACA,IAAKlB,KAAKwd,OAAO7Z,MAAMC,mBAAmB4H,wBAAwB8C,aAAa4kB,YAAa,CAC1F,MAAM5yB,EAAKN,KAAKwd,OAAOjM,MAAMkB,QAAQzS,MACrC0D,EAAI3D,KAAO,aACX2D,EAAIkB,SAAStE,EAAGyS,WAAY/S,KAAK8d,GAAGlb,IAAIxB,EAAGpB,KAAK8d,GAAGlb,IAAIvB,EACzD,CACF,CAEQ4xB,SAASvvB,EAA+B0U,EAAiBhO,EAAkB5J,GACjF,MAAM+rB,EAAOvsB,KAAK2D,MAAM0lB,cAAcC,mBAAmBloB,EACnDorB,EAAOxsB,KAAK2D,MAAM0lB,cAAcC,mBAAmBjoB,EAOzDrB,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMyC,SAASma,mBACzDzvB,EACA1D,KAAKwd,OAAOna,eAAe1C,YAC3BX,KAAKkd,GAAGta,IAAIxB,EAAImrB,EAChBvsB,KAAKkd,GAAGta,IAAIvB,EAAImrB,EAChBxsB,KAAKmd,GAAGva,IAAIxB,EAAImrB,EAChBvsB,KAAKmd,GAAGva,IAAIvB,EAAImrB,GAChB,GACA,EACA,EACA,EACApiB,EACApK,KAAKQ,WAET,CACQwyB,cAActvB,EAA+B0U,EAAiBhO,EAAkB5J,GACtF,GAAI4J,GAAW5J,EAAY,CACzB,MAAM+rB,EAAOvsB,KAAK2D,MAAM0lB,cAAcC,mBAAmBloB,EACnDorB,EAAOxsB,KAAK2D,MAAM0lB,cAAcC,mBAAmBjoB,EACzDrB,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAKqS,kBAAkB1vB,EAAK0U,EAAIpY,KAAKkd,GAAGta,IAAIxB,EAAImrB,EAAMvsB,KAAKkd,GAAGta,IAAIvB,EAAImrB,EAAMxsB,KAAKmd,GAAGva,IAAIxB,EAAImrB,EAAMvsB,KAAKmd,GAAGva,IAAIvB,EAAImrB,EAAMxsB,KAAK2D,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,OAAQlL,EAASpK,KAAKQ,YAC5QR,KAAKsV,OAAS,KACdtV,KAAKiP,OAAS,EACdjP,KAAKoG,SAAU,CACjB,MACEpG,KAAKsV,MAAQ,CAEjB,CACQyd,gBACNrvB,EACA0U,EACAwY,EACAC,EACAC,EACA1mB,EACA5J,GAGA,MAAM2b,EAAMyU,EACNb,EAAKc,EACLxkB,EAAI8P,EAAIjb,OAEVkJ,GAAW5J,GAEXR,KAAK2D,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBACpEC,OAASC,EAAAA,GAAAA,SAEZjW,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAKsS,yBACrD3vB,EACA0U,GACA+N,EAAAA,EAAAA,IAAOnmB,KAAKkd,GAAGta,IAAK5C,KAAKmd,GAAGva,MAGhC5C,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAMC,wBACtDttB,EACA0U,EACA+D,EAAI,GACJA,EAAI,GACJ4T,EAAG,GACHA,EAAG,GACH5T,EAAI,GACJA,EAAI,GACJnc,KAAK2D,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,OAC5ElL,EACA5J,GAEFR,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAMC,wBACtDttB,EACA0U,EACA+D,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACR0jB,EAAG,EAAI1jB,EAAI,IACX0jB,EAAG,EAAI1jB,EAAI,GACX8P,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACR,EACAjC,EACA5J,GAEFR,KAAKsV,OAAS,KACdtV,KAAKiP,OAAS,EACdjP,KAAKoG,SAAU,GAEfpG,KAAKsV,MAAQ,CAEjB,CACQ2a,WACNvsB,EACA0U,EACAwY,EACAC,EACAC,EACA1mB,EACA5J,GAGA,MAAM2b,EAAMyU,EACNb,EAAKc,EACLxkB,EAAI8P,EAAIjb,OAYdlB,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMyC,SAASiY,eACzDvtB,EACA0U,EACA+D,EAAI,GACJA,EAAI,GACJ4T,EAAG,GACHA,EAAG,GACH5T,EAAI,GACJA,EAAI,GACJnc,KAAKoK,QACLpK,KAAKQ,YAEPR,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMyC,SAASiY,eACzDvtB,EACA0U,EACA+D,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACR0jB,EAAG,EAAI1jB,EAAI,IACX0jB,EAAG,EAAI1jB,EAAI,GACX8P,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACRrM,KAAKoK,QACLpK,KAAKQ,WAET,CACQ4xB,cAActC,GACpB,MAAMwD,EAAoB,GAE1BtzB,KAAKkd,GAAGxL,WAAaoe,EACrB9vB,KAAKkd,GAAGvL,YAAcme,EACtB,MAAMvD,EAAOvsB,KAAK2D,MAAM0lB,cAAcC,mBAAmBloB,EACnDorB,EAAOxsB,KAAK2D,MAAM0lB,cAAcC,mBAAmBjoB,EACzDiyB,EAAQnyB,KAAKnB,KAAKkd,GAAGta,IAAIxB,EAAImrB,EAAMvsB,KAAKkd,GAAGta,IAAIvB,EAAImrB,GACnDxsB,KAAK8d,GAAGpM,WAAaoe,EACrB9vB,KAAK8d,GAAGnM,YAAcme,EACtBwD,EAAQnyB,KAAKnB,KAAK8d,GAAGlb,IAAIxB,EAAImrB,EAAMvsB,KAAK8d,GAAGlb,IAAIvB,EAAImrB,GACnDxsB,KAAKmd,GAAGzL,WAAaoe,EACrB9vB,KAAKmd,GAAGxL,YAAcme,EACtBwD,EAAQnyB,KAAKnB,KAAKmd,GAAGva,IAAIxB,EAAImrB,EAAMvsB,KAAKmd,GAAGva,IAAIvB,EAAImrB,GAEnDxsB,KAAKoxB,aAAekC,CACtB,CACQjB,gBAAsB,IAARhW,EAAC,uDAAG,EACxB,MAAMyT,EAAmB,CAACzT,EAAGA,EAAGA,GAEhCrc,KAAKqxB,YAAcvB,CACrB,CACQwC,sBACN,MAAMnW,EAAgB,GACtB,IAAK,MAAMoX,KAAMvzB,KAAKoxB,aACpBjV,EAAIhb,KAAKoyB,GAEX,IAAI1C,EAAgB,GAEpB,IAAK,IAAI5vB,EAAI,EAAGA,EAAIkb,EAAIjb,OAAS,EAAGD,GAAK,EACvC4vB,EAAMA,EAAI2C,OACR5D,EAAcI,iBACZ7T,EAAIlb,GAAKjB,KAAK2D,MAAM0lB,cAAcC,mBAAmBloB,EACrD+a,EAAIlb,EAAI,GAAKjB,KAAK2D,MAAM0lB,cAAcC,mBAAmBjoB,EACzD8a,EAAIlb,EAAI,GAAKjB,KAAK2D,MAAM0lB,cAAcC,mBAAmBloB,EACzD+a,EAAIlb,EAAI,GAAKjB,KAAK2D,MAAM0lB,cAAcC,mBAAmBjoB,EACzD8a,EAAIlb,EAAI,GAAKjB,KAAK2D,MAAM0lB,cAAcC,mBAAmBloB,EACzD+a,EAAIlb,EAAI,GAAKjB,KAAK2D,MAAM0lB,cAAcC,mBAAmBjoB,EACzDrB,KAAKqxB,YAAYpwB,KAIvBjB,KAAKsxB,kBAAoBT,CAE3B,CACQ4B,2BAA2BrxB,EAAWC,GAAqB,IAAVsG,EAAC,uDAAG,IAC3D,MAAMwU,EAAMnc,KAAKoxB,aACXrB,EAAK/vB,KAAKsxB,kBAChB,IAAK,IAAI/mB,EAAI,EAAKA,EAAI,EAAKA,GAAK,KAAO,CAErC,MAAM2lB,EACJ5d,KAAKyS,IAAIzS,KAAKme,IAAI,EAAIlmB,EAAG,IAAM4R,EAAI,GACnC,EAAI7J,KAAKme,IAAI,EAAIlmB,EAAG,GAAKA,EAAIwlB,EAAG,GAChC,EAAIzd,KAAKyS,IAAI,EAAIxa,GAAK+H,KAAKme,IAAIlmB,EAAG,GAAKwlB,EAAG,GAC1Czd,KAAKyS,IAAIzS,KAAKme,IAAIlmB,EAAG,IAAM4R,EAAI,GAC3BgU,EACJ7d,KAAKyS,IAAIzS,KAAKme,IAAI,EAAIlmB,EAAG,IAAM4R,EAAI,GACnC,EAAI7J,KAAKme,IAAI,EAAIlmB,EAAG,GAAKA,EAAIwlB,EAAG,GAChC,EAAIzd,KAAKyS,IAAI,EAAIxa,GAAK+H,KAAKme,IAAIlmB,EAAG,GAAKwlB,EAAG,GAC1Czd,KAAKyS,IAAIzS,KAAKme,IAAIlmB,EAAG,IAAM4R,EAAI,GAC3BiU,EACJ9d,KAAKyS,IAAIzS,KAAKme,IAAI,EAAIlmB,EAAG,IAAM4R,EAAI,GACnC,EAAI7J,KAAKme,IAAI,EAAIlmB,EAAG,GAAKA,EAAIwlB,EAAG,GAChC,EAAIzd,KAAKyS,IAAI,EAAIxa,GAAK+H,KAAKme,IAAIlmB,EAAG,GAAKwlB,EAAG,GAC1Czd,KAAKyS,IAAIzS,KAAKme,IAAIlmB,EAAG,IAAM4R,EAAI,GAC3BkU,EACJ/d,KAAKyS,IAAIzS,KAAKme,IAAI,EAAIlmB,EAAG,IAAM4R,EAAI,GACnC,EAAI7J,KAAKme,IAAI,EAAIlmB,EAAG,GAAKA,EAAIwlB,EAAG,GAChC,EAAIzd,KAAKyS,IAAI,EAAIxa,GAAK+H,KAAKme,IAAIlmB,EAAG,GAAKwlB,EAAG,GAC1Czd,KAAKyS,IAAIzS,KAAKme,IAAIlmB,EAAG,IAAM4R,EAAI,GAEjC,IADasX,EAAAA,EAAAA,IAAa,IAAIpxB,EAAAA,GAAS6tB,EAAIC,GAAK,IAAI9tB,EAAAA,GAASjB,EAAGC,IACrDsG,EACT,OAAO,EAGT,IADY8rB,EAAAA,EAAAA,IAAa,IAAIpxB,EAAAA,GAAS+tB,EAAIC,GAAK,IAAIhuB,EAAAA,GAASjB,EAAGC,IACrDsG,EACR,OAAO,CAEX,CACA,OAAO,CACT,EA5vBWioB,EACGxpB,SAAU,EADbwpB,EAEGta,MAAQ,EAFXsa,EAGG3gB,OAAS,ECXlB,MAAMykB,EAOX7zB,YAAY8D,EAAcT,EAAa3C,GAAc,KAN9C2C,OAAC,OACDqH,OAAC,OACDhK,UAAI,OACJozB,cAAQ,OACRhwB,WAAK,OACLwX,qBAAe,EAEpBnb,KAAK2D,MAAQA,EACb3D,KAAKO,KAAO6L,EAAAA,GAAAA,OACZpM,KAAKkD,EAAI,IAAIb,EAAAA,GAASa,EAAE9B,EAAG8B,EAAE7B,GAC7BrB,KAAKuK,EAAI,EACTvK,KAAK2zB,UAAW,EAChB3zB,KAAKmb,gBAAkB,IAAIhD,EAC3BnY,KAAK4zB,UAAUrzB,EACjB,CACQqzB,UAAUrzB,GACZA,IAAS6L,EAAAA,GAAAA,iBACX+L,EAAY0b,8BACV7zB,KAAKmb,gBACLnb,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAC5C1P,KAAK2D,MAAMC,mBAAmB4H,wBAAwB+f,sBAAsBC,aAErEjrB,IAAS6L,EAAAA,GAAAA,eAClB+L,EAAYuT,6BACV1rB,KAAKmb,gBACLnb,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAC5C1P,KAAK2D,MAAMC,mBAAmB4H,wBAAwB+f,sBAAsBC,YAGlF,CACOpe,KAAKhM,EAAWC,GACrBrB,KAAKkD,EAAE9B,EAAIA,EACXpB,KAAKkD,EAAE7B,EAAIA,CACb,CACOmC,SACL,CAEKC,OAAOC,GACP1D,KAAK2zB,WAGV3zB,KAAKuK,GAAK,IACVvK,KAAKwD,SACLxD,KAAKwP,WAAW9L,GAClB,CACO8L,WAAW9L,GAChB1D,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKU,UACrDxT,EACA1D,KAAKmb,gBACLnb,KAAKkD,EAAE9B,EAAIpB,KAAK2D,MAAM0lB,cAAcC,mBAAmBloB,EACvDpB,KAAKkD,EAAE7B,EAAIrB,KAAK2D,MAAM0lB,cAAcC,mBAAmBjoB,EACvD,EACArB,KAAK2D,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKuK,GAEhF,EAOK,MAAMupB,UAAsBJ,EACjC7zB,YAAY8D,EAAcT,EAAa3C,GACrC2E,MAAMvB,EAAOT,EAAG3C,GAChBP,KAAKO,KAAO6L,EAAAA,GAAAA,SACd,CACOoD,WAAW9L,GAChB1D,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKud,aACrDrwB,EACA1D,KAAKmb,gBACLnb,KAAKkD,EAAE9B,EAAIpB,KAAK2D,MAAM0lB,cAAcC,mBAAmBloB,EACvDpB,KAAKkD,EAAE7B,EAAIrB,KAAK2D,MAAM0lB,cAAcC,mBAAmBjoB,EACvDrB,KAAK2D,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKuK,GAEhF,EAGK,MAAMypB,EAYXn0B,YAAY8D,EAAcpD,GAAsC,IAAzB0zB,EAAgB,uDAAG,IAAG,KAX7D1zB,UAAI,OACJ2zB,QAAE,OACFC,WAAK,OACLC,cAAQ,OAERC,yBAAmB,OACnBJ,sBAAgB,OAEhBrU,eAAS,OACTjc,WAAK,OACLhD,iBAAW,EAETX,KAAK2D,MAAQA,EACb3D,KAAKO,KAAOA,EACZP,KAAKi0B,iBAAmBA,EAEtBj0B,KAAKq0B,oBADkB,IAArBJ,EAKJj0B,KAAKk0B,GAAK,GACVl0B,KAAKm0B,MAAQ,GACbn0B,KAAKW,YAAc,IAAIwX,EAEvBnY,KAAKW,YAAYiN,YAAc5N,KAAK2D,MAAMC,mBAAmB4H,wBAAwBoC,YACrF5N,KAAK4zB,UAAUrzB,EACjB,CACQqzB,UAAUrzB,GACZA,IAAS6L,EAAAA,GAAAA,iBACX+L,EAAYmc,0BACVt0B,KAAKW,YACLX,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAC5C1P,KAAK2D,MAAMC,mBAAmB4H,wBAAwB+f,sBAAsBC,aAErEjrB,IAAS6L,EAAAA,GAAAA,eAClB+L,EAAYsT,yBACVzrB,KAAKW,YACLX,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAC5C1P,KAAK2D,MAAMC,mBAAmB4H,wBAAwB+f,sBAAsBC,YAC5ExrB,KAAK2D,MAAMC,mBAAmB4H,wBAAwB+f,sBAAsBC,YAGlF,CACO7e,UACL,MAAM3L,EAAiB,GACvB,IAAK,IAAIC,EAAI,EAAGA,EAAIjB,KAAKk0B,GAAGhzB,SAAUD,EAAG,CACvC,MAAMwI,EAAIzJ,KAAKk0B,GAAGjzB,GAAGiC,EACrBlC,EAAGG,KAAKsI,EACV,CAEA,MAAM8qB,EAAM,IAAIlyB,EAAAA,GAASrC,KAAKo0B,SAAShzB,EAAIpB,KAAK2D,MAAM0lB,cAAcC,mBAAmBloB,EAAGpB,KAAKo0B,SAAS/yB,EAAIrB,KAAK2D,MAAM0lB,cAAcC,mBAAmBjoB,GAExJ,OADAL,EAAGG,KAAKozB,IACDC,EAAAA,EAAAA,IAAoBxzB,EAAI,EAQjC,CACOyzB,aACL,MAAMzzB,EAAiB,GACvB,IAAK,IAAIC,EAAI,EAAGA,EAAIjB,KAAKk0B,GAAGhzB,SAAUD,EAAG,CACvC,MAAMwI,EAAIzJ,KAAKk0B,GAAGjzB,GAAGiC,EAGrBlC,EAAGG,KAAK,IAAIkB,EAAAA,GAASoH,EAAErI,EAAIpB,KAAK2D,MAAM0lB,cAAcC,mBAAmBloB,EAAGqI,EAAEpI,EAAIrB,KAAK2D,MAAM0lB,cAAcC,mBAAmBjoB,GAC9H,CACA,OAAOL,CACT,CACO0zB,IAAIxxB,GACT,MAAMyxB,EAAK,IAAIjB,EAAW1zB,KAAK2D,MAAO,IAAItB,EAAAA,GAASa,EAAE9B,EAAG8B,EAAE7B,GAAIrB,KAAKO,MACnEP,KAAKk0B,GAAG/yB,KAAKwzB,GACT30B,KAAKk0B,GAAGhzB,OAAS,GACnBlB,KAAKk0B,GAAGl0B,KAAKk0B,GAAGhzB,OAAS,GAAGyyB,UAAW,EACvC3zB,KAAKo0B,SAAW,IAAI/xB,EAAAA,GAClBrC,KAAKk0B,GAAGl0B,KAAKk0B,GAAGhzB,OAAS,GAAGgC,EAAE9B,EAAIpB,KAAK2D,MAAM0lB,cAAcC,mBAAmBloB,EAC9EpB,KAAKk0B,GAAGl0B,KAAKk0B,GAAGhzB,OAAS,GAAGgC,EAAE7B,EAAIrB,KAAK2D,MAAM0lB,cAAcC,mBAAmBjoB,GAEhFrB,KAAK40B,OAAO50B,KAAKk0B,GAAGl0B,KAAKk0B,GAAGhzB,OAAS,GAAGgC,EAAGlD,KAAKk0B,GAAGl0B,KAAKk0B,GAAGhzB,OAAS,GAAGgC,KAEvElD,KAAKk0B,GAAG,GAAGP,UAAW,EACtB3zB,KAAKo0B,SAAW,IAAI/xB,EAAAA,GAClBrC,KAAKk0B,GAAGl0B,KAAKk0B,GAAGhzB,OAAS,GAAGgC,EAAE9B,EAAIpB,KAAK2D,MAAM0lB,cAAcC,mBAAmBloB,EAC9EpB,KAAKk0B,GAAGl0B,KAAKk0B,GAAGhzB,OAAS,GAAGgC,EAAE7B,EAAIrB,KAAK2D,MAAM0lB,cAAcC,mBAAmBjoB,GAGpF,CACOwzB,UAAUzzB,EAAWC,GAC1BrB,KAAKo0B,SAAShzB,EAAIA,EAAIpB,KAAK2D,MAAM0lB,cAAcC,mBAAmBloB,EAClEpB,KAAKo0B,SAAS/yB,EAAIA,EAAIrB,KAAK2D,MAAM0lB,cAAcC,mBAAmBjoB,CACpE,CACOyzB,OACL,GAAI90B,KAAKk0B,GAAGhzB,OAAS,EAGnB,OAFAlB,KAAK2D,MAAMoxB,8BAA2BpyB,OACtC3C,KAAK2D,MAAMC,mBAAmB4H,wBAAwBgX,aAGxDxiB,KAAKk0B,GAAGc,MACRh1B,KAAKm0B,MAAMa,KACb,CACOvxB,OAAOC,GAMZ,GALA1D,KAAKwD,SACLxD,KAAKi1B,YAAYvxB,GAEjB1D,KAAKk1B,WAAWxxB,GAEZ1D,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAaqR,SAAU,CAC/E,MAAMD,EAAO1f,KAAK2M,UACd+S,IAIF1f,KAAK4f,UAAUC,aAAanc,GAAK,EAAOgc,GACxC1f,KAAK4f,UAAUG,kBAAkBrc,EAAKgc,GAE1C,CACF,CACQkV,OAAOlP,EAAcC,GAC3B,MAAMziB,GAAIijB,EAAAA,EAAAA,IAAOT,EAAIC,GACfwP,EAAK,IAAIrB,EAAc9zB,KAAK2D,MAAO,IAAItB,EAAAA,GAASa,EAAE9B,EAAG8B,EAAE7B,GAAIrB,KAAKO,MACtE40B,EAAGxB,UAAW,EACd3zB,KAAKm0B,MAAMhzB,KAAKg0B,EAClB,CACQ3xB,SACN,IAAI6d,EAAIrhB,KAAKk0B,GAAGhzB,OAChB,KAAOmgB,KACLrhB,KAAKk0B,GAAG7S,GAAG7d,SAGb,IADA6d,EAAIrhB,KAAKm0B,MAAMjzB,OACRmgB,KACLrhB,KAAKm0B,MAAM9S,GAAG7d,QAElB,CACQyxB,YAAYvxB,GACd1D,KAAKO,OAAS6L,EAAAA,GAAAA,iBAChBpM,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAKqU,eACrD1xB,EACA1D,KAAKW,YACLX,KAAKy0B,aACLz0B,KAAKo0B,SACLp0B,KAAKO,MAEEP,KAAKO,OAAS6L,EAAAA,GAAAA,eACvBpM,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwK,KAAKsU,cACrD3xB,EACA1D,KAAKW,YACLX,KAAKy0B,aACLz0B,KAAKo0B,SACLp0B,KAAKO,KAGX,CACQ20B,WAAWxxB,GAEjB,IAAI2d,EAAIrhB,KAAKk0B,GAAGhzB,OAChB,KAAOmgB,KACLrhB,KAAKk0B,GAAG7S,GAAG5d,OAAOC,EAEtB,ECnPK,MAAM8R,UAA0BE,EAErC7V,YAAYyE,GACVY,MAAMZ,GAAM,KAFPA,UAAI,EAGTtE,KAAKsE,KAAOA,CACd,CACOkL,WAAW9L,IACZ1D,KAAKsE,KAAKqB,UAAa3F,KAAKsE,KAAKtC,eAGrChC,KAAKmU,iBAAiB3Q,SAEtBxD,KAAKsE,KAAK4Z,mBACVle,KAAKyV,MAAMF,qBAOXvV,KAAKsE,KAAKgxB,mBAEVt1B,KAAKigB,mBAAmBvc,GAC1B,CACQuc,mBAAmBvc,GACrB1D,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAaqR,WACtE3f,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAK6C,sBACtCnH,KAAKsE,KAAKsb,UAAUC,aAAanc,GAAK,EAAO1D,KAAKsE,KAAKqI,WAK3D3M,KAAKu1B,kBAAkB7xB,GAGnB1D,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMD,KAAKnR,SAASmP,WAActU,KAAKsE,KAAKsB,aAC/FlC,EAAI2c,YAAcrgB,KAAKsE,KAAKjB,eAAe1C,YAAY2Z,wBAIrDta,KAAKsE,KAAKyB,kBACZrC,EAAI2c,YAAcrgB,KAAKsE,KAAKjB,eAAe1C,YAAY2Z,yBAGzD5W,EAAImV,UAAY7Y,KAAKsE,KAAKjB,eAAe1C,YAAYkY,UAAY7Y,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WACzJjL,EAAIO,YAEJ,IAAI7C,EAAKpB,KAAKsE,KAAKiN,MAAM,GAAG2L,GAAGta,IAAIxB,EAAIpB,KAAKsE,KAAKX,MAAM0lB,cAAcC,mBAAmBloB,EACpFC,EAAKrB,KAAKsE,KAAKiN,MAAM,GAAG2L,GAAGta,IAAIvB,EAAIrB,KAAKsE,KAAKX,MAAM0lB,cAAcC,mBAAmBjoB,EACxFqC,EAAI4c,OAAOlf,EAAGC,GACd,MAAMJ,EAAIjB,KAAKsE,KAAKiN,MAAMrQ,OAC1B,IAAK,IAAI6tB,EAAQ,EAAGA,EAAQ9tB,IAAK8tB,EAC/B/uB,KAAKsE,KAAKiN,MAAMwd,GAAOvf,WAAW9L,GAEpCA,EAAIkS,QAAU,QACdlS,EAAI0c,YAAYpgB,KAAKsE,KAAKjB,eAAe1C,YAAYga,MACrDjX,EAAI8c,SACJ9c,EAAI0c,YAAY,CAAC,EAAG,GAKtB,CACQmV,kBAAkB7xB,GACxB,MACMzC,EAAIjB,KAAKsE,KAAKiN,MAAMrQ,OAE1B,GAAIlB,KAAKsE,KAAK8F,SAAWpK,KAAKsE,KAAK9D,WAK1B,CACLR,KAAKsV,OAAS,KACdtV,KAAKiP,OAAS,EACdjP,KAAKsE,KAAK8B,SAAU,EAEpB,MAAMmmB,EAAOvsB,KAAKsE,KAAKX,MAAM0lB,cAAcC,mBAAmBloB,EACxDorB,EAAOxsB,KAAKsE,KAAKX,MAAM0lB,cAAcC,mBAAmBjoB,EACxD+W,EAAKpY,KAAKsE,KAAKjB,eAAe1C,YAE9B6M,EAASxN,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,OAChG5R,EAAImV,UAAYrL,EAAS4K,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WAAa3O,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgB2xB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aAE/K/xB,EAAIO,YACJ,IAAK,IAAI8qB,EAAQ,EAAGA,EAAQ9tB,IAAK8tB,EAAO,CACtC,MAAM7R,EAAKld,KAAKsE,KAAKiN,MAAMwd,GAAO7R,GAClCxZ,EAAI4c,OAAOpD,EAAGta,IAAIxB,EAAImrB,EAAMrP,EAAGta,IAAIvB,EAAImrB,GACvC,MAAMrP,EAAKnd,KAAKsE,KAAKiN,MAAMwd,GAAO5R,GAClCzZ,EAAI2c,YAAcrgB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BACjHhyB,EAAI6c,OAAOpD,EAAGva,IAAIxB,EAAImrB,EAAMpP,EAAGva,IAAIvB,EAAImrB,EACzC,CACA9oB,EAAI0c,YAAYhI,EAAGuC,MACnBjX,EAAIkS,QAAU,QACdlS,EAAI8c,SACJ9c,EAAI0c,YAAY,CAAC,EAAG,GACtB,MAEApgB,KAAKsV,MAAQ,CAEjB,ECjGK,MAAM4F,UAAuBM,EAElC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KAFNA,SAAG,EAGR1B,KAAKmO,cACLnO,KAAK0K,aACP,CACOyD,cACL,IAAKnO,KAAKob,WACRpb,KAAK+W,MAAMC,aAAeM,EAAa+T,aACvCrrB,KAAKob,UAAW,EAChBjD,EAAYwJ,0BACV3hB,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElDyI,EAAYyJ,8BACV5hB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAE9C1P,KAAK0B,IAAI6P,OACX,IAAK,IAAItQ,EAAI,EAAGA,EAAIjB,KAAK0B,IAAI6P,MAAMrQ,SAAUD,EAC3CjB,KAAK0B,IAAI6P,MAAMtQ,GAAGic,GAAG7Z,eAAeuY,mBAAmB5b,KAAKmb,iBAC5Dnb,KAAK0B,IAAI6P,MAAMtQ,GAAG6c,GAAGza,eAAeuY,mBAAmB5b,KAAKmb,iBAC5Dnb,KAAK0B,IAAI6P,MAAMtQ,GAAGkc,GAAG9Z,eAAeuY,mBAAmB5b,KAAKmb,gBAIpE,CACOzQ,cAAsD,IAA1C4gB,EAA2B,4DAAG3oB,EAe/C,GAdA3C,KAAKob,UAAW,OACFzY,IAAV2oB,IACFA,EAAQtrB,KAAK0B,IAAIiC,MAAMC,mBAAmB4H,wBAAwB+f,sBAAsBC,aAE1FrT,EAAYmc,0BACVt0B,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD4b,GAEFnT,EAAY0b,8BACV7zB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD4b,GAEEtrB,KAAK0B,IAAI6P,MACX,IAAK,IAAItQ,EAAI,EAAGA,EAAIjB,KAAK0B,IAAI6P,MAAMrQ,SAAUD,EAC3CjB,KAAK0B,IAAI6P,MAAMtQ,GAAGic,GAAG7Z,eAAeuY,mBAAmB5b,KAAKmb,iBAC5Dnb,KAAK0B,IAAI6P,MAAMtQ,GAAG6c,GAAGza,eAAeuY,mBAAmB5b,KAAKmb,iBAC5Dnb,KAAK0B,IAAI6P,MAAMtQ,GAAGkc,GAAG9Z,eAAeuY,mBAAmB5b,KAAKmb,iBAGhEnb,KAAKqb,cAAgBiQ,CACvB,CAEOjd,kBAAkBzC,GAavB,GAPIA,EAAMtI,QACRtD,KAAK+W,MAAMzT,MAAQsI,EAAMtI,YAEPX,IAAhBiJ,EAAM0f,QACRtrB,KAAK+W,MAAMC,aAAepL,EAAM0f,OAG9B1f,EAAM6N,UAAUvY,OAAS,IAC3BlB,KAAKqb,cAAgBzP,EAAM6N,UAC3BtB,EAAYwd,gCACV31B,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD9D,EAAM6N,WAERtB,EAAYyd,oCACV51B,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD9D,EAAM6N,WAEJzZ,KAAK0B,IAAI6P,OACX,IAAK,IAAItQ,EAAI,EAAGA,EAAIjB,KAAK0B,IAAI6P,MAAMrQ,SAAUD,EAC3CjB,KAAK0B,IAAI6P,MAAMtQ,GAAGic,GAAG7Z,eAAeuY,mBAAmB5b,KAAKmb,iBAC5Dnb,KAAK0B,IAAI6P,MAAMtQ,GAAG6c,GAAGza,eAAeuY,mBAAmB5b,KAAKmb,iBAC5Dnb,KAAK0B,IAAI6P,MAAMtQ,GAAGkc,GAAG9Z,eAAeuY,mBAAmB5b,KAAKmb,iBAgBlE,OAZIvP,EAAM/G,QACR7E,KAAKW,YAAYgO,WAAa/C,EAAM/G,MACpC7E,KAAK+W,MAAMlS,MAAQ+G,EAAM/G,OAE3B7E,KAAKob,UAAW,EAKZxP,EAAM6N,UAAUvY,OAAS,GAC3BlB,KAAK0K,YAAYkB,EAAM6N,YAElB,CACT,CACO5L,QAAQ3K,GACblD,KAAKW,YAAYga,KAAOzX,EACxBlD,KAAK0B,IAAIiC,MAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAC3D9Q,KAAK0B,IAAI8H,SAEb,CAEOiK,SACL,IAAKzT,KAAKob,SACR,OAGF,MAAMyQ,EAAc,CAClBvoB,MAAOtD,KAAK+W,MAAMzT,MAClBuB,MAAO7E,KAAKW,YAAYgO,WACxB8K,UAAWzZ,KAAKqb,eAyClB,OAPIrb,KAAK+W,MAAMC,eAAiBM,EAAa+T,eAC3CQ,EAAOP,MAAQtrB,KAAK+W,MAAMC,cAMrB6U,CACT,CAEUtQ,YAAY3P,GACpB,GAAIA,EAAM6N,UAAUvY,SAAWlB,KAAKqb,cAAcna,OAChD,IAAK,IAAID,EAAI,EAAGA,EAAI2K,EAAM6N,UAAUvY,OAAQD,IAC1C,GAAI2K,EAAM6N,UAAUxY,KAAOjB,KAAKqb,cAAcpa,GAC5C,OAAO,EAIb,OAAO,CACT,ECzJK,MAAM40B,UAA8B5wB,EAsBzC,mBAA0BtB,EAAc2J,GACtC,IAAK,IAAIrM,EAAI0C,EAAMmyB,0BAA0B50B,OAAS,EAAGD,GAAK,IAAKA,EACjE,GACE0C,EAAMmyB,0BAA0B70B,GAAG+E,cACnCrC,EAAMmyB,0BAA0B70B,GAAG4R,cAAcvF,EAAElM,EAAGkM,EAAEjM,GAExD,OAAOsC,EAAMmyB,0BAA0B70B,EAI7C,CACA,0BAAiC0C,GAC/B,IAAI1C,EAAI0C,EAAMmyB,0BAA0B50B,OACpC6gB,EAAQ,EACZ,KAAO9gB,KACD0C,EAAMmyB,0BAA0B70B,GAAGT,aACrCuhB,GAAS,GAGb,OAAOA,CACT,CACA,mBAA0Bpe,EAAc2J,GACtC,MAAM0U,EAAKhiB,KAAKiiB,YAAYte,EAAO2J,QACxB3K,IAAPqf,IACFA,EAAGpc,cAAe,EAEtB,CACA,gCACO,CAGP,gBAAuBjC,EAAc0M,GAAoD,IAArCtJ,EAAM,wDAAUuV,EAAU,wDAC5E,MAAMtb,EAAiB,GACvB,IAAK,IAAIC,EAAI,EAAGA,EAAIoP,EAAEzP,MAAMM,OAAQD,GAAK,EAAG,CAC1C,MAAM80B,EAAK,CAAC1lB,EAAEzP,MAAMK,GAAGf,GAAImQ,EAAEzP,MAAMK,GAAGd,IAChCsJ,EAAI,IAAIpH,EAAAA,GAAS0zB,EAAG,GAAIA,EAAG,IACjC/0B,EAAGG,KAAKsI,EACV,CACA,MAAM/H,EAAM,IAAIm0B,EAAsBlyB,EAAO3C,EAAIoL,EAAAA,GAAAA,iBAAwBrF,GAAQ,GA4CjF,OAzCArF,EAAInB,KAAO6L,EAAAA,GAAMiE,EAAE9P,MAEjBmB,EAAIpB,GADFgc,EACO3Y,EAAMsF,UAENoH,EAAE/P,GAEboB,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EAC1BzF,EAAI0I,SAAU,EAaViG,EAAExP,QAAUwP,EAAExP,OAAO8Z,OACvBjZ,EAAI2B,eAAe1C,YAAYga,KAAOtK,EAAExP,OAAO8Z,MAGjDjZ,EAAI2E,cAAgBgK,EAAE3P,SAClB2P,EAAE3P,SACJgB,EAAIwF,gBAAkB,EAEtBxF,EAAIwF,gBAAkB,EAEpBmJ,EAAExP,QACJa,EAAI2M,kBAAkBgC,EAAExP,QAI1Ba,EAAIwc,mBACJxc,EAAIoO,kBACC/I,GACHpD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,UAEpE9H,CACT,CACA,eAAsB4L,GACf,CAEP,mBAA0B7D,GACnB,CAgBP,iBAAwB9F,EAAc2J,QAGG3K,IAAnCgB,EAAMoxB,0BAGNpxB,EAAMoxB,yBAAyBb,GAAGhzB,OAAS,GAC7CyC,EAAMoxB,yBAAyBL,IAAI,IAAIryB,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,GAE3D,CACA,sBAA6BsC,EAAc2J,QACnB3K,IAAlBgB,EAAMgP,eAG6BhQ,IAAnCgB,EAAMoxB,2BACRpxB,EAAMoxB,yBAA2B,IAAIf,EAAqBrwB,EAAOyI,EAAAA,GAAAA,kBACjEzI,EAAMoxB,yBAAyBL,IAAI,IAAIryB,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,IACvDsC,EAAMoxB,yBAAyBL,IAAI,IAAIryB,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,KAEzDsC,EAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMyW,UAAUC,iBAAiBC,2BAA4B,EAC5G,CACA,iBAAwBhf,EAAc2J,GACpC,QAAuC3K,IAAnCgB,EAAMoxB,yBAAV,CAGA,GAAIpxB,EAAMC,mBAAmB4H,wBAAwB8C,aAAayQ,WAAY,CAC5E,MAAM7B,EAAKvZ,EAAMoxB,yBAAyBb,GAAGvwB,EAAMoxB,yBAAyBb,GAAGhzB,OAAS,IACpFgM,EAAAA,EAAAA,IAAYgQ,EAAGha,EAAG,IAAIb,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,IAAM,IAC9CsC,EAAMoxB,yBAAyBL,IAAI,IAAIryB,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,GAE3D,CACIsC,EAAMoxB,yBAAyBb,GAAGhzB,OAAS,GAC7CyC,EAAMoxB,yBAAyBF,UAAUvnB,EAAElM,EAAGkM,EAAEjM,EARlD,CAWF,CACA,wBAA+BsC,EAAc2J,GAC3C,QAAuC3K,IAAnCgB,EAAMoxB,yBAAV,CAKA,GAAIpxB,EAAMC,mBAAmB4H,wBAAwB6b,cACnD,GAAI1jB,EAAMoxB,yBAAyBb,GAAGhzB,OAAS,EAAG,CAChD,IAAIF,EAAK2C,EAAMoxB,yBAAyBpoB,UACpC3L,IACFA,EAAKA,EAAGg1B,MAAM,EAAGh1B,EAAGE,OAAS,GACzBF,GACF60B,EAAsBI,YAAYtyB,EAAO3C,GACzC2C,EAAMoxB,8BAA2BpyB,EACjCgB,EAAMC,mBAAmB4H,wBAAwBgX,eAEjD7e,EAAMoxB,8BAA2BpyB,EACjCgB,EAAMC,mBAAmB4H,wBAAwBgX,cAGvD,OAEA,GAAI7e,EAAMoxB,yBAAyBb,GAAGhzB,OAAS,EAAG,CAChD,MAAMF,EAAK2C,EAAMoxB,yBAAyBpoB,UACtC3L,GACF60B,EAAsBI,YAAYtyB,EAAO3C,GACzC2C,EAAMoxB,8BAA2BpyB,EACjCgB,EAAMC,mBAAmB4H,wBAAwBgX,eAEjD7e,EAAMoxB,8BAA2BpyB,EACjCgB,EAAMC,mBAAmB4H,wBAAwBgX,aAErD,CAGF7e,EAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMyW,UAAUC,iBAAiBC,2BAA4B,CAhC1G,CAiCF,CACA,YAAmBhf,EAAc2J,QACQ3K,IAAnCgB,EAAMoxB,0BACRpxB,EAAMoxB,yBAAyBD,MAEnC,CACA,sBAA6BnxB,GAC3B,QAAuChB,IAAnCgB,EAAMoxB,yBAAwC,CAChD,MAAM/zB,EAAK2C,EAAMoxB,yBAAyBpoB,UACtC3L,GACF60B,EAAsBI,YAAYtyB,EAAO3C,GACzC2C,EAAMoxB,8BAA2BpyB,EACjCgB,EAAMC,mBAAmB4H,wBAAwBgX,eAEjD7e,EAAMoxB,8BAA2BpyB,EACjCgB,EAAMC,mBAAmB4H,wBAAwBgX,aAErD,CACF,CACA,cAAqB7e,QACoBhB,IAAnCgB,EAAMoxB,2BACRpxB,EAAMoxB,8BAA2BpyB,EAErC,CACA,mBAA0BgB,EAAc3C,GAAsC,IAAtBk1B,EAAW,wDACjE,KAAIl1B,EAAGE,OAAS,GAAhB,CAGA,KAAIg1B,IACEhpB,EAAAA,EAAAA,IAAYlM,EAAG,GAAIA,EAAGA,EAAGE,OAAS,IAAM,IAM9C,OADAyC,EAAMoxB,8BAA2BpyB,EAC1B,IAAIkzB,EAAsBlyB,EAAO3C,EAAIoL,EAAAA,GAAAA,kBAAwB,GAAO,GALvE+a,EAAgBgP,iBAAiBxyB,EAAO3C,EAH5C,CASF,CAEAnB,YACE8D,EACA3C,GAIC,IAHDT,EAAW,uDAAG6L,EAAAA,GAAAA,iBACdrF,EAAM,wDACNqvB,IAAQ,yDAERlxB,MAAMvB,GAQN,KAzPK4N,WAAK,OAILyR,cAAQ,OACR8P,YAAM,OAGNlT,eAAS,OACTyW,YAAc,GAAG,KAGjBC,eAAS,OAETC,qBAAe,OACfhT,aAAe,EAAE,KACjBC,eAAS,OAETre,cAAQ,EAwObnF,KAAKO,KAAOA,EACZP,KAAKmH,qBAAsB,EAC3BnH,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EACpBhC,KAAK+G,OAASA,EACd/G,KAAK8yB,QAAS,EACd9yB,KAAK4c,gBAEL5c,KAAKw2B,cAAcx1B,GACnB,MAAMmb,EAAMnc,KAAKy2B,YAAYz1B,EAAIo1B,GACjCp2B,KAAK02B,YAAYva,GACjBnc,KAAKke,mBACLle,KAAK8P,kBAEL9P,KAAK0G,cAAe,EAGpB1G,KAAK22B,mBACP,CACOA,oBACL32B,KAAK4f,UAAY,IAAIiI,EAAU7nB,MAC1BA,KAAK+G,QACR/G,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiB9Q,KAAKwJ,UAGjFxJ,KAAK2D,MAAMizB,yBAAyB52B,KACtC,CACO4c,gBACL5c,KAAKqD,eAAiB,IAAI6X,EAAelb,MACzCA,KAAKmF,SAAW,IAAIqQ,EAAkBxV,KAGxC,CACWU,eACT,OAAOV,KAAKqG,aACd,CACW3F,aAASwC,GAClBlD,KAAKsG,YAActG,KAAKqG,cACxBrG,KAAKqG,cAAgBnD,EACrB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKuR,MAAMrQ,SAAUD,EACvCjB,KAAKuR,MAAMtQ,GAAG0wB,SAAWzuB,EACzBlD,KAAKuR,MAAMtQ,GAAG4wB,WAAa,EAE7B7xB,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBC,UAAUjK,KAAKwJ,SAC1E,CACWY,cACT,OAAOpK,KAAK4F,YACd,CACWwE,YAAQlH,GAQjB,GAPAlD,KAAK4F,aAAe1C,GAChBlD,KAAK4F,eAAiB5F,KAAK6F,aAEnB7F,KAAK4F,cAAgB5F,KAAK6F,aADpC7F,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB4c,WAAW5mB,KAAKwJ,UAI3ExJ,KAAK6F,WAAa7F,KAAK4F,cAClB5F,KAAK+F,gBAAiB,CACzB,IAAI9E,EAAIjB,KAAKuR,MAAMrQ,OACnB,KAAOD,KACLjB,KAAKuR,MAAMtQ,GAAGiuB,aAAehsB,EAC7BlD,KAAKuR,MAAMtQ,GAAG2wB,QAAU1uB,CAE5B,CAIKA,IACHlD,KAAK8G,mBAAoB,EACzB9G,KAAK4M,mBAGT,CACWwV,mBACT,OAAOpiB,KAAKgG,YACd,CACWoc,iBAAalf,GACtBlD,KAAKgG,aAAe9C,EACpB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKuR,MAAMrQ,SAAUD,EACvCjB,KAAKuR,MAAMtQ,GAAGmhB,aAAelf,CAEjC,CACW1C,iBACT,OAAOR,KAAK+F,eACd,CACWvF,eAAW0C,GACpB,GAAIlD,KAAK2F,UAAY3F,KAAKqG,cACxB,OAEFrG,KAAK+F,gBAAkB7C,EACvB,IAAK,MAAMoK,KAAKtN,KAAKuR,MACnBjE,EAAEwkB,WAAa5uB,EAGjB,IAAI2D,GAAW,EACf,IAAK,MAAMyG,KAAKtN,KAAKuR,MAAO,CAC1B,GAAIjE,EAAE4P,GAAGnX,gBAAiB,CACxBc,GAAW,EACX,KACF,CACA,GAAIyG,EAAEwQ,GAAG/X,gBAAiB,CACxBc,GAAW,EACX,KACF,CACA,GAAIyG,EAAE6P,GAAGpX,gBAAiB,CACxBc,GAAW,EACX,KACF,CACF,CACIA,GACF7G,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2c,eAAe3mB,KAAKwJ,SAEjF,CACO4D,KAAKhM,EAAWC,GACrB,GAAIrB,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,cAC9C,OAEFrG,KAAKke,mBACL,MAAMsG,EAAKpjB,EAAIpB,KAAK4C,IAAIxB,EAClBqjB,EAAKpjB,EAAIrB,KAAK4C,IAAIvB,EACxB,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAKuR,MAAMrQ,SAAUD,EACvCjB,KAAKuR,MAAMtQ,GAAGic,GAAGta,IAAIxB,GAAKojB,EAC1BxkB,KAAKuR,MAAMtQ,GAAGic,GAAGta,IAAIvB,GAAKojB,EAE1BzkB,KAAKuR,MAAMtQ,GAAG6c,GAAGlb,IAAIxB,GAAKojB,EAC1BxkB,KAAKuR,MAAMtQ,GAAG6c,GAAGlb,IAAIvB,GAAKojB,EAE1BzkB,KAAKuR,MAAMtQ,GAAGkc,GAAGva,IAAIxB,GAAKojB,EAC1BxkB,KAAKuR,MAAMtQ,GAAGkc,GAAGva,IAAIvB,GAAKojB,CAG9B,CACOvG,mBACL,MAAMld,EAAiB,GACvB,IAAK,IAAIC,EAAI,EAAGA,EAAIjB,KAAKuR,MAAMrQ,SAAUD,EACvCD,EAAGG,KAAKnB,KAAKuR,MAAMtQ,GAAGic,GAAGta,IAAK5C,KAAKuR,MAAMtQ,GAAG6c,GAAGlb,IAAK5C,KAAKuR,MAAMtQ,GAAGkc,GAAGva,KAEvE5C,KAAK4C,KAAMyjB,EAAAA,EAAAA,IAAqBrlB,EAKlC,CACO01B,YAAYva,GACjBnc,KAAKuR,MAAQ,GAEb,IAAK,IAAItQ,EAAI,EAAGA,EAAIkb,EAAIjb,OAAS,IAAKD,EACpCjB,KAAKuR,MAAMpQ,KAAKnB,KAAKwS,QAAQ2J,EAAIlb,GAAIkb,EAAIlb,EAAI,IAEjD,CACOuR,QAAQ0K,EAAYC,GACzB,MAAMsJ,GAAKN,EAAAA,EAAAA,IAAOjJ,EAAGta,IAAKua,EAAGva,KAEvBi0B,EAAK,IAAI9a,EAAO/b,KAAK2D,MAAO8iB,EAAGrlB,EAAGqlB,EAAGplB,EAAG,GAAG,EAAO+K,EAAAA,GAAAA,WAGxD,OAAO,IAAIwjB,EAAc5vB,KAAK2D,MAAO3D,KAAMkd,EAAI2Z,EAAI1Z,EACrD,CACO/R,eACL,GAA0B,IAAtBpL,KAAKuR,MAAMrQ,OACb,OAEF,IAAIgkB,EAAcllB,KAAKuR,MAAM,GAAG2L,GAC5B9b,EAAYkI,OAAOC,iBACvB,IAAK,IAAItI,EAAI,EAAGA,EAAIjB,KAAKuR,MAAMrQ,SAAUD,EACnCjB,KAAKuR,MAAMtQ,GAAGic,GAAGta,IAAIxB,EAAIA,IAC3B8jB,EAAMllB,KAAKuR,MAAMtQ,GAAGic,GACpB9b,EAAIpB,KAAKuR,MAAMtQ,GAAGic,GAAGta,IAAIxB,GAEvBpB,KAAKuR,MAAMtQ,GAAG6c,GAAGlb,IAAIxB,EAAIA,IAC3B8jB,EAAMllB,KAAKuR,MAAMtQ,GAAG6c,GACpB1c,EAAIpB,KAAKuR,MAAMtQ,GAAG6c,GAAGlb,IAAIxB,GAEvBpB,KAAKuR,MAAMtQ,GAAGkc,GAAGva,IAAIxB,EAAIA,IAC3B8jB,EAAMllB,KAAKuR,MAAMtQ,GAAGkc,GACpB/b,EAAIpB,KAAKuR,MAAMtQ,GAAGkc,GAAGva,IAAIxB,GAG7B,OAAO8jB,CACT,CACOuR,YAAYz1B,GACjB,MAAMmb,EAAM,GAGZ,KAJyC,yDAKvC,IAAK,IAAIlb,EAAI,EAAGA,EAAID,EAAGE,SAAUD,EAAG,CAClC,MAAMwI,EAAI,IAAIsS,EAAO/b,KAAK2D,MAAO3C,EAAGC,GAAGG,EAAGJ,EAAGC,GAAGI,GAChDoI,EAAElJ,KAAO6L,EAAAA,GAAAA,MACT3C,EAAE8H,MAAMpQ,KAAKnB,MACbyJ,EAAEtC,qBAAsB,EACxBgV,EAAIhb,KAAKsI,EACX,MAEA,IAAK,IAAIxI,EAAI,EAAGA,EAAID,EAAGE,SAAUD,EAAG,CAClC,MAAMwI,EAAIsS,EAAOQ,qBAAqBvc,KAAK2D,MAAO3C,EAAGC,IACrDwI,EAAElJ,KAAO6L,EAAAA,GAAAA,MACT3C,EAAEtC,qBAAsB,EACxBsC,EAAE8H,MAAMpQ,KAAKnB,MACbmc,EAAIhb,KAAKsI,EACX,CAEF,OAAO0S,CACT,CACO2a,oBAAoBxpB,EAAkBypB,GAC3C,MAAM91B,EAAIjB,KAAKuR,MAAMkB,QAAQnF,GAC7BtN,KAAKuR,MAAM6L,OAAOnc,EAAG,GACrB,IAAK,IAAIib,EAAI,EAAGA,EAAI6a,EAAG71B,SAAUgb,EAC/Blc,KAAKuR,MAAM6L,OAAOnc,EAAG,EAAG81B,EAAG7a,GAE/B,CACOxJ,WAAWpF,GAChBtN,KAAKuR,MAAM6L,OAAOpd,KAAKuR,MAAMkB,QAAQnF,GAAI,EAK3C,CACO0pB,SAASvtB,GAEd,CAEKgH,SAA+B,IAAxB5J,IAAQ,yDACpB,GAAI7G,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,cAC9C,OAGF,GAAIrG,KAAK2D,MAAMmb,SAAW9e,KAAK2D,MAAMmb,QAAQve,OAAS6L,EAAAA,GAAAA,MAAa,CACjE,MAAM3C,EAAIzJ,KAAK2D,MAAMmb,QAErB,GAAIrV,EAAE+S,OAAO,IAAM/S,EAAE+S,OAAO,GAAI,CAE9B,MAAMya,EAAKxtB,EAAE+S,OAAO,GAAGU,KAAOzT,EAAIA,EAAE+S,OAAO,GAAGW,GAAK1T,EAAE+S,OAAO,GAAGU,GACzDga,EAAKztB,EAAE+S,OAAO,GAAGU,KAAOzT,EAAIA,EAAE+S,OAAO,GAAGW,GAAK1T,EAAE+S,OAAO,GAAGU,GAE/D,IAAIia,EAAyB,GAC7BF,EAAGza,OAAOwJ,SAAS1Y,IACbA,EAAE4P,KAAOzT,GAAK6D,EAAE6P,KAAO1T,GACzB0tB,EAAMh2B,KAAKmM,EACb,IAEF2pB,EAAGza,OAAS2a,EAEZA,EAAQ,GACRD,EAAG1a,OAAOwJ,SAAS1Y,IACbA,EAAE4P,KAAOzT,GAAK6D,EAAE6P,KAAO1T,GACzB0tB,EAAMh2B,KAAKmM,EACb,IAEF4pB,EAAG1a,OAAS2a,EAEZ,MAAMC,EAAgBp3B,KAAKuR,MAAM8lB,YAAY5tB,EAAE+S,OAAO,IAChD8a,EAAkBt3B,KAAKuR,MAAM8lB,YAAY5tB,EAAE+S,OAAO,IAElDwB,EAAKhe,KAAKwS,QAAQykB,EAAIC,GACtBK,EAAcH,EAAgBE,EAAkBF,EAAgBE,EACtEt3B,KAAKuR,MAAM6L,OAAOma,EAAa,EAAGvZ,GAElCvU,EAAE+S,OAAO,GAAGsB,GAAGC,aACftU,EAAE+S,OAAO,GAAGsB,GAAGC,aAEf/d,KAAKuR,MAAM6L,OAAOpd,KAAKuR,MAAMkB,QAAQhJ,EAAE+S,OAAO,IAAK,GACnDxc,KAAKuR,MAAM6L,OAAOpd,KAAKuR,MAAMkB,QAAQhJ,EAAE+S,OAAO,IAAK,EACrD,MAAO,GAAI/S,EAAE+S,OAAO,GAAI,CAEtB,MAAMya,EAAKxtB,EAAE+S,OAAO,GAAGU,KAAOzT,EAAIA,EAAE+S,OAAO,GAAGW,GAAK1T,EAAE+S,OAAO,GAAGU,GAEzDia,EAAyB,GAC/BF,EAAGza,OAAOwJ,SAAS1Y,IACbA,EAAE4P,KAAOzT,GAAK6D,EAAE6P,KAAO1T,GACzB0tB,EAAMh2B,KAAKmM,EACb,IAEF2pB,EAAGza,OAAS2a,EAEZ1tB,EAAE+S,OAAO,GAAGsB,GAAGC,aACf/d,KAAKuR,MAAM6L,OAAOpd,KAAKuR,MAAMkB,QAAQhJ,EAAE+S,OAAO,IAAK,EAGrD,CAKA,GAJA/S,EAAEsU,aACF/d,KAAKkyB,oBACLlyB,KAAKke,mBACLle,KAAK8P,kBACDjJ,EAAU,CACZ,MAAMuX,EAAQpe,KAAKwJ,SACf4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB,CAACvG,GAElF,CACA,MACF,CACA,IAAInd,EAAIjB,KAAKuR,MAAMrQ,OACnB,KAAOD,KACLjB,KAAKuR,MAAMtQ,GAAGwP,SAEhB,GAAI5J,EAAU,CACZ,MAAMuX,EAAQpe,KAAKwJ,SACf4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB,CAACvG,GAElF,CACApe,KAAK+d,YACP,CACOA,aACL/d,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EACpBhC,KAAK4M,mBAGL5M,KAAK2D,MAAM6zB,4BAA4Bx3B,MACvCA,KAAK2D,MAAM8a,eAAeze,KAC5B,CACOy3B,mBAIL,CAEKxZ,aAOL,CAEKyZ,6BAA6B12B,GAKlC,CAEK8R,SACL,OAAO9S,KAAKO,IACd,CACO2P,gBACLlQ,KAAKgG,cAAe,EACpBhG,KAAKuH,eAAgB,EACrBvH,KAAKuR,MAAMyU,SAAS1Y,IAClBA,EAAE4P,GAAGhN,gBACL5C,EAAEwQ,GAAG5N,gBACL5C,EAAE6P,GAAGjN,eAAe,GAGxB,CACO2C,cAAczR,EAAWC,GAC9B,IAAI+I,GAAU,EACd,IAAK,IAAInJ,EAAI,EAAGA,EAAIjB,KAAKuR,MAAMrQ,SAAUD,EACnCjB,KAAKuR,MAAMtQ,GAAG4R,cAAczR,EAAGC,KACjC+I,GAAU,GAId,GAAIpK,KAAKs2B,UAAW,CAClB,MAAMz0B,EAAS7B,KAAKs2B,UAAU,GAAGl1B,EAAIpB,KAAKuR,MAAM,GAAG2L,GAAGta,IAAIxB,EAC1D,IAAK,IAAIH,EAAI,EAAGA,EAAIjB,KAAKuR,MAAMrQ,SAAUD,EACnCjB,KAAKuR,MAAMtQ,GAAG4R,cAAczR,EAAIS,EAAQR,KAC1C+I,GAAU,EAGhB,CAEA,IAAK,IAAInJ,EAAI,EAAGA,EAAIjB,KAAKuR,MAAMrQ,SAAUD,EACvCjB,KAAKuR,MAAMtQ,GAAG2wB,QAAUxnB,EAE1B,OAAOA,CACT,CACOutB,kBAAkBv2B,EAAWC,GAIlC,OAAO,CACT,CACOkjB,wBACL,IAAK,IAAItjB,EAAI,EAAGA,EAAIjB,KAAKuR,MAAMrQ,SAAUD,EAAG,CAC1C,GAAIjB,KAAKuR,MAAMtQ,GAAGic,KAAOld,KAAK2D,MAAMgP,QAClC,OAAO,EAET,GAAI3S,KAAKuR,MAAMtQ,GAAG6c,KAAO9d,KAAK2D,MAAMgP,QAClC,OAAO,EAET,GAAI3S,KAAKuR,MAAMtQ,GAAGkc,KAAOnd,KAAK2D,MAAMgP,QAClC,OAAO,CAEX,CACA,OAAO,CACT,CACOO,0BAA0B5F,GAC/B,IAAItN,KAAKukB,wBAAT,CAGAvkB,KAAK43B,eAGL,IAAK,IAAI32B,EAAI,EAAGA,EAAIjB,KAAKuR,MAAMrQ,SAAUD,EAEvCjB,KAAKuR,MAAMtQ,GAAGiS,0BAA0B5F,EAN1C,CASF,CACOuqB,2CAA2CvqB,GAChD,CAEKoD,iBAEL1Q,KAAK2D,MAAMC,mBAAmBuS,eAAe2M,eAAe+D,iBAC5D7mB,KAAKuL,kBACP,CACOgI,UAAUnS,EAAWC,GACrB,CAEA8L,oBAEP,CAqBO8F,OACA,CAEAqiB,mBACDt1B,KAAKmH,mBAiDX,CACO2wB,0BAA0BC,EAAYC,GACvCD,EAAGj2B,YAGPi2B,EAAGj2B,WAAY,EACjB,CACO0N,WAAW9L,GAChB1D,KAAKmF,SAASqK,WAAW9L,EAC3B,CACOiJ,UACL,MAAM+S,EAAO,GACb,IAAK,IAAIze,EAAI,EAAGA,EAAIjB,KAAKuR,MAAMrQ,SAAUD,EACnCA,IAAMjB,KAAKuR,MAAMrQ,OAAS,GAE5Bwe,EAAKve,KAAKnB,KAAKuR,MAAMtQ,GAAGic,GAAGta,KAC3B8c,EAAKve,KAAKnB,KAAKuR,MAAMtQ,GAAG6c,GAAGlb,KAC3B8c,EAAKve,KAAKnB,KAAKuR,MAAMtQ,GAAGkc,GAAGva,OAG3B8c,EAAKve,KAAKnB,KAAKuR,MAAMtQ,GAAGic,GAAGta,KAC3B8c,EAAKve,KAAKnB,KAAKuR,MAAMtQ,GAAG6c,GAAGlb,MAG/B,OAAO8c,CACT,CACO8W,cAAcx1B,GAA6B,yDAK5CkM,EAAAA,EAAAA,IAAYlM,EAAG,GAAIA,EAAGA,EAAGE,OAAS,IAAM,KAC1ClB,KAAKgjB,UAAW,EAChBhjB,KAAKO,KAAO6L,EAAAA,GAAAA,SALZpM,KAAKgjB,UAAW,CAOpB,CACO5Z,UACL,MAAMpI,EAAK,GACX,IAAK,IAAIC,EAAI,EAAGA,EAAIjB,KAAKuR,MAAMrQ,SAAUD,EACnCA,IAAMjB,KAAKuR,MAAMrQ,OAAS,GAC5BF,EAAGG,KAAKnB,KAAKuR,MAAMtQ,GAAGic,GAAGta,KACzB5B,EAAGG,KAAKnB,KAAKuR,MAAMtQ,GAAG6c,GAAGlb,KACzB5B,EAAGG,KAAKnB,KAAKuR,MAAMtQ,GAAGkc,GAAGva,OAEzB5B,EAAGG,KAAKnB,KAAKuR,MAAMtQ,GAAGic,GAAGta,KACzB5B,EAAGG,KAAKnB,KAAKuR,MAAMtQ,GAAG6c,GAAGlb,MAG7B,OAAO5B,CACT,CACOwI,SACL,MAAMC,EAAI,IAAIpJ,EAAWL,KAAKM,GAAIN,KAAKO,KAAMP,KAAK+F,gBAAiB/F,KAAK4F,aAAc5F,KAAKqG,eAC3FoD,EAAE1I,SAASf,KAAKoJ,WAEhB,MAAMvI,EAASb,KAAKqD,eAAeoQ,SAKnC,OAJI5S,IACF4I,EAAE5I,OAASA,GAGN4I,CACT,CACOsG,SAAS3O,EAAWC,GACzB,MAAM+M,EAAIpO,KAAKwJ,SACf,GAAI4E,EAAG,CACL,MAAM6pB,EAAKpC,EAAsBzlB,SAASpQ,KAAK2D,MAAOyK,GAAG,GAAO,GAMhE,OALA6pB,EAAG7qB,KAAKhM,EAAGC,GAKJ42B,CACT,CAEF,CACO/F,oBACDlyB,KAAKuR,MAAMrQ,OAAS,IACtBlB,KAAKuR,MAAQvR,KAAKk4B,eAEtB,CACO/nB,2BACL,IAAK,IAAIlP,EAAI,EAAGA,EAAIjB,KAAKuR,MAAMrQ,SAAUD,EACvCjB,KAAKuR,MAAMtQ,GAAGmgB,cAElB,CACQwW,eACN53B,KAAKuR,MAAMyU,SAAS1Y,IAClBA,EAAE4P,GAAGpb,WAAY,EACjBwL,EAAEwQ,GAAGhc,WAAY,EACjBwL,EAAE6P,GAAGrb,WAAY,CAAK,GAE1B,CACQo2B,eACN,MAAMlnB,EAAO,CAAChR,KAAKuR,MAAM,IAEzB,IAAI4mB,EAAY,IACZC,EAAoBp4B,KAAKuR,MAAM,GAE/BiF,EAA0C,IAAnCxW,KAAKuR,MAAM,GAAG2L,GAAGV,OAAOtb,OAAelB,KAAKuR,MAAM,GAAG4L,GAAKnd,KAAKuR,MAAM,GAAG2L,GACnF,KAAO1G,GACsB,IAAvBA,EAAKgG,OAAOtb,SACdk3B,EAAK5hB,EAAKgG,OAAO,KAAO4b,EAAK5hB,EAAKgG,OAAO,GAAKhG,EAAKgG,OAAO,GAC1DxL,EAAK7P,KAAKi3B,GACV5hB,EAAOA,IAAS4hB,EAAGlb,GAAKkb,EAAGjb,GAAKib,EAAGlb,GAIrCib,MACIA,EAAY,MAIlB,OAAOnnB,CACT,CACO+Y,8BACL,IAAK,MAAMzc,KAAKtN,KAAKuR,MAAO,CAC1B,GAAIjE,EAAE4P,GAAG5S,gBAAkBgD,EAAE4P,GAAG5S,eAAe+I,WAAY,CACzD,IAAInG,EAAAA,EAAAA,IAAYI,EAAE4P,GAAGta,IAAK0K,EAAE4P,GAAG5S,eAAe+I,WAAWC,IAAM,EAC7D,OAAO,EAEThG,EAAE4P,GAAG5S,eAAe2f,mBAAgBtnB,EACpC2K,EAAE4P,GAAG5S,oBAAiB3H,CACxB,CACA,GAAI2K,EAAEwQ,GAAGxT,gBAAkBgD,EAAEwQ,GAAGxT,eAAe+I,WAAY,CACzD,IAAInG,EAAAA,EAAAA,IAAYI,EAAEwQ,GAAGlb,IAAK0K,EAAEwQ,GAAGxT,eAAe+I,WAAWC,IAAM,EAC7D,OAAO,EAEThG,EAAEwQ,GAAGxT,eAAe2f,mBAAgBtnB,EACpC2K,EAAEwQ,GAAGxT,oBAAiB3H,CACxB,CACA,GAAI2K,EAAE6P,GAAG7S,gBAAkBgD,EAAE6P,GAAG7S,eAAe+I,WAAY,CACzD,IAAInG,EAAAA,EAAAA,IAAYI,EAAE6P,GAAGva,IAAK0K,EAAE6P,GAAG7S,eAAe+I,WAAWC,IAAM,EAC7D,OAAO,EAEThG,EAAE6P,GAAG7S,eAAe2f,mBAAgBtnB,EACpC2K,EAAE6P,GAAG7S,oBAAiB3H,CACxB,CACF,CACA,OAAO,CACT,CACOye,eACL,IAAK,IAAIngB,EAAI,EAAGA,EAAIjB,KAAKuR,MAAMrQ,SAAUD,EACvC,IAAKjB,KAAKuR,MAAMtQ,GAAGswB,SAAU,CAC3B,MAAM9K,GAAKN,EAAAA,EAAAA,IAAOnmB,KAAKuR,MAAMtQ,GAAGic,GAAGta,IAAK5C,KAAKuR,MAAMtQ,GAAGkc,GAAGva,KACzD5C,KAAKuR,MAAMtQ,GAAG6c,GAAGlb,IAAIxB,EAAIqlB,EAAGrlB,EAC5BpB,KAAKuR,MAAMtQ,GAAG6c,GAAGlb,IAAIvB,EAAIolB,EAAGplB,CAC9B,CAEJ,EAv3BWw0B,EACGwC,SAAU,EClBnB,MAAMC,EACX,iBAAwB30B,EAAc2J,GACpC,MAAMuV,EAAsBlf,EAAMC,mBAAmBuS,eAAe2M,eAAeb,YACjF3U,GAEEuV,GACFA,EAAKpS,QAET,CACA,iBAAwBnD,GACtB,CAEFzN,cACO,ECbF,MAAM04B,EAYX14B,YAAY8D,GAAe,KARpBA,WAAK,OACL+hB,QAAE,OACFC,QAAE,OACFjG,UAAI,OACJ8Y,cAAQ,OACRjuB,OAAC,OAEDkuB,gBAAU,EAEfz4B,KAAK2D,MAAQA,EACb3D,KAAK0f,KAAO,GACZ1f,KAAKw4B,UAAW,EAChBx4B,KAAKuK,EAAI,EAETvK,KAAKy4B,WAAa,IAAIp2B,EAAAA,GAAS,EAAG,EACpC,CACOq2B,uBAAuBt3B,EAAWC,GAClC,CAEAs3B,QAAQv3B,EAAWC,GACxBrB,KAAK0f,KAAKve,KAAK,IAAIkB,EAAAA,GAASjB,EAAGC,GACjC,CACOoP,SACA,CAEA8R,cAC2B5f,IAA5B41B,EAAWlW,cACbkW,EAAWlW,aAAa5R,SAE1B8nB,EAAWlW,kBAAe1f,CAC5B,CAEOugB,WAAW5V,QACgB3K,IAA5B41B,EAAWlW,cAIbkW,EAAWlW,aAAaqW,uBAAuBprB,EAAElM,EAAGkM,EAAEjM,EAE1D,CACOmmB,UAAUla,GACftN,KAAK0lB,GAAK,IAAIrjB,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,GAC9BrB,KAAKy4B,WAAWr3B,GAAK,IACrBpB,KAAKy4B,WAAWp3B,GAAK,IACrBk3B,EAAWK,qBAAsB,CACnC,CACOC,UAAUvrB,GACXirB,EAAWO,QACb94B,KAAK24B,QAAQrrB,EAAElM,EAAGkM,EAAEjM,GAEpBrB,KAAK2lB,GAAK,IAAItjB,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,EAElC,CACOuP,QAAQtD,GAGb,GAFAtN,KAAK2D,MAAMC,mBAAmBuS,eAAe+X,cAAc6K,yBAEvDR,EAAWO,QAAS,CACtB,GAAI94B,KAAK0f,KAAKxe,OAAS,EACrB,OAEFlB,KAAK2D,MAAMC,mBAAmBuS,eAAe+X,cAAc8K,sBACzDxE,EAAAA,EAAAA,IAAoBx0B,KAAK0f,OAE3B1f,KAAK0f,KAAO,EACd,KAAO,CACL,QAAgB/c,IAAZ3C,KAAK0lB,SAAgC/iB,IAAZ3C,KAAK2lB,GAChC,OAEF3lB,KAAK2D,MAAMC,mBAAmBuS,eAAe+X,cAAc8K,sBACzDC,EAAAA,EAAAA,IAAgBj5B,KAAK0lB,GAAI1lB,KAAK2lB,IAC9B3lB,KAAKw4B,UAEPx4B,KAAK0lB,QAAK/iB,EACV3C,KAAK2lB,QAAKhjB,CACZ,CAEF,CACOkyB,UAAUvnB,GACftN,KAAKy4B,WAAWr3B,EAAIkM,EAAElM,EACtBpB,KAAKy4B,WAAWp3B,EAAIiM,EAAEjM,CACxB,CAEOoC,OAAOC,GAKZ,GAJI60B,EAAWK,oBAIXL,EAAWO,QAAS,CACtB,GAAI94B,KAAK0f,KAAKxe,OAAS,EACrB,OAEFlB,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2iB,UAAUC,eAC1Dz1B,EACA1D,KAAK0f,MACL,EACA1f,KAAKuK,EAET,KAAO,CACL,QAAgB5H,IAAZ3C,KAAK0lB,SAAgC/iB,IAAZ3C,KAAK2lB,GAChC,OAEE3lB,KAAK0lB,GAAGtkB,EAAIpB,KAAK2lB,GAAGvkB,GAAKpB,KAAK0lB,GAAGrkB,EAAIrB,KAAK2lB,GAAGtkB,EAC/CrB,KAAKw4B,UAAW,EAEhBx4B,KAAKw4B,UAAW,EAGlBx4B,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2iB,UAAUA,UAC1Dx1B,EACA1D,KAAK0lB,GACL1lB,KAAK2lB,GACL3lB,KAAKw4B,SACLx4B,KAAKuK,EAET,CACAvK,KAAKuK,GAAK,EACZ,EAxHWguB,EACGlW,kBAAY,EADfkW,EAEGO,SAAU,EAFbP,EAGGK,qBAAsB,ECD/B,MAAMQ,EAETv5B,YAAYw5B,GAA8C,KAD1DA,wBAAkB,EAEhBr5B,KAAKq5B,mBAAqBA,CAC5B,CACOC,SAASC,GACd,MAAMC,EAAKx5B,KAAKq5B,mBAAmBI,UAAUC,IAAIlE,aAAa/lB,cAAckqB,SAASC,iBAAiBL,EAAEM,IAAIC,eAC5G,YAAWn3B,IAAP62B,GAAoBD,EAAEQ,aAAeP,EAAGQ,YAAcT,EAAEU,cAAgBT,EAAGU,WAC7El6B,KAAKq5B,mBAAmBI,UAAUC,IAAIS,iBAAiBX,EAAGjsB,KACnD,EAGX,CACO6sB,cAEHp6B,KAAKq5B,mBAAmBI,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,UAC/Cr6B,KAAKq5B,mBAAmBI,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,SAC/Cr6B,KAAKq5B,mBAAmBI,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,WAC/Cr6B,KAAKq5B,mBAAmBI,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,UAC/Cr6B,KAAKq5B,mBAAmBI,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,kBAC/Cr6B,KAAKq5B,mBAAmBI,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,eAE/Cr6B,KAAKq5B,mBAAmBI,UAAUC,IAAIY,cAAcxF,OAEtD90B,KAAKq5B,mBAAmBI,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAeyX,4BACjFv6B,KAAKq5B,mBAAmBI,UAAUC,IAAIlE,aAAarf,eAAeC,eAAevH,aACnF,CACO2rB,WACLx6B,KAAKq5B,mBAAmBI,UAAUC,IAAIlE,aAAarf,eAAe+X,cAAcuM,sBAChFz6B,KAAKq5B,mBAAmBI,UAAUC,IAAIlE,aAAarf,eAAe+X,cAAc6K,yBAChF/4B,KAAKq5B,mBAAmBI,UAAUC,IAAIprB,aAAa4H,UAAW,EAC9DlW,KAAKq5B,mBAAmBI,UAAUC,IAAIlX,aACtCxiB,KAAKq5B,mBAAmBI,UAAUC,IAAIlE,aAAarf,eAAeC,eAAevH,aACnF,EC7BG,MAAM6rB,EAGX76B,YAAY86B,GAAkD,KAFvDlB,eAAS,OACTmB,4BAAsB,EAE3B56B,KAAKy5B,UAAYkB,EACjB36B,KAAK46B,uBAAyB,IAAIxB,EAAuBp5B,KAE3D,CACO66B,wBAAwBtB,GAC7B,OAAQA,EAAEuB,YACR,KAAKC,EAAAA,GAAAA,KACH/6B,KAAKg7B,WAAWzB,GAChB,MACF,KAAKwB,EAAAA,GAAAA,GACH/6B,KAAKi7B,SAAS1B,GAKpB,CACO2B,oCAAoC3B,GACzC,OAAQA,EAAEuB,YACR,KAAKC,EAAAA,GAAAA,KACH/6B,KAAKm7B,uBAAuB5B,GAC5B,MACF,KAAKwB,EAAAA,GAAAA,GACH/6B,KAAKo7B,qBAAqB7B,GAKhC,CACQyB,WAAWzB,GASjB,GAPAv5B,KAAKy5B,UAAUC,IAAIprB,aAAa6P,UAAW,EAIvCob,EAAEQ,aACJ/5B,KAAKy5B,UAAUC,IAAIprB,aAAaqQ,cAAe,GAE7C4a,EAAEU,aAAeV,EAAEQ,YAA4B,KAAdR,EAAE8B,QACrCr7B,KAAKy5B,UAAUC,IAAIlE,aAAa8F,WAAWC,YAAYC,gBAGzD,GAAIjC,EAAEU,aAAeV,EAAEQ,YAA4B,KAAdR,EAAE8B,QACrCr7B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAI23B,0BAGtD,IAAIz7B,KAAK46B,uBAAuBtB,SAASC,GAIzC,GACGv5B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAI43B,aACrDnC,EAAEU,aACY,KAAdV,EAAE8B,QAKJ,GACGr7B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAI43B,aACrDnC,EAAEU,aACY,KAAdV,EAAE8B,QAKJ,GACGr7B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAI43B,aACrDnC,EAAEU,aACY,KAAdV,EAAE8B,QAKJ,GACGr7B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAI43B,aACrDnC,EAAEU,aACY,KAAdV,EAAE8B,QAHJ,CAQA,IAAI9B,EAAEU,aAA6B,KAAdV,EAAE8B,QAIvB,OAAI9B,EAAEU,aAA6B,KAAdV,EAAE8B,SAErBr7B,KAAKy5B,UAAUC,IAAIlE,aAAahqB,wBAAwB2uB,iBACtDE,EAAAA,GAAAA,aAEFr6B,KAAKy5B,UAAUC,IAAIlE,aAAarf,eAAeC,eAAevH,eAG5D0qB,EAAEU,aAA6B,KAAdV,EAAE8B,SAErBr7B,KAAKy5B,UAAUC,IAAIlE,aAAahqB,wBAAwB2uB,iBACtDE,EAAAA,GAAAA,gBAEFr6B,KAAKy5B,UAAUC,IAAIlE,aAAarf,eAAeC,eAAevH,eAG5D0qB,EAAEU,aAA6B,KAAdV,EAAE8B,SAErBr7B,KAAKy5B,UAAUC,IAAIlE,aAAa8F,WAAWC,YAAYI,iBACvD37B,KAAKy5B,UAAUC,IAAIlE,aAAarf,eAAeC,eAAevH,oBAK7D7O,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAI43B,aACrDnC,EAAEU,aACY,KAAdV,EAAE8B,QAODr7B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAI43B,aACrDnC,EAAEU,aACY,KAAdV,EAAE8B,QAODr7B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAI43B,aACrDnC,EAAEU,aACY,KAAdV,EAAE8B,SAiBc,KAAd9B,EAAE8B,QACJr7B,KAAKy5B,UAAUC,IAAIlE,aAAa5mB,oBAAoBmD,cAAcC,QAAQ4pB,YACnD,KAAdrC,EAAE8B,QACXr7B,KAAKy5B,UAAUC,IAAIlE,aAAa5mB,oBAAoBmD,cAAcC,QAAQ6pB,YACnD,KAAdtC,EAAE8B,QACXr7B,KAAKy5B,UAAUC,IAAIlE,aAAa5mB,oBAAoBmD,cAAcC,QAAQ8pB,YACnD,KAAdvC,EAAE8B,QACXr7B,KAAKy5B,UAAUC,IAAIlE,aAAa5mB,oBAAoBmD,cAAcC,QAAQ+pB,YACnD,KAAdxC,EAAE8B,QACXr7B,KAAKy5B,UAAUC,IAAIlE,aAAa5mB,oBAAoBmD,cAAcC,QAAQgqB,YACnD,KAAdzC,EAAE8B,SACXr7B,KAAKy5B,UAAUC,IAAIlE,aAAa5mB,oBAAoBmD,cAAcC,QAAQiqB,YAM1Ej8B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBACtEC,OAASC,EAAAA,GAAAA,UAKTsjB,EAAEU,aAA6B,IAAdV,EAAE8B,SAAmB9B,EAAEU,aAAeV,EAAE8B,SAAyB,KAAd9B,EAAE8B,QACzEr7B,KAAKy5B,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAeoZ,YAG9C,IAAd3C,EAAE8B,SAA+B,KAAd9B,EAAE8B,SAMvBr7B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeqmB,cACtEC,cAAgBC,EAAAA,GAAAA,aAED,IAAd9C,EAAE8B,SAAiB9B,EAAEU,cACvBj6B,KAAKy5B,UAAUC,IAAIprB,aAAaguB,cAC5Bt8B,KAAKy5B,UAAUC,IAAIprB,aAAaguB,YAAc,IAAM,EACtDt8B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAAoBC,KAC3FC,EAAAA,GAAAA,QACOjW,KAAKy5B,UAAUC,IAAIprB,aAAaguB,YAAc,IAAM,EAC7Dt8B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAAoBC,KAC3FC,EAAAA,GAAAA,kBACOjW,KAAKy5B,UAAUC,IAAIprB,aAAaguB,YAAc,IAAM,IAC7Dt8B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAAoBC,KAC3FC,EAAAA,GAAAA,eAEJjW,KAAKy5B,UAAUC,IAAIS,iBAAiBE,EAAAA,GAAAA,MACpCr6B,KAAKy5B,UAAUC,IAAIlE,aAAa8F,WAAWC,YAAYgB,UACrDv8B,KAAKy5B,UAAUC,IAAIjc,EAAErc,EACrBpB,KAAKy5B,UAAUC,IAAIjc,EAAEpc,IAGrBk4B,EAAEU,aAA6B,KAAdV,EAAE8B,SACrBr7B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAMyW,UAAU+Z,WAElEjD,EAAEU,aAA6B,KAAdV,EAAE8B,SACrBr7B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAMyW,UAAUga,OAGpD,KAAdlD,EAAE8B,SACJr7B,KAAKy5B,UAAUC,IAAIlE,aAAa8F,WAAWC,YAAYmB,aAavDnD,EAAEU,cACJj6B,KAAKy5B,UAAUC,IAAIprB,aAAayQ,YAAa,GAE3Cwa,EAAEoD,YACJ38B,KAAKy5B,UAAUC,IAAIprB,aAAasuB,aAAc,EAC9C58B,KAAKy5B,UAAUC,IAAIprB,aAAauuB,oBAAqB,IAIrD78B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBACtEC,OAASC,EAAAA,GAAAA,eACXjW,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBACvE+mB,wBAAwBC,WAKX,KAAdxD,EAAE8B,SACJr7B,KAAKy5B,UAAUC,IAAIlE,aAAa8F,WAAWC,YAAYyB,aAGvDh9B,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBACtEC,OAASC,EAAAA,GAAAA,mBACXjW,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBACvE+mB,wBAAwBC,WAKX,KAAdxD,EAAE8B,SACJr7B,KAAKy5B,UAAUC,IAAIlE,aAAa8F,WAAWC,YAAY0B,eAEvC,KAAd1D,EAAE8B,SACJr7B,KAAKy5B,UAAUC,IAAIlE,aAAa8F,WAAWC,YAAY2B,iBAEvC,KAAd3D,EAAE8B,SACJr7B,KAAK46B,uBAAuBJ,WAEZ,KAAdjB,EAAE8B,QAKY,KAAd9B,EAAE8B,SAIF9B,EAAEU,aAA6B,KAAdV,EAAE8B,SACrBr7B,KAAKy5B,UAAUC,IAAIlE,aAAarf,eAAe+X,cAAciP,oBAG1D5D,EAAEoD,WAAapD,EAAE6D,gBAAkB7D,EAAEQ,aAA6B,KAAdR,EAAE8B,SACzDr7B,KAAKy5B,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAeua,eAG5D9D,EAAEoD,WAAapD,EAAE6D,gBAAkB7D,EAAEQ,aAA6B,KAAdR,EAAE8B,SAC1C,KAAd9B,EAAE8B,UAIFr7B,KAAKy5B,UAAUC,IAAIY,cAAcxF,QAE9ByE,EAAEoD,WAAapD,EAAE6D,gBAAkB7D,EAAEQ,aAA6B,KAAdR,EAAE8B,UAEzDr7B,KAAKy5B,UAAUC,IAAIlE,aAAarf,eAAemnB,gBAAgBC,YAC7Dv9B,KAAKy5B,UAAUC,IAAIlE,aAAahqB,wBAAwBiS,EAAErc,EAC1DpB,KAAKy5B,UAAUC,IAAIlE,aAAahqB,wBAAwBiS,EAAEpc,GAE5DrB,KAAKy5B,UAAUC,IAAIS,iBAAiBE,EAAAA,GAAAA,OAItCr6B,KAAKy5B,UAAU+D,QAAQjE,GACvBv5B,KAAKy5B,UAAUC,IAAIlE,aAAarf,eAAeC,eAAevH,eA7B5D7O,KAAKy5B,UAAUC,IAAIlE,aAAa8F,WAAWC,YAAYkC,6BALvDz9B,KAAKy5B,UAAUC,IAAIlE,aAAahqB,wBAAwB8C,aAAaovB,MAAQ19B,KAAKy5B,UAC/EC,IAAIlE,aAAahqB,wBAAwB8C,aAAaovB,QAvFzD19B,KAAK46B,uBAAuBR,gBA1C5Bp6B,KAAKy5B,UAAUC,IAAIlE,aAAa8F,WAAWC,YAAYoC,YATvD39B,KAAKy5B,UAAUC,IAAIlE,aAAa8F,WAAWC,YAAYqC,4BATvD59B,KAAKy5B,UAAUC,IAAIlE,aAAa8F,WAAWC,YAAYsC,uBAhCvD79B,KAAKy5B,UAAUC,IAAIoE,wBAFrB,MAFE99B,KAAKy5B,UAAUC,IAAIlE,aAAa8F,WAAWC,YAAYwC,0BARvD/9B,KAAKy5B,UAAUC,IAAIlE,aAAa8F,WAAWC,YAAYyC,+BARvDh+B,KAAKy5B,UAAUC,IAAIlE,aAAa8F,WAAWC,YAAY0C,oCARvDj+B,KAAKy5B,UAAUC,IAAIlE,aAAa8F,WAAWC,YAAY2C,oBAiP3D,CACQjD,SAAS1B,GACG,KAAdA,EAAE8B,UACJr7B,KAAKy5B,UAAUC,IAAIprB,aAAa4H,UAAW,GAE3B,KAAdqjB,EAAE8B,UACJr7B,KAAKy5B,UAAUC,IAAIprB,aAAayQ,YAAa,GAG/C/e,KAAKy5B,UAAUC,IAAIprB,aAAaqQ,cAAe,EAE/C3e,KAAKy5B,UAAU0E,MAAM5E,GACrBv5B,KAAKy5B,UAAUC,IAAIprB,aAAa6P,UAAW,CAC7C,CACQgd,uBAAuB5B,GAQ7B,OAPAv5B,KAAKy5B,UAAUC,IAAIprB,aAAa6P,UAAW,EAC3Cne,KAAKy5B,UAAUC,IAAIprB,aAAayQ,WAAawa,EAAEU,YAC/Cj6B,KAAKy5B,UAAUC,IAAIprB,aAAaqQ,aAAe4a,EAAEQ,WAKzCR,EAAEM,KAER,IAAK,YAGL,IAAK,SACH75B,KAAK46B,uBAAuBR,cAC5B,MACF,IAAK,SACHp6B,KAAK46B,uBAAuBJ,WASlC,CACQY,qBAAqB7B,GAC3Bv5B,KAAKy5B,UAAUC,IAAIprB,aAAa6P,UAAW,EAC3Cne,KAAKy5B,UAAUC,IAAIprB,aAAayQ,WAAawa,EAAEU,YAC/Cj6B,KAAKy5B,UAAUC,IAAIprB,aAAaqQ,aAAe4a,EAAEQ,UACnD,EC/VK,MAAMqE,GAEXv+B,YAAYw+B,GAA6C,KADlDC,QAAE,EAEPt+B,KAAKs+B,GAAKD,CACZ,CACOE,aAAajxB,GAClB,CAEKkxB,kBAAkBlxB,GACvB,CAEKmxB,oBAAoBnxB,GACzB,CAEKoxB,mBAAmBpxB,GACxB,CAEKqxB,WAAWrxB,GAChB,CAEKsxB,oBAAoBtxB,GACzB,CAEKuxB,aAAavxB,GAClB,CAEKwxB,aAAaxxB,GAClB,CAEKyxB,cAAczxB,GACnB,ECnBG,MAAM0xB,WAAkCZ,GAE7Cv+B,YAAYw+B,GACVn5B,MAAMm5B,GAAsB,KAFtBY,WAAa,CAGrB,CACOV,aAAajxB,GAGdtN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIC,YACzD/D,KAAKs+B,GAAG7E,UAAUC,IAAIwF,UAAU/9B,KAAK,gBAKrCnB,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,QAC/Br6B,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAa6wB,oBAGnCn/B,KAAKs+B,GAAGc,oBAAoB9xB,GAG9B,MAAM1J,EAAqB5D,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAiBjD,GAdAx1B,KAAKs+B,GAAGe,SAASj+B,EAAIkM,EAAElM,EACvBpB,KAAKs+B,GAAGe,SAASh+B,EAAIiM,EAAEjM,EACvBiM,EAAItN,KAAKs+B,GAAG7E,UAAUC,IAAI4F,YAAYhyB,GAElC1J,EAAmBuB,SAASqL,YAC9B5M,EAAmBuB,SAASqL,UAAU+uB,YAAa,GAErD37B,EAAmB4H,wBAAwB8C,aAAakxB,QAAS,EACjE57B,EAAmB4H,wBAAwB8C,aAAamxB,MAAO,EAE/Dz/B,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAaoxB,sBAAuB,EAItD97B,EAAmB4H,wBAAwB8C,aAAaqxB,UAC1D/7B,EAAmB4H,wBAAwB8C,aAAaqxB,WAAY,OAItE,IAAI3/B,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAasxB,UAIpCh8B,EAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAC1D+mB,wBAAwBtV,UAyB7B,GApBAla,EAAEkyB,QAAS,EAEX57B,EAAmBuS,eAAe2M,eAAe+c,qBAE5Cj8B,EAAmBuS,eAAe2M,eAAegd,cAIlDl8B,EAAmB4H,0BACrB5H,EAAmB4H,wBAAwB8C,aAAayxB,eAAgB,EACpEn8B,EAAmBD,MAAMq8B,cAC3Bp8B,EAAmBmG,GAAGC,wBAAwBi2B,eAC5Cr8B,EAAmBD,MAAMq8B,YAAYx2B,UAEvC5F,EAAmBD,MAAMq8B,iBAAcr9B,IAOzCiB,EAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAAoBC,OAChFC,EAAAA,GAAAA,kBAFF,CAiBA,GACEjW,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAasU,8BAClC5iB,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAa4xB,UACpC,CACA,IAAIrd,EAAsBjf,EAAmBuS,eAAe2M,eAAeb,YAAY3U,GACnF6yB,EAAsBv8B,EAAmBuS,eAAe2M,eAAesd,sBAAsB9yB,GACjG,MAAM+yB,EAAOz8B,EAAmBuS,eAAe2M,eAAewd,4BAA4BhzB,GAmB1F,GAhBI+yB,IACFF,EAAOE,GAILxd,GACF7iB,KAAKugC,2CAA2C1d,EAAMvV,GAIpDuV,GAAQsd,GAAQtd,EAAKtiB,OAAS6L,EAAAA,GAAAA,mBAA2B+zB,EAAK5/B,OAAS6L,EAAAA,GAAAA,eAAuB+zB,EAAK5/B,OAAS6L,EAAAA,GAAAA,kBAC9GyW,EAAOsd,GAKLtd,GAAQA,EAAKtiB,OAAS6L,EAAAA,GAAAA,gBAAuB,CAC/CxI,EAAmBC,gBAAgBC,IAAIkI,MAAMyW,UAAUC,iBAAiBC,2BAA4B,EAGpG,MAAMtP,EAAawP,EAEjBxP,EAAW4W,eACX5W,EAAWA,aACXnG,EAAAA,EAAAA,IACEmG,EAAWA,WAAWC,GACtB,IAAIjR,EAAAA,GAASrC,KAAKs+B,GAAG7E,UAAUC,IAAIjc,EAAErc,EAAGpB,KAAKs+B,GAAG7E,UAAUC,IAAIjc,EAAEpc,IAC9D,KAEJwhB,EAAOxP,EAAW4W,cAGtB,MAEErmB,EAAmBC,gBAAgBC,IAAIkI,MAAMyW,UAAUC,iBAAiBC,2BAA4B,OAIzFhgB,IAATkgB,GAAsBA,EAAKtiB,OAAS6L,EAAAA,GAAAA,kBAClCyW,EAAKtiB,OAAS6L,EAAAA,GAAAA,iBAAyB+zB,IACzCtd,EAAOsd,GAKLtd,EAAKtiB,OAAS6L,EAAAA,GAAAA,YAAoByW,EAAKtiB,OAAS6L,EAAAA,GAAAA,eAClDyW,EAAQA,EAAgBtR,MAAM,IAI5B3N,EAAmBD,MAAMmb,UAEtB9e,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAayQ,YAClCnb,EAAmBD,MAAMmb,QAAQte,aACnCoD,EAAmBD,MAAMmb,QAAQte,YAAa,GAGlDoD,EAAmBD,MAAMmb,QAAQrY,iBAAkB,GAGrD7C,EAAmBD,MAAMmb,QAAU+D,EACnCjf,EAAmBD,MAAMmb,QAAQrY,iBAAkB,IAI/C7C,EAAmBD,MAAMmb,UAC3Blb,EAAmBD,MAAMmb,QAAQrY,iBAAkB,GAErD7C,EAAmBD,MAAMmb,aAAUnc,EAOvC,CAEA,GACEiB,EAAmBD,MAAMmb,SACzBlb,EAAmBD,MAAMmb,QAAQve,OAAS6L,EAAAA,GAAAA,UAC1C,CACA,MAAMo0B,EAAc58B,EAAmBD,MAAMmb,QACzC0hB,EAAYhkB,OAAO,IACrBgkB,EAAYhkB,OAAO,GAAG+V,qBAE1B,CAOAvyB,KAAKs+B,GAAG7E,UAAUjS,UAAUla,EA3G5B,MANItN,KAAKs+B,GAAG7E,UAAUC,IAAIrS,eACtBrnB,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,KAAS85B,EAAAA,GAAAA,OAiHrC,CACOmE,kBAAkBlxB,GASvB,GANItN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIC,YACzD/D,KAAKs+B,GAAG7E,UAAUC,IAAIwF,UAAU/9B,KAAK,qBAIvCnB,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAahqB,wBAAwB8C,aAAamyB,SAAU,GAC9EzgC,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAasxB,UAIpC5/B,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAC1E+mB,wBAAwB4D,YAc7BpzB,EAAItN,KAAKs+B,GAAG7E,UAAUC,IAAI4F,YAAYhyB,IAElCtN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarwB,SAASw7B,UAAUC,WAAWtzB,EAAElM,EAAGkM,EAAEjM,IAA5E,CAuBA,GAhBErB,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,QAC/Br6B,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAa6wB,oBAGnCn/B,KAAKs+B,GAAGc,oBAAoB9xB,IAI3BtN,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAayQ,YACpC/e,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAauyB,eAEnC7gC,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe+X,cAAc6K,yBAEhE/4B,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAauyB,gBAAiB,EAIpD7gC,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAasU,8BAClC5iB,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAa4xB,UACpC,CACA,IAAIrd,EAUFA,EAPA7iB,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAegrB,eACzEC,UACH/gC,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBACzEC,OAASC,EAAAA,GAAAA,QAILjW,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAeke,mBACtE1zB,GAGKtN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAeb,YACtE3U,GAKAuV,IACF7iB,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMmb,QAAU+D,GAInD7iB,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,QAC/Br6B,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,YAC/Br6B,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,gBAC/Br6B,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,eAC/Br6B,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,UAE0B13B,IAArD3C,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,UAEzC3S,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,YAC1DpM,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,gBAC1DpM,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,eAC1DpM,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,MAC1DpM,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,QAC1DpM,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,MAI1DpM,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAQnS,YAAcR,KAAKs+B,GAAG7E,UAAUC,IAC9ElE,aAAa7xB,MAAMgP,QAAQnS,YAE9BR,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAQlM,iBAAkB,EACnEzG,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,aAAUhQ,UAIEA,IAArD3C,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,UACvC3S,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,OAI5DpM,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAQnS,YAAcR,KAAKs+B,GAAG7E,UAAUC,IAC9ElE,aAAa7xB,MAAMgP,QAAQnS,WAC9BR,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAQjC,eAAepD,EAAElM,EAAGkM,EAAEjM,KASzErB,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAC1DC,oBAAoBC,OAASC,EAAAA,GAAAA,mBAEhCjW,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAeme,6BAGvE,CAyBA,GAREjhC,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,MAC/Br6B,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,QAC/Br6B,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,cAC/Br6B,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,aAE/Br6B,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarwB,SAAS+7B,iBAAiB5zB,IAG1DtN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAE5C,IAAK,IAAI1R,EAAI,EAAGA,EAAIjB,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMsY,WAAW/a,SAAUD,EAChFjB,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMsY,WAAWhb,GAAG2V,gBAAiB,EAKzE5W,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMmb,SAC1C9e,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,SAE/Br6B,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAe+D,iBACjE7mB,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAazrB,GAAGC,wBAAwBm3B,mBAGhEnhC,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAese,iBACjEphC,KAAKs+B,GAAG7E,UAAU/oB,eAAepD,EA1IjC,CA2IF,CACOmxB,oBAAoBnxB,GAEtBtN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAC1E+mB,wBAAwBuE,cAK7B/zB,EAAItN,KAAKs+B,GAAG7E,UAAUC,IAAI4F,YAAYhyB,GAGtCtN,KAAKs+B,GAAG7E,UAAU6H,iBAAiBh0B,GACrC,CACOoxB,mBAAmBpxB,GAErBtN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAC1E+mB,wBAAwByE,aAM7Bj0B,EAAItN,KAAKs+B,GAAG7E,UAAUC,IAAI4F,YAAYhyB,GAItCtN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAe0e,qBAAqBl0B,GAGtFtN,KAAKs+B,GAAG7E,UAAU9oB,gBAAgBrD,GACpC,CACOqxB,WAAWrxB,GA2BhB,GAxBItN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIC,YACzD/D,KAAKs+B,GAAG7E,UAAUC,IAAIwF,UAAU/9B,KAAK,cAIvCnB,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAahqB,wBAAwB8C,aAAamzB,YAAa,EACrFzhC,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAahqB,wBAAwB8C,aAAamxB,MAAO,EAC/Ez/B,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAahqB,wBAAwB8C,aAAakxB,QAAS,EACjFx/B,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAahqB,wBAAwB8C,aAAamyB,SAAU,EAClFnzB,EAAEkyB,QAAS,EAePx/B,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAS,CACpD,MAAMzP,EAAIlD,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAQxF,oBACvDjK,GACFlD,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAe4e,aAAax+B,EAElF,CAIAlD,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAe6e,eAG/D3hC,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMmb,UACzC9e,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMmb,QAAQve,KAAS6L,EAAAA,GAAAA,OAQxDpM,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAa4xB,YACrClgC,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMmb,aAAUnc,GAOjD3C,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMmb,SAc3C9e,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMmb,QAAQlO,UAGnD5Q,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarwB,SAASy8B,eAAeC,4BAAuBl/B,GAIlF3C,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAM+Z,eAAY/a,EACrD3C,KAAKs+B,GAAG7E,UAAUC,IAAIhQ,kBAAkBoY,uBAAuB9hC,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,MAErFP,KAAKs+B,GAAG7E,UAAU7oB,QAAQtD,GAC1BtN,KAAK+hC,YAAYz0B,EACnB,CACOy0B,YAAYz0B,GACbtN,KAAKs+B,GAAGe,SAASj+B,IAAMkM,EAAElM,GAAKpB,KAAKs+B,GAAGe,SAASh+B,IAAMiM,EAAEjM,GACzDrB,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAezE,gBAGrE,CACOugB,oBAAoBtxB,GACzB,IACGtN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAC1E+mB,wBAAwBkF,YAE3B,OAEF10B,EAAItN,KAAKs+B,GAAG7E,UAAUC,IAAI4F,YAAYhyB,GAEtC,MAAMuV,EAAsB7iB,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAeb,YAC3F3U,QAEW3K,IAATkgB,IACEA,EAAKtiB,OAAS6L,EAAAA,GAAAA,iBAIhByW,EAAK9U,oBAQT/N,KAAKs+B,GAAG7E,UAAU1rB,iBAAiBT,EACrC,CACOuxB,aAAavxB,GAEftN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAC1E+mB,wBAAwBjI,YAIzBvnB,EAAEkyB,OACJx/B,KAAK8+B,aAAaxxB,GAKhBtN,KAAKi/B,aAAe,IAAM,IAC5B3xB,EAAItN,KAAKs+B,GAAG7E,UAAUC,IAAI4F,YAAYhyB,GAEjCtN,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAa4xB,WAEpClgC,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,QAC/Br6B,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,OAAS85B,EAAAA,GAAAA,MAE/Br6B,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarwB,SAAS+7B,iBAAiB5zB,GAM7B,IADlCtN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa5mB,oBAAoBmD,cAAcC,QAClEC,qBAAqBC,OAExBlS,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAeC,eAAevH,cAGnE7O,KAAKs+B,GAAG7E,UAAUC,IAAIhQ,kBAAkBuY,yBAAyBjiC,KAAKs+B,GAAG7E,UAAUC,IAAIn5B,MACvFP,KAAKs+B,GAAG7E,UAAU5E,UAAUvnB,GAC5BtN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarwB,SAASw7B,UAAU9L,UAAUvnB,EAAElM,EAAGkM,EAAEjM,IAI3E,CACOy9B,aAAaxxB,GAkBlB,GACGtN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAC1E+mB,wBAAwBjE,UAF7B,CAYA,GANAvrB,EAAItN,KAAKs+B,GAAG7E,UAAUC,IAAI4F,YAAYhyB,GACtCtN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAahqB,wBAAwB8C,aAAamzB,YAAa,GAKpE,IAAbn0B,EAAEkyB,OAAiB,CAQrB,GAFAx/B,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAeof,aAAa50B,GAC9EtN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAeqf,gBAAgB70B,GAC7EtN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,UAKzC3S,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,QAC1DpM,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,OAC1D,CACUpM,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAEjDvF,KAAKE,EAAElM,EAAGkM,EAAEjM,EAEhB,CAIErB,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAasuB,aACjC58B,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAauuB,qBAErC78B,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAauuB,oBAAqB,EAK9D,CAKA,GAAI78B,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAS,CACpD,MAAMzP,EAAIlD,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAMgP,QAAQxF,oBACvDjK,GACFlD,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAesf,oBAAoBl/B,EAEzF,CAIoC,IADlClD,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa5mB,oBAAoBmD,cAAcC,QAClEC,qBAAqBC,OAGxBlS,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAeC,eAAevH,cAG/D7O,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAM0+B,gBAC3CriC,KAAKs+B,GAAG7E,UAAUC,IAAIhQ,kBAAkB4Y,yBACtCtiC,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAa7xB,MAAM0+B,gBAG7CriC,KAAKs+B,GAAG7E,UAAUC,IAAIprB,aAAaoxB,sBAAuB,EAC1D1/B,KAAKs+B,GAAG7E,UAAUZ,UAAUvrB,EAjE5B,CAkEF,CACQizB,2CAA2C1d,EAAqBvV,GAKtE,GACGuV,EAAKtiB,OAAS6L,EAAAA,GAAAA,WAAoByW,EAAgBtR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,cACpEyW,EAAKtiB,OAAS6L,EAAAA,GAAAA,WAAoByW,EAAgBtR,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,aACrE,CACA,MAAMoa,EAAK3D,EAIX,OAHA7iB,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe+X,cAAcC,qBAChE3H,EAAGjV,MAAM,GAAGnH,SAAU,OACtBoc,EAAGhmB,YAAa,EAElB,CAEA,GACGqiB,EAAuBtiB,OAAS6L,EAAAA,GAAAA,cAChCyW,EAAuBtiB,OAAS6L,EAAAA,GAAAA,aAFnC,CAaA,GAAIyW,EAAKtiB,OAAS6L,EAAAA,GAAAA,MAGhB,OAFApM,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe+X,cAAcC,0BAC/DtL,EAAgBrG,OAAO,GAAGgB,OAAOhd,YAAa,GAIjD,GAAIqiB,EAAKtiB,OAAS6L,EAAAA,GAAAA,WAGhB,OAFApM,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe+X,cAAcC,0BAC/DtL,EAAuBriB,YAAa,GAIvC,GAAIqiB,EAAKtiB,OAAS6L,EAAAA,GAAAA,aAGhB,OAFApM,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe+X,cAAcC,0BAC/DtL,EAAuBriB,YAAa,GAIvC,GAAIqiB,EAAKtiB,OAAS6L,EAAAA,GAAAA,mBAAlB,CACayW,EACE1V,sBAEXnN,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe+X,cAAcC,qBAChEtL,EAAKriB,YAAa,EAGtB,CA5BA,KAXA,CAIE,MAAM0C,EAAI2f,EAAKnV,gBAAgBJ,EAAElM,EAAGkM,EAAEjM,GAClC6B,IACFlD,KAAKs+B,GAAG7E,UAAUC,IAAIlE,aAAarf,eAAe+X,cAAcC,qBAChEjrB,EAAEqO,MAAM,GAAGnH,SAAU,EACrBlH,EAAE1C,YAAa,EAGnB,CA8BF,EC/rBK,MAAM+hC,GAIX1iC,YAAY86B,GAAkD,KAHvDlB,eAAS,OACT+I,gBAAU,OACVnD,SAAW,IAAIh9B,EAAAA,IAAU,GAAI,GAElCrC,KAAKy5B,UAAYkB,EACjB36B,KAAKwiC,WAAa,IAAIxD,GAA0Bh/B,KAClD,CACOq+B,qBAAqB/wB,GAC1B,KACEtN,KAAKy5B,UAAUC,IAAIlE,aAAa5mB,oBAAoBmD,cAAcC,QAAQC,qBAAqBC,MAAQ,KAKE,IAAzGlS,KAAKy5B,UAAUC,IAAIlE,aAAa5mB,oBAAoBmD,cAAcC,QAAQC,qBAAqBC,QAG/FlS,KAAKy5B,UAAUC,IAAIlE,aAAa5mB,oBAAoBmD,cAAcC,QAAQC,qBAAqBwwB,MAAO,GAGrGziC,KAAKy5B,UAAUC,IAAIlE,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeqmB,cAAcuG,eAEpF1iC,KAAK2iC,gBAAgBr1B,IAK3B,OAAQA,EAAEs1B,YACR,KAAKC,EAAAA,GAAAA,KACH7iC,KAAKwiC,WAAWjE,aAAajxB,GAC7BtN,KAAK8iC,cAAcx1B,GACnB,MACF,KAAKu1B,EAAAA,GAAAA,GACH7iC,KAAKwiC,WAAW7D,WAAWrxB,GAC3BtN,KAAK+hC,YAAYz0B,GACjB,MACF,KAAKu1B,EAAAA,GAAAA,KACH7iC,KAAKwiC,WAAWhE,kBAAkBlxB,GAClCtN,KAAK+iC,mBAAmBz1B,GACxB,MACF,KAAKu1B,EAAAA,GAAAA,OACH7iC,KAAKwiC,WAAW/D,oBAAoBnxB,GACpCtN,KAAKgjC,qBAAqB11B,GAC1B,MACF,KAAKu1B,EAAAA,GAAAA,MACH7iC,KAAKwiC,WAAW9D,mBAAmBpxB,GACnCtN,KAAKijC,oBAAoB31B,GACzB,MACF,KAAKu1B,EAAAA,GAAAA,OACH7iC,KAAKwiC,WAAW5D,oBAAoBtxB,GACpCtN,KAAKkjC,qBAAqB51B,GAC1B,MACF,KAAKu1B,EAAAA,GAAAA,KACH7iC,KAAKwiC,WAAW3D,aAAavxB,GAC7BtN,KAAKmjC,cAAc71B,GACnB,MACF,KAAKu1B,EAAAA,GAAAA,KACH7iC,KAAKwiC,WAAW1D,aAAaxxB,GAC7BtN,KAAKojC,cAAc91B,GACnB,MACF,KAAKu1B,EAAAA,GAAAA,MACH7iC,KAAKwiC,WAAWzD,cAAczxB,GAC9BtN,KAAKqjC,eAAe/1B,GAK1B,CACO8xB,oBAAoB9xB,GAEzB,MAAMg2B,EAAgBtjC,KAAKy5B,UAAUC,IAAIlE,aAAarf,eAAe2M,eAAeygB,iBAAiBj2B,EAAElM,EAAGkM,EAAEjM,EAAG,IAC/GiM,EAAElM,EAAIkiC,EAAc,GACpBh2B,EAAEjM,EAAIiiC,EAAc,EACtB,CAEQX,gBAAgBr1B,GACtB,MAAMk2B,EAAWxjC,KAAKy5B,UAAUC,IAAIlE,aAAa5mB,oBAAoBmD,cAAc0xB,YAAYngC,MAC/F,OAAIkgC,EAAWl2B,EAAElM,GAGbpB,KAAKy5B,UAAUC,IAAIlE,aAAa5mB,oBAAoBmD,cAAc0xB,YAAYC,OAAOpgC,MAAQkgC,EAAWl2B,EAAElM,CAIhH,CAEQ0hC,cAAcx1B,GACpB,CAEMy0B,YAAYz0B,GAClB,CAEMy1B,mBAAmBz1B,GACzB,CAEM01B,qBAAqB11B,GAC3B,CAEM21B,oBAAoB31B,GAC1B,CAEM41B,qBAAqB51B,GAC3B,CAEM61B,cAAc71B,GAGpB,CAEM81B,cAAc91B,GACpB,CAEM+1B,eAAe/1B,GACrB,ECpHG,MAAMq2B,GAIX9jC,YAAY65B,GAA+B,KAHpCA,SAAG,OACFkK,qBAAe,OACfC,wBAAkB,EAExB7jC,KAAK05B,IAAMA,EACX15B,KAAK4jC,gBAAkB,IAAIrB,GAAqBviC,MAChDA,KAAK6jC,mBAAqB,IAAInJ,EAAwB16B,KACxD,CACOq+B,qBAAqB/wB,GAC1BtN,KAAK4jC,gBAAgBvF,qBAAqB/wB,EAC5C,CACOutB,wBAAwBtB,GAC7Bv5B,KAAK6jC,mBAAmBhJ,wBAAwBtB,EAClD,CACO2B,oCAAoC3B,GACzCv5B,KAAK6jC,mBAAmB3I,oCAAoC3B,EAC9D,CACOuK,qBAAqBv5B,GAC1B,CAGKid,UAAUla,GACV,CAEAoD,eAAepD,GACf,CAEAg0B,iBAAiBh0B,GACjB,CAEAqD,gBAAgBrD,GAChB,CAEAS,iBAAiBT,GACjB,CAEAsD,QAAQtD,GACR,CAEAunB,UAAUvnB,GACV,CAEAurB,UAAUvrB,GACV,CAEAkwB,QAAQjE,GACR,CAEA4E,MAAM5E,GACN,CAEAzE,OACA,CAEAvS,SACA,ECzDF,MAAMwhB,WAA2BJ,GACtC9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOhpB,eAAepD,GACf,EAGF,MAAM02B,WAA6BL,GACxC9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfgrB,EAAQ9Q,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACjD,CACOunB,UAAUvnB,GACfgrB,EAAQzD,UAAUvnB,EACpB,EAEK,MAAM22B,WAAgCN,GAC3C9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GAEftN,KAAK05B,IAAIlE,aAAarwB,SAAS+zB,UAAU1R,UAAUla,EACrD,CACOurB,UAAUvrB,GACX,CAECsD,QAAQtD,GACT,EAGD,MAAM42B,WAAoCP,GAC/C9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACftN,KAAK05B,IAAIlE,aAAarf,eAAe+X,cAAcC,qBACnDnuB,KAAK05B,IAAIlE,aAAarwB,SAAS+zB,UAAU1R,UAAUla,EACrD,CACOurB,UAAUvrB,GAEfirB,EAAWO,SAAU,EACrB94B,KAAK05B,IAAIlE,aAAarwB,SAAS+zB,UAAUL,UAAUvrB,EACrD,CACOsD,QAAQtD,GAEbirB,EAAWO,SAAU,EACrB94B,KAAK05B,IAAIlE,aAAarwB,SAAS+zB,UAAUtoB,QAAQtD,GACjDtN,KAAK05B,IAAIlX,YACX,CACOqS,UAAUvnB,GACftN,KAAK05B,IAAIlE,aAAarwB,SAAS+zB,UAAUrE,UAAUvnB,EACrD,EAEK,MAAM62B,WAAqCD,GAChDrkC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACftN,KAAK05B,IAAIlE,aAAarf,eAAe+X,cAAcC,qBACnDnuB,KAAK05B,IAAIlE,aAAarwB,SAAS+zB,UAAU1R,UAAUla,EACrD,CACOurB,UAAUvrB,GAEfirB,EAAWO,SAAU,EACrB94B,KAAK05B,IAAIlE,aAAarwB,SAAS+zB,UAAUL,UAAUvrB,EACrD,CACOsD,QAAQtD,GAEbirB,EAAWO,SAAU,EACrB94B,KAAK05B,IAAIlE,aAAarwB,SAAS+zB,UAAUtoB,QAAQtD,GACjDtN,KAAK05B,IAAIlX,YACX,CACOqS,UAAUvnB,GACftN,KAAK05B,IAAIlE,aAAarwB,SAAS+zB,UAAUrE,UAAUvnB,EACrD,EChFK,MAAMqb,GAGX9oB,YAAY6B,GAAqB,KAF1BA,SAAG,OACH4C,UAAI,EAETtE,KAAK0B,IAAMA,EACX1B,KAAKsE,KAAO5C,CACd,CACOmR,cAAczR,EAAWC,GAC9B,GAAIrB,KAAKsE,KAAKqB,WAAa3F,KAAKsE,KAAKtC,cAAgBhC,KAAKsE,KAAK+B,cAC7D,OAAO,EAET,GAAIrG,KAAKokC,QAAQhjC,EAAGC,GAClB,OAAO,EAET,MAAMgjC,EAAKjjC,EAAIpB,KAAKsE,KAAK1B,IAAIxB,EACvBkjC,EAAKjjC,EAAIrB,KAAKsE,KAAK1B,IAAIvB,EAC7B,OACGgjC,EAAKA,GAAOrkC,KAAKsE,KAAKigC,UAAYvkC,KAAKsE,KAAKigC,WAC1CD,EAAKA,GAAOtkC,KAAKsE,KAAKkgC,WAAaxkC,KAAKsE,KAAKkgC,aAChD,GAGJ,CACO1xB,SAiCL,MA9BE,UACA9S,KAAKsE,KAAKhE,GADV,WAIAN,KAAKsE,KAAK/D,KAAKwS,WAJf,2BAYA/S,KAAKsE,KAAKigC,UAAUtgB,QAAQ,GAAGlR,WAZ/B,eAgBA/S,KAAKsE,KAAKkgC,WAAWvgB,QAAQ,GAAGlR,WAhBhC,iBAoBA/S,KAAKsE,KAAK+E,UAAU4a,QAAQ,GAAGlR,WApB/B,eA0BA/S,KAAKsE,KAAKyB,gBA1BV,gBA6BA/F,KAAKsE,KAAK0B,YAEd,CACOo+B,QAAQhjC,EAAWC,GACxB,MAAMoc,EAAI,IAAIpb,EAAAA,GAASjB,EAAGC,GAC1B,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK4kB,OAAOhoB,SAAUD,EAC7C,IAAIiM,EAAAA,EAAAA,IAAYuQ,EAAGzd,KAAKsE,KAAK4kB,OAAOjoB,IAAM,GAExC,OADAjB,KAAKsE,KAAK6kB,cAAgBloB,GACnB,EAIX,OADAjB,KAAKsE,KAAK6kB,eAAiB,GACpB,CACT,CACOlW,OACL,ECrEG,MAAMuC,WAA0BE,EAIrC7V,YAAYyE,GACVY,MAAMZ,GAAM,KAJPA,UAAI,OACJ3D,iBAAW,OACXwa,qBAAe,EAGpBnb,KAAKsE,KAAOA,CACd,CACOkL,WAAW9L,GAChB1D,KAAKsE,KAAKmgC,eACVzkC,KAAKmU,iBAAiB3Q,SACtBxD,KAAKyV,MAAMjS,SACXxD,KAAKyV,MAAMF,qBAgBXvV,KAAKigB,mBAAmBvc,EAE1B,CACQuc,mBAAmBvc,GACrB1D,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAKyB,iBACtC/F,KAAK0kC,eAAehhC,GACpB1D,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMqU,MAAM+Z,YAC3DjhC,EACA1D,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,GAGhBrB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2K,KAAKsJ,aAC1D9mB,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,EACdrB,KAAKsE,KAAKigC,UACVvkC,KAAKsE,KAAKkgC,WACVxkC,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAC1D3W,KAAKsE,KAAKa,SAASmQ,OAErBtV,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,iBAEZ/F,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2K,KAAKyJ,QAC1DjnB,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,EACdrB,KAAKsE,KAAKigC,UACVvkC,KAAKsE,KAAKkgC,WACVxkC,KAAKsE,KAAKgB,OACVtF,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,iBAGZ/F,KAAKsE,KAAKa,SAASmQ,OAAStV,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GACxErV,KAAKsE,KAAKa,SAAS8J,OAAS,EAC5BjP,KAAKsE,KAAK8B,SAAU,IAIpBpG,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2K,KAAKyJ,QAC1DjnB,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,EACdrB,KAAKsE,KAAKigC,UACVvkC,KAAKsE,KAAKkgC,WACVxkC,KAAKsE,KAAKgB,OACVtF,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,iBAEZ/F,KAAKsE,KAAKa,SAASmQ,MAAQ,GAI3BtV,KAAKsE,KAAK6C,qBACVnH,KAAKsE,KAAKsB,aAMZ5F,KAAKgrB,4BAA4BhrB,KAAKsE,KAAK1B,IAC7C,CACQ8hC,eAAehhC,GACrB1D,KAAKsE,KAAK4kB,OAAO,GAAG9nB,EAAIpB,KAAKsE,KAAK1B,IAAIxB,EAAIpB,KAAKsE,KAAKigC,UACpDvkC,KAAKsE,KAAK4kB,OAAO,GAAG7nB,EAAIrB,KAAKsE,KAAK1B,IAAIvB,EAAIrB,KAAKsE,KAAKkgC,WAEpDxkC,KAAKsE,KAAK4kB,OAAO,GAAG9nB,EAAIpB,KAAKsE,KAAK1B,IAAIxB,EAAIpB,KAAKsE,KAAKigC,UACpDvkC,KAAKsE,KAAK4kB,OAAO,GAAG7nB,EAAIrB,KAAKsE,KAAK1B,IAAIvB,EAAIrB,KAAKsE,KAAKkgC,WAEpDxkC,KAAKsE,KAAK4kB,OAAO,GAAG9nB,EAAIpB,KAAKsE,KAAK1B,IAAIxB,EAAIpB,KAAKsE,KAAKigC,UACpDvkC,KAAKsE,KAAK4kB,OAAO,GAAG7nB,EAAIrB,KAAKsE,KAAK1B,IAAIvB,EAAIrB,KAAKsE,KAAKkgC,WAEpDxkC,KAAKsE,KAAK4kB,OAAO,GAAG9nB,EAAIpB,KAAKsE,KAAK1B,IAAIxB,EAAIpB,KAAKsE,KAAKigC,UACpDvkC,KAAKsE,KAAK4kB,OAAO,GAAG7nB,EAAIrB,KAAKsE,KAAK1B,IAAIvB,EAAIrB,KAAKsE,KAAKkgC,WAEpD9gC,EAAImV,UAAY,IAChBnV,EAAI2c,YAAcrgB,KAAKsE,KAAKjB,eAAe1C,YAAY8Z,YACvD/W,EAAIO,YACJP,EAAI4c,OAAOtgB,KAAKsE,KAAK4kB,OAAO,GAAG9nB,EAAGpB,KAAKsE,KAAK4kB,OAAO,GAAG7nB,GACtD,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK4kB,OAAOhoB,SAAUD,EAC7CyC,EAAI6c,OAAOvgB,KAAKsE,KAAK4kB,OAAOjoB,GAAGG,EAAGpB,KAAKsE,KAAK4kB,OAAOjoB,GAAGI,GAExDqC,EAAIS,YACJT,EAAI8c,SAEJ9c,EAAIM,UAAYhE,KAAKsE,KAAKjB,eAAe8X,gBAAgBZ,UACzD7W,EAAImV,UAAY7Y,KAAKsE,KAAKjB,eAAe8X,gBAAgBtC,UACzDnV,EAAI2c,YAAcrgB,KAAKsE,KAAKjB,eAAe8X,gBAAgBV,YAC3D,IAAK,IAAIxZ,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK4kB,OAAOhoB,SAAUD,EAC7CyC,EAAIO,YACJP,EAAIe,IAAIzE,KAAKsE,KAAK4kB,OAAOjoB,GAAGG,EAAGpB,KAAKsE,KAAK4kB,OAAOjoB,GAAGI,EAAG,EAAG,EAAe,EAAViR,KAAK8Y,IACnE1nB,EAAIS,YACJT,EAAIU,OACJV,EAAI8c,QAER,CAaQwK,4BAA4B+E,GAClC/vB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASqc,UAAUyJ,iBACpDjrB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAC5C1hB,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK6D,UACV4nB,EAAG3uB,EACH2uB,EAAG1uB,EACHrB,KAAKsE,KAAKigC,UACVvkC,KAAKsE,KAAKkgC,WACVxkC,KAAKsE,KAAKgB,OAEd,EC3JK,MAAM4V,WAAuBM,EAIlC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KAJNA,SAAG,OACHf,iBAAW,OACXwa,qBAAe,EAGpBnb,KAAKW,YAAc,IAAIwX,EAAYnY,MACnCA,KAAKmb,gBAAkB,IAAIhD,EAAYnY,MACvCA,KAAKmO,aACP,CACOA,cACLgK,EAAY8O,yBACVjnB,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElDyI,EAAY+O,6BACVlnB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElD,IAAK,IAAIzO,EAAI,EAAGA,EAAIjB,KAAK0B,IAAIya,IAAIjb,SAAUD,EACzCjB,KAAK0B,IAAIya,IAAIlb,GAAGoC,eAAeuY,mBAAmB5b,KAAKmb,gBAE3D,CACOtN,QAAQ3K,GACblD,KAAKW,YAAYga,KAAOzX,EACxBlD,KAAK0B,IAAIiC,MAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAC3D9Q,KAAK0B,IAAI8H,SAEb,CAEOiK,SACL,GAAIzT,KAAKW,YAAYga,KAAKzZ,OAAS,EACjC,MAAO,CAAEyZ,KAAM3a,KAAKW,YAAYga,KAGpC,EClCK,MAAMmR,WAAgCC,EAI3ClsB,YAAY6B,GACVwD,MAAMxD,GAAK,KAJNA,SAAG,OACH4C,UAAI,EAITtE,KAAK0B,IAAMA,EACX1B,KAAKsE,KAAO5C,CACd,CACOwR,0BAA0B5F,IACA,IAA3BtN,KAAKsE,KAAKif,YAKVvjB,KAAKsE,KAAKqB,WAAa3F,KAAKsE,KAAKtC,cAAgBhC,KAAKsE,KAAK+B,gBAG/DrG,KAAKsE,KAAK1B,IAAIxB,GAAKkM,EAAElM,EAAIkM,EAAE6F,KAC3BnT,KAAKsE,KAAK1B,IAAIvB,GAAKiM,EAAEjM,EAAIiM,EAAE8F,KAC3BpT,KAAKsE,KAAKsgC,YARR5kC,KAAKsE,KAAK6X,IAAInc,KAAKsE,KAAKif,aAAarQ,0BAA0B5F,EASnE,ECHK,MAAMu3B,WAAgB5/B,EAqB3B+W,gBAAgBrY,EAAc0M,GAAoD,IAArCtJ,EAAM,wDAAUuV,EAAU,wDACrE,MAAM7S,EAAIsS,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAM,GAAImG,GAC9CrF,EAAM,IAAImjC,GAAQlhC,EAAO8F,EAAE7G,IAAIxB,EAAGqI,EAAE7G,IAAIvB,EAAG,EAAG0F,GACpD0C,EAAEgH,SAEF,MAAMyM,EAAKnB,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAM,IAC3Cuc,EAAKpB,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAM,IAmCjD,OAjCAc,EAAIojC,GAAK5nB,EAAGta,IAAIxB,EAAIM,EAAIkB,IAAIxB,EAC5BM,EAAIqjC,GAAK5nB,EAAGva,IAAIvB,EAAIK,EAAIkB,IAAIvB,EAC5B6b,EAAGzM,SACH0M,EAAG1M,SAEH/O,EAAInB,KAAO6L,EAAAA,GAAMiE,EAAE9P,MAEnBmB,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EAE1BzF,EAAI2E,cAAgBgK,EAAE3P,SAClB2P,EAAE3P,SACJgB,EAAIwF,gBAAkB,EAEtBxF,EAAIwF,gBAAkB,EAGpBmJ,EAAExP,QAAUwP,EAAExP,OAAO8Z,OACvBjZ,EAAI2B,eAAe1C,YAAYga,KAAOtK,EAAExP,OAAO8Z,MAM/CjZ,EAAIpB,GAHDgc,EAGM3Y,EAAMsF,UAFNoH,EAAE/P,GAKboB,EAAIoO,mBACC/I,GAAUuV,EACb3Y,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,UAEzE9H,EAAI0I,SAAU,EAET1I,CACT,CACAsa,qBAC+BrZ,IAAzBkiC,GAAQxiB,cACVwiB,GAAQxiB,aAAa5R,SAEvBo0B,GAAQxiB,kBAAe1f,CACzB,CACAqZ,0BAA0BrY,GACxB,IAAI1C,EAAI0C,EAAMqhC,oBAAoB9jC,OAC9B6gB,EAAQ,EACZ,KAAO9gB,KACD0C,EAAMqhC,oBAAoB/jC,GAAGT,aAC/BuhB,GAAS,GAGb,OAAOA,CACT,CACA/F,kBAAkB1O,QACa3K,IAAzBkiC,GAAQxiB,eACVwiB,GAAQxiB,aAAa4iB,EAAIJ,GAAQxiB,aAAahQ,SAAS/E,EAAElM,EAAGkM,EAAEjM,GAC9DwjC,GAAQxiB,aAAauiB,WAEzB,CACA5oB,0BAA0BrY,GACxB,MAAM4mB,EAAK,IAAIloB,EAAAA,GACkD,GAA/DsB,EAAMC,mBAAmBuS,eAAe2M,eAAexf,MACS,GAAhEK,EAAMC,mBAAmBuS,eAAe2M,eAAevf,QAEzDvD,KAAKklC,gBAAgBvhC,EAAO,CAC1B4mB,EACA,IAAIloB,EAAAA,GAASkoB,EAAGnpB,EAAI,IAAKmpB,EAAGlpB,GAC5B,IAAIgB,EAAAA,GAASkoB,EAAGnpB,EAAGmpB,EAAGlpB,EAAI,MAE9B,CACA2a,uBAAuBrY,EAAc3C,GACnC,MAAMupB,GAAKlE,EAAAA,EAAAA,IAAqBrlB,GAC1BmkC,GAAMC,EAAAA,EAAAA,IAAkBpkC,GAExBU,EAAM,IAAImjC,GAAQlhC,EAAO4mB,EAAGnpB,EAAGmpB,EAAGlpB,EAAG,GAAG,EAAgB,EAAT8jC,EAAI,IACzDzjC,EAAIkjC,WACJljC,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EAC1BxD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,SAC3E,CACAwS,uBAAuBrY,EAAcud,EAAc9f,EAAWC,GAC5D,IAAI6P,GAASm0B,EAAAA,EAAAA,IAAgBnkB,GAC7BhQ,EAASvN,EAAMC,mBAAmBuS,eAAe2M,eAAewiB,mBAC9DlkC,EACAC,EACA6P,GAEF,MAAMxP,EAAM,IAAImjC,GAAQlhC,EAAOvC,EAAGC,EAAG,GAAG,EAAO6P,GAC/CxP,EAAIkjC,WACJljC,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EAC1BxD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,UACzEq7B,GAAQxiB,aAAe3gB,CACzB,CACAsa,gCAAgCrY,EAAc4hC,EAAuBnkC,EAAWC,GAC9E,IAAI6P,GAASs0B,EAAAA,EAAAA,IAAyBD,GACtCr0B,EAASvN,EAAMC,mBAAmBuS,eAAe2M,eAAewiB,mBAC9DlkC,EACAC,EACA6P,GAEF,MAAMxP,EAAM,IAAImjC,GAAQlhC,EAAOvC,EAAGC,EAAG,GAAG,EAAO6P,GAC/CxP,EAAIkjC,WACJljC,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EAC1BxD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,UACzEq7B,GAAQxiB,aAAe3gB,CACzB,CACAsa,iBAAiBrY,EAAc2J,QACA3K,IAAzBkiC,GAAQxiB,cACVwiB,GAAQxiB,aAAa1a,EAAIk9B,GAAQxiB,aAAahQ,SAAS/E,EAAElM,EAAGkM,EAAEjM,GAC9DwjC,GAAQxiB,aAAaD,cAAe,EACpCyiB,GAAQxiB,aAAalb,qBAAsB,EAC3CxD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAClD+zB,GAAQxiB,aAAa7Y,UAEvBq7B,GAAQxiB,kBAAe1f,IAEvBkiC,GAAQxiB,aAAe,IAAIwiB,GAAQlhC,EAAO2J,EAAElM,EAAGkM,EAAEjM,GACjDwjC,GAAQxiB,aAAaD,cAAe,EAExC,CAEApG,iBAAiBrY,EAAc2J,GAC7B,CAQF0O,0BAA0B1O,GACnB,CAEP0O,yBAAyB1O,GAClB,CAEP0O,wBAAwBrY,EAAc2J,GACpCtN,KAAKylC,iBAAiB9hC,EAAO2J,EAmB/B,CACA0O,mBAAmB1O,GAGjB,CAEF0O,mBAAmBrY,EAAc2J,QACF3K,IAAzBkiC,GAAQxiB,aACVwiB,GAAQ3hB,WAAW5V,GAEnBu3B,GAAQa,UAAU/hC,EAAO2J,EAI7B,CACA0O,iBAAiBrY,EAAc2J,GACzBu3B,GAAQxiB,eACVwiB,GAAQxiB,aAAaD,cAAe,EACpCyiB,GAAQxiB,aAAalb,qBAAsB,EAC3C09B,GAAQxiB,aAAa7hB,YAAa,EAClCqkC,GAAQxiB,kBAAe1f,EACvBkiC,GAAQ5hB,QAAS,EACjBtf,EAAMC,mBAAmB4H,wBAAwBgX,aAErD,CACAxG,wBAAwBrY,EAAc2J,GACpC,MAAM5L,EAAM,IAAImjC,GAAQlhC,EAAO2J,EAAElM,EAAGkM,EAAEjM,EAAG,GAAG,EAAO,IACnDK,EAAIkjC,WACJljC,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EAC1BzF,EAAIlB,YAAa,EACjBmD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,UACzE7F,EAAMC,mBAAmB4H,wBAAwBgX,YACnD,CAEA3iB,YACE8D,GAQC,IAPDvC,EAAC,uDAAG,EACJC,EAAC,uDAAG,EACJC,EAAC,uDAAG,EACJyF,EAAM,wDACNmK,EAAM,uDAAG,EAIThM,MAAMvB,GAAO,KAnOR0B,iBAAW,OACX8W,SAAG,OACHvZ,SAAG,OACH8c,KAAmB,GAAG,KACtBwJ,OAAqB,GAAG,KACxBxhB,UAAI,OACJ68B,eAAS,OACTC,gBAAU,OACVrzB,aAAO,OACPw0B,YAAM,OACNpiB,aAAe,EAAE,KACjB4F,eAAiB,EAAE,KACnB7jB,YAAM,OAENsgC,oBAAc,OAEdhmB,eAAS,EAoNd5f,KAAK+G,OAASA,EACd/G,KAAK4C,IAAM,IAAIP,EAAAA,GAASjB,EAAGC,EAAGC,GAK9BtB,KAAKukC,UAAYrzB,EACjBlR,KAAKwkC,WAAatzB,EAClBlR,KAAKmR,QAAUD,EACflR,KAAK2lC,OAASz0B,EAAS,GAEvBlR,KAAKmc,IAAM,GACXnc,KAAK2H,EAAI,EACT3H,KAAK4c,gBAEL5c,KAAKmc,IAAI,GAAK,IAAIJ,EAChB/b,KAAK2D,MACL3D,KAAK4C,IAAIxB,EAAa,GAATpB,KAAK2H,EAClB3H,KAAK4C,IAAIvB,EAAa,GAATrB,KAAK2H,EAClB3H,KAAK4C,IAAItB,EACTtB,KAAK+G,QAEP/G,KAAKmc,IAAI,GAAK,IAAIJ,EAChB/b,KAAK2D,MACL3D,KAAK4C,IAAIxB,EAAa,GAATpB,KAAK2H,EAClB3H,KAAK4C,IAAIvB,EAAa,GAATrB,KAAK2H,EAClB3H,KAAK4C,IAAItB,EAAa,GAATtB,KAAK2H,EAClB3H,KAAK+G,QAGP/G,KAAKmc,IAAI,GAAK,IAAIJ,EAChB/b,KAAK2D,MACL3D,KAAK4C,IAAIxB,EACTpB,KAAK4C,IAAIvB,EAAa,GAATrB,KAAK2H,EAClB3H,KAAK4C,IAAItB,EACTtB,KAAK+G,QAEP/G,KAAKmc,IAAI,GAAK,IAAIJ,EAChB/b,KAAK2D,MACL3D,KAAK4C,IAAIxB,EAAa,GAATpB,KAAK2H,EAClB3H,KAAK4C,IAAIvB,EAAa,GAATrB,KAAK2H,EAClB3H,KAAK4C,IAAItB,EAAa,GAATtB,KAAK2H,EAClB3H,KAAK+G,QAGP/G,KAAKmc,IAAI,GAAG3J,QAAQxS,MACpBA,KAAKmc,IAAI,GAAG3J,QAAQxS,MACpBA,KAAKmc,IAAI,GAAG3J,QAAQxS,MACpBA,KAAKmc,IAAI,GAAG3J,QAAQxS,MACpBA,KAAKmc,IAAI,GAAG5b,KAAO6L,EAAAA,GAAAA,aACnBpM,KAAKmc,IAAI,GAAG5b,KAAO6L,EAAAA,GAAAA,aACnBpM,KAAKmc,IAAI,GAAG5b,KAAO6L,EAAAA,GAAAA,aACnBpM,KAAKmc,IAAI,GAAG5b,KAAO6L,EAAAA,GAAAA,aAEnBpM,KAAKkpB,OAAS,GACdlpB,KAAKkpB,OAAO/nB,KAAK,IAAIkB,EAAAA,GAASrC,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAGpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAG,IACpErB,KAAKkpB,OAAO/nB,KAAK,IAAIkB,EAAAA,GAASrC,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAGpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAG,IACpErB,KAAKkpB,OAAO/nB,KAAK,IAAIkB,EAAAA,GAASrC,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAGpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAG,IACpErB,KAAKkpB,OAAO/nB,KAAK,IAAIkB,EAAAA,GAASrC,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAGpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAG,IASpErB,KAAK6lC,YACP,CACQjpB,gBACN5c,KAAKqD,eAAiB,IAAI6X,GAAelb,MACzCA,KAAKmF,SAAW,IAAIqQ,GAAkBxV,MACtCA,KAAKqF,YAAc,IAAIsjB,GAAqB3oB,MAC5CA,KAAKoF,eAAiB,IAAI0mB,GAAwB9rB,KACpD,CACA8lC,OACO,CAEPD,aACE7lC,KAAK4f,UAAY,IAAIiI,EAAU7nB,MAC/BA,KAAKO,KAAO6L,EAAAA,GAAAA,OAEZpM,KAAK2F,UAAW,EAChB3F,KAAK4F,cAAe,EACpB5F,KAAKsF,QAAS,EACdtF,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EACpBhC,KAAKkG,aAAc,EACnBlG,KAAK+F,iBAAkB,EACvB/F,KAAKwG,aAAc,EACnBxG,KAAKmH,qBAAsB,CAC7B,CACAkC,UACE,OAAOiJ,KAAK8Y,GAAKprB,KAAKwkC,WAAaxkC,KAAKukC,SAC1C,CACAzxB,SACE,OAAO9S,KAAKqF,YAAYyN,QAC1B,CACAE,YAeE,MAbE,iBACAhT,KAAKM,GADL,wDAUAN,KAAK2H,EACL,YAGJ,CACAyK,gBAGE,MAAO,EACT,CACA2zB,UACE,MAAO,SACT,CACAp5B,UACE,MAAM3L,EAAiB,GACvB,IAAK,IAAIC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCD,EAAGG,KAAKnB,KAAKmc,IAAIlb,GAAG2B,KAGtB,OADA5C,KAAK0f,KAAO1e,EACLA,CACT,CACWqJ,eAAWnH,GACpBlD,KAAKkH,gBAAkBhE,EACvB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGiG,gBAAkBhE,CAElC,CACW2rB,qBAAiB3rB,GAC1BlD,KAAKsG,YAActG,KAAKqG,cACxBrG,KAAKqG,cAAgBnD,EACrB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGoF,cAAgBnD,CAEhC,CACWxC,aAASwC,GAClBlD,KAAKsG,YAActG,KAAKqG,cACxBrG,KAAKqG,cAAgBnD,EACrBlD,KAAK6uB,iBAAmB3rB,EAExBlD,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBC,UAAUjK,KAAKwJ,SAC1E,CAEOo7B,WAAqE,IAA5DoB,EAAU,uDAAGhmC,KAAKukC,UAAW0B,EAAU,uDAAGjmC,KAAKwkC,WAC7DxkC,KAAKukC,UAAYyB,EACjBhmC,KAAKwkC,WAAayB,EAClBjmC,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAK4C,IAAIxB,EAAIpB,KAAKukC,UACtCvkC,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAK4C,IAAIvB,EAE7BrB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAK4C,IAAIxB,EAAIpB,KAAKukC,UACtCvkC,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAK4C,IAAIvB,EAE7BrB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAK4C,IAAIxB,EAC7BpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAK4C,IAAIvB,EAAIrB,KAAKwkC,WAEtCxkC,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAK4C,IAAIxB,EAC7BpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAK4C,IAAIvB,EAAIrB,KAAKwkC,UAExC,CACOC,eASL,OARAzkC,KAAK4C,IAAM,IAAIP,EAAAA,GAAS,EAAG,EAAG,GAC9BrC,KAAK4C,KAAMgQ,EAAAA,EAAAA,IAAK5S,KAAK4C,IAAK5C,KAAKmc,IAAI,GAAGvZ,KACtC5C,KAAK4C,KAAMgQ,EAAAA,EAAAA,IAAK5S,KAAK4C,IAAK5C,KAAKmc,IAAI,GAAGvZ,KACtC5C,KAAK4C,KAAMgQ,EAAAA,EAAAA,IAAK5S,KAAK4C,IAAK5C,KAAKmc,IAAI,GAAGvZ,KACtC5C,KAAK4C,KAAMgQ,EAAAA,EAAAA,IAAK5S,KAAK4C,IAAK5C,KAAKmc,IAAI,GAAGvZ,KACtC5C,KAAK4C,IAAIsjC,SAAS,GAClBlmC,KAAKukC,UAAYjyB,KAAKyS,IAAI/kB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAK4C,IAAIxB,GACvDpB,KAAKwkC,WAAalyB,KAAKyS,IAAI/kB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAK4C,IAAIvB,GACjDrB,KAAK4C,GACd,CACOsN,gBACLlQ,KAAKgG,cAAe,EACpBhG,KAAKuH,eAAgB,EACrBvH,KAAKmc,IAAI6J,SAASvc,IAChBA,EAAEyG,eAAe,GAErB,CACO9E,eACL,OAAOpL,KAAKmc,IAAI,EAClB,CACW8oB,MAAEt9B,GACX3H,KAAKukC,UAAY58B,EACjB3H,KAAKwkC,WAAa78B,CAGpB,CACWm9B,OAAGn9B,GACZ3H,KAAKukC,UAAY58B,EACjB3H,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAK4C,IAAIxB,EAAIpB,KAAKukC,UACtCvkC,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAK4C,IAAIvB,EAC7BrB,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAK4C,IAAIxB,EAAIpB,KAAKukC,UACtCvkC,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAK4C,IAAIvB,CAC/B,CACW0jC,OAAGp9B,GACZ3H,KAAKwkC,WAAa78B,EAClB3H,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAK4C,IAAIxB,EAC7BpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAK4C,IAAIvB,EAAIrB,KAAKwkC,WACtCxkC,KAAKmc,IAAI,GAAGvZ,IAAIxB,EAAIpB,KAAK4C,IAAIxB,EAC7BpB,KAAKmc,IAAI,GAAGvZ,IAAIvB,EAAIrB,KAAK4C,IAAIvB,EAAIrB,KAAKwkC,UACxC,CACWpiB,iBAAavN,GACtB7U,KAAKgG,aAAe6O,EACpB7U,KAAKmc,IAAI,GAAGnW,aAAe6O,EAC3B7U,KAAKmc,IAAI,GAAGnW,aAAe6O,EAC3B7U,KAAKmc,IAAI,GAAGnW,aAAe6O,EAC3B7U,KAAKmc,IAAI,GAAGnW,aAAe6O,CAC7B,CACOhC,cAAczR,EAAWC,GAC9B,OAAOrB,KAAKqF,YAAYwN,cAAczR,EAAGC,EAC3C,CACOgR,SAASjR,EAAWC,GACzB,OAAOiR,KAAKC,MAAMvS,KAAK4C,IAAIxB,EAAIA,IAAMpB,KAAK4C,IAAIxB,EAAIA,IAAMpB,KAAK4C,IAAIvB,EAAIA,IAAMrB,KAAK4C,IAAIvB,EAAIA,GAC1F,CACO8kC,cACA,CAEA94B,eAAeC,EAAmBC,GAEvCvN,KAAK0H,KAAO,IAAIrF,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,EAAG,GACnCrB,KAAKwG,aAAc,EACnBxG,KAAK4kC,UACP,CACOp3B,SACDxN,KAAKwG,cACPxG,KAAK4C,KAAMgQ,EAAAA,EAAAA,KAAK/N,EAAAA,EAAAA,IAAM7E,KAAK4C,IAAK,MAAOiC,EAAAA,EAAAA,IAAM7E,KAAK0H,KAAM,OACpDwF,EAAAA,EAAAA,IAAYlN,KAAK4C,IAAK5C,KAAK0H,MAAQ,IACrC1H,KAAKwG,aAAc,IAGvBxG,KAAK4kC,UACP,CACOn0B,SAAyB,IAAlB5J,IAAQ,yDAQpB,GAPA7G,KAAK2F,UAAW,EAChB3F,KAAKgC,cAAe,EACpBhC,KAAKmc,IAAI,GAAG1L,SACZzQ,KAAKmc,IAAI,GAAG1L,SACZzQ,KAAKmc,IAAI,GAAG1L,SACZzQ,KAAKmc,IAAI,GAAG1L,SAER5J,EAAU,CACZ,MAAMuX,EAAQpe,KAAKwJ,SACf4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB,CAACvG,GAElF,CAGApe,KAAK2D,MAAM8a,eAAeze,KAC5B,CACOiT,OACA,CAEA7F,KAAKhM,EAAWC,GACjBrB,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,gBAGhDrG,KAAK4C,IAAIxB,EAAIA,EACbpB,KAAK4C,IAAIvB,EAAIA,EACbrB,KAAK4kC,WACP,CACO1xB,0BAA0B5F,GAC/B,OAAOtN,KAAKoF,eAAe8N,0BAA0B5F,EACvD,CACOiG,UAAUnS,EAAWC,GAC1B,CAGSb,iBACT,OAAOR,KAAK+F,eACd,CACWvF,eAAW0C,GACpBlD,KAAK+F,gBAAkB7C,EACvBlD,KAAKmc,IAAI,GAAGna,aAAekB,EAC3BlD,KAAKmc,IAAI,GAAGna,aAAekB,EAC3BlD,KAAKmc,IAAI,GAAGna,aAAekB,EAC3BlD,KAAKmc,IAAI,GAAGna,aAAekB,EAE3BlD,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2c,eAAe3mB,KAAKwJ,SAC/E,CACWY,cACT,OAAOpK,KAAK4F,YACd,CACWwE,YAAQlH,GACblD,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,eAG5CrG,KAAKmH,sBAGTnH,KAAK4F,aAAe1C,GAEhBlD,KAAK4F,eAAiB5F,KAAK6F,aAEnB7F,KAAK4F,cAAgB5F,KAAK6F,aADpC7F,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB4c,WAAW5mB,KAAKwJ,UAI3ExJ,KAAK6F,WAAa7F,KAAK4F,aAClB5F,KAAK+F,kBACR/F,KAAKmc,IAAI,GAAGna,aAAekB,EAC3BlD,KAAKmc,IAAI,GAAGna,aAAekB,EAC3BlD,KAAKmc,IAAI,GAAGna,aAAekB,EAC3BlD,KAAKmc,IAAI,GAAGna,aAAekB,GAExBA,IACHlD,KAAK8G,mBAAoB,EACzB9G,KAAK4M,oBAET,CACOxD,UACL,MAAMlG,EAAgB,GAMtB,OALAA,EAAE/B,KAAKnB,KAAK4C,KACZM,EAAE/B,KAAKnB,KAAKmc,IAAI,GAAGvZ,KACnBM,EAAE/B,KAAKnB,KAAKmc,IAAI,GAAGvZ,KACnBM,EAAE/B,KAAKnB,KAAKmc,IAAI,GAAGvZ,KACnBM,EAAE/B,KAAKnB,KAAKmc,IAAI,GAAGvZ,KACZM,CACT,CACOsG,SACL,MAAMC,EAAI,IAAIpJ,EACZL,KAAKM,GACLN,KAAKO,KACLP,KAAK+F,gBACL/F,KAAK4F,aACL5F,KAAKqG,eAEPoD,EAAE1I,SAASf,KAAKoJ,WAEhB,MAAMvI,EAASb,KAAKqD,eAAeoQ,SAKnC,OAJI5S,IACF4I,EAAE5I,OAASA,GAGN4I,CACT,CACOsG,SAAS3O,EAAWC,GACzB,MAAMgP,EAAIrQ,KAAKwJ,SACf,GAAI6G,EAAG,CACL,MAAMqW,EAAKme,GAAQz0B,SAASpQ,KAAK2D,MAAO0M,GAAG,GAAM,GAGjD,OAFAqW,EAAGtZ,KAAKhM,EAAGC,GACXqlB,EAAG7V,eACI6V,CACT,CAEF,CACO/V,kBACL3Q,KAAKsF,QAAUtF,KAAKsF,MACtB,CACOkK,WAAW9L,GAChB1D,KAAKmF,SAASqK,WAAW9L,EAC3B,EA7kBWmhC,GACG5hB,QAAS,EADZ4hB,GAEGxiB,kBAAoC1f,ECrB7C,MAAMuY,WAAuBM,EAElC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KAFNA,SAAG,CAGV,CACOyM,cASL,GARAgK,EAAY8O,yBACVjnB,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElDyI,EAAY+O,6BACVlnB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAE9C1P,KAAK0B,IAAIya,IACX,IAAK,IAAIlb,EAAI,EAAGA,EAAIjB,KAAK0B,IAAIya,IAAIjb,SAAUD,EACzCjB,KAAK0B,IAAIya,IAAIlb,GAAGoC,eAAeuY,mBAAmB5b,KAAKmb,gBAG7D,ECJK,MAAMirB,WAAqBnhC,EAchC,mBAA0BqI,GACxB,IAAK,IAAIrM,EAAImlC,GAAap1B,KAAK9P,OAAS,EAAGD,GAAK,IAAKA,EACnD,GAAImlC,GAAap1B,KAAK/P,GAAG+E,cAAgBogC,GAAap1B,KAAK/P,GAAG4R,cAAcvF,EAAElM,EAAGkM,EAAEjM,GACjF,OAAO+kC,GAAap1B,KAAK/P,EAI/B,CACA,mBAA0BqM,GACxB,MAAM0U,EAAKokB,GAAankB,YAAY3U,QACzB3K,IAAPqf,IACFA,EAAGpc,cAAe,EAEtB,CAEA,gBACEjC,EACA0M,GAKA,MAAM5G,EAAIsS,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAM,IAC1Cc,EAAM,IAAI0kC,GAAaziC,EAAO8F,EAAE7G,IAAIxB,EAAGqI,EAAE7G,IAAIvB,GACnDK,EAAInB,KAAO6L,EAAAA,GAAMiE,EAAE9P,MACnBkJ,EAAEgH,SAEF,IAAK,IAAIxP,EAAI,EAAGA,EAAIS,EAAIya,IAAIjb,SAAUD,EAAG,CACvC,MAAMiC,EAAI6Y,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAMK,IAChDS,EAAIya,IAAIlb,GAAG2B,IAAIxB,EAAI8B,EAAEN,IAAIxB,EACzBM,EAAIya,IAAIlb,GAAG2B,IAAIvB,EAAI6B,EAAEN,IAAIvB,EACzBK,EAAIya,IAAIlb,GAAGV,KAAO6L,EAAAA,GAAAA,KAEpB,CAGA1K,EAAIpB,GAAK+P,EAAE/P,GACXoB,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EAE1BxD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,UACzE48B,GAAa/jB,kBAAe1f,CAC9B,CACA,eAAsBgB,EAAc2J,EAAmB/M,QACnBoC,IAA9ByjC,GAAa/jB,aACX+jB,GAAa/jB,aAAa9hB,OAAS6L,EAAAA,GAAAA,QACrCg6B,GAAa/jB,aAAaD,cAAe,EACzCgkB,GAAa/jB,aAAalb,qBAAsB,EAChDggB,EAAgBkf,iBAAiB1iC,EAAOyiC,GAAa/jB,cACrD+jB,GAAa/jB,aAAa5R,SAC1B9M,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAClDs1B,GAAa/jB,aAAa7Y,UAE5B48B,GAAa/jB,kBAAe1f,GACnByjC,GAAa/jB,aAAa9hB,OAAS6L,EAAAA,GAAAA,UAC5Cg6B,GAAa/jB,aAAaikB,WACiB,IAAvCF,GAAa/jB,aAAaikB,WAC5BF,GAAa/jB,aAAaD,cAAe,EACzCgkB,GAAa/jB,aAAalb,qBAAsB,EAChDxD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAClDs1B,GAAa/jB,aAAa7Y,UAE5B2d,EAAgBkf,iBAAiB1iC,EAAOyiC,GAAa/jB,cACrD+jB,GAAa/jB,aAAa5R,SAC1B21B,GAAa/jB,kBAAe1f,KAIhCyjC,GAAa/jB,aAAe,IAAI+jB,GAAaziC,EAAO2J,EAAElM,EAAGkM,EAAEjM,EAAG,EAAGd,GACjE6lC,GAAa/jB,aAAakkB,YAC1BH,GAAa/jB,aAAalb,qBAAsB,EAChDi/B,GAAa/jB,aAAaD,cAAe,EAE7C,CACA,mBAA0B3Y,GACnB,CAEP,qBACoC9G,IAA9ByjC,GAAa/jB,eACf+jB,GAAa/jB,aAAaD,cAAe,EACzCgkB,GAAa/jB,aAAalb,qBAAsB,EAChDi/B,GAAa/jB,aAAa5R,SAC1B21B,GAAa/jB,kBAAe1f,EAEhC,CACA,kBAAyB2K,QACW3K,IAA9ByjC,GAAa/jB,cACf+jB,GAAa/jB,aAAamkB,UAAUl5B,EAAElM,EAAGkM,EAAEjM,EAE/C,CAEA,WAAkBgP,GAChB+1B,GAAap1B,KAAK7P,KAAKkP,EACzB,CACA,cAAqB1M,EAAc0M,GACjC,MAAM3O,EAAM2O,EAAE7G,SACV9H,IACFiC,EAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB,CAACjjB,IACzE0kC,GAAap1B,KAAKoM,OAAOgpB,GAAap1B,KAAKyB,QAAQpC,GAAI,GAE3D,CAEA,iBAAwB1M,EAAc2J,EAAmB/M,QACrBoC,IAA9ByjC,GAAa/jB,eACX9hB,IAAS6L,EAAAA,GAAAA,QACXg6B,GAAarjB,QAAQpf,EAAO2J,EAAG/M,GAC/B6lC,GAAa/jB,kBAAe1f,EAC5ByjC,GAAanjB,QAAS,EACtBtf,EAAMC,mBAAmB4H,wBAAwBgX,cACxCjiB,IAAS6L,EAAAA,GAAAA,UAClBg6B,GAAarjB,QAAQpf,EAAO2J,EAAG/M,GAC3B6lC,GAAaE,WAAa,IAC5BF,GAAa/jB,kBAAe1f,EAC5ByjC,GAAanjB,QAAS,EACtBmjB,GAAaE,SAAW,EACxB3iC,EAAMC,mBAAmB4H,wBAAwBgX,eAIzD,CACA,sBAA6B7e,EAAc2J,EAAmB/M,GACxD6lC,GAAanjB,OACfmjB,GAAanjB,QAAS,OAGuBtgB,IAA3CgB,EAAMC,mBAAmBD,MAAMgP,cAGDhQ,IAA9ByjC,GAAa/jB,cACf+jB,GAAarjB,QAAQpf,EAAO2J,EAAG/M,EAEnC,CACA,iBAAwB+M,QACY3K,IAA9ByjC,GAAa/jB,cACf+jB,GAAaljB,WAAW5V,EAE5B,CAEAzN,YACE8D,EACAvC,EACAC,GAIC,IAFDd,EAAW,uDAAG6L,EAAAA,GAAAA,OACdq6B,EAAe,uDAAGL,GAAaK,QAE/BvhC,MAAMvB,GAAO,KAzJR+b,UAAI,OACJvD,SAAG,OACH9P,OAAC,OACD45B,QAAE,OACFS,QAAE,OACF7tB,eAAS,OACTytB,cAAQ,EAoJbtmC,KAAKmc,IAAM,GACXnc,KAAK4C,IAAM,IAAIP,EAAAA,GAASjB,EAAGC,GAC3BrB,KAAKO,KAAOA,EACZP,KAAKqM,EAAIo6B,EACTzmC,KAAK4c,gBACL5c,KAAK8R,MACP,CACQ8K,gBACN5c,KAAKqD,eAAiB,IAAI6X,GAAelb,KAC3C,CACO8R,OACL9R,KAAKimC,GAAK,GACVjmC,KAAK6Y,UAAY,EAEjB7Y,KAAKsmC,SAAW,EAChBtmC,KAAK0f,KAAO,GACZ0mB,GAAa1R,IAAI10B,KACnB,CACO2mC,aACL3mC,KAAK0f,KAAO,GACZ,IAAK,IAAIze,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAK0f,KAAKve,KAAKnB,KAAKmc,IAAIlb,GAAG2B,KAE7B,OAAO5C,KAAK0f,IACd,CACO5M,SAEL,IAAI8zB,EAAO,EACP5mC,KAAKO,OAAS6L,EAAAA,GAAAA,OAChBw6B,EAAO5mC,KAAKqM,EACHrM,KAAKO,OAAS6L,EAAAA,GAAAA,UACvBw6B,EAAOt0B,KAAKu0B,MAAe,GAAT7mC,KAAKqM,IA2BzB,MAxBE,UACArM,KAAKM,GADL,WAIAN,KAAKO,KAAKwS,WAJV,YASA6zB,EATA,sBAoBA5mC,KAAK+F,gBApBL,gBAuBA/F,KAAKgG,YAET,CACOuN,UAAUnS,EAAWC,GAC1B,CAEK6R,0BAA0B5F,GAC/B,MAAMkX,EAAKlX,EAAElM,EAAIkM,EAAE6F,KACbsR,EAAKnX,EAAEjM,EAAIiM,EAAE8F,KACnB,IAAK,IAAInS,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAG2B,IAAIxB,GAAKojB,EACrBxkB,KAAKmc,IAAIlb,GAAG2B,IAAIvB,GAAKojB,CAIzB,CACOhU,SACL,IAAK,IAAIxP,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGwP,SAEdzQ,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EACpBokC,GAAa31B,OAAOzQ,KAAK2D,MAAO3D,KAElC,CACOiT,OACL,CAES6zB,UAAM5jC,GACflD,KAAK+mC,kBAAkB7jC,EACzB,CACWA,QACT,OAAOlD,KAAK4C,GACd,CACWM,MAAEA,GACXlD,KAAK4C,IAAMM,CACb,CACW+hC,QACT,OAAOjlC,KAAK2H,CACd,CACWs9B,MAAE/hC,GACXlD,KAAK2H,EAAIzE,CACX,CACWkf,iBAAalf,GACtBlD,KAAKgG,aAAe9C,EACpB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAG+E,aAAe9C,CAE/B,CACWkf,mBACT,OAAOpiB,KAAKgG,YACd,CACO6M,cAAczR,EAAWC,GAC9B,OAAiC,IAA7BrB,KAAKmH,0BAA6DxE,IAA7B3C,KAAKmH,sBAG1CnH,KAAKmkB,cAAc/iB,EAAGC,IACxBrB,KAAKoK,SAAU,GACR,IAETpK,KAAKoK,SAAU,GACR,GACT,CACO+Z,cAAc/iB,EAAWC,GAC9B,IAAIsI,EAAAA,EAAAA,IAAe,IAAItH,EAAAA,GAASjB,EAAGC,GAAIrB,KAAK2M,WAC1C,OAAO,EAET,IAAK,IAAI1L,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,OAAS,IAAKD,EACzC,IACEojB,EAAAA,EAAAA,IAAyB,IAAIhiB,EAAAA,GAASjB,EAAGC,GAAIrB,KAAKmc,IAAIlb,GAAG2B,IAAK5C,KAAKmc,IAAIlb,EAAI,GAAG2B,KAC9E5C,KAAK6Y,UAEL,OAAO,EAGX,OAAO,CACT,CACOlM,UACL,MAAMzJ,EAAgB,GACtB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCiC,EAAE/B,KAAKnB,KAAKmc,IAAIlb,GAAG2B,KAErB,OAAOM,CACT,CACOgb,mBACL,MAAMld,EAAiB,GACvB,IAAK,IAAIC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCD,EAAGG,KAAKnB,KAAKmc,IAAIlb,GAAG2B,KAEtB5C,KAAK4C,KAAMyjB,EAAAA,EAAAA,IAAqBrlB,EAClC,CACOqR,SAASjR,EAAWC,GACzB,OAAOiR,KAAKC,MAAMvS,KAAK4C,IAAIxB,EAAIA,IAAMpB,KAAK4C,IAAIxB,EAAIA,IAAMpB,KAAK4C,IAAIvB,EAAIA,IAAMrB,KAAK4C,IAAIvB,EAAIA,GAC1F,CAKO0lC,kBAAkB34B,GACvBpO,KAAKgnC,WAAWhnC,KAAK4C,IAAIxB,EAAIgN,EAAGpO,KAAK4C,IAAIvB,EAC3C,CACO2lC,WAAW5lC,EAAWC,GAC3BrB,KAAKimC,GAAKjmC,KAAKqS,SAASjR,EAAGC,GAC3B,MAAM4lC,EAAS,IAAI5kC,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAIA,EAAGpB,KAAK4C,IAAIvB,EAAIA,GAAGukB,YACtDxjB,GAAO2N,EAAAA,EAAAA,IAAS/P,KAAK4C,KAAKgjB,YAChC,IAAIqG,GAAQib,EAAAA,EAAAA,IAAqB9kC,EAAM6kC,IAAW30B,KAAK8Y,GAAK,MAChDvF,EAAAA,EAAAA,IAAIohB,EAAQ7kC,GAChBhB,EAAI,IACV6qB,IAAU,GAEZ,MAAMkb,EAA4B,EAAV70B,KAAK8Y,GAAUprB,KAAKqM,EAC5C,IAAIpL,EAAIjB,KAAKqM,EACb,KAAOpL,KAAK,CACV,MAAM8sB,EAAK/tB,KAAK4C,IAAIxB,EAAIpB,KAAKimC,GAAK3zB,KAAK80B,IAAInb,GACrC+B,EAAKhuB,KAAK4C,IAAIvB,EAAIrB,KAAKimC,GAAK3zB,KAAK+0B,IAAIpb,GAC3CA,GAASkb,EACTnnC,KAAKmc,IAAIlb,GAAG2B,IAAIxB,EAAI2sB,EACpB/tB,KAAKmc,IAAIlb,GAAG2B,IAAIvB,EAAI2sB,CACtB,CAEF,CACOsZ,YAAYlmC,EAAWC,GACN,IAAlBrB,KAAKsmC,SACPtmC,KAAKimC,GAAKjmC,KAAKqS,SAASjR,EAAGC,GACA,IAAlBrB,KAAKsmC,WACdtmC,KAAK0mC,GAAK1mC,KAAKqS,SAASjR,EAAGC,IAE7B,MAAM4lC,EAAS,IAAI5kC,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAIA,EAAGpB,KAAK4C,IAAIvB,EAAIA,GAAGukB,YACtDxjB,GAAO2N,EAAAA,EAAAA,IAAS/P,KAAK4C,KAAKgjB,YAChC,IAAIqG,GAAQib,EAAAA,EAAAA,IAAqB9kC,EAAM6kC,IAAW30B,KAAK8Y,GAAK,MAChDvF,EAAAA,EAAAA,IAAIohB,EAAQ7kC,GAChBhB,EAAI,IACV6qB,IAAU,GAEZ,MAAMkb,EAA4B,EAAV70B,KAAK8Y,GAAUprB,KAAKqM,EAC5C,IAAIpL,EAAIjB,KAAKqM,EACb,KAAOpL,KACL,GAAsB,IAAlBjB,KAAKsmC,SAAgB,CACvB,IAAIvY,EACAC,EACA/sB,EAAI,IAAM,GACZ8sB,EAAK/tB,KAAK4C,IAAIxB,EAAIpB,KAAKimC,GAAK3zB,KAAK80B,IAAInb,GACrC+B,EAAKhuB,KAAK4C,IAAIvB,EAAIrB,KAAKimC,GAAK3zB,KAAK+0B,IAAIpb,KAErC8B,EAAK/tB,KAAK4C,IAAIxB,GAAKpB,KAAKimC,GAAK,GAAK3zB,KAAK80B,IAAInb,GAC3C+B,EAAKhuB,KAAK4C,IAAIvB,GAAKrB,KAAKimC,GAAK,GAAK3zB,KAAK+0B,IAAIpb,IAE7CA,GAASkb,EACTnnC,KAAKmc,IAAIlb,GAAG2B,IAAIxB,EAAI2sB,EACpB/tB,KAAKmc,IAAIlb,GAAG2B,IAAIvB,EAAI2sB,CACtB,KAAO,CACL,IAAID,EACAC,EACA/sB,EAAI,IAAM,GACZ8sB,EAAK/tB,KAAK4C,IAAIxB,EAAIpB,KAAKimC,GAAK3zB,KAAK80B,IAAInb,GACrC+B,EAAKhuB,KAAK4C,IAAIvB,EAAIrB,KAAKimC,GAAK3zB,KAAK+0B,IAAIpb,KAErC8B,EAAK/tB,KAAK4C,IAAIxB,EAAIpB,KAAK0mC,GAAKp0B,KAAK80B,IAAInb,GACrC+B,EAAKhuB,KAAK4C,IAAIvB,EAAIrB,KAAK0mC,GAAKp0B,KAAK+0B,IAAIpb,IAEvCA,GAASkb,EACTnnC,KAAKmc,IAAIlb,GAAG2B,IAAIxB,EAAI2sB,EACpB/tB,KAAKmc,IAAIlb,GAAG2B,IAAIvB,EAAI2sB,CACtB,CAGJ,CACOwY,UAAUplC,EAAWC,GACtBrB,KAAKO,OAAS6L,EAAAA,GAAAA,OAChBpM,KAAKgnC,WAAW5lC,EAAGC,GACVrB,KAAKO,OAAS6L,EAAAA,GAAAA,SACvBpM,KAAKsnC,YAAYlmC,EAAGC,EAExB,CAEOkmC,cAAsC,IAA1BC,EAAc,uDAAGxnC,KAAKqM,EACvC,GAAIrM,KAAKmc,IAAIjb,OAAS,EAAG,CACvB,IAAImgB,EAAIrhB,KAAKmc,IAAIjb,OACjB,KAAOmgB,KACLrhB,KAAKmc,IAAIkF,GAAG5Q,SAEdzQ,KAAKmc,IAAM,EACb,CAEInc,KAAKO,OAAS6L,EAAAA,GAAAA,UAChBpM,KAAKqM,EAAa,EAATm7B,GAEX,IAAIvb,EAAQ,EACZ,MAAMkb,EAA4B,EAAV70B,KAAK8Y,GAAUprB,KAAKqM,EAC5C,IAAIpL,EAAIjB,KAAKqM,EACb,KAAOpL,KAAK,CACV,MAAMG,EAAIpB,KAAK4C,IAAIxB,EAAIpB,KAAKimC,GAAK3zB,KAAK80B,IAAInb,GACpC5qB,EAAIrB,KAAK4C,IAAIvB,EAAIrB,KAAKimC,GAAK3zB,KAAK+0B,IAAIpb,GAC1CA,GAASkb,EACT,MAAM19B,EAAI,IAAIsS,EAAO/b,KAAK2D,MAAOvC,EAAGC,GACpCoI,EAAE+I,QAAQxS,MACVyJ,EAAElJ,KAAO6L,EAAAA,GAAAA,MACT3C,EAAEzD,cAAe,EACjBhG,KAAKmc,IAAIhb,KAAKsI,EAChB,CACF,CACO88B,YACAvmC,KAAKmH,qBACRnH,KAAKke,mBAEPle,KAAKunC,aAEP,CAEW/mC,iBACT,OAAOR,KAAK+F,eACd,CACWvF,eAAW0C,GACpBlD,KAAK+F,gBAAkB7C,EACvBlD,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2c,eAAe3mB,KAAKwJ,SAC/E,CACWY,cACT,OAAOpK,KAAK4F,YACd,CACWwE,YAAQlH,GACjB,IAAIlD,KAAKmH,sBAITnH,KAAK4F,aAAe1C,GAChBlD,KAAKmH,qBAAT,CAGA,IAAK,MAAMsC,KAAKzJ,KAAKmc,IACnB1S,EAAEzH,aAAekB,GAGflD,KAAK4F,eAAiB5F,KAAK6F,aAEnB7F,KAAK4F,cAAgB5F,KAAK6F,aADpC7F,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB4c,WAAW5mB,KAAKwJ,UAI3ExJ,KAAK6F,WAAa7F,KAAK4F,YAVvB,CAWF,CACOwD,UACL,MAAMlG,EAAgB,GACtB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCiC,EAAE/B,KAAKnB,KAAKmc,IAAIlb,GAAG2B,KAErB,OAAOM,CACT,CACOsG,SACL,MAAMC,EAAI,IAAIpJ,EACZL,KAAKM,GACLN,KAAKO,KACLP,KAAK+F,gBACL/F,KAAK4F,aACL5F,KAAKqG,eAGP,OADAoD,EAAE1I,SAASf,KAAKoJ,WACTK,CACT,CAEO+F,WAAW9L,GAChB,GAAI1D,KAAKmc,IAAIjb,OAAS,EACpB,OAGF,MAAMF,EAAK,GACX,IAAK,IAAIC,EAAI,EAAIA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACtCD,EAAGG,KAAK,IAAIkB,EAAAA,GAASrC,KAAKmc,IAAIlb,GAAG2B,IAAIxB,EAAIpB,KAAK2D,MAAMC,mBAAmBD,MAAM0lB,cAAcC,mBAAmBloB,EAAEpB,KAAKmc,IAAIlb,GAAG2B,IAAIvB,EAAIrB,KAAK2D,MAAMC,mBAAmBD,MAAM0lB,cAAcC,mBAAmBjoB,IAGvMrB,KAAKO,OAAS6L,EAAAA,GAAAA,OAChBpM,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMkxB,KAAKC,KACrDhkC,EACA1C,EACAhB,KAAK4F,aACL5F,KAAK+F,iBAEE/F,KAAKO,OAAS6L,EAAAA,GAAAA,SACvBpM,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMkxB,KAAKE,MACrDjkC,EACA1D,KAAKmc,IACLnc,KAAK4F,aACL5F,KAAK+F,gBAGX,EArfWqgC,GACGp1B,KAAuB,GAD1Bo1B,GAEGnjB,QAAS,EAFZmjB,GAGGE,SAAW,EAHdF,GAIGpf,OAAQ,EAJXof,GAKGK,QAAU,EALbL,GAMG/jB,kBAAY,ECjBrB,MAAMulB,GAWX/nC,YAAYyE,GAA6B,KAVlCA,UAAI,OACJujC,YAA+BllC,EAAU,KACzCmlC,eAAkCnlC,EAAU,KAC5ColC,iBAAoCplC,EAAU,KAC9CqlC,6BAAgDrlC,EAAU,KAC1D3B,GAAiB,GAAG,KACpBoB,UAAI,OACH6lC,OAAmB,IAAI5lC,EAAAA,GAAS,EAAG,EAAG,GAAG,KACzC6lC,OAAS,GAAG,KACVnZ,OAAS,EAEjB/uB,KAAKsE,KAAOA,EACZtE,KAAK+uB,OAAS,CAChB,CACOoZ,UAAUnnC,GACfhB,KAAKgB,GAAKA,CAEZ,CACO2L,UACL,OAAO3M,KAAKgB,EACd,CACOonC,eACLpoC,KAAK6nC,YAASllC,EACd3C,KAAK8nC,eAAYnlC,EACjB3C,KAAK+nC,iBAAcplC,EACf3C,KAAKgB,GAAGE,OAAS,EACnBlB,KAAKsE,KAAKmM,SAIZzQ,KAAKgB,GAAGoc,OAAOpd,KAAKgB,GAAGyR,QAAQzS,KAAKgB,GAAGhB,KAAK+uB,QAAS,EAGvD,CACO6D,YAML,OALA5yB,KAAKoC,MAAOikB,EAAAA,EAAAA,IAAqBrmB,KAAKgB,IAK/BhB,KAAKoC,IACd,CACOimC,cAAc5hB,EAAc5b,GACjC,IAAIy9B,GAAY,EACZj2B,EAAW/I,OAAOC,iBACtB,IAAK,IAAItI,EAAI,EAAGA,EAAIjB,KAAKgB,GAAGE,SAAUD,EAAG,CACvC,MAAMsnC,GAASr7B,EAAAA,EAAAA,IAAYuZ,EAAIzmB,KAAKgB,GAAGC,IACnCsnC,EAAS19B,GAAO09B,EAASl2B,IAC3BA,EAAWk2B,EACXD,EAAWrnC,EAEf,CAEA,GAAIqnC,GAAY,EAGd,OAFAtoC,KAAK6nC,OAAS7nC,KAAKgB,GAAGsnC,GACtBtoC,KAAKgoC,wBAA0BhoC,KAAKgB,GAAGsnC,GAChCtoC,KAAKgB,GAAGsnC,GAmBjBtoC,KAAK6nC,YAASllC,EACd3C,KAAKgoC,6BAA0BrlC,CAEjC,CAqBOkQ,cAAczR,EAAWC,GAC9BrB,KAAKioC,OAAO7mC,EAAIA,EAChBpB,KAAKioC,OAAO5mC,EAAIA,EA6ChB,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAKgB,GAAGE,OAAS,IAAKD,EAAG,CAC3C,IAAIiM,EAAAA,EAAAA,IAAYlN,KAAKioC,OAAQjoC,KAAKgB,GAAGC,IAAMjB,KAAKkoC,OAASloC,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,YAI7I,OAHA5N,KAAK6nC,OAAS7nC,KAAKgB,GAAGC,GACtBjB,KAAK8nC,eAAYnlC,EACjB3C,KAAK+uB,MAAQ9tB,EACNA,EAGT,MAAMunC,EAAKxoC,KAAKgB,GAAGC,GAAGG,EAAwC,IAAnCpB,KAAKgB,GAAGC,EAAI,GAAGG,EAAIpB,KAAKgB,GAAGC,GAAGG,GACnDqnC,EAAKzoC,KAAKgB,GAAGC,GAAGI,EAAwC,IAAnCrB,KAAKgB,GAAGC,EAAI,GAAGI,EAAIrB,KAAKgB,GAAGC,GAAGI,GAEzD,GADArB,KAAK8nC,UAAY,IAAIzlC,EAAAA,GAASmmC,EAAIC,EAAI,IAClCv7B,EAAAA,EAAAA,IAAYlN,KAAKioC,OAAQjoC,KAAK8nC,WAAa9nC,KAAKkoC,OAASloC,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,YAGjJ,OAFA5N,KAAK6nC,YAASllC,EACd3C,KAAK+uB,MAAQ9tB,EACNA,EAETjB,KAAK8nC,eAAYnlC,CACnB,CACA,IAAIuK,EAAAA,EAAAA,IAAYlN,KAAKioC,OAAQjoC,KAAKgB,GAAGhB,KAAKgB,GAAGE,OAAS,IAAMlB,KAAKkoC,OAASloC,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,YAI9J,OAHA5N,KAAK6nC,OAAS7nC,KAAKgB,GAAGhB,KAAKgB,GAAGE,OAAS,GACvClB,KAAK8nC,eAAYnlC,EACjB3C,KAAK+uB,MAAQ/uB,KAAKgB,GAAGE,OAAS,EACvBlB,KAAKgB,GAAGE,OAAS,EAE1B,MAAMsnC,EAAKxoC,KAAKgB,GAAGhB,KAAKgB,GAAGE,OAAS,GAAGE,EAAqD,IAAhDpB,KAAKgB,GAAG,GAAGI,EAAIpB,KAAKgB,GAAGhB,KAAKgB,GAAGE,OAAS,GAAGE,GACjFqnC,EAAKzoC,KAAKgB,GAAGhB,KAAKgB,GAAGE,OAAS,GAAGG,EAAqD,IAAhDrB,KAAKgB,GAAG,GAAGK,EAAIrB,KAAKgB,GAAGhB,KAAKgB,GAAGE,OAAS,GAAGG,GAEvF,OADArB,KAAK8nC,UAAY,IAAIzlC,EAAAA,GAASmmC,EAAIC,EAAI,IAClCv7B,EAAAA,EAAAA,IAAYlN,KAAKioC,OAAQjoC,KAAK8nC,WAAa9nC,KAAKkoC,OAASloC,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,aACjJ5N,KAAK6nC,YAASllC,EACd3C,KAAK+uB,MAAQ/uB,KAAKgB,GAAGE,OAAS,EACvBlB,KAAKgB,GAAGE,OAAS,IAG1BlB,KAAK6nC,YAASllC,EACd3C,KAAK8nC,eAAYnlC,EACjB3C,KAAK+uB,OAAS,GACN,EACV,CACO2Z,eACD1oC,KAAK8nC,YACP9nC,KAAKgB,GAAGoc,OAAOpd,KAAK+uB,MAAQ,EAAG,EAAG/uB,KAAK8nC,WACvC9nC,KAAK6nC,OAAS7nC,KAAK8nC,UACnB9nC,KAAK8nC,eAAYnlC,EAErB,CACOgmC,eACL,MAAML,EAAWtoC,KAAKgB,GAAGhB,KAAK+uB,OAC9B,IAAI6Z,EAAe5oC,KAAKgB,GAAGhB,KAAK+uB,MAAQ,GACpC8Z,EAAe7oC,KAAKgB,GAAGhB,KAAK+uB,MAAQ,GACpC/uB,KAAK+uB,MAAQ,GAAK/uB,KAAK+uB,MAAQ/uB,KAAKgB,GAAGE,OAAS,GAClD0nC,EAAe5oC,KAAKgB,GAAGhB,KAAK+uB,MAAQ,GACpC8Z,EAAe7oC,KAAKgB,GAAGhB,KAAK+uB,MAAQ,IAC3B/uB,KAAK+uB,QAAU/uB,KAAKgB,GAAGE,OAAS,GACzC0nC,EAAe5oC,KAAKgB,GAAG,GACvB6nC,EAAe7oC,KAAKgB,GAAGhB,KAAK+uB,MAAQ,IACZ,IAAf/uB,KAAK+uB,QACd8Z,EAAe7oC,KAAKgB,GAAGhB,KAAKgB,GAAGE,OAAS,IAG1C,IAAIulB,GAAKN,EAAAA,EAAAA,IAAOmiB,EAAUM,GAK1B5oC,KAAKgB,GAAGoc,OAAOpd,KAAK+uB,MAAQ,EAAG,EAAGtI,GAElCA,GAAKN,EAAAA,EAAAA,IAAOmiB,EAAUO,GAKtB7oC,KAAKgB,GAAGoc,OAAOpd,KAAK+uB,MAAO,EAAGtI,EAChC,EChOK,MAAMkC,GAKX9oB,YAAY6B,GAA4B,KAJjCA,SAAG,OACH6qB,KAAO,EAAE,KACTC,KAAO,EAAE,KACR1jB,yBAAmB,EAEzB9I,KAAK0B,IAAMA,CACb,CACOmR,cAAczR,EAAWC,GAC9B,OAAgD,IAA5CrB,KAAK0B,IAAIonC,UAAUj2B,cAAczR,EAAGC,MAKtCrB,KAAK0B,IAAIiC,MAAMC,mBAAmBuS,eAAe2M,eAAewB,yBAC9DljB,EAAKpB,KAAK0B,IAAIiC,MAAM0lB,cAAcC,mBAAmBloB,EACrDC,EAAKrB,KAAK0B,IAAIiC,MAAM0lB,cAAcC,mBAAmBjoB,EACrDrB,KAAK0B,IAAIyG,UAMf,CACO4gC,SACL,GAAI/oC,KAAK0B,IAAIiE,WAAa3F,KAAK0B,IAAIM,cAAgBhC,KAAK0B,IAAI2E,cAC1D,MAAO,GA4BT,MAzBE,UACArG,KAAK0B,IAAIpB,GADT,WAIAN,KAAK0B,IAAInB,KAAKwS,WAJd,oBAYA/S,KAAK0B,IAAIonC,UAAU9nC,GAAGE,OAZtB,WAeAlB,KAAK0B,IAAI2H,UAAU4a,QAAQ,GAAGlR,WAf9B,eAqBA/S,KAAK0B,IAAIqE,gBArBT,gBAwBA/F,KAAK0B,IAAIsE,YAEb,CACOiN,OACL,CAEK1H,mBACAvL,KAAK0B,IAAIiC,MAAMC,mBAAmB4H,wBAAwBC,cAK3DzL,KAAK0B,IAAIyJ,UAAYnL,KAAK0B,IAAI6D,UAIlCvF,KAAK0B,IAAIyJ,UAAW,EAEpBnL,KAAK0B,IAAIwG,MAAQwD,SAASC,cAAc,OACxC3L,KAAK0B,IAAIwG,MAAM5H,GAAK,MAAQN,KAAK0B,IAAIpB,GACrCN,KAAK0B,IAAIwG,MAAM0D,MAAMC,SAAW,WAChC7L,KAAK0B,IAAIwG,MAAM0D,MAAME,OAAS,OAC9B9L,KAAK0B,IAAIwG,MAAM0D,MAAMrI,OAAS,MAC9BvD,KAAK0B,IAAIwG,MAAM0D,MAAMtI,MAAQ,MAC7BtD,KAAK0B,IAAIwG,MAAM0D,MAAMG,gBAAkB,MACvC/L,KAAK0B,IAAIiC,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAIC,YAC/EnM,KAAK0B,IAAIwG,OAEXlI,KAAK0B,IAAIwG,MAAM0D,MAAMU,IAAMtM,KAAK0B,IAAIkB,IAAIvB,EAAI,KAC5CrB,KAAK0B,IAAIwG,MAAM0D,MAAMW,KAAOvM,KAAK0B,IAAIkB,IAAIxB,EAAI,KAEzCpB,KAAK8I,qBACP0D,aAAaxM,KAAK8I,qBAEpB9I,KAAK8I,oBAAsB2D,YAAW,KAChCzM,KAAK0B,IAAIwG,OACXlI,KAAK0B,IAAIiC,MAAMC,mBAAmBmG,GAAGC,wBAAwB0C,eAC3D1M,KAAK0B,IAAI8H,SAEb,GACCxJ,KAAK0B,IAAI6G,iBACd,CACO0E,aAAa/J,GAClB,IAAI+Z,EAAM,GACN+rB,EAAS/rB,EACTb,EAAiB,IAAI/Z,EAAAA,IAAU,KAAM,KAEzC,IAAK,IAAIpB,EAAI,EAAGA,EAAIjB,KAAK0B,IAAIonC,UAAU9nC,GAAGE,OAAS,IAAKD,EACtD+nC,GAAS97B,EAAAA,EAAAA,IAAYlN,KAAK0B,IAAIonC,UAAU9nC,GAAGC,GAAIiC,GAC3C8lC,EAAS/rB,IACXA,EAAM+rB,EACN5sB,EAAOpc,KAAK0B,IAAIonC,UAAU9nC,GAAGC,IAG/B+nC,GAASC,EAAAA,EAAAA,IACP/lC,EAAE9B,EACF8B,EAAE7B,EACFrB,KAAK0B,IAAIonC,UAAU9nC,GAAGC,EAAI,GAAGG,EAAIpB,KAAK0B,IAAIonC,UAAU9nC,GAAGC,GAAGG,EAC1DpB,KAAK0B,IAAIonC,UAAU9nC,GAAGC,EAAI,GAAGI,EAAIrB,KAAK0B,IAAIonC,UAAU9nC,GAAGC,GAAGI,GAExD2nC,EAAS/rB,IACXA,EAAM+rB,EACN5sB,EAAKhb,EAAIpB,KAAK0B,IAAIonC,UAAU9nC,GAAGC,EAAI,GAAGG,EAAIpB,KAAK0B,IAAIonC,UAAU9nC,GAAGC,GAAGG,EACnEgb,EAAK/a,EAAIrB,KAAK0B,IAAIonC,UAAU9nC,GAAGC,EAAI,GAAGI,EAAIrB,KAAK0B,IAAIonC,UAAU9nC,GAAGC,GAAGI,GAsBvE,OAnBA2nC,GAAS97B,EAAAA,EAAAA,IAAYlN,KAAK0B,IAAIonC,UAAU9nC,GAAGhB,KAAK0B,IAAIonC,UAAU9nC,GAAGE,OAAS,GAAIgC,GAC1E8lC,EAAS/rB,IACXA,EAAM+rB,EACN5sB,EAAOpc,KAAK0B,IAAIonC,UAAU9nC,GAAGhB,KAAK0B,IAAIonC,UAAU9nC,GAAGE,OAAS,IAE9D8nC,GAASC,EAAAA,EAAAA,IACP/lC,EAAE9B,EACF8B,EAAE7B,EACFrB,KAAK0B,IAAIonC,UAAU9nC,GAAGhB,KAAK0B,IAAIonC,UAAU9nC,GAAGE,OAAS,GAAGE,EAAIpB,KAAK0B,IAAIonC,UAAU9nC,GAAG,GAAGI,EACrFpB,KAAK0B,IAAIonC,UAAU9nC,GAAGhB,KAAK0B,IAAIonC,UAAU9nC,GAAGE,OAAS,GAAGG,EAAIrB,KAAK0B,IAAIonC,UAAU9nC,GAAG,GAAGK,GAEnF2nC,EAAS/rB,IACXA,EAAM+rB,EACN5sB,EAAKhb,EACHpB,KAAK0B,IAAIonC,UAAU9nC,GAAGhB,KAAK0B,IAAIonC,UAAU9nC,GAAGE,OAAS,GAAGE,EAAIpB,KAAK0B,IAAIonC,UAAU9nC,GAAG,GAAGI,EACvFgb,EAAK/a,EACHrB,KAAK0B,IAAIonC,UAAU9nC,GAAGhB,KAAK0B,IAAIonC,UAAU9nC,GAAGE,OAAS,GAAGG,EAAIrB,KAAK0B,IAAIonC,UAAU9nC,GAAG,GAAGK,GAGlF,CAAC4b,EAAKb,EACf,EC1IK,MAAM8sB,GAEXrpC,YAAY6B,GAA4B,KADjCA,SAAG,EAER1B,KAAK0B,IAAMA,CACb,CACOynC,SACL,MAAM1/B,EAAI,IAAIpJ,EACZL,KAAK0B,IAAIpB,GACT8L,EAAAA,GAAAA,cACApM,KAAK0B,IAAIqE,gBACT/F,KAAK0B,IAAIkE,aACT5F,KAAK0B,IAAI2E,eAEXoD,EAAE1I,SAASf,KAAKoJ,WAEhB,MAAMvI,EAASb,KAAK0B,IAAI2B,eAAeoQ,SAKvC,OAJI5S,IACF4I,EAAE5I,OAASA,GAGN4I,CACT,CACQL,UACN,MAAMpI,EAAK,GACX,IAAK,IAAIC,EAAI,EAAGA,EAAIjB,KAAK0B,IAAIonC,UAAU9nC,GAAGE,SAAUD,EAClDD,EAAGG,KAAKnB,KAAK0B,IAAIonC,UAAU9nC,GAAGC,IAEhC,OAAOD,CACT,CACOyP,SACL,KADoB,yDACN,CACZ,MAAM2N,EAAQpe,KAAKmpC,SACf/qB,GACFpe,KAAK0B,IAAIiC,MAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB,CAACvG,GAEtF,CACApe,KAAK0B,IAAIqc,YACX,ECtCK,MAAMqrB,GAEXvpC,YAAY6B,GAA4B,KADjCA,SAAG,EAER1B,KAAK0B,IAAMA,CACb,CACOgP,iBAID1Q,KAAK0B,IAAIonC,UAAUjB,OAErB7nC,KAAK0B,IAAIonC,UAAUf,YAAc/nC,KAAK0B,IAAIonC,UAAUjB,QAGtD7nC,KAAK0B,IAAIonC,UAAUf,iBAAcplC,EAGjC3C,KAAK0B,IAAIiC,MAAMC,mBAAmBuS,eAAe2M,eAAe+D,iBAChE7mB,KAAK0B,IAAI6J,mBAKX,CACOoF,kBACL,CAEK2wB,iBAAiBh0B,GACtB,CAEK+7B,eAAe/7B,GACpB,EC9BG,MAAMkI,WAA0BE,EAErC7V,YAAY6B,GACVwD,MAAMxD,GAAK,KAFNA,SAAG,EAGR1B,KAAK0B,IAAMA,CACb,CACO8N,WAAW9L,GAChB1D,KAAKmU,iBAAiB3Q,SACtBxD,KAAKyV,MAAMjS,SACXxD,KAAK0B,IAAI0G,UAAU5E,OAAOE,GAC1B1D,KAAK0B,IAAI4nC,eAMT,MAAMtoC,EAAK,GACX,IAAK,IAAIC,EAAI,EAAIA,EAAIjB,KAAK0B,IAAIonC,UAAU9nC,GAAGE,SAAUD,EACnDD,EAAGG,KACD,IAAIkB,EAAAA,GACFrC,KAAK0B,IAAIonC,UAAU9nC,GAAGC,GAAGG,EAAIpB,KAAK0B,IAAIiC,MAAM0lB,cAAcC,mBAAmBloB,EAC7EpB,KAAK0B,IAAIonC,UAAU9nC,GAAGC,GAAGI,EAAIrB,KAAK0B,IAAIiC,MAAM0lB,cAAcC,mBAAmBjoB,IAKnFrB,KAAK8gB,cAAcpd,EAAK1C,EAE1B,CACOuoC,gBAAgB7lC,GACjB1D,KAAK0B,IAAIiC,MAAMC,mBAAmB4lC,kBAAoBvzB,EAAAA,GAAAA,WAGtDjW,KAAK0B,IAAIkE,cAAgB5F,KAAK0B,IAAIqE,kBACpC/F,KAAKypC,YACH/lC,EAAK1D,KAAK0B,IAAIonC,UAAU9nC,GAAIhB,KAAK0B,IAAI2G,eACrCrI,KAAK0B,IAAIiC,MAAMC,mBAAmBgL,oBAAoB+G,6BAa1D3V,KAAK0pC,kBAAkBhmC,GACzB,CASQod,cAAcpd,EAA+B1C,GACnDhB,KAAKuhB,uBAAuBvgB,GAExBhB,KAAK0B,IAAIkE,cAAgB5F,KAAK0B,IAAIqE,iBACpC/F,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2K,KAAKC,aACzDzd,EACA1D,KAAK0B,IAAI2B,eAAe1C,YACxBK,EACAhB,KAAK0B,IAAIsF,YACThH,KAAK0B,IAAIwF,gBACTlH,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,OAChFtV,KAAK0B,IAAIkE,aACT5F,KAAK0B,IAAIqE,iBAEX/F,KAAKsV,OAAS,IACdtV,KAAKiP,OAAS,EACdjP,KAAK0B,IAAI0E,SAAU,EACnBpG,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2K,KAAKxH,QACzDhW,EACA1D,KAAK0B,IAAI2B,eAAe1C,YACxBK,EACAhB,KAAK0B,IAAIyF,oBACTnH,KAAK0B,IAAIsF,YACThH,KAAK0B,IAAIwF,gBACTlH,KAAK0B,IAAI4D,OACTtF,KAAK0B,IAAI0I,QACTpK,KAAK0B,IAAIqE,mBAGX/F,KAAKsV,MAAQ,EACbtV,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2K,KAAKxH,QACzDhW,EACA1D,KAAK0B,IAAI2B,eAAe1C,YACxBK,EACAhB,KAAK0B,IAAIyF,oBACTnH,KAAK0B,IAAIsF,YACThH,KAAK0B,IAAIwF,gBACTlH,KAAK0B,IAAI4D,OACTtF,KAAK0B,IAAI0I,QACTpK,KAAK0B,IAAIqE,iBAGf,CACQ2jC,kBAAkBhmC,GACpB1D,KAAK0B,IAAIonC,UAAUf,aAKrB/nC,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKW,aACzDzT,EACA1D,KAAK0B,IAAI2B,eAAesmC,wBACxB3pC,KAAK0B,IAAIonC,UAAUf,YAAY3mC,EAAIpB,KAAK0B,IAAIiC,MAAM0lB,cAAcC,mBAAmBloB,EACnFpB,KAAK0B,IAAIonC,UAAUf,YAAY1mC,EAAIrB,KAAK0B,IAAIiC,MAAM0lB,cAAcC,mBAAmBjoB,EACnFrB,KAAK0B,IAAIiC,MAAMC,mBAAmBgL,oBAAoB+G,4BAI5D,CACQ8zB,YAAY/lC,EAA+B1C,EAAgB6D,GACjE,MAAM0nB,EAAOvsB,KAAK0B,IAAIiC,MAAM0lB,cAAcC,mBAAmBloB,EACvDorB,EAAOxsB,KAAK0B,IAAIiC,MAAM0lB,cAAcC,mBAAmBjoB,EAC7D,IAAK,IAAIJ,EAAI,EAAGA,EAAID,EAAGE,OAAS,IAAKD,EACnCjB,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKC,aACzD/S,EACA1D,KAAK0B,IAAI2B,eAAe8X,gBACxBna,EAAGC,GAAGG,EAA8B,IAAzBJ,EAAGC,EAAI,GAAGG,EAAIJ,EAAGC,GAAGG,GAAWmrB,EAC1CvrB,EAAGC,GAAGI,EAA8B,IAAzBL,EAAGC,EAAI,GAAGI,EAAIL,EAAGC,GAAGI,GAAWmrB,EAC1C3nB,EACA7E,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,QAChF,GAEFtV,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKU,UACzDxT,EACA1D,KAAK0B,IAAI2B,eAAe8X,gBACxBna,EAAGC,GAAGG,EAAImrB,EACVvrB,EAAGC,GAAGI,EAAImrB,EACV3nB,EACA7E,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,QAGpFtV,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKC,aACzD/S,EACA1D,KAAK0B,IAAI2B,eAAe8X,gBACxBna,EAAGA,EAAGE,OAAS,GAAGE,EAAsC,IAAjCJ,EAAG,GAAGI,EAAIJ,EAAGA,EAAGE,OAAS,GAAGE,GAAYmrB,EAC/DvrB,EAAGA,EAAGE,OAAS,GAAGG,EAAsC,IAAjCL,EAAG,GAAGK,EAAIL,EAAGA,EAAGE,OAAS,GAAGG,GAAYmrB,EAC/D3nB,EACA7E,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,QAChF,GAEFtV,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMC,KAAKU,UACzDxT,EACA1D,KAAK0B,IAAI2B,eAAe8X,gBACxBna,EAAGA,EAAGE,OAAS,GAAGE,EAAImrB,EACtBvrB,EAAGA,EAAGE,OAAS,GAAGG,EAAImrB,EACtB3nB,EACA7E,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,OAEpF,CACQiM,uBAAuBvgB,GAC7BhB,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASqc,UAAUC,iBACnDzhB,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuc,aAC3C1hB,KAAK0B,IAAIyG,UACTnH,EAEJ,ECnKK,MAAMka,WAAuBM,EAGlC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KAHNA,SAAG,OACHioC,6BAAuB,EAG5B3pC,KAAK2pC,wBAA0B,IAAIxxB,EACnCnY,KAAKmO,cACLnO,KAAK0K,aACP,CACOyD,cACAnO,KAAKob,WACRpb,KAAK+W,MAAMC,aAAeM,EAAa+T,aACvCrrB,KAAKob,UAAW,EAChBjD,EAAY8O,yBACVjnB,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElDyI,EAAY+O,6BACVlnB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElDyI,EAAY0D,eAAe7b,KAAKmb,gBAAiBnb,KAAK2pC,yBAE1D,CACOj/B,cAAsD,IAA1C4gB,EAA2B,4DAAG3oB,EAE/C3C,KAAKob,UAAW,OACFzY,IAAV2oB,IACFA,EAAQtrB,KAAK0B,IAAIiC,MAAMC,mBAAmB4H,wBAAwB+f,sBAAsBC,aAE1FrT,EAAYsT,yBACVzrB,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD4b,EACAA,GAGFnT,EAAYuT,6BACV1rB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD4b,GAGFnT,EAAY0D,eAAe7b,KAAKmb,gBAAiBnb,KAAK2pC,yBACtD3pC,KAAKqb,cAAgBiQ,CACvB,CAEOjd,kBAAkBzC,GA0CvB,OApCIA,EAAMtI,QACRtD,KAAK+W,MAAMzT,MAAQsI,EAAMtI,YAEPX,IAAhBiJ,EAAM0f,QACRtrB,KAAK+W,MAAMC,aAAepL,EAAM0f,OAG9B1f,EAAM6N,UAAUvY,OAAS,GAAK0K,EAAMxH,KAAKlD,OAAS,IACpDlB,KAAKqb,cAAgBzP,EAAM6N,UAC3BzZ,KAAKsb,aAAe1P,EAAMxH,KAC1B+T,EAAYwT,+BACV3rB,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD9D,EAAM6N,UACN7N,EAAMxH,MAER+T,EAAYyT,mCACV5rB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD9D,EAAM6N,UACN7N,EAAMxH,MAER+T,EAAYyxB,qBAAqB5pC,KAAKmb,gBAAiBnb,KAAK2pC,yBAG5D3pC,KAAK0K,YAAYkB,EAAM6N,YAErB7N,EAAM/G,QACR7E,KAAKW,YAAYgO,WAAa/C,EAAM/G,MACpC7E,KAAK+W,MAAMlS,MAAQ+G,EAAM/G,OAE3B7E,KAAKob,UAAW,GAKT,CACT,CACOvN,QAAQ3K,GACblD,KAAKW,YAAYga,KAAOzX,EACxBlD,KAAK0B,IAAIiC,MAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAC3D9Q,KAAK0B,IAAI8H,SAEb,CAEOiK,SACL,IAAKzT,KAAKob,SACR,OAGF,MAAMyQ,EAAc,CAClBvoB,MAAOtD,KAAK+W,MAAMzT,MAClBuB,MAAO7E,KAAKW,YAAYgO,WAExB8K,UAAWzZ,KAAKqb,cAChBjX,KAAMpE,KAAKsb,cA0Cb,OARItb,KAAK+W,MAAMC,eAAiBM,EAAa+T,eAC3CQ,EAAOP,MAAQtrB,KAAK+W,MAAMC,cAOrB6U,CACT,CAEUtQ,YAAY3P,GACpB,GACEA,EAAM6N,UAAUvY,SAAWlB,KAAKqb,cAAcna,QAC9C0K,EAAMxH,KAAKlD,SAAWlB,KAAKsb,aAC3B,CACA,IAAK,IAAIra,EAAI,EAAGA,EAAI2K,EAAM6N,UAAUvY,OAAQD,IAC1C,GAAI2K,EAAM6N,UAAUxY,KAAOjB,KAAKqb,cAAcpa,GAC5C,OAAO,EAGX,IAAK,IAAIA,EAAI,EAAGA,EAAI2K,EAAMxH,KAAKlD,OAAQD,IACrC,GAAI2K,EAAMxH,KAAKnD,KAAOjB,KAAKsb,aAAara,GACtC,OAAO,CAGb,CACA,OAAO,CACT,EC5KK,MAAM6qB,GAKXjsB,YAAY6B,GAA4B,KAJjCA,SAAG,OACHwB,OAAC,OAEA2mC,cAAe,EAErB7pC,KAAK0B,IAAMA,CACb,CACOooC,4BACL9pC,KAAK6pC,cAAe,CACtB,CACO32B,0BAA0B5F,GAC/B,GAAItN,KAAK0B,IAAIiE,WAAa3F,KAAK0B,IAAIM,cAAgBhC,KAAK0B,IAAI2E,cAC1D,OAEF,MAAMme,EAAKlX,EAAElM,EAAIkM,EAAE6F,KACbsR,EAAKnX,EAAEjM,EAAIiM,EAAE8F,KAEnB,GAAIpT,KAAK0B,IAAIonC,UAAUjB,OAAQ,CAqB7B,GAlBI7nC,KAAK0B,IAAIiC,MAAMC,mBAAmB4H,wBAAwB8C,aAAaqQ,cACrE3e,KAAK6pC,eACP7pC,KAAK0B,IAAIonC,UAAUH,eACnB3oC,KAAK6pC,cAAe,GAIxB7pC,KAAK0B,IAAIonC,UAAUjB,OAAOzmC,GAAKojB,EAC/BxkB,KAAK0B,IAAIonC,UAAUjB,OAAOxmC,GAAKojB,EAU3BzkB,KAAK0B,IAAIqoC,6BACX,OAoBF,OAjBI/pC,KAAK0B,IAAI4I,iBACXtK,KAAK0B,IAAI4I,eAAe4I,0BAA0B5F,GAC9CtN,KAAK0B,IAAI4I,gBAAkBtK,KAAK0B,IAAI4I,eAAe+I,aACrDrT,KAAK0B,IAAI4I,eAAe+I,WAAWC,GAAGlS,GAAKojB,EAC3CxkB,KAAK0B,IAAI4I,eAAe+I,WAAWC,GAAGjS,GAAKojB,SAY/CzkB,KAAK0B,IAAIsoC,gBAAiB,EAE5B,CAEA,GAAIhqC,KAAK0B,IAAIonC,UAAUhB,UAOrB,OALA9nC,KAAK0B,IAAIonC,UAAUJ,oBAInB1oC,KAAK0B,IAAIsoC,gBAAiB,GAK5BhqC,KAAK0B,IAAIsoC,gBAAiB,EAC1B,IAAK,IAAI/oC,EAAI,EAAGA,EAAIjB,KAAK0B,IAAIonC,UAAU9nC,GAAGE,SAAUD,EAClDjB,KAAK0B,IAAIonC,UAAU9nC,GAAGC,GAAGG,GAAKojB,EAC9BxkB,KAAK0B,IAAIonC,UAAU9nC,GAAGC,GAAGI,GAAKojB,EAmB5BzkB,KAAK0B,IAAI4I,iBACXtK,KAAK0B,IAAI4I,eAAe4I,0BAA0B5F,GAC9CtN,KAAK0B,IAAI4I,eAAe+I,aAC1BrT,KAAK0B,IAAI4I,eAAe+I,WAAWC,GAAGlS,GAAKojB,EAC3CxkB,KAAK0B,IAAI4I,eAAe+I,WAAWC,GAAGjS,GAAKojB,GAYjD,CACOlR,UAAUnS,EAAWC,GAC1B,ECnGG,MAAM4oC,WAA6BhlC,EA+BxC,cAAqBtB,QACoBhB,IAAnCgB,EAAMoxB,2BACRpxB,EAAMoxB,8BAA2BpyB,EAErC,CACA,sBAA6BgB,GAC3B,QAAuChB,IAAnCgB,EAAMoxB,yBAAwC,CAChD,MAAM/zB,EAAK2C,EAAMoxB,yBAAyBpoB,UACtC3L,GACFipC,GAAqBC,WAAWvmC,EAAO3C,GACvC2C,EAAMoxB,8BAA2BpyB,EACjCgB,EAAMC,mBAAmB4H,wBAAwBgX,eAEjD7e,EAAMoxB,8BAA2BpyB,EACjCgB,EAAMC,mBAAmB4H,wBAAwBgX,aAErD,CACF,CACA,YAAmB7e,EAAc2J,QACQ3K,IAAnCgB,EAAMoxB,0BACRpxB,EAAMoxB,yBAAyBD,MAEnC,CACA,iBAAwBnxB,EAAc2J,QACG3K,IAAnCgB,EAAMoxB,0BAGNpxB,EAAMoxB,yBAAyBb,GAAGhzB,OAAS,GAC7CyC,EAAMoxB,yBAAyBL,IAAI,IAAIryB,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,GAE3D,CACA,sBACEsC,EACA2J,GAGC,IADD/M,EAAW,uDAAG6L,EAAAA,GAAAA,mBAEQzJ,IAAlBgB,EAAMgP,eAG6BhQ,IAAnCgB,EAAMoxB,2BACRpxB,EAAMoxB,yBAA2B,IAAIf,EAAqBrwB,EAAOpD,GACjEoD,EAAMoxB,yBAAyBL,IAAI,IAAIryB,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,IACvDsC,EAAMoxB,yBAAyBL,IAAI,IAAIryB,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,KAEzDsC,EAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMyW,UAAUC,iBAAiBC,2BAA4B,EAC5G,CACA,iBAAwBhf,EAAc2J,GACpC,QAAuC3K,IAAnCgB,EAAMoxB,yBAAV,CAGA,GAAIpxB,EAAMC,mBAAmB4H,wBAAwB8C,aAAayQ,WAAY,CAC5E,MAAM7B,EAAKvZ,EAAMoxB,yBAAyBb,GAAGvwB,EAAMoxB,yBAAyBb,GAAGhzB,OAAS,IACpFgM,EAAAA,EAAAA,IAAYgQ,EAAGha,EAAG,IAAIb,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,IAAM,IAC9CsC,EAAMoxB,yBAAyBL,IAAI,IAAIryB,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,GAE3D,CACIsC,EAAMoxB,yBAAyBb,GAAGhzB,OAAS,GAC7CyC,EAAMoxB,yBAAyBF,UAAUvnB,EAAElM,EAAGkM,EAAEjM,EARlD,CAWF,CACA,wBAA+BsC,EAAc2J,GAC3C,QAAuC3K,IAAnCgB,EAAMoxB,yBAAV,CAKA,GAAIpxB,EAAMC,mBAAmB4H,wBAAwB6b,cACnD,GAAI1jB,EAAMoxB,yBAAyBb,GAAGhzB,OAAS,EAAG,CAChD,IAAIF,EAAK2C,EAAMoxB,yBAAyBpoB,UACpC3L,IACFA,EAAKA,EAAGg1B,MAAM,EAAGh1B,EAAGE,OAAS,GACzBF,GACFipC,GAAqBC,WAAWvmC,EAAO3C,GACvC2C,EAAMoxB,8BAA2BpyB,EACjCgB,EAAMC,mBAAmB4H,wBAAwBgX,eAEjD7e,EAAMoxB,8BAA2BpyB,EACjCgB,EAAMC,mBAAmB4H,wBAAwBgX,cAGvD,OAEA,GAAI7e,EAAMoxB,yBAAyBb,GAAGhzB,OAAS,EAAG,CAChD,MAAMF,EAAK2C,EAAMoxB,yBAAyBpoB,UACtC3L,GACFipC,GAAqBC,WAAWvmC,EAAO3C,GACvC2C,EAAMoxB,8BAA2BpyB,EACjCgB,EAAMC,mBAAmB4H,wBAAwBgX,eAEjD7e,EAAMoxB,8BAA2BpyB,EACjCgB,EAAMC,mBAAmB4H,wBAAwBgX,aAErD,CAGF7e,EAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMyW,UAAUC,iBAAiBC,2BAA4B,CAhC1G,CAiCF,CACA,wBAA+Bhf,EAAc3C,GAC3C,OAAOhB,KAAKkqC,WAAWvmC,EAAO3C,EAahC,CACA,kBAAyB2C,EAAc3C,GAUrC,OADA2C,EAAMoxB,8BAA2BpyB,EAC1B,IAAIsnC,GAAqBtmC,EAAO3C,EAAIoL,EAAAA,GAAAA,eAAqB,GAAO,EACzE,CACA,gBAAuBzI,EAAc0M,GAAoD,IAArCtJ,EAAM,wDAAUuV,EAAU,wDAC5E,MAAMtb,EAAiB,GACvB,IAAK,IAAIC,EAAI,EAAGA,EAAIoP,EAAEzP,MAAMM,SAAUD,EAAG,CAEvC,MAAMwI,EAAI,IAAIpH,EAAAA,GAASgO,EAAEzP,MAAMK,GAAGf,GAAImQ,EAAEzP,MAAMK,GAAGd,IAOjDa,EAAGG,KAAKsI,EACV,CACA,MAAM/H,EAAM,IAAIuoC,GAAqBtmC,EAAO3C,EAAIoL,EAAAA,GAAAA,eAAqB,GAoCrE,OAlCA1K,EAAInB,KAAO6L,EAAAA,GAAMiE,EAAE9P,MAGjBmB,EAAIpB,GADFgc,EACO3Y,EAAMsF,UAENoH,EAAE/P,GAGboB,EAAIyF,qBAAsB,EAC1BzF,EAAI0I,SAAU,EACd1I,EAAI2E,cAAgBgK,EAAE3P,SAClB2P,EAAE3P,SACJgB,EAAIwF,gBAAkB,EAEtBxF,EAAIwF,gBAAkB,EAGpBmJ,EAAExP,QAAUwP,EAAExP,OAAO8Z,OACvBjZ,EAAI2B,eAAe1C,YAAYga,KAAOtK,EAAExP,OAAO8Z,MAE7CtK,EAAExP,QACJa,EAAI2M,kBAAkBgC,EAAExP,QAMtBwP,EAAEvP,KAAK+D,OACTnD,EAAIyH,UAAUkH,EAAEvP,KAAK+D,OAEvBnD,EAAIoO,kBACC/I,GACHpD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,UAEpE9H,CACT,CAGA7B,YACE8D,EACA3C,GAIC,IAHDT,EAAW,uDAAG6L,EAAAA,GAAAA,cACdrF,EAAM,wDAGN7B,MAAMvB,GAAO,KApNRwB,cAAQ,OACR9B,oBAAc,OACb8mC,iBAAW,OACXC,yBAAmB,OACnBC,0BAAoB,OACpBC,6BAAuB,OAE/B5iC,UAAI,OACJsiC,gBAAiB,EAAM,KACvBpkC,kBAAY,OACZod,cAAQ,OACR8P,YAAM,OAENlT,eAAS,OACTyW,YAAc,GAAG,KACjB0T,8BAA+B,EAAK,KAS7BjB,eAAS,EA6Ld9oC,KAAKO,KAAOA,EACZP,KAAKmH,qBAAsB,EAC3BnH,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EACpBhC,KAAKsF,QAAS,EACdtF,KAAK+G,OAASA,EACd/G,KAAKuqC,UAAUvpC,GACfhB,KAAKspC,eACLtpC,KAAK8P,kBACL9P,KAAK4c,gBACL5c,KAAK2D,MAAM6mC,wBAAwBxqC,MAC9BA,KAAK+G,QACR/G,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiB9Q,KAAKwJ,SAEnF,CACQoT,gBACN5c,KAAKqD,eAAiB,IAAI6X,GAAelb,MACzCA,KAAKoqC,oBAAsB,IAAIhB,GAAoBppC,MACnDA,KAAKmqC,YAAc,IAAIjB,GAAYlpC,MACnCA,KAAKqqC,qBAAuB,IAAI1hB,GAAqB3oB,MACrDA,KAAKsqC,wBAA0B,IAAIxe,GAAwB9rB,MAC3DA,KAAKmF,SAAW,IAAIqQ,GAAkBxV,KACxC,CACQuqC,UAAUvpC,GAChBhB,KAAK8oC,UAAY,IAAIlB,GAAU5nC,MAC/BA,KAAK8oC,UAAUX,UAAUnnC,EAC3B,CACOsoC,eACLtpC,KAAK4C,IAAM5C,KAAK8oC,UAAUlW,WAC5B,CACOkX,4BACL9pC,KAAKsqC,wBAAwBR,2BAC/B,CACO78B,aAAa/J,GAClB,OAAOlD,KAAKqqC,qBAAqBp9B,aAAa/J,EAChD,CACOiK,oBAEL,OAAOnN,KAAK8oC,UAAUjB,MACxB,CACOl7B,UACL,OAAO3M,KAAK8oC,UAAU9nC,EACxB,CACOkP,gBACLlQ,KAAKuH,eAAgB,EACrBvH,KAAK0H,KAAO1H,KAAK2D,MAAMC,mBAAmBuB,SAASqL,UAAUtN,EAC7DlD,KAAKuG,YAAa,CACpB,CACO6I,eACDpP,KAAK6I,YAAY3H,OAAS,IAO9BlB,KAAKiL,QAAS,EACdjL,KAAK2E,aAAc,EAErB,CAEO8L,SAA+B,IAAxB5J,IAAQ,yDACpB,IAAI7G,KAAK2F,UAAa3F,KAAKgC,eAAgBhC,KAAKqG,cAAhD,CAGA,GAAIrG,KAAK8oC,UAAUf,YAAa,CAC9B/nC,KAAK8oC,UAAUV,eACf,MAAMtnC,EAAOd,KAAKwJ,SAClB,GAAI1I,EAEF,YADAd,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBqU,eAAe,CAACvd,GAG7E,CACAd,KAAKmqC,YAAY15B,OAAO5J,EATxB,CAUF,CACOkX,aACL/d,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EACpBhC,KAAK4M,mBACL5M,KAAK2D,MAAM8mC,2BAA2BzqC,MACtCA,KAAK2D,MAAM8a,eAAeze,KAC5B,CAEO6S,cAAczR,EAAWC,GAC9B,OAAOrB,KAAKqqC,qBAAqBx3B,cAAczR,EAAGC,EACpD,CACOyR,SACL,OAAO9S,KAAKqqC,qBAAqBtB,QACnC,CACO91B,OACLjT,KAAKqqC,qBAAqBp3B,MAC5B,CAGOC,0BAA0B5F,GAC/BtN,KAAKsqC,wBAAwBp3B,0BAA0B5F,EACzD,CACOiG,UAAUnS,EAAWC,GAC1BrB,KAAKsqC,wBAAwB/2B,UAAUnS,EAAGC,EAC5C,CAEOmI,SACL,OAAOxJ,KAAKmqC,YAAYhB,QAC1B,CAEOz4B,iBACL1Q,KAAKoqC,oBAAoB15B,gBAC3B,CACOC,kBACL3Q,KAAKoqC,oBAAoBz5B,iBAC3B,CAEOnB,WAAW9L,GAChB1D,KAAKmF,SAASqK,WAAW9L,EAC3B,CACO6lC,gBAAgB7lC,GACrB1D,KAAKmF,SAASokC,gBAAgB7lC,EAChC,CACWhD,eACT,OAAOV,KAAKqG,aACd,CACW3F,aAASwC,GAClBlD,KAAKsG,YAActG,KAAKqG,cACxBrG,KAAKqG,cAAgBnD,EACrBlD,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBC,UAAUjK,KAAKwJ,SAC1E,CACWhJ,iBACT,OAAOR,KAAK+F,eACd,CACWvF,eAAW0C,GAChBlD,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,eAG5CrG,KAAK8oC,UAAUjB,SAInB7nC,KAAK+F,gBAAkB7C,EAClBA,IACHlD,KAAK8oC,UAAUf,iBAAcplC,GAE/B3C,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2c,eAAe3mB,KAAKwJ,UAC/E,CACWY,cACT,OAAOpK,KAAK4F,YACd,CACWwE,YAAQlH,GACblD,KAAKmH,sBAGTnH,KAAK4F,aAAe1C,GAChBlD,KAAK4F,eAAiB5F,KAAK6F,aAEnB7F,KAAK4F,cAAgB5F,KAAK6F,aADpC7F,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB4c,WAAW5mB,KAAKwJ,UAI3ExJ,KAAK6F,WAAa7F,KAAK4F,aAClB1C,IACHlD,KAAK8G,mBAAoB,EACzB9G,KAAK4M,oBAET,CACOvB,cACL,MAAO,CAACrL,KAAK4C,IACf,CACO2I,mBACLvL,KAAKqqC,qBAAqB9+B,kBAC5B,CACOm/B,eAAejkB,EAAc5b,GAClC,GAAI7K,KAAK8oC,UAAUT,cAAc5hB,EAAI5b,GACnC,OAAO7K,IAGX,CACO2qC,eAAelkB,GACpB,OAAOzmB,KAAK8oC,UAAUT,cAAc5hB,EAAI,GAC1C,CACOpX,cACDrP,KAAK8H,oBAAgCnF,IAAf3C,KAAKkI,QACzBlI,KAAKgI,eACPhI,KAAKkI,MAAM0D,MAAMU,IACftM,KAAK4C,IAAIvB,EACTrB,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAOpM,OAChEvD,KAAKiI,iBACL,KACFjI,KAAKkI,MAAM0D,MAAMW,KAAOvM,KAAK4C,IAAIxB,EAAI,OAErCpB,KAAKkI,MAAM0D,MAAMU,IAAMtM,KAAK4C,IAAIvB,EAAI,KACpCrB,KAAKkI,MAAM0D,MAAMW,KAAOvM,KAAK4C,IAAIxB,EAAI,MAG3C,CACO2oB,8BACL,IAAK/pB,KAAKsK,iBAAmBtK,KAAKsK,eAAe+I,WAC/C,OAAO,EAOT,GALArT,KAAK+pC,8BAA+B,EAKhC/pC,KAAK8oC,UAAUjB,QACb7nC,KAAKsK,gBAAkBtK,KAAKsK,eAAe+I,WAAY,CACzD,IAAInG,EAAAA,EAAAA,IAAYlN,KAAK8oC,UAAUjB,OAAQ7nC,KAAKsK,eAAe+I,WAAWC,IAAM,EAE1E,OADAtT,KAAK+pC,8BAA+B,GAC7B,EAET/pC,KAAK+pC,8BAA+B,CACtC,CAKF,IAAI/f,GAAgB,EACpB,IAAK,IAAI/oB,EAAI,EAAGA,EAAIjB,KAAK8oC,UAAU9nC,GAAGE,SAAUD,GAC1CiM,EAAAA,EAAAA,IAAYlN,KAAK8oC,UAAU9nC,GAAGC,GAAIjB,KAAKsK,eAAe+I,WAAWC,IAAM,IACzE0W,GAAgB,GAGpB,QAAIA,IAGJhqB,KAAKsK,eAAe2f,mBAAgBtnB,EACpC3C,KAAKsK,oBAAiB3H,GACf,EACT,EA3bWsnC,GACG5nB,kBAAY,EADf4nB,GAEGhnB,YAAM,EAFTgnB,GAGG5R,SAAU,ECjBnB,MAAM7iB,WAA0BE,EAErC7V,YAAYyE,GACVY,MAAMZ,GAAM,KAFPA,UAAI,EAGTtE,KAAKsE,KAAOA,CACd,CACOkL,WAAW9L,GAChB1D,KAAKyV,MAAMjS,SACXxD,KAAKsE,KAAKsmC,kCAEN5qC,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAaqR,WACtE3f,KAAKsE,KAAK/D,OAAS6L,EAAAA,GAAAA,aACjBpM,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAK6C,sBAEtCnH,KAAKsE,KAAKsb,UAAU8I,qBAAqBhlB,EAAK1D,KAAKsE,KAAKob,KAAM1f,KAAKsE,KAAK0e,WAGtEhjB,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAK6C,sBAEtCnH,KAAKsE,KAAKsb,UAAU2I,uBAAuB7kB,EAAK1D,KAAKsE,KAAKob,KAAM1f,KAAKsE,KAAK0e,WAIhFhjB,KAAKsE,KAAK6tB,eACVnyB,KAAKigB,mBAAmBvc,EAC1B,CACQuc,mBAAmBvc,GACzB1D,KAAK6qC,aACHnnC,EACA1D,KAAKsE,KAAK8sB,aACVpxB,KAAKsE,KAAKgtB,kBACVtxB,KAAKsE,KAAK+sB,YACVrxB,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,gBACV/F,KAAKsE,KAAK0e,WAGRhjB,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAKyB,kBAEpC/F,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBACzEC,OAASC,EAAAA,GAAAA,UAEZjW,KAAK8qC,gBAAgBpnC,EAAK1D,KAAKsE,KAAKgtB,kBAAmBtxB,KAAKsE,KAAK8sB,cACjEpxB,KAAK+qC,gBAAgBrnC,EAAK1D,KAAKsE,KAAKgtB,mBAG1C,CAEQuZ,aACNnnC,EACAsnC,EACAna,EACAC,EACA1mB,EACA5J,EACAwiB,GAEA,MAAM7G,EAAM6uB,EACVjb,EAAKc,EACLxkB,EAAI8P,EAAIjb,OAEV,GAAI8hB,EAAU,CACZ,GAAIhjB,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAKyB,gBACtC,IAAK,IAAI9E,EAAI,EAAGA,EAAIoL,EAAI,EAAGpL,GAAK,EAC9BjB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAMka,8BAC3DvnC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBwb,EAAIlb,GACJkb,EAAIlb,EAAI,GACR8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,GACP8uB,EAAG,EAAI9uB,EAAI,GACXkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRjB,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBACzD3W,KAAKsE,KAAKa,SAASmQ,QAK3B,IAAK,IAAIrU,EAAI,EAAGA,EAAIoL,EAAI,EAAGpL,GAAK,EAC9BjB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAMma,kBAC3DxnC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBwb,EAAIlb,GACJkb,EAAIlb,EAAI,GACR8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,GACP8uB,EAAG,EAAI9uB,EAAI,GACXkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRjB,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,iBAGV/F,KAAKsE,KAAKgB,QACZtF,KAAKmrC,kBAAkBznC,EAAKsnC,EAASna,EAEzC,KAAO,CACL,GAAI7wB,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAKyB,gBAAiB,CACvD,IAAK,IAAI9E,EAAI,EAAGA,EAAIkb,EAAIjb,OAAS,EAAGD,GAAK,EACvCjB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAMqa,yBAC3D1nC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBwb,EAAIlb,GACJkb,EAAIlb,EAAI,GACR8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,GACP8uB,EAAG,EAAI9uB,EAAI,GACXkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRjB,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBACzD3W,KAAKsE,KAAKa,SAASmQ,QAIzBtV,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAMsa,4BAC3D3nC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBwb,EAAI,GACJA,EAAI,GACJ4T,EAAG,GACHA,EAAG,GACH5T,EAAI,GACJA,EAAI,GACJnc,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBACzD3W,KAAKsE,KAAKa,SAASmQ,QAGvBtV,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAMsa,4BAC3D3nC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBwb,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACR0jB,EAAG,EAAI1jB,EAAI,IACX0jB,EAAG,EAAI1jB,EAAI,GACX8P,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACRrM,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBACzD3W,KAAKsE,KAAKa,SAASmQ,OAGzB,CAEA,IAAK,IAAIrU,EAAI,EAAGA,EAAIkb,EAAIjb,OAAS,EAAGD,GAAK,EACvCjB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAMua,YAC3D5nC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBwb,EAAIlb,GACJkb,EAAIlb,EAAI,GACR8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,GACP8uB,EAAG,EAAI9uB,EAAI,GACXkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRjB,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,iBAGd/F,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAME,eAC3DvtB,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBwb,EAAI,GACJA,EAAI,GACJ4T,EAAG,GACHA,EAAG,GACH5T,EAAI,GACJA,EAAI,GACJnc,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,iBAEZ/F,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAME,eAC3DvtB,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBwb,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACR0jB,EAAG,EAAI1jB,EAAI,IACX0jB,EAAG,EAAI1jB,EAAI,GACX8P,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACRrM,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,gBAEd,CAUA/F,KAAKkgB,gBAAgB/D,EAAK4T,EAAI1jB,EAAG2W,EACnC,CACQ+nB,gBAAgBrnC,EAA+B4tB,GAErD5tB,EAAImV,UAAiE,GAArD7Y,KAAKsE,KAAKjB,eAAe8X,gBAAgBtC,UACzDnV,EAAIM,UAAYhE,KAAKsE,KAAKjB,eAAe8X,gBAAgBZ,UACzD7W,EAAI2c,YAAcrgB,KAAKsE,KAAKjB,eAAe8X,gBAAgBV,YAC3D,IAAK,IAAIxZ,EAAI,EAAGA,EAAIqwB,EAAkBpwB,OAAS,EAAGD,GAAK,EACrDyC,EAAIO,YACJP,EAAIe,IACF6sB,EAAkBrwB,GAClBqwB,EAAkBrwB,EAAI,GACtB,EAAIjB,KAAKsE,KAAK+D,eACd,EACA,EAAIiK,KAAK8Y,IACT,GAEF1nB,EAAIU,OACJV,EAAI8c,QAER,CACQsqB,gBACNpnC,EACA4tB,EACAF,GAEA,IAAK,IAAInwB,EAAI,EAAGA,EAAImwB,EAAalwB,OAAS,EAAGD,GAAK,EAChDjB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAM+Z,gBAC3DpnC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBywB,EAAanwB,GACbmwB,EAAanwB,EAAI,GACjBqwB,EAAkB,EAAIrwB,EAAI,GAC1BqwB,EAAkB,EAAIrwB,EAAI,IAE5BjB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAM+Z,gBAC3DpnC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBywB,EAAanwB,EAAI,GACjBmwB,EAAanwB,EAAI,GACjBqwB,EAAkB,EAAIrwB,GACtBqwB,EAAkB,EAAIrwB,EAAI,IAG9BjB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAM+Z,gBAC3DpnC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBywB,EAAa,GACbA,EAAa,GACbE,EAAkB,GAClBA,EAAkB,IAEpBtxB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAM+Z,gBAC3DpnC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBywB,EAAaA,EAAalwB,OAAS,GACnCkwB,EAAaA,EAAalwB,OAAS,GACnCowB,EAAkB,EAAIF,EAAalwB,OAAS,IAC5CowB,EAAkB,EAAIF,EAAalwB,OAAS,GAEhD,CACQiqC,kBACNznC,EACAsnC,EACAna,GAKA,MAAM1U,EAAM6uB,EACVjb,EAAKc,EACLxkB,EAAI8P,EAAIjb,OAONlB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmP,YAActU,KAAKsE,KAAKsB,cACtElC,EAAI2c,YAAcrgB,KAAKsE,KAAKjB,eAAe1C,YAAY+Z,iBACvDhX,EAAIM,UAAYhE,KAAKsE,KAAKjB,eAAe1C,YAAY6Z,iBAErD9W,EAAI2c,YAAcrgB,KAAKsE,KAAKjB,eAAe1C,YAAY8Z,YACvD/W,EAAIM,UAAYhE,KAAKsE,KAAKjB,eAAe1C,YAAY4Z,WAGnDva,KAAKsE,KAAKyB,kBACZrC,EAAI2c,YAAcrgB,KAAKsE,KAAKjB,eAAe1C,YAAY8Z,YACvD/W,EAAIM,UAAYhE,KAAKsE,KAAKjB,eAAe1C,YAAY4Z,WAKvD7W,EAAIO,YACJP,EAAI4c,OAAOnE,EAHA,GAGSA,EAAIoX,IACxB,IAAK,IAAItyB,EAAI,EAAGA,EAAIoL,EAAI,EAAGpL,GAAK,EAC9BjB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAMwa,sBAC3D7nC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBwb,EAAIlb,GACJkb,EAAIlb,EAAI,GACR8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,GACP8uB,EAAG,EAAI9uB,EAAI,GACXkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,IAGZyC,EAAIS,YACJT,EAAIU,MAGN,CACQonC,2BACN9nC,EACA+Q,EACAu2B,EACAna,GAIA,MAAM1U,EAAM6uB,EACNjb,EAAKc,EAGLxkB,EAAI8P,EAAIjb,OACdwC,EAAI+nC,OACJ/nC,EAAIO,YACJP,EAAIM,UAAYyQ,EAEhB/Q,EAAI4c,OAAOnE,EADA,GACSA,EAAIoX,IACxB,IAAK,IAAItyB,EAAI,EAAGA,EAAIoL,EAAI,EAAGpL,GAAK,EAC9BjB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAAMwa,sBAC3D7nC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBwb,EAAIlb,GACJkb,EAAIlb,EAAI,GACR8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,GACP8uB,EAAG,EAAI9uB,EAAI,GACXkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,IAGZyC,EAAIS,YACJT,EAAIU,OACJV,EAAIgoC,SACN,CAEQxrB,gBAAgB/D,EAAe4T,EAAc1jB,EAAW2W,GAC9D,GAAIA,EAAU,CACZ,IAAK,IAAI/hB,EAAI,EAAGA,EAAIoL,EAAI,EAAGpL,GAAK,EAC9BjB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASqc,UAAUmqB,qBACpD3rC,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAC5C1hB,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK6D,UACVgU,EAAIlb,GACJkb,EAAIlb,EAAI,GACR8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,GACP8uB,EAAG,EAAI9uB,EAAI,GACXkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,IAGZjB,KAAKwrC,2BACHxrC,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAC5C1hB,KAAKsE,KAAK6D,UACVgU,EACA4T,EAEJ,KAAO,CACL,IAAK,IAAI9uB,EAAI,EAAGA,EAAIkb,EAAIjb,OAAS,EAAGD,GAAK,EACvCjB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASqc,UAAUmqB,qBACpD3rC,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAC5C1hB,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK6D,UACVgU,EAAIlb,GACJkb,EAAIlb,EAAI,GACR8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,EAAI,GACX8uB,EAAG,EAAI9uB,GACP8uB,EAAG,EAAI9uB,EAAI,GACXkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,IAGZjB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASqc,UAAU0P,6BACpDlxB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAC5C1hB,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK6D,UACVgU,EAAI,GACJA,EAAI,GACJ4T,EAAG,GACHA,EAAG,GACH5T,EAAI,GACJA,EAAI,IAENnc,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASqc,UAAU0P,6BACpDlxB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAC5C1hB,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK6D,UACVgU,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACR0jB,EAAG,EAAI1jB,EAAI,IACX0jB,EAAG,EAAI1jB,EAAI,GACX8P,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GAEZ,CACF,EC1ZK,MAAM6O,WAAuBM,EAElC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KAFNA,SAAG,EAGR1B,KAAKmO,aACP,CACOA,cACLgK,EAAY8O,yBACVjnB,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElDyI,EAAY+O,6BACVlnB,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAEpD,ECGK,MAAMk8B,WAAe3mC,EAqB1B,wBACEirB,EACAC,EACAC,EACAC,EACAC,EACAC,EACAhmB,GAEA,MAAMimB,EAAMle,KAAKC,KAAKD,KAAKme,IAAIL,EAAKF,EAAI,GAAK5d,KAAKme,IAAIJ,EAAKF,EAAI,IAEzDO,EAAMnmB,EAAIimB,GAAQA,EADZle,KAAKC,KAAKD,KAAKme,IAAIH,EAAKF,EAAI,GAAK9d,KAAKme,IAAIF,EAAKF,EAAI,KAEzDM,EAAKpmB,EAAImmB,EAKf,MAAO,CAJKN,EAAKM,GAAMR,EAAKI,GAChBD,EAAKK,GAAMP,EAAKI,GAChBH,EAAKO,GAAMT,EAAKI,GAChBD,EAAKM,GAAMR,EAAKI,GAE9B,CACA,4BAAmCpU,EAAe5R,GAA8B,IAC1EsmB,EAAgB,GACpB,GAFmE,wDAErD,CACZ1U,EAAIhb,KAAKgb,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IACrCA,EAAI0vB,QAAQ1vB,EAAIA,EAAIjb,OAAS,IAC7Bib,EAAI0vB,QAAQ1vB,EAAIA,EAAIjb,OAAS,IAC7B,IAAK,IAAID,EAAI,EAAGA,EAAIkb,EAAIjb,OAAQD,GAAK,EACnC4vB,EAAMA,EAAI2C,OACRoY,GAAO5b,iBACL7T,EAAIlb,GACJkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRsJ,IAINsmB,EAAMA,EAAI2C,OAAO3C,EAAI,GAAIA,EAAI,GAC/B,MACE,IAAK,IAAI5vB,EAAI,EAAGA,EAAIkb,EAAIjb,OAAS,EAAGD,GAAK,EACvC4vB,EAAMA,EAAI2C,OACRoY,GAAO5b,iBACL7T,EAAIlb,GACJkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRsJ,IAMR,OAAOsmB,CACT,CAEA,iBAAwBltB,EAAcpD,GACpC,IAAIU,EAAI0C,EAAMmoC,WAAW5qC,OACrB6gB,EAAQ,EACZ,KAAO9gB,KACDV,IAASoD,EAAMmoC,WAAW7qC,GAAGV,OAC/BwhB,GAAS,GAGb,OAAOA,CACT,CACA,0BAAiCpe,EAAcpD,GAC7C,IAAIU,EAAI0C,EAAMmoC,WAAW5qC,OACrB6gB,EAAQ,EACZ,KAAO9gB,KACD0C,EAAMmoC,WAAW7qC,GAAGT,YAAcD,IAASoD,EAAMmoC,WAAW7qC,GAAGV,OACjEwhB,GAAS,GAGb,OAAOA,CACT,CAEA,gBACEpe,EACA0M,GAIC,IAHDtJ,EAAM,wDACNuV,EAAU,wDAKV,MAAM5a,EAAM,IAAIkqC,GAAOjoC,EAJf,wDAIgCoD,GACxC,GAAIA,EACF,IAAK,IAAI9F,EAAI,EAAGA,EAAIoP,EAAEzP,MAAMM,SAAUD,EACpCS,EAAIygB,MAAMpG,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAMK,GAAI8F,SAGtD,IAAK,IAAI9F,EAAI,EAAGA,EAAIoP,EAAEzP,MAAMM,SAAUD,EACpCS,EAAIygB,MAAMpG,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAMK,KAuBpD,OAnBAS,EAAInB,KAAO6L,EAAAA,GAAMiE,EAAE9P,MACnBmB,EAAI0gB,cAAe,EACnB1gB,EAAIyF,qBAAsB,EAC1BzF,EAAI0I,SAAU,EACd1I,EAAIhB,SAAW2P,EAAE3P,SAGfgB,EAAIpB,GADFgc,EACO3Y,EAAMsF,UAENoH,EAAE/P,GAET+P,EAAE3P,SACJgB,EAAIwF,gBAAkB,EAEtBxF,EAAIwF,gBAAkB,EAGxBxF,EAAIoO,kBACJ87B,GAAOvpB,kBAAe1f,EACfjB,CACT,CACA,sBAA6BiC,EAAcT,GACzC,MAAMyH,EAAI,IAAIihC,GAAOjoC,EAD2C,yDAEhE,IAAK,IAAI1C,EAAI,EAAGA,EAAIiC,EAAEhC,SAAUD,EAC9B0J,EAAEwX,MAAM,IAAIpG,EAAOpY,EAAOT,EAAEjC,GAAGG,EAAG8B,EAAEjC,GAAGI,EAAG,IAK5C,OAHAsJ,EAAEyX,cAAe,EACjBzX,EAAExD,qBAAsB,EACxBxD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBnG,EAAEnB,UAChEmB,CACT,CACA,kBAAyB2C,GACvB,QAA4B3K,IAAxBipC,GAAOvpB,aACT,GAAIupB,GAAOvpB,aAAalG,IAAIjb,OAAS,EAAG,CACtC,GAAI0qC,GAAOvpB,aAAa1c,SACtB,OAEFimC,GAAOvpB,aAAalG,IAAIyvB,GAAOvpB,aAAalG,IAAIjb,OAAS,GAAGkM,KAAKE,EAAElM,EAAGkM,EAAEjM,GACxE,MAAM00B,EAAK6V,GAAOvpB,aAAalG,IAAI,GAC7BqK,EAAKolB,GAAOvpB,aAAalG,IAAI,GAC7B4vB,EAAKH,GAAOvpB,aAAalG,IAAI,GAEnCqK,EAAG5jB,IAAIxB,EAA4B,IAAvB20B,EAAGnzB,IAAIxB,EAAI2qC,EAAGnpC,IAAIxB,GAC9BolB,EAAG5jB,IAAIvB,EAA4B,IAAvB00B,EAAGnzB,IAAIvB,EAAI0qC,EAAGnpC,IAAIvB,EAChC,MACEuqC,GAAOvpB,aAAalG,IAAIyvB,GAAOvpB,aAAalG,IAAIjb,OAAS,GAAGkM,KAAKE,EAAElM,EAAGkM,EAAEjM,EAG9E,CACA,oBAA2BsC,EAAc8F,GACvCmiC,GAAOvpB,aAAe,IAAIupB,GAAOjoC,GACjCioC,GAAOvpB,aAAaF,MAAM,IAAIpG,EAAOpY,EAAO8F,EAAE7G,IAAIxB,EAAGqI,EAAE7G,IAAIvB,IAC3DuqC,GAAOvpB,aAAaF,MAAM,IAAIpG,EAAOpY,EAAO8F,EAAE7G,IAAIxB,EAAGqI,EAAE7G,IAAIvB,IAC3DuqC,GAAOvpB,aAAaF,MAAM,IAAIpG,EAAOpY,EAAO8F,EAAE7G,IAAIxB,EAAGqI,EAAE7G,IAAIvB,IAE3DoI,EAAEgH,QACJ,CACA,gBAAuB9M,EAAc2J,GAAsC,IAAnB0V,EAAQ,6DAClCrgB,IAAxBipC,GAAOvpB,aACLupB,GAAOvpB,aAAalG,IAAI,GAAG9J,SAAS/E,EAAElM,EAAGkM,EAAEjM,GAAK,GAClDuqC,GAAOvpB,aAAaW,SAAWA,EAC3B4oB,GAAOvpB,aAAaW,UACtB4oB,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAI,IACrDyvB,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAI,IACrDyvB,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAIyvB,GAAOvpB,aAAalG,IAAIjb,OAAS,IACtF0qC,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAIyvB,GAAOvpB,aAAalG,IAAIjb,OAAS,MAEtF0qC,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAI,IACrDyvB,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAIyvB,GAAOvpB,aAAalG,IAAIjb,OAAS,IACtF0qC,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAIyvB,GAAOvpB,aAAalG,IAAIjb,OAAS,KAExF0qC,GAAOvpB,aAAa2pB,WAAY,EAChCJ,GAAOvpB,kBAAe1f,GAEtBipC,GAAOvpB,aAAaF,MAAM,IAAIpG,EAAOpY,EAAO2J,EAAElM,EAAGkM,EAAEjM,KAGrDuqC,GAAOvpB,aAAe,IAAIupB,GAAOjoC,EAAOqf,GACxC4oB,GAAOvpB,aAAaF,MAAM,IAAIpG,EAAOpY,EAAO2J,EAAElM,EAAGkM,EAAEjM,IACnDuqC,GAAOvpB,aAAaF,MAAM,IAAIpG,EAAOpY,EAAO2J,EAAElM,EAAGkM,EAAEjM,IACnDuqC,GAAOvpB,aAAaF,MAAM,IAAIpG,EAAOpY,EAAO2J,EAAElM,EAAGkM,EAAEjM,IAGvD,CAEA,YAAmBsC,GACjB,QAA4BhB,IAAxBipC,GAAOvpB,aACT,GAAIupB,GAAOvpB,aAAalG,IAAIjb,OAAS,EAAG,CAC5B,IAAI6a,EACZpY,EACAioC,GAAOvpB,aAAalG,IAAI,GAAGvZ,IAAIxB,EAC/BwqC,GAAOvpB,aAAalG,IAAI,GAAGvZ,IAAIvB,EAC/BuqC,GAAOvpB,aAAalG,IAAI,GAAGvZ,IAAItB,GAE/BgP,QACFs7B,GAAOvpB,aAAa5R,SACpBm7B,GAAOvpB,kBAAe1f,EACtBgB,EAAMC,mBAAmB4H,wBAAwBgX,YACnD,MACMopB,GAAOvpB,aAAaW,UACtB4oB,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAI,IACrDyvB,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAI,IACrDyvB,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAIyvB,GAAOvpB,aAAalG,IAAIjb,OAAS,IACtF0qC,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAIyvB,GAAOvpB,aAAalG,IAAIjb,OAAS,MAEtF0qC,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAI,IACrDyvB,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAIyvB,GAAOvpB,aAAalG,IAAIjb,OAAS,IACtF0qC,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAIyvB,GAAOvpB,aAAalG,IAAIjb,OAAS,KAGxF0qC,GAAOvpB,aAAaD,cAAe,EACnCwpB,GAAOvpB,aAAalb,qBAAsB,EAC1CxD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAClD86B,GAAOvpB,aAAa7Y,UAEtBoiC,GAAOvpB,kBAAe1f,EACtBgB,EAAMC,mBAAmB4H,wBAAwBgX,YAGvD,CACA,sBAA6B7e,GAC3B,QAA4BhB,IAAxBipC,GAAOvpB,aACT,GAAIupB,GAAOvpB,aAAalG,IAAIjb,OAAS,EAAG,CAC5B,IAAI6a,EACZpY,EACAioC,GAAOvpB,aAAalG,IAAI,GAAGvZ,IAAIxB,EAC/BwqC,GAAOvpB,aAAalG,IAAI,GAAGvZ,IAAIvB,EAC/BuqC,GAAOvpB,aAAalG,IAAI,GAAGvZ,IAAItB,GAE/BgP,QACFs7B,GAAOvpB,aAAa5R,SACpBm7B,GAAOvpB,kBAAe1f,EACtBgB,EAAMC,mBAAmB4H,wBAAwBgX,YACnD,MACEopB,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAI,IACrDyvB,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAI,IACrDyvB,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,IAAIyvB,GAAOvpB,aAAalG,IAAIjb,OAAS,IAEtF0qC,GAAOvpB,aAAaD,cAAe,EACnCwpB,GAAOvpB,aAAalb,qBAAsB,EAC1CxD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAClD86B,GAAOvpB,aAAa7Y,UAEtBoiC,GAAOvpB,kBAAe1f,EACtBgB,EAAMC,mBAAmB4H,wBAAwBgX,YAGvD,CACA,YAAmBlV,GACjB,IAAKs+B,GAAOvpB,aACV,OAEF,IAAIphB,EAAI2qC,GAAOvpB,aAAalG,IAAIjb,OAAS,EACrCD,EAAI,EACN2qC,GAAOrpB,UAGTqpB,GAAOvpB,aAAaC,SAASspB,GAAOvpB,aAAalG,MAAMlb,IACvD2qC,GAAOvpB,aAAalG,IAAIlb,GAAG2B,IAAIxB,EAAIkM,EAAElM,EACrCwqC,GAAOvpB,aAAalG,IAAIlb,GAAG2B,IAAIvB,EAAIiM,EAAEjM,EACvC,CACA,qBAC8BsB,IAAxBipC,GAAOvpB,eACTupB,GAAOvpB,aAAa1c,UAAW,EAC/BimC,GAAOvpB,aAAa5R,SACpBm7B,GAAOvpB,kBAAe1f,EAE1B,CAEA,iBAAwBgB,EAAc2J,GAAsC,IAAnB0V,EAAQ,wDAC/D,GAAIrf,EAAMC,mBAAmB4H,wBAAwB8C,aAAasU,4BAA6B,CAC7F,MAAMC,EAAOlf,EAAMC,mBAAmBuS,eAAe2M,eAAeb,YAAY3U,GAC5Es+B,GAAOvpB,eACLQ,IAAS+oB,GAAOvpB,aAAalG,IAAIyvB,GAAOvpB,aAAalG,IAAIjb,OAAS,QAEzDyB,IAATkgB,GACAA,EAAKtiB,OAAS6L,EAAAA,GAAAA,YACUzJ,IAAxBipC,GAAOvpB,cAEHupB,GAAOvpB,cACTupB,GAAOvpB,aAAaF,MAAM,IAAIpG,EAAOpY,EAAOkf,EAAK3f,EAAE9B,EAAGyhB,EAAK3f,EAAE7B,EAAGwhB,EAAK3f,EAAE5B,IAEzEuhB,EAAKpS,eAEI9N,IAATkgB,GACAA,EAAKtiB,OAAS6L,EAAAA,GAAAA,YACUzJ,IAAxBipC,GAAOvpB,cAEPupB,GAAOK,aAAatoC,EAAOkf,GAG7B+oB,GAAOM,SAASvoC,EAAO2J,EAAG0V,GAGhC,MACE4oB,GAAOM,SAASvoC,EAAO2J,EAAG0V,EAE9B,CACA,wBAA+Brf,EAAc2J,GAAsC,IAAnB0V,EAAQ,6DAC1CrgB,IAAxBipC,GAAOvpB,cACTupB,GAAOzoB,KAAKxf,EAAOqf,EAEvB,CACA,sBAA6Brf,EAAc2J,GAAsC,IAAnB0V,EAAQ,6DAC9CrgB,IAAlBgB,EAAMgP,cAGkBhQ,IAAxBipC,GAAOvpB,cACTupB,GAAOM,SAASvoC,EAAO2J,EAAG0V,EAE9B,CACA,iBAAwB1V,GACtBs+B,GAAO1oB,WAAW5V,EACpB,CAIAzN,YAAY8D,GAAiD,IAAnCqf,EAAQ,wDAAUjc,EAAM,wDAChD7B,MAAMvB,GAAO,KAhVRN,oBAAc,OACdT,SAAG,OACH8c,UAAI,OACJvD,SAAG,OACH6G,cAAQ,OACRmpB,iBAAW,OACX/a,kBAAY,OACZC,iBAAW,OACXC,uBAAiB,OAMjB/N,aAAe,EAAE,KAEjB3D,eAAS,EAiUd5f,KAAK4C,IAAM,IAAIP,EAAAA,GAAS,EAAG,EAAG,GAC9BrC,KAAKmc,IAAM,GACXnc,KAAK4c,gBACL5c,KAAKgjB,SAAWA,EAChBhjB,KAAK+G,OAASA,EACd/G,KAAKmH,qBAAsB,EAC3BnH,KAAKmsC,aAAc,EACfnsC,KAAKgjB,UACPhjB,KAAKO,KAAO6L,EAAAA,GAAAA,YACZpM,KAAKsF,QAAS,IAEdtF,KAAKO,KAAO6L,EAAAA,GAAAA,WACZpM,KAAKsF,QAAS,GAEhBtF,KAAK4f,UAAY,IAAIiI,EAAU7nB,MAE/BA,KAAK2D,MAAMyoC,UAAUpsC,MACrBA,KAAK8R,MACP,CACQ8K,gBACN5c,KAAKqD,eAAiB,IAAI6X,GAAelb,MACzCA,KAAKmF,SAAW,IAAIqQ,GAAkBxV,KACxC,CACO8R,OACA,CAEAgB,SAyBL,MAtBE,UACA9S,KAAKM,GADL,WAIAN,KAAKO,KAAKwS,WAJV,sBAYA/S,KAAKmc,IAAIjb,OAZT,YAkBAlB,KAAK+F,gBAlBL,gBAqBA/F,KAAKgG,YAET,CACOgN,YAcL,MAZE,iBACAhT,KAAKM,GADL,oDASAN,KAAK2H,EACL,YAGJ,CACOgF,UACL3M,KAAK0f,KAAO,GACZ,IAAK,MAAMjW,KAAKzJ,KAAKmc,IACnBnc,KAAK0f,KAAKve,KAAKsI,EAAE7G,KAEnB,OAAO5C,KAAK0f,IACd,CACO0S,gBACLpyB,KAAKoxB,aAAe,GACpB,IAAK,MAAM3nB,KAAKzJ,KAAKmc,IACnBnc,KAAKoxB,aAAajwB,KAAKsI,EAAE7G,IAAIxB,EAAGqI,EAAE7G,IAAIvB,EAE1C,CACOgxB,gBACLryB,KAAKqxB,YAAc,GACnB,IAAK,MAAM5nB,KAAKzJ,KAAKmc,IACnBnc,KAAKqxB,YAAYlwB,KAAKsI,EAAEiI,WAAYjI,EAAEkI,YAE1C,CACO2gB,sBACL,MAAMnW,EAAgB,GACtB,IAAK,MAAMoX,KAAMvzB,KAAKoxB,aACpBjV,EAAIhb,KAAKoyB,GAEX,IAAI1C,EAAgB,GACpB,GAAI7wB,KAAKgjB,SAAU,CACjB7G,EAAIhb,KAAKgb,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IACrCA,EAAI0vB,QAAQ1vB,EAAInc,KAAKoxB,aAAalwB,OAAS,IAC3Cib,EAAI0vB,QAAQ1vB,EAAInc,KAAKoxB,aAAalwB,OAAS,IAC3C,IAAK,IAAID,EAAI,EAAGA,EAAIjB,KAAKoxB,aAAalwB,OAAQD,GAAK,EACjD4vB,EAAMA,EAAI2C,OACRoY,GAAO5b,iBACL7T,EAAIlb,GACJkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRjB,KAAKqxB,YAAYpwB,KAOvB,OAHA4vB,EAAMA,EAAI2C,OAAO3C,EAAI,GAAIA,EAAI,IAC7B7wB,KAAKsxB,kBAAoBT,OACzB7wB,KAAKoxB,aAAejV,EAEtB,CACA,IAAK,IAAIlb,EAAI,EAAGA,EAAIkb,EAAIjb,OAAS,EAAGD,GAAK,EACvC4vB,EAAMA,EAAI2C,OACRoY,GAAO5b,iBACL7T,EAAIlb,GACJkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRjB,KAAKqxB,YAAYpwB,KAIvBjB,KAAKsxB,kBAAoBT,CAE3B,CACO3gB,gBACLlQ,KAAKgG,cAAe,EACpBhG,KAAKuH,eAAgB,EACrBvH,KAAKmc,IAAI6J,SAASvc,IAChBA,EAAEyG,eAAe,GAErB,CACOm8B,yBAAyB/V,GAC9Bt2B,KAAKoxB,aAAe,GACpB,IAAK,MAAM3nB,KAAK6sB,EACdt2B,KAAKoxB,aAAajwB,KAAKsI,EAAErI,EAAGqI,EAAEpI,GAGhC,MAAM8a,EAAgB,GACtB,IAAK,MAAMoX,KAAMvzB,KAAKoxB,aACpBjV,EAAIhb,KAAKoyB,GAEX,IAAI1C,EAAgB,GACpB,GAAI7wB,KAAKgjB,SAAU,CACjB7G,EAAIhb,KAAKgb,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIA,EAAI,IACrCA,EAAI0vB,QAAQ1vB,EAAInc,KAAKoxB,aAAalwB,OAAS,IAC3Cib,EAAI0vB,QAAQ1vB,EAAInc,KAAKoxB,aAAalwB,OAAS,IAC3C,IAAK,IAAID,EAAI,EAAGA,EAAIjB,KAAKoxB,aAAalwB,OAAQD,GAAK,EACjD4vB,EAAMA,EAAI2C,OACRoY,GAAO5b,iBACL7T,EAAIlb,GACJkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRjB,KAAKqxB,YAAYpwB,KAOvB,OAHA4vB,EAAMA,EAAI2C,OAAO3C,EAAI,GAAIA,EAAI,IAC7B7wB,KAAKsxB,kBAAoBT,OACzB7wB,KAAKoxB,aAAejV,EAEtB,CACA,IAAK,IAAIlb,EAAI,EAAGA,EAAIkb,EAAIjb,OAAS,EAAGD,GAAK,EACvC4vB,EAAMA,EAAI2C,OACRoY,GAAO5b,iBACL7T,EAAIlb,GACJkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRjB,KAAKqxB,YAAYpwB,KAIvBjB,KAAKsxB,kBAAoBT,CAE3B,CACOsB,eACLnyB,KAAKoyB,gBACLpyB,KAAKqyB,gBACLryB,KAAKsyB,qBACP,CAEO7hB,SAA+B,IAAxB5J,IAAQ,yDAChB5F,EAAIjB,KAAKmc,IAAIjb,OACjB,KAAOD,KACLjB,KAAKmc,IAAIlb,GAAGwP,SAGd,GAAI5J,EAAU,CACZ,MAAMuX,EAAQpe,KAAKwJ,SACf4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB,CAACvG,GAElF,CAEApe,KAAK2D,MAAM2oC,aAAatsC,MACxBA,KAAK2D,MAAM8a,eAAeze,KAC5B,CACOiT,OACA,CAEAkP,MAAM1Y,GACXA,EAAElJ,KAAO6L,EAAAA,GAAAA,MACT3C,EAAE7G,IAAIyZ,EAAI,GACV5S,EAAEiI,WAAajI,EAAE7G,IAAIyZ,EACrB5S,EAAEkI,YAAc,EAChBlI,EAAEzD,cAAe,EACjByD,EAAEpG,eAAe1C,YAAcX,KAAKqD,eAAe8X,gBACnD1R,EAAEpG,eAAe8X,gBAAkBnb,KAAKqD,eAAe8X,gBACvD1R,EAAEpG,eAAeuY,mBAAmB5b,KAAKqD,eAAe8X,iBACxD1R,EAAE8H,MAAMpQ,KAAKnB,MACbA,KAAKmc,IAAIhb,KAAKsI,GACVzJ,KAAKmc,IAAIjb,OAAS,GACpBlB,KAAKmyB,cAET,CACO7P,SAAS7Y,GACdzJ,KAAKmc,IAAIiB,OAAOpd,KAAKmc,IAAI1J,QAAQhJ,GAAI,GACrCA,EAAEgH,QACJ,CACOV,SAAS3O,EAAWC,GACzB,MAAMgP,EAAIrQ,KAAKwJ,SACf,GAAI6G,EAAG,CACL,IAAIqW,EAUJ,OAREA,EADErW,EAAE9P,OAAS6L,EAAAA,GAAAA,YACRw/B,GAAOx7B,SAASpQ,KAAK2D,MAAO0M,GAAG,GAAM,GAAM,GAE3Cu7B,GAAOx7B,SAASpQ,KAAK2D,MAAO0M,GAAG,GAAM,GAE5CqW,EAAGtZ,KAAKhM,EAAGC,GAEXqlB,EAAGtc,SAAU,EACbsc,EAAG7V,eACI6V,CACT,CAEF,CACOtZ,KAAKhM,EAAWC,GACrB,GAAIrB,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,cAC9C,OAEFrG,KAAK4qC,kCACL,MAAMpmB,EAAKpjB,EAAIpB,KAAK4C,IAAIxB,EAClBqjB,EAAKpjB,EAAIrB,KAAK4C,IAAIvB,EACxB,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAG2B,IAAIxB,GAAKojB,EACrBxkB,KAAKmc,IAAIlb,GAAG2B,IAAIvB,GAAKojB,CAEzB,CACO5R,cAAczR,EAAWC,GAC9B,OAAiC,IAA7BrB,KAAKmH,0BAA6DxE,IAA7B3C,KAAKmH,wBAI1CnH,KAAKmkB,cAAc/iB,EAAGC,MAGtBrB,KAAKskB,yBAAyBljB,EAAGC,GASvC,CACO8iB,cAAc/iB,EAAWC,GAkB9B,OAAO,CACT,CACOijB,yBAAyBljB,EAAWC,GAMzC,OALUrB,KAAK2D,MAAMC,mBAAmBuS,eAAe2M,eAAewB,yBACpEljB,EACAC,EACArB,KAAKmI,YAGLnI,KAAKoK,SAAU,GACR,IAETpK,KAAKoK,SAAU,GACR,EACT,CACWgY,iBAAalf,GACtBlD,KAAKgG,aAAe9C,EACpB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAG+E,aAAe9C,CAE/B,CACWkf,mBACT,OAAOpiB,KAAKgG,YACd,CACOkN,0BAA0B5F,GAM/B,MAAMkX,EAAKlX,EAAElM,EAAIkM,EAAE6F,KACbsR,EAAKnX,EAAEjM,EAAIiM,EAAE8F,KACnB,IAAK,IAAInS,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAG2B,IAAIxB,GAAKojB,EACrBxkB,KAAKmc,IAAIlb,GAAG2B,IAAIvB,GAAKojB,CAGzB,CACOlR,UAAUnS,EAAWC,GAU1B,CAESb,iBACT,OAAOR,KAAK+F,eACd,CACWvF,eAAW0C,GACpBlD,KAAK+F,gBAAkB7C,EACvB,IAAK,MAAMuG,KAAKzJ,KAAKmc,IACnB1S,EAAEzH,aAAekB,EAEnBlD,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2c,eAAe3mB,KAAKwJ,SAC/E,CACWY,cACT,OAAOpK,KAAK4F,YACd,CACWwE,YAAQlH,GACjB,IAAIlD,KAAKmH,sBAGLnH,KAAK+F,gBAAT,CAGA,IAAK,MAAM0D,KAAKzJ,KAAKmc,IACnB1S,EAAEzH,aAAekB,EAGnB,GADAlD,KAAK4F,aAAe1C,EAChBlD,KAAK4F,eAAiB5F,KAAK6F,WAAY,CACzC,IAAK,IAAI5E,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGkE,SAASoF,EAAI,EAE3BvK,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB4c,WAAW5mB,KAAKwJ,SAC3E,MAAYxJ,KAAK4F,cAAgB5F,KAAK6F,YACpC7F,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB4c,WAAW5mB,KAAKwJ,UAE3ExJ,KAAK6F,WAAa7F,KAAK4F,aAClB1C,IACHlD,KAAK8G,mBAAoB,EACzB9G,KAAK4M,mBAhBP,CAkBF,CACWo/B,gBACT,OAAOhsC,KAAKyG,eACd,CACWulC,cAAU9oC,GACnB,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAGwF,gBAAkBvD,CAElC,CAaOkG,UACL,MAAMlG,EAAgB,GACtB,IAAK,IAAIqwB,EAAK,EAAGA,EAAKvzB,KAAKmc,IAAIjb,SAAUqyB,EACvCrwB,EAAE/B,KAAKnB,KAAKmc,IAAIoX,GAAI3wB,KAEtB,OAAOM,CACT,CACOyN,kBACD3Q,KAAKgjB,WACPhjB,KAAKsF,QAAUtF,KAAKsF,OAExB,CACOkE,SACL,MAAMC,EAAI,IAAIpJ,EACZL,KAAKM,GACLN,KAAKO,KACLP,KAAK+F,gBACL/F,KAAK4F,aACL5F,KAAKqG,eAGP,OADAoD,EAAE1I,SAASf,KAAKoJ,WACTK,CACT,CACO+F,WAAW9L,GAChB1D,KAAKmF,SAASqK,WAAW9L,EAC3B,CACOknC,kCACL5qC,KAAK0f,KAAO,GACZ,IAAK,IAAIze,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAK0f,KAAKve,KAAKnB,KAAKmc,IAAIlb,GAAG2B,KAE7B5C,KAAK4C,KAAMyjB,EAAAA,EAAAA,IAAqBrmB,KAAK0f,KAEvC,EAzwBWksB,GACGvpB,kBAAmC1f,EClB5C,MAAM4pC,WAAkBtnC,EAK7BpF,YAAY8D,GACVuB,MAAMvB,GAAO,KALRuZ,QAAE,OACFC,QAAE,OACFW,QAAE,OACFvM,WAAK,EAGVvR,KAAK4C,IAAM,IAAIP,EAAAA,GAAS,EAAG,EAAG,EAChC,CACWa,QACT,MAAM9B,GAAKpB,KAAKkd,GAAGta,IAAIxB,EAAIpB,KAAKmd,GAAGva,IAAIvB,EAAIrB,KAAK8d,GAAGlb,IAAIxB,GAAK,EACtDC,GAAKrB,KAAKkd,GAAGta,IAAIxB,EAAIpB,KAAKmd,GAAGva,IAAIvB,EAAIrB,KAAK8d,GAAGlb,IAAIxB,GAAK,EACtDE,GAAKtB,KAAKkd,GAAGta,IAAItB,EAAItB,KAAKmd,GAAGva,IAAItB,EAAItB,KAAK8d,GAAGlb,IAAItB,GAAK,EAE5D,OADAtB,KAAK4C,IAAM,IAAIP,EAAAA,GAASjB,EAAGC,EAAGC,GACvBtB,KAAK4C,GACd,CACWM,MAAEA,GACXlD,KAAK4C,IAAMM,CACb,CACO4P,SAEL,MAAO,EACT,CACOtD,WAAW9L,GAChB,CAEKmP,cAAczR,EAAWC,GAE9B,OAAO,CACT,CACO6R,0BAA0B5F,GAC/B,CAEKiG,UAAUnS,EAAWC,GAC1B,CAEKoP,SACL,CAEKwC,OACL,EC3CG,MAAM0V,GAEX9oB,YAAY6B,GAAqB,KAD1BA,SAAG,EAER1B,KAAK0B,IAAMA,CACb,CACOmR,cAAczR,EAAWC,GAC9B,OAAO,CACT,CACOyR,SACL,MAAO,EACT,CACOG,OACA,ECVF,MAAM0V,WAA6B6jB,GAExC3sC,YAAYyE,GACVY,MAAMZ,GAAM,KAFPA,UAAI,EAGTtE,KAAKsE,KAAOA,CACd,CACOuO,cAAczR,EAAWC,GAC9B,OAAsC,IAAlCrB,KAAKsE,KAAK6C,0BAAkExE,IAAlC3C,KAAKsE,KAAK6C,sBAItDnH,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBACzEC,OAASC,EAAAA,GAAAA,YAIVjW,KAAKysC,oBAAoBrrC,EAAGC,MAI5BrB,KAAKskB,yBAAyBljB,EAAGC,IAIvC,CACQijB,yBAAyBljB,EAAWC,GAM1C,OALUrB,KAAKsE,KAAKX,MAAMC,mBAAmBuS,eAAe2M,eAAewB,yBACzEljB,EAAIpB,KAAKsE,KAAKX,MAAMC,mBAAmBD,MAAM0lB,cAAcC,mBAAmBloB,EAC9EC,EAAIrB,KAAKsE,KAAKX,MAAMC,mBAAmBD,MAAM0lB,cAAcC,mBAAmBjoB,EAC9ErB,KAAKsE,KAAK6D,YAGVnI,KAAKsE,KAAK8F,SAAU,GACb,IAETpK,KAAKsE,KAAK8F,SAAU,GACb,EACT,CACQqiC,oBAAoBrrC,EAAWC,GAOrC,OALAD,GAAKpB,KAAKsE,KAAKX,MAAMC,mBAAmBD,MAAM0lB,cAAcC,mBAAmBloB,EAC/EC,GAAKrB,KAAKsE,KAAKX,MAAMC,mBAAmBD,MAAM0lB,cAAcC,mBAAmBjoB,EAE/ErB,KAAKsE,KAAK6tB,aAAa,IAEnBnyB,KAAKyyB,2BAA2BrxB,EAAGC,IACrCrB,KAAKsE,KAAK8F,SAAU,GACb,IAETpK,KAAKsE,KAAK8F,SAAU,GACb,EACT,CAOQqoB,2BAA2BrxB,EAAWC,GAAqB,IAAVsG,EAAC,uDAAG,IAC3D,MAAMwU,EAAMnc,KAAKsE,KAAK8sB,aAChBrB,EAAK/vB,KAAKsE,KAAKgtB,kBACrB,IAAK,IAAI/mB,EAAI,EAAKA,EAAI,EAAKA,GAAK,KAAO,CAErC,MAAM2lB,EACJ5d,KAAKyS,IAAIzS,KAAKme,IAAI,EAAIlmB,EAAG,IAAM4R,EAAI,GACnC,EAAI7J,KAAKme,IAAI,EAAIlmB,EAAG,GAAKA,EAAIwlB,EAAG,GAChC,EAAIzd,KAAKyS,IAAI,EAAIxa,GAAK+H,KAAKme,IAAIlmB,EAAG,GAAKwlB,EAAG,GAC1Czd,KAAKyS,IAAIzS,KAAKme,IAAIlmB,EAAG,IAAM4R,EAAI,GAC3BgU,EACJ7d,KAAKyS,IAAIzS,KAAKme,IAAI,EAAIlmB,EAAG,IAAM4R,EAAI,GACnC,EAAI7J,KAAKme,IAAI,EAAIlmB,EAAG,GAAKA,EAAIwlB,EAAG,GAChC,EAAIzd,KAAKyS,IAAI,EAAIxa,GAAK+H,KAAKme,IAAIlmB,EAAG,GAAKwlB,EAAG,GAC1Czd,KAAKyS,IAAIzS,KAAKme,IAAIlmB,EAAG,IAAM4R,EAAI,GAC3BiU,EACJ9d,KAAKyS,IAAIzS,KAAKme,IAAI,EAAIlmB,EAAG,IAAM4R,EAAI,GACnC,EAAI7J,KAAKme,IAAI,EAAIlmB,EAAG,GAAKA,EAAIwlB,EAAG,GAChC,EAAIzd,KAAKyS,IAAI,EAAIxa,GAAK+H,KAAKme,IAAIlmB,EAAG,GAAKwlB,EAAG,GAC1Czd,KAAKyS,IAAIzS,KAAKme,IAAIlmB,EAAG,IAAM4R,EAAI,GAC3BkU,EACJ/d,KAAKyS,IAAIzS,KAAKme,IAAI,EAAIlmB,EAAG,IAAM4R,EAAI,GACnC,EAAI7J,KAAKme,IAAI,EAAIlmB,EAAG,GAAKA,EAAIwlB,EAAG,GAChC,EAAIzd,KAAKyS,IAAI,EAAIxa,GAAK+H,KAAKme,IAAIlmB,EAAG,GAAKwlB,EAAG,GAC1Czd,KAAKyS,IAAIzS,KAAKme,IAAIlmB,EAAG,IAAM4R,EAAI,GAEjC,IADasX,EAAAA,EAAAA,IAAa,IAAIpxB,EAAAA,GAAS6tB,EAAIC,GAAK,IAAI9tB,EAAAA,GAASjB,EAAGC,IACrDsG,EAAI3H,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,YACxE,OAAO,EAGT,IADY6lB,EAAAA,EAAAA,IAAa,IAAIpxB,EAAAA,GAAS+tB,EAAIC,GAAK,IAAIhuB,EAAAA,GAASjB,EAAGC,IACrDsG,EAAI3H,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,YACvE,OAAO,CAEX,CACA,OAAO,CACT,CACOsF,0BAA0B5F,GAC/B,GAAItN,KAAKsE,KAAKqB,WAAa3F,KAAKsE,KAAKtC,cAAgBhC,KAAKsE,KAAK+B,cAC7D,OAEF,MAAMme,EAAKlX,EAAElM,EAAIkM,EAAE6F,KACbsR,EAAKnX,EAAEjM,EAAIiM,EAAE8F,KACnBpT,KAAKsE,KAAK4Y,GAAGta,IAAIxB,GAAKojB,EACtBxkB,KAAKsE,KAAK4Y,GAAGta,IAAIvB,GAAKojB,EACtBzkB,KAAKsE,KAAK6Y,GAAGva,IAAIxB,GAAKojB,EACtBxkB,KAAKsE,KAAK6Y,GAAGva,IAAIvB,GAAKojB,EACtBzkB,KAAKsE,KAAKwZ,GAAGlb,IAAIxB,GAAKojB,EACtBxkB,KAAKsE,KAAKwZ,GAAGlb,IAAIvB,GAAKojB,CAGxB,CAWO3R,SAsBL,MApBE,UACA9S,KAAKsE,KAAKhE,GADV,WAIAN,KAAKsE,KAAK/D,KAAKwS,WAJf,kBAWA/S,KAAKsE,KAAKqD,EAXV,kBAgBA3H,KAAKsE,KAAKyB,gBAhBV,gBAmBA/F,KAAKsE,KAAK0B,YAEd,CACOiN,OACA,EChJF,MAAMuC,WAA0BE,EAGrC7V,YAAYyE,GACVY,MAAMZ,GAAM,KAHPA,UAAI,OACHooC,SAAU,EAGhB1sC,KAAKsE,KAAOA,CACd,CACOkL,WAAW9L,GACZ1D,KAAKsE,KAAKqoC,aAAe3sC,KAAKsE,KAAKX,MAAMC,mBAAmB6L,cAAcC,aAAa6J,MAAM1U,QAC/F7E,KAAKsE,KAAKqoC,WAAa3sC,KAAKsE,KAAKX,MAAMC,mBAAmB6L,cAAcC,aAAa6J,MAAM1U,OAG7F7E,KAAKsE,KAAK6tB,gBAERnyB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAayY,WACxE/mB,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAas+B,iBAIxE5sC,KAAKsE,KAAKwK,yBAER9O,KAAKsE,KAAK6C,qBACZnH,KAAKsE,KAAKuoC,kBAEZ7sC,KAAKigB,mBAAmBvc,EAC1B,CACQuc,mBAAmBvc,GACzB1D,KAAKiwB,WAAWvsB,EAAK1D,KAAKsE,KAAK8sB,aAAcpxB,KAAKsE,KAAKgtB,kBACzD,CACQrB,WAAWvsB,EAA+BsnC,EAAmBna,GACnE,MAAM1U,EAAM6uB,EACNjb,EAAKc,EACLxkB,EAAI8P,EAAIjb,OAIR4rC,EAAQ,CAAC9sC,KAAKsE,KAAK4Y,GAAGta,IAAK5C,KAAKsE,KAAK6Y,GAAGva,IAAK5C,KAAKsE,KAAKwZ,GAAGlb,KAEhE5C,KAAKkgB,gBAAgB/D,EAAK4T,EAAI1jB,GAC9B,MAAM0gC,EAAS/sC,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMwa,MAClE/wB,KAAKsE,KAAKsB,cAAgB5F,KAAKsE,KAAKyB,iBAEtCgnC,EAAOC,oBACLtpC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBwb,EAAI,GACJA,EAAI,GACJ4T,EAAG,GACHA,EAAG,GACH5T,EAAI,GACJA,EAAI,GACJnc,KAAKsE,KAAKsB,aACVknC,EACA9sC,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,OAChFtV,KAAKsE,KAAKyB,gBACV/F,KAAKsE,KAAKjB,eAAe0T,MAAMC,aAC/BhX,KAAK0sC,QAzBc,GA4BrBK,EAAOC,oBACLtpC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBwb,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACR0jB,EAAG,EAAI1jB,EAAI,IACX0jB,EAAG,EAAI1jB,EAAI,GACX8P,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACRrM,KAAKsE,KAAKsB,aACVknC,EACA9sC,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,OAChFtV,KAAKsE,KAAKyB,gBACV/F,KAAKsE,KAAKjB,eAAe0T,MAAMC,aAC/BhX,KAAK0sC,SAEPK,EAAOE,oBACLvpC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzB,IAAI0B,EAAAA,GAAS8Z,EAAI,GAAIA,EAAI,IACzB,IAAI9Z,EAAAA,GAAS0tB,EAAG,GAAIA,EAAG,IACvB5T,EAAI,GACJA,EAAI,GACJnc,KAAKsE,KAAKqoC,WACV3sC,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WAAa3O,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,YAC7G5N,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,OAChFtV,KAAKsE,KAAKyB,gBACV/F,KAAKsE,KAAKjB,eAAe0T,MAAMC,cAE7BhX,KAAKsE,KAAK/D,OAAS6L,EAAAA,GAAAA,cACrB2gC,EAAOE,oBACLvpC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzB,IAAI0B,EAAAA,GAAS8Z,EAAI,GAAIA,EAAI,IACzB,IAAI9Z,EAAAA,GAAS0tB,EAAG,GAAIA,EAAG,IACvB5T,EAAI,GACJA,EAAI,GACJnc,KAAKsE,KAAKqoC,WACV3sC,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WAAa3O,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,aAC7G,EACA5N,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,OAChFtV,KAAKsE,KAAKyB,gBACV/F,KAAKsE,KAAKjB,eAAe0T,MAAMC,cAGnChX,KAAKsV,OAAStV,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAC1DrV,KAAKiP,OAAS,EACdjP,KAAKsE,KAAK8B,SAAU,IAEpB2mC,EAAOC,oBACLtpC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBwb,EAAI,GACJA,EAAI,GACJ4T,EAAG,GACHA,EAAG,GACH5T,EAAI,GACJA,EAAI,GACJnc,KAAKsE,KAAKsB,aACVknC,EACA9sC,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACV,EACAlH,KAAKsE,KAAKyB,gBACV/F,KAAKsE,KAAKjB,eAAe0T,MAAMC,aAC/BhX,KAAK0sC,QApGc,GAuGrBK,EAAOC,oBACLtpC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBwb,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACR0jB,EAAG,EAAI1jB,EAAI,IACX0jB,EAAG,EAAI1jB,EAAI,GACX8P,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACRrM,KAAKsE,KAAKsB,aACVknC,EACA9sC,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACV,EACAlH,KAAKsE,KAAKyB,gBACV/F,KAAKsE,KAAKjB,eAAe0T,MAAMC,aAC/BhX,KAAK0sC,SAEPK,EAAOE,oBACLvpC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzB,IAAI0B,EAAAA,GAAS8Z,EAAI,GAAIA,EAAI,IACzB,IAAI9Z,EAAAA,GAAS0tB,EAAG,GAAIA,EAAG,IACvB5T,EAAI,GACJA,EAAI,GACJnc,KAAKsE,KAAKqoC,WACV3sC,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WAAa3O,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,YAC7G5N,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACV,EACAlH,KAAKsE,KAAKyB,gBACV/F,KAAKsE,KAAKjB,eAAe0T,MAAMC,cAE7BhX,KAAKsE,KAAK/D,OAAS6L,EAAAA,GAAAA,cACrB2gC,EAAOE,oBACLvpC,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzB,IAAI0B,EAAAA,GAAS8Z,EAAI,GAAIA,EAAI,IACzB,IAAI9Z,EAAAA,GAAS0tB,EAAG,GAAIA,EAAG,IACvB5T,EAAI,GACJA,EAAI,GACJnc,KAAKsE,KAAKqoC,WACV3sC,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WAAa3O,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,aAC7G,EACA5N,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACV,EACAlH,KAAKsE,KAAKyB,gBACV/F,KAAKsE,KAAKjB,eAAe0T,MAAMC,cAGnChX,KAAKsV,MAAQ,EAEjB,CACQ4K,gBAAgB/D,EAAe4T,EAAc1jB,GACnDrM,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASqc,UAAU0P,6BACpDlxB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAC5C1hB,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK6D,UACVgU,EAAI,GACJA,EAAI,GACJ4T,EAAG,GACHA,EAAG,GACH5T,EAAI,GACJA,EAAI,IAENnc,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASqc,UAAU0P,6BACpDlxB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAC5C1hB,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK6D,UACVgU,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACR0jB,EAAG,EAAI1jB,EAAI,IACX0jB,EAAG,EAAI1jB,EAAI,GACX8P,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GAGZ,CAaW6gC,aACT,OAAOltC,KAAK0sC,OACd,CACWQ,WAAOhqC,GAChBlD,KAAK0sC,QAAUxpC,CACjB,ECpOK,MAAMgY,WAAuBM,EAElC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KAFNA,SAAG,EAGR1B,KAAKmO,cACLnO,KAAK0K,aACP,CACOyD,cACAnO,KAAKob,WACRpb,KAAK+W,MAAMC,aAAeM,EAAayD,WACvC/a,KAAKqb,cAAgB,CAAC,EAAG,EAAG,EAAG,GAC/Brb,KAAKob,UAAW,EAChBjD,EAAYg1B,uBACVntC,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElDyI,EAAYi1B,2BACVptC,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElD1P,KAAKqtC,kBAKT,CACO3iC,cAAsD,IAA1C4gB,EAA2B,4DAAG3oB,EAC/C3C,KAAKob,UAAW,OACFzY,IAAV2oB,IACFA,EAAQtrB,KAAK0B,IAAIiC,MAAMC,mBAAmB4H,wBAAwB+f,sBAAsBC,aAQ1FrT,EAAYm1B,6BACVttC,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD4b,GAEFnT,EAAYo1B,iCACVvtC,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD4b,GAEFtrB,KAAKqtC,kBACLrtC,KAAKqb,cAAgBiQ,CACvB,CACOkiB,oBACL,CAGKn/B,kBAAkBzC,GAmCvB,OAlCIA,EAAM6N,YACRzZ,KAAKqb,cAAgBzP,EAAM6N,WAEzB7N,EAAM/G,QACR7E,KAAKW,YAAYgO,WAAa/C,EAAM/G,MACpC7E,KAAK+W,MAAMlS,MAAQ+G,EAAM/G,OAEvB+G,EAAMtI,QACRtD,KAAK+W,MAAMzT,MAAQsI,EAAMtI,YAEPX,IAAhBiJ,EAAM0f,QACRtrB,KAAK+W,MAAMC,aAAepL,EAAM0f,YAEX3oB,IAAnBiJ,EAAM6hC,WACRztC,KAAK+W,MAAMiE,WAAapP,EAAM6hC,SAC9BztC,KAAKW,YAAYga,K5DjEgBra,KACrC,OAAQA,GACN,KAAK+W,EAAWq2B,MACd,MAAO,CAAC,EAAG,GACb,KAAKr2B,EAAWs2B,MACd,MAAO,CAAC,EAAG,GACb,KAAKt2B,EAAW4D,WACd,MAAO,CAAC,EAAG,GACb,QACE,MAAO,GAAG,E4DwDc2yB,CAAuBhiC,EAAM6hC,WAKnD7hC,EAAM6N,UAAUvY,OAAS,IAC3BiX,EAAY01B,6BACV7tC,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD9D,GAEFuM,EAAY21B,iCACV9tC,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD9D,GAEF5L,KAAKqtC,mBAEPrtC,KAAKob,UAAW,GACT,CACT,CACQiyB,kBACN,GAAIrtC,KAAK0B,IAAIya,IACX,IAAK,IAAIlb,EAAI,EAAGA,EAAIjB,KAAK0B,IAAIya,IAAIjb,SAAUD,EACzCjB,KAAK0B,IAAIya,IAAIlb,GAAGoC,eAAeuY,mBAAmB5b,KAAKmb,gBAG7D,CAEO1H,SACL,IAAKzT,KAAKob,SACR,OAGF,MAAMyQ,EAAc,CAClBvoB,MAAOtD,KAAK+W,MAAMzT,MAClBuB,MAAO7E,KAAKW,YAAYgO,WACxB8K,UAAWzZ,KAAKqb,eAelB,OAPIrb,KAAK+W,MAAMiE,aAAe3D,EAAW4D,aACvC4Q,EAAO4hB,SAAWztC,KAAK+W,MAAMiE,YAE3Bhb,KAAK+W,MAAMC,eAAiBM,EAAayD,aAC3C8Q,EAAOP,MAAQtrB,KAAK+W,MAAMC,cAGrB6U,CACT,EC/HK,MAAMC,WAAgCtQ,EAE3C3b,YAAYyE,GACVY,MAAMZ,GAAM,KAFPA,UAAI,EAGTtE,KAAKsE,KAAOA,CACd,CACO4O,0BAA0B5F,GAE/B,GAAItN,KAAKsE,KAAKqB,WAAa3F,KAAKsE,KAAKtC,cAAgBhC,KAAKsE,KAAK+B,cAC7D,OAOF,GAAIrG,KAAKsE,KAAKwZ,GAAGlY,aAGf,YADA5F,KAAKsE,KAAKwZ,GAAG5K,0BAA0B5F,GAIzC,MAAMkX,EAAKlX,EAAElM,EAAIkM,EAAE6F,KACbsR,EAAKnX,EAAEjM,EAAIiM,EAAE8F,KACnBpT,KAAKsE,KAAK4Y,GAAGta,IAAIxB,GAAKojB,EACtBxkB,KAAKsE,KAAK4Y,GAAGta,IAAIvB,GAAKojB,EAEtBzkB,KAAK0kB,2BAA2BpX,EAAGtN,KAAKsE,KAAK4Y,IAE7Cld,KAAKsE,KAAK6Y,GAAGva,IAAIxB,GAAKojB,EACtBxkB,KAAKsE,KAAK6Y,GAAGva,IAAIvB,GAAKojB,EAEtBzkB,KAAK0kB,2BAA2BpX,EAAGtN,KAAKsE,KAAK6Y,IAE7Cnd,KAAKsE,KAAKwZ,GAAGlb,IAAIxB,GAAKojB,EACtBxkB,KAAKsE,KAAKwZ,GAAGlb,IAAIvB,GAAKojB,EAEtBzkB,KAAK0kB,2BAA2BpX,EAAGtN,KAAKsE,KAAKwZ,GAQ/C,CACQ4G,2BAA2BpX,EAAmB7D,GACpD,SAAIA,EAAEa,iBACJb,EAAEa,eAAe4I,0BAA0B5F,IACvC7D,EAAEa,eAAe+I,eAEnB5J,EAAEa,eAAe+I,WAAWC,GAAGlS,EAAIqI,EAAE7G,IAAIxB,EACzCqI,EAAEa,eAAe+I,WAAWC,GAAGjS,EAAIoI,EAAE7G,IAAIvB,GAElC,EAIb,CAsCOkS,UAAUnS,EAAWC,GACrB,CAEA+L,KAAKhM,EAAWC,GACrB,GAAIrB,KAAKsE,KAAKqB,WAAa3F,KAAKsE,KAAKtC,cAAgBhC,KAAKsE,KAAK+B,cAC7D,OAEFrG,KAAKsE,KAAK4Z,mBACV,MAAMsG,EAAKpjB,EAAIpB,KAAKsE,KAAK1B,IAAIxB,EACvBqjB,EAAKpjB,EAAIrB,KAAKsE,KAAK1B,IAAIvB,EAC7B,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAKsE,KAAK6X,IAAIjb,SAAUD,EAC1CjB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIxB,GAAKojB,EAC1BxkB,KAAKsE,KAAK6X,IAAIlb,GAAG2B,IAAIvB,GAAKojB,CAG9B,EC1FK,MAAMspB,WAAexB,GAoB1BvwB,mBAAmBrY,EAAc2J,GAC/B,IAAK,IAAIrM,EAAI0C,EAAMqqC,WAAW9sC,OAAS,EAAGD,GAAK,IAAKA,EAClD,GAAI0C,EAAMqqC,WAAW/sC,GAAG+E,cAAgBrC,EAAMqqC,WAAW/sC,GAAG4R,cAAcvF,EAAElM,EAAGkM,EAAEjM,GAC/E,OAAOsC,EAAMqqC,WAAW/sC,EAI9B,CACA+a,mBAAmBrY,EAAc2J,GAC/B,MAAM0U,EAAK+rB,GAAO9rB,YAAYte,EAAO2J,QAC1B3K,IAAPqf,IACFA,EAAGpc,cAAe,EAEtB,CACAoW,iBAAiBrY,EAAcpD,GAC7B,IAAIU,EAAI0C,EAAMqqC,WAAW9sC,OACrB6gB,EAAQ,EACZ,KAAO9gB,KACD0C,EAAMqqC,WAAW/sC,GAAGV,OAASA,IAC/BwhB,GAAS,GAGb,OAAOA,CACT,CACA/F,0BAA0BrY,EAAcpD,GACtC,IAAIU,EAAI0C,EAAMqqC,WAAW9sC,OACrB6gB,EAAQ,EACZ,KAAO9gB,KACD0C,EAAMqqC,WAAW/sC,GAAGT,YAAcmD,EAAMqqC,WAAW/sC,GAAGV,OAASA,IACjEwhB,GAAS,GAGb,OAAOA,CACT,CAEA/F,gBAAgBrY,EAAc0M,GAAoE,IAArDtJ,EAAM,wDAAUuV,EAAU,wDAAU2xB,EAAM,wDACrF,MAAM/wB,EAAKnB,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAM,GAAImG,GAC/C+W,EAAK/B,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAM,GAAImG,GAC/CoW,EAAKpB,EAAOmG,gBAAgBve,EAAO0M,EAAEzP,MAAM,GAAImG,GAIrD,IAAIrF,EAHJwb,EAAG3c,KAAO6L,EAAAA,GAAAA,MACV0R,EAAGvd,KAAO6L,EAAAA,GAAAA,UACV+Q,EAAG5c,KAAO6L,EAAAA,GAAAA,MAIN1K,EAAM,IAAIqsC,GAAOpqC,EAAOuZ,EAAIC,EAD1BpW,IAG8B,EAJhCknC,EAEwC7hC,EAAAA,GAAAA,aAMAA,EAAAA,GAAAA,cAM5C1K,EAAIoc,GAAGlb,IAAIxB,EAAI0c,EAAGlb,IAAIxB,EACtBM,EAAIoc,GAAGlb,IAAIvB,EAAIyc,EAAGlb,IAAIvB,EACtByc,EAAGrN,SAED/O,EAAIpB,GADFgc,EACO3Y,EAAMsF,UAENoH,EAAE/P,GAGboB,EAAIyF,qBAAsB,EAC1BzF,EAAIwsC,6BAA+B,EAEnCxsC,EAAI0I,SAAU,EACd1I,EAAIoc,GAAGvd,KAAO6L,EAAAA,GAAAA,UAGViE,EAAEvP,KAAa,SACjBY,EAAIyD,SAAS+nC,OAAS78B,EAAEvP,KAAa,QAEnCuP,EAAExP,QACJa,EAAI2M,kBAAkBgC,EAAExP,QAG1Ba,EAAIwc,mBACJxc,EAAIoO,kBACC/I,GACHpD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,UAE3EukC,GAAOI,UAAUzoB,QAAK/iB,EACtBorC,GAAOI,UAAUxoB,QAAKhjB,EACtBorC,GAAOI,UAAUzsC,SAAMiB,CACzB,CACAqZ,wBAAwBrY,EAAc3C,GAAmD,IAAnCT,EAAW,uDAAG6L,EAAAA,GAAAA,aAClE2hC,GAAOlgB,cAAclqB,EAAO3C,EAAIT,EAClC,CACAyb,qBAAqBrY,EAAc3C,GAAmD,IAAnCT,EAAW,uDAAG6L,EAAAA,GAAAA,aAC/D,MAAMrF,GAAS,EACT2e,EAAK1kB,EAAG,GACR2kB,EAAK3kB,EAAGA,EAAGE,OAAS,GAEpBgc,EAAK,IAAInB,EAAOpY,EAAO+hB,EAAGtkB,EAAGskB,EAAGrkB,EAAG,EAAG0F,EAAQqF,EAAAA,GAAAA,OAC9C+Q,EAAK,IAAIpB,EAAOpY,EAAOgiB,EAAGvkB,EAAGukB,EAAGtkB,EAAG,EAAG0F,EAAQqF,EAAAA,GAAAA,OAE9C1K,EAAM,IAAIqsC,GAAOpqC,EAAOuZ,EAAIC,EAAIpW,EAAQxG,GAC9CmB,EAAIlB,WAAakB,EAAI0I,QAAU1I,EAAIyF,qBAAsB,EAEzDxD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiBpP,EAAI8H,SAC3E,CACAwS,kBAAkBrY,EAAc2J,EAAmB8gC,GACjD,QAA6BzrC,IAAzBorC,GAAOI,UAAUzsC,IAAmB,CACtC,MAAM2sC,EAAK,IAAItyB,EAAOpY,EAAO2J,EAAElM,EAAGkM,EAAEjM,EAAG,GACvCgtC,EAAGroC,cAAe,EACdooC,IAAahiC,EAAAA,GAAAA,mBAA8CzJ,IAAxBorC,GAAOI,UAAUzoB,KACtDqoB,GAAOI,UAAUzsC,IAAM,IAAIqsC,GACzBpqC,EACAoqC,GAAOI,UAAUzoB,GACjB2oB,GACA,EACAjiC,EAAAA,GAAAA,eAGAgiC,IAAahiC,EAAAA,GAAAA,mBAA8CzJ,IAAxBorC,GAAOI,UAAUzoB,KACtDqoB,GAAOI,UAAUzsC,IAAM,IAAIqsC,GACzBpqC,EACAoqC,GAAOI,UAAUzoB,GACjB2oB,GACA,EACAjiC,EAAAA,GAAAA,oBAGyBzJ,IAAzBorC,GAAOI,UAAUzsC,MACnBqsC,GAAOI,UAAUzsC,IAAIsE,cAAe,EAExC,WACkCrD,IAA5BorC,GAAOI,UAAUzsC,IAAIyb,IACvB4wB,GAAOI,UAAUzsC,IAAIyb,GAAG/P,KAAKE,EAAElM,EAAGkM,EAAEjM,EAG1C,CACA2a,eAAerY,EAAc2J,GAAkC,2CAAGlB,EAAAA,GAAAA,aAChE,QAA4BzJ,IAAxBorC,GAAOI,UAAUzoB,IAGd,QAA4B/iB,IAAxBorC,GAAOI,UAAUzoB,GAAkB,CAC5C,QAA6B/iB,IAAzBorC,GAAOI,UAAUzsC,IACnB,OAaF,OAXAqsC,GAAOI,UAAUzsC,IAAIyb,GAAG/P,KAAKE,EAAElM,EAAGkM,EAAEjM,GACpC0sC,GAAOI,UAAUzsC,IAAImrC,kBAErBkB,GAAOI,UAAUzsC,IAAIsE,cAAe,EACpC+nC,GAAOI,UAAUzsC,IAAIyF,qBAAsB,EAC3C4mC,GAAOI,UAAUzsC,IAAIlB,YAAa,EAClCutC,GAAOI,UAAUzsC,IAAIqJ,YAAa,OAClCpH,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAClDi9B,GAAOI,UAAUzsC,IAAI8H,SAIzB,OAlBEukC,GAAOI,UAAUzoB,GAAK,IAAI3J,EAAOpY,EAAO2J,EAAElM,EAAGkM,EAAEjM,EAmBnD,CAEA2a,mBAAmBrY,EAAc8F,GAC/B,QAA4B9G,IAAxBorC,GAAOI,UAAUzoB,SAA4C/iB,IAAxBorC,GAAOI,UAAUxoB,GAOxD,OANAooB,GAAOI,UAAUzoB,GAAK,IAAI3J,EAAOpY,EAAO8F,EAAE7G,IAAIxB,EAAGqI,EAAE7G,IAAIvB,EAAGoI,EAAE7G,IAAItB,QAC5DysC,GAAO/mB,MACT+mB,GAAOI,UAAUzoB,GAAG9iB,IAAM6G,EAAE7G,IAE5B6G,EAAEgH,eAKuB9N,IAAzBorC,GAAOI,UAAUzsC,UAAiDiB,IAA5BorC,GAAOI,UAAUzsC,IAAIyb,IAC7D4wB,GAAOI,UAAUzsC,IAAIyb,GAAG/P,KAAK3D,EAAE7G,IAAIxB,EAAGqI,EAAE7G,IAAIvB,QAEjBsB,IAAzBorC,GAAOI,UAAUzsC,MACnBqsC,GAAOI,UAAUzsC,IAAIsE,cAAe,EACpC+nC,GAAOI,UAAUzsC,IAAIyF,qBAAsB,GAEzCsC,EAAElJ,OAAS6L,EAAAA,GAAAA,MACT2hC,GAAO/mB,YAAkCrkB,IAAzBorC,GAAOI,UAAUzsC,MACnCqsC,GAAOI,UAAUzsC,IAAIyb,GAAGva,IAAM6G,EAAE7G,KAEzB6G,EAAElJ,OAAS6L,EAAAA,GAAAA,QACpB3C,EAAEgH,QAIN,CACAuL,qBAC+BrZ,IAAzBorC,GAAOI,UAAUzsC,KACnBqsC,GAAOI,UAAUzsC,IAAI+O,SAEvBs9B,GAAOI,UAAUzoB,QAAK/iB,EACtBorC,GAAOI,UAAUxoB,QAAKhjB,EACtBorC,GAAOI,UAAUzsC,SAAMiB,CACzB,CAGAqZ,iBAAiBrY,EAAc2J,EAAmBghC,QAInB3rC,IAAzBorC,GAAOI,UAAUzsC,WACGiB,IAAlBgB,EAAMgP,SAAyBhP,EAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,OACxD2hC,GAAOQ,YAAY5qC,EAAOA,EAAMgP,SAEhCo7B,GAAOhrB,QAAQpf,EAAO2J,EAAGghC,GAG3BP,GAAOI,UAAUzsC,IAAIwc,mBACrB6vB,GAAOI,UAAUzsC,IAAIyF,qBAAsB,EAG3CxD,EAAMmb,QAAUivB,GAAOI,UAAUzsC,IACjCqsC,GAAOI,UAAUzsC,IAAIlB,YAAa,EAElCutC,GAAOI,UAAUzoB,QAAK/iB,EACtBorC,GAAOI,UAAUxoB,QAAKhjB,EACtBorC,GAAOI,UAAUzsC,SAAMiB,EAGvBorC,GAAO9qB,QAAS,EAChBtf,EAAMC,mBAAmB4H,wBAAwB8C,aAAauyB,gBAAiB,EAC/El9B,EAAMC,mBAAmB4H,wBAAwBgX,cAE/CurB,GAAOI,UAAUzsC,KACnB1B,KAAKkjB,WAAWvf,EAAO2J,EAAGghC,EAE9B,CACAtyB,sBAAsBrY,EAAc2J,EAAmBghC,GAEjDP,GAAO9qB,OACT8qB,GAAO9qB,QAAS,QAGItgB,IAAlBgB,EAAMgP,SACJhP,EAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,aAAkCzJ,IAAlBgB,EAAMgP,UAC/Co7B,GAAOQ,YAAY5qC,EAAOA,EAAMgP,SAChCo7B,GAAO9qB,QAAS,QAIStgB,IAAzBorC,GAAOI,UAAUzsC,MACnBqsC,GAAOhrB,QAAQpf,EAAO2J,EAAGghC,GACzBP,GAAO9qB,QAAS,GAElB8qB,GAAO7qB,WAAWvf,EAAO2J,EAAGghC,GAK9B,CACAtyB,iBAAiBrY,EAAc2J,EAAmBghC,QACpB3rC,IAAxBorC,GAAOI,UAAUzoB,IACnBqoB,GAAO7qB,WAAWvf,EAAO2J,EAAGghC,EAEhC,CACAtyB,eAAe1O,GACb,CAEFzN,YACE8D,EACAuZ,EACAC,GAGC,IAFDpW,EAAM,wDACNxG,EAAW,uDAAG6L,EAAAA,GAAAA,aAEdlH,MAAMvB,GAAO,KA1RRwB,cAAQ,OACRuC,UAAI,OACJwV,QAAE,OACFC,QAAE,OACFW,QAAE,OACF4B,UAAI,OACJ7G,eAAS,OACT21B,iBAAW,OACXryB,SAAG,OACHiV,kBAAY,OACZC,iBAAW,OACXC,uBAAiB,OACjBqb,gBAAU,OAEVppB,aAAe,EAAE,KAChB2qB,6BAA+B,EA4QrCluC,KAAK+G,OAASA,EACd/G,KAAKO,KAAOA,EACZP,KAAKkd,GAAKA,EACVld,KAAKmd,GAAKA,EACV,MAAMsJ,GAAKN,EAAAA,EAAAA,IAAOnmB,KAAKkd,GAAGta,IAAK5C,KAAKmd,GAAGva,KACvC5C,KAAK8d,GAAK,IAAI/B,EAAOpY,EAAO8iB,EAAGrlB,EAAGqlB,EAAGplB,EAAGolB,EAAGnlB,GAC3CtB,KAAKkd,GAAG3c,KAAO6L,EAAAA,GAAAA,MACfpM,KAAK8d,GAAGvd,KAAO6L,EAAAA,GAAAA,MACfpM,KAAKmd,GAAG5c,KAAO6L,EAAAA,GAAAA,MACfpM,KAAK0f,KAAO,CAAC1f,KAAKkd,GAAGta,IAAK5C,KAAK8d,GAAGlb,IAAK5C,KAAKmd,GAAGva,KAC/C5C,KAAKiL,QAAS,EACdjL,KAAK0H,KAAO,IAAIrF,EAAAA,GAAS,EAAG,EAAG,GAE/BrC,KAAK4c,gBACL5c,KAAKyuC,WACP,CACQ7xB,gBACN5c,KAAKoF,eAAiB,IAAI0mB,GAAwB9rB,MAClDA,KAAKqF,YAAc,IAAIsjB,GAAqB3oB,MAC5CA,KAAKqD,eAAiB,IAAI6X,GAAelb,MACzCA,KAAKmF,SAAW,IAAIqQ,GAAkBxV,KACxC,CACQyuC,YACNzuC,KAAKke,mBACLle,KAAKkd,GAAG1K,QAAQxS,MAChBA,KAAK8d,GAAGtL,QAAQxS,MAChBA,KAAKmd,GAAG3K,QAAQxS,MAChBA,KAAKmc,IAAM,CAACnc,KAAKkd,GAAIld,KAAK8d,GAAI9d,KAAKmd,IACnCnd,KAAK2sC,WAAa,EAClB3sC,KAAK6Y,UAAY,EACjB7Y,KAAKwuC,YAAc,GAGnBxuC,KAAK2D,MAAM+qC,UAAU1uC,KACvB,CACO6sC,kBACL,MAAMpmB,GAAKN,EAAAA,EAAAA,IAAOnmB,KAAKkd,GAAGta,IAAK5C,KAAKmd,GAAGva,KACvC5C,KAAK8d,GAAGlb,IAAIxB,EAAIqlB,EAAGrlB,EACnBpB,KAAK8d,GAAGlb,IAAIvB,EAAIolB,EAAGplB,EAGnBrB,KAAK8d,GAAGrM,YAAa,EACrBzR,KAAK8d,GAAGvd,KAAO6L,EAAAA,GAAAA,SACjB,CAYOgmB,cAAcpxB,GACnB,MAAMsyB,EAAoB,GAGpB/G,EAAOvsB,KAAK2D,MAAM0lB,cAAcC,mBAAmBloB,EACnDorB,EAAOxsB,KAAK2D,MAAM0lB,cAAcC,mBAAmBjoB,EAEzD,IAAK,MAAMoI,KAAKzI,EACdsyB,EAAQnyB,KAAKsI,EAAErI,EAAImrB,EAAM9iB,EAAEpI,EAAImrB,GAEjC,OAAO8G,CACT,CACQjB,gBAAsB,IAARhW,EAAC,uDAAG,EACxB,MAAMyT,EAAmB,GACzB,IAAK,IAAI7uB,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrC6uB,EAAO3uB,KAAKkb,GAEdrc,KAAKqxB,YAAcvB,CACrB,CACOwC,oBAAoBqc,GACzB,MAAMxyB,EAAgB,GACtB,IAAK,MAAMoX,KAAMob,EACfxyB,EAAIhb,KAAKoyB,GAEX,IAAIjC,EAA8B,GAClC,IAAK,IAAIrwB,EAAI,EAAGA,EAAIkb,EAAIjb,OAAS,EAAGD,GAAK,EACvCqwB,EAAoBA,EAAkBkC,OACpCoY,GAAO5b,iBACL7T,EAAIlb,GACJkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRjB,KAAKqxB,YAAYpwB,KAIvB,OAAOqwB,CACT,CACO5jB,gBAAgBtM,EAAWC,GAChC,IAAIrB,KAAK2F,UAAa3F,KAAKgC,eAAgBhC,KAAKqG,cAGhD,OAAIrG,KAAKkd,GAAGrK,cAAczR,EAAGC,GACpBrB,KAAKkd,GACHld,KAAKmd,GAAGtK,cAAczR,EAAGC,GAC3BrB,KAAKmd,QADP,CAIT,CACOgV,eAA4B,IAAfrC,EAAM,uDAAG,GAC3B9vB,KAAKoxB,aAAepxB,KAAKoyB,cAAcpyB,KAAK2M,WAC5C3M,KAAKqyB,cAAcvC,GACnB9vB,KAAKsxB,kBAAoBtxB,KAAKsyB,oBAAoBtyB,KAAKoxB,cACvDpxB,KAAKke,kBACP,CACOA,mBACL,MAAMld,EAAiB,CAAChB,KAAKkd,GAAGta,IAAK5C,KAAKmd,GAAGva,IAAK5C,KAAK8d,GAAGlb,KAE1D,OADA5C,KAAK4C,KAAMyjB,EAAAA,EAAAA,IAAqBrlB,GACzBhB,KAAK4C,GACd,CAEOkQ,SACL,OAAO9S,KAAKqF,YAAYyN,QAC1B,CAMO/C,SAAS3O,EAAWC,GACzBrB,KAAKQ,YAAa,EAClB,MAAM0c,EAAKld,KAAKkd,GAAGnN,WACboN,EAAKnd,KAAKmd,GAAGpN,WACnB,GAAImN,GAAMC,EAAI,CACZ,MAAM+H,EAAM,IAAI6oB,GAAO/tC,KAAK2D,MAAOuZ,EAAIC,GAAI,EAAOnd,KAAKO,MAMvD,OALA2kB,EAAIpH,GAAGlb,IAAIxB,EAAIpB,KAAK8d,GAAGlb,IAAIxB,EAC3B8jB,EAAIpH,GAAGlb,IAAIvB,EAAIrB,KAAK8d,GAAGlb,IAAIvB,EAC3B6jB,EAAI/d,qBAAsB,EAC1B+d,EAAI9X,KAAKhM,EAAGC,GACZ6jB,EAAIrU,eACGqU,CACT,CAEF,CACOhV,gBACLlQ,KAAKgG,cAAe,EACpBhG,KAAKuH,eAAgB,EACrBvH,KAAKkd,GAAGhN,gBACRlQ,KAAK8d,GAAG5N,gBACRlQ,KAAKmd,GAAGjN,eAGV,CACO9C,KAAKhM,EAAWC,GACrB,GAAIrB,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,cAC9C,OAEFrG,KAAKke,mBACL,MAAMsG,EAAKpjB,EAAIpB,KAAK4C,IAAIxB,EAClBqjB,EAAKpjB,EAAIrB,KAAK4C,IAAIvB,EACxB,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAKmc,IAAIjb,SAAUD,EACrCjB,KAAKmc,IAAIlb,GAAG2B,IAAIxB,GAAKojB,EACrBxkB,KAAKmc,IAAIlb,GAAG2B,IAAIvB,GAAKojB,CAGzB,CAkDO9X,UAOL,MAAO,CAAC3M,KAAKkd,GAAGta,IAAK5C,KAAK8d,GAAGlb,IAAK5C,KAAKmd,GAAGva,IAC5C,CACO8G,mBAAmB1I,GACxB,UAAI2I,EAAAA,EAAAA,IAAe3J,KAAKkd,GAAGta,IAAK5B,KAC1B2I,EAAAA,EAAAA,IAAe3J,KAAK8d,GAAGlb,IAAK5B,KAC1B2I,EAAAA,EAAAA,IAAe3J,KAAKmd,GAAGva,IAAK5B,GAMtC,CACO4I,qBAAqB5I,GAC1B,SAAI2I,EAAAA,EAAAA,IAAe3J,KAAKkd,GAAGta,IAAK5B,QAG5B2I,EAAAA,EAAAA,IAAe3J,KAAK8d,GAAGlb,IAAK5B,OAG5B2I,EAAAA,EAAAA,IAAe3J,KAAKmd,GAAGva,IAAK5B,GAIlC,CACO6R,cAAczR,EAAWC,GAC9B,OAAOrB,KAAKqF,YAAYwN,cAAczR,EAAGC,EAC3C,CACO6R,0BAA0B5F,GAC/BtN,KAAKoF,eAAe8N,0BAA0B5F,EAChD,CACOmD,SAA+B,IAAxB5J,IAAQ,yDAWpB,GAVA7G,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EACpBhC,KAAK2F,UAAW,EAChB3F,KAAKkd,GAAGa,aACR/d,KAAKmd,GAAGY,aACR/d,KAAK8d,GAAGC,aAER/d,KAAK2D,MAAMirC,aAAa5uC,MACxBA,KAAK2D,MAAM8a,eAAeze,MAEtB6G,EAAU,CACZ,MAAMuX,EAAQpe,KAAKwJ,SACf4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB,CAACvG,GAElF,CACF,CACOnL,OACLjT,KAAKqF,YAAY4N,MACnB,CAEO7J,UACL,MAAMlG,EAAgB,GAItB,OAHAA,EAAE/B,KAAKnB,KAAKkd,GAAGta,KACfM,EAAE/B,KAAKnB,KAAK8d,GAAGlb,KACfM,EAAE/B,KAAKnB,KAAKmd,GAAGva,KACRM,CACT,CAEW1C,iBACT,OAAOR,KAAK+F,eACd,CACWvF,eAAW0C,GACwB,IAAxClD,KAAKkuC,iCAKPluC,KAAK2D,MAAMgP,UAAY3S,MACvBA,KAAK6S,cACH7S,KAAK2D,MAAMC,mBAAmB4H,wBAAwBiS,EAAErc,EACxDpB,KAAK2D,MAAMC,mBAAmB4H,wBAAwBiS,EAAEpc,IAG1DrB,KAAK+F,iBAAkB,EACvB/F,KAAKkd,GAAGlb,cAAe,EACvBhC,KAAKmd,GAAGnb,cAAe,EACvBhC,KAAK8d,GAAG9b,cAAe,IAEvBhC,KAAK+F,gBAAkB7C,EACvBlD,KAAKkd,GAAGlb,aAAekB,EACvBlD,KAAKmd,GAAGnb,aAAekB,EACvBlD,KAAK8d,GAAG9b,aAAekB,GAEzBlD,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2c,eAAe3mB,KAAKwJ,UAC/E,CACWY,cACT,OAAOpK,KAAK4F,YACd,CACWwE,YAAQlH,GACblD,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,eAG5CrG,KAAKmH,sBAGTnH,KAAK4F,aAAe1C,GAChBlD,KAAK4F,eAAiB5F,KAAK6F,aAEnB7F,KAAK4F,cAAgB5F,KAAK6F,aADpC7F,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB4c,WAAW5mB,KAAKwJ,UAI3ExJ,KAAK6F,WAAa7F,KAAK4F,aAClB5F,KAAK+F,kBACR/F,KAAKkd,GAAGlb,aAAekB,EACvBlD,KAAKmd,GAAGnb,aAAekB,EACvBlD,KAAK8d,GAAG9b,aAAekB,GAEpBA,IACHlD,KAAK8G,mBAAoB,EACzB9G,KAAK4M,oBAET,CACWlM,eACT,OAAOV,KAAKqG,aACd,CACW3F,aAASwC,GAClBlD,KAAKqG,cAAgBnD,EACrBlD,KAAKkd,GAAG7W,cAAgBnD,EACxBlD,KAAKkd,GAAG7S,WAAa,EACrBrK,KAAK8d,GAAGzX,cAAgBnD,EACxBlD,KAAK8d,GAAGzT,WAAa,EACrBrK,KAAKmd,GAAG9W,cAAgBnD,EACxBlD,KAAKmd,GAAG9S,WAAa,EACrBrK,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBC,UAAUjK,KAAKwJ,SAC1E,CACWuB,iBACT,OAAO/K,KAAKyG,eACd,CACWsE,eAAW7H,GACpBlD,KAAKyG,gBAAkBzG,KAAKkd,GAAGzW,gBAAkBzG,KAAK8d,GAAGrX,gBAAkBzG,KAAKmd,GAAG1W,gBAAkBvD,CACvG,CACOsM,WAAW9L,GAChB1D,KAAKmF,SAASqK,WAAW9L,EAC3B,CAaOiN,kBACL,IAAK3Q,KAAK2D,MAAMC,mBAAmBC,gBAAgBC,IAAI+qC,OAAOC,IAC5D,OAEF9uC,KAAKmF,SAAS+nC,QAAUltC,KAAKmF,SAAS+nC,OACtC,MAAM6B,EAAO/uC,KAAKwJ,SACdulC,GACF/uC,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBqU,eAAe,CAAC0wB,GAE7E,CACOn+B,UAEA,CAEApH,SACL,MAAMC,EAAI,IAAIpJ,EACZL,KAAKM,GACLN,KAAKO,KACLP,KAAK+F,gBACL/F,KAAK4F,aACL5F,KAAKqG,eAEPoD,EAAE1I,SAASf,KAAKoJ,WAEhB,MAAMwC,EAAQ5L,KAAKqD,eAAeoQ,SAclC,OAbI7H,IACFnC,EAAE5I,OAAS+K,GAYNnC,CACT,EArrBWskC,GACG9qB,QAAS,EADZ8qB,GAEG/mB,OAAQ,EAFX+mB,GAGGI,UAA8B,IAXvC,MAILtuC,cAAe,KAHR6lB,QAAE,OACFC,QAAE,OACFjkB,SAAG,CAGV,GCrBK,MAAMstC,GAMXnvC,YAAYovC,GAAkC,KALvCC,iBAAmB,GAAG,KACtBD,aAAO,OACPE,mBAAa,OACbC,aAAO,OACPxsC,SAAG,EAER5C,KAAKivC,QAAUA,EACfjvC,KAAKqvC,cACL,MAAM56B,EAAM,CAAC,IAAK,EAAG,EAAG,GACxBzU,KAAKsvC,QAAO,eAAW76B,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,IAChE,CACW66B,YAAQpsC,GAEblD,KAAKovC,UACPpvC,KAAKovC,QAAQxjC,MAAM0f,MAAQ,QAE/B,CACOikB,YACL,GAAIvvC,KAAKovC,QAAS,CAChB,MAAMvqC,EAAQ7E,KAAKivC,QAAQtrC,MAAMC,mBAAmB6L,cAAcC,aAAa8/B,eAC5E3qC,MAEG8nB,EAAsB,KADb3sB,KAAKivC,QAAQtpB,GAAGvkB,EAAIpB,KAAKivC,QAAQvpB,GAAGtkB,GAAKyD,GAKtD7E,KAAKovC,QAAQxjC,MAAMW,KADP,IAAV1H,EAEA7E,KAAKivC,QAAQQ,UAAUruC,EAAIpB,KAAKkvC,iBAAmBrqC,EAAQ8nB,EAAc,KAEjD3sB,KAAKivC,QAAQQ,UAAUruC,EAAIurB,EAAc,KAKrE3sB,KAAKovC,QAAQxjC,MAAMU,IACjBtM,KAAKivC,QAAQS,IAAI9sC,IAAIvB,EACrBiR,KAAKyS,IAAI/kB,KAAKivC,QAAQtpB,GAAGtkB,EAAIrB,KAAKivC,QAAQvpB,GAAGrkB,GACK,GAAlDiR,KAAKyS,IAAI/kB,KAAKivC,QAAQtpB,GAAGtkB,EAAIrB,KAAKivC,QAAQvpB,GAAGrkB,GAC7C,KAIFrB,KAAKovC,QAAQxjC,MAAMU,IAAMtM,KAAKivC,QAAQvpB,GAAGrkB,EAAIrB,KAAKkvC,iBAAmB,KAOrElvC,KAAKovC,QAAQxjC,MAAMtI,OAAStD,KAAKivC,QAAQ3rC,MAAgC,EAAxBtD,KAAKkvC,kBAAwBrqC,EAAQ,IACxF,CACI7E,KAAKmvC,gBACPnvC,KAAKmvC,cAAcvjC,MAAMU,IAAMtM,KAAKivC,QAAQvpB,GAAGrkB,EAAIrB,KAAKivC,QAAQU,oBAAsB,KACtF3vC,KAAKmvC,cAAcvjC,MAAMW,KAAOvM,KAAKivC,QAAQvpB,GAAGtkB,EAAI,KAExD,CACOwuC,cACD5vC,KAAKovC,SACPpvC,KAAKivC,QAAQtrC,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAIa,YACnF/M,KAAKovC,SAGLpvC,KAAKmvC,eACPnvC,KAAKivC,QAAQtrC,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAIa,YACnF/M,KAAKmvC,eAGTnvC,KAAKovC,aAAUzsC,EACf3C,KAAKmvC,mBAAgBxsC,EACrB3C,KAAKivC,QAAQtrC,MAAMC,mBAAmBmG,GAAGC,wBAAwB6lC,cAC/D7vC,KAAKivC,QAAQzlC,SAEjB,CACO6lC,cACLrvC,KAAK8vC,sBACL9vC,KAAK+vC,eACA/vC,KAAKivC,QAAQ9nC,qBAChBnH,KAAKivC,QAAQtrC,MAAMC,mBAAmBmG,GAAGC,wBAAwBgmC,cAC/DhwC,KAAKivC,QAAQzlC,SAGnB,CACOymC,iBACWvkC,SAASwkC,eAAe,eAAiBlwC,KAAKivC,QAAQ3uC,MAIpEN,KAAKivC,QAAQtrC,MAAMC,mBAAmBmG,GAAGC,wBAAwBmmC,iBAC/DnwC,KAAKivC,QAAQzlC,UAEfxJ,KAAKivC,QAAQtrC,MAAMC,mBAAmB4H,wBAAwB4kC,eAAgB,EAElF,CACQL,eACN,MAAMZ,EAAgBzjC,SAASC,cAAc,OAa7C,OAZAwjC,EAAc7uC,GAAK,gBAAkBN,KAAKivC,QAAQ3uC,GAClD6uC,EAAcvjC,MAAMC,SAAW,WAC/BsjC,EAAcvjC,MAAMrI,OAAS,MAC7B4rC,EAAcvjC,MAAMtI,MAAQ,MAC5B6rC,EAAcvjC,MAAMG,gBAAkB,UACtCojC,EAAcvjC,MAAMU,IAAMtM,KAAKivC,QAAQvpB,GAAGrkB,EAAIrB,KAAKivC,QAAQU,oBAAsB,KACjFR,EAAcvjC,MAAMW,KAAOvM,KAAKivC,QAAQvpB,GAAGtkB,EAAI,KAC/CpB,KAAKmvC,cAAgBA,EACrBnvC,KAAKivC,QAAQtrC,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAImkC,aACnFrwC,KAAKmvC,cACLnvC,KAAKivC,QAAQtrC,MAAMC,mBAAmBgL,oBAAoBmD,cAAc0xB,YAAYC,QAE/EyL,CACT,CACQW,sBACN,MAAMV,EAAU1jC,SAASC,cAAc,OAgCvC,OA/BAyjC,EAAQ9uC,GAAK,eAAiBN,KAAKivC,QAAQ3uC,GAC3C8uC,EAAQxjC,MAAMC,SAAW,WACzBujC,EAAQxjC,MAAM0kC,aAAe,QAC7BlB,EAAQxjC,MAAM2kC,SAAWvwC,KAAKivC,QAAQuB,SAAmC,EAAxBxwC,KAAKkvC,iBAAuB,KAC7EE,EAAQxjC,MAAMtI,MAAQtD,KAAKivC,QAAQ3rC,MAAgC,EAAxBtD,KAAKkvC,iBAAuB,KACvEE,EAAQxjC,MAAMW,KAAOvM,KAAKivC,QAAQvpB,GAAGtkB,EAAIpB,KAAKkvC,iBAAmB,KACjEE,EAAQxjC,MAAMU,IAAMtM,KAAKivC,QAAQvpB,GAAGrkB,EAAIrB,KAAKkvC,iBAAmB,KAChEE,EAAQqB,YAAc,KAElBzwC,KAAKivC,QAAQtrC,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAC7DC,oBAAoBC,OAASC,EAAAA,GAAAA,UAIlCjW,KAAKivC,QAAQtrC,MAAMC,mBAAmB4H,wBAAwB4kC,eAAgB,EAAI,EAEpFhB,EAAQsB,iBAAiB,WAAYpjC,IAC/BtN,KAAKivC,SAAWG,EAAQuB,eAC1B3wC,KAAKivC,QAAQ1rC,OAAS6rC,EAAQuB,aAC9B3wC,KAAKivC,QAAQnhC,qBAEXshC,EAAQwB,YAGZ5wC,KAAKivC,QAAQtrC,MAAMC,mBAAmBgL,oBAAoBC,aAAa,IAEzE7O,KAAKivC,QAAQtrC,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAImkC,aACnFjB,EACApvC,KAAKivC,QAAQtrC,MAAMC,mBAAmBgL,oBAAoBmD,cAAc0xB,YAAYC,QAEtF1jC,KAAKovC,QAAUA,EACRA,CACT,EChJK,IAAKyB,IAKX,SALWA,GAAAA,EAAuB,gBAAvBA,EAAuB,kBAAvBA,EAAuB,YAAvBA,EAAuB,cAKlC,CALWA,KAAAA,GAAuB,KAM5B,MAAMC,GAQXjxC,YACEkxC,EACA3vC,EACAC,GAEC,IADDd,EAA6B,uDAAGswC,GAAwBG,OAAM,KAXzDpuC,SAAG,OACH+E,EAAY,EAAS,KACrBspC,UAAoB,IAAS,KAC7BC,SAAmB,IAAS,KAC5B3wC,UAAI,OACJwwC,YAAM,OACNt0B,aAAc,EAOnBzc,KAAK+wC,OAASA,EACd/wC,KAAKO,KAAOA,EACZP,KAAK4C,IAAM,IAAIP,EAAAA,GAASjB,EAAGC,EAC7B,CACOwR,cAAczR,EAAWC,GAC9B,OAAI6L,EAAAA,EAAAA,IAAY,IAAI7K,EAAAA,GAASjB,EAAGC,GAAIrB,KAAK4C,KAAO5C,KAAK2H,EAAI,CAI3D,CACOsmB,UAAU7sB,EAAWC,GAC1BrB,KAAK4C,IAAIxB,EAAIA,EACbpB,KAAK4C,IAAIvB,EAAIA,CACf,CACOoC,OAAOC,GACZ1D,KAAK+wC,OAAOptC,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM7R,KAAKysC,cAC5DztC,EACA1D,KAAK+wC,OAAO1tC,eACZrD,KAAK4C,IAAIxB,EACTpB,KAAK4C,IAAIvB,EACTrB,KAAKkxC,SACLlxC,KAAKixC,UAET,EAEK,MAAMG,WAAkCN,GAC7CjxC,YACEkxC,EACA3vC,EACAC,GAGA6D,MAAM6rC,EAAQ3vC,EAAGC,EAFY,uDAAGwvC,GAAwBG,OAG1D,EAEK,MAAMK,WAA+BP,GAC1CjxC,YACEkxC,EACA3vC,EACAC,GAGA6D,MAAM6rC,EAAQ3vC,EAAGC,EAFY,uDAAGwvC,GAAwBS,QAG1D,ECzDK,MAAMC,GAgBX1xC,YAAYkxC,EAAgCS,GAAqC,KAf1ET,YAAM,OACN3mC,SAAU,EAAK,KACfsb,QAAE,OACFC,QAAE,OACF8pB,eAAS,OACTgC,cAAQ,OAGR5oC,iBAAW,OACX0B,EAAI,EAAI,KACR5C,EAAI,IAAI,KACRxB,QAAS,EAAM,KACfurC,cAAe,EAAM,KACrBC,YAAa,EAAM,KAClBC,SAAG,EAET5xC,KAAK+wC,OAASA,EACd/wC,KAAK0lB,GAAK8rB,EAAc5uC,IACxB5C,KAAKyvC,UAAY,IAAIptC,EAAAA,GAAS,EAAG,GACjCrC,KAAK2lB,GAAK,IAAItjB,EAAAA,GAASrC,KAAK0lB,GAAGtkB,EAAGpB,KAAK0lB,GAAGrkB,GAC1CrB,KAAKyxC,SAAW,IAAIpvC,EAAAA,GAASrC,KAAK0lB,GAAGtkB,EAAGpB,KAAK0lB,GAAGrkB,GAChDrB,KAAKsT,GAAK,IAAIjR,EAAAA,GAASrC,KAAK0lB,GAAGtkB,EAAGpB,KAAK0lB,GAAGrkB,GAC1CrB,KAAK6I,YAAc,CAAC7I,KAAKsT,GAC3B,CACOT,cAAczR,EAAWC,GAC9B,MACMolB,EAAK,IAAIpkB,EAAAA,GAASjB,EAAGC,GAE3B,OAAIgjB,EAAAA,EAAAA,IAAyBoC,EAAIzmB,KAAK0lB,GAAI1lB,KAAK2lB,IAHnC,KAORtB,EAAAA,EAAAA,IAAyBoC,EAAIzmB,KAAK2lB,GAAI3lB,KAAKsT,IAPnC,EAqBd,CACOu+B,aACL7xC,KAAK2lB,GAAGvkB,EAAIpB,KAAK0lB,GAAGtkB,EACpBpB,KAAK2lB,GAAGtkB,EAAIrB,KAAKsT,GAAGjS,EAMpBrB,KAAKyxC,SAASrwC,EAAIpB,KAAK+wC,OAAOtB,UAAUruC,EACxCpB,KAAKyxC,SAASpwC,EAAIrB,KAAK+wC,OAAOnuC,IAAIvB,CACpC,CACOywC,6BAED5kC,EAAAA,EAAAA,IAAYlN,KAAKsT,GAAI,IAAIjR,EAAAA,GAASrC,KAAK+wC,OAAOgB,OAAQ/xC,KAAK+wC,OAAOiB,SAAWhyC,KAAK2H,IAEjF3H,KAAK+wC,OAAOptC,MAAMC,mBAAmB4H,wBAAwB8C,aAAakxB,QAC1Ex/B,KAAK0xC,eAEN1xC,KAAK+wC,OAAOptC,MAAMC,mBAAmBmG,GAAGC,wBAAwBqU,eAAe,CAC7Ere,KAAK+wC,OAAOvnC,WAEdxJ,KAAK0xC,cAAe,GAElB1xC,KAAK+wC,OAAOptC,MAAMC,mBAAmB4H,wBAAwB8C,aAAakxB,SAC5Ex/B,KAAK0xC,cAAe,GAI1B,CACWp+B,SACT,OAAOtT,KAAK4xC,GACd,CACWt+B,OAAGpQ,GACZlD,KAAK4xC,IAAM1uC,CACb,CAYO+uC,iBAAiBvuC,GACtB1D,KAAK0lB,GAAK1lB,KAAK+wC,OAAOtB,UACtBzvC,KAAKsT,GAAKtT,KAAK+wC,OAAOnuC,IAClB5C,KAAKmG,SACPnG,KAAKmG,QAAS,EACdnG,KAAKsT,IAAKvD,EAAAA,EAAAA,IAAS/P,KAAK6I,YAAY7I,KAAK6I,YAAY3H,OAAS,KAEhElB,KAAK6xC,aAKL7xC,KAAK+wC,OAAOptC,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM7R,KAAKutC,iBAC5DvuC,EACA1D,KAAK+wC,OAAO1tC,eACZrD,KAAK+wC,OAAOtB,UACZzvC,KAAKyxC,SACLzxC,KAAKsT,GACLtT,KAAKuK,EACLvK,KAAK2xC,WACL3xC,KAAK+wC,OAAOnrC,aACZ5F,KAAK+wC,OAAOhrC,iBAGd/F,KAAKuK,GAAK,EACZ,EClHK,MAAMoe,WAA6B6jB,GAGxC3sC,YAAYqyC,GACVhtC,MAAMgtC,GAAQ,KAHTjD,aAAO,OACNkD,uBAAwB,EAG9BnyC,KAAKivC,QAAUiD,CACjB,CACWpgB,iBACT,OAAO9xB,KAAKivC,QAAQlpC,eACtB,CACW+rB,eAAW5uB,GAEpBlD,KAAKivC,QAAQlpC,gBAAkB7C,EAC/BlD,KAAKivC,QAAQtrC,MAAMC,mBAAmBmG,GAAGC,wBAAwB2c,eAC/D3mB,KAAKivC,QAAQzlC,SAEjB,CACW4oC,2BACT,OAAOpyC,KAAKmyC,qBACd,CACWC,yBAAqBlvC,GAC9BlD,KAAKmyC,sBAAwBjvC,CAC/B,CACW0uB,cACT,OAAO5xB,KAAKivC,QAAQrpC,YACtB,CACWgsB,YAAQ1uB,GACblD,KAAKivC,QAAQtpC,WAAa3F,KAAKivC,QAAQjtC,cAAgBhC,KAAKivC,QAAQ5oC,gBAKxErG,KAAKivC,QAAQrpC,aAAe1C,EAExBlD,KAAKivC,QAAQ57B,aACfrT,KAAKivC,QAAQ57B,WAAWjJ,QAAUlH,IAIhClD,KAAKivC,QAAQrpC,eAAiB5F,KAAKivC,QAAQppC,aAInC7F,KAAKivC,QAAQrpC,cAAgB5F,KAAKivC,QAAQppC,aAHpD7F,KAAKivC,QAAQtrC,MAAMC,mBAAmBmG,GAAGC,wBAAwB4c,WAC/D5mB,KAAKivC,QAAQzlC,UAOjBxJ,KAAKivC,QAAQppC,WAAa7F,KAAKivC,QAAQrpC,aAKlC1C,IACHlD,KAAKivC,QAAQnoC,mBAAoB,EACjC9G,KAAKivC,QAAQriC,oBAEjB,CACOsG,0BAA0B5F,GAI/B,GAHAtN,KAAKivC,QAAQ8C,OAASzkC,EAAElM,EACxBpB,KAAKivC,QAAQ+C,OAAS1kC,EAAEjM,GAEnBrB,KAAKivC,QAAQjtC,cAAgBhC,KAAKivC,QAAQ5oC,cAC7C,OAEF,GAAIrG,KAAKivC,QAAQhoC,gBACf,OAEF,IAAKjH,KAAKivC,QAAQoD,WAChB,OAEF,GAAIryC,KAAKivC,QAAQ3mC,iBAEf,YADAtI,KAAKsyC,kCAAkChlC,GAKzC,MAAMif,EAAOjf,EAAElM,EAAIkM,EAAE6F,KACnBqZ,EAAOlf,EAAEjM,EAAIiM,EAAE8F,KAEjB,IAAIm/B,GAAa,EACjB,GAAIvyC,KAAKivC,QAAQ93B,cAuBf,GArBAnX,KAAKivC,QAAQ3rC,MAAQtD,KAAKivC,QAAQtpB,GAAGvkB,EAAIpB,KAAKivC,QAAQvpB,GAAGtkB,EAGrDpB,KAAKivC,QAAQ93B,aAAa5W,OAASswC,GAAwB2B,MACzDxyC,KAAKivC,QAAQ3rC,MAAQipB,EAAOvsB,KAAKivC,QAAQuB,SAAW,EACtDxwC,KAAKivC,QAAQvpB,GAAGtkB,GAAKmrB,EAErBvsB,KAAKivC,QAAQvpB,GAAGtkB,GAAK,EAEvBmxC,GAAa,GACJvyC,KAAKivC,QAAQ93B,aAAa5W,OAASswC,GAAwB4B,QAChEzyC,KAAKivC,QAAQ3rC,MAAQipB,EAAOvsB,KAAKivC,QAAQuB,SAAW,EACtDxwC,KAAKivC,QAAQtpB,GAAGvkB,GAAKmrB,EAErBvsB,KAAKivC,QAAQtpB,GAAGvkB,GAAK,EAEvBmxC,GAAa,GAKXvyC,KAAKivC,QAAQ93B,aAAa5W,OAASswC,GAAwBS,QAkC7D,OAhCItxC,KAAKivC,QAAQhlB,gBACXjqB,KAAKivC,QAAQhlB,cAAc3f,iBAC7BtK,KAAKivC,QAAQhlB,cAAc3f,oBAAiB3H,GAE9C3C,KAAKivC,QAAQhlB,mBAAgBtnB,GAI/B3C,KAAKivC,QAAQyD,oBAAoBplC,EAAElM,EAAGkM,EAAEjM,GACpCrB,KAAKivC,QAAQ57B,YAMXrT,KAAKivC,QAAQS,IAAIjzB,cACnBzc,KAAKivC,QAAQQ,UAAUruC,EACrBpB,KAAKivC,QAAQvpB,GAAGtkB,EAA8C,IAAzCpB,KAAKivC,QAAQtpB,GAAGvkB,EAAIpB,KAAKivC,QAAQvpB,GAAGtkB,GAC3DpB,KAAKivC,QAAQQ,UAAUpuC,EAAIrB,KAAKivC,QAAQtpB,GAAGtkB,EAC3CrB,KAAKivC,QAAQtiB,YAAc3sB,KAAKivC,QAAQQ,UAAUruC,EAAIpB,KAAKivC,QAAQrsC,IAAIxB,EACvEpB,KAAKivC,QAAQriB,aAAe5sB,KAAKivC,QAAQQ,UAAUpuC,EAAIrB,KAAKivC,QAAQrsC,IAAIvB,GAQ5ErB,KAAKivC,QAAQ/wB,wBAGble,KAAKivC,QAAQnhC,wBAIV,IAAI9N,KAAKivC,QAAQ0D,qBAetB,OAbA3yC,KAAK4yC,uBAAuBtlC,EAAElM,EAAGkM,EAAEjM,GACnCrB,KAAKivC,QAAQQ,UAAUruC,EAAIpB,KAAKivC,QAAQvpB,GAAGtkB,EAA8C,IAAzCpB,KAAKivC,QAAQtpB,GAAGvkB,EAAIpB,KAAKivC,QAAQvpB,GAAGtkB,GACpFpB,KAAKivC,QAAQQ,UAAUpuC,EAAIrB,KAAKivC,QAAQvpB,GAAGrkB,EAA8C,IAAzCrB,KAAKivC,QAAQtpB,GAAGtkB,EAAIrB,KAAKivC,QAAQvpB,GAAGrkB,GAEpFrB,KAAKivC,QAAQtiB,YAAc3sB,KAAKivC,QAAQQ,UAAUruC,EAAIpB,KAAKivC,QAAQrsC,IAAIxB,EACvEpB,KAAKivC,QAAQriB,aACX5sB,KAAKivC,QAAQQ,UAAUpuC,EAAIrB,KAAKivC,QAAQrsC,IAAIvB,EAA0B,GAAtBrB,KAAKivC,QAAQ1rC,OAC/DvD,KAAKivC,QAAQ/wB,mBAIble,KAAKivC,QAAQ4D,qBACb7yC,KAAKivC,QAAQnhC,oBAGb9N,KAAKivC,QAAQvpB,GAAGtkB,GAAKmrB,EACrBvsB,KAAKivC,QAAQvpB,GAAGrkB,GAAKmrB,EACrBxsB,KAAKivC,QAAQtpB,GAAGvkB,GAAKmrB,EACrBvsB,KAAKivC,QAAQtpB,GAAGtkB,GAAKmrB,CACvB,CAEI+lB,EACEvyC,KAAKivC,QAAQ57B,YAEfrT,KAAKivC,QAAQQ,UAAUruC,EACrBpB,KAAKivC,QAAQvpB,GAAGtkB,EAA8C,IAAzCpB,KAAKivC,QAAQtpB,GAAGvkB,EAAIpB,KAAKivC,QAAQvpB,GAAGtkB,GAC3DpB,KAAKivC,QAAQtiB,YAAc3sB,KAAKivC,QAAQQ,UAAUruC,EAAIpB,KAAKivC,QAAQrsC,IAAIxB,IAEvEpB,KAAKivC,QAAQrsC,IAAIxB,EAAIpB,KAAKivC,QAAQvpB,GAAGtkB,EAA8C,IAAzCpB,KAAKivC,QAAQtpB,GAAGvkB,EAAIpB,KAAKivC,QAAQvpB,GAAGtkB,GAC9EpB,KAAKivC,QAAQQ,UAAUruC,EACrBpB,KAAKivC,QAAQvpB,GAAGtkB,EAA8C,IAAzCpB,KAAKivC,QAAQtpB,GAAGvkB,EAAIpB,KAAKivC,QAAQvpB,GAAGtkB,GAG3DpB,KAAKivC,QAAQtiB,YAAc,EAC3B3sB,KAAKivC,QAAQriB,aAAe,GAG1B5sB,KAAKivC,QAAQ57B,YACfrT,KAAKivC,QAAQQ,UAAUruC,EACrBpB,KAAKivC,QAAQvpB,GAAGtkB,EAA8C,IAAzCpB,KAAKivC,QAAQtpB,GAAGvkB,EAAIpB,KAAKivC,QAAQvpB,GAAGtkB,GAC3DpB,KAAKivC,QAAQQ,UAAUpuC,EACrBrB,KAAKivC,QAAQvpB,GAAGrkB,EAA8C,IAAzCrB,KAAKivC,QAAQtpB,GAAGtkB,EAAIrB,KAAKivC,QAAQvpB,GAAGrkB,GAE3DrB,KAAKivC,QAAQtiB,YAAc3sB,KAAKivC,QAAQQ,UAAUruC,EAAIpB,KAAKivC,QAAQrsC,IAAIxB,EACvEpB,KAAKivC,QAAQriB,aACX5sB,KAAKivC,QAAQQ,UAAUpuC,EAAIrB,KAAKivC,QAAQrsC,IAAIvB,EAA0B,GAAtBrB,KAAKivC,QAAQ1rC,OAG/DvD,KAAKivC,QAAQ4D,kBAEb7yC,KAAKivC,QAAQrsC,IAAIxB,GAAKmrB,EACtBvsB,KAAKivC,QAAQrsC,IAAIvB,GAAKmrB,EACtBxsB,KAAKivC,QAAQQ,UAAUruC,GAAKpB,KAAKivC,QAAQrsC,IAAIxB,EAC7CpB,KAAKivC,QAAQQ,UAAUpuC,GAAKrB,KAAKivC,QAAQrsC,IAAIvB,EAC7CrB,KAAKivC,QAAQtiB,YAAc,EAC3B3sB,KAAKivC,QAAQriB,aAAe,EAC5B5sB,KAAKivC,QAAQ4D,iBAMjB7yC,KAAKivC,QAAQ/wB,mBAEble,KAAKivC,QAAQ6D,OAAOvD,YACpBvvC,KAAK+yC,kBACL/yC,KAAKgzC,oBACLhzC,KAAKivC,QAAQnhC,mBACf,CACQwkC,kCAAkChlC,GACxC,MAAMif,EAAOjf,EAAElM,EAAIkM,EAAE6F,KACfqZ,EAAOlf,EAAEjM,EAAIiM,EAAE8F,KACjBpT,KAAKivC,QAAQ57B,YASfrT,KAAKivC,QAAQQ,UAAUruC,GAAKmrB,EAC5BvsB,KAAKivC,QAAQQ,UAAUpuC,GAAKmrB,EAC5BxsB,KAAKivC,QAAQtiB,aAAeJ,EAC5BvsB,KAAKivC,QAAQriB,cAAgBJ,EAE7BxsB,KAAK+yC,oBAEL/yC,KAAKivC,QAAQtiB,YAAc,EAC3B3sB,KAAKivC,QAAQriB,aAAe,EAC5B5sB,KAAKivC,QAAQQ,UAAUruC,GAAKmrB,EAC5BvsB,KAAKivC,QAAQQ,UAAUpuC,GAAKmrB,EAC5BxsB,KAAKivC,QAAQrsC,IAAIxB,GAAKmrB,EACtBvsB,KAAKivC,QAAQrsC,IAAIvB,GAAKmrB,GAGxBxsB,KAAKivC,QAAQ4D,gBACb7yC,KAAKivC,QAAQnhC,mBAGf,CACO4C,eAAetP,EAAWC,GAE/B,GADArB,KAAKivC,QAAQtrC,MAAMq8B,YAAchgC,KAAKivC,QAClCjvC,KAAKivC,QAAQlsC,WAIf,OAHA/C,KAAKivC,QAAQjqC,UAAUxC,YAAa,EACpCxC,KAAKivC,QAAQlsC,YAAa,OAC1B/C,KAAKivC,QAAQ6D,OAAO7C,iBAIlBjwC,KAAKivC,QAAQmD,qBACfpyC,KAAKivC,QAAQgE,6BAA8B,EAE3CjzC,KAAKivC,QAAQgE,6BAA8B,EAGxCjzC,KAAKivC,QAAQgE,6BACZjzC,KAAKivC,QAAQiE,iBAAiB9xC,EAAGC,IAEnCrB,KAAKivC,QAAQ6D,OAAO7C,gBAM1B,CACOr/B,UAWL5Q,KAAKivC,QAAQkE,cACf,CACOplC,mBACL/N,KAAKivC,QAAQjkC,aAAehL,KAAKivC,QAAQjkC,WAE3C,CACO6H,cAAczR,EAAWC,GAE9B,OAAIrB,KAAKivC,QAAQ3mC,kBACX4E,EAAAA,EAAAA,IAAY,IAAI7K,EAAAA,GAASjB,EAAGC,GAAIrB,KAAK0B,IAAIkB,KAAO,IAClD5C,KAAKivC,QAAQ7kC,SAAU,GAChB,IAETpK,KAAKivC,QAAQ7kC,SAAU,GAChB,GAIPpK,KAAKivC,QAAQtrC,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAC7DC,oBAAoBC,OAASC,EAAAA,GAAAA,UAK9BjW,KAAKozC,wBAAwBhyC,EAAGC,IAKhCrB,KAAKqzC,mBAAmBjyC,EAAGC,IAJ7BrB,KAAKivC,QAAQmD,sBAAuB,EACpCpyC,KAAKivC,QAAQ7kC,SAAU,GAChB,IAQTpK,KAAKivC,QAAQmD,sBAAuB,GAEhCkB,EAAAA,EAAAA,IAAkB,IAAIjxC,EAAAA,GAASjB,EAAGC,GAAIrB,KAAKivC,QAAQvpB,GAAI1lB,KAAKivC,QAAQtpB,KACtE3lB,KAAKivC,QAAQ7kC,SAAU,GAChB,IAETpK,KAAKivC,QAAQ7kC,SAAU,GAChB,IACT,CACO8oC,iBAAiB9xC,EAAWC,GAEjC,GAAIrB,KAAKivC,QAAQ3mC,iBACf,OAAO,EAGT,MAAMtH,EAAK,CACT,IAAIqB,EAAAA,GACFrC,KAAKivC,QAAQvpB,GAAGtkB,EAAIpB,KAAKivC,QAAQsE,OACjCvzC,KAAKivC,QAAQvpB,GAAGrkB,EAAIrB,KAAKivC,QAAQsE,QAEnC,IAAIlxC,EAAAA,GACFrC,KAAKivC,QAAQvpB,GAAGtkB,EAAIpB,KAAKivC,QAAQ3rC,MAAQtD,KAAKivC,QAAQsE,OACtDvzC,KAAKivC,QAAQvpB,GAAGrkB,EAAIrB,KAAKivC,QAAQsE,QAEnC,IAAIlxC,EAAAA,GACFrC,KAAKivC,QAAQvpB,GAAGtkB,EAAIpB,KAAKivC,QAAQ3rC,MAAQtD,KAAKivC,QAAQsE,OACtDvzC,KAAKivC,QAAQvpB,GAAGrkB,EAAIrB,KAAKivC,QAAQ1rC,OAASvD,KAAKivC,QAAQsE,QAEzD,IAAIlxC,EAAAA,GACFrC,KAAKivC,QAAQvpB,GAAGtkB,EAAIpB,KAAKivC,QAAQsE,OACjCvzC,KAAKivC,QAAQvpB,GAAGrkB,EAAIrB,KAAKivC,QAAQ1rC,OAASvD,KAAKivC,QAAQsE,SAI3D,SAAI5pC,EAAAA,EAAAA,IAAe,IAAItH,EAAAA,GAASjB,EAAGC,EAAG,GAAIL,EAI5C,CACQ4xC,uBAAuBxxC,EAAWC,QACEsB,IAAtC3C,KAAKivC,QAAQ0D,uBAGjB3yC,KAAKivC,QAAQ0D,qBAAqBvxC,EAAIA,EACtCpB,KAAKivC,QAAQ0D,qBAAqBtxC,EAAIA,EAEtCrB,KAAKivC,QAAQ0D,qBAAqBvxC,EAAIA,EACtCpB,KAAKivC,QAAQ0D,qBAAqBtxC,EAAIA,EACxC,CACO+xC,wBAAwBhyC,EAAWC,GACxC,GAAIrB,KAAKivC,QAAQ57B,WAAY,CAC3B,GAAIrT,KAAKivC,QAAQ57B,WAAWR,cAAczR,EAAGC,GAG3C,OAFArB,KAAKivC,QAAQ0D,qBAAuB3yC,KAAKivC,QAAQ57B,WAAWC,GAC5DtT,KAAKivC,QAAQ57B,WAAWjJ,SAAU,GAC3B,EAETpK,KAAKivC,QAAQ57B,WAAWjJ,SAAU,CACpC,CAEA,OADApK,KAAKivC,QAAQ0D,0BAAuBhwC,GAC7B,CACT,CACOowC,kBACL/yC,KAAKivC,QAAQuE,MAAMvlB,UAAUjuB,KAAKivC,QAAQvpB,GAAGtkB,EAAGpB,KAAKivC,QAAQvpB,GAAGrkB,EAA0B,GAAtBrB,KAAKivC,QAAQ1rC,QACjFvD,KAAKivC,QAAQwE,OAAOxlB,UAAUjuB,KAAKivC,QAAQtpB,GAAGvkB,EAAGpB,KAAKivC,QAAQvpB,GAAGrkB,EAA0B,GAAtBrB,KAAKivC,QAAQ1rC,OACpF,CACOyvC,oBACLhzC,KAAKivC,QAAQS,IAAIzhB,UAAUjuB,KAAKivC,QAAQvpB,GAAGtkB,EAAyB,GAArBpB,KAAKivC,QAAQ3rC,MAAatD,KAAKivC,QAAQvpB,GAAGrkB,GACzFrB,KAAKivC,QAAQyE,MAAMzlB,UAAUjuB,KAAKivC,QAAQvpB,GAAGtkB,EAAyB,GAArBpB,KAAKivC,QAAQ3rC,MAAatD,KAAKivC,QAAQtpB,GAAGtkB,EAC7F,CACQgyC,mBAAmBjyC,EAAWC,GACpCrB,KAAKivC,QAAQ93B,kBAAexU,EAC5B,IAAK,IAAI1B,EAAI,EAAGA,EAAIjB,KAAKivC,QAAQruC,MAAMM,SAAUD,EAC/C,GAAIjB,KAAKivC,QAAQruC,MAAMK,GAAG4R,cAAczR,EAAGC,GAEzC,OADArB,KAAKivC,QAAQ93B,aAAenX,KAAKivC,QAAQruC,MAAMK,IACxC,EAGX,OAAO,CACT,CACOyxC,oBAAoBtxC,EAAWC,GAChCrB,KAAKivC,QAAQ57B,YASfrT,KAAKivC,QAAQrsC,IAAIxB,EAAIA,EACrBpB,KAAKivC,QAAQrsC,IAAIvB,EAAIA,EACrBrB,KAAKivC,QAAQtiB,YAAc3sB,KAAKivC,QAAQQ,UAAUruC,EAAIpB,KAAKivC,QAAQrsC,IAAIxB,EACvEpB,KAAKivC,QAAQriB,aAAe5sB,KAAKivC,QAAQQ,UAAUpuC,EAAIrB,KAAKivC,QAAQrsC,IAAIvB,GAOxErB,KAAKivC,QAAQ57B,WAAa,IAAIk+B,GAC5BvxC,KAAKivC,QACLjvC,KAAKivC,QAAQ0E,kBAAkBvyC,EAAGC,GAGxC,EC7aK,MAAM6nC,GAEXrpC,YAAYqyC,GAAiC,KADtCjD,aAAO,EAEZjvC,KAAKivC,QAAUiD,CACjB,CACO1oC,SACL,MAAMC,EAAI,IAAIpJ,EACZL,KAAKivC,QAAQ3uC,GACb8L,EAAAA,GAAAA,gBACApM,KAAKivC,QAAQlpC,gBACb/F,KAAKivC,QAAQrpC,aACb5F,KAAKivC,QAAQ5oC,eAEkB,IAA7BrG,KAAKivC,QAAQtiB,aAAmD,IAA9B3sB,KAAKivC,QAAQriB,aACjDnjB,EAAE1I,SAAS,CACTf,KAAKivC,QAAQrsC,IACb,IAAIP,EAAAA,GAASrC,KAAKivC,QAAQtiB,YAAa3sB,KAAKivC,QAAQriB,gBAGtDnjB,EAAE1I,SAAS,CAACf,KAAKivC,QAAQrsC,MAG3B6G,EAAE3I,KAAO,CAIPhB,QAASE,KAAKivC,QAAQ2E,gBACtBtwC,MAAOtD,KAAKivC,QAAQ3rC,MACpBC,OAAQvD,KAAKivC,QAAQ1rC,OACrBswC,QAAS,EACTC,KAAM9zC,KAAKivC,QAAQ9pC,SAAS4uC,WAE9B,MAAMlzC,EAASb,KAAKivC,QAAQ5rC,eAAeoQ,SAK3C,OAJI5S,IACF4I,EAAE5I,OAASA,GAGN4I,CACT,CACOqJ,SAiCL,MA/BE,UACA9S,KAAKivC,QAAQ3uC,GADb,WAIAN,KAAKivC,QAAQ1uC,KAAKwS,WAJlB,oBASA/S,KAAKivC,QAAQtnC,EATb,iBAeA3H,KAAKivC,QAAQxoC,gBAfb,YAkBAzG,KAAKivC,QAAQlpC,gBAlBb,YAqBA/F,KAAKivC,QAAQ5oC,cArBb,YAwBArG,KAAKivC,QAAQ9oC,OAxBb,gBA2BAnG,KAAKivC,QAAQjpC,aA3Bb,oBA8BAhG,KAAKivC,QAAQ57B,UAEjB,CACO2gC,iBAAiBlzC,GACtB,MAAMmzC,EAAIC,KAAKC,MAAMrzC,GACjBmzC,EAAEn0C,UACJE,KAAKivC,QAAQ2E,gBAAkBK,EAAEn0C,SAEnCE,KAAKivC,QAAQtrC,MAAMC,mBAAmBmG,GAAGC,wBAAwBoqC,YAAYp0C,KAAKwJ,SACpF,CACOuG,SAAS3O,EAAWC,GACzB,MAAMgP,EAAIrQ,KAAKwJ,SACf,GAAI6G,EAAG,CACL,MAAMqW,EAAK1mB,KAAKivC,QAAQ7+B,SAASC,GAAG,GAAM,GAI1C,OAHAqW,EAAGtZ,KAAKhM,EAAGC,GACXqlB,EAAGtc,SAAU,EACbsc,EAAG7V,eACI6V,CACT,CAEF,CACOjW,SAA+B,IAAxB5J,IAAQ,yDACpB,GACG7G,KAAKivC,QAAQtrC,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAC9DC,oBAAoBs+B,QAFzB,CASA,GAHIr0C,KAAKivC,QAAQhlB,gBACfjqB,KAAKivC,QAAQhlB,cAAc3f,oBAAiB3H,GAE1C3C,KAAKivC,QAAQgE,4BAMf,OALAjzC,KAAKivC,QAAQ57B,gBAAa1Q,EAC1B3C,KAAKivC,QAAQzuC,YAAa,OAC1BR,KAAKivC,QAAQtrC,MAAMC,mBAAmBmG,GAAGC,wBAAwBqU,eAAe,CAC9Ere,KAAKwJ,WAKT,IAAIxJ,KAAKivC,QAAQtrC,MAAMC,mBAAmB4H,wBAAwB8C,aAAayxB,cAA/E,CAMA,GAFA//B,KAAKivC,QAAQqF,YAETztC,EAAU,CACZ,MAAMuX,EAAQpe,KAAKwJ,SACf4U,IACFpe,KAAKivC,QAAQtrC,MAAMC,mBAAmBmG,GAAGC,wBAAwB6lC,cAAczxB,GAC/Epe,KAAKivC,QAAQtrC,MAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB,CACnFvG,IAGN,CACApe,KAAKivC,QAAQtrC,MAAM4wC,6BAA6Bv0C,KAAKivC,SACrDjvC,KAAKivC,QAAQtrC,MAAM8a,eAAeze,KAAKivC,QAdvC,CAfA,CA8BF,CACO3wB,wBACLte,KAAKivC,QAAQ57B,gBAAa1Q,EACtB3C,KAAKivC,QAAQhlB,gBACfjqB,KAAKivC,QAAQhlB,cAAc3f,oBAAiB3H,EAC5C3C,KAAKivC,QAAQhlB,mBAAgBtnB,GAG/B3C,KAAKw0C,iBACLx0C,KAAKivC,QAAQtrC,MAAMC,mBAAmBmG,GAAGC,wBAAwBqU,eAAe,CAC9Ere,KAAKwJ,UAET,CACOirC,mBACLz0C,KAAKivC,QAAQ57B,gBAAa1Q,EACtB3C,KAAKivC,QAAQhlB,gBACfjqB,KAAKivC,QAAQhlB,cAAc3f,oBAAiB3H,EAC5C3C,KAAKivC,QAAQhlB,mBAAgBtnB,GAG/B3C,KAAKw0C,iBACLx0C,KAAKivC,QAAQtrC,MAAMC,mBAAmBmG,GAAGC,wBAAwBqU,eAAe,CAC9Ere,KAAKwJ,UAET,CACO8qC,YACL,IACOt0C,KAAKivC,QAAQtrC,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,MAChFlM,KAAKivC,QAAQ6D,OAAO1D,SACtBpvC,KAAKivC,QAAQtrC,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAIa,YACnF/M,KAAKivC,QAAQ6D,OAAO1D,SAGpBpvC,KAAKivC,QAAQ6D,OAAO3D,eACtBnvC,KAAKivC,QAAQtrC,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAIa,YACnF/M,KAAKivC,QAAQ6D,OAAO3D,eAK1B,CADA,MAAOuF,GACP,CAEJ,CACQF,iBACNx0C,KAAKivC,QAAQtiB,YAAc,EAC3B3sB,KAAKivC,QAAQriB,aAAe,EAExB5sB,KAAKivC,QAAQS,IAAIjzB,cACnBzc,KAAKivC,QAAQQ,UAAUpuC,GAAKrB,KAAKivC,QAAQ1rC,QAG3CvD,KAAKivC,QAAQrsC,IAAIxB,EAAIpB,KAAKivC,QAAQQ,UAAUruC,EAC5CpB,KAAKivC,QAAQrsC,IAAIvB,EAAIrB,KAAKivC,QAAQQ,UAAUpuC,EAE5CrB,KAAKivC,QAAQtI,YACf,ECzLK,MAAMgO,GAEX90C,YAAYqyC,GAAiC,KADtCjD,aAAO,EAEZjvC,KAAKivC,QAAUiD,CACjB,CACOlkC,YACLhO,KAAKivC,QAAQ98B,wBACTnS,KAAKivC,QAAQroC,iBACf5G,KAAKivC,QAAQ6D,OAAOlD,cACpB5vC,KAAKivC,QAAQroC,gBAAiB,EAElC,CACOqH,WACAjO,KAAKivC,QAAQroC,iBAChB5G,KAAKivC,QAAQ6D,OAAOzD,cACpBrvC,KAAKivC,QAAQroC,gBAAiB,EAElC,ECfK,MAAM4O,WAA0BE,EAYrC7V,YAAYqyC,GACVhtC,MAAMgtC,GAAQ,KAZTjD,aAAO,OACP8E,UAAY,EAAE,KACda,eAAiB,EAAE,KACnBC,4BAAsB,OACtBC,YAAa,EAAM,KAElBC,aAAe,EAAE,KACjBC,aAAe,EAAE,KACjBC,cAAgB,EAAE,KAClBC,UAAsB,IAAI7yC,EAAAA,GAAS,EAAG,EAAG,GAI/CrC,KAAKivC,QAAUiD,CACjB,CACO1iC,WAAW9L,GAChB1D,KAAK+0C,aAAe,EACpB/0C,KAAKg1C,cAAgBh1C,KAAKivC,QAAQtpB,GAAGvkB,EAAIpB,KAAKivC,QAAQvpB,GAAGtkB,GAAKpB,KAAK+0C,aACnE/0C,KAAKi1C,cAAgB3iC,KAAKyS,IAAI/kB,KAAKivC,QAAQtpB,GAAGtkB,EAAIrB,KAAKivC,QAAQvpB,GAAGrkB,GAElErB,KAAKk1C,UAAU9zC,EAAIpB,KAAKivC,QAAQQ,UAAUruC,EAAwB,GAApBpB,KAAKg1C,aACnDh1C,KAAKk1C,UAAU7zC,EAAIrB,KAAKivC,QAAQS,IAAI9sC,IAAIvB,EAcpCrB,KAAKivC,QAAQ3mC,iBACftI,KAAKm1C,cAAczxC,EAAK1D,KAAKg1C,aAAch1C,KAAKi1C,gBAalDj1C,KAAKivC,QAAQtrC,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM7R,KAAK0wC,iCAC7D1xC,EACA1D,KAAKivC,QAAQ5rC,eACbrD,KAAKk1C,UACLl1C,KAAKg1C,aACLh1C,KAAKi1C,cACL,EACA,EACA,EACAj1C,KAAKivC,QAAQrpC,aACb5F,KAAKivC,QAAQlpC,iBAGX/F,KAAKivC,QAAQtrC,MAAMC,mBAAmB4lC,kBAAoBvzB,EAAAA,GAAAA,UACxDjW,KAAKivC,QAAQ7kC,SAAWpK,KAAKivC,QAAQzuC,aACvCR,KAAKypC,YAAY/lC,GAGvB,CACOyxC,cAAczxC,EAA+BJ,EAAeC,GAC7DvD,KAAKivC,QAAQ7kC,SACXpK,KAAKivC,QAAQ6D,OAAO1D,SAAWpvC,KAAKivC,QAAQ6D,OAAO1D,QAAQiG,SAC7Dr1C,KAAKivC,QAAQ6D,OAAO1D,QAAQiG,QAAS,GAEvCr1C,KAAK80C,YAAa,EACd90C,KAAKivC,QAAQ57B,aACfrT,KAAKivC,QAAQqG,qBACbt1C,KAAKivC,QAAQ57B,WAAW4+B,iBAAiBvuC,IAG3C1D,KAAKivC,QAAQtrC,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM7R,KAAK0wC,iCAC7D1xC,EACA1D,KAAKivC,QAAQ5rC,eACbrD,KAAKk1C,UACL5xC,EACAC,EACA,EACA,EACA,EACAvD,KAAKivC,QAAQrpC,aACb5F,KAAKivC,QAAQlpC,mBAGX/F,KAAKivC,QAAQ6D,OAAO1D,UAAYpvC,KAAKivC,QAAQ6D,OAAO1D,QAAQiG,SAC9Dr1C,KAAKivC,QAAQ6D,OAAO1D,QAAQiG,QAAS,GAEvCr1C,KAAK80C,YAAa,EAEtB,CACOS,eAAe7xC,GAChB1D,KAAKivC,QAAQ3mC,iBACftI,KAAKw1C,aAAa9xC,GAIhB1D,KAAKivC,QAAQ57B,aACfrT,KAAKivC,QAAQqG,qBACbt1C,KAAKivC,QAAQ57B,WAAW4+B,iBAAiBvuC,GAE7C,CACQ+lC,YAAY/lC,GAClB1D,KAAKivC,QAAQuE,MAAM/vC,OAAOC,GAC1B1D,KAAKivC,QAAQwE,OAAOhwC,OAAOC,GAC3B1D,KAAKivC,QAAQS,IAAIjsC,OAAOC,GACxB1D,KAAKivC,QAAQyE,MAAMjwC,OAAOC,EAC5B,CACQ8xC,aAAa9xC,GACnB,GAAI1D,KAAK80C,WACP,OAEF,MAAM5xC,EAAIlD,KAAKivC,QAAQrsC,IAGvBc,EAAIO,YACJP,EAAIe,IAAIvB,EAAE9B,EAAG8B,EAAE7B,EAAG,EAAG,EAAG,MACxBqC,EAAIS,YAEJ,IAAIsQ,EAAMzU,KAAKivC,QAAQ5rC,eAAeoyC,gBAAgBzxC,UACtDN,EAAIM,UAAS,eAAWyQ,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,KAC/D/Q,EAAIU,OAEJV,EAAImV,UAAY7Y,KAAKivC,QAAQ5rC,eAAeoyC,gBAAgB58B,UAC5DpE,EAAMzU,KAAKivC,QAAQ5rC,eAAeoyC,gBAAgBp1B,YAClD3c,EAAI2c,YAAW,eAAW5L,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,KACjE/Q,EAAI8c,QAkBN,ECpJF,MAAMk1B,GAAmB,cAAD,KACfC,SAAG,OACHC,SAAG,OACHtyC,MAAQ,GAAG,KACXC,OAAS,GAAG,KACZsB,MAAQ,EAAE,KACV4T,oBAAgC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC7CE,qBAAiC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC9CE,UAAY,EAAE,KAEdg9B,YAAc,sBAAsB,KACpCC,iBAAmB,sBAAsB,KACzCC,WAAa,CAAE,EAExB,MAAMC,GAAoB,cAAD,KAChB1yC,MAAQ,GAAG,KACXC,OAAS,GAAG,KACZ0yC,gBAAU,OACVC,SAAW,EAAE,KACbC,eAA2B,CAAC,EAAG,EAAG,EAAG,GAAG,KACxCR,SAAG,OACHC,SAAG,OACH/wC,MAAQ,EAAE,KACV4T,oBAAgC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC7CE,qBAAiC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC9CO,sBAAkC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC/CL,UAAY,EAAE,KAEdg9B,YAAc,sBAAsB,KACpCC,iBAAmB,sBAAsB,KACzCC,WAAa,CAAE,EAExB,MAAMK,GAAgB,cAAD,KACZT,SAAG,OACHC,SAAG,OACH/wC,MAAQ,EAAE,KACV4T,oBAAgC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC7CE,qBAAiC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC9CO,sBAAkC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC/CL,UAAY,CAAE,EAEvB,MAAMw9B,GAAY,cAAD,KACR59B,oBAAgC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC7CE,qBAAiC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC9CO,sBAAkC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC/CE,uBAAmC,CAAC,EAAG,EAAG,EAAG,GAAG,KAChDP,UAAY,EAAE,KACd40B,SAAqB,CAAC,EAAG,GAAG,KAC5B5oC,MAAQ,CAAE,EAEnB,MAAMyxC,GAAe,cAAD,KACXp9B,sBAAkC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC/CE,uBAAmC,CAAC,EAAG,EAAG,EAAG,GAAG,KAChDP,UAAY,CAAE,EAEvB,MAAM09B,GAAc,cAAD,KACV99B,oBAAgC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC7CE,qBAAiC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC9CO,sBAAkC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC/CE,uBAAmC,CAAC,EAAG,EAAG,EAAG,GAAG,KAChDP,UAAY,CAAE,EAsBhB,MAAM29B,GAAiB,cAAD,KACpBn2B,YAAwB,CAAC,EAAG,EAAG,EAAG,GAAK,KACvCxH,UAAY,EAAE,KACbqB,MAAkB,CAAC,EAAG,EAAG,CAE7BS,WACF,OAAO3a,KAAKka,KACd,CACIS,SAAKzX,GACPlD,KAAKka,MAAQhX,CACf,EAGK,MAAMuzC,GAAiB,cAAD,KACpBzyC,UAAsB,CAAC,EAAG,EAAG,EAAG,GAAK,KACrCqc,YAAwB,CAAC,EAAG,EAAG,EAAG,GAAK,KACvCxH,UAAY,EAAE,KACd3H,OAAS,EAAE,KACXyJ,KAAiB,CAAC,EAAG,EAAG,EAE1B,MAAM+7B,GAAiB,cAAD,KACpB1yC,UAAsB,CAAC,EAAG,EAAG,EAAG,GAAK,KACrCqc,YAAwB,CAAC,IAAK,IAAK,IAAK,GAAK,KAC7CxH,UAAY,EAAE,KACd8B,KAAiB,CAAC,EAAG,EAAG,EAE1B,MAAMg8B,GAAU,cAAD,KACb3yC,UAAsB,CAAC,GAAI,GAAI,GAAI,GAAK,KACxCqc,YAAwB,CAAC,EAAG,EAAG,EAAG,GAAK,KACvCxH,UAAY,EAAE,KACd8B,KAAiB,CAAC,EAAG,EAAG,EAEjC,MAAMi8B,GAAqB,cAAD,KACjBn+B,oBAAgC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC7CE,qBAAiC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC9CO,sBAAkC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC/C29B,WAA8B,IAAIH,GAAkB,KACpDI,IAAgB,IAAIH,GAAW,KAC/BI,WAA8B,IAAIN,GAAkB,KACpDpjC,WAA8B,IAAImjC,GAAkB,KACpD3xC,MAAQ,CAAE,EAInB,MAAMmyC,GAAW,cAAD,KACP9sC,KAAO,EAAE,KACT2O,UAAY,EAAE,KACd/B,QAAU,EAAE,KACZmgC,aAAe,CAAE,EAE1B,MAAMC,GAAyB,cAAD,KACrBzhB,aAAe,IAAI,KACnB0hB,iBAAmB,EAAE,KACrBC,uBAAmC,CAAC,EAAG,EAAG,EAAG,GAAG,KAChD1hB,4BAA8B,wBAAwB,KACtD2hB,UAAY,UAAU,KACtB/9B,UAAW,EAAM,KACjB1D,aAAO,OACPX,QAAU,GAAI,KACdqiC,aAAe,GAAI,KAEnBv+B,mBAAqB,GAAI,KACzBvE,gBAAkB,KAAM,KACxBO,gBAAkB,IAAM,EAEjC,MAAMwiC,GAAgB,cAAD,KACZ9+B,oBAAgC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC7CS,sBAAkC,CAAC,EAAG,EAAG,EAAG,EAAG,EAExD,MAAMs+B,GAAe,cAAD,KACX/+B,oBAAgC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC7CS,sBAAkC,CAAC,EAAG,EAAG,EAAG,GAAG,KAC/CL,UAAY,CAAE,EAEhB,MAAM4+B,GAiBX53C,cAAe,KAfR0Y,YAAM,OACN5I,YAAM,OACN+nC,YAAM,OAENn+B,WAAK,OACLP,cAAQ,OAERU,aAAO,OAEP81B,oBAAc,OAEdj7B,gBAAU,OACV2kB,eAAS,OACTrf,cAAQ,OACRrD,UAAI,EAETxW,KAAKuY,OAAS,IAAIm9B,GAClB11C,KAAK2P,OAAS,IAAIqmC,GAClBh2C,KAAK03C,OAAS,IAAItB,GAClBp2C,KAAKuZ,MAAQ,IAAI88B,GACjBr2C,KAAKgZ,SAAW,IAAIs9B,GACpBt2C,KAAK0Z,QAAU,IAAI68B,GACnBv2C,KAAKuU,WAAa,IAAI2iC,GACtBl3C,KAAKk5B,UAAY,IAAIqe,GACrBv3C,KAAK6Z,SAAW,IAAI29B,GACpBx3C,KAAKwW,KAAO,IAAIwgC,GAChBh3C,KAAKwvC,eAAiB,IAAIoH,EAG5B,CACOnjC,SACL,OAAOygC,KAAKC,MAAMD,KAAKyD,UAAU33C,MACnC,CACO43C,eAA6C,IAAhCC,EAAI,uDAAG,uBACZ,IAAIC,EAAAA,GAAa93C,KAAKyT,SAAUokC,GACxCvnC,OACP,EC9KK,MAAMwK,WAAci9B,EAAQ,cAAD,yBACzBC,UAA0B1gC,EAAa2gC,gBAAgB,KACvDlsC,gBAAgCuL,EAAayD,UAAW,EAE1D,MAAMG,WAAuBM,EAOlC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KAPNqV,WAAK,OACLrV,SAAG,OACHw2C,qBAAe,OACfC,qBAAe,OACf1C,qBAAe,OACf2C,cAAQ,EAGbp4C,KAAK+W,MAAQ,IAAI+D,GACjB9a,KAAKmO,aACP,CACOA,cACL,MAAMkK,EAAQrY,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAAa8/B,eACtExvC,KAAKo4C,WACRp4C,KAAKo4C,SAAW,IAAIzB,GACpB32C,KAAKo4C,SAASz9B,KAAO,CAAC,EAAG,GACzB3a,KAAKo4C,SAASp0C,UAAYqU,EAAMy+B,IAAI9yC,UACpChE,KAAKo4C,SAASv/B,UAAYR,EAAMy+B,IAAIj+B,UACpC7Y,KAAKo4C,SAAS/3B,YAAchI,EAAMy+B,IAAIz2B,aAEnCrgB,KAAKy1C,kBACRz1C,KAAKy1C,gBAAkB,IAAIgB,GAC3Bz2C,KAAKy1C,gBAAgB96B,KAAO,CAAC,EAAG,GAChC3a,KAAKy1C,gBAAgBzxC,UAAYqU,EAAM0+B,WAAW/yC,UAClDhE,KAAKy1C,gBAAgB58B,UAAYR,EAAM0+B,WAAWl+B,UAClD7Y,KAAKy1C,gBAAgBp1B,YAAchI,EAAM0+B,WAAW12B,aAEjDrgB,KAAKm4C,kBACRn4C,KAAKm4C,gBAAkB,IAAIzB,GAC3B12C,KAAKm4C,gBAAgBx9B,KAAO,CAAC,EAAG,GAChC3a,KAAKm4C,gBAAgBn0C,UAAYqU,EAAMw+B,WAAW7yC,UAClDhE,KAAKm4C,gBAAgBt/B,UAAYR,EAAMw+B,WAAWh+B,UAClD7Y,KAAKm4C,gBAAgB93B,YAAchI,EAAMw+B,WAAWx2B,aAEjDrgB,KAAKk4C,kBACRl4C,KAAKk4C,gBAAkB,IAAI1B,GAC3Bx2C,KAAKk4C,gBAAgBv9B,KAAO,CAAC,EAAG,GAChC3a,KAAKk4C,gBAAgBr/B,UAAYR,EAAMhF,WAAWwF,UAClD7Y,KAAKk4C,gBAAgB73B,YAAchI,EAAMhF,WAAWgN,YAExD,CAEOhS,kBAAkBzC,GACvB,IAAI/E,GAAW,EAwEf,YAvEkBlE,IAAdiJ,EAAMkrC,MACR92C,KAAKo4C,SAASz9B,KAAO/O,EAAMkrC,IAAIn8B,KAAO/O,EAAMkrC,IAAIn8B,KAAO3a,KAAKo4C,SAASz9B,KACrE3a,KAAKo4C,SAASp0C,UAAY4H,EAAMkrC,IAAI1yC,KAAOwH,EAAMkrC,IAAI1yC,KAAOpE,KAAKo4C,SAASp0C,UAC1EhE,KAAKo4C,SAASv/B,UAAYjN,EAAMkrC,IAAIxzC,MAAQsI,EAAMkrC,IAAIxzC,MAAQtD,KAAKo4C,SAASv/B,UAC5E7Y,KAAKo4C,SAAS/3B,YAAczU,EAAMkrC,IAAIz2B,YAClCzU,EAAMkrC,IAAIz2B,YACVrgB,KAAKo4C,SAAS/3B,YAClBxZ,GAAW,QAEYlE,IAArBiJ,EAAMmrC,aACR/2C,KAAKy1C,gBAAgB96B,KAAO/O,EAAMmrC,WAAWp8B,KACzC/O,EAAMmrC,WAAWp8B,KACjB3a,KAAKy1C,gBAAgB96B,KACzB3a,KAAKy1C,gBAAgBzxC,UAAY4H,EAAMmrC,WAAW3yC,KAC9CwH,EAAMmrC,WAAW3yC,KACjBpE,KAAKy1C,gBAAgBzxC,UACzBhE,KAAKy1C,gBAAgB58B,UAAYjN,EAAMmrC,WAAWzzC,MAC9CsI,EAAMmrC,WAAWzzC,MACjBtD,KAAKy1C,gBAAgB58B,UACzB7Y,KAAKy1C,gBAAgBp1B,YAAczU,EAAMmrC,WAAW12B,YAChDzU,EAAMmrC,WAAW12B,YACjBrgB,KAAKy1C,gBAAgBp1B,YACzBxZ,GAAW,QAEYlE,IAArBiJ,EAAMirC,aACR72C,KAAKm4C,gBAAgBx9B,KAAO/O,EAAMirC,WAAWl8B,KACzC/O,EAAMirC,WAAWl8B,KACjB3a,KAAKm4C,gBAAgBx9B,KACzB3a,KAAKm4C,gBAAgBn0C,UAAY4H,EAAMirC,WAAWzyC,KAC9CwH,EAAMirC,WAAWzyC,KACjBpE,KAAKm4C,gBAAgBn0C,UACzBhE,KAAKm4C,gBAAgBt/B,UAAYjN,EAAMirC,WAAWvzC,MAC9CsI,EAAMirC,WAAWvzC,MACjBtD,KAAKm4C,gBAAgBt/B,UACzB7Y,KAAKm4C,gBAAgB93B,YAAczU,EAAMirC,WAAWx2B,YAChDzU,EAAMirC,WAAWx2B,YACjBrgB,KAAKm4C,gBAAgB93B,YACzBxZ,GAAW,QAEYlE,IAArBiJ,EAAMyH,aACRrT,KAAKk4C,gBAAgBv9B,KAAO/O,EAAMyH,WAAWsH,KACzC/O,EAAMyH,WAAWsH,KACjB3a,KAAKk4C,gBAAgBv9B,KACzB3a,KAAKk4C,gBAAgBr/B,UAAYjN,EAAMyH,WAAW/P,MAC9CsI,EAAMyH,WAAW/P,MACjBtD,KAAKk4C,gBAAgBr/B,UACzB7Y,KAAKk4C,gBAAgB73B,YAAczU,EAAMyH,WAAWgN,YAChDzU,EAAMyH,WAAWgN,YACjBrgB,KAAKk4C,gBAAgB73B,YACzBxZ,GAAW,GAGb7G,KAAK+W,MAAMzT,MAAQsI,EAAMtI,OAAStD,KAAK+W,MAAMzT,MAC7CtD,KAAKqb,cAAgBzP,EAAM6N,WAAazZ,KAAKqb,cAC7Crb,KAAK+W,MAAMlS,MAAQ+G,EAAM/G,OAAS7E,KAAK+W,MAAMlS,WAErBlC,IAApBiJ,EAAMosC,YACRh4C,KAAK+W,MAAMihC,UAAYpsC,EAAMosC,gBAEDr1C,IAA1BiJ,EAAMG,kBACR/L,KAAK+W,MAAMhL,gBAAkBH,EAAMG,iBAEjCH,EAAM6hC,WACRztC,KAAK+W,MAAMiE,WAAapP,EAAM6hC,UAGhCztC,KAAKob,UAAW,EACZvU,IAAa7G,KAAK0B,IAAIyF,sBACxBnH,KAAK0B,IAAIiD,aAAc,IAGlB,CACT,CAEO8O,SACL,IAAKzT,KAAKob,SACR,OAIF,MAAMyQ,EAAc,CAClBirB,IAAK,CACHn8B,KAAM3a,KAAKo4C,SAASz9B,KACpBvW,KAAMpE,KAAKo4C,SAASp0C,UACpBV,MAAOtD,KAAKo4C,SAASv/B,UACrBwH,YAAargB,KAAKo4C,SAAS/3B,aAE7B02B,WAAY,CACVp8B,KAAM3a,KAAKy1C,gBAAgB96B,KAC3BvW,KAAMpE,KAAKy1C,gBAAgBzxC,UAC3BV,MAAOtD,KAAKy1C,gBAAgB58B,UAC5BwH,YAAargB,KAAKy1C,gBAAgBp1B,aAEpCw2B,WAAY,CACVl8B,KAAM3a,KAAKm4C,gBAAgBx9B,KAC3BvW,KAAMpE,KAAKm4C,gBAAgBn0C,UAC3BV,MAAOtD,KAAKm4C,gBAAgBt/B,UAC5BwH,YAAargB,KAAKm4C,gBAAgB93B,aAEpChN,WAAY,CACVsH,KAAM3a,KAAKk4C,gBAAgBv9B,KAC3BrX,MAAOtD,KAAKk4C,gBAAgBr/B,UAC5BwH,YAAargB,KAAKk4C,gBAAgB73B,aAEpC/c,MAAOtD,KAAK+W,MAAMzT,MAClBuB,MAAO7E,KAAK+W,MAAMlS,MAClB4U,UAAWzZ,KAAKqb,eAalB,OAVIrb,KAAK+W,MAAMhL,kBAAoBuL,EAAayD,aAC9C8Q,EAAO9f,gBAAkB/L,KAAK+W,MAAMhL,iBAElC/L,KAAK+W,MAAMihC,YAAc1gC,EAAa2gC,kBACxCpsB,EAAOmsB,UAAYh4C,KAAK+W,MAAMihC,WAG5Bh4C,KAAK+W,MAAMiE,aAAe3D,EAAW4D,aACvC4Q,EAAO4hB,SAAWztC,KAAK+W,MAAMiE,YAExB6Q,CACT,ECnMK,MAAMxnB,GAEXxE,YAAYyE,GAA+B,KADpCA,UAAI,EAETtE,KAAKsE,KAAOA,CACd,CACOd,OAAOE,GACP1D,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIC,aAG5DL,EAAI3D,KAAI,aACRC,KAAKsE,KAAKU,UAAUhD,cAAe,EAInChC,KAAKuE,WAAWb,GAKhB1D,KAAKq4C,cAAc30C,GACnB1D,KAAKs4C,aAAa50C,GAElB1D,KAAKu4C,mBAAmB70C,GACxB1D,KAAKw4C,kBAAkB90C,GACvB1D,KAAKsE,KAAKU,UAAUvB,OAAOC,GAC7B,CACO80C,kBAAkB90C,GACnB1D,KAAKsE,KAAK1B,MACZc,EAAIO,YACJP,EAAIe,IAAIzE,KAAKsE,KAAK1B,IAAIxB,EAAGpB,KAAKsE,KAAK1B,IAAIvB,EAAG,IAAK,EAAG,MAClDqC,EAAIS,YACJT,EAAIM,UAAY,UAChBN,EAAIU,OAER,CACOG,WAAWb,GAChB,MAAMc,EAAMxE,KAAKsE,KAAKqhB,GACtBjiB,EAAIO,YACJP,EAAIe,IAAID,EAAIpD,EAAGoD,EAAInD,EAAG,EAAG,EAAG,MAC5BqC,EAAIS,YACJT,EAAIM,UAAY,UAChBN,EAAIU,OACJ,IAAIM,EAAI,uBAAmB1E,KAAKsE,KAAKK,aACrCjB,EAAIkB,SAASF,EAAMF,EAAIpD,EAAI,GAAIoD,EAAInD,EAAI,IAEvCqD,EAAI,kBAAc1E,KAAKsE,KAAKa,SAAS4uC,WACrCrwC,EAAIkB,SAASF,EAAMF,EAAIpD,EAAI,IAAKoD,EAAInD,EAAI,GAC1C,CACOo3C,cAAc/0C,GACnB,MAAMc,EAAMxE,KAAKsE,KAAKo0C,UACtBh1C,EAAIO,YACJP,EAAIe,IAAID,EAAIpD,EAAGoD,EAAInD,EAAG,EAAG,EAAG,MAC5BqC,EAAIS,YACJT,EAAIM,UAAY,UAChBN,EAAIU,OACJ,MAAMu0C,EAAK,UAAMn0C,EAAIpD,GACfw3C,EAAK,UAAMp0C,EAAInD,GACrBqC,EAAIkB,SAAS+zC,EAAOn0C,EAAIpD,EAAGoD,EAAInD,EAAI,IACnCqC,EAAIkB,SAASg0C,EAAOp0C,EAAIpD,EAAGoD,EAAInD,EAAI,GACrC,CACOi3C,aAAa50C,GAClB,MAAMm1C,EAAO74C,KAAKsE,KAAKohB,GACvBhiB,EAAIO,YACJP,EAAIe,IAAIo0C,EAAKz3C,EAAGy3C,EAAKx3C,EAAG,EAAG,EAAG,MAC9BqC,EAAIS,YACJT,EAAIM,UAAY,UAChBN,EAAIU,OACJ,IAAIu0C,EAAK,UAAME,EAAKz3C,GAChBw3C,EAAK,UAAMC,EAAKx3C,GACpBqC,EAAIkB,SAAS+zC,EAAOE,EAAKz3C,EAAGy3C,EAAKx3C,EAAI,IACrCqC,EAAIkB,SAASg0C,EAAOC,EAAKz3C,EAAGy3C,EAAKx3C,EAAI,IAErC,MAAMy3C,EAAO94C,KAAKsE,KAAKqhB,GACvBjiB,EAAIO,YACJP,EAAIe,IAAIq0C,EAAK13C,EAAG03C,EAAKz3C,EAAG,EAAG,EAAG,MAC9BqC,EAAIS,YACJT,EAAIM,UAAY,UAChBN,EAAIU,OACJu0C,EAAK,UAAMG,EAAK13C,GAChBw3C,EAAK,UAAME,EAAKz3C,GAChBqC,EAAIkB,SAAS+zC,EAAOG,EAAK13C,EAAG03C,EAAKz3C,EAAI,IACrCqC,EAAIkB,SAASg0C,EAAOE,EAAK13C,EAAG03C,EAAKz3C,EAAI,GACvC,CACO03C,cAAcr1C,GACnB,MAAMc,EAAMxE,KAAKsE,KAAK1B,IACtBc,EAAIO,YACJP,EAAIe,IAAID,EAAIpD,EAAGoD,EAAInD,EAAG,IAAK,EAAG,MAC9BqC,EAAIS,YACJT,EAAIM,UAAY,UAChBN,EAAIU,OACJ,MAAMu0C,EAAK,UAAMn0C,EAAIpD,GACfw3C,EAAK,UAAMp0C,EAAInD,GACrBqC,EAAIkB,SAAS+zC,EAAOn0C,EAAIpD,EAAGoD,EAAInD,EAAI,IACnCqC,EAAIkB,SAASg0C,EAAOp0C,EAAIpD,EAAGoD,EAAInD,EAAI,GACrC,CACOg3C,cAAc30C,GACnB,MAAMc,EAAMxE,KAAKsE,KAAKmrC,UACtB/rC,EAAIO,YACJP,EAAIe,IAAID,EAAIpD,EAAGoD,EAAInD,EAAG,IAAK,EAAG,MAC9BqC,EAAIS,YACJT,EAAIM,UAAY,UAChBN,EAAIU,OACJ,MAAMu0C,EAAK,UAAMn0C,EAAIpD,GACfw3C,EAAK,UAAMp0C,EAAInD,GACrBqC,EAAIkB,SAAS+zC,EAAOn0C,EAAIpD,EAAGoD,EAAInD,EAAI,IACnCqC,EAAIkB,SAASg0C,EAAOp0C,EAAIpD,EAAGoD,EAAInD,EAAI,GACrC,CACOk3C,mBAAmB70C,GACxB,MAAMc,EAAMxE,KAAKsE,KAAKqhB,GACtBjiB,EAAIO,YACJP,EAAIe,IAAID,EAAIpD,EAAGoD,EAAInD,EAAG,IAAK,EAAG,MAC9BqC,EAAIS,YACJT,EAAIM,UAAY,UAChBN,EAAIU,OACJ,MAAMiP,EAAU,UAAMrT,KAAKsE,KAAK+O,YAEhC3P,EAAIkB,SAASyO,EAAY7O,EAAIpD,EAAGoD,EAAInD,EAAI,IAEpCrB,KAAKsE,KAAK2lB,cACZvmB,EAAIkB,SAAS5E,KAAKsE,KAAK2lB,cAAc1pB,KAAMiE,EAAIpD,EAAGoD,EAAInD,EAAI,IAE1DqC,EAAIkB,SAAS,OAAQJ,EAAIpD,EAAGoD,EAAInD,EAAI,GAExC,ECnGK,MAAM23C,WAA+B/zC,EAmD1C+W,wBAAwBrY,EAAc3C,GACpC,MACM0kB,EAAK1kB,EAAGA,EAAGE,OAAS,GACpBykB,EAAK3kB,EAAG,GACRi4C,EAAM,IAAID,GAAuBr1C,EAAO+hB,EAAGtkB,EAAGskB,EAAGrkB,EAAG,IAAK,GAHhD,OAIf43C,EAAIvG,oBAAoB/sB,EAAGvkB,EAAGukB,EAAGtkB,GACjC43C,EAAIvG,oBAAoB/sB,EAAGvkB,EAAGukB,EAAGtkB,GAE7B43C,EAAI5lC,WAKR4lC,EAAI7uC,SAAU,EAEd6uC,EAAI5zC,YAAY0tC,kBAChBkG,EAAI5zC,YAAY2tC,oBAChBiG,EAAInG,OAAOvD,WAKb,CACAvzB,gBAAgBrY,EAAc0M,GAAoD,IAArCtJ,EAAM,wDAAUuV,EAAU,wDAErE,MAAMY,EAAK,CAAC7M,EAAEzP,MAAM,GAAGV,GAAImQ,EAAEzP,MAAM,GAAGT,IAIhCywC,EAAcvgC,EAAEvP,KAAc,QAC9BwC,EAAQ+M,EAAEvP,KAAY,MAAIuP,EAAEvP,KAAY,MAAI,IAC5CyC,EAAS8M,EAAEvP,KAAa,OAAIuP,EAAEvP,KAAa,OAAI,GAI/Cm4C,EAAM,IAAID,GAAuBr1C,EAH7BuZ,EAAG,GACHA,EAAG,GAEuC5Z,EAAOC,EAAQwD,EAAQ6pC,GA0E3E,OAxEIvgC,EAAEzP,MAAM,IACVq4C,EAAIC,qBAAqB7oC,EAAEzP,MAAM,GAAGV,GAAImQ,EAAEzP,MAAM,GAAGT,IAGrD84C,EAAIrF,gBAAkBhD,EAElBvgC,EAAEvP,KAAW,MACfm4C,EAAIE,cAAc9oC,EAAEvP,KAAW,MASjCm4C,EAAI9xC,qBAAsB,EACtBkJ,EAAExP,QACJo4C,EAAI5qC,kBAAkBgC,EAAExP,QAE1Bo4C,EAAI9xC,qBAAsB,EAwBxB8xC,EAAI34C,GADFgc,EACO3Y,EAAMsF,UAENoH,EAAE/P,GAET24C,EAAInG,OAAO1D,UACb6J,EAAInG,OAAO1D,QAAQ9uC,GAAE,sBAAkB24C,EAAI34C,KAG7C24C,EAAI5yC,cAAgBgK,EAAE3P,SAClB2P,EAAE3P,SACJu4C,EAAI/xC,gBAAkB,EAEtB+xC,EAAI/xC,gBAAkB,EAIxB+xC,EAAI/6B,mBACJ+6B,EAAInG,OAAOvD,YACX0J,EAAItS,aAEA5/B,GACFpD,EAAMC,mBAAmBmG,GAAGC,wBAAwBgmC,cAAciJ,EAAIzvC,UAExEyvC,EAAIz4C,YAAa,EACjBy4C,EAAI7uC,SAAU,EACd6uC,EAAIt0C,aAAc,EAClBs0C,EAAInpC,kBACJmpC,EAAIG,mBAAmB71C,GAChB01C,CACT,CAEAj9B,sBAAsBrY,EAAc2J,GAClC,QAAsB3K,IAAlBgB,EAAMgP,QACR,OAEFhP,EAAMC,mBAAmB4H,wBAAwBgX,aACjD,MAAMjY,EAAI,IAAIyuC,GAAuBr1C,EAAO2J,EAAElM,EAAGkM,EAAEjM,GACnDkJ,EAAE/J,YAAa,EACfmD,EAAMmb,QAAUvU,EAChBA,EAAE+F,OACJ,CACA0L,iBAAiB1O,GACf,CAEF0O,aACE,CAEFnc,YACE8D,EACAvC,EACAC,GAKC,IAJDiC,EAAK,uDAAG,IACRC,EAAM,uDAAG,GACTwD,EAAM,wDAuFN,GApFA7B,MAAMvB,GAAO,KA1LRN,oBAAc,OACd8B,cAAQ,OACRE,iBAAW,OACX0E,QAAE,OACFsvC,gBAAU,OAEV1sB,YAAc,EAAE,KAChBC,aAAe,EAAE,KACjBtpB,WAAK,OACLktC,SAAW,GAAG,KACd+C,OAAS,GAAG,KACZ3wC,SAAG,OACH6sC,eAAS,OACTiJ,eAAS,OACThzB,QAAE,OACFC,QAAE,OAEF/kB,WAAK,OACL4yC,WAAK,OACLC,YAAM,OACN/D,SAAG,OACHgE,WAAK,OAELT,6BAA8B,EAAM,KAEpCZ,YAAa,EAAK,KAElBl7B,kBAAgDxU,EAAU,KAC1D0Q,gBAA8C1Q,EAAU,KACxDgwC,0BAA6ChwC,EAAU,KAEvDgtC,oBAAsB,GAAG,KACzB2J,kBAAoB,EAAE,KAEtBvH,OAAS,EAAE,KACXC,OAAS,EAAE,KAEXc,YAAM,OACNc,qBAAe,OAEf2F,eAAiB,EAAE,KAEnBtvB,mBAA2CtnB,EAAU,KAErDyF,eAAS,OAETE,kBAAmB,EAAM,KACxBkxC,aAAO,OACPC,gBAAU,EA2IhBz5C,KAAKoI,UAAY,IAAI/D,GAAUrE,MAE/BA,KAAK+G,OAASA,EACd/G,KAAKO,KAAO6L,EAAAA,GAAAA,gBAEZpM,KAAK4C,IAAM,IAAIP,EAAAA,GAASjB,EAAGC,GAC3BrB,KAAKyvC,UAAY,IAAIptC,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAGpB,KAAK4C,IAAIvB,GAEnDrB,KAAK0lB,GAAK,IAAIrjB,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAiB,GAAbpB,KAAKsD,MAAatD,KAAK4C,IAAIvB,EAAIrB,KAAKuD,QACxEvD,KAAK2lB,GAAK,IAAItjB,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAiB,GAAbpB,KAAKsD,MAAatD,KAAK4C,IAAIvB,GAQ/DrB,KAAK4c,gBACL5c,KAAKm5C,gBAELn5C,KAAKke,mBAELle,KAAK8yC,OAAS,IAAI9D,GAAkBhvC,MAChCA,KAAK8yC,OAAO1D,UACdpvC,KAAKy5C,WAAaz5C,KAAK8yC,OAAO1D,QAAQuB,cAExC3wC,KAAKsD,MAAQA,EACbtD,KAAKuD,OAASA,EAEdvD,KAAKwzC,MAAQ,IAAIpC,GACfpxC,KACAA,KAAK0lB,GAAGtkB,EACRpB,KAAK0lB,GAAGrkB,EAAkB,GAAdrB,KAAKuD,OACjBstC,GAAwB2B,MAE1BxyC,KAAKyzC,OAAS,IAAIrC,GAChBpxC,KACAA,KAAK2lB,GAAGvkB,EACRpB,KAAK0lB,GAAGrkB,EAAkB,GAAdrB,KAAKuD,OACjBstC,GAAwB4B,OAE1BzyC,KAAK0vC,IAAM,IAAI2B,GACbrxC,KACAA,KAAK0lB,GAAGtkB,EAAiB,GAAbpB,KAAKsD,MACjBtD,KAAK0lB,GAAGrkB,EACRwvC,GAAwBS,SAE1BtxC,KAAK0zC,MAAQ,IAAIrC,GACfrxC,KACAA,KAAK0lB,GAAGtkB,EAAiB,GAAbpB,KAAKsD,MACjBtD,KAAK0lB,GAAGrkB,EAAIrB,KAAKuD,OACjBstC,GAAwBS,SAE1BtxC,KAAKY,MAAQ,CAACZ,KAAKwzC,MAAOxzC,KAAKyzC,OAAQzzC,KAAK0vC,IAAK1vC,KAAK0zC,OAEtD1zC,KAAKqH,eAAiB,GACtBrH,KAAK8P,kBACL9P,KAAKoH,cAAe,EACpBpH,KAAK2G,QAAS,EACd3G,KAAKmG,QAAS,EACdnG,KAAK+F,iBAAkB,EACvB/F,KAAKoG,SAAU,EACfpG,KAAK4F,cAAe,EACpB5F,KAAK8F,UAAW,EAEhB9F,KAAKmH,qBAAsB,EAC3BnH,KAAKgF,UAAUnD,OAAS,EAKxB7B,KAAK2mC,aACL3mC,KAAK8N,oBAUL9N,KAAK2D,MAAM+1C,0BAA0B15C,OAChCA,KAAK+G,OAKR,OAJA/G,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiB9Q,KAAKwJ,UAC/ExJ,KAAK8yC,OAAOlD,cACZ5vC,KAAK8yC,OAAOzD,mBACZrvC,KAAK8yC,OAAO7C,gBAGhB,CACO0J,mCACL,IAAK,IAAI14C,EAAI,EAAGA,EAAIjB,KAAKY,MAAMM,SAAUD,EACnCjB,KAAKY,MAAMK,GAAGV,KAASswC,GAAwB4B,KAKvD,CACOI,gBACD7yC,KAAKqT,YACHrT,KAAKmF,SAASyvC,eAChB50C,KAAKyvC,UAAUruC,EAAIpB,KAAK4C,IAAIxB,EAAIpB,KAAK2sB,YACrC3sB,KAAKyvC,UAAUpuC,EAAIrB,KAAK4C,IAAIvB,EAAIrB,KAAK4sB,eAMvC5sB,KAAKyvC,UAAUruC,EAAIpB,KAAK4C,IAAIxB,EAC5BpB,KAAKyvC,UAAUpuC,EAAIrB,KAAK4C,IAAIvB,GAG9BrB,KAAK0lB,GAAGtkB,EAAIpB,KAAKyvC,UAAUruC,EAAiB,GAAbpB,KAAKsD,MACpCtD,KAAK0lB,GAAGrkB,EAAIrB,KAAKyvC,UAAUpuC,EAAIrB,KAAKuD,OACpCvD,KAAK2lB,GAAGvkB,EAAIpB,KAAKyvC,UAAUruC,EAAiB,GAAbpB,KAAKsD,MACpCtD,KAAK2lB,GAAGtkB,EAAIrB,KAAKyvC,UAAUpuC,EAC3BrB,KAAKqF,YAAY0tC,kBACjB/yC,KAAKqF,YAAY2tC,mBACnB,CACQp2B,gBACN5c,KAAK+J,GAAK,IAAIm/B,GAAYlpC,MAC1BA,KAAKq5C,WAAa,IAAI1E,GAAoB30C,MAC1CA,KAAKqF,YAAc,IAAIsjB,GAAqB3oB,MAC5CA,KAAKqD,eAAiB,IAAI6X,GAAelb,MACzCA,KAAKmF,SAAW,IAAIqQ,GAAkBxV,KACxC,CACOm5C,gBAA0B,IAAZjnC,EAAK,uDAAG,EAC3BlS,KAAKmF,SAAS4uC,UAAY7hC,CAC5B,CAEOzB,SAA+B,IAAxB5J,IAAQ,yDAEpB7G,KAAK+J,GAAG0G,OAAO5J,EACjB,CACOiJ,kBACL9P,KAAK6I,YAAc,GACnB7I,KAAK6I,YAAY1H,MACf4O,EAAAA,EAAAA,IAAS/P,KAAK04C,YACd3oC,EAAAA,EAAAA,IAAS/P,KAAK04C,YACd3oC,EAAAA,EAAAA,IAAS/P,KAAK04C,WAElB,CACOp6B,wBACLte,KAAK+J,GAAGuU,uBACV,CACO7T,mBACLzK,KAAK+J,GAAG0qC,kBACV,CACOH,YACLt0C,KAAK+J,GAAGuqC,WACV,CACOrhC,OAEP,CACOlD,SAAS3O,EAAWC,GAAmB,IAARC,EAAC,uDAAG,EACxC,OAAOtB,KAAK+J,GAAGgG,SAAS3O,EAAGC,EAAGC,EAChC,CAEO6Q,wBACL,CAEKnE,YACLhO,KAAKq5C,WAAWrrC,WAClB,CACOC,WACLjO,KAAKq5C,WAAWprC,UAClB,CACO6V,kBAEL,CAGKo1B,qBAAqB93C,EAAWC,GAIrCrB,KAAK2sB,YAAcvrB,EACnBpB,KAAK4sB,aAAevrB,EAGpBrB,KAAKqF,YAAYqtC,oBAAoBtxC,EAAGC,GACxCrB,KAAK2mC,YACP,CACOj2B,eAAetP,EAAWC,GAC/BrB,KAAKqF,YAAYqL,eAAetP,EAAGC,EACrC,CACO0M,mBACL/N,KAAKqF,YAAY0I,kBACnB,CACO6C,UAEL5Q,KAAKqF,YAAYuL,SACnB,CACOiC,cAAczR,EAAWC,GAC9B,OAAOrB,KAAKqF,YAAYwN,cAAczR,EAAGC,EAC3C,CACO6xC,iBAAiB9xC,EAAWC,GACjC,OAAOrB,KAAKqF,YAAY6tC,iBAAiB9xC,EAAGC,EAC9C,CACOkS,UAAUnS,EAAWC,GACrB,CAEA6R,0BAA0B5F,GAC/BtN,KAAKqF,YAAY6N,0BAA0B5F,EAC7C,CACOolC,oBAAoBtxC,EAAWC,GACpCrB,KAAKqF,YAAYqtC,oBAAoBtxC,EAAGC,EAC1C,CAEOmI,SACL,OAAOxJ,KAAK+J,GAAGP,QACjB,CACOsJ,SACL,OAAO9S,KAAK+J,GAAG+I,QACjB,CACOkhC,iBAAiBlzC,GACtBd,KAAK+J,GAAGiqC,iBAAiBlzC,EAC3B,CAEOkP,oBAGL,IAFAhQ,KAAK04C,UAAY14C,KAAKke,mBACtBle,KAAK6I,YAAY1H,MAAK4O,EAAAA,EAAAA,IAAS/P,KAAK04C,YAC7B14C,KAAK6I,YAAY3H,OAAS,GAC/BlB,KAAK6I,YAAYoH,OAErB,CAEO2pC,kBACL,CAEKp2C,SACL,CAEK+xC,eAAe7xC,GACpB1D,KAAKwD,SACLxD,KAAKmF,SAASowC,eAAe7xC,EAC/B,CAsBO8L,WAAW9L,GAChB1D,KAAKmF,SAASqK,WAAW9L,GACzB1D,KAAKoI,UAAU5E,OAAOE,EACxB,CAEO0F,UACL,MAAO,CAACpJ,KAAK4C,IAAK5C,KAAKyvC,UACzB,CACO9I,aACL3mC,KAAKmS,wBACLnS,KAAK6yC,gBACL7yC,KAAKqF,YAAY0tC,kBACjB/yC,KAAKqF,YAAY2tC,oBACjBhzC,KAAK8yC,OAAOvD,YACZvvC,KAAK8N,mBACP,CACO6lC,kBAAkBvyC,EAAWC,GAGlC,OAFW6L,EAAAA,EAAAA,IAAY,IAAI7K,EAAAA,GAASjB,EAAGC,GAAIrB,KAAK0vC,IAAI9sC,MACzCsK,EAAAA,EAAAA,IAAY,IAAI7K,EAAAA,GAASjB,EAAGC,GAAIrB,KAAK0zC,MAAM9wC,MAEpD5C,KAAK0vC,IAAIjzB,aAAc,EACvBzc,KAAK0zC,MAAMj3B,aAAc,EAClBzc,KAAK0vC,MAEd1vC,KAAK0vC,IAAIjzB,aAAc,EACvBzc,KAAK0zC,MAAMj3B,aAAc,EAClBzc,KAAK0zC,MACd,CACO4B,qBACL,GAAIt1C,KAAKqT,WAAY,EACRnG,EAAAA,EAAAA,IAAYlN,KAAKqT,WAAWsS,GAAI3lB,KAAK0vC,IAAI9sC,MACzCsK,EAAAA,EAAAA,IAAYlN,KAAKqT,WAAWsS,GAAI3lB,KAAK0zC,MAAM9wC,MAEpD5C,KAAK0vC,IAAIjzB,aAAc,EACvBzc,KAAK0zC,MAAMj3B,aAAc,EAIzBzc,KAAKqT,WAAWqS,GAAGtkB,EAAIpB,KAAK0vC,IAAI9sC,IAAIxB,EACpCpB,KAAKqT,WAAWqS,GAAGrkB,EAAIrB,KAAK0vC,IAAI9sC,IAAIvB,EACpCrB,KAAKqT,WAAWqS,GAAGpkB,EAAItB,KAAK0vC,IAAI9sC,IAAItB,IAEpCtB,KAAK0vC,IAAIjzB,aAAc,EACvBzc,KAAK0zC,MAAMj3B,aAAc,EAIzBzc,KAAKqT,WAAWqS,GAAGtkB,EAAIpB,KAAK0zC,MAAM9wC,IAAIxB,EACtCpB,KAAKqT,WAAWqS,GAAGrkB,EAAIrB,KAAK0zC,MAAM9wC,IAAIvB,EACtCrB,KAAKqT,WAAWqS,GAAGpkB,EAAItB,KAAK0zC,MAAM9wC,IAAItB,EAE1C,CACF,CACO4c,mBAEL,OADAle,KAAK04C,WAAYryB,EAAAA,EAAAA,IAAqBrmB,KAAK2M,WACpC3M,KAAK04C,SACd,CACO/rC,UACL,MAAO,CAAC3M,KAAK0lB,GAAI1lB,KAAK2lB,GAAI3lB,KAAK4C,IACjC,CACOwM,eACDpP,KAAK6I,YAAY3H,OAAS,IAK3BlB,KAAK04C,UAAW14C,KAAK2D,MAAMC,mBAAmB4H,wBAAwBquC,mBAEvE75C,KAAKiL,QAAS,GAIdjL,KAAKiL,QAAS,EACdjL,KAAK2E,aAAc,GAEvB,CAEOwuC,eAGL,MAAM9mC,EAAIrM,KAAK2D,MAAMC,mBAAmBuS,eAAe2M,eAAeg3B,0BACpE95C,KAAK4C,IAAIxB,EACTpB,KAAK4C,IAAIvB,EACT,IAIF,GAAIgL,GACF,GAAIrM,KAAKqT,WAAY,CACfrT,KAAKiqB,gBACPjqB,KAAKiqB,cAAc3f,oBAAiB3H,EACpC3C,KAAKiqB,mBAAgBtnB,GAGvB0J,EAAE/B,eAAiBtK,KAEnB,MAAMkD,EAAImJ,EAAEc,oBACRjK,IACFlD,KAAK4C,IAAIxB,EAAIpB,KAAKqT,WAAWC,GAAGlS,EAAI8B,EAAE9B,EACtCpB,KAAK4C,IAAIvB,EAAIrB,KAAKqT,WAAWC,GAAGjS,EAAI6B,EAAE7B,EACtCrB,KAAK4C,IAAItB,EAAItB,KAAKqT,WAAWC,GAAGhS,EAAI4B,EAAE5B,EACtCtB,KAAKiqB,cAAgB5d,EAYzB,OAGIrM,KAAKiqB,gBACPjqB,KAAKiqB,cAAc3f,oBAAiB3H,EACpC3C,KAAKiqB,mBAAgBtnB,EAI3B,CACOo3C,0BAEL,MAAM1tC,EAEUrM,KAAK2D,MAAMC,mBAAmBuS,eAAe2M,eAAeg3B,0BAC1E95C,KAAK4C,IAAIxB,EACTpB,KAAK4C,IAAIvB,EACT,IAGF,QAAUsB,IAAN0J,EAAiB,CACnBA,EAAE/B,eAAiBtK,KAEnB,MAAMkD,EAAImJ,EAAEc,oBAERjK,IACFlD,KAAK4C,IAAIxB,EAAI8B,EAAE9B,EACfpB,KAAK4C,IAAIvB,EAAI6B,EAAE7B,EACfrB,KAAK4C,IAAItB,EAAI4B,EAAE5B,EACftB,KAAKiqB,cAAgB5d,EACrBrM,KAAK2E,aAAc,EAKvB,CAEF,CASWnE,iBACT,OAAOR,KAAKqF,YAAYysB,UAC1B,CACWtxB,eAAW0C,GACpBlD,KAAKqF,YAAYysB,WAAa5uB,CAChC,CACWkvC,2BACT,OAAOpyC,KAAKqF,YAAY+sC,oBAC1B,CACWA,yBAAqBlvC,GAC9BlD,KAAKqF,YAAY+sC,qBAAuBlvC,CAC1C,CACWkH,cACT,OAAOpK,KAAKqF,YAAYusB,OAC1B,CACWxnB,YAAQlH,GACjBlD,KAAKqF,YAAYusB,QAAU1uB,CAC7B,CACWK,aACT,OAAOvD,KAAKw5C,OACd,CACWj2C,WAAOL,GAChB,GAAU,IAANA,EACF,QAEGlD,KAAKmF,SAAS2vC,YAAc90C,KAAK+C,aACpCG,GAAK,IAEPlD,KAAKw5C,QAAUt2C,EACf,MAAM82C,EAAM92C,EAAmC,EAA/BlD,KAAK8yC,OAAO5D,iBAC5BlvC,KAAKw5C,QAAUQ,EACfh6C,KAAK0lB,GAAGrkB,EAAIrB,KAAK2lB,GAAGtkB,EAAI24C,CAC1B,CACOZ,mBAAmBl2C,GAExB,MAAM82C,GADN92C,GAAK,IAC0C,EAA/BlD,KAAK8yC,OAAO5D,iBAC5BlvC,KAAKw5C,QAAUQ,EACfh6C,KAAK0lB,GAAGrkB,EAAIrB,KAAK2lB,GAAGtkB,EAAI24C,EACxBh6C,KAAKwD,SACLxD,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAaoxB,sBAAuB,CAC5F,CACOua,kBACDj6C,KAAK8yC,OAAO1D,SAAWpvC,KAAKy5C,aAAez5C,KAAK8yC,OAAO1D,QAAQuB,eACjE3wC,KAAKy5C,WAAaz5C,KAAK8yC,OAAO1D,QAAQuB,aACtC3wC,KAAKuD,OAASvD,KAAK8yC,OAAO1D,QAAQuB,aAElC3wC,KAAKqF,YAAY0tC,kBACjB/yC,KAAKqF,YAAY2tC,oBACjBhzC,KAAK8yC,OAAOvD,YAEhB,CASOzhC,oBACL,MACMxK,EADQ,GACCtD,KAAK2lB,GAAGvkB,EAAIpB,KAAK0lB,GAAGtkB,GAC7BmC,EAAS+O,KAAKyS,IAAI/kB,KAAK2lB,GAAGtkB,EAAIrB,KAAK0lB,GAAGrkB,GAC5CrB,KAAKgF,UAAU/B,OAAS,IAAIZ,EAAAA,GAASrC,KAAKyvC,UAAUruC,EAAY,GAARkC,EAAatD,KAAKyvC,UAAUpuC,EAAIkC,GACxFvD,KAAKgF,UAAU7B,OAAS,IAAId,EAAAA,GAASrC,KAAKyvC,UAAUruC,EAAY,GAARkC,EAAatD,KAAKyvC,UAAUpuC,EAEtF,CACW0B,eAAWG,GAChBA,GACFlD,KAAKsI,kBAAmB,EACpBtI,KAAK8yC,OAAO1D,UAAYpvC,KAAK8yC,OAAO1D,QAAQiG,SAC9Cr1C,KAAK8yC,OAAO1D,QAAQiG,QAAS,KAG/Br1C,KAAKsI,kBAAmB,EACpBtI,KAAK8yC,OAAO1D,SAAWpvC,KAAK8yC,OAAO1D,QAAQiG,SAC7Cr1C,KAAK8yC,OAAO1D,QAAQiG,QAAS,GAGnC,CACWtyC,iBACT,OAAO/C,KAAKsI,gBACd,CACO8H,SAASC,GAAsE,IAAvDtJ,EAAe,wDAAUuV,EAAmB,wDAEzE,MAAMY,EAAK,CAAC7M,EAAEzP,MAAM,GAAGV,GAAImQ,EAAEzP,MAAM,GAAGT,IAIhCywC,EAAcvgC,EAAEvP,KAAc,QAC9BwC,EAAQ+M,EAAEvP,KAAY,MAAIuP,EAAEvP,KAAY,MAAI,IAC5CyC,EAAS8M,EAAEvP,KAAa,OAAIuP,EAAEvP,KAAa,OAAI,GAC/CM,EAAI8b,EAAG,GACP7b,EAAI6b,EAAG,GAEP+7B,EAAM,IAAID,GAAuBh5C,KAAK2D,MAAOvC,EAAGC,EAAGiC,EAAOC,EAAQwD,EAAQ6pC,GA0EhF,OAxEIvgC,EAAEzP,MAAM,IACVq4C,EAAIC,qBAAqB7oC,EAAEzP,MAAM,GAAGV,GAAImQ,EAAEzP,MAAM,GAAGT,IAGrD84C,EAAIrF,gBAAkBhD,EAElBvgC,EAAEvP,KAAW,MACfm4C,EAAIE,cAAc9oC,EAAEvP,KAAW,MASjCm4C,EAAI9xC,qBAAsB,EACtBkJ,EAAExP,QACJo4C,EAAI5qC,kBAAkBgC,EAAExP,QAE1Bo4C,EAAI9xC,qBAAsB,EAwBxB8xC,EAAI34C,GADFgc,EACOtc,KAAK2D,MAAMsF,UAEXoH,EAAE/P,GAET24C,EAAInG,OAAO1D,UACb6J,EAAInG,OAAO1D,QAAQ9uC,GAAE,sBAAkB24C,EAAI34C,KAG7C24C,EAAI5yC,cAAgBgK,EAAE3P,SAClB2P,EAAE3P,SACJu4C,EAAI/xC,gBAAkB,EAEtB+xC,EAAI/xC,gBAAkB,EAIxB+xC,EAAI/6B,mBACJ+6B,EAAInG,OAAOvD,YACX0J,EAAItS,aAEA5/B,GACF/G,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBgmC,cAAciJ,EAAIzvC,UAE7EyvC,EAAIz4C,YAAa,EACjBy4C,EAAI7uC,SAAU,EACd6uC,EAAIt0C,aAAc,EAClBs0C,EAAInpC,kBACJmpC,EAAIG,mBAAmB71C,GAChB01C,CACT,EChyBK,MAAMzjC,WAA0BE,EAErC7V,YAAYyE,GACVY,MAAMZ,GAAM,KAFPA,UAAI,EAGTtE,KAAKsE,KAAOA,CACd,CACOkL,WAAW9L,GAChB1D,KAAKyV,MAAMjS,SAEPxD,KAAKsE,KAAKob,KAAKxe,OAAS,IAEjBlB,KAAKsE,KAAK41C,kBACnBl6C,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM4jC,SAASC,eAC9D12C,EACA1D,KAAKsE,KAAKob,KACV1f,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB+f,sBAAsBC,YACjFxrB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASqwB,aAAa/lB,cAAcC,aAAamK,SAAShB,UAAY7Y,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WACjM3O,KAAKsE,KAAK0e,UAGZhjB,KAAKsE,KAAKmM,SAEd,ECrBK,MAAMyK,WAAuBM,EAElC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KAFNA,SAAG,EAGR1B,KAAKmO,cACLnO,KAAK0B,IAAI2B,eAAeqH,aAC1B,CACOyD,cACLgK,EAAYkiC,oBACVr6C,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElDyI,EAAYkiC,oBACVr6C,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAEpD,ECOK,MAAM4qC,WAA8Br1C,EAkCzC,qBAC6CtC,IAAvC23C,GAAsBj4B,cACxBi4B,GAAsBj4B,aAAa5R,SAErC6pC,GAAsBj4B,kBAAe1f,CACvC,CAEA,iBAAwBgB,EAAc2J,GACpC3J,EAAMC,mBAAmBuS,eAAe+X,cAAcC,qBACtDmsB,GAAsB1hB,qBAAsB,CAC9C,CACA,iBAAwBtrB,GACtBgtC,GAAsB1hB,qBAAsB,EACxC0hB,GAAsBj4B,cACxBi4B,GAAsBj4B,aAAasW,QAAQrrB,EAAElM,EAAGkM,EAAEjM,EAEtD,CACA,eAAsBsC,EAAc2J,GAClC,QAA2C3K,IAAvC23C,GAAsBj4B,aAA4B,CACpD,GAAIi4B,GAAsBj4B,aAAa3C,KAAKxe,OAAS,EACnD,OAGFo5C,GAAsBj4B,aAAak4B,gBACnCD,GAAsBj4B,aAAa63B,mBAAoB,EACvDI,GAAsBj4B,kBAAe1f,EACrCgB,EAAMC,mBAAmB4H,wBAAwBgX,YACnD,CACF,CACA,iBACE7e,EACA2J,EACA/M,GAEC,IADDi6C,EAAsB,uDAAGC,EAAAA,GAAAA,KAEzB,QAA2C93C,IAAvC23C,GAAsBj4B,aAA4B,MAEvC1f,IADAgB,EAAMC,mBAAmBuS,eAAe2M,eAAeb,YAAY3U,KAE9EgtC,GAAsBj4B,aAAe,IAAIi4B,GAAsB32C,EAAOpD,EAAMi6C,GAEhF,CACAF,GAAsB7hB,WAAW,GAAKnrB,EAAElM,EACxCk5C,GAAsB7hB,WAAW,GAAKnrB,EAAEjM,CAC1C,CACAxB,YAAY8D,EAAcpD,GAA0D,IAA5Ci6C,EAAsB,uDAAGC,EAAAA,GAAAA,KAC/Dv1C,MAAMvB,GAAO,KA9DR+b,KAAmB,GAAG,KACtB86B,eAAS,OACTj6C,UAAI,OACJogC,eAAS,OACT+Z,kBAAY,OACZ1iB,eAAS,OACTkiB,uBAAiB,OACjBl3B,cAAQ,OACRvO,SAAG,EAuDRzU,KAAKw6C,UAAYA,EACjBx6C,KAAK06C,aAAen6C,EACpBP,KAAKg4B,UAAY,EACjBh4B,KAAKk6C,mBAAoB,EACzBl6C,KAAKgjB,SAAWs3B,GAAsBK,QACtC36C,KAAK2gC,UAAYia,EAAAA,EAAAA,eACjB,MAAMnmC,EAAMzU,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAAamK,SAClEX,sBACHlZ,KAAKyU,IAAG,eAAWA,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,UAC/CzU,KAAK4c,gBACL09B,GAAsBj4B,aAAeriB,KAErCA,KAAK8R,MACP,CACQ8K,gBACN5c,KAAKqD,eAAiB,IAAI6X,GAAelb,MACzCA,KAAKmF,SAAW,IAAIqQ,GAAkBxV,KACxC,CACQ8R,OACN9R,KAAK2D,MAAMk3C,yBAAyB76C,KACtC,CACO24B,QAAQv3B,EAAWC,GACxBrB,KAAK0f,KAAKve,KAAK,IAAIkB,EAAAA,GAASjB,EAAGC,GACjC,CACQy5C,gBAAgB95C,GACtB,MAAM0e,EAAmB,GAEzBA,EAAKve,KAAKH,EAAG,IACb,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAGE,OAFV,IAE2BD,EAAG,CACzC,IAAIiC,GAAI2iB,EAAAA,EAAAA,IAAI7kB,EAAGC,GAAID,EAAGC,EAAI,IAC1BiC,GAAI0iB,EAAAA,EAAAA,IAAU1iB,GACd,IAAI63C,GAAKl1B,EAAAA,EAAAA,IAAI7kB,EAAGC,GAAID,EAAGC,EAAI,IAC3B85C,GAAKn1B,EAAAA,EAAAA,IAAUm1B,GACf,MAAMC,GAAMn1B,EAAAA,EAAAA,IAAI7kB,EAAGC,GAAID,EAAGC,EAAI,IAC9B85C,GAAKn1B,EAAAA,EAAAA,IAAUo1B,GACf,IAAIC,GAAOp1B,EAAAA,EAAAA,IAAI7kB,EAAGC,GAAID,EAAGC,EAAI,IAC7Bg6C,GAAOr1B,EAAAA,EAAAA,IAAUq1B,GACjB,IAAIC,GAAQr1B,EAAAA,EAAAA,IAAI7kB,EAAGC,GAAID,EAAGC,EAAI,IAC9Bi6C,GAAQt1B,EAAAA,EAAAA,IAAUs1B,GAElB,MAAMC,GAAKC,EAAAA,EAAAA,IAAcl4C,EAAG63C,GACtBM,GAAKD,EAAAA,EAAAA,IAAcl4C,EAAG83C,GACtBM,GAAKF,EAAAA,EAAAA,IAAcl4C,EAAG83C,IAGxBhsC,MAAMmsC,IAAOnsC,MAAMqsC,IAAOrsC,MAAMssC,KAElC57B,EAAKve,KAAKH,EAAGC,GAEjB,CAEA,OADAye,EAAKve,KAAKH,EAAGA,EAAGE,OAAS,IAClBwe,CACT,CACQ67B,QAAQv6C,GACd,IAAI0e,EAAmB,GAEvB,OADAA,EAAO1e,EACA0e,CACT,CACQ87B,UAAUt4C,GAChB,IAAIjC,EAAIiC,EAAEhC,OACV,KAAOD,KAAK,CACA,IAAI8a,EAAO/b,KAAK2D,MAAOT,EAAEjC,GAAGG,EAAG8B,EAAEjC,GAAGI,GAC5CiP,OACJ,CACF,CACAmrC,sBACE,IAAIz6C,EAAKhB,KAAK0f,KAmBd,GAjBA1f,KAAK07C,kBAAkB16C,GAEnBhB,KAAKw6C,UAAcC,EAAAA,GAAAA,aAenBz6C,KAAK06C,eAAiBiB,EAAAA,GAAAA,aACxB36C,EAAKhB,KAAK86C,gBAAgB95C,GAE1BA,EAAKhB,KAAKu7C,QAAQv6C,GAClBhB,KAAKw7C,UAAUx6C,OACV,CACDhB,KAAK2gC,UAAcia,EAAAA,EAAAA,eAIvB,MAAMgB,GAAUC,EAAAA,EAAAA,IAA6B76C,GAU7C,IAJIkM,EAAAA,EAAAA,IAAYlM,EAAG,GAAIA,EAAGA,EAAGE,OAAS,IAAM,KAC1CF,EAAGg0B,MACH4mB,EAAQ5mB,OAENh0B,EAAGE,OAAS,EACd,OAGF,GAAI,EAAIF,EAAGE,QAAUF,EAAGE,OAAS,MAAO46C,EAAAA,EAAAA,IAAwBF,GAE9D,YADA/W,GAAQK,gBAAgBllC,KAAK2D,MAAO3C,GAGtC,GAAI,EAAIA,EAAGE,QAAUF,EAAGE,OAAS,EAE/B,YADAuuB,EAAkB5B,cAAc7tB,KAAK2D,MAAO3C,GAI9CmmB,EAAgBgP,iBAAiBn2B,KAAK2D,MAAO3C,GAI7ChB,KAAKyQ,QAKP,CACF,CACQirC,kBAAkB16C,GACxB,MACM+6C,EAAmB/6C,EAEzB,IAAIg7C,GAAWC,EAAAA,EAAAA,IAAmBF,GAClCC,GAAWE,EAAAA,EAAAA,IAAqBF,EAJjB,KAKfA,EAAS76C,KAA+B,GAA1B46C,EAAiB76C,QAC/Bo5C,GAAsB6B,yBAAyBh7C,KAAK66C,GAEpD,IAAII,EAAS,GACb,IAAK,IAAIn7C,EAAI,EAAGA,EAAI86C,EAAiB76C,SAAUD,EAC7Cm7C,EAAOj7C,KAAK46C,EAAiB96C,GAAGG,EAAG26C,EAAiB96C,GAAGI,GAEzDi5C,GAAsB+B,4BAA4Bl7C,KAAKi7C,GAEvDJ,GAAWC,EAAAA,EAAAA,IAAmBj7C,GAC9Bg7C,GAAWE,EAAAA,EAAAA,IAAqBF,EAfjB,KAgBfA,EAAS76C,KAA+B,GAA1B46C,EAAiB76C,QAC/Bo5C,GAAsBgC,uBAAuBn7C,KAAK66C,GAElDI,EAAS,GACT,IAAK,IAAIn7C,EAAI,EAAGA,EAAID,EAAGE,SAAUD,EAC/Bm7C,EAAOj7C,KAAKH,EAAGC,GAAGG,EAAGJ,EAAGC,GAAGI,GAE7Bi5C,GAAsBiC,0BAA0Bp7C,KAAKi7C,EAKvD,CACQI,oBAAoBR,GAC1B,MAAMS,GAAuBP,EAAAA,EAAAA,IAAqBF,EAAU,KAItDU,EAAsB18C,KAAK2D,MAAMC,mBAAmBC,gBAAgBC,IAAI64C,MAAMC,aAAaC,4BAC/FJ,GAOF,MAAO,CAJkBz8C,KAAK2D,MAAMC,mBAAmBC,gBAAgBC,IAAI64C,MAAMC,aAAaE,6BAC5FL,GAGwBC,EAC5B,CACQK,uBAAuBC,EAA0Bh8C,GACvD,OAAQg8C,GACN,IAAK,SACHnY,GAAQK,gBAAgBllC,KAAK2D,MAAO3C,GACpC,MACF,IAAK,UAEHmmB,EAAgBgP,iBAAiBn2B,KAAK2D,MAAO3C,GAC7C,MACF,IAAK,eACH+sC,GAAOkP,iBAAiBj9C,KAAK2D,MAAO3C,EAAIoL,EAAAA,GAAAA,cACxC,MACF,IAAK,eACH2hC,GAAOkP,iBAAiBj9C,KAAK2D,MAAO3C,EAAIoL,EAAAA,GAAAA,cACxC,MACF,IAAK,YACHqjB,EAAkB5B,cAAc7tB,KAAK2D,MAAO3C,GAC5C,MACF,IAAK,kBACHg4C,GAAuBiE,iBAAiBj9C,KAAK2D,MAAO3C,GACpD,MACF,IAAK,QAEH4qC,GAAOsR,eAAel9C,KAAK2D,MAAO3C,GAWxC,CAEO8R,SACL,MAAO,EACT,CACOD,cAAczR,EAAWC,GAC9B,OAAO,CACT,CACO6R,0BAA0B5F,GAC3B,CAECiG,UAAUnS,EAAWC,GACtB,CAEC4R,OACD,CAECxC,SACLzQ,KAAK2D,MAAM8a,eAAeze,MAC1BA,KAAK2D,MAAMw5C,4BAA4Bn9C,KACzC,CACOwJ,SAEP,CACOgG,WAAW9L,GACZ42C,GAAsB1hB,oBAOtB54B,KAAK0f,KAAKxe,OAAS,IAEZlB,KAAKk6C,kBACdl6C,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM4jC,SAASC,eACzD12C,EACA1D,KAAK0f,KACL1f,KAAK2D,MAAMC,mBAAmB4H,wBAAwB+f,sBAAsBC,YAC5ExrB,KAAK2D,MAAMC,mBAAmBuB,SAASqwB,aAAa/lB,cAAcC,aAAamK,SAAShB,UAAY7Y,KAAKqD,eAAe1C,YAAYiN,YAAc5N,KAAKqD,eAAe1C,YAAYgO,WAClL3O,KAAKgjB,UAGPhjB,KAAKyQ,SAET,EA7UW6pC,GAEGK,SAAU,EAFbL,GAGGj4B,kBAAY,EAHfi4B,GAIGgC,uBAAqC,GAJxChC,GAKGiC,0BAAwC,GAL3CjC,GAMG6B,yBAAuC,GAN1C7B,GAOG+B,4BAA0C,GAP7C/B,GAcG1hB,qBAAsB,EAdzB0hB,GAeG7hB,WAAuB,CAAC,EAAG,GCtCpC,MAAMjjB,WAA0BE,EAErC7V,YAAYyE,GACVY,MAAMZ,GAAM,KAFPA,UAAI,EAGTtE,KAAKsE,KAAOA,EACZtE,KAAKsE,KAAKjB,eAAeqH,aAC3B,CACO8E,WAAW9L,GAGhB,GAFA1D,KAAKyV,MAAMjS,WAEPxD,KAAKsE,KAAKob,KAAKxe,OAAS,GAErB,GAAIlB,KAAKsE,KAAK41C,kBAAmB,CACtC,MAAMkD,EAAc,GAEpB,IAAK,IAAIn8C,EAAI,EAAGA,EAAIjB,KAAKsE,KAAKob,KAAKxe,SAAUD,EAC3Cm8C,EAAYj8C,KAAK,IAAIkB,EAAAA,GACnBrC,KAAKsE,KAAKob,KAAKze,GAAGG,EAAIpB,KAAKsE,KAAKX,MAAMC,mBAAmBD,MAAM0lB,cAAcC,mBAAmBloB,EAChGpB,KAAKsE,KAAKob,KAAKze,GAAGI,EAAIrB,KAAKsE,KAAKX,MAAMC,mBAAmBD,MAAM0lB,cAAcC,mBAAmBjoB,IAIpGrB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM4jC,SAASC,eAC9D12C,EACA05C,EACAp9C,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB+f,sBAAsBC,YACjFxrB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASqwB,aAAa/lB,cAAcC,aAAamK,SAAShB,UAAY7Y,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WACjM3O,KAAKsE,KAAK0e,SAEd,MACEhjB,KAAKsE,KAAKmM,QAEd,EC/BK,MAAMyK,WAAuBM,EAIlC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KAJNA,SAAG,OACHf,iBAAW,OACXwa,qBAAe,EAGpBnb,KAAKW,YAAc,IAAIwX,EACvBnY,KAAKmb,gBAAkB,IAAIhD,EAC3BnY,KAAKmO,aACP,CACOA,cACLgK,EAAYkiC,oBACVr6C,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElDyI,EAAYkiC,oBACVr6C,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAEpD,CACO2tC,oBAAoB98C,GACrBA,IAASo7C,EAAAA,GAAAA,SACXxjC,EAAYmlC,2BACVt9C,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElDyI,EAAYolC,+BACVv9C,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,eAEzCnP,IAASo7C,EAAAA,GAAAA,kBAClBxjC,EAAYqlC,4BACVx9C,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAElDyI,EAAYslC,gCACVz9C,KAAKmb,gBACLnb,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAGtD,ECvBK,MAAMguC,WAAkBz4C,EAiB7B,qBACiCtC,IAA3B+6C,GAAUr7B,cACZq7B,GAAUr7B,aAAa5R,SAEzBitC,GAAUr7B,kBAAe1f,CAC3B,CAEA,iBAAwBgB,EAAc2J,EAAmB/M,GAEvDoD,EAAMC,mBAAmBuS,eAAe+X,cAAcC,qBACtDuvB,GAAU9kB,qBAAsB,CAClC,CACA,iBAAwBj1B,EAAc2J,EAAmB/M,QAExBoC,IAA3B+6C,GAAUr7B,cACZriB,KAAK60B,UAAUlxB,EAAO2J,EAAG/M,GAE3Bm9C,GAAU9kB,qBAAsB,EAC5B8kB,GAAUr7B,cACZq7B,GAAUr7B,aAAasW,QAAQrrB,EAAElM,EAAGkM,EAAEjM,EAE1C,CACA,eAAsBsC,EAAc2J,GAClC,QAA+B3K,IAA3B+6C,GAAUr7B,aAA4B,CACxC,GAAIq7B,GAAUr7B,aAAa3C,KAAKxe,OAAS,EACvC,OAEFw8C,GAAUr7B,aAAak4B,gBACvBmD,GAAUr7B,aAAa63B,mBAAoB,EAC3Cv2C,EAAMC,mBAAmB4H,wBAAwBgX,aACjDk7B,GAAUr7B,kBAAe1f,CAC3B,CACF,CACA,iBAAwBgB,EAAc2J,EAAmB/M,GACvD,QAAsBoC,IAAlB+6C,GAAUh8C,IAAmB,MAElBiB,IADAgB,EAAMC,mBAAmBuS,eAAe2M,eAAeb,YAAY3U,KAE9EowC,GAAUr7B,aAAe,IAAIq7B,GAAU/5C,EAAOpD,GAC9Cm9C,GAAUr7B,aAAahf,eAAeg6C,oBAAoB98C,GAE9D,CACAm9C,GAAUjlB,WAAW,GAAKnrB,EAAElM,EAC5Bs8C,GAAUjlB,WAAW,GAAKnrB,EAAEjM,CAC9B,CACAxB,YAAY8D,EAAcpD,GACxB2E,MAAMvB,GAAO,KAxDRN,oBAAc,OACd8B,cAAQ,OACRua,KAAmB,GAAG,KACtBnf,UAAI,OACJogC,UAAuBia,EAAAA,EAAAA,QAAkB,KACzCF,kBAAY,OACZ1iB,eAAS,OACTkiB,uBAAiB,OACjBl3B,cAAQ,EAiDbhjB,KAAK06C,aAAen6C,EAElBP,KAAK06C,eAAiBiB,EAAAA,GAAAA,aACtB37C,KAAK06C,eAAiBiB,EAAAA,GAAAA,SACtB37C,KAAK06C,eAAiBiB,EAAAA,GAAAA,aAEtB37C,KAAKgjB,UAAW,EAEhBhjB,KAAKgjB,UAAW,EAElBhjB,KAAKg4B,UAAY,EACjBh4B,KAAKk6C,mBAAoB,EAEzBl6C,KAAK2gC,UAAYia,EAAAA,EAAAA,eACjB56C,KAAK4c,gBAGL8gC,GAAUh8C,IAAM1B,KAEhBA,KAAK8R,MACP,CACQ8K,gBACN5c,KAAKqD,eAAiB,IAAI6X,GAAelb,MACzCA,KAAKmF,SAAW,IAAIqQ,GAAkBxV,KACxC,CACQ8R,OACN9R,KAAK2D,MAAMg6C,aAAa39C,KAC1B,CACO24B,QAAQv3B,EAAWC,GACxBrB,KAAK0f,KAAKve,KAAK,IAAIkB,EAAAA,GAASjB,EAAGC,GACjC,CACQy5C,gBAAgB95C,GACtB,MAAM0e,EAAmB,GAEzBA,EAAKve,KAAKH,EAAG,IACb,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAGE,OAFV,IAE2BD,EAAG,CACzC,IAAIiC,GAAI2iB,EAAAA,EAAAA,IAAI7kB,EAAGC,GAAID,EAAGC,EAAI,IAC1BiC,GAAI0iB,EAAAA,EAAAA,IAAU1iB,GACd,IAAI63C,GAAKl1B,EAAAA,EAAAA,IAAI7kB,EAAGC,GAAID,EAAGC,EAAI,IAC3B85C,GAAKn1B,EAAAA,EAAAA,IAAUm1B,GACf,MAAMC,GAAMn1B,EAAAA,EAAAA,IAAI7kB,EAAGC,GAAID,EAAGC,EAAI,IAC9B85C,GAAKn1B,EAAAA,EAAAA,IAAUo1B,GACf,IAAIC,GAAOp1B,EAAAA,EAAAA,IAAI7kB,EAAGC,GAAID,EAAGC,EAAI,IAC7Bg6C,GAAOr1B,EAAAA,EAAAA,IAAUq1B,GACjB,IAAIC,GAAQr1B,EAAAA,EAAAA,IAAI7kB,EAAGC,GAAID,EAAGC,EAAI,IAC9Bi6C,GAAQt1B,EAAAA,EAAAA,IAAUs1B,GAElB,MAAMC,GAAKC,EAAAA,EAAAA,IAAcl4C,EAAG63C,GACtBM,GAAKD,EAAAA,EAAAA,IAAcl4C,EAAG83C,GACtBM,GAAKF,EAAAA,EAAAA,IAAcl4C,EAAG83C,IAGxBhsC,MAAMmsC,IAAOnsC,MAAMqsC,IAAOrsC,MAAMssC,KAElC57B,EAAKve,KAAKH,EAAGC,GAEjB,CAEA,OADAye,EAAKve,KAAKH,EAAGA,EAAGE,OAAS,IAClBwe,CACT,CACQ67B,QAAQv6C,GACd,IAAI0e,EAAmB,GAEvB,OADAA,EAAO1e,EACA0e,CACT,CACQ87B,UAAUt4C,GAChB,IAAIjC,EAAIiC,EAAEhC,OACV,KAAOD,KAAK,CACA,IAAI8a,EAAO/b,KAAK2D,MAAOT,EAAEjC,GAAGG,EAAG8B,EAAEjC,GAAGI,GAC5CiP,OACJ,CACF,CACQiqC,gBACN,IAAIv5C,EAAKhB,KAAK0f,KACd,GAAI1f,KAAK06C,eAAiBiB,EAAAA,GAAAA,aACxB36C,EAAKhB,KAAK86C,gBAAgB95C,GAE1BA,EAAKhB,KAAKu7C,QAAQv6C,GAClBhB,KAAKw7C,UAAUx6C,OACV,CAOL,GANIhB,KAAK2gC,YAAcia,EAAAA,EAAAA,eACrB55C,EAAK48C,EAAAA,GAAAA,aAA4B58C,EAAI,GAC5BhB,KAAK2gC,YAAcia,EAAAA,EAAAA,UAC5B55C,GAAKwzB,EAAAA,EAAAA,IAAoBxzB,EAAI,KAG3BA,EAAGE,OAAS,EACd,OAEElB,KAAK06C,eAAiBiB,EAAAA,GAAAA,aACxB/P,GAAOsR,eAAel9C,KAAK2D,MAAO3C,GAAI,GAEpChB,KAAK06C,eAAiBiB,EAAAA,GAAAA,OACxB/P,GAAOsR,eAAel9C,KAAK2D,MAAO3C,GAEhChB,KAAK06C,eAAiBiB,EAAAA,GAAAA,iBACxB9lB,EAAsBI,YAAYj2B,KAAK2D,MAAO3C,GAE5ChB,KAAK06C,eAAiBiB,EAAAA,GAAAA,UACxB95B,EAAiBg8B,kBAAkB79C,KAAK2D,MAAO3C,GAE7ChB,KAAK06C,eAAiBiB,EAAAA,GAAAA,aACxBx0B,EAAgBgP,iBAAiBn2B,KAAK2D,MAAO3C,GAE3ChB,KAAK06C,eAAiBiB,EAAAA,GAAAA,cACxB1R,GAAqB9T,iBAAiBn2B,KAAK2D,MAAO3C,GAIpDhB,KAAKyQ,QACP,CACF,CAEOqC,SACL,MAAO,EACT,CACOD,cAAczR,EAAWC,GAC9B,OAAO,CACT,CACO6R,0BAA0B5F,GAC1B,CAEAiG,UAAUnS,EAAWC,GACtB,CAEC4R,OACD,CAECxC,SACLitC,GAAUh8C,SAAMiB,EAChB3C,KAAK2D,MAAM8a,eAAeze,MAC1BA,KAAK2D,MAAMm6C,gBAAgB99C,KAC7B,CACOwJ,SAEP,CACOgG,WAAW9L,GAChB1D,KAAKmF,SAASqK,WAAW9L,EAC3B,EAzMWg6C,GACGh8C,SAAG,EADNg8C,GAEG/C,SAAU,EAFb+C,GAGGr7B,kBAAY,EAHfq7B,GAIG9kB,qBAAsB,EAJzB8kB,GAKGjlB,WAAuB,CAAC,EAAG,GCtBpC,MAAMjjB,WAA0BE,EAErC7V,YAAYyE,GACVY,MAAMZ,GAAM,KAFPA,UAAI,EAGTtE,KAAKsE,KAAOA,CACd,CACOkL,WAAW9L,GACX1D,KAAKsE,KAAKtC,cAAiBhC,KAAKsE,KAAKy5C,MAQ1C/9C,KAAKyV,MAAMjS,SAGXE,EAAI+nC,OACJ/nC,EAAI6P,UAAUvT,KAAKsE,KAAK1B,IAAIxB,EAAGpB,KAAKsE,KAAK1B,IAAIvB,GAC7CqC,EAAIs6C,OAAOh+C,KAAKsE,KAAK2nB,MAAQ,KAQzBjsB,KAAKuK,EAAI,GACPvK,KAAKsE,KAAKsB,cAAiB5F,KAAKsE,KAAK9D,YAAcR,KAAKsE,KAAK/D,OAAS6L,EAAAA,GAAAA,YACxEpM,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMqU,MAAMqzB,UAC3Dv6C,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzB,EACA,EACAX,KAAKsE,KAAK45C,YACVl+C,KAAKsE,KAAK65C,aACVn+C,KAAKsE,KAAKy5C,KACV,EACA/9C,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,iBACV,EACAlH,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,QAElFtV,KAAKsV,OAAStV,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAC1DrV,KAAKiP,OAAS,EACdjP,KAAKsE,KAAK8B,SAAU,EACpBpG,KAAKo+C,eAAe16C,GACpB1D,KAAKq+C,mBAAmB36C,GACxB1D,KAAK+qB,SAASrnB,GACV1D,KAAKsE,KAAKg6C,iBACZt+C,KAAKu+C,aAAa76C,KAIpB1D,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMqU,MAAMqzB,UAC3Dv6C,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzB,EACA,EACAX,KAAKsE,KAAK45C,YACVl+C,KAAKsE,KAAK65C,aACVn+C,KAAKsE,KAAKy5C,KACV,EACA/9C,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,iBACV,GAGFlH,KAAKsV,MAAQ,GAGftV,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMqU,MAAMqzB,UAC3Dv6C,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzB,EACA,EACAX,KAAKsE,KAAK45C,YACVl+C,KAAKsE,KAAK65C,aACVn+C,KAAKsE,KAAKy5C,KACV,EACA/9C,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,iBACV,EACAlH,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKuK,IAIpF7G,EAAIgoC,UAGN,CACO8S,WAAW96C,GAUhB,CAEM06C,eAAe16C,GACrB,MAAM+6C,EAA2B,GACjC,IAAK,IAAIx9C,EAAI,EAAGA,EAAIjB,KAAKsE,KAAKo6C,QAAQx9C,SAAUD,EAC9Cw9C,EAAat9C,KAAKnB,KAAKsE,KAAKo6C,QAAQz9C,GAAG2B,KAEzCc,EAAIO,YACJ,MAAMwQ,EAAMzU,KAAKsE,KAAKX,MAAMC,mBAAmB6L,cAAcC,aAAaC,OACvE8I,oBACH/U,EAAI2c,YAAW,eAAW5L,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,KACjE/Q,EAAImV,UAAY,EAChB7Y,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM2K,KAAKy9B,YAC1Dj7C,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzB89C,EACA,EACA,GAEF/6C,EAAIS,YACJT,EAAI8c,QACN,CACQuK,SAASrnB,GACfA,EAAIM,UAAY,UAChB,MAAMyQ,EAAMzU,KAAKsE,KAAKX,MAAMC,mBAAmB6L,cAAcC,aAAaC,OACvE8I,oBACH/U,EAAI2c,YAAW,eAAW5L,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,KACjE/Q,EAAIO,YACJP,EAAIe,IAAI,EAAG,EAAG,IAAK,EAAa,EAAV6N,KAAK8Y,IAC3B1nB,EAAIS,YACJT,EAAIU,OACJV,EAAI8c,QACN,CACQ69B,mBAAmB36C,GACzB,IAAK,IAAIzC,EAAI,EAAGA,EAAIjB,KAAKsE,KAAKo6C,QAAQx9C,SAAUD,EAC9CjB,KAAKsE,KAAKo6C,QAAQz9C,GAAGuO,WAAWxP,KAAKsE,KAAKX,MAAOD,EAErD,CACQ66C,aAAa76C,GACnB,IAAK,IAAIzC,EAAI,EAAGA,EAAIjB,KAAKsE,KAAKs6C,MAAM19C,SAAUD,EAAG,CAC/C,MAAM49C,GAAUlxB,EAAAA,EAAAA,IACd3tB,KAAKsE,KAAKy5C,IAAIz6C,MACdtD,KAAKsE,KAAKy5C,IAAIx6C,OACdvD,KAAKsE,KAAKs6C,MAAM39C,IAEZ69C,EAAO,EAAiB,GAAbD,EAAQ,GACnBE,EAAO,EAAiB,GAAbF,EAAQ,GAEzBn7C,EAAIwnB,YAAc,EAClBxnB,EAAIyc,gBAAkBngB,KAAKuK,EAC3B7G,EAAIO,YACJP,EAAImV,UAAY,GAChBnV,EAAI2c,YAAc,UAClB3c,EAAI0c,YAAY,CAAC,EAAG,IACpB1c,EAAIQ,KAAK46C,EAAMC,EAAMF,EAAQ,GAAIA,EAAQ,IACzCn7C,EAAIS,YACJT,EAAI8c,SAEJ9c,EAAIwnB,YAAc,EAClBxnB,EAAIyc,gBAAkBngB,KAAKuK,EAAI,EAC/B7G,EAAIO,YACJP,EAAImV,UAAY,GAChBnV,EAAI2c,YAAc,UAClB3c,EAAI0c,YAAY,CAAC,EAAG,IACpB1c,EAAIQ,KAAK46C,EAAMC,EAAMF,EAAQ,GAAIA,EAAQ,IACzCn7C,EAAIS,YACJT,EAAI8c,SAEJ9c,EAAI0c,YAAY,CAAC,EAAG,GACtB,CACF,EAEK,MAAM4+B,GAKXn/C,YAAYkvB,EAAe3tB,EAAWC,EAAWC,GAAY,KAJ7DytB,WAAK,OACLnsB,SAAG,OACH+E,EAAI,EAAE,KACNs3C,WAAa,EAEXj/C,KAAK4C,IAAM,IAAIP,EAAAA,GAASjB,EAAGC,EAAGC,GAC9BtB,KAAK+uB,MAAQA,CACf,CACOvf,WAAW7L,EAAcD,GAC9BA,EAAImV,UAAY7Y,KAAKi/C,WACrBv7C,EAAIM,UAAY,UAChB,MAAMyQ,EAAM9Q,EAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO8I,oBACvE/U,EAAI2c,YAAW,eAAW5L,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,KACjE/Q,EAAIO,YACJP,EAAIe,IAAIzE,KAAK4C,IAAIxB,EAAGpB,KAAK4C,IAAIvB,EAAGrB,KAAK2H,EAAG,EAAa,EAAV2K,KAAK8Y,IAEhD1nB,EAAIS,YACJT,EAAIU,OACJV,EAAI8c,QACN,ECnMK,MAAMtF,WAAuBM,EAElC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KAFN+Z,aAAO,EAGZzb,KAAKmO,aACP,CACOA,cACLgK,EAAY+mC,wBACVl/C,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAEpD,ECCK,MAAMyvC,WAA0BluC,EAiGrC,gBAAuBtN,EAAc0M,GAAoD,IAArCtJ,EAAM,wDAAUuV,EAAU,wDAE5E,MAAMkK,EAAK,CAACnW,EAAEzP,MAAM,GAAGV,GAAImQ,EAAEzP,MAAM,GAAGT,IAChC4vB,EAAK,IAAIovB,GAAkBx7C,EAAO6iB,EAAG,GAAIA,EAAG,GAAI,EAAGzf,EAAQsJ,EAAEvP,KAAKs+C,UAyBxE,OAxBArvB,EAAGxvB,KAAO6L,EAAAA,GAAMiE,EAAE9P,MAGlBwvB,EAAG1pB,cAAgBgK,EAAE3P,SACjB2P,EAAE3P,SACJqvB,EAAG7oB,gBAAkB,EAErB6oB,EAAG7oB,gBAAkB,EAGrB6oB,EAAGzvB,GADDgc,EACM3Y,EAAMsF,UAENoH,EAAE/P,GAGZyvB,EAAGouB,aAAe9tC,EAAEvP,KAAKyC,OACzBwsB,EAAGmuB,YAAc7tC,EAAEvP,KAAKwC,MAExBysB,EAAGguB,IAAIsB,IAAM17C,EAAMC,mBAAmBuB,SAASmR,KAAKgpC,MAAMC,WAAWC,IACnEnvC,EAAEvP,KAAKs+C,UAGTrvB,EAAG/tB,cAAe,EAClB+tB,EAAGjgB,kBACIigB,CACT,CAGA,uBAA8BziB,GACvB,CAEP,wBAA+BA,GACxB,CAEP,sBAA6B3J,EAAc2J,GAEzC,QACoB3K,IAAlBgB,EAAMgP,UACLhP,EAAMC,mBAAmBuB,SAASmR,KAAKgpC,MAAMG,eAE9C,OAEQ,IAAIN,GAAkBx7C,EAAO2J,EAAElM,EAAGkM,EAAEjM,EAAG,GAC/CiP,QACE3M,EAAMC,mBAAmB4H,wBAAwB8C,aAAayQ,YAGlEpb,EAAMC,mBAAmB4H,wBAAwBgX,YACnD,CACA,iBAAwBlV,GACjB,CAGPzN,YACE8D,GAUC,IATDvC,EAAC,uDAAG,EACJC,EAAC,uDAAG,EACJC,EAAC,uDAAG,EACJyF,EAAM,wDACNq4C,EAAQ,uDAAG,GACXM,EAAI,uDAAG,GACPn/C,EAAW,uDAAG6L,EAAAA,GAAAA,WAEE,2CAAGyJ,EAAAA,GAAAA,MAWnB,GATA3Q,MAAMvB,EAAOvC,EAAGC,EAAGC,EAAGf,GAAM,KArKvBoH,OAAC,OACD/E,SAAG,OACH8E,UAAI,OACJyJ,aAAO,OACPC,aAAO,OACP7Q,UAAI,OAEJiR,WAAK,OACLC,gBAAU,OACVC,gBAAU,OACVC,iBAAW,OACX+tC,UAAI,OACJ3B,SAAG,OACH7xC,SAAG,OACHyzC,eAAS,OACTC,cAAQ,OACRC,eAAS,OACTT,cAAQ,OAERU,kBAAY,OACZC,iBAAW,OACX7B,YAAc,EAAE,KAChBC,aAAe,EAAE,KAGjB6B,0BAA4B,EAAE,KAC9BC,SAAW,EAAE,KACbC,SAAW,EAAE,KACbC,cAAQ,OACRzB,QAAyB,GAAG,KAC5B0B,cAAe,EAAM,KACrBn0B,MAAQ,EAAE,KACVqyB,iBAAkB,EAAM,KACxB+B,yBAA0B,EAAM,KAChCzB,MAAkB,GAAG,KACrB0B,SAAqB,GAmI1BtgD,KAAK0/C,KAAOA,EACZ1/C,KAAK+G,OAASA,EACd/G,KAAKyR,YAAa,EAClBzR,KAAK8H,eAAgB,EACrB9H,KAAKgC,cAAe,EACpBhC,KAAKo/C,SAAWA,EAChBp/C,KAAK4c,gBAED5c,KAAKugD,WAAY,CAEnB,GADA58C,EAAM68C,UAAUxgD,MACZA,KAAK+G,OACP,OAEFpD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiB9Q,KAAKwJ,SAC5E,CACF,CACQoT,gBACN5c,KAAKqD,eAAiB,IAAI6X,GAAelb,MACzCA,KAAKmF,SAAW,IAAIqQ,GAAkBxV,KACxC,CACQugD,WAKN,GAJIvgD,KAAK8H,eACP9H,KAAKygD,cAGHzgD,KAAKo/C,SAASl+C,OAAS,GAczB,OAAO,EAbPlB,KAAKo/C,SAAWp/C,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKgpC,MAAMG,eAKlEz/C,KAAK+9C,IAAM,IAAI2C,MAGf1gD,KAAK+9C,IAAIsB,IAAMr/C,KAAK2D,MAAMC,mBAAmBuB,SAASmR,KAAKgpC,MAAMG,eAEjEz/C,KAAKgC,cAAe,EACpBhC,KAAKmH,qBAAsB,EAU7B,MAAMy3C,GAAQ+B,EAAAA,EAAAA,IAA6B3gD,KAAK+9C,IAAIz6C,MAAOtD,KAAK+9C,IAAIx6C,OAAQ,IA6C5E,OA5CAvD,KAAKk+C,YAAcU,EAAM,GACzB5+C,KAAKm+C,aAAeS,EAAM,GAE1B5+C,KAAK8/C,aAAe9/C,KAAKk+C,YAAY,GACrCl+C,KAAK+/C,YAAc//C,KAAKk+C,YAAY,GACpCl+C,KAAKigD,QAAU,EACfjgD,KAAKkgD,QAAU,EAEflgD,KAAK0+C,QAAU,GACf1+C,KAAK0+C,QAAQv9C,KACX,IAAI69C,GACF,EACA,EAAIh/C,KAAK+/C,YAAc//C,KAAKigD,QAC5B,EAAIjgD,KAAK8/C,aAAe9/C,KAAKkgD,QAC7B,IAGJlgD,KAAK0+C,QAAQv9C,KACX,IAAI69C,GACF,EACA,EAAIh/C,KAAK+/C,YAAc//C,KAAKigD,QAC5B,EAAIjgD,KAAK8/C,aAAe9/C,KAAKkgD,QAC7B,IAGJlgD,KAAK0+C,QAAQv9C,KACX,IAAI69C,GACF,EACA,EAAIh/C,KAAK+/C,YAAc//C,KAAKigD,QAC5B,EAAIjgD,KAAK8/C,aAAe9/C,KAAKkgD,QAC7B,IAGJlgD,KAAK0+C,QAAQv9C,KACX,IAAI69C,GACF,EACA,EAAIh/C,KAAK+/C,YAAc//C,KAAKigD,QAC5B,EAAIjgD,KAAK8/C,aAAe9/C,KAAKkgD,QAC7B,IAIJlgD,KAAK4+C,MAAQ,CAAC,GAAI,GAAI,GAAI,IAC1B5+C,KAAK4gD,0BACE,CACT,CACOA,yBACL5gD,KAAKsgD,SAAW,GAChB,IAAK,IAAIr/C,EAAI,EAAGA,EAAIjB,KAAK4+C,MAAM19C,SAAUD,EAAG,CAC1C,MAAM49C,GAAU8B,EAAAA,EAAAA,IAA6B3gD,KAAK+9C,IAAIz6C,MAAOtD,KAAK+9C,IAAIx6C,OAAQvD,KAAK4+C,MAAM39C,IACnF69C,EAAO,EAAiB,GAAbD,EAAQ,GACnBE,EAAO,EAAiB,GAAbF,EAAQ,GACnB5hC,GAAM/P,EAAAA,EAAAA,IAAY,IAAI7K,EAAAA,GAAS,EAAG,GAAI,IAAIA,EAAAA,GAASy8C,EAAMC,IAC/D/+C,KAAKsgD,SAASn/C,KAAK8b,EACrB,CACF,CACO7K,gBACL,MAAO,mBACT,CAYOquC,YACLzgD,KAAK2/C,UAAY,IACjB3/C,KAAK4/C,SAAW,IAChB5/C,KAAKkM,IAAMR,SAASC,cAAc,OAClC3L,KAAKkM,IAAI5L,GAAE,kBAAcN,KAAKM,GAAGyS,YACjC/S,KAAKkM,IAAIN,MAAMrI,OAASvD,KAAK2/C,UAAY,KACzC3/C,KAAKkM,IAAIN,MAAMtI,MAAQtD,KAAK4/C,SAAW,KACvC5/C,KAAKkM,IAAIN,MAAMU,KAAOtM,KAAK4C,IAAIvB,EAAqB,GAAjBrB,KAAK2/C,WAAiB5sC,WAAa,KACtE/S,KAAKkM,IAAIN,MAAMW,MAAQvM,KAAK4C,IAAIxB,EAAI,IAAI2R,WAAa,KACrD/S,KAAKkM,IAAIN,MAAMC,SAAW,WAC1B7L,KAAKkM,IAAIN,MAAMi1C,WAAa,MAC5B7gD,KAAKkM,IAAIN,MAAME,OAAS,MACxB9L,KAAKkM,IAAIN,MAAMvB,WAAa,QAG9B,CACOy2C,eACL9gD,KAAKkM,IAAIN,MAAMU,KAAOtM,KAAK4C,IAAIvB,EAAqB,GAAjBrB,KAAK2/C,WAAiB5sC,WAAa,KACtE/S,KAAKkM,IAAIN,MAAMW,MAAQvM,KAAK4C,IAAIxB,EAAI,IAAI2R,WAAa,IACvD,CACOF,cAAczR,EAAWC,GAC9B,GAAIrB,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,cAC9C,OAAO,EAET,MAAMoX,EAAI,IAAIpb,EAAAA,GAASjB,EAAGC,GAE1BrB,KAAKogD,cAAe,EAEpB,IAAK,IAAIn/C,EAAI,EAAGA,EAAIjB,KAAK0+C,QAAQx9C,SAAUD,EAAG,CAC5C,MAAMgc,GAAM/P,EAAAA,EAAAA,IACVuQ,EACA,IAAIpb,EAAAA,GAASrC,KAAK0+C,QAAQz9C,GAAG2B,IAAIxB,EAAIpB,KAAK4C,IAAIxB,EAAGpB,KAAK0+C,QAAQz9C,GAAG2B,IAAIvB,EAAIrB,KAAK4C,IAAIvB,IAEpF,GAAI4b,EAAMjd,KAAK0+C,QAAQz9C,GAAG0G,EAAI,EAG5B,OAFA3H,KAAKggD,yBAA2BhgD,KAAK0+C,QAAQz9C,GAAG8tB,MAChD/uB,KAAKogD,cAAe,GACb,EACEpgD,KAAK0+C,QAAQ,GAAG/2C,EAAI,EAAIsV,GAAOA,EAAMjd,KAAK0+C,QAAQ,GAAG/2C,EAAI,KAClE3H,KAAKogD,cAAe,EAExB,CAGA,OADApgD,KAAKggD,0BAA4B,KAE/Br2C,EAAAA,EAAAA,IAAe8T,EAAG,CAChB,IAAIpb,EAAAA,GAASrC,KAAK0+C,QAAQ,GAAG97C,IAAIxB,EAAIpB,KAAK4C,IAAIxB,EAAGpB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,EAAIrB,KAAK4C,IAAIvB,GAClF,IAAIgB,EAAAA,GAASrC,KAAK0+C,QAAQ,GAAG97C,IAAIxB,EAAIpB,KAAK4C,IAAIxB,EAAGpB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,EAAIrB,KAAK4C,IAAIvB,GAClF,IAAIgB,EAAAA,GAASrC,KAAK0+C,QAAQ,GAAG97C,IAAIxB,EAAIpB,KAAK4C,IAAIxB,EAAGpB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,EAAIrB,KAAK4C,IAAIvB,GAClF,IAAIgB,EAAAA,GAASrC,KAAK0+C,QAAQ,GAAG97C,IAAIxB,EAAIpB,KAAK4C,IAAIxB,EAAGpB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,EAAIrB,KAAK4C,IAAIvB,QAKlFrB,KAAKogD,YAIX,CACOrwC,SAAS3O,EAAWC,GACzB,MAAMK,EAAM,IAAIy9C,GACdn/C,KAAK2D,MACLvC,EACAC,EACArB,KAAK4C,IAAItB,GACT,EACAtB,KAAKo/C,SACLp/C,KAAK0/C,KACL1/C,KAAKO,KACLP,KAAK2H,GAYP,OAVAjG,EAAInB,KAAOP,KAAKO,KAEhBmB,EAAI2E,cAAgBrG,KAAKqG,cACzB3E,EAAIpB,GAAKN,KAAK2D,MAAMsF,UAGpBvH,EAAIw8C,YAAcl+C,KAAKk+C,YACvBx8C,EAAIy8C,aAAen+C,KAAKm+C,aAExBz8C,EAAImP,eACGnP,CACT,CACO6R,UAAUnS,EAAWC,GAC1B,CAEK6R,0BAA0B5F,GAC/B,GAAItN,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,cAC9C,OAEF,GAAIrG,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAa4H,SACrE,OAEF,MAAMqW,EAAOjf,EAAElM,EAAIkM,EAAE6F,KACfqZ,EAAOlf,EAAEjM,EAAIiM,EAAE8F,KAErB,GACEpT,KAAKogD,cACLpgD,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAayQ,WAEnE/e,KAAKisB,OAASM,EAAOC,MAChB,CACL,GAAIxsB,KAAKggD,0BAA4B,EAQnC,OAPAhgD,KAAKqgD,yBAA0B,OAC3BrgD,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAayQ,WACrE/e,KAAK+gD,iCAAiCx0B,EAAMC,IAE5CxsB,KAAKghD,0BAA0B1zC,GAC/BtN,KAAKs+C,iBAAkB,IAI3Bt+C,KAAKs+C,iBAAkB,EAEvBt+C,KAAK4C,IAAIxB,GAAKmrB,EACdvsB,KAAK4C,IAAIvB,GAAKmrB,EAEdxsB,KAAKmG,QAAS,EAEVnG,KAAKsK,iBACPtK,KAAKsK,eAAe4I,0BAA0B5F,GAC1CtN,KAAKsK,eAAe+I,aAEtBrT,KAAKsK,eAAe+I,WAAWC,GAAGlS,EAAIpB,KAAK4C,IAAIxB,EAC/CpB,KAAKsK,eAAe+I,WAAWC,GAAGjS,EAAIrB,KAAK4C,IAAIvB,GAIrD,CACF,CAEWb,iBACT,OAAOR,KAAK+F,eACd,CACWvF,eAAW0C,GACpBlD,KAAK+F,gBAAkB7C,EACvBlD,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2c,eAAe3mB,KAAKwJ,SAC/E,CACWY,cACT,OAAOpK,KAAK4F,YACd,CACWwE,YAAQlH,GACjBlD,KAAK4F,aAAe1C,GAChBlD,KAAK4F,eAAiB5F,KAAK6F,aAEnB7F,KAAK4F,cAAgB5F,KAAK6F,aADpC7F,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB4c,WAAW5mB,KAAKwJ,UAI3ExJ,KAAK6F,WAAa7F,KAAK4F,aAClB1C,IACHlD,KAAK8G,mBAAoB,EACzB9G,KAAK4M,mBAET,CAEOo0C,0BAA0B1zC,GAC/B,MAAM2P,GAAM/P,EAAAA,EAAAA,IAAYlN,KAAK4C,IAAK,IAAIP,EAAAA,GAASiL,EAAElM,EAAGkM,EAAEjM,IACtD,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAKsgD,SAASp/C,SAAUD,EAC1C,GAAIgc,EAAMjd,KAAKsgD,SAASr/C,GAAI,CAC1B,MAAM29C,GAAQ+B,EAAAA,EAAAA,IAA6B3gD,KAAK+9C,IAAIz6C,MAAOtD,KAAK+9C,IAAIx6C,OAAQvD,KAAK4+C,MAAM39C,IACvFjB,KAAKk+C,YAAcU,EAAM,GACzB5+C,KAAKm+C,aAAeS,EAAM,GAC1B5+C,KAAK0+C,QAAQ,GAAG97C,IAAIxB,EAAgB,IAAXw9C,EAAM,GAC/B5+C,KAAK0+C,QAAQ,GAAG97C,IAAIvB,EAAgB,IAAXu9C,EAAM,GAC/B5+C,KAAK0+C,QAAQ,GAAG97C,IAAIxB,EAAgB,IAAXw9C,EAAM,GAC/B5+C,KAAK0+C,QAAQ,GAAG97C,IAAIvB,EAAgB,IAAXu9C,EAAM,GAC/B5+C,KAAK0+C,QAAQ,GAAG97C,IAAIxB,EAAgB,IAAXw9C,EAAM,GAC/B5+C,KAAK0+C,QAAQ,GAAG97C,IAAIvB,EAAgB,IAAXu9C,EAAM,GAC/B5+C,KAAK0+C,QAAQ,GAAG97C,IAAIxB,EAAgB,IAAXw9C,EAAM,GAC/B5+C,KAAK0+C,QAAQ,GAAG97C,IAAIvB,EAAgB,IAAXu9C,EAAM,GAC/B,KACF,CAEJ,CACQmC,iCAAiCx0B,EAAcC,GACf,IAAlCxsB,KAAKggD,0BACPhgD,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,EACzBxsB,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,EACzBxsB,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,EACzBxsB,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,GACkB,IAAlCxsB,KAAKggD,0BACdhgD,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,EACzBxsB,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,EACzBxsB,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,EACzBxsB,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,GACkB,IAAlCxsB,KAAKggD,0BACdhgD,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,EACzBxsB,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,EACzBxsB,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,EACzBxsB,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,GACkB,IAAlCxsB,KAAKggD,2BACdhgD,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,EACzBxsB,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,EACzBxsB,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,EACzBxsB,KAAK0+C,QAAQ,GAAG97C,IAAIxB,GAAKmrB,EACzBvsB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,GAAKmrB,GAE3BxsB,KAAKk+C,YAAcl+C,KAAK0+C,QAAQ,GAAG97C,IAAIxB,EAAIpB,KAAK0+C,QAAQ,GAAG97C,IAAIxB,EAC/DpB,KAAKm+C,aAAen+C,KAAK0+C,QAAQ,GAAG97C,IAAIvB,EAAIrB,KAAK0+C,QAAQ,GAAG97C,IAAIvB,CAClE,CAEOoP,SAAyB,IAAlB5J,IAAQ,yDAepB,GAdA7G,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EAChBhC,KAAK8H,eACP9H,KAAK4M,mBAGH5M,KAAKsK,iBACPtK,KAAKsK,eAAegU,wBACpBte,KAAKsK,oBAAiB3H,GAGxB3C,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EACpBhC,KAAK2F,UAAW,EACZkB,EAAU,CACZ,MAAMuX,EAAQpe,KAAKwJ,SACf4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB,CAACvG,GAElF,CACApe,KAAK2D,MAAM4a,gBAAgBve,MAC3BA,KAAK2D,MAAMs9C,aAAajhD,MACxBA,KAAK2D,MAAM8a,eAAeze,KAC5B,CACOwJ,SAYP,CACOoH,UACL,GAAI5Q,KAAKqgD,wBAAyB,CAChC,MAAMv/C,EAAOd,KAAKwJ,SACd1I,GACFd,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBqU,eAAe,CAACvd,GAE7E,CACAd,KAAKqgD,yBAA0B,CACjC,CAEO7wC,WAAW9L,GAChB1D,KAAKmF,SAASqK,WAAW9L,EAC3B,ECpjBK,MAAMilB,GAEX9oB,YAAY6B,GAAqB,KAD1BA,SAAG,EAER1B,KAAK0B,IAAMA,CACb,CACOmR,cAAczR,EAAWC,GAC9B,OAAO,CACT,CACOyR,SACL,MAAO,EACT,CACOG,OACL,ECVG,MAAMuC,WAA0BE,EAErC7V,YAAYyE,GACVY,MAAMZ,GAAM,KAFPA,UAAI,EAGTtE,KAAKsE,KAAOA,CACd,CACOkL,WAAW9L,GAKhB,GAJA1D,KAAKsE,KAAK8D,UAAU5E,OAAOE,GAC3B1D,KAAKmU,iBAAiB3Q,SAGlBxD,KAAKsE,KAAKvB,WAAc,OAC5B,GAAI/C,KAAKsE,KAAK+D,eAAiB,IAAQ,OACvC,QAAiF1F,IAA7E3C,KAAKsE,KAAKX,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAOimC,IAAqB,OAG9F,MAAMsL,EAAwBlhD,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAM4qC,SAC/EC,EAAqBphD,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMqU,MAE5Ey2B,EAAerhD,KAAKsE,KAAKX,MAAMC,mBAAmBuS,eAAeC,eAAeC,sBAAsBrW,KAAKsE,KAAK1B,KAClH5C,KAAKsE,KAAK6B,QACZi7C,EAAmBE,aAAa59C,EAAK1D,KAAKsE,KAAKjB,eAAe1C,YAAa0gD,EAAajgD,EAAGigD,EAAahgD,EAAGrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WAAY3O,KAAKsE,KAAK9D,WAAYR,KAAKsE,KAAK8F,SAEtQpK,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIy9C,MAAMhmB,cAAgBimB,EAAAA,GAAAA,MAC/EJ,EAAmBK,kCACjB/9C,EAAK1D,KAAKsE,KAAKjB,eAAe1C,YAC9B0gD,EAAajgD,EAAGigD,EAAahgD,EAC7BrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WACnH3O,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,QAChF,GAAM,EACNtV,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK+F,YAEZ+2C,EAAmBM,0BAA0Bh+C,EAAK1D,KAAKsE,KAAKjB,eAAe1C,YACzE0gD,EAAajgD,EAAGigD,EAAahgD,EAC7BrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WACnH3O,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKkP,SAChF,GAAO,EAAOlP,KAAKsE,KAAK0C,YAAahH,KAAKsE,KAAK+F,WAAYrK,KAAKsE,KAAK8F,QAASpK,KAAKsE,KAAK9D,aAK1F0gD,EAAsBS,mBACpBj+C,EAAK1D,KAAKsE,KAAKX,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAOimC,IAAIgM,OAAQ5hD,KAAKsE,KAAKjB,eAAe1C,YAC/G0gD,EAAajgD,EAAGigD,EAAahgD,EAC7BrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WACnH3O,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKkP,SAAS,GAAO,EAAOlP,KAAKsE,KAAK0C,YAAahH,KAAKsE,KAAK4C,gBAAiBlH,KAAKsE,KAAKoB,WAAY1F,KAAKsE,KAAKsB,aAAc5F,KAAKsE,KAAKyB,iBAAiB,GAGtO/F,KAAKoV,KAAO,KACZpV,KAAKkP,OAAS,IAGVlP,KAAKsE,KAAKyB,iBACZq7C,EAAmBE,aAAa59C,EAAK1D,KAAKsE,KAAKjB,eAAe1C,YAAa0gD,EAAajgD,EAAGigD,EAAahgD,EAAGrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WAAY3O,KAAKsE,KAAK9D,WAAYR,KAAKsE,KAAK8F,SAGtQpK,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIy9C,MAAMhmB,cAAgBimB,EAAAA,GAAAA,KAE/EJ,EAAmBS,0CACjBn+C,EAAK1D,KAAKsE,KAAKjB,eAAe1C,YAC9B0gD,EAAajgD,EAAGigD,EAAahgD,EAC7BrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WACnH3O,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,QAChF,GAAM,EACNtV,KAAKsE,KAAK0C,YAAahH,KAAKsE,KAAK4C,iBAGnCg6C,EAAsBS,mBACpBj+C,EAAK1D,KAAKsE,KAAKX,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAOimC,IAAIgM,OAAQ5hD,KAAKsE,KAAKjB,eAAe1C,YAC/G0gD,EAAajgD,EAAGigD,EAAahgD,EAC7BrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WACnH3O,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKkP,SAChF,GAAO,EAAOlP,KAAKsE,KAAK0C,YAAahH,KAAKsE,KAAK4C,gBAC/ClH,KAAKsE,KAAKoB,WAAY1F,KAAKsE,KAAKsB,aAAc5F,KAAKsE,KAAKyB,iBAAiB,GAG7E/F,KAAKsV,OAAS,KACdtV,KAAKiP,OAAS,EACVjP,KAAKsE,KAAKsB,aACZ5F,KAAK8M,mBAAqB9M,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAEtErV,KAAK8M,kBAAoB,EAE3B9M,KAAKsE,KAAK8B,SAAU,GACXpG,KAAKsE,KAAKsB,cACnBw7C,EAAmBU,kBACjBp+C,EAAK1D,KAAKsE,KAAKjB,eAAe1C,YAC9B0gD,EAAajgD,EAAGigD,EAAahgD,EAC7BrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WACnH3O,KAAKsE,KAAK9D,WACVR,KAAKsE,KAAK8F,SAGRpK,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIy9C,MAAMhmB,cAAgBimB,EAAAA,GAAAA,KAC/EJ,EAAmBK,kCACjB/9C,EAAK1D,KAAKsE,KAAKjB,eAAe1C,YAC9B0gD,EAAajgD,EAAGigD,EAAahgD,EAC7BrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WACnH3O,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,QAChF,GAAM,EACNtV,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK+F,YAGZ62C,EAAsBS,mBACpBj+C,EAAK1D,KAAKsE,KAAKX,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAOimC,IAAIgM,OAAQ5hD,KAAKsE,KAAKjB,eAAe1C,YAC/G0gD,EAAajgD,EAAGigD,EAAahgD,EAC7BrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WACnH3O,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKkP,SAChF,GAAO,EACPlP,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKoB,WACV1F,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,iBACV,GAoBJ/F,KAAKsV,OAAS,KACdtV,KAAK8M,mBAAqB9M,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GACtErV,KAAKiP,OAAS,EACdjP,KAAKsE,KAAK8B,SAAU,GAEhBpG,KAAKsE,KAAK8B,UAAYpG,KAAKsE,KAAK6B,QAG9BnG,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIy9C,MAAMhmB,YAAgBimB,EAAAA,GAAAA,KAoBjFxhD,KAAKiP,QAAU,KACfjP,KAAKsV,MAAQtV,KAAK8M,kBAAoB,EAElC9M,KAAKiP,OAAS,MAChBjP,KAAKsE,KAAK8B,SAAU,IAEZpG,KAAKsE,KAAK6B,SAGhBnG,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIy9C,MAAMhmB,YAAgBimB,EAAAA,GAAAA,KAMjFJ,EAAmBK,kCACjB/9C,EAAK1D,KAAKsE,KAAKjB,eAAe1C,YAC9B0gD,EAAajgD,EAAGigD,EAAahgD,EAC7BrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WACnH3O,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKiP,SAChF,GAAO,EACPjP,KAAKsE,KAAK0C,YAAahH,KAAKsE,KAAK4C,iBAEnClH,KAAKiP,QAAUjP,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAC3DrV,KAAKsV,MAAQtV,KAAK8M,kBAAoB,GAqBtC9M,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIy9C,MAAMhmB,cAAgBimB,EAAAA,GAAAA,KAC/EJ,EAAmBM,0BAA0Bh+C,EAAK1D,KAAKsE,KAAKjB,eAAe1C,YACzE0gD,EAAajgD,EAAGigD,EAAahgD,EAC7BrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WACnH3O,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKkP,SAChF,GAAO,EAAOlP,KAAKsE,KAAK0C,YAAahH,KAAKsE,KAAK+F,WAAYrK,KAAKsE,KAAK8F,QAASpK,KAAKsE,KAAK9D,YAG1F0gD,EAAsBS,mBAAmBj+C,EAAK1D,KAAKsE,KAAKX,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAOimC,IAAIgM,OAAQ5hD,KAAKsE,KAAKjB,eAAe1C,YACtJ0gD,EAAajgD,EAAGigD,EAAahgD,EAC7BrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WACnH3O,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKkP,SAChF,GAAO,EAAOlP,KAAKsE,KAAK0C,YAAahH,KAAKsE,KAAK4C,gBAAiBlH,KAAKsE,KAAKoB,WAAY1F,KAAKsE,KAAKsB,aAAc5F,KAAKsE,KAAKyB,iBAK5H/F,KAAKoV,IAAM,EACXpV,KAAKkP,QAA2D,GAAjDlP,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAEvDrV,KAAKkP,OAAS,MAChBlP,KAAKsE,KAAKqC,QAAS,IAYvB3G,KAAK+hD,YAAYr+C,EAAK29C,EAAajgD,EAAGigD,EAAahgD,GAE/CrB,KAAKsE,KAAK6G,UAAYnL,KAAKsE,KAAK2G,QAClCjL,KAAKsE,KAAKsP,eAEZ5T,KAAKsE,KAAKiG,GAAKvK,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAEvDrV,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIy9C,MAAMhmB,cAAgBimB,EAAAA,GAAAA,KAC/ExhD,KAAKgiD,4BAA4BhiD,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAAc2/B,EAAajgD,EAAGigD,EAAahgD,EAAGrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,YAE9O3O,KAAKiiD,gBAAgBZ,EAAajgD,EAAGigD,EAAahgD,EAEtD,CACO0gD,YAAYr+C,EAA+BtC,EAAWC,GAC3D,MAAMwD,EAAQ7E,KAAK0B,IAAI2B,eAAe1C,YAAYgO,WAAa3O,KAAK0B,IAAI2B,eAAe1C,YAAYiN,YAC7Fs0C,EAAO,UAAMliD,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAOumC,SAAWrxC,EAAK,cAAO7E,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAOsmC,YAC9NvyC,EAAI3D,KAAOmiD,EAQXx+C,EAAI8b,UAAY,SAEhB9b,EAAIM,UAAYhE,KAAKsE,KAAKjB,eAAe20C,UACrCh4C,KAAKsE,KAAKX,MAAMC,mBAAmBC,gBAAgBC,IAAIy9C,MAAMhmB,cAAgBimB,EAAAA,GAAAA,KAC/E99C,EAAIkB,SAAS5E,KAAKsE,KAAK69C,WAAWpvC,WAAY3R,EAAGC,EAAK,GAAKwD,EAAS,IAEpEnB,EAAIkB,SAAS5E,KAAKsE,KAAK69C,WAAWpvC,WAAY3R,EAAGC,EAAK,GAAKwD,EAAS,GAExE,CACUo9C,gBAAgB7gD,EAAWC,GACnC,MAAM+gD,GAAYC,EAAAA,EAAAA,MAClBC,GACEtiD,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAC5C,CAACtgB,EAAGC,GAAI+gD,EAAUR,OAClB5hD,KAAK0B,IAAIyG,UACTnI,KAAK0B,IAAIiC,MAAMC,mBAAmB4H,wBAAwBoC,YAAc5N,KAAK0B,IAAI2B,eAAe1C,YAAYgO,YAAY,OAAc,GAE1I,CACUqzC,4BAA4Bt+C,EAA+BtC,EAAWC,EAAWwD,GACzF,MAAMtB,EAASvD,KAAKsE,KAAKX,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAOpM,OAASsB,EAC7FnB,EAAIM,UAAYhE,KAAK0B,IAAIyG,UACzBzE,EAAIO,YACJP,EAAIe,IAAIrD,EAAGC,EAAa,GAATkC,EAAuB,GAATA,EAAc,EAAa,EAAV+O,KAAK8Y,IACnD1nB,EAAIS,YACJT,EAAIU,MACN,EAGK,MAAMk+C,GAAwB,SAAC5+C,EAA+Bc,EAAek7C,EAAcp0B,GAAqF,IAAtEzmB,EAAa,uDAAG,EAAG0nB,EAAY,wDAAG,EAAYC,EAAY,wDAAI,GAC7K9oB,EAAIM,UAAYsnB,EAChB5nB,EAAI+nC,OACJ/nC,EAAI6P,UAAU/O,EAAI,GAAK+nB,EAAO1nB,EAAOL,EAAI,GAAKgoB,EAAO3nB,GACrDnB,EAAImB,MAAMA,EAAOA,GACjBnB,EAAIU,KAAKs7C,GACTh8C,EAAIgoC,SACN,E,IC3RK6W,G,YCfE,MAAMrnC,WAAuBM,EAGlC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KAHNA,SAAG,OACHs2C,UAAoB,OAGzBh4C,KAAKmO,cACLnO,KAAK0K,aACP,CACOyD,cACAnO,KAAKob,WACRpb,KAAK+W,MAAMC,aAAeM,EAAa+T,aACvCrrB,KAAKob,UAAW,EAChBjD,EAAYqqC,wBACVxiD,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,eAGpD1P,KAAKyiD,iBACP,CACO/3C,cAAsD,IAA1C4gB,EAA2B,4DAAG3oB,EAC/C3C,KAAKob,UAAW,OACFzY,IAAV2oB,IACFA,EAAQtrB,KAAK0B,IAAIiC,MAAMC,mBAAmB4H,wBAAwB+f,sBAAsBC,aAE1FrT,EAAYuqC,wBACV1iD,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD4b,GAEFtrB,KAAKqb,cAAgBiQ,EACrBtrB,KAAKyiD,iBACP,CAEOp0C,kBAAkBzC,GAIvB,IAAI/E,GAAW,EA+Bf,OA7BI+E,EAAM1B,OACRlK,KAAK0B,IAAIwI,KAAO0B,EAAM1B,KAAK4vB,cAC3BjzB,GAAW,GAET+E,EAAMtI,QACRtD,KAAK+W,MAAMzT,MAAQsI,EAAMtI,YAEPX,IAAhBiJ,EAAM0f,QACRtrB,KAAK+W,MAAMC,aAAepL,EAAM0f,OAG9B1f,EAAM6N,UAAUvY,OAAS,IAC3BlB,KAAKqb,cAAgBzP,EAAM6N,UAC3BtB,EAAYwqC,8BACV3iD,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD9D,EAAM6N,YAGN7N,EAAM/G,QACR7E,KAAKW,YAAYgO,WAAa/C,EAAM/G,MACpC7E,KAAK+W,MAAMlS,MAAQ+G,EAAM/G,OAE3B7E,KAAKob,UAAW,EACZvU,IAAa7G,KAAK0B,IAAIyF,sBACxBnH,KAAK0B,IAAIiD,aAAc,GAGzB3E,KAAKyiD,mBACE,CACT,CAEOhvC,SACL,IAAKzT,KAAKob,SACR,OAGF,MAAMyQ,EAAc,CAClBvoB,MAAOtD,KAAK+W,MAAMzT,MAClBuB,MAAO7E,KAAKW,YAAYgO,WACxB8K,UAAWzZ,KAAKqb,cAChBunC,OAAQ5iD,KAAK0B,IAAIygD,YAanB,OAXIniD,KAAKW,YAAYuJ,OAASvB,EAAAA,GAAAA,SAC5BkjB,EAAO3hB,KAAOlK,KAAKW,YAAYuJ,KAAK24C,eAGlC7iD,KAAK+W,MAAMC,eAAiBM,EAAa+T,eAC3CQ,EAAOP,MAAQtrB,KAAK+W,MAAMC,cAMrB6U,CACT,CAEUtQ,YAAY3P,GACpB,GAAIA,EAAM6N,UAAUvY,SAAWlB,KAAKqb,cAAcna,OAChD,IAAK,IAAID,EAAI,EAAGA,EAAI2K,EAAM6N,UAAUvY,OAAQD,IAC1C,GAAI2K,EAAM6N,UAAUxY,KAAOjB,KAAKqb,cAAcpa,GAC5C,OAAO,EAIb,OAAO,CACT,CACQwhD,kBACNziD,KAAKg4C,WAAY8K,EAAAA,GAAAA,IAAc9iD,KAAKW,YAAY4Z,UAClD,EC/GK,MAAMuR,WAAgCC,EAG3ClsB,YAAY6B,GACVwD,MAAMxD,GAAK,KAHNA,SAAG,OACHwB,OAAC,EAGNlD,KAAK0B,IAAMA,CACb,CACOwR,0BAA0B5F,GAC/B,CAEKiG,UAAUnS,EAAWC,GAC1B,ECAG,MAAM0hD,WAA8B9xC,EAsBzC,mBAA0BtN,EAAcvC,EAAWC,GACjD,IAAK,IAAIJ,EAAI0C,EAAMq/C,WAAW9hD,OAAS,EAAGD,GAAK,IAAKA,EAClD,GACE0C,EAAMq/C,WAAW9hD,OAAOD,GAAG+E,cAC3BrC,EAAMq/C,WAAW9hD,OAAOD,GAAGgiD,cAAc7hD,EAAGC,GAE5C,OAAOsC,EAAMq/C,WAAW9hD,OAAOD,EAIrC,CACA,0BAAiC0C,GAC/B,IAAI1C,EAAI0C,EAAMq/C,WAAW9hD,OACrB6gB,EAAQ,EACZ,KAAO9gB,KACD0C,EAAMq/C,WAAW/hD,GAAGT,aACtBuhB,GAAS,GAGb,OAAOA,CACT,CACA,4BAAmCpe,GACjC,MAAMyY,EAAOzY,EAAMq/C,WACnB,IAAK,IAAI/hD,EAAI,EAAGA,EAAImb,EAAKlb,SAAUD,GACW,IAAxC0C,EAAMq/C,WAAW/hD,GAAG8E,iBACtBpC,EAAMq/C,WAAW/hD,GAAGwP,QAG1B,CACA,+BAAsC9M,GACpC,IAAK,IAAI1C,EAAI,EAAGA,EAAI0C,EAAMq/C,WAAW9hD,SAAUD,EAC7C0C,EAAMq/C,WAAW/hD,GAAG8E,iBAAkB,CAE1C,CACA,uBAA8BpC,EAAc2J,GAC1C,IAAK,IAAIrM,EAAI,EAAGA,EAAI0C,EAAMq/C,WAAW9hD,SAAUD,GACD,IAAxC0C,EAAMq/C,WAAW/hD,GAAG8E,iBAA6BpC,EAAMq/C,WAAW/hD,GAAG2E,cACvEjC,EAAMq/C,WAAW/hD,GAAGiS,0BAA0B5F,IAEP,IAArC3J,EAAMq/C,WAAW/hD,GAAG2E,cACtBjC,EAAMq/C,WAAW/hD,GAAGiS,0BAA0B5F,EAGpD,CACA,gBAAuB3J,EAAc0M,GAAoD,IAArCtJ,EAAM,wDAAUuV,EAAU,wDAC5E,MAAMkK,EAAK,CAACnW,EAAEzP,MAAM,GAAGV,GAAImQ,EAAEzP,MAAM,GAAGT,IAChC4vB,EAAK,IAAIgzB,GAAsBp/C,EAAO6iB,EAAG,GAAIA,EAAG,GAAI,EAAGzf,GAmB7D,OAlBAgpB,EAAGxvB,KAAO6L,EAAAA,GAAMiE,EAAE9P,MAGhBwvB,EAAGzvB,GADDgc,EACM3Y,EAAMsF,UAENoH,EAAE/P,GAEZyvB,EAAG1pB,cAAgBgK,EAAE3P,SACjB2P,EAAE3P,SACJqvB,EAAG7oB,gBAAkB,EAErB6oB,EAAG7oB,gBAAkB,EAEnBmJ,EAAExP,QACJkvB,EAAG1hB,kBAAkBgC,EAAExP,QAGzBkvB,EAAGjgB,kBACIigB,CACT,CAEA,uBAA8BziB,GACvB,CAEP,wBAA+BA,GACxB,CAEP,sBAA6B3J,EAAc2J,GACzC,QAAsB3K,IAAlBgB,EAAMgP,QACR,OAEQ,IAAIowC,GAAsBp/C,EAAO2J,EAAElM,EAAGkM,EAAEjM,EAAG,GACnDiP,QACE3M,EAAMC,mBAAmB4H,wBAAwB8C,aAAayQ,YAGlEpb,EAAMC,mBAAmB4H,wBAAwBgX,YACnD,CACA3iB,YAAY8D,GAAoL,IAAtKvC,EAAC,uDAAG,EAAGC,EAAC,uDAAG,EAAGC,EAAC,uDAAG,EAAGyF,EAAM,wDAAUxG,EAAW,uDAAG6L,EAAAA,GAAAA,eAAgG,2CAAGyJ,EAAAA,GAAAA,MAC9K3Q,MAAMvB,EAAOvC,EAAGC,EAAGC,EAAGf,GAAM,KA3GvB8C,oBAAc,OAEd8B,cAAQ,OACRwC,OAAC,OACD/E,SAAG,OACH8E,UAAI,OACJyJ,aAAO,OACPC,aAAO,OACP7Q,UAAI,OAEJiR,WAAK,OACLC,gBAAU,OACVC,gBAAU,OACVC,iBAAW,OACXpH,OAAC,OACDwzC,SAAG,OACHmF,mBAAoB,EAAK,KACzBC,QAAU,IAAIC,OAAO,gGAAgG,KACpHC,cAAgB,EAAE,KAClBC,cAAgB,CAAC,EAAG,EAAG,EAAG,GAyFhCtjD,KAAKO,KAAOA,EACZP,KAAK+G,OAASA,EACd/G,KAAKujD,YAAcvjD,KAAK2D,MAAMq/C,WAAW9hD,OAAS,EAElD,MAAMsiD,EAAYxjD,KAAKmI,UAAU6e,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,KACnEhnB,KAAKsjD,cAAgB,EAAEE,EAAU,IAAKA,EAAU,IAAKA,EAAU,IAG/DxjD,KAAKyjD,gBACL9/C,EAAM+/C,UAAU1jD,MAEZA,KAAK+G,QAGTpD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiB9Q,KAAKwJ,SAC5E,CACOi6C,gBACLzjD,KAAKqD,eAAiB,IAAI6X,GAAelb,MACzCA,KAAKmF,SAAW,IAAIqQ,GAAkBxV,MACtCA,KAAKoF,eAAiB,IAAI0mB,GAAwB9rB,MAClDA,KAAKqF,YAAc,IAAIsjB,GAAqB3oB,KAC9C,CACO8R,OACL9R,KAAK8F,UAAW,EAEhB9F,KAAKuR,MAAQ,GACbvR,KAAKyR,YAAa,EAElBzR,KAAKuK,EAAI,CACX,CACOsI,cAAczR,EAAWC,GAC9B,GAAIrB,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,cAC9C,OAAO,EAET,GAAIrG,KAAK+C,WACP,OAAO,EAkBP,OALgB/C,KAAK2D,MAAMC,mBAAmBuS,eAAe2M,eAAe6gC,oCAC1EviD,EAAIpB,KAAK2D,MAAMC,mBAAmBuB,SAASqwB,aAAa7xB,MAAM0lB,cAAcC,mBAAmBloB,EAC/FC,EAAIrB,KAAK2D,MAAMC,mBAAmBuB,SAASqwB,aAAa7xB,MAAM0lB,cAAcC,mBAAmBjoB,EAC/FrB,KAAKsjD,cAIX,CACOM,2BAA2BxiD,EAAWC,EAAWwiD,GACtD,GAAI7jD,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,cAC9C,OAAO,EAET,GAAIrG,KAAK+C,WACP,OAAO,EAIT,OADY/C,KAAKqS,SAASjR,EAAGC,EAAI,GAAKrB,KAAKqI,iBAC7BrI,KAAK2H,EAAI3H,KAAKqI,eAAiB,GAAKrI,KAAKqI,eAAiBw7C,CAC1E,CACOzxC,gBACL,MAAO,2BACT,CAEO3B,SAAyB,IAAlB5J,IAAQ,yDASpB,GANA7G,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EAChBhC,KAAK8H,eACP9H,KAAK4M,mBAGH/F,EAAU,CACZ,MAAMuX,EAAQpe,KAAKwJ,SACf4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB,CAACvG,GAElF,CACIpe,KAAKsK,iBACPtK,KAAKsK,eAAegU,wBACpBte,KAAKsK,oBAAiB3H,GAGxB3C,KAAK2D,MAAM4a,gBAAgBve,MAC3BA,KAAK2D,MAAMmgD,aAAa9jD,MACxBA,KAAK2D,MAAM8a,eAAeze,KAC5B,CACOmiD,WACL,OAAOniD,KAAK2D,MAAMq/C,WAAWvwC,QAAQzS,MAAQ,CAC/C,CACO+P,SAAS3O,EAAWC,GACzB,OAAO,IAAI0hD,GAAsB/iD,KAAK2D,MAAOvC,EAAGC,EAAGrB,KAAK4C,IAAItB,GAAG,EAAOtB,KAAKO,KAAMP,KAAK2H,EACxF,CAEWnH,iBACT,OAAOR,KAAK+F,eACd,CACWvF,eAAW0C,GACpBlD,KAAK+F,gBAAkB7C,EACvBlD,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2c,eAAe3mB,KAAKwJ,SAC/E,CACWY,cACT,OAAOpK,KAAK4F,YACd,CACWwE,YAAQlH,GAEjBlD,KAAK4F,aAAe1C,GAChBlD,KAAK4F,eAAiB5F,KAAK6F,aAEnB7F,KAAK4F,cAAgB5F,KAAK6F,aADpC7F,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB4c,WAAW5mB,KAAKwJ,UAI3ExJ,KAAK6F,WAAa7F,KAAK4F,aAClB1C,IACHlD,KAAK8G,mBAAoB,EACzB9G,KAAK4M,mBAET,CAEO8D,iBAGL1Q,KAAK2D,MAAMC,mBAAmBuS,eAAe2M,eAAe+D,iBAC5D7mB,KAAKuL,kBACP,CACOqI,eACD5T,KAAKkI,QACPlI,KAAKkI,MAAM0D,MAAMU,IACftM,KAAK4C,IAAIvB,EACT,GAAKrB,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,MACrE,KACF7E,KAAKkI,MAAM0D,MAAMW,KACfvM,KAAK4C,IAAIxB,EACT,GAAKpB,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,MACrE,KAEN,CACO2K,WAAW9L,GAChB1D,KAAKmF,SAASqK,WAAW9L,GACrB1D,KAAK2D,MAAMC,mBAAmBC,gBAAgBC,IAAIC,YACpD/D,KAAKgF,UAAUvB,OAAOC,EAE1B,CACO8F,SACL,GACExJ,KAAKO,OAAS6L,EAAAA,GAAAA,OACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,cACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,WACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,QACdpM,KAAKO,OAAS6L,EAAAA,GAAAA,WAEd,OAEF,MAAM3C,EAAI,IAAIpJ,EACZL,KAAKM,GACLN,KAAKO,KACLP,KAAK+F,gBACL/F,KAAK4F,aACL5F,KAAKqG,eAEPoD,EAAE1I,SAASf,KAAKoJ,WAKhB,MAAMvI,EAASb,KAAKqD,eAAeoQ,SAKnC,OAJI5S,IACF4I,EAAE5I,OAASA,GAGN4I,CACT,CACW85C,kBACT,OAAOvjD,KAAKqjD,YACd,CACWE,gBAAYrgD,GACrBlD,KAAKqjD,aAAengD,CAEtB,CACO4K,oBAEL9N,KAAKgF,UAAU/B,OAAS,IAAIZ,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAI,GAAIpB,KAAK4C,IAAIvB,EAAI,IACnErB,KAAKgF,UAAU7B,OAAS,IAAId,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAI,GAAIpB,KAAK4C,IAAIvB,EAAI,EAErE,CACOkK,mBACAvL,KAAK2D,MAAMC,mBAAmB4H,wBAAwBC,cAKvDzL,KAAK8H,eAAiB9H,KAAKkI,OAASlI,KAAKuF,UAK7CvF,KAAK8H,eAAgB,EACrB9H,KAAKkI,MAAQwD,SAASC,cAAc,OACpC3L,KAAKkI,MAAM5H,GAAK,MAAQN,KAAKM,GAC7BN,KAAKkI,MAAM0D,MAAMC,SAAW,WAC5B7L,KAAKkI,MAAM0D,MAAMm4C,cAAgB,OAMjC/jD,KAAK2D,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAIC,YAC3EnM,KAAKkI,OAGPlI,KAAKkI,MAAM0D,MAAMrI,OACyD,GAAxEvD,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,MAAa,KAC/E7E,KAAKkI,MAAM0D,MAAMtI,MACyD,GAAxEtD,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,MAAa,KAE/E7E,KAAKkI,MAAM0D,MAAMU,IACftM,KAAK4C,IAAIvB,EACT,GAAKrB,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,MACrE,KACF7E,KAAKkI,MAAM0D,MAAMW,KACfvM,KAAK4C,IAAIxB,EACT,GAAKpB,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,MACrE,KAEE7E,KAAK8I,qBACP0D,aAAaxM,KAAK8I,qBAEpB9I,KAAK8I,oBAAsB2D,YAAW,KAChCzM,KAAKkI,OACPlI,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB0C,eAAe1M,KAAKwJ,SAC/E,GACCxJ,KAAKuI,iBACV,CACO8G,cACDrP,KAAK8H,oBAAgCnF,IAAf3C,KAAKkI,QACzBlI,KAAKgI,eACPhI,KAAKkI,MAAM0D,MAAMU,IACftM,KAAK4C,IAAIvB,EACTrB,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAOpM,OAChEvD,KAAKiI,iBACL,KACFjI,KAAKkI,MAAM0D,MAAMW,KAAOvM,KAAK4C,IAAIxB,EAAI,OAErCpB,KAAKkI,MAAM0D,MAAMU,IACftM,KAAK4C,IAAIvB,EACT,GAAKrB,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,MACrE,KACF7E,KAAKkI,MAAM0D,MAAMW,KACfvM,KAAK4C,IAAIxB,EACT,GAAKpB,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,MACrE,MAGR,CACO+H,mBAIL,GACE5M,KAAKkI,OACLlI,KAAKkI,MAAM2E,YACX7M,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAa01C,UAEnE,CAKA,GAFAhkD,KAAKmF,SAAS2H,kBAAoB,EAClC9M,KAAKkI,MAAM2E,WAAWE,YAAY/M,KAAKkI,OACnClI,KAAKO,OAAS6L,EAAAA,GAAAA,MAAa,CAC7B,MAAM3C,EAAI,IAAIpJ,EACZL,KAAKM,GACLN,KAAKO,KACLP,KAAK+F,gBACL/F,KAAK4F,aACL5F,KAAKqG,eAEPoD,EAAE1I,SAASf,KAAKoJ,WAChBpJ,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBgD,eAAevD,EAC1E,MACEzJ,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwBgD,eAAehN,KAAKwJ,UAE/ExJ,KAAK+H,aAAc,EACnB/H,KAAKkI,WAAQvF,EACb3C,KAAK8H,eAAgB,CACvB,CAEF,EC/ZK,MAAM6gB,GAGX9oB,YAAY6B,GAA4B,KAFjCA,SAAG,OACFoH,yBAAmB,EAEzB9I,KAAK0B,IAAMA,CACb,CACOmR,cAAczR,EAAWC,GAC9B,GAAIrB,KAAK0B,IAAIiE,WAAa3F,KAAK0B,IAAIM,cAAgBhC,KAAK0B,IAAI2E,cAC1D,OAAO,EAET,GAAIrG,KAAK0B,IAAIqB,WACX,OAAO,EAQT,GACE/C,KAAK0B,IAAIiC,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAAegrB,eACxEC,SACH,CAQA,OAPY7zB,EAAAA,EAAAA,IACV,IAAI7K,EAAAA,GAASjB,EAAGC,GAChB,IAAIgB,EAAAA,GACFrC,KAAK0B,IAAIkB,IAAIxB,EACbpB,KAAK0B,IAAIkB,IAAIvB,EAAkE,IAA7DrB,KAAK0B,IAAIsD,UAAU7B,OAAO9B,EAAIrB,KAAK0B,IAAIsD,UAAU/B,OAAO5B,KAGpE,EAIZ,CAOA,OALaiyC,EAAAA,EAAAA,IACX,IAAIjxC,EAAAA,GAASjB,EAAGC,GAChBrB,KAAK0B,IAAIsD,UAAU/B,OACnBjD,KAAK0B,IAAIsD,UAAU7B,OAGvB,CACO2P,SACL,MAAO,EACT,CACOG,OACL,CAEKW,eACL,GAAI5T,KAAK0B,IAAIwG,MACX,OAAQlI,KAAK0B,IAAIyD,SAAS8+C,iBACxB,KAAKC,EAAAA,GAAAA,QACHlkD,KAAK0B,IAAIwG,MAAM0D,MAAMU,IAAMtM,KAAK0B,IAAIkB,IAAIvB,EAAI,GAAK,KACjDrB,KAAK0B,IAAIwG,MAAM0D,MAAMW,KAAOvM,KAAK0B,IAAIkB,IAAIxB,EAAI,GAAK,KAClD,MACF,KAAK8iD,EAAAA,GAAAA,MACHlkD,KAAK0B,IAAIwG,MAAM0D,MAAMU,IAAMtM,KAAK0B,IAAIkB,IAAIvB,EAAI,KAC5CrB,KAAK0B,IAAIwG,MAAM0D,MAAMW,KACnBvM,KAAK0B,IAAIkB,IAAIxB,EAAwC,GAApCpB,KAAK0B,IAAI2B,eAAe06C,IAAIz6C,MAAc,EAAI,KAMzE,CACOiI,mBACL,GAAKvL,KAAK0B,IAAIiC,MAAMC,mBAAmB4H,wBAAwBC,cAK3DzL,KAAK0B,IAAIyJ,WAAYnL,KAAK0B,IAAI6D,QAAlC,CAgBA,OAXAvF,KAAK0B,IAAIyJ,UAAW,EACpBnL,KAAK0B,IAAIwG,MAAQwD,SAASC,cAAc,OACxC3L,KAAK0B,IAAIwG,MAAM5H,GAAK,MAAQN,KAAK0B,IAAIpB,GACrCN,KAAK0B,IAAIwG,MAAM0D,MAAMC,SAAW,WAChC7L,KAAK0B,IAAIwG,MAAM0D,MAAMm4C,cAAgB,OAGrC/jD,KAAK0B,IAAIiC,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAIC,YAC/EnM,KAAK0B,IAAIwG,OAGHlI,KAAK0B,IAAIyD,SAAS8+C,iBACxB,KAAKC,EAAAA,GAAAA,QAC+E,IAA9ElkD,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,OACtE7E,KAAK0B,IAAIwG,MAAM0D,MAAMrI,OAAS,OAC9BvD,KAAK0B,IAAIwG,MAAM0D,MAAMtI,MAAQ,OAC7BtD,KAAK0B,IAAIwG,MAAM0D,MAAMU,IAAMtM,KAAK0B,IAAIkB,IAAIvB,EAAI,GAAK,KACjDrB,KAAK0B,IAAIwG,MAAM0D,MAAMW,KAAOvM,KAAK0B,IAAIkB,IAAIxB,EAAI,GAAK,OAElDpB,KAAK0B,IAAIwG,MAAM0D,MAAMrI,OACnB,GAAKvD,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,MAAQ,KACnF7E,KAAK0B,IAAIwG,MAAM0D,MAAMtI,MACnB,GAAKtD,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,MAAQ,KACnF7E,KAAK0B,IAAIwG,MAAM0D,MAAMU,IACnBtM,KAAK0B,IAAIkB,IAAIvB,EACb,GAAKrB,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,MACzE,KACF7E,KAAK0B,IAAIwG,MAAM0D,MAAMW,KACnBvM,KAAK0B,IAAIkB,IAAIxB,EACb,GAAKpB,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,MACzE,EACA,MAEJ,MACF,KAAKq/C,EAAAA,GAAAA,MACHlkD,KAAK0B,IAAIwG,MAAM0D,MAAMU,IAAMtM,KAAK0B,IAAIkB,IAAIvB,EAAI,KAC5CrB,KAAK0B,IAAIwG,MAAM0D,MAAMW,KACnBvM,KAAK0B,IAAIkB,IAAIxB,EAAwC,GAApCpB,KAAK0B,IAAI2B,eAAe06C,IAAIz6C,MAAc,EAAI,KAKjEtD,KAAK8I,qBACP0D,aAAaxM,KAAK8I,qBAEpB9I,KAAK8I,oBAAsB2D,YAAW,KAChCzM,KAAK0B,IAAIwG,OACXlI,KAAK0B,IAAIiC,MAAMC,mBAAmBmG,GAAGC,wBAAwB0C,eAC3D1M,KAAK0B,IAAI8H,SAEb,GACC,IAtDH,CAuDF,CACO6F,cACL,GAAIrP,KAAK0B,IAAIyJ,eAA+BxI,IAAnB3C,KAAK0B,IAAIwG,MAChC,OAAQlI,KAAK0B,IAAIyD,SAAS8+C,iBACxB,KAAKC,EAAAA,GAAAA,QACClkD,KAAK0B,IAAIsG,eACXhI,KAAK0B,IAAIwG,MAAM0D,MAAMU,IACnBtM,KAAK0B,IAAIkB,IAAIvB,EACbrB,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAOpM,OACpEvD,KAAK0B,IAAIuG,iBACT,KACFjI,KAAK0B,IAAIwG,MAAM0D,MAAMW,KAAOvM,KAAK0B,IAAIkB,IAAIxB,EAAI,MAEqC,IAA9EpB,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,OACtE7E,KAAK0B,IAAIwG,MAAM0D,MAAMU,IAAMtM,KAAK0B,IAAIkB,IAAIvB,EAAI,GAAK,KACjDrB,KAAK0B,IAAIwG,MAAM0D,MAAMW,KAAOvM,KAAK0B,IAAIkB,IAAIxB,EAAI,GAAK,OAElDpB,KAAK0B,IAAIwG,MAAM0D,MAAMU,IACnBtM,KAAK0B,IAAIkB,IAAIvB,EACb,GAAKrB,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,MACzE,KACF7E,KAAK0B,IAAIwG,MAAM0D,MAAMW,KACnBvM,KAAK0B,IAAIkB,IAAIxB,EACb,GAAKpB,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAAaC,OAAO9K,MACzE,EACA,MAGN,MACF,KAAKq/C,EAAAA,GAAAA,MACHlkD,KAAK0B,IAAIwG,MAAM0D,MAAMU,IAAMtM,KAAK0B,IAAIkB,IAAIvB,EAAI,KAC5CrB,KAAK0B,IAAIwG,MAAM0D,MAAMW,KACnBvM,KAAK0B,IAAIkB,IAAIxB,EAAwC,GAApCpB,KAAK0B,IAAI2B,eAAe06C,IAAIz6C,MAAc,EAAI,KAMzE,ECvKK,MAAMkS,WAA0BE,EAErC7V,YAAYyE,GACVY,MAAMZ,GAAM,KAFPA,UAAI,EAGTtE,KAAKsE,KAAOA,CACd,CACOkL,WAAW9L,GAMhB,GALA1D,KAAKsE,KAAK8D,UAAU5E,OAAOE,GAC3B1D,KAAKmU,iBAAiB3Q,SAEtBxD,KAAKsE,KAAK+D,eAAiB,EAEvBrI,KAAKsE,KAAKvB,WACZ,OAEF,GAAI/C,KAAKsE,KAAK+D,eAAiB,IAC7B,OASF,MAAM+4C,EAAqBphD,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMqU,MAG9E5qB,KAAKsE,KAAK6B,QAEZi7C,EAAmB+C,0BACjBzgD,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,EACdrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,YACtF5N,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKoV,MAChF,GACA,EACApV,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKoB,WACV1F,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,iBAEZ/F,KAAKoV,KAAO,KACZpV,KAAKkP,OAAS,IAEVlP,KAAKsE,KAAKyB,iBACZq7C,EAAmBgD,aACjB1gD,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,EACdrB,KAAKsE,KAAK9D,WACVR,KAAKsE,KAAK8F,SAGZg3C,EAAmBiD,0CACjB3gD,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,EACdrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,YACtF5N,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,QAChF,GACA,EACAtV,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKoB,YAEZ1F,KAAKsV,OAAS,KACdtV,KAAKiP,OAAS,EACVjP,KAAKsE,KAAKsB,aACZ5F,KAAK8M,mBAAqB9M,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAEtErV,KAAK8M,kBAAoB,EAE3B9M,KAAKsE,KAAK8B,SAAU,GACXpG,KAAKsE,KAAKsB,cACnBw7C,EAAmBkD,kBACjB5gD,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,EACdrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,YACtF5N,KAAKsE,KAAK9D,WACVR,KAAKsE,KAAK8F,SAIZg3C,EAAmBmD,kCACjB7gD,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,EACdrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,YACtF5N,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,QAChF,GACA,EACAtV,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKoB,YAEZ1F,KAAKsV,OAAS,KACdtV,KAAK8M,mBAAqB9M,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GACtErV,KAAKiP,OAAS,EACdjP,KAAKsE,KAAK8B,SAAU,GAEhBpG,KAAKsE,KAAK8B,UAAYpG,KAAKsE,KAAK6B,QAElCi7C,EAAmBmD,kCACjB7gD,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,EACdrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,YACtF5N,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKiP,SAChF,GACA,EACAjP,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKoB,YAEZ1F,KAAKiP,QAAUjP,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAC3DrV,KAAKsV,MAAQtV,KAAK8M,kBAAoB,EAElC9M,KAAKiP,OAAS,MAChBjP,KAAKsE,KAAK8B,SAAU,IAEZpG,KAAKsE,KAAK6B,SAEpBi7C,EAAmBmD,kCACjB7gD,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,EACdrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,YACtF5N,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKiP,SAChF,GACA,EACAjP,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKoB,YAEZ1F,KAAKiP,QAAUjP,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAC3DrV,KAAKsV,MAAQtV,KAAK8M,kBAAoB,GAI1Cs0C,EAAmB+C,0BACjBzgD,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,EACdrB,KAAKsE,KAAK+D,eAAiBrI,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBoC,YACtF5N,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKkP,SAChF,GACA,EACAlP,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKoB,WACV1F,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,iBAEZ/F,KAAKoV,IAAM,EACXpV,KAAKkP,QAA2D,GAAjDlP,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,IAMzDrV,KAAKsE,KAAK6G,UAAYnL,KAAKsE,KAAK2G,QAClCjL,KAAKsE,KAAKsP,eAEZ5T,KAAKuK,GAAKvK,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAWtDrV,KAAKiiD,iBACP,CACUA,kBAGRjiD,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASqc,UAAUgjC,gBACpDxkD,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAC5C1hB,KAAKsE,KAAK6D,UACVnI,KAAKsE,KAAK1B,IACV5C,KAAKsE,KAAK+D,eAEd,ECpMK,MAAMo8C,WAAiC/uC,GAI5C7V,YAAYyE,GACVY,MAAMZ,GAAM,KAJPA,UAAI,OACJ2/C,qBAAe,EAIpBjkD,KAAKsE,KAAOA,EACZtE,KAAKikD,gBAAkBC,EAAAA,GAAAA,OACzB,CACO10C,WAAW9L,GAIhB,GAHA1D,KAAKsE,KAAK8D,UAAU5E,OAAOE,GAC3B1D,KAAKmU,iBAAiB3Q,UAElBxD,KAAKsE,KAAKvB,cAGV/C,KAAKsE,KAAK+D,eAAiB,KAA/B,CAkBA,OAHIrI,KAAKsE,KAAK6G,UAAYnL,KAAKsE,KAAK2G,QAClCjL,KAAKsE,KAAKsP,eAEJ5T,KAAKikD,iBACX,KAAKC,EAAAA,GAAAA,QACHlkD,KAAK0kD,aAAahhD,GAClB,MACF,KAAKwgD,EAAAA,GAAAA,MACHlkD,KAAK2kD,gBAAgBjhD,GAazB1D,KAAKuK,GAAKvK,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GACtDrV,KAAKiiD,iBAnCL,CAoCF,CAEQyC,aAAahhD,GACnB,MAAMkhD,EAA4B5kD,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMsuC,aACnFzD,EAAqBphD,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMqU,MAE5Ey2B,EAAerhD,KAAKsE,KAAKX,MAAMC,mBAAmBuS,eAAeC,eAAeC,sBAAsBrW,KAAKsE,KAAK1B,KAEhHyF,EAAiBrI,KAAKsE,KAAKjB,eAAe1C,YAAYiN,YAAc5N,KAAKsE,KAAKjB,eAAe1C,YAAYgO,WAE/G3O,KAAK0B,IAAIsD,UAAU5B,cAAciF,GAE7BrI,KAAKsE,KAAK6B,QAEZi7C,EAAmBgD,aAAc1gD,EAAK1D,KAAKsE,KAAKjB,eAAe1C,YAAa0gD,EAAajgD,EAAGigD,EAAahgD,EAAGrB,KAAKsE,KAAK9D,WAAYR,KAAKsE,KAAK8F,SAC5Iw6C,EAA0BE,iCAAiCphD,EAAK1D,KAAKikD,gBAAiBjkD,KAAKsE,KAAKjB,eAAe1C,YAAa0gD,EAAajgD,EAAGigD,EAAahgD,EAAGgH,EAAgBrI,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,QAAQ,GAAM,EAAMtV,KAAKsE,KAAK0C,YAAahH,KAAKsE,KAAK4C,gBAAiBlH,KAAKsE,KAAKoB,YAC5Uk/C,EAA0BG,iBAAiBrhD,EAAK1D,KAAKikD,gBAAiBjkD,KAAKsE,KAAKjB,eAAe1C,YAAa0gD,EAAajgD,EAAGigD,EAAahgD,EAAGgH,EAAgBrI,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKoV,MAAM,GAAM,EAAMpV,KAAKsE,KAAK0C,YAAahH,KAAKsE,KAAK4C,gBAAiBlH,KAAKsE,KAAKoB,WAAY1F,KAAKsE,KAAKsB,aAAc5F,KAAKsE,KAAKyB,iBACxW/F,KAAKoV,KAAO,KACZpV,KAAKkP,OAAS,IAEVlP,KAAKsE,KAAKyB,iBACZq7C,EAAmBgD,aAAc1gD,EAAK1D,KAAKsE,KAAKjB,eAAe1C,YAAa0gD,EAAajgD,EAAGigD,EAAahgD,EAAGrB,KAAKsE,KAAK9D,WAAYR,KAAKsE,KAAK8F,SAE5Iw6C,EAA0BE,iCAAiCphD,EAAK1D,KAAKikD,gBAAiBjkD,KAAKsE,KAAKjB,eAAe1C,YAAa0gD,EAAajgD,EAAGigD,EAAahgD,EAAGgH,EAAgBrI,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,QAAQ,GAAM,EAAMtV,KAAKsE,KAAK0C,YAAahH,KAAKsE,KAAK4C,gBAAiBlH,KAAKsE,KAAKoB,YAC5U1F,KAAKsV,OAAS,KACdtV,KAAKiP,OAAS,EACVjP,KAAKsE,KAAKsB,aACZ5F,KAAK8M,mBAAqB9M,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAEtErV,KAAK8M,kBAAoB,EAE3B9M,KAAKsE,KAAK8B,SAAU,GACXpG,KAAKsE,KAAKsB,cACnBw7C,EAAmBkD,kBAAkB5gD,EAAK1D,KAAKsE,KAAKjB,eAAe1C,YAAa0gD,EAAajgD,EAAGigD,EAAahgD,EAAGgH,EAAgBrI,KAAKsE,KAAK9D,WAAYR,KAAKsE,KAAK8F,SAEhKw6C,EAA0BI,yBAAyBthD,EAAK1D,KAAKikD,gBAAiBjkD,KAAKsE,KAAKjB,eAAe1C,YAAa0gD,EAAajgD,EAAGigD,EAAahgD,EAAGgH,EAAgBrI,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,QAAQ,GAAM,EAAMtV,KAAKsE,KAAK0C,YAAahH,KAAKsE,KAAK4C,gBAAiBlH,KAAKsE,KAAKoB,YAEpU1F,KAAKsV,OAAS,KACdtV,KAAK8M,mBAAqB9M,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GACtErV,KAAKiP,OAAS,EACdjP,KAAKsE,KAAK8B,SAAU,GAEhBpG,KAAKsE,KAAK8B,UAAYpG,KAAKsE,KAAK6B,QAClCy+C,EAA0BI,yBAAyBthD,EAAK1D,KAAKikD,gBAAiBjkD,KAAKsE,KAAKjB,eAAe1C,YAAa0gD,EAAajgD,EAAGigD,EAAahgD,EAAGgH,EAAgBrI,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKiP,SAAS,GAAO,EAAMjP,KAAKsE,KAAK0C,YAAahH,KAAKsE,KAAK4C,gBAAiBlH,KAAKsE,KAAKoB,YAEtU1F,KAAKiP,QAAUjP,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAC3DrV,KAAKsV,MAAQtV,KAAK8M,kBAAoB,EAElC9M,KAAKiP,OAAS,MAChBjP,KAAKsE,KAAK8B,SAAU,IAEZpG,KAAKsE,KAAK6B,SACpBy+C,EAA0BI,yBAAyBthD,EAAK1D,KAAKikD,gBAAiBjkD,KAAKsE,KAAKjB,eAAe1C,YAAa0gD,EAAajgD,EAAGigD,EAAahgD,EAAGgH,EAAgBrI,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKiP,SAAS,GAAO,EAAOjP,KAAKsE,KAAK0C,YAAahH,KAAKsE,KAAK4C,gBAAiBlH,KAAKsE,KAAKoB,YAEvU1F,KAAKiP,QAAUjP,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAC3DrV,KAAKsV,MAAQtV,KAAK8M,kBAAoB,GAI1C83C,EAA0BG,iBACxBrhD,EAAK1D,KAAKikD,gBAAiBjkD,KAAKsE,KAAKjB,eAAe1C,YAAa0gD,EAAajgD,EAAGigD,EAAahgD,EAAGgH,EAAgBrI,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKkP,SAAS,GAAO,EAAOlP,KAAKsE,KAAK0C,YAAahH,KAAKsE,KAAK4C,gBAAiBlH,KAAKsE,KAAKoB,WAAY1F,KAAKsE,KAAKsB,aAAc5F,KAAKsE,KAAKyB,iBAEpU/F,KAAKoV,IAAM,EACXpV,KAAKkP,QAA2D,GAAjDlP,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAG/D,CACQsvC,gBAAgBjhD,GACtB,MAAMkhD,EAA4B5kD,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMsuC,aACnFzD,EAAqBphD,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASmR,KAAKC,MAAMqU,MAE5EtnB,EAAQtD,KAAKsE,KAAKjB,eAAe06C,IAAIz6C,MAAQtD,KAAKsE,KAAKX,MAAMC,mBAAmB6L,cAAcC,aAAa6I,OAAO1T,MAClHtB,EAASvD,KAAKsE,KAAKjB,eAAe06C,IAAIx6C,OAASvD,KAAKsE,KAAKX,MAAMC,mBAAmB6L,cAAcC,aAAa6I,OAAO1T,MAE1H7E,KAAKilD,UAAWvhD,EAAK1D,KAAKsE,KAAKjB,eAAe06C,IAAK/9C,KAAKsE,KAAK1B,IAAIxB,EAAY,GAARkC,EAAatD,KAAKsE,KAAK1B,IAAIvB,EAAIkC,EAAQD,EAAOC,EAAQvD,KAAKsE,KAAK8F,QAASpK,KAAKsE,KAAKyB,iBAEpJ/F,KAAKsE,KAAK6B,QACZy+C,EAA0BG,iBACxBrhD,EACA1D,KAAKikD,gBACLjkD,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,EACdrB,KAAKsE,KAAK+D,eACVrI,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKoV,MAChF,GACA,EACApV,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKoB,WACV1F,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,iBAEZ/F,KAAKoV,KAAO,KACZpV,KAAKkP,OAAS,IAEVlP,KAAKsE,KAAKyB,iBACZq7C,EAAmBgD,aACjB1gD,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,EACdrB,KAAKsE,KAAK9D,WACVR,KAAKsE,KAAK8F,SAGZpK,KAAKsV,OAAS,KACdtV,KAAKiP,OAAS,EACVjP,KAAKsE,KAAKsB,aACZ5F,KAAK8M,mBAAqB9M,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAEtErV,KAAK8M,kBAAoB,EAE3B9M,KAAKsE,KAAK8B,SAAU,GACXpG,KAAKsE,KAAKsB,cACnBw7C,EAAmBkD,kBACjB5gD,EACA1D,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,EACdrB,KAAKsE,KAAK+D,eACVrI,KAAKsE,KAAK9D,WACVR,KAAKsE,KAAK8F,SAIZpK,KAAKsV,OAAS,KACdtV,KAAK8M,mBAAqB9M,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GACtErV,KAAKiP,OAAS,EACdjP,KAAKsE,KAAK8B,SAAU,GAEhBpG,KAAKsE,KAAK8B,UAAYpG,KAAKsE,KAAK6B,QAGlCnG,KAAKiP,QAAUjP,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAC3DrV,KAAKsV,MAAQtV,KAAK8M,kBAAoB,EAElC9M,KAAKiP,OAAS,MAChBjP,KAAKsE,KAAK8B,SAAU,IAEZpG,KAAKsE,KAAK6B,SAGpBnG,KAAKiP,QAAUjP,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAC3DrV,KAAKsV,MAAQtV,KAAK8M,kBAAoB,GAG1C83C,EAA0BG,iBACxBrhD,EACA1D,KAAKikD,gBACLjkD,KAAKsE,KAAKjB,eAAe1C,YACzBX,KAAKsE,KAAK1B,IAAIxB,EACdpB,KAAKsE,KAAK1B,IAAIvB,EACdrB,KAAKsE,KAAK+D,eACVrI,KAAK0B,IAAIiC,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBAAgB3W,KAAKkP,SAChF,GACA,EACAlP,KAAKsE,KAAK0C,YACVhH,KAAKsE,KAAK4C,gBACVlH,KAAKsE,KAAKoB,WACV1F,KAAKsE,KAAKsB,aACV5F,KAAKsE,KAAKyB,iBAEZ/F,KAAKoV,IAAM,EACXpV,KAAKkP,QAA2D,GAAjDlP,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASkQ,GAG/D,CACQ4vC,UACNvhD,EACAq6C,EACA38C,EACAC,EACAiC,EACAC,EACA6G,EACA5J,GAEK4J,GAAY5J,IACfkD,EAAIwnB,YAAclrB,KAAKmU,iBAAiBc,SAE1CvR,EAAIwhD,UAAUnH,EAAK38C,EAAGC,EAAGiC,EAAOC,GAChCG,EAAIwnB,YAAc,CACpB,CAEU+2B,kBACR,OAAQjiD,KAAKikD,iBACX,KAAKC,EAAAA,GAAAA,QACHlkD,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASqc,UAAUgjC,gBACpDxkD,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAC5C1hB,KAAKsE,KAAK6D,UACVnI,KAAKsE,KAAK1B,IACV5C,KAAKsE,KAAK+D,gBAEZ,MACF,KAAK67C,EAAAA,GAAAA,MAGHlkD,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAAa1d,UAAYhE,KAAKsE,KAAK6D,UAC/EnI,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAAazd,YAEzDjE,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAAaxd,KACvDlE,KAAKsE,KAAKU,UAAU/B,OAAO7B,EAC3BpB,KAAKsE,KAAKU,UAAU/B,OAAO5B,EAC3BrB,KAAKsE,KAAKU,UAAU7B,OAAO/B,EAAIpB,KAAKsE,KAAKU,UAAU/B,OAAO7B,EAC1DpB,KAAKsE,KAAKU,UAAU7B,OAAO9B,EAAIrB,KAAKsE,KAAKU,UAAU/B,OAAO5B,GAI5DrB,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAAavd,YACzDnE,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuc,aAAatd,OAK/D,EC3QK,MAAM8W,WAAuBM,EAMlC3b,YAAY6B,GACVwD,MAAMxD,GAAK,KANNA,SAAG,OACH8R,SAAG,OACHuqC,IAAM,IAAI2C,MAAQ,KACjByE,YAAM,OACNC,gBAAU,EAGhBplD,KAAKolD,WAAU,UAAMplD,KAAK0B,IAAIiC,MAAMC,mBAAmBC,gBAAgBC,IAAI+qC,OAAOwW,OAAOC,SAAQ,6EACjGtlD,KAAKmO,cACLnO,KAAK0K,aACP,CACOyD,cACAnO,KAAKob,WACRpb,KAAK+W,MAAMC,aAAeM,EAAa+T,aACvCrrB,KAAKob,UAAW,EAChBpb,KAAKwT,IAAMxT,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAAa6I,OAAOo9B,IAC/Ex9B,EAAY+mC,wBACVl/C,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,cAGtD,CACOhF,cAAsD,IAA1C4gB,EAA2B,4DAAG3oB,EAC/C3C,KAAKob,UAAW,OACFzY,IAAV2oB,IACFA,EAAQtrB,KAAK0B,IAAIiC,MAAMC,mBAAmB4H,wBAAwB+f,sBAAsBC,aAE1FrT,EAAYwqC,8BACV3iD,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD4b,GAEFtrB,KAAKqb,cAAgBiQ,CACvB,CAEOjd,kBAAkBzC,GAKvB,IAAI/E,GAAW,EAsDf,OArDI+E,EAAM1B,OACRlK,KAAK0B,IAAIwI,KAAO0B,EAAM1B,KAAK4vB,cAC3B95B,KAAKW,YAAYuJ,KAAOlK,KAAK0B,IAAIwI,KACjCrD,GAAW,GAET+E,EAAM4H,KAAOxT,KAAKwT,MAAQ5H,EAAM4H,MAClCxT,KAAKwT,IAAM5H,EAAM4H,IACjBxT,KAAK+9C,IAAM,IAAI2C,MACf1gD,KAAK+9C,IAAIsB,IAAMr/C,KAAKwT,IACpBxT,KAAK+9C,IAAIwH,OAAS,KACZ35C,EAAM1B,MACRlK,KAAK0B,IAAIwI,KAAO0B,EAAM1B,KAAK4vB,cAC3B95B,KAAKW,YAAYuJ,KAAOlK,KAAK0B,IAAIwI,MAEjClK,KAAK0B,IAAIwI,KAAOvB,EAAAA,GAAAA,OAEdiD,EAAM4H,MAAQxT,KAAKolD,WACrBplD,KAAK0B,IAAIyD,SAAS8+C,gBAAkBC,EAAAA,GAAAA,MAEpClkD,KAAK0B,IAAIyD,SAAS8+C,gBAAkBC,EAAAA,GAAAA,QAEtCr9C,GAAW,CAAI,GAGf+E,EAAMtI,QACRtD,KAAK+W,MAAMzT,MAAQsI,EAAMtI,YAEPX,IAAhBiJ,EAAM0f,QACRtrB,KAAK+W,MAAMC,aAAepL,EAAM0f,OAE9B1f,EAAM6N,UAAUvY,OAAS,IAC3BlB,KAAKqb,cAAgBzP,EAAM6N,UAC3BtB,EAAYwqC,8BACV3iD,KAAKW,YACLX,KAAK0B,IAAIiC,MAAMC,mBAAmB6L,cAAcC,aAChD9D,EAAM6N,WAERzZ,KAAK0K,YAAYkB,EAAM6N,YAGrB7N,EAAM/G,QACR7E,KAAKW,YAAYgO,WAAa/C,EAAM/G,MACpC7E,KAAK+W,MAAMlS,MAAQ+G,EAAM/G,OAEC,kBAAjB+G,EAAMu5C,SACfnlD,KAAKmlD,OAASv5C,EAAMu5C,QAEtBnlD,KAAKob,UAAW,EACZvU,IAAa7G,KAAK0B,IAAIyF,sBACxBnH,KAAK0B,IAAIiD,aAAc,IAIlB,CACT,CAEO8O,SACL,IAAKzT,KAAKob,SACR,OAGF,MAAMyQ,EAAc,CAClBvoB,MAAOtD,KAAK+W,MAAMzT,MAClBuB,MAAO7E,KAAKW,YAAYgO,WACxB8K,UAAWzZ,KAAKqb,cAChB7H,IAAKxT,KAAKwT,KAeZ,OAbIxT,KAAKW,YAAYuJ,OAASvB,EAAAA,GAAAA,SAC5BkjB,EAAO3hB,KAAOlK,KAAKW,YAAYuJ,KAAK24C,eAGlC7iD,KAAKwT,MAAQxT,KAAKolD,aACpBv5B,EAAO25B,WAAa,SAElBxlD,KAAKmlD,SACPt5B,EAAOs5B,OAASnlD,KAAKmlD,QAEnBnlD,KAAK+W,MAAMC,eAAiBM,EAAa+T,eAC3CQ,EAAOP,MAAQtrB,KAAK+W,MAAMC,cAErB6U,CACT,CAEUtQ,YAAY3P,GAEpB,GAAIA,EAAM1B,MAAQ0B,EAAM1B,OAASlK,KAAKW,YAAYuJ,KAAK24C,cACrD,OAAO,EAET,GAAIj3C,EAAM6N,UAAUvY,SAAWlB,KAAKqb,cAAcna,OAChD,IAAK,IAAID,EAAI,EAAGA,EAAI2K,EAAM6N,UAAUvY,OAAQD,IAC1C,GAAI2K,EAAM6N,UAAUxY,KAAOjB,KAAKqb,cAAcpa,GAC5C,OAAO,EAIb,OAAIjB,KAAKwT,MAAQ5H,EAAM4H,GAKzB,EChJK,MAAMsY,WAAgCC,EAG3ClsB,YAAY6B,GACVwD,MAAMxD,GAAK,KAHNA,SAAG,OACHwB,OAAC,EAGNlD,KAAK0B,IAAMA,CACb,CACOwR,0BAA0B5F,GAC/BtN,KAAK0B,IAAIyE,QAAS,EAkBhBnG,KAAK0B,IAAIkB,IAAIxB,GAAKkM,EAAElM,EAAIkM,EAAE6F,KAC1BnT,KAAK0B,IAAIkB,IAAIvB,GAAKiM,EAAEjM,EAAIiM,EAAE8F,KAE5BpT,KAAK0B,IAAIyO,0BACX,CACOoD,UAAUnS,EAAWC,GAC1B,GRdU,SAATkhD,GAAAA,EAAAA,EAAS,mBAATA,EAAAA,EAAS,mBAATA,EAAAA,EAAS,qBAATA,KAAAA,GAAS,KAKP,MAAMkD,WAA6Bx0C,EAiBxC,mBAA0BtN,EAAcvC,EAAWC,GACjD,IAAK,IAAIJ,EAAI0C,EAAM+hD,WAAWxkD,OAAS,EAAGD,GAAK,IAAKA,EAClD,GAAI0C,EAAM+hD,WAAWzkD,GAAG+E,cAAgBrC,EAAM+hD,WAAWzkD,GAAG4R,cAAczR,EAAGC,GAC3E,OAAOsC,EAAM+hD,WAAWzkD,EAI9B,CACA,0BAAiC0C,GAC/B,IAAI1C,EAAI0C,EAAM+hD,WAAWxkD,OACrB6gB,EAAQ,EACZ,KAAO9gB,KACD0C,EAAM+hD,WAAWzkD,GAAGT,aACtBuhB,GAAS,GAGb,OAAOA,CACT,CACA,4BAAmCpe,GACjC,MAAMyY,EAAOzY,EAAM+hD,WACnB,IAAK,IAAIzkD,EAAI,EAAGA,EAAImb,EAAKlb,SAAUD,GACW,IAAxC0C,EAAM+hD,WAAWzkD,GAAG8E,iBACtBpC,EAAM+hD,WAAWzkD,GAAGwP,QAG1B,CACA,+BAAsC9M,GACpC,IAAK,IAAI1C,EAAI,EAAGA,EAAI0C,EAAM+hD,WAAWxkD,SAAUD,EAC7C0C,EAAM+hD,WAAWzkD,GAAG8E,iBAAkB,CAE1C,CACA,uBAA8BpC,EAAc2J,GAC1C,IAAK,IAAIrM,EAAI,EAAGA,EAAI0C,EAAM+hD,WAAWxkD,SAAUD,GACD,IAAxC0C,EAAM+hD,WAAWzkD,GAAG8E,iBAA6BpC,EAAM+hD,WAAWzkD,GAAG2E,cACvEjC,EAAM+hD,WAAWzkD,GAAGiS,0BAA0B5F,IAEP,IAArC3J,EAAM+hD,WAAWzkD,GAAG2E,cACtBjC,EAAM+hD,WAAWzkD,GAAGiS,0BAA0B5F,EAGpD,CACA,gBAAuB3J,EAAc0M,GAAoD,IAArCtJ,EAAM,wDAAUuV,EAAU,wDAC5E,MAAM7S,EAAI,CAAC4G,EAAEzP,MAAM,GAAGV,GAAImQ,EAAEzP,MAAM,GAAGT,IAC/B4vB,EAAK,IAAI01B,GAAqB9hD,EAAO8F,EAAE,GAAIA,EAAE,GAAI,EAAG1C,GA0B1D,OAzBIsJ,EAAExP,QACJkvB,EAAG1hB,kBAAkBgC,EAAExP,QAEzBkvB,EAAGxvB,KAAO6L,EAAAA,GAAMiE,EAAE9P,MAElBwvB,EAAG1pB,cAAgBgK,EAAE3P,SAEnBqvB,EAAGzvB,GADDgc,EACM3Y,EAAMsF,UAENoH,EAAE/P,GAER+P,EAAE3P,SACJqvB,EAAG7oB,gBAAkB,EAErB6oB,EAAG7oB,gBAAkB,EAGnBmJ,EAAEvP,KAAK+D,OACTkrB,EAAG5mB,UAAUkH,EAAEvP,KAAK+D,OAElBwL,EAAEvP,KAAK0S,KACTuc,EAAG41B,WAAWt1C,EAAEvP,KAAK0S,KAGvBuc,EAAGjgB,kBACIigB,CACT,CACA,uBAA8BziB,GACvB,CAEP,wBAA+BA,GACxB,CAEP,sBAA6B3J,EAAc2J,GACzC,QAAsB3K,IAAlBgB,EAAMgP,QACR,OAEQ,IAAI8yC,GAAqB9hD,EAAO2J,EAAElM,EAAGkM,EAAEjM,EAAG,GAClDiP,QACE3M,EAAMC,mBAAmB4H,wBAAwB8C,aAAayQ,YAGlEpb,EAAMC,mBAAmB4H,wBAAwBgX,YACnD,CACA,mBAA0BlV,GACxB,CAEF,iBAAwBA,GACjB,CAEP,eAAsBA,GACf,CAEPzN,YACE8D,GAUC,IATDvC,EAAC,uDAAG,EACJC,EAAC,uDAAG,EACJC,EAAC,uDAAG,EACJyF,EAAM,wDACNxG,EAAW,uDAAG6L,EAAAA,GAAAA,cAIE,2CAAGyJ,EAAAA,GAAAA,MAEnB3Q,MAAMvB,EAAOvC,EAAGC,EAAGC,EAAGf,GAAM,KA5HvB8C,oBAAc,OACd8B,cAAQ,OACRE,iBAAW,OACXsC,OAAC,OACD/E,SAAG,OACH8E,UAAI,OACJyJ,aAAO,OACPC,aAAO,OACP7Q,UAAI,OACJkR,gBAAU,OACVC,gBAAU,OACVC,iBAAW,OACXzJ,WAAK,OACL09C,aAAO,OACPC,SAAW,EA+GhB7lD,KAAK+G,OAASA,EACd/G,KAAKqI,eAAiB,EACtBrI,KAAK4c,gBACL5c,KAAK8N,oBACLnK,EAAMmiD,UAAU9lD,MACXA,KAAK+G,QACRpD,EAAMC,mBAAmBmG,GAAGC,wBAAwB8G,iBAAiB9Q,KAAKwJ,SAE9E,CACQoT,gBACN5c,KAAKqD,eAAiB,IAAI6X,GAAelb,MACzCA,KAAKmF,SAAW,IAAIs/C,GAAyBzkD,MAC7CA,KAAKoF,eAAiB,IAAI0mB,GAAwB9rB,MAClDA,KAAKqF,YAAc,IAAIsjB,GAAqB3oB,KAC9C,CACO8R,OACL9R,KAAK8F,UAAW,EAChB9F,KAAKuR,MAAQ,GACbvR,KAAKyR,YAAa,CACpB,CACOW,gBACL,MAAO,0BACT,CAEO5C,WAAW9L,GACZsL,MAAMhP,KAAK4C,IAAIxB,KAGnBpB,KAAKmF,SAASqK,WAAW9L,GACrB1D,KAAK2D,MAAMC,mBAAmBC,gBAAgBC,IAAIC,YACpD/D,KAAKgF,UAAUvB,OAAOC,GAE1B,CAEOmP,cAAczR,EAAWC,GAC9B,OAAOrB,KAAKqF,YAAYwN,cAAczR,EAAGC,EAC3C,CACOuiD,2BAA2BxiD,EAAWC,EAAWwiD,GAEtD,GAAI7jD,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,cAC9C,OAAO,EAET,GAAIrG,KAAK+C,WACP,OAAO,EAKT,OAFY/C,KAAKqS,SAASjR,EAAGC,EAAI,GAAKrB,KAAKqI,iBAE7BrI,KAAK2H,EAAI3H,KAAKqI,eAAiB,GAAKrI,KAAKqI,eAAiBw7C,CAC1E,CACO/wC,SACL,OAAO9S,KAAKqF,YAAYyN,QAC1B,CACOG,OACLjT,KAAKqF,YAAY4N,MACnB,CACWzS,iBACT,OAAOR,KAAK+F,eACd,CACWvF,eAAW0C,GACpBlD,KAAK+F,gBAAkB7C,EACvBlD,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2c,eAAe3mB,KAAKwJ,SAC/E,CACWY,cACT,OAAOpK,KAAK4F,YACd,CACWwE,YAAQlH,GAEjBlD,KAAK4F,aAAe1C,GAChBlD,KAAK4F,eAAiB5F,KAAK6F,aAEnB7F,KAAK4F,cAAgB5F,KAAK6F,aADpC7F,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB4c,WAAW5mB,KAAKwJ,UAI3ExJ,KAAK6F,WAAa7F,KAAK4F,aAClB1C,IACHlD,KAAK8G,mBAAoB,EACzB9G,KAAK4M,mBAET,CACW9B,YACT,OAAO9K,KAAK0F,UACd,CACWoF,UAAM5H,GACflD,KAAK0F,WAAaxC,CACpB,CAEOgQ,0BAA0B5F,GAC1BtN,KAAKiG,iBAGNjG,KAAK2F,WAAa3F,KAAKgC,cAAgBhC,KAAKqG,gBAGhDrG,KAAKoF,eAAe8N,0BAA0B5F,GAC1CtN,KAAKsK,iBACPtK,KAAKsK,eAAe4I,0BAA0B5F,GAC1CtN,KAAKsK,gBAAkBtK,KAAKsK,eAAe+I,aAE7CrT,KAAKsK,eAAe+I,WAAWC,GAAGlS,EAAIpB,KAAK4C,IAAIxB,EAC/CpB,KAAKsK,eAAe+I,WAAWC,GAAGjS,EAAIrB,KAAK4C,IAAIvB,KAIrD,CACOkS,UAAUnS,EAAWC,GAC1BrB,KAAKoF,eAAemO,UAAUnS,EAAGC,EACnC,CACOuS,eACL5T,KAAKqF,YAAYuO,cACnB,CACOrI,mBACLvL,KAAKqF,YAAYkG,kBACnB,CACO8D,cACLrP,KAAKqF,YAAYgK,aACnB,CAEOs2C,WAAWziD,GAChBlD,KAAKmF,SAAS8+C,gBAAkBC,EAAAA,GAAAA,MAChClkD,KAAKqD,eAAe1C,YAAY6S,IAAMtQ,CACxC,CACO6iD,aACL/lD,KAAKmF,SAAS8+C,gBAAkBC,EAAAA,GAAAA,OAClC,CAEOzzC,SAAyB,IAAlB5J,IAAQ,yDACpB,GAAK7G,KAAKgC,eAAgBhC,KAAKqG,cAA/B,CAWA,GARArG,KAAK2F,UAAW,EAChB3F,KAAKgG,cAAe,EACpBhG,KAAKgC,cAAe,EAEhBhC,KAAK8H,eACP9H,KAAK4M,oBAGF5M,KAAKuF,SAAWsB,EAAU,CAC7B,MAAMuX,EAAQpe,KAAKwJ,SACf4U,GACFpe,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB,CAACvG,GAElF,CAEIpe,KAAKsK,iBACPtK,KAAKsK,eAAegU,wBACpBte,KAAKsK,oBAAiB3H,GAGxB3C,KAAK2D,MAAM4a,gBAAgBve,MAC3BA,KAAK2D,MAAMqiD,aAAahmD,MACxBA,KAAK2D,MAAM8a,eAAeze,KAvB1B,CAwBF,CACO+P,SAAS3O,EAAWC,GACzB,OAAO,IAAIokD,GAAqBzlD,KAAK2D,MAAOvC,EAAGC,EAAGrB,KAAK4C,IAAItB,GAAG,EAAOtB,KAAKO,KAAMP,KAAK2H,EACvF,CAEO+I,iBACD1Q,KAAKuF,UAITvF,KAAK2D,MAAMC,mBAAmBuS,eAAe2M,eAAe+D,iBAC5D7mB,KAAKuL,mBAEP,CACOuC,oBACL9N,KAAKqI,eACHrI,KAAK6lD,SAAW7lD,KAAK2D,MAAMC,mBAAmB6L,cAAcC,aAAa6I,OAAO1T,MAClF,MAAMA,EAAQ7E,KAAKqI,eACb9E,EAAS,GAAKsB,EAEd0/B,EAAY,GAAK1/B,EAAQ,IAM/B7E,KAAKgF,UAAU/B,OAAS,IAAIZ,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAImjC,EALrC,EAKuDvkC,KAAK4C,IAAIvB,EAAIkC,EAAS,GAC1FvD,KAAKgF,UAAU7B,OAAS,IAAId,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAImjC,GANrC,EAMuDvkC,KAAK4C,IAAIvB,EAAI,EAEnF,CACW6I,WACT,OAAOlK,KAAK0I,SACd,CAGWwB,SAAKhH,GAQd,GAFAlD,KAAK0I,UAAYxF,EAEblD,KAAKqD,eAAe06C,IAAK,CAE3B,IAAIkI,EAAuB,GAC3B,OAAQ/iD,GACN,KAAKyF,EAAAA,GAAAA,MACH3I,KAAK6lD,SAAWtD,GAAU2D,MAC1BlmD,KAAKqD,eAAe1C,YAAYuJ,KAAOvB,EAAAA,GAAAA,MAGrCs9C,EADEjmD,KAAKqD,eAAe06C,IAAIz6C,MAAQtD,KAAKqD,eAAe06C,IAAIx6C,QAC7CmqB,EAAAA,EAAAA,IACX1tB,KAAKqD,eAAe06C,IAAIz6C,MACxBtD,KAAKqD,eAAe06C,IAAIx6C,OACxB,KAGWoqB,EAAAA,EAAAA,IACX3tB,KAAKqD,eAAe06C,IAAIz6C,MACxBtD,KAAKqD,eAAe06C,IAAIx6C,OACxB,IAGJvD,KAAKqD,eAAe06C,IAAIz6C,MAAQ2iD,EAAW,GAC3CjmD,KAAKqD,eAAe06C,IAAIx6C,OAAS0iD,EAAW,GAC5C,MACF,KAAKt9C,EAAAA,GAAAA,OACH3I,KAAK6lD,SAAWtD,GAAU4D,OAC1BnmD,KAAKqD,eAAe1C,YAAYuJ,KAAOvB,EAAAA,GAAAA,OAGrCs9C,EADEjmD,KAAKqD,eAAe06C,IAAIz6C,MAAQtD,KAAKqD,eAAe06C,IAAIx6C,QAC7CmqB,EAAAA,EAAAA,IACX1tB,KAAKqD,eAAe06C,IAAIz6C,MACxBtD,KAAKqD,eAAe06C,IAAIx6C,OACxB,KAGWoqB,EAAAA,EAAAA,IACX3tB,KAAKqD,eAAe06C,IAAIz6C,MACxBtD,KAAKqD,eAAe06C,IAAIx6C,OACxB,IAGJvD,KAAKqD,eAAe06C,IAAIz6C,MAAQ2iD,EAAW,GAC3CjmD,KAAKqD,eAAe06C,IAAIx6C,OAAS0iD,EAAW,GAC5C,MACF,KAAKt9C,EAAAA,GAAAA,MACH3I,KAAK6lD,SAAWtD,GAAU6D,MAC1BpmD,KAAKqD,eAAe1C,YAAYuJ,KAAOvB,EAAAA,GAAAA,MAGrCs9C,EADEjmD,KAAKqD,eAAe06C,IAAIz6C,MAAQtD,KAAKqD,eAAe06C,IAAIx6C,QAC7CmqB,EAAAA,EAAAA,IACX1tB,KAAKqD,eAAe06C,IAAIz6C,MACxBtD,KAAKqD,eAAe06C,IAAIx6C,OACxB,KAGWoqB,EAAAA,EAAAA,IACX3tB,KAAKqD,eAAe06C,IAAIz6C,MACxBtD,KAAKqD,eAAe06C,IAAIx6C,OACxB,IAIJvD,KAAKqD,eAAe06C,IAAIz6C,MAAQ2iD,EAAW,GAC3CjmD,KAAKqD,eAAe06C,IAAIx6C,OAAS0iD,EAAW,GAKlD,CAEA,GAAIjmD,KAAKqmD,aAAenC,EAAAA,GAAAA,MACtB,OAAQhhD,GACN,KAAKyF,EAAAA,GAAAA,MACH3I,KAAK6lD,SAAWtD,GAAU2D,MAC1BlmD,KAAKqD,eAAe1C,YAAYuJ,KAAOvB,EAAAA,GAAAA,MACvC,MACF,KAAKA,EAAAA,GAAAA,OACH3I,KAAK6lD,SAAWtD,GAAU4D,OAC1BnmD,KAAKqD,eAAe1C,YAAYuJ,KAAOvB,EAAAA,GAAAA,OACvC,MACF,KAAKA,EAAAA,GAAAA,MACH3I,KAAK6lD,SAAWtD,GAAU6D,MAC1BpmD,KAAKqD,eAAe1C,YAAYuJ,KAAOvB,EAAAA,GAAAA,MAO7C3I,KAAK8N,mBAEP,CACWu4C,iBACT,OAAOrmD,KAAKmF,SAAS8+C,eACvB,CACWoC,eAAWnjD,GACpBlD,KAAKmF,SAAS8+C,gBAAkB/gD,CAClC,ESxaK,MAAMojD,WAA4B3iB,GACvC9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOhpB,eAAepD,GACpByO,EAAOrL,eAAe1Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACrD,CACOg0B,iBAAiBh0B,GACtByO,EAAOulB,iBAAiBh0B,EAC1B,CACOqD,gBAAgBrD,GACrByO,EAAOpL,gBAAgBrD,EACzB,CAEOunB,UAAUvnB,GAEf,CAEKurB,UAAUvrB,GAIf,EAGG,MAAMi5C,WAAqCD,GAChDzmD,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOhpB,eAAepD,GACpBm4C,GAAqB/0C,eAAe1Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACnE,EAEK,MAAMk5C,WAAsCF,GACjDzmD,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOhpB,eAAepD,GACpBy1C,GAAsBryC,eAAe1Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACpE,EAEK,MAAMm5C,WAA2BH,GACtCzmD,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOhpB,eAAepD,GACpB6xC,GAAkBzuC,eAAe1Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAChE,EAEK,MAAMo5C,WAA4B/iB,GACvC9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfygC,GAAOvmB,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGlB,EAAAA,GAAAA,aACnD,CACOsE,eAAepD,GACpBygC,GAAOr9B,eAAe1Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGlB,EAAAA,GAAAA,aACxD,CACOyoB,UAAUvnB,GACfygC,GAAOlZ,UAAU70B,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGlB,EAAAA,GAAAA,aACnD,CACOwE,QAAQtD,GACbygC,GAAOn9B,QAAQtD,EACjB,CACOkwB,QAAQjE,GACC,WAAVA,EAAEM,KAAkC,KAAdN,EAAE8B,SAAgC,KAAd9B,EAAE8B,SAC9C0S,GAAOxrB,QAEX,EAEK,MAAMokC,WAAkCD,GAE7C7mD,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfygC,GAAOvmB,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGlB,EAAAA,GAAAA,aACnD,CACOsE,eAAepD,GACpBygC,GAAOr9B,eAAe1Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGlB,EAAAA,GAAAA,aACxD,CACOyoB,UAAUvnB,QACa3K,IAAxBorC,GAAOI,UAAUzoB,IACnBqoB,GAAO7qB,WAAWljB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGlB,EAAAA,GAAAA,aAEtD,EAEK,MAAMw6C,WAA8BjjB,GACzC9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfs+B,GAAOpkB,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAChD,CACOoD,eAAepD,GACpBs+B,GAAOl7B,eAAe1Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACrD,CACOS,iBAAiBT,GACtBs+B,GAAO79B,iBAAiB/N,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACvD,CACOunB,UAAUvnB,GACfs+B,GAAO/W,UAAUvnB,EACnB,CACOkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJuQ,GAAOrpB,SAES,KAAdgX,EAAE8B,SAAgC,KAAd9B,EAAE8B,SACxBuQ,GAAOib,eAAe7mD,KAAK05B,IAAIlE,aAAa7xB,MAEhD,CACOmxB,OACL8W,GAAO9W,KAAK90B,KAAK05B,IAAIjc,EACvB,EAEK,MAAMqpC,WAAoCF,GAC/C/mD,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOhpB,eAAepD,GACpBs+B,GAAOl7B,eAAe1Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,GAAG,EACxD,CACOS,iBAAiBT,GACtBs+B,GAAO79B,iBAAiB/N,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,GAAG,EAC1D,CACOka,UAAUla,GACfs+B,GAAOpkB,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,GAAG,EACnD,CACOunB,UAAUvnB,GACfs+B,GAAO/W,UAAUvnB,EACnB,EAEK,MAAMy5C,WAAmCpjB,GAC9C9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfowC,GAAUl2B,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,SACtD,CACO9iB,UAAUvrB,GACfowC,GAAU7kB,UAAU74B,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,SACtD,CACO/qC,QAAQtD,GACbowC,GAAU9sC,QAAQ5Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACjD,CACOkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJqiB,GAAUn7B,QAEd,CACOsS,UAAUvnB,GACfowC,GAAU7oB,UAAU70B,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,SACtD,EAEK,MAAMqL,WAA0CrjB,GACrD9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfowC,GAAUl2B,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,gBACtD,CACO9iB,UAAUvrB,GACfowC,GAAU7kB,UAAU74B,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,gBACtD,CACO/qC,QAAQtD,GACbowC,GAAU9sC,QAAQ5Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACjD,CACOkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJqiB,GAAUn7B,QAEd,CACOsS,UAAUvnB,GACfowC,GAAU7oB,UAAU70B,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,gBACtD,CACOp5B,SACLm7B,GAAUn7B,QACZ,EAEK,MAAM0kC,WAAkCtjB,GAC7C9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfowC,GAAUl2B,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,QACtD,CACO9iB,UAAUvrB,GACfowC,GAAU7kB,UAAU74B,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,QACtD,CACO/qC,QAAQtD,GACbowC,GAAU9sC,QAAQ5Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACjD,CACOkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJqiB,GAAUn7B,QAEd,CACOsS,UAAUvnB,GACfowC,GAAU7oB,UAAU70B,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,QACtD,EAEK,MAAMuL,WAAuCvjB,GAClD9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfowC,GAAUl2B,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,aACtD,CACO9iB,UAAUvrB,GACfowC,GAAU7kB,UAAU74B,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,aACtD,CACO/qC,QAAQtD,GACbowC,GAAU9sC,QAAQ5Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACjD,CACOkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJqiB,GAAUn7B,QAEd,CACOsS,UAAUvnB,GACfowC,GAAU7oB,UAAU70B,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,aACtD,CACOp5B,SACLm7B,GAAUn7B,QACZ,EAEK,MAAM4kC,WAAgCJ,GAC3ClnD,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfowC,GAAUl2B,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,MACtD,CACO9mB,UAAUvnB,GACfowC,GAAU7oB,UAAU70B,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,MACtD,EAEK,MAAMyL,WAAsCL,GACjDlnD,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfowC,GAAUl2B,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,YACtD,CACO9mB,UAAUvnB,GACfowC,GAAU7oB,UAAU70B,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,YACtD,EAEK,MAAM0L,WAA6B1jB,GACxC9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfmiB,EAAkBjI,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC3D,CACOoD,eAAepD,GACpB,MAAMpD,EAAO,IAAMlK,KAAK05B,IAAI9rB,YAC5B6hB,EAAkB63B,iBAAiBtnD,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGpD,EAAMA,EAC3E,CACOo3B,iBAAiBh0B,GACjB,CAEAqD,gBAAgBrD,GACrBmiB,EAAkB83B,kBAAkBj6C,EACtC,CACOunB,UAAUvnB,GACfmiB,EAAkB+3B,YAAYxnD,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC7D,CACOurB,UAAUvrB,GACfmiB,EAAkBg4B,YAAYznD,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC7D,CACOsD,QAAQtD,GACbmiB,EAAkBi4B,UAAU1nD,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC3D,CACOkwB,QAAQjE,GACC,WAAVA,EAAEM,KAAkC,KAAdN,EAAE8B,SAAgC,KAAd9B,EAAE8B,SAC9C5L,EAAkBlN,QAEtB,CACOA,SACLkN,EAAkBlN,QACpB,EAEK,MAAMolC,WAA+BhkB,GAC1C9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfsgB,EAAepG,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACxD,CACOoD,eAAepD,GACpB,MAAMpD,EAAO,IAAMlK,KAAK05B,IAAI9rB,YAC5BggB,EAAe05B,iBAAiBtnD,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGpD,EAAMA,EACxE,CACOo3B,iBAAiBh0B,GACjB,CAEAqD,gBAAgBrD,GACrBsgB,EAAe25B,kBAAkBj6C,EACnC,CAGOunB,UAAUvnB,GACf,CAEKurB,UAAUvrB,GACfsgB,EAAe65B,YAAYznD,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC1D,CACOsD,QAAQtD,GACbsgB,EAAe85B,UAAU1nD,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACxD,CACOkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJzN,EAAerL,QAEnB,CACOA,SACLqL,EAAerL,QACjB,EAEK,MAAMqlC,WAA6CjkB,GACxD9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfu3B,GAAQgjB,gBAAgB7nD,KAAK05B,IAAIlE,aAAa7xB,MAAO,IAAQ2J,EAAElM,EAAGkM,EAAEjM,EACtE,CACOqP,eAAepD,GAChBu3B,GAAQxiB,eACVwiB,GAAQxiB,aAAa7hB,YAAa,EAClCqkC,GAAQxiB,kBAAe1f,GAEzB3C,KAAK05B,IAAIlE,aAAahqB,wBAAwBgX,YAChD,CACO8e,iBAAiBh0B,GACjB,CAEAqD,gBAAgBrD,GACrBu3B,GAAQ0iB,kBAAkBj6C,EAC5B,CAGOunB,UAAUvnB,GACfu3B,GAAQ2iB,YAAYl6C,EACtB,CACOurB,UAAUvrB,GACV,CAEAkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJwJ,GAAQtiB,QAEZ,EAEK,MAAMulC,WAAsDnkB,GACjE9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfu3B,GAAQkjB,yBAAyB/nD,KAAK05B,IAAIlE,aAAa7xB,MAAO,IAAK2J,EAAElM,EAAGkM,EAAEjM,EAC5E,CACOqP,eAAepD,GAChBu3B,GAAQxiB,eACVwiB,GAAQxiB,aAAa7hB,YAAa,EAClCqkC,GAAQxiB,kBAAe1f,GAEzB3C,KAAK05B,IAAIlE,aAAahqB,wBAAwBgX,YAChD,CACO8e,iBAAiBh0B,GACjB,CAEAqD,gBAAgBrD,GACrBu3B,GAAQ0iB,kBAAkBj6C,EAC5B,CAGOunB,UAAUvnB,GACfu3B,GAAQ2iB,YAAYl6C,EACtB,CACOurB,UAAUvrB,GACV,CAEAkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJwJ,GAAQtiB,QAEZ,EAEK,MAAMylC,WAAiCrkB,GAC5C9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOhpB,eAAepD,GACpBuU,EAAiBnR,eAAe1Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC/D,CACOunB,UAAUvnB,GACfuU,EAAiBgT,UAAUvnB,EAC7B,CACOS,iBAAiBT,GACtBuU,EAAiB9T,iBAAiB/N,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACjE,CACOka,UAAUla,GACfuU,EAAiB2F,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC1D,CACOkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJxZ,EAAiBU,OAAOviB,KAAK05B,IAAIlE,aAAa7xB,OAE9B,KAAd41B,EAAE8B,SAAgC,KAAd9B,EAAE8B,SACxBxZ,EAAiBglC,eAAe7mD,KAAK05B,IAAIlE,aAAa7xB,MAE1D,CACOmxB,OACLjT,EAAiBiT,KAAK90B,KAAK05B,IAAIlE,aAAa7xB,MAAO3D,KAAK05B,IAAIjc,EAC9D,EAEK,MAAMwqC,WAA6CtkB,GACxD9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOhpB,eAAepD,GACpBuoB,EAAsBnlB,eAAe1Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACpE,CACOunB,UAAUvnB,GACfuoB,EAAsBhB,UAAU70B,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC/D,CACOS,iBAAiBT,GACtBuoB,EAAsB9nB,iBAAiB/N,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACtE,CACOka,UAAUla,GACfuoB,EAAsBrO,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC/D,CACOkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJxF,EAAsBtT,OAAOviB,KAAK05B,IAAIlE,aAAa7xB,OAEnC,KAAd41B,EAAE8B,SAAgC,KAAd9B,EAAE8B,SACxBxF,EAAsBgxB,eAAe7mD,KAAK05B,IAAIlE,aAAa7xB,MAE/D,CACOmxB,OACLe,EAAsBf,KAAK90B,KAAK05B,IAAIlE,aAAa7xB,MAAO3D,KAAK05B,IAAIjc,EACnE,EAEK,MAAMyqC,WAA2CvkB,GACtD9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOhpB,eAAepD,GACpBuU,EAAiBnR,eAAe1Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,GAAG,EAClE,CACOunB,UAAUvnB,GACfuU,EAAiBgT,UAAUvnB,EAC7B,CACOS,iBAAiBT,GACtBuU,EAAiB9T,iBAAiB/N,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACjE,CACOka,UAAUla,GACfuU,EAAiB2F,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,GAAG,EAC7D,CACOkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJxZ,EAAiBU,OAAOviB,KAAK05B,IAAIlE,aAAa7xB,OAE9B,KAAd41B,EAAE8B,SAAgC,KAAd9B,EAAE8B,SACxBxZ,EAAiBglC,eAAe7mD,KAAK05B,IAAIlE,aAAa7xB,MAE1D,CACOmxB,OACLjT,EAAiBiT,KAAK90B,KAAK05B,IAAIlE,aAAa7xB,MAAO3D,KAAK05B,IAAIjc,EAC9D,EAEK,MAAM0qC,WAAgCxkB,GAC3C9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOhpB,eAAepD,GACpB6Z,EAAgBzW,eAAe1Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC9D,CACOunB,UAAUvnB,GACf6Z,EAAgB0N,UAAUvnB,EAC5B,CACOS,iBAAiBT,GACtB6Z,EAAgBpZ,iBAAiB/N,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAChE,CACOka,UAAUla,GACf6Z,EAAgBK,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACzD,CACOkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJlU,EAAgB5E,OAAOviB,KAAK05B,IAAIlE,aAAa7xB,OAE7B,KAAd41B,EAAE8B,SAAgC,KAAd9B,EAAE8B,SACxBlU,EAAgB0/B,eAAe7mD,KAAK05B,IAAIlE,aAAa7xB,MAEzD,CACOmxB,OACL3N,EAAgB2N,KAAK90B,KAAK05B,IAAIlE,aAAa7xB,MAAO3D,KAAK05B,IAAIjc,EAC7D,EAEK,MAAM2qC,WAAqCzkB,GAChD9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOhpB,eAAepD,GACpB28B,GAAqBv5B,eAAe1Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACnE,CACOunB,UAAUvnB,GACf28B,GAAqBpV,UAAU70B,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC9D,CACOS,iBAAiBT,GACtB28B,GAAqBl8B,iBAAiB/N,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACrE,CACOka,UAAUla,GACf28B,GAAqBziB,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC9D,CACOkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJ4O,GAAqB1nB,OAAOviB,KAAK05B,IAAIlE,aAAa7xB,OAElC,KAAd41B,EAAE8B,SAAgC,KAAd9B,EAAE8B,SACxB4O,GAAqB4c,eAAe7mD,KAAK05B,IAAIlE,aAAa7xB,MAE9D,CACOmxB,OACLmV,GAAqBnV,KAAK90B,KAAK05B,IAAIlE,aAAa7xB,MAAO3D,KAAK05B,IAAIjc,EAClE,EAEK,MAAM4qC,WAAwC1kB,IAS9C,MAAM2kB,WAA0C3kB,GACrD9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOhpB,eAAepD,GACpB6Z,EAAgBzW,eAAe1Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,GAAG,EACjE,CACOunB,UAAUvnB,GACf6Z,EAAgB0N,UAAUvnB,EAC5B,CACOS,iBAAiBT,GACtB6Z,EAAgBpZ,iBAAiB/N,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAChE,CACOka,UAAUla,GACf6Z,EAAgBK,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACzD,CACOkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJlU,EAAgB5E,OAAOviB,KAAK05B,IAAIlE,aAAa7xB,OAE7B,KAAd41B,EAAE8B,SAAgC,KAAd9B,EAAE8B,SACxBlU,EAAgB0/B,eAAe7mD,KAAK05B,IAAIlE,aAAa7xB,MAEzD,CACOmxB,OACL3N,EAAgB2N,KAAK90B,KAAK05B,IAAIlE,aAAa7xB,MAAO3D,KAAK05B,IAAIjc,EAC7D,EAaK,MAAM8qC,WAAoC5kB,GAC/C9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOhpB,eAAepD,GACpBtN,KAAK05B,IAAIlE,aAAahqB,wBAAwB4kC,eAAgB,EAC9D4I,GAAuBtoC,eAAe1Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EACrE,CACOunB,UAAUvnB,GACf0rC,GAAuBnkB,UAAUvnB,EACnC,EAEK,MAAMk7C,WAAqC7kB,GAChD9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfgtC,GAAsB9yB,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC/D,CACOurB,UAAUvrB,GACfgtC,GAAsBzhB,UAAUvrB,EAClC,CACOsD,QAAQtD,GACbgtC,GAAsB1pC,QAAQ5Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC7D,CACOkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJif,GAAsB/3B,QAE1B,CACOsS,UAAUvnB,GACfgtC,GAAsBzlB,UAAU70B,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGquC,EAAAA,GAAAA,SAClE,EAGK,MAAM8M,WAAiDD,GAC5D3oD,YAAY65B,GACVx0B,MAAMw0B,EACR,CACOlS,UAAUla,GACfgtC,GAAsB9yB,UAAUxnB,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC/D,CACOurB,UAAUvrB,GACfgtC,GAAsBzhB,UAAUvrB,EAClC,CACOsD,QAAQtD,GACbgtC,GAAsB1pC,QAAQ5Q,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAC7D,CACOkwB,QAAQjE,GACK,KAAdA,EAAE8B,SACJif,GAAsB/3B,QAE1B,CACOsS,UAAUvnB,GACfgtC,GAAsBzlB,UACpB70B,KAAK05B,IAAIlE,aAAa7xB,MACtB2J,EACAquC,EAAAA,GAAAA,SACAlB,EAAAA,GAAAA,aAEJ,EAsBK,MAAMiO,WAA2B/kB,GACtC9jC,YAAY65B,GACVx0B,MAAMw0B,EACR,CACAlS,UAAUla,GACR84B,GAAAA,UAAuBpmC,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGlB,EAAAA,GAAAA,QACzD,CACAsE,eAAepD,GACb84B,GAAAA,eAA4BpmC,KAAK05B,IAAIlE,aAAa7xB,MAAO2J,EAAGlB,EAAAA,GAAAA,QAC9D,CACAyoB,UAAUvnB,GACR84B,GAAAA,UAAuB94B,EACzB,CACAkwB,QAAQjE,GACY,KAAdA,EAAE8B,SACJ+K,GAAAA,QAEJ,ECprBK,MAAMuiB,GAuDX9oD,YAAY2L,GAAmD,KAtD/DA,6BAAuB,OACvBo9C,KAAaC,EAAAA,GAAAA,UAAe,KAC5BC,YAAc,EAAE,KAChBxsB,YAAc,EAAE,KAEhBpJ,aAAc,EAAK,KACnB6M,eAAgB,EAAM,KACtBikB,WAAY,EAAM,KAElB+E,gBAAiB,EAAK,KACtBC,aAAc,EAAK,KACnBppB,UAAW,EAAM,KACjBqpB,kBAAmB,EAAK,KACxBtpC,UAAW,EAAM,KACjBupC,aAAc,EAAK,KACnBC,wBAAyB,EAAK,KAC9BjpB,WAAY,EAAM,KAClBtd,6BAA8B,EAAM,KACpC8a,MAAO,EAAM,KACboC,aAAc,EAAM,KACpBspB,kBAAmB,EAAM,KACzB76C,kBAAmB,EAAM,KACzBkzB,YAAa,EAAM,KACnBhC,MAAO,EAAM,KACbmN,gBAAiB,EAAM,KACvBpN,QAAS,EAAM,KACfiB,SAAU,EAAM,KAChBd,WAAY,EAAM,KAElB0pB,kBAAmB,EAAM,KACzBC,aAAc,EAAM,KAEpBnqB,oBAAqB,EAAM,KAC3BtC,oBAAqB,EAAM,KAC3BgE,gBAAiB,EAAK,KAGtB0oB,8BAA+B,EAAK,KACpCC,wBAAyB,EAAK,KAC9Bj6C,wBAAyB,EAAK,KAC9B4O,UAAW,EAAM,KACjBY,YAAa,EAAM,KACnB7I,UAAW,EAAM,KACjB0mB,aAAc,EAAM,KACpB6sB,aAAc,EAAM,KACpB16C,sBAAuB,EAAK,KAC5B26C,iBAAkB,EAAM,KAChBC,uBAAwB,EAAM,KAC9BC,yBAAoDC,EAAAA,GAAAA,KAA6B,KACjFC,gBAAkCC,EAAAA,GAAAA,KAAoB,KACtDC,eAAgB,EAAM,KACtBC,YAAa,EAAM,KACnBC,YAAa,EAAM,KACnBC,iBAAkB,EAExBnqD,KAAKwL,wBAA0BA,CACjC,CAEW4+C,mBAAelnD,GACxBlD,KAAK8pD,gBAAkB5mD,EAEvBlD,KAAKwL,wBAAwBgqB,aAAarwB,SAASw7B,UAAU0pB,UAAYnnD,CAE3E,CACWknD,qBACT,OAAOpqD,KAAK8pD,eACd,CACWQ,4BAAwBpnD,GACjClD,KAAK4pD,yBAA2B1mD,EAEhClD,KAAKwL,wBAAwBgqB,aAAarwB,SAASw7B,UAAU4pB,mBAAqBrnD,CAEpF,CACWonD,8BACT,OAAOtqD,KAAK4pD,wBACd,CACWjrC,iBAAazb,GACtBlD,KAAKgqD,cAAgB9mD,GAEX,IAANA,GACFlD,KAAKwL,wBAAwBgqB,aAAarf,eAAe2M,eAAegnB,2BAE5E,CACWhgB,wBACT,OAAO9pB,KAAKwL,wBAAwBgqB,aAAarwB,SAASy8B,eAAe9X,iBAC3E,CAEWnL,mBACT,OAAO3e,KAAKgqD,aACd,CACWjjC,cAAU7jB,GACnBlD,KAAKiqD,WAAa/mD,CACpB,CACW6jB,gBACT,OAAO/mB,KAAKiqD,UACd,CACWO,cAAUtnD,GACnBlD,KAAKkqD,WAAahnD,EACbA,IACHlD,KAAK0/B,sBAAuB,EAEhC,CACW8qB,gBACT,OAAOxqD,KAAKkqD,UACd,CACW17C,eAET,OAAO,CACT,CACWkxB,yBAAqBx8B,GAC9BlD,KAAK2pD,sBAAwBzmD,CAC/B,CACWw8B,2BACT,OAAO1/B,KAAK2pD,qBACd,CACWv/B,mBAAelnB,GACxBlD,KAAKwL,wBAAwBi/C,iBAAiBvnD,GAC9ClD,KAAKmqD,gBAAkBjnD,CACzB,CACWknB,qBACT,OAAOpqB,KAAKmqD,eACd,CACWrW,WAEX,EChIK,MAAM4W,GAGX7qD,YAAY0N,GAA8B,KAFnCA,QAAE,OACDo9C,kBAAY,EAElB3qD,KAAKuN,GAAKA,EACVvN,KAAK4qD,kBACP,CACO/nD,QACL,CAEKi/B,uBAAuB+oB,GAC5B7qD,KAAK2qD,aAAaG,SACpB,CACO7oB,yBAAyB4oB,GAC9B7qD,KAAKsL,mBAAmBu/C,EAC1B,CACOvoB,yBAAyB5gC,IAC1B1B,KAAKuN,GAAGioB,aAAa7xB,MAAMgP,SAG3B3S,KAAKuN,GAAGioB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,YAC5CpM,KAAKuN,GAAGioB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,cAC5CpM,KAAKuN,GAAGioB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,WAC5CpM,KAAKuN,GAAGioB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,OAOhDpM,KAAK6pB,sBALDnoB,EAAI4J,oBAMV,CACOue,sBACL7pB,KAAK2qD,aAAaI,UACpB,CACOC,0BACLhrD,KAAK2qD,aAAaM,UACpB,CACQ3/C,mBAAmBu/C,GAErBA,IAAWxwB,EAAAA,GAAAA,KAMbwwB,IAAWxwB,EAAAA,GAAAA,QACXwwB,IAAWxwB,EAAAA,GAAAA,MACXwwB,IAAWxwB,EAAAA,GAAAA,cACXwwB,IAAWxwB,EAAAA,GAAAA,aAGTr6B,KAAKuN,GAAGe,aAAag7C,aACrBtpD,KAAKuN,GAAGioB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAAoBC,OAChFC,EAAAA,GAAAA,SAIFjW,KAAK2qD,aAAaG,UAGlB9qD,KAAKuN,GAAGioB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAAoBC,OAClFC,EAAAA,GAAAA,SAEAjW,KAAKkrD,uBAGPlrD,KAAK2qD,aAAaQ,WA1BlBnrD,KAAK2qD,aAAaS,SA4BtB,CACQF,sBACN,IAAK,IAAIjqD,EAAI,EAAGA,EAAIjB,KAAKuN,GAAGioB,aAAa7xB,MAAM0nD,2BAA2BnqD,SAAUD,EAEhFjB,KAAKuN,GAAGioB,aAAa7xB,MAAM0nD,2BAA2BpqD,GAAGiyC,iBACvDlzC,KAAKuN,GAAGkQ,EAAErc,EACVpB,KAAKuN,GAAGkQ,EAAEpc,IAGZrB,KAAK2qD,aAAaS,SAGxB,CACQR,mBACN5qD,KAAK2qD,aAAe,IAAIW,EAAAA,GACtBtrD,KAAKuN,GAAGioB,aAAa3xB,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAEpE,CACOyd,gBAAgB4hC,GACrB,OAAQA,GACN,KAAK3hC,EAAAA,GAAAA,SACH5pB,KAAK2qD,aAAaa,gBAClB,MACF,KAAK5hC,EAAAA,GAAAA,SACH5pB,KAAK2qD,aAAac,gBAClB,MACF,KAAK7hC,EAAAA,GAAAA,WACH5pB,KAAK2qD,aAAae,kBAClB,MACF,KAAK9hC,EAAAA,GAAAA,WACH5pB,KAAK2qD,aAAagB,kBAClB,MACF,KAAK/hC,EAAAA,GAAAA,QACH5pB,KAAK2qD,aAAaM,WAKxB,EC1GK,MAAMW,GAIX/rD,YAAY0N,GAA8B,KAHnCA,QAAE,OACFie,YAAwB,CAAC,GAAI,GAAI,IAAK,GAAG,KAyBxCqgC,cAAeC,EAAAA,EAAAA,KAAS,KAE9B9rD,KAAKuN,GAAGioB,aAAa7xB,MAAMooD,cAAc,IAxBzC/rD,KAAKuN,GAAKA,CACZ,CACOy+C,eAAe1gC,GAA4C,IAA7B2gC,IAAmB,yDAEtDjsD,KAAKwrB,aAAchU,EAAAA,EAAAA,IAAS8T,GACxBtrB,KAAKwrB,YAAYtqB,OAAS,GAC5BlB,KAAKwrB,YAAYrqB,KAAK,GAExBnB,KAAKksD,yBAAyBlsD,KAAKwrB,aAE/BxrB,KAAKuN,GAAGioB,aAAa7xB,MAAMgP,SAAWs5C,GACxCjsD,KAAK6rD,cAIT,CACOM,iBACL,OAAO10C,EAAAA,EAAAA,IAAQzX,KAAKwrB,YAAY,GAAIxrB,KAAKwrB,YAAY,GAAIxrB,KAAKwrB,YAAY,GAC5E,CACO0gC,yBAAyB5gC,GAC9BtrB,KAAKuN,GAAGioB,aAAarf,eAAe2M,eAAespC,iBAAiB9gC,EACtE,EC3BK,MAAM+gC,GAKXxsD,YAAY0N,GAA8B,KAJnCA,QAAE,OACF++C,QAAU,GAAG,KACZt7C,KAAiB,GAGvBhR,KAAKuN,GAAKA,CACZ,CACOpM,KAAKiN,GACVpO,KAAKgR,KAAK7P,KAAKiN,GACXpO,KAAKgR,KAAK9P,OAASlB,KAAKssD,SAC1BtsD,KAAKgR,KAAKf,OAEd,CACOxM,OAAOC,GACZA,EAAI8b,UAAY+sC,EAAAA,GAAAA,KAChB7oD,EAAIM,UAAY,UAChBN,EAAI3D,KAAI,aAIR,IAAIkB,EAAIjB,KAAKgR,KAAK9P,OAClB,KAAOD,KACLyC,EAAIkB,SAAS,QAAD,OACF5E,KAAKgR,KAAK/P,IACC,GAAnByC,EAAIggC,OAAOpgC,MANL,IACK,IAMGtD,KAAKgR,KAAK9P,OAASD,GAGvC,ECuBK,MAAMurD,GAmBX3sD,YAAY21B,GAA6B,KAlBlCA,kBAAY,OACZlnB,kBAAY,OACZ4wB,eAAS,OAETutB,cAAQ,OACRnyB,mBAAa,OACboyB,UAAY,GAAG,KACfnsD,KAA0B85B,EAAAA,GAAAA,KAAuB,KACjD5c,OAAC,OACDkvC,aAAO,OACPC,gBAAkB,GAAG,KACrBljC,uBAAiB,OACjB6B,2BAAqB,OACrBshC,gBAAU,OACVj/C,YAAc,EAAE,KACfk/C,iBAAW,OACXC,eAAgB,EAAM,KACtBC,oBAAsB,EAE5BhtD,KAAKsO,aAAe,IAAIq6C,GAAwB3oD,MAChDA,KAAKw1B,aAAeA,EACpBx1B,KAAKysD,SAAW,CAEd,CAACpyB,EAAAA,GAAAA,eAAkC,IAAIksB,GAA6BvmD,MACpE,CAACq6B,EAAAA,GAAAA,gBAAmC,IAAImsB,GAA8BxmD,MACtE,CAACq6B,EAAAA,GAAAA,YAA+B,IAAIosB,GAAmBzmD,MAEvD,CAACq6B,EAAAA,GAAAA,cAAiC,IAAIqsB,GAAoB1mD,MAC1D,CAACq6B,EAAAA,GAAAA,cAAiC,IAAIssB,GAA0B3mD,MAChE,CAACq6B,EAAAA,GAAAA,YAA+B,IAAIusB,GAAsB5mD,MAC1D,CAACq6B,EAAAA,GAAAA,aAAgC,IAAIysB,GAA4B9mD,MAEjE,CAACq6B,EAAAA,GAAAA,UAA6B,IAAI2tB,GAAyBhoD,MAC3D,CAACq6B,EAAAA,GAAAA,qBAAwC,IAAI6tB,GAAmCloD,MAChF,CAACq6B,EAAAA,GAAAA,kBAAqC,IAAI4tB,GAAqCjoD,MAE/E,CAACq6B,EAAAA,GAAAA,SAA4B,IAAI8tB,GAAwBnoD,MACzD,CAACq6B,EAAAA,GAAAA,eAAkC,IAAI+tB,GAA6BpoD,MACpE,CAACq6B,EAAAA,GAAAA,oBAAuC,IAAIiuB,GAAkCtoD,MAC9E,CAACq6B,EAAAA,GAAAA,kBAAqC,IAAIguB,GAAgCroD,MAG1E,CAACq6B,EAAAA,GAAAA,iBAAoC,IAAIkuB,GAA4BvoD,MAErE,CAACq6B,EAAAA,GAAAA,mBAAsC,IAAI0sB,GAA2B/mD,MACtE,CAACq6B,EAAAA,GAAAA,2BAA8C,IAAI2sB,GAAkChnD,MACrF,CAACq6B,EAAAA,GAAAA,kBAAqC,IAAI4sB,GAA0BjnD,MACpE,CAACq6B,EAAAA,GAAAA,wBAA2C,IAAI6sB,GAA+BlnD,MAC/E,CAACq6B,EAAAA,GAAAA,gBAAmC,IAAI8sB,GAAwBnnD,MAChE,CAACq6B,EAAAA,GAAAA,uBAA0C,IAAI+sB,GAA8BpnD,MAE7E,CAACq6B,EAAAA,GAAAA,cAAiC,IAAImuB,GAA6BxoD,MACnE,CAACq6B,EAAAA,GAAAA,2BAA8C,IAAIouB,GAAyCzoD,MAK5F,CAACq6B,EAAAA,GAAAA,MAAyB,IAAI0J,GAAmB/jC,MACjD,CAACq6B,EAAAA,GAAAA,QAA2B,IAAI4J,GAAwBjkC,MACxD,CAACq6B,EAAAA,GAAAA,QAA2B,IAAI2J,GAAqBhkC,MACrD,CAACq6B,EAAAA,GAAAA,aAAgC,IAAI6J,GAA4BlkC,MACjE,CAACq6B,EAAAA,GAAAA,cAAiC,IAAI8J,GAA6BnkC,MAGnE,CAACq6B,EAAAA,GAAAA,WAA8B,IAAIgtB,GAAqBrnD,MACxD,CAACq6B,EAAAA,GAAAA,MAAyB,IAAIquB,GAAmB1oD,MACjD,CAACq6B,EAAAA,GAAAA,QAA2B,IAAIstB,GAAuB3nD,MACvD,CAACq6B,EAAAA,GAAAA,wBAA2C,IAAIutB,GAAqC5nD,MACrF,CAACq6B,EAAAA,GAAAA,iCAAoD,IAAIytB,GAA8C9nD,OAGzGA,KAAKyd,EAAI,IAAIwvC,EAAAA,GACbjtD,KAAK2sD,QAAU3sD,KAAKyd,EAAE1N,WACtB/P,KAAKs6B,cAAgB,IAAIyJ,GAAmB/jC,MAC5CA,KAAKk/B,UAAY,IAAImtB,GAAUrsD,MAC/BA,KAAKktD,WAAa7yB,EAAAA,GAAAA,OAClBr6B,KAAK0pB,kBAAoB,IAAIghC,GAAkB1qD,MAC/CA,KAAKurB,sBAAwB,IAAIqgC,GAAY5rD,MAM7CA,KAAKm6B,iBAAiBE,EAAAA,GAAAA,OACxB,CAEO2xB,eAAe1rD,GACpB,CAEK6sD,eAAejqD,GAChBA,EAAI,KACNlD,KAAK4N,YAAc1K,EACnBlD,KAAKw1B,aAAa5mB,oBAAoBC,cAE1C,CACOsrB,iBAAiBizB,GACtBA,EAAQptD,KAAKqtD,0BAA0BD,GACzB/yB,EAAAA,GAAAA,0BAKdr6B,KAAKsO,aAAayQ,YAAa,EAU7B/e,KAAKw1B,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAAoBC,OAC/EC,EAAAA,GAAAA,SAMEm3C,IAAU/yB,EAAAA,GAAAA,QAA4B+yB,IAAU/yB,EAAAA,GAAAA,KAClDr6B,KAAKsO,aAAa4xB,WAAY,EAE9BlgC,KAAKsO,aAAa4xB,WAAY,EAGhClgC,KAAKstD,WAELttD,KAAKs6B,cAAgBt6B,KAAKysD,SAASW,GACnCptD,KAAKO,KAAO6sD,EAEZptD,KAAK0pB,kBAAkBoY,uBAAuB9hC,KAAKO,MAOjDP,KAAKO,OAAS85B,EAAAA,GAAAA,eACdr6B,KAAKO,OAAS85B,EAAAA,GAAAA,YACdr6B,KAAKO,OAAS85B,EAAAA,GAAAA,gBACdr6B,KAAKO,OAAS85B,EAAAA,GAAAA,KAEdr6B,KAAKsO,aAAa+6C,kBAAmB,EAErCrpD,KAAKsO,aAAa+6C,kBAAmB,GA7BrCrpD,KAAKs6B,cAAgBt6B,KAAKysD,SAASW,EA+BvC,CACO5qC,aAAyD,IAA9C+qC,EAAyB,uDAAGvtD,KAAKktD,WAC5CltD,KAAKsO,aAAay6C,iBAMvB/oD,KAAKm6B,iBAAiBozB,GACtBvtD,KAAKw1B,aAAazrB,GAAGC,wBAAwBwjD,YAAYD,GAC3D,CACW1T,uBAAmB32C,GAC5BlD,KAAKgtD,oBAAsB,EAAI16C,KAAKm7C,MAAMvqD,EAAI,EAChD,CACW22C,yBACT,OAAO75C,KAAKgtD,mBACd,CACWE,iBACT,OAAOltD,KAAK8sD,WACd,CACWI,eAAWhqD,GAIpBlD,KAAK8sD,YAAc5pD,CACrB,CACWmkB,mBACT,OAAOrnB,KAAK+sD,aACd,CACW1lC,iBAAankB,GACtBlD,KAAK+sD,cAAgB7pD,CACvB,CACWktC,kBAAcltC,GACvBlD,KAAKsO,aAAayxB,cAAgB78B,CAEpC,CACWktC,oBACT,OAAOpwC,KAAKsO,aAAayxB,aAC3B,CACO2tB,aAAapqD,EAAeC,GAIjC,CAEK+pD,WACLttD,KAAKsO,aAAayQ,YAAa,EAE7B/e,KAAKw1B,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAAoBC,OAC/EC,EAAAA,GAAAA,gBAIF4f,EAAsBtT,OAAOviB,KAAKw1B,aAAa7xB,OAC/CwjB,EAAgB5E,OAAOviB,KAAKw1B,aAAa7xB,OACzCke,EAAiBU,OAAOviB,KAAKw1B,aAAa7xB,OAG5C,CAEOgqD,qBACL,CAEKC,wBACLn+B,EAAkBm+B,sBAAsB5tD,KAAKw1B,aAAa7xB,MAC5D,CAEOkqD,iBAAiBC,GACtB9tD,KAAKw1B,aAAarf,eAAe2M,eAAe+qC,iBAAiBC,EACnE,CACOC,0BAA0BD,GAC/B9tD,KAAKw1B,aAAarf,eAAe2M,eAAeirC,0BAA0BD,EAC5E,CACOE,qBAAqB/Z,GAC1Bj0C,KAAKw1B,aAAarf,eAAe2M,eAAekrC,qBAAqB/Z,EACvE,CAIOga,eAAeC,EAAgB5tD,EAAY6tD,GAChDnuD,KAAKouD,iBAAiBF,EAAQ5tD,EAAI6tD,EACpC,CACOE,iBACLruD,KAAKw1B,aAAarf,eAAe2M,eAAeyX,2BAClD,CACO6zB,iBAAiBF,EAAgB5tD,EAAY6tD,GAC9CD,IAAWI,EAAAA,GAAAA,oBAAuC3rD,IAAXwrD,GACzCnuD,KAAKw1B,aAAarwB,SAASmR,KAAKgpC,MAAMiP,UAAUjuD,EAAI6tD,GAElDD,IAAWI,EAAAA,GAAAA,kBACbtuD,KAAKw1B,aAAarwB,SAASmR,KAAKgpC,MAAMkP,aAAaluD,EAEvD,CACOmuD,iBAAiBnhD,GAAqD,IAAlCohD,EAAc,uDAAG1uD,KAAK0sD,UAC/D,OAAI1sD,KAAKsO,aAAaovB,MACpBpwB,EAAElM,EAAIkR,KAAKm7C,MAAMngD,EAAElM,EAAIstD,GAAUA,EACjCphD,EAAEjM,EAAIiR,KAAKm7C,MAAMngD,EAAEjM,EAAIqtD,GAAUA,EAC1BphD,GAEFA,CACT,CACO0mC,iBAAiB1zC,EAAYQ,GAClCd,KAAKw1B,aAAarf,eAAe2M,eAAekxB,iBAAiB1zC,EAAIQ,EACvE,CACO6tD,YAAYC,GACjB5uD,KAAKw1B,aAAarf,eAAe2M,eAAe6rC,YAAYC,EAC9D,CACOC,kBACL7uD,KAAKw1B,aAAarf,eAAe+X,cAAciP,mBAC/Cn9B,KAAKw1B,aAAarf,eAAe2M,eAAegsC,eAChD9uD,KAAKw1B,aAAarf,eAAe2M,eAAeoZ,WAClD,CACO5G,iBAAiBhoB,GACtB,GAAItN,KAAKw1B,aAAa3xB,gBAAgBC,IAAIkI,MAAM+iD,aAAahR,IAAK,CAChE,MAAMv5C,EAAMxE,KAAKw1B,aAAa3xB,gBAAgBC,IAAIkI,MAAM+iD,aAAaC,uBAAuB1hD,EAAElM,EAAGkM,EAAEjM,GACnGiM,EAAElM,EAAIoD,EAAI,GACV8I,EAAEjM,EAAImD,EAAI,GAMV8I,EAAElM,GAAKpB,KAAKw1B,aAAa7xB,MAAM0lB,cAAcC,mBAAmBloB,EAChEkM,EAAEjM,GAAKrB,KAAKw1B,aAAa7xB,MAAM0lB,cAAcC,mBAAmBjoB,CAQlE,CAEF,CACOi+B,YAAYhyB,GAMjB,OALAtN,KAAKs1B,iBAAiBhoB,GACtBtN,KAAK2sD,QAAUr/C,EAAEyC,WACjBzC,EAAItN,KAAKyuD,iBAAiBnhD,GAC1BtN,KAAKw1B,aAAa8F,WAAWC,YAAYgB,UAAUjvB,EAAElM,EAAGkM,EAAEjM,GAC1DrB,KAAKyd,EAAInQ,EACFA,CACT,CACO2F,KAAK27C,GACV5uD,KAAKw1B,aAAarf,eAAe2M,eAAe7P,KAAK27C,EACvD,CACOK,OAAOL,GACZ5uD,KAAKw1B,aAAarf,eAAe2M,eAAemsC,OAAOL,EACzD,CACOM,8BAA8BhsD,GACnClD,KAAKw1B,aAAarf,eAAe2M,eAAeosC,8BAA8BhsD,EAChF,CACOisD,wCAAwCjsD,GAC7ClD,KAAKw1B,aAAarf,eAAe2M,eAAeqsC,wCAAwCjsD,EAC1F,CAEOksD,cAAcR,GACnB5uD,KAAKw1B,aAAarf,eAAe2M,eAAessC,cAAcR,EAChE,CACOS,UAAU/uD,GACfN,KAAKw1B,aAAarf,eAAe2M,eAAeusC,UAAU/uD,EAC5D,CACOgvD,iBACLtvD,KAAKw1B,aAAa3xB,gBAAgBC,IAAIkI,MAAMyW,UAAU+Z,UACxD,CACO+yB,gBACLvvD,KAAKw1B,aAAa/lB,cAAc8/C,eAClC,CACOC,QACLxvD,KAAKw1B,aAAa3xB,gBAAgBC,IAAI0rD,OACxC,CACOC,SACLzvD,KAAKw1B,aAAa3xB,gBAAgBC,IAAI2rD,QACxC,CACOhkD,YACL,OAAIzL,KAAKsO,aAAa06C,WAIxB,CACQqE,0BAA0BD,GAIhC,OAAOA,CACT,CACO3C,gBAAgBvnD,IAIhBA,GAAKlD,KAAKw1B,aAAa7xB,MAAM0nD,2BAA2BnqD,OAAS,EACpElB,KAAKw1B,aAAa5mB,oBAAoBmD,cAAcC,QAAQ09C,cAAe,EAG7E1vD,KAAKw1B,aAAa5mB,oBAAoBmD,cAAcC,QAAQ09C,cAAe,CAC7E,CACO5xB,yBAEL99B,KAAKm6B,iBAAiBE,EAAAA,GAAAA,WACxB,CACOs1B,iBAAiBjhD,GAAsE,IAAvDkhD,IAAiB,yDAAS3D,IAAmB,yDAClF,MAAMvqD,EAAM1B,KAAKw1B,aAAarf,eAAe2M,eAAegd,cAC5D,GAAGp+B,GAAOA,EAAIR,OAAS,EACrB,IAAK,IAAID,EAAI,EAAGA,EAAIS,EAAIR,SAAUD,EAC5B2uD,EACFluD,EAAIT,GAAGwN,cAAcC,GAEjBA,EAAQhN,EAAIT,GAAGoC,eAAe1C,YAAYgO,WAAa,IACzDjN,EAAIT,GAAGwN,cAAcC,EAAQhN,EAAIT,GAAGoC,eAAe1C,YAAYgO,iBAKjEihD,EACF5vD,KAAKw1B,aAAahqB,wBAAwB2hD,eAAez+C,GAEzD1O,KAAKw1B,aAAahqB,wBAAwB2hD,eAAez+C,EAAQ1O,KAAKw1B,aAAahqB,wBAAwBoC,aAG3Gq+C,GACFjsD,KAAKw1B,aAAa7xB,MAAMooD,eAE1B/rD,KAAKs6B,cAAcZ,IAAIlE,aAAa5mB,oBAAoBC,aAC1D,EChaK,MAAMghD,GAEXhwD,YAAYiwD,GAAuB,KAD5BA,UAAI,EAET9vD,KAAK8vD,KAAOA,CACd,CACOC,eAML,MAAMC,EAAOtkD,SAASC,cAAc,KACpCqkD,EAAKxzB,SAAW,eAChBwzB,EAAKC,KAAOjwD,KAAK8vD,KAAKlsD,mBAAmBgL,oBAAoBmD,cAAcC,QAAQ0xB,OAAOwsB,UAAU,cACpGF,EAAKG,OACP,CACOC,wBAAwB1uD,GAC7B,MAAMV,EAAK,GACX,IAAK,IAAIC,EAAI,EAAGA,EAAIS,EAAIR,SAAUD,EAAG,CACnC,MAAMiC,EAAIxB,EAAIT,GAAGoK,cACjB,IAAK,IAAI6Q,EAAI,EAAGA,EAAIhZ,EAAEhC,SAAUgb,EAC9Blb,EAAGG,KAAK+B,EAAEgZ,GAEd,CACA,OAAO4R,EAAAA,EAAAA,IAAkB9sB,EAC3B,CACOqvD,mBAAmBjvD,EAAWC,GACnC,IAAIJ,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAapvD,OACxD,GAAU,IAAND,EAGJ,GAAU,IAANA,EAAJ,CAQA,KAAOA,KACL,GAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAarvD,GAAI,CACtD,MAAMwI,EAAIzJ,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAarvD,GAC1DwI,EAAE1D,iBAAkB,EACpB,MAAMwqD,EAAKvwD,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAarvD,GAAG8O,SAC5DtG,EAAEvG,EAAE9B,EAAIA,EACRqI,EAAEvG,EAAE7B,EAAIA,GAEV,GAAIkvD,EAAI,CACN,MAAMpxC,EAAKoxC,EACXpxC,EAAG3e,YAAa,EAChB2e,EAAG/U,SAAU,CAGf,CACF,CAEFpK,KAAK8vD,KAAKlsD,mBAAmB4H,wBAAwB2uB,iBAAiBE,EAAAA,GAAAA,KAnBtE,MALEr6B,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAa,GAAGvgD,SACjD/P,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAa,GAAG1tD,IAAIxB,EAAIA,EAC3DpB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAa,GAAG1tD,IAAIvB,EAAIA,EAuBjE,CACOk8B,YAAYn8B,EAAWC,GAC5B,IAAIJ,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAapvD,OACxD,GAAU,IAAND,EACF,OAEF,GAAU,IAANA,EAEF,YADAjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAa,GAAGvgD,SAAS3O,EAAGC,GAGjE,MAAMmvD,GAAexnD,EAAAA,EAAAA,MACrB,KAAO/H,KACLuvD,EAAGC,IAAIzwD,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAarvD,GAAGiC,GAK5D,IAHAjC,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAapvD,OACpDsvD,EAAGpvD,EAAIA,EAAIovD,EAAGpvD,EAAIH,EAClBuvD,EAAGnvD,EAAIA,EAAImvD,EAAGnvD,EAAIJ,EACXA,KACL,GAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAarvD,GAAI,CACtD,MAAMwI,EAAIzJ,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAarvD,GAC1DwI,EAAE1D,iBAAkB,EACpB,MAAMwqD,EAAKvwD,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAarvD,GAAG8O,SAC5DtG,EAAEvG,EAAE9B,EAAIovD,EAAGpvD,EACXqI,EAAEvG,EAAE7B,EAAImvD,EAAGnvD,GAEb,GAAIkvD,EAAI,CACKA,EACR/vD,YAAa,CAGlB,CACF,CAEFR,KAAK8vD,KAAK5hC,cAAc6K,wBAC1B,CACO23B,YACL,OAAO1wD,KAAK8vD,KAAKlsD,mBAAmBgL,oBAAoBmD,cAAcC,QAAQtO,IAAIggC,MACpF,ECpEK,MAAMitB,GAgBX9wD,YAAYiwD,GAAuB,KAD5BA,UAAI,EAET9vD,KAAK8vD,KAAOA,CACd,CACWxsD,YACT,OAAQtD,KAAK8vD,KAAKlsD,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiB2kD,QAAQhlD,MAAMtI,MAAM0jB,MAClG,MACA,EACJ,CACWzjB,aACT,OAASvD,KAAK8vD,KAAKlsD,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiB2kD,QAAQhlD,MAAMrI,OAAOyjB,MACpG,MACA,EACJ,CACOwa,qBAAqBl0B,GAC1B,IAAIrM,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,KAAOD,KACL,GAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGmJ,QAErD,OADApK,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG0P,gBAAgBrD,IAC5D,EAGX,OAAO,CACT,CACO+B,cAQL,CAIKyhD,sDAAsDxjD,GAkB3D,CAEK60B,gBAAgB70B,GACrB,IAAK,IAAIrM,EAAI,EAAGA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,SAAUD,EAC5E,GACEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGwF,iBAClDzG,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGT,YAClDR,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,OAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,aAC9D,CAKA,MAAM2jB,EAAK/vB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGyM,gBAAgBJ,EAAElM,EAAGkM,EAAEjM,QAC1EsB,IAAPotB,GAA2B,OAAPA,GACtBA,EAAG7c,0BAA0B5F,GAC7BtN,KAAK8vD,KAAKlsD,mBAAmBD,MAAMmb,QAAUiR,GAE7C/vB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGiS,0BAA0B5F,EAEjF,CAEJ,CA+BO40B,aAAa50B,GAmBlB,CAGKwhD,eACL,IAAInkD,EAAIsG,EAAWD,KAAK9P,OACxB,GAAU,IAANyJ,EACF,OAEF,KAAOA,KACLsG,EAAWD,KAAKrG,GAAG8F,SAErB,IAAIxP,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,GAAU,IAAND,EAGJ,KAAOA,KAGLjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGwP,QAEvD,CACOovB,qBACL,IAAI5+B,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,GAAU,IAAND,EAGJ,KAAOA,KACLjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG0D,aAAc,CAErE,CACOolB,4BAA4B1Z,GACjC,GAAIA,EAAE9P,OAAS6L,EAAAA,GAAAA,cAAqB,CAElC,OADeiE,EACD0Z,6BAChB,CAAO,GAAI1Z,EAAE9P,OAAS6L,EAAAA,GAAAA,iBAAwB,CAE5C,OADmBiE,EACD0Z,6BACpB,CAAO,GAAI1Z,EAAE9P,OAAS6L,EAAAA,GAAAA,UAAiB,CAErC,OADaiE,EACD0Z,6BACd,CAAO,GAAI1Z,EAAE9P,OAAS6L,EAAAA,GAAAA,OAAc,CAElC,OADYiE,EACD+e,6BACb,CAGA,QAAI/e,EAAE/F,gBAAkB+F,EAAE/F,eAAe+I,aACnCnG,EAAAA,EAAAA,IAAYmD,EAAE/F,eAAe+I,WAAWC,GAAIjD,EAAEzN,KAAO,KACvDyN,EAAE/F,eAAe2f,mBAAgBtnB,EACjC0N,EAAE/F,oBAAiB3H,GACZ,EAIb,CAEOs+B,6BACL,IAAIhgC,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,GAAIlB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,QACrC,KAAO1R,KAEHjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,UACnC3S,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAEhDjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG8E,iBAAkB,EAErE/F,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG8E,iBAAkB,OAIzE,KAAO9E,KACLjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG8E,iBAAkB,CAG3E,CACO+jC,4BACL,IAAI7oC,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMotD,yBAAyB7vD,OACpE,KAAOD,KACLjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMotD,yBAAyB9vD,GAAG6oC,2BAEnE,CACOzM,aACLr9B,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAe,GAClD,IAAIrvD,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,KAAOD,MAEHjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGT,YACnDR,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG2E,eAEnD5F,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2sD,aAAanvD,KAC9CnB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,IAItDjB,KAAK8vD,KAAKlsD,mBAAmB4H,wBAAwB2uB,iBAAiBE,EAAAA,GAAAA,KACxE,CACOiL,mBAAmBlkC,EAAWC,EAAW4b,GAM9C,MAAM+zC,EAAO/zC,EAAM,EAKbg0C,EAAajxD,KAAK8vD,KAAK15C,eAAe86C,MAAM9vD,EAAI4vD,EAAM3vD,GAG5D,MAFqB,CAAC4vD,EAAW,GAAIA,EAAW,IAE5B,GAAK7vD,CAC3B,CAKO+vD,kBAAkBzvD,GAEnBA,IAAQ1B,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0+B,iBAC7CriC,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0+B,eAAiB3gC,EAGxD,CACOwH,aAAaxH,GAElB,OAAa,CACX,MAAM+S,GAAM28C,EAAAA,EAAAA,MACZ,IAAKpxD,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0tD,cAAc58C,GAEpD,OADAzU,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0tD,cAAc58C,GAAO/S,EACjD+S,CAEX,CACF,CACO68C,kBAAkB3mD,GACvB,OAAO3K,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0tD,cAAc1mD,EAC1D,CACOg5C,oCAAoCviD,EAAWC,EAAWkwD,GAE/D,MAAM98C,EAAMzU,KAAKwxD,oBAAoBpwD,EAAGC,EAAG,EAAI,GACzCwiD,EAAY,GAClB,OACE4N,EAAAA,EAAAA,IAAiBh9C,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAI88C,EAAU,GAAIA,EAAU,GAAIA,EAAU,IAAM1N,IACrF4N,EAAAA,EAAAA,IAAiBh9C,EAAI,GAAMA,EAAI,GAAMA,EAAI,GAAM88C,EAAU,GAAIA,EAAU,GAAIA,EAAU,IAAM1N,IAC3F4N,EAAAA,EAAAA,IAAiBh9C,EAAI,GAAUA,EAAI,GAAUA,EAAI,IAAU88C,EAAU,GAAIA,EAAU,GAAIA,EAAU,IAAM1N,IACvG4N,EAAAA,EAAAA,IAAiBh9C,EAAI,IAAUA,EAAI,IAAUA,EAAI,IAAU88C,EAAU,GAAIA,EAAU,GAAIA,EAAU,IAAM1N,IACvG4N,EAAAA,EAAAA,IAAiBh9C,EAAI,IAAUA,EAAI,IAAUA,EAAI,IAAU88C,EAAU,GAAIA,EAAU,GAAIA,EAAU,IAAM1N,IACvG4N,EAAAA,EAAAA,IAAiBh9C,EAAI,IAAUA,EAAI,IAAUA,EAAI,IAAU88C,EAAU,GAAIA,EAAU,GAAIA,EAAU,IAAM1N,IACvG4N,EAAAA,EAAAA,IAAiBh9C,EAAI,IAAUA,EAAI,IAAUA,EAAI,IAAU88C,EAAU,GAAIA,EAAU,GAAIA,EAAU,IAAM1N,IACvG4N,EAAAA,EAAAA,IAAiBh9C,EAAI,IAAUA,EAAI,IAAUA,EAAI,IAAU88C,EAAU,GAAIA,EAAU,GAAIA,EAAU,IAAM1N,IACvG4N,EAAAA,EAAAA,IAAiBh9C,EAAI,IAAUA,EAAI,IAAUA,EAAI,IAAU88C,EAAU,GAAIA,EAAU,GAAIA,EAAU,IAAM1N,CAK3G,CACOv/B,yBAAyBljB,EAAWC,EAAWsJ,GAEpD,MAAM8J,EAAMzU,KAAK0xD,mBAAmBtwD,EAAGC,GAEvC,SADcrB,KAAKsxD,kBAAkB78C,IACxBA,IAAQ9J,EAIvB,CAEOmvC,0BAA0B14C,EAAWC,EAAWwJ,GACrD,MAAM4b,EAAK,IAAIpkB,EAAAA,GAASjB,EAAGC,GAC3B,IAAIJ,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMguD,cAAczwD,OACrDonC,GAAY,EAChB,KAAOrnC,KAAK,CACV,GAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMguD,cAAc1wD,GAAG8B,WACtD,SAIF,GAAI/C,KAAK8vD,KAAKlsD,mBAAmBD,MAAMguD,cAAc1wD,GAAGV,OAAS6L,EAAAA,GAAAA,UAAiB,CAChF,MAAMwe,EAAQ5qB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMguD,cAAc1wD,GAC/D,GAAI2pB,EAAMpO,OAAO,IAAMoO,EAAMpO,OAAO,GAAGgB,OAAOjd,OAAS6L,EAAAA,GAAAA,iBACrD,QAEJ,CAEA,MAAM6Q,GAAM/P,EAAAA,EAAAA,IAAYlN,KAAK8vD,KAAKlsD,mBAAmBD,MAAMguD,cAAc1wD,GAAG2B,IAAK6jB,GAC7ExJ,EAAMpS,IACRA,EAAMoS,EACNqrB,EAAWrnC,EAEf,CAIA,IADAA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMiuD,sBAAsB1wD,OACtDD,KAAK,CACV,MAAMsV,EAAQvW,KAAK8vD,KAAKlsD,mBAAmBD,MAAMiuD,sBAAsB3wD,GAEvE,GADAsV,EAAM3L,qBAAqB6b,EAAI5b,GAC3B0L,EAAM/N,oBAAqB,CAC7B,IAAI0E,EAAAA,EAAAA,IAAYqJ,EAAM/N,oBAAqBie,GAAM,EAC/C,OAAOlQ,EAETA,EAAM/N,yBAAsB7F,CAC9B,CACF,CAEA,IADA1B,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMqhC,oBAAoB9jC,OACpDD,KAAK,CACV,MAAMsV,EAAQvW,KAAK8vD,KAAKlsD,mBAAmBD,MAAMqhC,oBAAoB/jC,GAErE,GADAsV,EAAM3L,qBAAqB6b,EAAI5b,GAC3B0L,EAAM/N,oBAAqB,CAC7B,IAAI0E,EAAAA,EAAAA,IAAYqJ,EAAM/N,oBAAqBie,GAAM,EAC/C,OAAOlQ,EAETA,EAAM/N,yBAAsB7F,CAC9B,CACF,CAGA,GAAI2lC,GAAY,EACd,OAAOtoC,KAAK8vD,KAAKlsD,mBAAmBD,MAAMguD,cAAcrpB,GAG1D,IADArnC,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMotD,yBAAyB7vD,OACzDD,KAAK,CACV,MAAMkwB,EAAKnxB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMotD,yBAAyB9vD,GAAGypC,eACxEjkB,EACA5b,GAEF,GAAIsmB,EACF,OAAOA,CAEX,CAEF,CACOqgC,oBAAoBpwD,EAAWC,GAAgD,IAArCwwD,EAAY,uDAAG,EAAGC,EAAY,uDAAG,EAChF,OAAO9xD,KAAK8vD,KAAKlsD,mBAAmBuB,SAASuc,aAAaqwC,aAAa3wD,EAAGC,EAAGwwD,EAAMC,GAAMhxD,IAC3F,CACO4wD,mBAAmBtwD,EAAWC,GACnC,MAAM2wD,EAAQhyD,KAAKwxD,oBAAoBpwD,EAAGC,GAE1C,MADS,cAAU2wD,EAAM,GAAE,YAAIA,EAAM,GAAE,YAAIA,EAAM,GAAE,IAErD,CACOC,YACL,MAAM/sC,EAAM,GACZ,IAAIjkB,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,KAAOD,KACDjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGT,YACrD0kB,EAAI/jB,KAAKnB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,IAG7D,OAAOikB,CACT,CAEOgtC,WAAW5xD,GAChB,IAAIW,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,KAAOD,KACL,GAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGX,KAAOA,EAC5D,OAAON,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,EAI7D,CACOkxD,eAAe7xD,GACpB,IAAIW,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM+hD,WAAWxkD,OACtD,KAAOD,KACL,GAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM+hD,WAAWzkD,GAAGX,KAAOA,EAC1D,OAAON,KAAK8vD,KAAKlsD,mBAAmBD,MAAM+hD,WAAWzkD,EAI3D,CACOmxD,gBAAgB9xD,EAAYkT,GACjC,MAAM/J,EAAIzJ,KAAKmyD,eAAe7xD,GAC1BmJ,IACFA,EAAEk8C,WAAWnyC,GACbxT,KAAK8vD,KAAK15C,eAAevH,cAE7B,CACOwjD,sBAEL,GAAIryD,KAAK8vD,KAAKlsD,mBAAmBD,MAAMmb,QAAS,CAC9C,MAAMpd,EAAM1B,KAAK8vD,KAAKlsD,mBAAmBD,MAAMmb,QAAQ/O,SACrD/P,KAAK8vD,KAAKlsD,mBAAmBD,MAAMmb,QAAQlc,IAAIxB,EAC/CpB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMmb,QAAQlc,IAAIvB,GAEjDrB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMmb,QAAQ1U,SAAU,EACrDpK,KAAK8vD,KAAKlsD,mBAAmBD,MAAMmb,QAAQte,YAAa,EACpDkB,IACFA,EAAI0I,SAAU,EACdpK,KAAK8vD,KAAKlsD,mBAAmBD,MAAMmb,QAAUpd,EAEjD,CACA,MAAM4wD,EAAOtyD,KAAK8/B,cAClB,QAAan9B,IAAT2vD,EACF,IAAK,MAAMC,KAAUD,EAAM,CAEzBC,EAAO/xD,YAAa,EACpB+xD,EAAOnoD,SAAU,EACjB,MAAMiG,EAAIkiD,EAAOxiD,SAASwiD,EAAO3vD,IAAIxB,EAAGmxD,EAAO3vD,IAAIvB,GAC/CgP,IACFA,EAAE7P,YAAa,EACf6P,EAAEjG,SAAU,EAEhB,CAEJ,CACOooD,oBACL,MAAM9wD,EAAM,GACZ,IAAK,IAAIT,EAAI,EAAGA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,SAAUD,EAE1EjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,YAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,cAI1DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG8E,iBACrDrE,EAAIP,KAAKnB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGX,IAGhE,OAAOoB,CACT,CACOsyC,iBAAiB1zC,EAAYQ,GAClC,MAAMY,EAAM1B,KAAKkyD,WAAW5xD,GAC5B,GAAIoB,GAAOA,EAAInB,OAAS6L,EAAAA,GAAAA,gBAAuB,CACjC1K,EACRsyC,iBAAiBlzC,EACvB,CACF,CACO6tD,YAAYC,GACjB,MAAM6D,EAAuB,GAC7Bve,KAAKC,MAAMya,GAAK5oC,SAAS1lB,IACvB,MAAMiW,EAAQvW,KAAKkyD,WAAW5xD,GAC9B,GAAIiW,EAAO,CACT,MAAM6H,EAAQ7H,EAAM/M,SAChB4U,IACFq0C,EAAOtxD,KAAKid,GACZ7H,EAAM9F,QAAO,GAEjB,KAEFzQ,KAAK8vD,KAAKlsD,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB8tC,GAC5EzyD,KAAK8vD,KAAK15C,eAAevH,aAC3B,CACO6jD,mBACL1yD,KAAK8vD,KAAK5hC,cAAcC,qBACxBnuB,KAAK2yD,uBACL,IAAI1xD,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0nD,2BAA2BnqD,OACtE,KAAOD,KACDjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0nD,2BAA2BpqD,IAChEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0nD,2BAA2BpqD,GAAGqzC,YAIrEt0C,KAAK4yD,eACL5yD,KAAK6yD,mBACP,CACOhF,iBAAiBC,GACtB9tD,KAAK0yD,mBAEL5E,EAAO9nC,SAAStkB,IACd1B,KAAK8yD,mBAAmBpxD,GAAK,EAAK,IAGpC1B,KAAK+yD,gCACL/yD,KAAK8vD,KAAKlsD,mBAAmB4H,wBAAwB8C,aAAaoxB,sBAAuB,EACzF1/B,KAAK8vD,KAAK15C,eAAevH,aAC3B,CACOk/C,0BAA0BD,GAS/B9tD,KAAK0yD,mBAEL5E,EAAO9nC,SAAStkB,IACd1B,KAAK8yD,mBAAmBpxD,GAAK,EAAK,IAGpC1B,KAAK+yD,gCACL/yD,KAAK8vD,KAAKlsD,mBAAmB4H,wBAAwB8C,aAAaoxB,sBAAuB,EACzF1/B,KAAK8vD,KAAK15C,eAAevH,aAC3B,CACOoE,KAAK27C,GACV,IAAIvtC,EAAIutC,EAAI1tD,OACZ,KAAOmgB,KACL,IAAK,IAAIpgB,EAAI,EAAGA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,SAAUD,EACxEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGX,KAAOsuD,EAAIvtC,KAChErhB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGe,cAAe,EAClEhC,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGP,UAAW,EAC9DV,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGoJ,WAAa,EAIxE,CACO4kD,OAAOL,GACZ,IAAIvtC,EAAIutC,EAAI1tD,OACZ,KAAOmgB,KACL,IAAK,IAAIpgB,EAAI,EAAGA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,SAAUD,EACxEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGX,KAAOsuD,EAAIvtC,KAChErhB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGe,cAAe,EAClEhC,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGP,UAAW,EAC9DV,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGoJ,WAAa,EAIxE,CACO6kD,8BAA8BhsD,GACnC,GACElD,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,SACnC3S,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,SACpD,CACA,MAAM6Q,EAAgB,IAAT/Z,EAAI,GACNlD,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,QAC3C8M,yBAA2BxC,CAChC,CACF,CACOkyC,wCAAwCjsD,GAC7C,GACElD,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,SACnC3S,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,SACpD,CACWpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,QAC3CsS,mCAAqC/hB,CAC1C,CACF,CACOksD,cAAcR,GACnB,MAAMoE,EAAa,GACnB,IAAK,IAAI/xD,EAAI,EAAGA,EAAI2tD,EAAI1tD,SAAUD,EAChC+xD,EAAW7xD,KAAKnB,KAAKkyD,WAAWtD,EAAI3tD,KAEtC,IAAK,IAAIib,EAAI,EAAGA,EAAI82C,EAAW9xD,SAAUgb,EACvC,IAAK,IAAIjb,EAAI,EAAGA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,SAAUD,EACxEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,KAAO+xD,EAAW92C,GACpElc,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGiK,SAAU,EAE7DlL,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGiK,SAAU,CAIrE,CACOmkD,UAAU/uD,GACfN,KAAK8vD,KAAKlsD,mBAAmBuB,SAASmP,WAAY,EAClD,IAAK,IAAIrT,EAAI,EAAGA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,SAAUD,EACxEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGX,KAAOA,GAC5DN,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGT,YAAa,EAChER,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGmJ,SAAU,IAE7DpK,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGT,YAAa,EAChER,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGmJ,SAAU,EAGnE,CAEOg4B,oBAAoBl/B,GACzB,OAAOlD,KAAK8vD,KAAKlsD,mBAAmBuB,SAASy8B,eAAeQ,oBAAoBl/B,GAAG,EACrF,CACOw+B,aAAax+B,GAClB,OAAOlD,KAAK8vD,KAAKlsD,mBAAmBuB,SAASy8B,eAAeQ,oBAAoBl/B,GAAG,EACrF,CAEOqgC,iBAAiBniC,EAAWC,EAAWwiD,GAC5C,IAAI5mC,EAAM,GACNg2C,EAAa,IAAI5wD,EAAAA,GAASjB,EAAGC,GACjC,MAAM+a,EAAO,IAAI/Z,EAAAA,GAASjB,EAAGC,GAC7B,IAAIJ,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,KAAOD,KAAK,CACV,MAAM+nC,EAAShpC,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGgM,aAAamP,GAC3E4sB,EAAO,IAAMA,EAAO,IAAMA,EAAO,GAAK,GAAKA,EAAO,GAAK/rB,IACzDA,EAAM+rB,EAAO,GACbiqB,EAAajqB,EAAO,GAExB,CAKA,OAJI/rB,EAAM4mC,IACRziD,EAAI6xD,EAAW7xD,EACfC,EAAI4xD,EAAW5xD,GAEV,CAACD,EAAGC,EACb,CACO2sD,qBAAqB/Z,GAC1Bj0C,KAAKk8B,YACL,IAAK,MAAMj7B,KAAKgzC,EACd,GAAIA,EAAEhzC,GAAI,CACR,MAAMS,EAAMuyC,EAAEhzC,GACdjB,KAAK8yD,mBAAmBpxD,GAAK,GAAO,EACtC,CAEF1B,KAAK+yD,gCACL/yD,KAAK8vD,KAAK15C,eAAevH,aAC3B,CACOqtB,UAAUr1B,GACf,IAAI5F,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0nD,2BAA2BnqD,OACtE,KAAOD,KACDjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0nD,2BAA2BpqD,IAChEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0nD,2BAA2BpqD,GAAGqzC,YAIrE,IADArzC,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OAC7CD,KACDjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,IAClDjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGwP,OAAO5J,GAI9D7G,KAAK4yD,eACL5yD,KAAK6yD,oBAEL7yD,KAAK8vD,KAAK15C,eAAevH,aAC3B,CACO+jD,eACL,IACE,IAAI3xD,EAAI,EACRA,EACAjB,KAAK8vD,KAAKlsD,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IACrEgnD,oBACDjyD,EAIAjB,KAAK8vD,KAAKlsD,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IACrEinD,WACHnzD,KAAK8vD,KAAKlsD,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IACrEinD,qBAAqBC,gBAExBpzD,KAAK8vD,KAAKlsD,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAIinD,UAAU1iD,QAG5F,CACOoW,iBACL,IACE,IAAI5lB,EAAI,EACRA,EACAjB,KAAK8vD,KAAKlsD,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IACrEgnD,oBACDjyD,EAEF,GACEjB,KAAK8vD,KAAKlsD,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IACrEinD,WACHnzD,KAAK8vD,KAAKlsD,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IACrEinD,qBAAqBC,eACxB,CAEWpzD,KAAK8vD,KAAKlsD,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAIinD,UAAU7yD,GAC1F+yD,SAAS,OACdrzD,KAAK8vD,KAAKlsD,mBAAmBC,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAIinD,UAAU1iD,QAE1F,CAGF,IAAK,IAAIxP,EAAI,EAAGA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,SAAUD,EACxEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGkK,UACrDnL,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG2L,kBAGzD,CACOmmD,gCACL,IAAI9xD,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0nD,2BAA2BnqD,OACtE,KAAOD,UAE6E0B,IAAhF3C,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0nD,2BAA2BpqD,GAAGoS,YAKjErT,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0nD,2BAA2BpqD,GAAG84C,yBAKvE,CACO8Y,oBAEL7yD,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAe,GAGlD7wD,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0nD,2BAA6B,GAGhErrD,KAAK8vD,KAAKlsD,mBAAmBD,MAAMguD,cAAgB,GACnD3xD,KAAK8vD,KAAKlsD,mBAAmBD,MAAMsY,WAAa,GAChDjc,KAAK8vD,KAAKlsD,mBAAmBD,MAAMqqC,WAAa,GAChDhuC,KAAK8vD,KAAKlsD,mBAAmBD,MAAM2vD,WAAa,GAChDtzD,KAAK8vD,KAAKlsD,mBAAmBD,MAAM+hD,WAAa,GAChD1lD,KAAK8vD,KAAKlsD,mBAAmBD,MAAMq/C,WAAa,GAChDhjD,KAAK8vD,KAAKlsD,mBAAmBD,MAAMqhC,oBAAsB,GACzDhlC,KAAK8vD,KAAKlsD,mBAAmBD,MAAMiuD,sBAAwB,GAC3D5xD,KAAK8vD,KAAKlsD,mBAAmBD,MAAMme,qBAAuB,GAC1D9hB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMotD,yBAA2B,GAC9D/wD,KAAK8vD,KAAKlsD,mBAAmBD,MAAMyjB,oBAAsB,GACzDpnB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMmyB,0BAA4B,GAE/D91B,KAAK8vD,KAAKlsD,mBAAmBD,MAAMmoC,WAAa,GAIhD9rC,KAAK8vD,KAAKlsD,mBAAmBD,MAAM4vD,SAAW,EAEhD,CACOC,+BACL,IAAIvyD,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0nD,2BAA2BnqD,OACtE,KAAOD,KACDjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0nD,2BAA2BpqD,GAAGT,YACnER,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0nD,2BAA2BpqD,GAAGwP,SAGrEzQ,KAAK8vD,KAAK15C,eAAevH,aAC3B,CACO4kD,oCAAoCT,GAEzC,IAAK,IAAI/xD,EAAI,EAAIA,EAAI+xD,EAAW9xD,SAAUD,EACxCjB,KAAK8yD,mBAAmBE,EAAW/xD,IAAkB,EAGzD,CACOyyD,kBAAkBV,GAEvB,IAAK,IAAI/xD,EAAI,EAAIA,EAAI+xD,EAAW9xD,SAAUD,EACxCjB,KAAK8yD,mBAAmBE,EAAW/xD,IAAI,EAG3C,CACO6xD,mBAAmBpxD,GAAsD,IAArCqF,EAAM,wDAAUuV,EAAU,6DACvD3Z,IAARjB,IAIAA,EAAInB,OAAS6L,EAAAA,GAAAA,cACfq5C,GAAqBr1C,SAASpQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAOjC,EAAKqF,EAAQuV,GACtE5a,EAAInB,OAAS6L,EAAAA,GAAAA,eACtB22C,GAAsB4Q,SAAS3zD,KAAK8vD,KAAKlsD,mBAAmBD,MAAOjC,EAAKqF,EAAQuV,GACvE5a,EAAInB,OAAS6L,EAAAA,GAAAA,OACtBwhB,EAAexd,SAASpQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAOjC,EAAKqF,EAAQuV,GAChE5a,EAAInB,OAAS6L,EAAAA,GAAAA,UACtBqjB,EAAkBrf,SAASpQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAOjC,EAAKqF,EAAQuV,GACnE5a,EAAInB,OAAS6L,EAAAA,GAAAA,SACtByV,EAAiBzR,SAASpQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAOjC,EAAKqF,EAAQuV,GAClE5a,EAAInB,OAAS6L,EAAAA,GAAAA,iBACtBypB,EAAsBzlB,SAASpQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAOjC,EAAKqF,EAAQuV,GACvE5a,EAAInB,OAAS6L,EAAAA,GAAAA,QACtB+a,EAAgB/W,SAASpQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAOjC,EAAKqF,EAAQuV,GACjE5a,EAAInB,OAAS6L,EAAAA,GAAAA,cACtB69B,GAAqB75B,SAASpQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAOjC,EAAKqF,EAAQuV,GACtE5a,EAAInB,OAAS6L,EAAAA,GAAAA,WACtB+yC,GAAkB/uC,SAASpQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAOjC,EAAKqF,EAAQuV,GACnE5a,EAAInB,OAAS6L,EAAAA,GAAAA,aACtB2hC,GAAO39B,SAASpQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAOjC,EAAKqF,EAAQuV,GAAY,GACpE5a,EAAInB,OAAS6L,EAAAA,GAAAA,aACtB2hC,GAAO39B,SAASpQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAOjC,EAAKqF,EAAQuV,GAAY,GACpE5a,EAAInB,OAAS6L,EAAAA,GAAAA,WACtBw/B,GAAOx7B,SAASpQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAOjC,EAAKqF,EAAQuV,GACxD5a,EAAInB,OAAS6L,EAAAA,GAAAA,YACtBw/B,GAAOx7B,SAASpQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAOjC,EAAKqF,EAAQuV,GAAY,GAGpE5a,EAAInB,OAAS6L,EAAAA,GAAAA,iBACtB4sC,GAAuB5oC,SAASpQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAOjC,EAAKqF,EAAQuV,GAErF,CACOwjB,cACL,IAAI7+B,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,MAAMgkB,EAAM,GACZ,KAAOjkB,KACAjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGkG,qBAClDnH,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG8E,iBACrDmf,EAAI/jB,KAAKnB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,IAK/D,GAAIikB,EAEF,OADAllB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMiwD,gBAAkB1uC,EAC9CA,EAETllB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMiwD,qBAAkBjxD,CAEvD,CAEO0L,kBAAkBxN,GACvB,MAAMgzD,EAA6B,GACnC,IAAK,IAAI33C,EAAI,EAAGA,EAAIrb,EAAOK,SAAUgb,EACnC,IAAK,IAAIjb,EAAI,EAAGA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,SAAUD,EAAG,CAC/E,MAAMS,EAAM1B,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAC5D,GAAIS,EAAIpB,KAAOO,EAAOqb,GAAG5b,IAEnBoB,EAAI2M,kBAAkBxN,EAAOqb,GAAGtQ,OAAQ,CAC1C,MAAMkoD,EAAWpyD,EAAI8H,SACjBsqD,GACFD,EAAa1yD,KAAK2yD,EAEtB,CAEJ,CAEED,EAAa3yD,OAAS,GAExBlB,KAAK8vD,KAAKlsD,mBAAmBmG,GAAGC,wBAAwBqU,eAAew1C,GAEzE7zD,KAAK8vD,KAAK15C,eAAevH,aAC3B,CACOklD,cAAc7pD,GACnB,IAAK,IAAIjJ,EAAI,EAAGA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM+hD,WAAWxkD,SAAUD,EAC1EjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM+hD,WAAWzkD,GAAGiJ,KAAOA,EAE1DlK,KAAK8vD,KAAKlsD,mBAAmBuS,eAAeC,eAAevH,aAC7D,CACOmlD,mBAAmB3N,GAKxB,GAAInC,EAAAA,GAAAA,eAA+BmC,GACjC,IAAK,IAAIplD,EAAI,EAAGA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM+hD,WAAWxkD,SAAUD,EAC1EjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM+hD,WACjCzkD,GACAkE,SAAS8+C,gBAAkBoC,EAC7BrmD,KAAK8vD,KAAKlsD,mBAAmBD,MAAM+hD,WAAWzkD,GAAGoC,eAAe1C,YAAY6S,IAAM,QAE/E,GAA0B,kBAAf6yC,EAChB,IAAK,IAAIplD,EAAI,EAAGA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM+hD,WAAWxkD,SAAUD,EAC1EjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM+hD,WAAWzkD,GAAGkE,SAAS8+C,gBACxDC,EAAAA,GAAAA,MACFlkD,KAAK8vD,KAAKlsD,mBAAmBD,MAAM+hD,WACjCzkD,GACAoC,eAAe1C,YAAY6S,IAAM6yC,EAGvCrmD,KAAK8vD,KAAKlsD,mBAAmBuS,eAAeC,eAAevH,aAC7D,CACOuxB,sBAAsB9yB,GAC3B,IAAK,IAAIrM,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMguD,cAAczwD,OAAS,EAAGD,GAAK,IAAKA,EAElF,GACEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMguD,cAAc1wD,GAAG+E,cACpDhG,KAAK8vD,KAAKlsD,mBAAmBD,MAAMguD,cAAc1wD,GAAG4R,cAAcvF,EAAElM,EAAGkM,EAAEjM,GAEzE,OAAOrB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMguD,cAAc1wD,EAI9D,CACOq/B,4BAA4BhzB,GAEjC,IACE,IAAIrM,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMotD,yBAAyB7vD,OAAS,EAC7ED,GAAK,IACHA,EAGF,GAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMotD,yBAAyB9vD,GAAG+E,aAAc,CAE/E,QAAUrD,IADA3C,KAAK8vD,KAAKlsD,mBAAmBD,MAAMotD,yBAAyB9vD,GAAGkM,oBAEvE,OAAOnN,KAAK8vD,KAAKlsD,mBAAmBD,MAAMotD,yBAAyB9vD,GAErEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMotD,yBAAyB9vD,GAAG6nC,UAAUjB,YAASllC,EAClF3C,KAAK8vD,KAAKlsD,mBAAmBD,MAAMotD,yBAAyB9vD,GAAG6nC,UAAUf,iBAAcplC,EACvF3C,KAAK8vD,KAAKlsD,mBAAmBD,MAAMotD,yBAAyB9vD,GAAG6nC,UAAUd,6BAA0BrlC,CACrG,CAGJ,CACOq+B,mBAAmB1zB,GAGxB,IAAI2mD,EAA8B,GAClC,IAAK,IAAIhzD,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OAAS,EAAGD,GAAK,IAAKA,EAI7EjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,eAE3DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG+E,cAClDhG,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG2E,cACrD5F,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG4R,cAAcvF,EAAElM,EAAGkM,EAAEjM,KAExE4yD,EAAW9yD,KAAKnB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,IAKhEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG+E,cAEnDhG,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG4R,cAAcvF,EAAElM,EAAGkM,EAAEjM,IASxE4yD,EAAW9yD,KAAKnB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,IAUtE,MACMizD,EAAY,GAClB,IAAK,IAAIjzD,EAAI,EAAGA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMq/C,WAAW9hD,SAAUD,EAAG,CACjEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMq/C,WAAW/hD,GAAG2iD,2BAC3Dt2C,EAAElM,EACFkM,EAAEjM,EALY,KASd6yD,EAAU/yD,KAAKnB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMq/C,WAAW/hD,GAEjE,CACA,IAAK,IAAIA,EAAI,EAAGA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM+hD,WAAWxkD,SAAUD,EAAG,CACjEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM+hD,WAAWzkD,GAAG2iD,2BAC3Dt2C,EAAElM,EACFkM,EAAEjM,EAfY,KAmBd6yD,EAAU/yD,KAAKnB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM+hD,WAAWzkD,GAEjE,CAGA,GAAIizD,EAAUhzD,OAAS,EAAG,CACxB,IAAIZ,GAAM,EACN2c,EAAM3T,OAAOC,iBACjB,IAAK,IAAItI,EAAI,EAAGA,EAAIizD,EAAUhzD,SAAUD,EAAG,CACzC,MAAM+nC,EAASkrB,EAAUjzD,GAAGoR,SAAS/E,EAAElM,EAAGkM,EAAEjM,EAAI,GAAK6yD,EAAUjzD,GAAGoH,gBAC9D2gC,EAAS/rB,IACXA,EAAM+rB,EACN1oC,EAAKW,GAEPgzD,EAAa,CAACC,EAAU5zD,GAC1B,CACF,CAMA,IAAI6zD,GAAe,EACnB,GAAIF,EAAW/yD,OAAS,EACtB,IAAK,IAAID,EAAI,EAAGA,EAAIgzD,EAAW/yD,SAAUD,EAErCgzD,EAAWhzD,GAAGV,OAAS6L,EAAAA,GAAAA,QACvB6nD,EAAWhzD,GAAGV,OAAS6L,EAAAA,GAAAA,WACvB6nD,EAAWhzD,GAAGV,OAAS6L,EAAAA,GAAAA,UACvB6nD,EAAWhzD,GAAGV,OAAS6L,EAAAA,GAAAA,SACvB6nD,EAAWhzD,GAAGV,OAAS6L,EAAAA,GAAAA,eACvB6nD,EAAWhzD,GAAGV,OAAS6L,EAAAA,GAAAA,QACvB6nD,EAAWhzD,GAAGV,OAAS6L,EAAAA,GAAAA,UAEvB+nD,GAAe,GAKrB,MAAMC,EAAkB,GACxB,GAAID,EAAc,CAEhB,IAAK,IAAIlzD,EAAI,EAAGA,EAAIgzD,EAAW/yD,SAAUD,EACvCmzD,EAAMjzD,KAAKmR,KAAKyS,IAAIkvC,EAAWhzD,GAAGoI,YAEpC,OAAO4qD,GAAWI,EAAAA,EAAAA,IAAeD,GACnC,CAIA,IAAK,IAAInzD,EAAI,EAAGA,EAAIgzD,EAAW/yD,SAAUD,EACvC,GAAIgzD,EAAWhzD,GAAG+E,cAAgBiuD,EAAWhzD,GAAG4R,cAAcvF,EAAElM,EAAGkM,EAAEjM,GACnE,OAAO4yD,EAAWhzD,EAMxB,CACOghB,YAAY3U,GAGjB,MAAM2mD,EAA8B,GACpC,IAAK,IAAIhzD,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OAAS,EAAGD,GAAK,IAAKA,EAIjF,GAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,eAC9D,GACGpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG+E,cAClDhG,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG2E,cACrD5F,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG4R,cAAcvF,EAAElM,EAAGkM,EAAEjM,GACxE,CACA,GACErB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,SAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,eAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,QAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,eAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,WAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,QAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,SAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,iBAI5D,OAAOpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAFvDgzD,EAAW9yD,KAAKnB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAIpE,OAGA,GACEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG+E,cAEnDhG,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG4R,cAAcvF,EAAElM,EAAGkM,EAAEjM,GACxE,CACA,GACErB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,SAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,eAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,QAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,eAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,WAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,QAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,SAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,iBAI5D,OAAOpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAFvDgzD,EAAW9yD,KAAKnB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAIpE,CAKJ,IAAIkzD,GAAe,EACnB,GAAIF,EAAW/yD,OAAS,EACtB,IAAK,IAAID,EAAI,EAAGA,EAAIgzD,EAAW/yD,SAAUD,EAErCgzD,EAAWhzD,GAAGV,OAAS6L,EAAAA,GAAAA,QACvB6nD,EAAWhzD,GAAGV,OAAS6L,EAAAA,GAAAA,WACvB6nD,EAAWhzD,GAAGV,OAAS6L,EAAAA,GAAAA,UACvB6nD,EAAWhzD,GAAGV,OAAS6L,EAAAA,GAAAA,SACvB6nD,EAAWhzD,GAAGV,OAAS6L,EAAAA,GAAAA,eACvB6nD,EAAWhzD,GAAGV,OAAS6L,EAAAA,GAAAA,QACvB6nD,EAAWhzD,GAAGV,OAAS6L,EAAAA,GAAAA,UAEvB+nD,GAAe,GAKrB,MAAMC,EAAkB,GACxB,GAAID,EAAc,CAEhB,IAAK,IAAIlzD,EAAI,EAAGA,EAAIgzD,EAAW/yD,SAAUD,EACvCmzD,EAAMjzD,KAAKmR,KAAKyS,IAAIkvC,EAAWhzD,GAAGoI,YAEpC,OAAO4qD,GAAWI,EAAAA,EAAAA,IAAeD,GACnC,CAIA,IAAK,IAAInzD,EAAI,EAAGA,EAAIgzD,EAAW/yD,SAAUD,EACvC,GAAIgzD,EAAWhzD,GAAG+E,cAAgBiuD,EAAWhzD,GAAG4R,cAAcvF,EAAElM,EAAGkM,EAAEjM,GACnE,OAAO4yD,EAAWhzD,EAMxB,CACOqzD,oBACL,IAAIrzD,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,KAAOD,KACL,GACEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGT,YACnDR,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG2E,aAEnD,OAAO,EAGX,OAAO,CACT,CACO+7B,eACL,IAAI1gC,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,KAAOD,MAC6D,IAA9DjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGkF,SACrDnG,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGkF,QAAS,EAGlE,CACOwsD,uBACL3yD,KAAK8vD,KAAK15C,eAAevH,cACzB,IAAIlE,EAAI3K,KAAK8vD,KAAKlsD,mBAAmBD,MAAMguD,cAAczwD,OACzD,KAAOyJ,KAEH3K,KAAK8vD,KAAKlsD,mBAAmBD,MAAMguD,cAAchnD,KACkB,IAAnE3K,KAAK8vD,KAAKlsD,mBAAmBD,MAAMguD,cAAchnD,GAAGnK,YAEpDR,KAAK8vD,KAAKlsD,mBAAmBD,MAAMguD,cAAchnD,GAAG8F,SAGxD,IAAIxP,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,GAAU,IAAND,EAAJ,CAGA,KAAOA,UAEoD0B,IAAvD3C,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,IACO,OAAvDjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,KAIoB,IAAlEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGT,aAEjDR,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,KAAS6L,EAAAA,GAAAA,MAG9DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGwP,UAQzD,IAAK,MAAMJ,KAAKrQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,cAC5B,IAAjBxgD,EAAE7P,aACJ6P,EAAE7P,YAAa,EAvBnB,CA0BF,CACO+zD,sBAAsB3F,GAE3B,IAAK,IAAI1yC,EAAI,EAAGA,EAAIlc,KAAK8vD,KAAKlsD,mBAAmBD,MAAMq/C,WAAW9hD,SAAUgb,EAC1Elc,KAAK8vD,KAAKlsD,mBAAmBD,MAAMq/C,WAAW9mC,GAAGgnC,mBAAoB,EAevE,MAAMlyC,EAAO,GACb,IAAIwjD,EAAM,EACV,KAAO5F,EAAI1tD,QAAQ,CACjB,MAAMZ,EAAKsuD,EAAI,GACfA,EAAI3+C,QACJ,IAAK,IAAIiM,EAAI,EAAGA,EAAIlc,KAAK8vD,KAAKlsD,mBAAmBD,MAAMq/C,WAAW9hD,SAAUgb,EACtElc,KAAK8vD,KAAKlsD,mBAAmBD,MAAMq/C,WAAW9mC,GAAGgnC,mBAC/CljD,KAAK8vD,KAAKlsD,mBAAmBD,MAAMq/C,WAAW9mC,GAAG5b,KAAOA,IAC1DN,KAAK8vD,KAAKlsD,mBAAmBD,MAAMq/C,WAAW9mC,GAAGgnC,mBAAoB,EACrEljD,KAAK8vD,KAAKlsD,mBAAmBD,MAAMq/C,WAAW9mC,GAAGqnC,YAAciR,IAC/DxjD,EAAK7P,KAAKnB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMq/C,WAAW9mC,IAOhE,CAGAlc,KAAK8vD,KAAKlsD,mBAAmBD,MAAMq/C,WAAahyC,CAElD,CACOupB,4BACL,GAAIv6B,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,QAAS,CAC9C,GAAI3S,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,QAAQpS,MAAQP,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,cAAqB,CAE9H,GADgBpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,QACvCm2B,UAAUjB,OAGpB,YADA7nC,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,QAAQlC,QAAO,EAGtD,CACA,GAAIzQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,QAAQpS,MAAQP,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,MAEzG,YADApM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,QAAQlC,QAG/C,CAEA,MAAMgkD,EAAcz0D,KAAK8/B,cAEzB,GACE9/B,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,SACnC3S,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,gBACpD,CACA,MAAM6sC,EAAMj5C,KAAK8vD,KAAKlsD,mBAAmBD,MAAMgP,QAC/C,GAAIsmC,EAAIhG,6BAA+BgG,EAAI5lC,WAIzC,YAHI4lC,EAAI7G,sBACN6G,EAAIxuC,mBAIV,CAEA,MAAMgoD,EAAuB,GACzBgC,GACFA,EAAYzuC,SAAS3V,IAEnB,GAAIA,EAAE9P,OAAS6L,EAAAA,GAAAA,cAAqB,CAClC,MAAM+kB,EAAK9gB,EAEX,GAAI8gB,EAAG2X,UAAUjB,OACf1W,EAAG1gB,QAAO,OACL,CACL,MAAM2N,EAAQ/N,EAAE7G,SACZ4U,IACFq0C,EAAOtxD,KAAKid,GACZ/N,EAAEI,QAAO,GAEb,CACF,KAAO,CACL,MAAM2N,EAAQ/N,EAAE7G,SACZ4U,IACFq0C,EAAOtxD,KAAKid,GACZ/N,EAAEI,QAAO,GAEb,KAGJzQ,KAAK8vD,KAAKlsD,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB8tC,GAC5EzyD,KAAK8vD,KAAK15C,eAAevH,aAC3B,CACOwP,iBACL,GACEre,KAAK8vD,KAAKlsD,mBAAmBC,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBACnEC,OAASC,EAAAA,GAAAA,SACZjW,KAAK8vD,KAAKlsD,mBAAmB4H,wBAAwB8C,aAAayY,UAElE,OAGF,MAAM2tC,EAA6B,GAC7BC,EAAqC,GAE3C,IAAI1zD,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,KAAOD,KAAK,CACV,MAAMoP,EAAIrQ,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAG1D,GAAIoP,EAAE7P,YAAc6P,EAAE5J,iBAAmB4J,EAAE1L,YAAa,CACtD,GAAI0L,EAAElJ,oBACJ,SAEF,GAAIkJ,EAAE1L,YACJ,GAAI0L,EAAE9P,OAAS6L,EAAAA,GAAAA,gBAAuB,CAGpC,GAFuBiE,EAEH4Z,cAOb,CACL,MAAM7L,EAAQ/N,EAAE7G,SACZ4U,IAEFu2C,EAAqBxzD,KAAKid,GAC1B/N,EAAE1L,aAAc,EAEpB,KAdmC,CACjC,MAAMyZ,EAAQ/N,EAAE7G,SACZ4U,IACFs2C,EAAavzD,KAAKid,GAClBu2C,EAAqBxzD,KAAKid,GAC1B/N,EAAE1L,aAAc,EAEpB,CAQF,KAAO,CACL,MAAMyZ,EAAQ/N,EAAE7G,SACZ4U,IAEFs2C,EAAavzD,KAAKid,GAClBu2C,EAAqBxzD,KAAKid,IAE5B/N,EAAE1L,aAAc,CAClB,CAeF,GAJA0L,EAAEL,oBAIEK,EAAE9P,OAAS6L,EAAAA,GAAAA,MAAa,CAC1B,MAAMgS,EAAQ/N,EAAE7G,SACZ4U,GACFs2C,EAAavzD,KAAKid,EAGtB,CAEF,CACF,CAEA,GAAIpe,KAAK8vD,KAAKlsD,mBAAmBuB,SAASqL,WAAaxQ,KAAK8vD,KAAKlsD,mBAAmBuB,SAASqL,UAAUokD,SAAU,CAS/G,IARY1nD,EAAAA,EAAAA,IACVlN,KAAK8vD,KAAKlsD,mBAAmBuB,SAASqL,UAAUtN,EAChD,IAAIb,EAAAA,GACFrC,KAAK8vD,KAAKlsD,mBAAmB4H,wBAAwBiS,EAAErc,EACvDpB,KAAK8vD,KAAKlsD,mBAAmB4H,wBAAwBiS,EAAEpc,EACvD,IAGMrB,KAAK8vD,KAAKlsD,mBAAmBuB,SAASqL,UAAUU,OAIxD,YAHAlR,KAAK8vD,KAAKlsD,mBAAmBuB,SAASqL,UAAUqkD,gCAC9CH,EAIN,CAMA,IAJIC,EAAqBzzD,OAAS,GAChClB,KAAK8vD,KAAKlsD,mBAAmBmG,GAAGC,wBAAwBqU,eAAes2C,GAEzE1zD,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OAC7CD,KACLjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG0D,aAAc,CAErE,CACOmwB,OACL90B,KAAK8vD,KAAKlsD,mBAAmBD,MAAMmxB,MACrC,CACOggC,OACL90D,KAAK8vD,KAAKlsD,mBAAmBD,MAAMmxD,MACrC,CACO1zB,iBACL,MAAMtgC,EAAOd,KAAK8vD,KAAK5hC,cAAc6mC,wBAGrC/0D,KAAK8vD,KAAKlsD,mBAAmBmG,GAAGirD,WAAW,iBAAD,OAAkB9gB,KAAKyD,UAAU72C,IAC7E,CACOsrD,iBAAiB9gC,GACtB,IAAK,IAAIrqB,EAAI,EAAIA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,SAAUD,EACzEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGT,YACrDR,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGyJ,YAAY4gB,GAGnEtrB,KAAK8vD,KAAKlsD,mBAAmBgL,oBAAoBC,aACnD,EA92CW8hD,GAGGh+C,aAAqChQ,EAHxCguD,GAIGiD,qBAA+CjxD,EAJlDguD,GAMGtuB,oBAA4C1/B,EAN/CguD,GAQGsE,sBAA8CtyD,EARjDguD,GASG3/C,KAAwB,GAT3B2/C,GAWGL,aAAgC,GAXnCK,GAYGU,cAAoC,CAAC,ECvC9C,MAAM6D,GAIXr1D,YAAYiwD,GAAuB,KAF5BA,UAAI,EAGT9vD,KAAK8vD,KAAOA,CACd,CACO92B,qBAAqBh4B,GAAmC,IACzDC,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,MAAM0tD,EAAM,GACZ,KAAO3tD,KAEDjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,YAG5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,OAI9DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,OAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,cAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,WAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,YAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,QAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,YAK1DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGyI,mBAAmB1I,KACxEhB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG8E,iBAAkB,EACrE6oD,EAAIztD,KAAKnB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGX,KAIhEN,KAAK8vD,KAAKlsD,mBAAmBmG,GAAGC,wBAAwBmrD,oBAAoBvG,EAC9E,CACO71B,yBACL,IAAI93B,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,KAAOD,KACDjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGwF,kBAGnDzG,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,KAC9DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG+J,aAAc,EAE7DhL,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGT,aACrDR,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGT,YAAa,EAChER,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGmJ,SAAU,IAInEpK,KAAK8vD,KAAKlsD,mBAAmBD,MAAMmb,aAAUnc,CAE/C,CACOwrB,qBACL,IAAIltB,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,KAAOD,KACLjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAG8J,YAAa,EAChE/K,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGT,YAAa,EAChER,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGmJ,SAAU,EAE/DpK,KAAK8vD,KAAKlsD,mBAAmBD,MAAMmb,aAAUnc,CAE/C,CACOw6B,mBACL,IAAIl8B,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,KAAOD,KAGHjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,QAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,WAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,OAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,cAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,YAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,YAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,YAI1DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,YAI9DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,OAC5DpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGV,OAAS6L,EAAAA,GAAAA,aAIzDpM,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGT,aACtDR,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGT,YAAa,GAGtE,CACO40D,mBACL,MAAMt0D,EAAO,GACb,IAAIu0D,EACJ,IAAK,IAAIp0D,EAAI,EAAIA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,SAAUD,EAC7Eo0D,EAAWr1D,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGuI,SAC1D6rD,GACFv0D,EAAKK,KAAKk0D,GAId,OAAOv0D,CACT,CACOi0D,wBACL,MAAMj0D,EAAO,GACb,IAAIu0D,EACJ,IAAK,IAAIp0D,EAAI,EAAIA,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,SAAUD,EACzEjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGT,aACrD60D,EAAWr1D,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGuI,SAC1D6rD,GACFv0D,EAAKK,KAAKk0D,IAIhB,OAAOv0D,CACT,CACO25B,sBAEHz6B,KAAK8vD,KAAKlsD,mBAAmB4H,wBAAwBjL,OAAS85B,EAAAA,GAAAA,WAC9Dr6B,KAAK8vD,KAAKlsD,mBAAmB4H,wBAAwBjL,OAAS85B,EAAAA,GAAAA,QAC9Dr6B,KAAK8vD,KAAKlsD,mBAAmB4H,wBAAwBjL,OAAS85B,EAAAA,GAAAA,2BAC9Dr6B,KAAK8vD,KAAKlsD,mBAAmB4H,wBAAwBjL,OAAS85B,EAAAA,GAAAA,wBAE5Dr6B,KAAK8vD,KAAKlsD,mBAAmB4H,wBAAwB8uB,cAAc/X,QAEzE,ECrIK,MAAM+yC,GAEXz1D,YAAYiwD,GAAuB,KAD5BA,UAAI,EAET9vD,KAAK8vD,KAAOA,CACd,CACO3hD,cACL,IAAIlN,EAAIjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa3vD,OACxD,KAAOD,KACLjB,KAAK8vD,KAAKlsD,mBAAmBD,MAAMktD,aAAa5vD,GAAGoC,eAAe8K,cAEpEnO,KAAK6O,aACP,CACOA,cACL7O,KAAK8vD,KAAKlsD,mBAAmBgL,oBAAoBC,cAMjD7O,KAAK8vD,KAAKlsD,mBAAmB4H,wBAAwB8C,aAAaoxB,sBAAuB,CAC3F,CACO61B,uBAAuBv0D,EAAgBkc,EAAcC,GAC1D,SAAIo4C,EAAAA,EAAAA,IAAuBv0D,EAAIkc,EAAIC,EAIrC,CAEOq4C,cAActyD,GACnBlD,KAAK8vD,KAAKlsD,mBAAmB6L,cAAcgmD,iBAAiBD,cAActyD,EAG5E,CAEOsiB,SAASpkB,EAAWC,GACzB,MAAO,CAACD,EAAGC,EACb,CACO6vD,MAAM9vD,EAAWC,GACtB,MAAO,CAACD,EAAGC,EACb,CACOq0D,iBAAiBzhB,GAQtBj0C,KAAK8vD,KAAKlsD,mBAAmBgL,oBAAoBmD,cAAcC,QAAQ2jD,WAAW/pD,MAAMi1C,WAAa,uBACrG7gD,KAAK8vD,KAAKlsD,mBAAmBgL,oBAAoBmD,cAAcC,QAAQ07C,aALzD,IACE,KAMhB1tD,KAAK8vD,KAAKlsD,mBAAmBgL,oBAAoBmD,cAAcC,QAAQ4+C,QAAQhlD,MAAMtI,MAAQA,QAC7FtD,KAAK8vD,KAAKlsD,mBAAmBgL,oBAAoBmD,cAAcC,QAAQ4+C,QAAQhlD,MAAMrI,OAASA,OAEhG,CACO8S,sBAAsBzT,GAC3B,MAAO,CACLxB,EAAGwB,EAAIxB,EAAIpB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0lB,cAAcC,mBAAmBloB,EAC/EC,EAAGuB,EAAIvB,EAAIrB,KAAK8vD,KAAKlsD,mBAAmBD,MAAM0lB,cAAcC,mBAAmBjoB,EAGnF,CACOipB,uBAAuBtpB,GAC5B,MAAM40D,EAAU,GAChB,IAAK,IAAI30D,EAAI,EAAIA,EAAID,EAAGE,SAAUD,EAAG,CACnC,MAAM40D,EAAK71D,KAAKqW,sBAAsBrV,EAAGC,IACzC20D,EAAQz0D,KAAK,IAAIkB,EAAAA,GAASwzD,EAAGz0D,EAAGy0D,EAAGx0D,GACrC,CACA,OAAOu0D,CACT,EClEK,MAAME,GAMXj2D,YAAY+D,GAAmC,KALxCA,wBAAkB,OAClBwS,oBAAc,OACd0M,oBAAc,OACdoL,mBAAa,OACboP,qBAAe,EAEpBt9B,KAAK4D,mBAAqBA,EAC1B5D,KAAKoW,eAAiB,IAAIk/C,GAAyBt1D,MACnDA,KAAK8iB,eAAiB,IAAI6tC,GAAyB3wD,MACnDA,KAAKkuB,cAAgB,IAAIgnC,GAAwBl1D,MACjDA,KAAKs9B,gBAAkB,IAAIuyB,GAA2B7vD,KACxD,EChBK,MAAM+1D,GAEXl2D,YAAYy7B,GAAyB,KAD9BA,gBAAU,EAEft7B,KAAKs7B,WAAaA,CACpB,CACO06B,UAAU9yD,GAsBjB,ECpBK,MAAMs+C,GAOX3hD,YAAYy7B,GAAyB,KAN9BA,gBAAU,OACTsuB,yBAA2B,EAAE,KAC7BE,gBAAkB,EAAE,KACpBmM,YAAc,EAAE,KAChBC,iBAAmB,EAAE,KACrBC,WAAa,EAEnBn2D,KAAKs7B,WAAaA,CACpB,CACOiB,UAAUn7B,EAAWC,GAC1B,CAEK+0D,sBAAsBlzD,GACvBA,EACFlD,KAAKq2D,4BAA4BtM,EAAAA,GAAAA,WAEjC/pD,KAAKq2D,4BAA4BtM,EAAAA,GAAAA,KAErC,CACOsM,8BAA8E,IAAlD11B,EAAyB,uDAAGopB,EAAAA,GAAAA,KAC7D/pD,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAa87C,eAAiBzpB,EACzF3gC,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAaoxB,sBAAuB,EAC/F1/B,KAAKs7B,WAAW13B,mBAAmBuS,eAAeC,eAAevH,aACnE,CAEOqvB,qBACLl+B,KAAKs2D,iBACP,CACO36B,YACD37B,KAAKs7B,WAAW13B,mBAAmBD,MAAMgP,UAGzC,IADA3S,KAAKs7B,WAAW13B,mBAAmBD,MAAMgP,QAAQtP,eAAe1C,YAAYga,KAAKzZ,OAGjFlB,KAAKs7B,WAAW13B,mBAAmBD,MAAMgP,QAAQ9E,QAAQ,CAAC,EAAG,IAE7D7N,KAAKs7B,WAAW13B,mBAAmBD,MAAMgP,QAAQ9E,QAAQ,IAG/D,CACOyoD,kBAELt2D,KAAKs7B,WAAW13B,mBAAmBC,gBAAgBC,IAAIC,YAAc/D,KAAKs7B,WACvE13B,mBAAmBC,gBAAgBC,IAAIC,WAC1C/D,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAa4kB,aAAelzB,KACpFs7B,WAAW13B,mBAAmBC,gBAAgBC,IAAIC,UACvD,CACOk6B,oCACmEt7B,IAApE3C,KAAKs7B,WAAW13B,mBAAmBC,gBAAgB2xB,eAIvDx1B,KAAK4pD,2BACD5pD,KAAK4pD,yBAA2B,IAAM,EACxC5pD,KAAKs7B,WAAW13B,mBAAmBC,gBAAgB2xB,aAAahqB,wBAAwB8C,aAAag8C,wBACnGT,EAAAA,GAAAA,KACO7pD,KAAK4pD,yBAA2B,IAAM,EAC/C5pD,KAAKs7B,WAAW13B,mBAAmBC,gBAAgB2xB,aAAahqB,wBAAwB8C,aAAag8C,wBACnGT,EAAAA,GAAAA,KACO7pD,KAAK4pD,yBAA2B,IAAM,IAC/C5pD,KAAKs7B,WAAW13B,mBAAmBC,gBAAgB2xB,aAAahqB,wBAAwB8C,aAAag8C,wBACnGT,EAAAA,GAAAA,WAGN,CACO9rB,0BACmEp7B,IAApE3C,KAAKs7B,WAAW13B,mBAAmBC,gBAAgB2xB,eAIvDx1B,KAAK8pD,kBACD9pD,KAAK8pD,gBAAkB,IAAM,EAC/B9pD,KAAKs7B,WAAW13B,mBAAmBC,gBAAgB2xB,aAAahqB,wBAAwB8C,aAAa87C,eACnGL,EAAAA,GAAAA,KAEF/pD,KAAKs7B,WAAW13B,mBAAmBC,gBAAgB2xB,aAAahqB,wBAAwB8C,aAAa87C,eACnGL,EAAAA,GAAAA,UAEN,CACOlsB,sBACL79B,KAAKi2D,cACDj2D,KAAKi2D,YAAc,IAAM,EAC3Bj2D,KAAKs7B,WAAW13B,mBAAmBuS,eAAe2M,eAAeixC,cAAcprD,EAAAA,GAAAA,OACtE3I,KAAKi2D,YAAc,IAAM,EAClCj2D,KAAKs7B,WAAW13B,mBAAmBuS,eAAe2M,eAAeixC,cAAcprD,EAAAA,GAAAA,QACtE3I,KAAKi2D,YAAc,IAAM,GAClCj2D,KAAKs7B,WAAW13B,mBAAmBuS,eAAe2M,eAAeixC,cAAcprD,EAAAA,GAAAA,MAEnF,CACOi1B,4BACL59B,KAAKk2D,mBACDl2D,KAAKk2D,iBAAmB,IAAM,EAChCl2D,KAAKs7B,WAAW13B,mBAAmBuS,eAAe2M,eAAekxC,mBAC/D9P,EAAAA,GAAAA,SAEOlkD,KAAKk2D,iBAAmB,IAAM,EACvCl2D,KAAKs7B,WAAW13B,mBAAmBuS,eAAe2M,eAAekxC,mBAC/D9P,EAAAA,GAAAA,SAEOlkD,KAAKk2D,iBAAmB,IAAM,GACvCl2D,KAAK29B,WAET,CACOA,YACL39B,KAAKm2D,aACDn2D,KAAKm2D,WAAa,IAAM,EAC1Bn2D,KAAKs7B,WAAW13B,mBAAmBuS,eAAe2M,eAAekxC,mBAC/D,+DAEOh0D,KAAKm2D,WAAa,IAAM,EACjCn2D,KAAKs7B,WAAW13B,mBAAmBuS,eAAe2M,eAAekxC,mBAC/D,sCAEOh0D,KAAKm2D,WAAa,IAAM,GAIxBn2D,KAAKm2D,WAAa,IAAM,EAHjCn2D,KAAKs7B,WAAW13B,mBAAmBuS,eAAe2M,eAAekxC,mBAC/D,mDAMOh0D,KAAKm2D,WAAa,IAAM,GACjCn2D,KAAKs7B,WAAW13B,mBAAmBuS,eAAe2M,eAAekxC,mBAC/D,8DAGN,CAEO5B,gBAAgBmE,GACrBv2D,KAAKs7B,WAAW13B,mBAAmBuS,eAAe2M,eAAesvC,gBAC/DmE,EAAY,GACZA,EAAa,IAEjB,CACOv4B,+BACmEr7B,IAApE3C,KAAKs7B,WAAW13B,mBAAmBC,gBAAgB2xB,eAIvDx1B,KAAKs7B,WAAW13B,mBAAmBC,gBAAgB2xB,aAAahqB,wBAAwB8C,aAAaS,sBAAwB/O,KAC1Hs7B,WAAW13B,mBAAmBC,gBAAgB2xB,aAAahqB,wBAC3D8C,aAAaS,qBAClB,CACOysB,WAMLx7B,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAa4kB,aAAelzB,KACpFs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAa4kB,WAExE,CACOsjC,kBAEL,CAEKt5B,iBAKL,CAEKu5B,gBAAgBC,GACrB,CAEKC,yBAAyBD,GACZ,SAAdA,EACF12D,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAa66C,wBAAyB,EAC1E,UAAduN,IACT12D,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAa66C,wBAAyB,EAErG,CACOyN,sBAAsBF,GACT,SAAdA,EACF12D,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAa46C,aAAc,EAC/D,UAAdwN,IACT12D,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAa46C,aAAc,EAE1F,CACO2N,WAAWH,GAShB,CAEKj5B,6BACL,CAEKT,YAGL,CAEKC,eAOL,CAEK65B,cAAcJ,GASnB,CAEKK,aAAaL,GAOlB,CAEKM,wBAAwBN,GAO7B,CAEKO,gBACLj3D,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAa6wB,oBAAsBn/B,KAC3Fs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAa6wB,kBACxE,CACO+3B,mBACLl3D,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAaqR,UAAY3f,KACjFs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAaqR,SACtE,IAAK,MAAMw3C,KAAQn3D,KAAKs7B,WAAW13B,mBAAmBD,MAAM4vD,SAC1D4D,EAAKC,OAASp3D,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAaqR,QAI1F,CACO+c,YACL18B,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAaw6C,cACoB,IAAxF9oD,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAaw6C,YAC1E9oD,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAas6C,KAAOC,EAAAA,GAAAA,UAES,IAAxF7oD,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAaw6C,YAExE9oD,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAas6C,KAAOC,EAAAA,GAAAA,MAES,IAAxF7oD,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAaw6C,cAExE9oD,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAas6C,KAAOC,EAAAA,GAAAA,MAE7E7oD,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAaw6C,YAAc,IACxF9oD,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAaw6C,YAAc,EAE1F,CACOuO,2BACLr3D,KAAKs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAaiB,wBAA0BvP,KAC/Fs7B,WAAW13B,mBAAmB4H,wBAAwB8C,aAAaiB,sBACxE,CACO+nD,oBACLt3D,KAAKs7B,WAAW13B,mBAAmBgL,oBAAoBmD,cAAcwlD,iBAAiB9W,WACxF,CACO+W,sBACL,IACEx3D,KAAKs7B,WAAW13B,mBAAmBgL,oBAAoBmD,cAAcwlD,iBAAiBjjB,WAEtF,CADA,MAAOI,GACP,CAEJ,CACO+iB,uBACL,CAEKC,oBACL13D,KAAKs7B,WAAW13B,mBAAmBuB,SAASqL,UAAUmnD,cAAgB33D,KAAKs7B,WAAW13B,mBAAmBuB,SAASqL,UAAUmnD,YAE9H,ECtSK,MAAMC,GAIX/3D,YAAY+D,GAAmC,KAHxCA,wBAAkB,OAClB23B,iBAAW,OACXohB,WAAK,EAEV38C,KAAK4D,mBAAqBA,EAC1B5D,KAAK28C,MAAQ,IAAIoZ,GAAM/1D,MACvBA,KAAKu7B,YAAc,IAAIimB,GAAYxhD,KACrC,ECVK,MAAM63D,GAIXh4D,YAAY4P,EAA8B4I,GAAkB,KAHrDy/C,MAAQ,CAAC,EAAE,KACXroD,mBAAa,OACbsoD,iBAAkCp1D,EAEvC3C,KAAKyP,cAAgBA,EAErBzP,KAAKg4D,SAAS3/C,EAShB,CAEQ2/C,SAAS3/C,GACf,IAAK,MAAM4/C,KAAY5/C,EAAM6/C,WAAY,CACvC,MAAM5Y,EAAQ,IAAIoB,MAClBpB,EAAMD,IAAMhnC,EAAM6/C,WAAWD,GAE7Bj4D,KAAK83D,MAAMG,GAAY3Y,CACzB,CACF,CACOzkC,QAAQrH,GACRxT,KAAK83D,MAAMtkD,KACdxT,KAAK83D,MAAMtkD,GAAOxT,KAAKm4D,aAAa3kD,GAExC,CACO4kD,aAAa5kD,GAClB,OAAOxT,KAAK83D,MAAMtkD,EACpB,CACO6kD,gBAAgB/3D,UACdN,KAAK83D,MAAMx3D,EACpB,CACQ63D,aAAa3kD,GACnB,MAAMuqC,EAAM,IAAI2C,MAOhB,OANA3C,EAAIua,YAAc,YAClBva,EAAIwH,OAAS,OAIbxH,EAAIsB,IAAM7rC,EACHuqC,CACT,ECtCK,MAAMwa,GAaX14D,YAAY4P,EAA8B4I,GAAa,KAZhD5I,mBAAa,OACbgF,SAAG,OACH+jD,gBAAU,OACVC,WAAa,EAAE,KACfC,8BAAgC,EAAE,KAClCC,UAAY,EAAE,KACd11C,QAAS,EAAM,KAEf21C,gBAA8Bj2D,EAAU,KACvCk2D,mBAAa,OACbC,mBAAa,EAGnB94D,KAAKyP,cAAgBA,EACjBzP,KAAKyP,cAAc7L,mBAAmBC,gBAAgBC,IAAIy9C,MAAMhmB,cAAgBimB,EAAAA,GAAAA,MAClFxhD,KAAK64D,eAAgBE,EAAAA,EAAAA,MACrB/4D,KAAK84D,eAAgBzW,EAAAA,EAAAA,QAErBriD,KAAK64D,eAAgBG,EAAAA,EAAAA,MACrBh5D,KAAK84D,eAAgBzW,EAAAA,EAAAA,OAEvBriD,KAAKi5D,aAAa5gD,EACpB,CACO6gD,iBAAiBh2D,GAClBA,IAAMs+C,EAAAA,GAAAA,KACRxhD,KAAKm5D,kBAAiBJ,EAAAA,EAAAA,OAEtB/4D,KAAKm5D,kBAAiBH,EAAAA,EAAAA,MAE1B,CACOG,iBAAiBzZ,GACpB1/C,KAAKyP,cAAcC,aAAa6I,OAAOq9B,IAAIgM,OAASlC,EAAKkC,OAGzD,IAAIwX,EAAW,GACXC,EAAY,GACZr5D,KAAKyP,cAAc7L,mBAAmBC,gBAAgBC,IAAIy9C,MAAMhmB,cAAgBimB,EAAAA,GAAAA,OAClF4X,EAAW,GACXC,EAAY,IAGdr5D,KAAKyP,cAAcC,aAAa6I,OAAOjV,MAAQ81D,EAC/Cp5D,KAAKyP,cAAcC,aAAa6I,OAAOhV,OAAS81D,EAChD,IAAK,IAAIp4D,EAAI,EAAGA,EAAIjB,KAAKyP,cAAc7L,mBAAmBD,MAAM+hD,WAAWxkD,SAAUD,EACnFjB,KAAKyP,cAAc7L,mBAAmBD,MAAM+hD,WAAWzkD,GAAGoC,eAAe1C,YAAY2C,MAAQ81D,EAC7Fp5D,KAAKyP,cAAc7L,mBAAmBD,MAAM+hD,WAAWzkD,GAAGoC,eAAe1C,YAAY4C,OAAS81D,CAGpG,CACOC,iBAAiB5Z,GACtB1/C,KAAKyP,cAAcC,aAAaC,OAAOimC,IAAIgM,OAASlC,CACtD,CAEA,oBAA2B6Z,GACpBv5D,KAAKijB,aAIJjjB,KAAKi5D,aAAaM,GAHtBv5D,KAAK44D,WAAaW,CAItB,CAEA,mBAA2BA,GAWzB,GAVAv5D,KAAKijB,QAAS,EACdjjB,KAAKyP,cAAcC,aAAe,IAAI+nC,GACtCz3C,KAAKw5D,kBAAkBD,EAAOvjD,MAC9BhW,KAAKy5D,uBAAuBF,GAC5Bv5D,KAAK05D,gBAAgBH,EAAOhlD,WAAW8iC,WACvCr3C,KAAK25D,gBAAgBJ,EAAOK,SAAS74C,KAAKtH,UAAW8/C,EAAOK,SAASlgD,QAAQtV,MAC7EpE,KAAK65D,oBAAoBN,GACzBv5D,KAAKyP,cAAcC,aAAe1P,KAAK85D,oBAAoBP,EAAOK,gBAC5D55D,KAAK+5D,oBAAoBR,EAAOK,UACtC55D,KAAKijB,QAAS,EACVjjB,KAAK44D,WAAY,CACnB,MAAMoB,EAAWh6D,KAAK44D,WACtB54D,KAAK44D,gBAAaj2D,EAClB3C,KAAKi5D,aAAae,EACpB,CAEF,CAEQH,oBAAoBxhD,GAC1BrY,KAAKyP,cAAcC,aAAa6E,WAAWkhB,aAAepd,EAAM9D,WAAWkhB,aAC3Ez1B,KAAKyP,cAAcC,aAAa6E,WAAWwE,kBACzCV,EAAM9D,WAAWwE,kBACnB/Y,KAAKyP,cAAcC,aAAa6E,WAAWC,gBAAkB6D,EAAM9D,WAAWC,gBAC9ExU,KAAKyP,cAAcC,aAAa6E,WAAWQ,gBAAkBsD,EAAM9D,WAAWQ,eAChF,CAEQ+kD,oBAAoBzhD,GAE1B,MAAM2hD,EAAWh6D,KAAKyP,cAAcC,aAgLpC,OA9KAsqD,EAASxjD,KAAKtM,KAA6B,GAAtBmO,EAAM7B,KAAKyjD,SAChCD,EAASxjD,KAAKqC,UAAY,EAC1BmhD,EAASxjD,KAAKM,QAAmC,GAAzBuB,EAAM7B,KAAK0jD,YACnCF,EAASxjD,KAAKygC,aAAe,EAE7B+iB,EAAShhD,SAASE,sBAAwB,CACxCb,EAAM0I,KAAKtH,UAAU,GACrBpB,EAAM0I,KAAKtH,UAAU,GACrBpB,EAAM0I,KAAKtH,UAAU,GACrBpB,EAAM0I,KAAKtH,UAAU,IAEvBugD,EAAShhD,SAASI,uBAAyB,CACzCf,EAAM0I,KAAKtH,UAAU,GACrBpB,EAAM0I,KAAKtH,UAAU,GACrBpB,EAAM0I,KAAKtH,UAAU,GACrBugD,EAASzlD,WAAWU,SAGtB+kD,EAAShhD,SAASH,UAAYR,EAAM0I,KAAKzd,MAEzC02D,EAASzgD,MAAMd,oBAAsB,CACnCJ,EAAMkB,MAAME,UAAU,GACtBpB,EAAMkB,MAAME,UAAU,GACtBpB,EAAMkB,MAAME,UAAU,GACtBpB,EAAMkB,MAAME,UAAU,IAExBugD,EAASzgD,MAAMZ,qBAAuB,CACpCN,EAAMkB,MAAME,UAAU,GACtBpB,EAAMkB,MAAME,UAAU,GACtBpB,EAAMkB,MAAME,UAAU,GACtBugD,EAASzlD,WAAWU,QAAU,IAEhC+kD,EAASzgD,MAAML,sBAAwB,CACrCb,EAAMkB,MAAME,UAAU,GACtBpB,EAAMkB,MAAME,UAAU,GACtBpB,EAAMkB,MAAME,UAAU,GACtBpB,EAAMkB,MAAME,UAAU,IAExBugD,EAASzgD,MAAMH,uBAAyB,CACtCf,EAAMkB,MAAME,UAAU,GACtBpB,EAAMkB,MAAME,UAAU,GACtBpB,EAAMkB,MAAME,UAAU,GACtBugD,EAASzlD,WAAWU,SAEtB+kD,EAASzgD,MAAMV,UAAYR,EAAMkB,MAAMjW,MACvC02D,EAASzgD,MAAM1U,MAAQwT,EAAMkB,MAAM1U,MAEnCm1D,EAAStgD,QAAQjB,oBAAsB,CACrCJ,EAAMqB,QAAQtV,KAAK,GACnBiU,EAAMqB,QAAQtV,KAAK,GACnBiU,EAAMqB,QAAQtV,KAAK,GACnBiU,EAAMqB,QAAQtV,KAAK,IAErB41D,EAAStgD,QAAQf,qBAAuB,CACtCN,EAAMqB,QAAQtV,KAAK,GACnBiU,EAAMqB,QAAQtV,KAAK,GACnBiU,EAAMqB,QAAQtV,KAAK,GACnB41D,EAASzlD,WAAWU,QAAU,IAEhC+kD,EAAStgD,QAAQR,sBAAwB,CACvCb,EAAMqB,QAAQD,UAAU,GACxBpB,EAAMqB,QAAQD,UAAU,GACxBpB,EAAMqB,QAAQD,UAAU,GACxBpB,EAAMqB,QAAQD,UAAU,IAE1BugD,EAAStgD,QAAQN,uBAAyB,CACxCf,EAAMqB,QAAQD,UAAU,GACxBpB,EAAMqB,QAAQD,UAAU,GACxBpB,EAAMqB,QAAQD,UAAU,GACxBugD,EAASzlD,WAAWU,QAAU,IAEhC+kD,EAAStgD,QAAQb,UAAYR,EAAMqB,QAAQpW,MAG3C02D,EAASngD,SAASpB,oBAAsB,CACtCJ,EAAMqB,QAAQtV,KAAK,GACnBiU,EAAMqB,QAAQtV,KAAK,GACnBiU,EAAMqB,QAAQtV,KAAK,GACnB41D,EAASzlD,WAAWU,SAEtB+kD,EAASngD,SAASX,sBAAwB,CACxCb,EAAMqB,QAAQD,UAAU,GACxBpB,EAAMqB,QAAQD,UAAU,GACxBpB,EAAMqB,QAAQD,UAAU,GACxBugD,EAASzlD,WAAWU,SAEtB+kD,EAASngD,SAAShB,UAAYR,EAAMqB,QAAQpW,MAsB5C02D,EAASxqB,eAAe3qC,MAAQwT,EAAM/N,eAAezF,MACrDm1D,EAASxqB,eAAesH,IAAIn8B,KAAOtC,EAAM/N,eAAewsC,IAAIn8B,KAC5Dq/C,EAASxqB,eAAesH,IAAIj+B,UAAYR,EAAM/N,eAAewsC,IAAIxzC,MACjE02D,EAASxqB,eAAesH,IAAI9yC,UAAYqU,EAAM/N,eAAewsC,IAAI1yC,KACjE41D,EAASxqB,eAAesH,IAAIz2B,YAAchI,EAAM/N,eAAewsC,IAAIz2B,YAEnE25C,EAASxqB,eAAeqH,WAAWl8B,KAAOtC,EAAM/N,eAAeusC,WAAWl8B,KAC1Eq/C,EAASxqB,eAAeqH,WAAWh+B,UAAYR,EAAM/N,eAAeusC,WAAWvzC,MAC/E02D,EAASxqB,eAAeqH,WAAW7yC,UAAYqU,EAAM/N,eAAeusC,WAAWzyC,KAC/E41D,EAASxqB,eAAeqH,WAAWx2B,YAAchI,EAAM/N,eAAeusC,WAAWx2B,YAEjF25C,EAASxqB,eAAen8B,WAAWsH,KAAOtC,EAAM/N,eAAe+I,WAAWsH,KAC1Eq/C,EAASxqB,eAAen8B,WAAWwF,UAAYR,EAAM/N,eAAe+I,WAAW/P,MAC/E02D,EAASxqB,eAAen8B,WAAWgN,YAAchI,EAAM/N,eAAe+I,WAAWgN,YAEjF25C,EAASxqB,eAAeuH,WAAWp8B,KAAOtC,EAAM/N,eAAeysC,WAAWp8B,KAC1Eq/C,EAASxqB,eAAeuH,WAAWl+B,UAAYR,EAAM/N,eAAeysC,WAAWzzC,MAC/E02D,EAASxqB,eAAeuH,WAAW/yC,UAAYqU,EAAM/N,eAAeysC,WAAW3yC,KAC/E41D,EAASxqB,eAAeuH,WAAW12B,YAAchI,EAAM/N,eAAeysC,WAAW12B,YAGjF25C,EAAStiB,OAAO7yC,MAAQwT,EAAM8hD,UAAUt1D,MAExCm1D,EAASzhD,OAAOo9B,IAAMt9B,EAAM+hD,aAAa5mD,IACzCwmD,EAASzhD,OAAOE,oBAAsBJ,EAAM+hD,aAAa3gD,UACzDugD,EAASzhD,OAAOw9B,WAAa19B,EAAM+hD,aAAarkB,WAChDikB,EAASzhD,OAAOs9B,YAAcx9B,EAAM+hD,aAAavkB,YACjDmkB,EAASzhD,OAAOu9B,iBAAmBz9B,EAAM+hD,aAAatkB,iBAItDkkB,EAASzhD,OAAO1T,MAAQwT,EAAM+hD,aAAav1D,MAE3Cm1D,EAASzhD,OAAOI,qBAAuB,CACrCN,EAAM+hD,aAAa3gD,UAAU,GAC7BpB,EAAM+hD,aAAa3gD,UAAU,GAC7BpB,EAAM+hD,aAAa3gD,UAAU,GAC7BugD,EAASzlD,WAAWU,SAGtB+kD,EAASrqD,OAAOgmC,IAAMt9B,EAAMgiD,cAAc7mD,IAC1CwmD,EAASrqD,OAAOomC,WAAa19B,EAAMgiD,cAActkB,WACjDikB,EAASrqD,OAAOkmC,YAAcx9B,EAAMgiD,cAAcxkB,YAClDmkB,EAASrqD,OAAOmmC,iBAAmBz9B,EAAMgiD,cAAcvkB,iBACvDkkB,EAASrqD,OAAOgJ,qBAAuB,CACrCN,EAAMgiD,cAAc5gD,UAAU,GAC9BpB,EAAMgiD,cAAc5gD,UAAU,GAC9BpB,EAAMgiD,cAAc5gD,UAAU,GAC9BugD,EAASzlD,WAAWU,QAAU,IAGhC+kD,EAASrqD,OAAO8I,oBAAsB,CACpCJ,EAAMgiD,cAAc5gD,UAAU,GAC9BpB,EAAMgiD,cAAc5gD,UAAU,GAC9BpB,EAAMgiD,cAAc5gD,UAAU,GAC9BpB,EAAMgiD,cAAc5gD,UAAU,IAEhCugD,EAASrqD,OAAOwmC,eAAiB,CAC/B99B,EAAMgiD,cAAcC,UAAU,GAC9BjiD,EAAMgiD,cAAcC,UAAU,GAC9BjiD,EAAMgiD,cAAcC,UAAU,GAC9BjiD,EAAMgiD,cAAcC,UAAU,IAEhCN,EAASrqD,OAAOumC,SAAW79B,EAAMgiD,cAAcnkB,SAC/C8jB,EAASrqD,OAAOsmC,WAAa59B,EAAMgiD,cAAcpkB,WACjD+jB,EAASrqD,OAAO9K,MAAQwT,EAAMgiD,cAAcx1D,MACrCm1D,CACT,CAEA,0BAAiC3hD,GAC/B,MAAM2hD,EAAWh6D,KAAKyP,cAAcC,aAiCpCsqD,EAASzhD,OAAOq9B,IAAM,CACpBr1C,KAAM,OACNgD,OAAQ,GACRD,MAAO,GAEPs+C,OAAQ5hD,KAAK64D,cAAcjX,QAI7B,IAAIr+C,EAAS,GACby2D,EAASzhD,OAAOq9B,IAAIryC,OAASA,EAC7By2D,EAASzhD,OAAOhV,OAASA,EACzB,IAAID,EAAQ,GACZ02D,EAASzhD,OAAOq9B,IAAItyC,MAAQA,EAC5B02D,EAASzhD,OAAOjV,MAAQA,EA0CxB,IAAIi3D,EAA8B,CAChCh6D,KAAM,OACN+C,MAAO,GACPC,OAAQ,GACRm8C,KAAM,GACNkC,OAAS5hD,KAAK84D,cAAclX,QAa9B,OAVAoY,EAASrqD,OAAOimC,IAAM2kB,EACtBh3D,EAAS,GACTy2D,EAASrqD,OAAOimC,IAAIryC,OAASA,EAC7By2D,EAASrqD,OAAOpM,OAASA,EACzBD,EAAQ,GACR02D,EAASrqD,OAAOimC,IAAItyC,MAAQA,EAC5B02D,EAASrqD,OAAOrM,MAAQA,EAExBtD,KAAKyP,cAAc7L,mBAAmBuS,eAAeC,eAAejI,cAE7D6rD,CACT,CAEQR,kBAAkBt2D,GAEtBlD,KAAKyP,cAAcC,aAAa6E,WAAW+E,SADnC,SAANpW,CAKN,CACQw2D,gBAAgBx2D,GACtBlD,KAAKyP,cAAcC,aAAa6E,WAAW8iC,UAAS,eAAWn0C,EAAE,GAAE,aAAKA,EAAE,GAAE,aAAKA,EAAE,GAAE,aAAKA,EAAE,GAAE,KAC9FlD,KAAKyP,cAAc7L,mBAAmBgL,oBAAoBmD,cAAc0xB,YAAY4T,UAAYr3C,KAAKyP,cAAcC,aAAa6E,WAAW8iC,SAC7I,CAEQoiB,uBAAuBF,GAC7Bv5D,KAAKyP,cAAcC,aAAa6E,WAAW6iC,uBACzCmiB,EAAOhlD,WAAWimD,kBACpBx6D,KAAKyP,cAAcC,aAAa6E,WAAWmhB,4BAA2B,eAAW6jC,EAAOhlD,WAAWimD,kBAAkB,GAAE,aAAKjB,EAAOhlD,WAAWimD,kBAAkB,GAAE,aAAKjB,EAAOhlD,WAAWimD,kBAAkB,GAAE,aAAKjB,EAAOhlD,WAAWimD,kBAAkB,GAAE,IAC1P,CACQb,gBAAgBn5C,EAAkBpc,GACxCpE,KAAKyP,cAAcC,aAAawpB,UAAUhgB,sBAAwBsH,EAClExgB,KAAKyP,cAAcC,aAAawpB,UAAUzgB,oBAAsBrU,CAClE,EClZK,MAAMq2D,GAKX56D,YAAY66D,GAAyC,KAJ9C7gC,IAAM,GAAG,KACTK,UAAW,EAAM,KACjBF,YAAa,EAAM,KACnBzsB,GAAwB8sB,EAAAA,GAAAA,KAE7Br6B,KAAK65B,IAAM6gC,EAAmB7gC,IAAIC,cAClC95B,KAAKk6B,SAAWwgC,EAAmBzqD,MACnCjQ,KAAKg6B,WAAa0gC,EAAmBC,OACvC,EAEK,MAAMC,GAOX/6D,YAAY4P,EAA8B4I,GAAc,KANjD5I,mBAAa,OAGbmqB,iBAAwB,CAAC,EAI9B55B,KAAKyP,cAAgBA,EACjB4I,EACFrY,KAAKw1D,cAAcn9C,GAEnBrY,KAAKw1D,cACHx1D,KAAKyP,cAAc7L,mBAAmBC,gBAAgBC,IAAIkI,MAAM6uD,OAAOxiD,MAG7E,CAEOm9C,cAAc+D,GACnB,GAAKA,EAAO5/B,SAGZ,IAAK,IAAI14B,EAAI,EAAGA,EAAIs4D,EAAO5/B,SAASz4B,SAAUD,EAC5C65D,OAAOC,KAAKxB,EAAO5/B,SAAS14B,IAAI+kB,SAAS6T,IACvC,MAAMnrB,EAAQ6qD,EAAO5/B,SAAS14B,GAAG44B,GACjC,GAAY,WAARA,GAAkC,KAAdnrB,EAAMmrB,IAAY,CACxC,MAAML,EAAK,IAAIihC,GAAgB/rD,GAG/B,OAFA8qB,EAAGjsB,GAAK8sB,EAAAA,GAAAA,YACRr6B,KAAK45B,iBAAiBlrB,EAAMmrB,IAAIC,eAAiBN,EAEnD,CACA,GAAY,eAARK,GAAsC,KAAdnrB,EAAMmrB,IAAY,CAC5C,MAAML,EAAK,IAAIihC,GAAgB/rD,GAG/B,OAFA8qB,EAAGjsB,GAAK8sB,EAAAA,GAAAA,iBACRr6B,KAAK45B,iBAAiBlrB,EAAMmrB,IAAIC,eAAiBN,EAEnD,CACA,GAAY,SAARK,GAAgC,KAAdnrB,EAAMmrB,IAAY,CACtC,MAAML,EAAK,IAAIihC,GAAgB/rD,GAG/B,OAFA8qB,EAAGjsB,GAAK8sB,EAAAA,GAAAA,UACRr6B,KAAK45B,iBAAiBlrB,EAAMmrB,IAAIC,eAAiBN,EAEnD,CACA,GAAY,SAARK,GAAgC,KAAdnrB,EAAMmrB,IAAY,CACtC,MAAML,EAAK,IAAIihC,GAAgB/rD,GAG/B,OAFA8qB,EAAGjsB,GAAK8sB,EAAAA,GAAAA,UACRr6B,KAAK45B,iBAAiBlrB,EAAMmrB,IAAIC,eAAiBN,EAEnD,CACA,GAAY,WAARK,GAAkC,KAAdnrB,EAAMmrB,IAAY,CACxC,MAAML,EAAK,IAAIihC,GAAgB/rD,GAG/B,OAFA8qB,EAAGjsB,GAAK8sB,EAAAA,GAAAA,mBACRr6B,KAAK45B,iBAAiBlrB,EAAMmrB,IAAIC,eAAiBN,EAEnD,CACA,GAAY,WAARK,GAAkC,KAAdnrB,EAAMmrB,IAAY,CACxC,MAAML,EAAK,IAAIihC,GAAgB/rD,GAG/B,OAFA8qB,EAAGjsB,GAAK8sB,EAAAA,GAAAA,oBACRr6B,KAAK45B,iBAAiBlrB,EAAMmrB,IAAIC,eAAiBN,EAEnD,CACA,GAAY,aAARK,GAAoC,KAAdnrB,EAAMmrB,IAAY,CAC1C,MAAML,EAAK,IAAIihC,GAAgB/rD,GAG/B,OAFA8qB,EAAGjsB,GAAK8sB,EAAAA,GAAAA,sBACRr6B,KAAK45B,iBAAiBlrB,EAAMmrB,IAAIC,eAAiBN,EAEnD,CACA,GAAY,qBAARK,GAA4C,KAAdnrB,EAAMmrB,IAAY,CAClD,MAAML,EAAK,IAAIihC,GAAgB/rD,GAG/B,OAFA8qB,EAAGjsB,GAAK8sB,EAAAA,GAAAA,+BACRr6B,KAAK45B,iBAAiBlrB,EAAMmrB,IAAIC,eAAiBN,EAEnD,CACA,GAAY,YAARK,GAAmC,KAAdnrB,EAAMmrB,IAAY,CACzC,MAAML,EAAK,IAAIihC,GAAgB/rD,GAG/B,OAFA8qB,EAAGjsB,GAAK8sB,EAAAA,GAAAA,mBACRr6B,KAAK45B,iBAAiBlrB,EAAMmrB,IAAIC,eAAiBN,EAEnD,CACA,GAAY,oBAARK,GAA2C,KAAdnrB,EAAMmrB,IAAY,CACjD,MAAML,EAAK,IAAIihC,GAAgB/rD,GAG/B,OAFA8qB,EAAGjsB,GAAK8sB,EAAAA,GAAAA,4BACRr6B,KAAK45B,iBAAiBlrB,EAAMmrB,IAAIC,eAAiBN,EAEnD,CACA,GAAY,mBAARK,GAA0C,KAAdnrB,EAAMmrB,IAAY,CAChD,MAAML,EAAK,IAAIihC,GAAgB/rD,GAG/B,OAFA8qB,EAAGjsB,GAAK8sB,EAAAA,GAAAA,qBACRr6B,KAAK45B,iBAAiBlrB,EAAMmrB,IAAIC,eAAiBN,EAEnD,CACA,GAAY,gBAARK,GAAuC,KAAdnrB,EAAMmrB,IAAY,CAC7C,MAAML,EAAK,IAAIihC,GAAgB/rD,GAG/B,OAFA8qB,EAAGjsB,GAAK8sB,EAAAA,GAAAA,kBACRr6B,KAAK45B,iBAAiBlrB,EAAMmrB,IAAIC,eAAiBN,EAEnD,CACA,GAAY,iBAARK,GAAwC,KAAdnrB,EAAMmrB,IAAY,CAC9C,MAAML,EAAK,IAAIihC,GAAgB/rD,GAG/B,OAFA8qB,EAAGjsB,GAAK8sB,EAAAA,GAAAA,kBACRr6B,KAAK45B,iBAAiBlrB,EAAMmrB,IAAIC,eAAiBN,EAEnD,IAGN,ECvHK,MAAMwhC,GAOXn7D,YAAY+D,EAAkCyU,GAAc,KANrDzU,wBAAkB,OAClBgX,eAAS,OACT66C,sBAAgB,OAChB97B,cAAQ,OACRjqB,kBAAY,EAGjB1P,KAAK4D,mBAAqBA,EAErByU,IACHA,EAAQrY,KAAK4D,mBAAmBC,gBAAgBC,IAAIkI,MAAM6uD,OAAOxiD,OAGnErY,KAAK4a,UAAY,IAAIi9C,GAAU73D,KAAMqY,GACrCrY,KAAKy1D,iBAAmB,IAAI8C,GAAiBv4D,KAAMqY,GACnDrY,KAAK25B,SAAW,IAAIihC,GAAS56D,KAAMqY,EACrC,CACOk3C,gBACL,OAAOvvD,KAAK0P,aAAakoC,cAC3B,ECzBK,MAAeqjB,GAsBpBp7D,YAAY+wD,GAAsC,IAAhBtwD,EAAE,uDAAG,SAAQ,KArBxCswD,aAAO,OACPltB,YAAM,OACNhgC,SAAG,OACHiyD,gBAAU,OACVuF,aAAO,OACPjpD,0BAAoB,OACpBkpD,qBAAe,OACf76D,GAAK,SAAS,KACdwL,OAAS,IAAI,KACbsvD,QAAU,EAAE,KACZC,gBAAiB,EAAK,KACtB7L,OAAQ,EAAM,KACd8L,eAAS,OACTC,UAAY,GAAG,KACfC,QAAS,EAAK,KACd5uB,gBAAiB,EAAM,KACvBgoB,UAAW,EAAM,KAChB6G,UAAI,OAELC,iCAA2B,EAGhC17D,KAAK4wD,QAAUA,EACf5wD,KAAKM,GAAKA,EACVN,KAAK27D,SACP,CACOA,UACL37D,KAAK21D,WAAajqD,SAASC,cAAc,UACzC3L,KAAK21D,WAAWr1D,GAAKN,KAAKM,GAC1BN,KAAK21D,WAAW/pD,MAAMtI,MAAQ,OAC9BtD,KAAK21D,WAAW/pD,MAAMrI,OAAS,OAC/BvD,KAAK21D,WAAW/pD,MAAME,OAAS9L,KAAK8L,OACpC9L,KAAK21D,WAAW/pD,MAAMC,SAAW,WACjC7L,KAAK21D,WAAW/pD,MAAMm4C,cAAgB,OACtC/jD,KAAKk7D,QAAUl7D,KAAK21D,WAAWiG,WAAW,MAC1C57D,KAAKk7D,QAAQW,yBAA2B,cACxC77D,KAAK4wD,QAAQzkD,YAAYnM,KAAK21D,YAU9B31D,KAAK0jC,OAASh4B,SAASC,cAAc,UAIrC3L,KAAK0jC,OAAOpjC,GAAKN,KAAKM,GACtBN,KAAK0jC,OAAO93B,MAAMtI,MAAQ,OAC1BtD,KAAK0jC,OAAO93B,MAAMrI,OAAS,OAC3BvD,KAAK0jC,OAAO93B,MAAME,OAAS9L,KAAK8L,OAChC9L,KAAK0jC,OAAO93B,MAAMC,SAAW,WAC7B7L,KAAK0jC,OAAO93B,MAAMm4C,cAAgB,OAGlC/jD,KAAK0D,IAAM1D,KAAK0jC,OAAOk4B,WAAW,MAClC57D,KAAK0D,IAAIm4D,yBAA2B,cAOpC77D,KAAKs7D,UAAY,IAAIQ,GACrB97D,KAAKiS,qBAAuB,IAAI8pD,GAAqB,KACrD/7D,KAAKiS,qBAAqBC,MAAQ,EAMlClS,KAAK8R,OACL9R,KAAKg8D,MACP,CACOlqD,OACL,CAEKkqD,OACL,IAAKh8D,KAAK40D,SACR,OAQF,MAAMqH,EAASC,YAAYC,MAG3B,GAFAn8D,KAAKs7D,UAAUc,YAEXp8D,KAAKiS,qBAAqBC,MAAQ,GACpC,GAAwC,IAApClS,KAAKiS,qBAAqBC,MAE5BmqD,uBAAsB,KACpBr8D,KAAKg8D,MAAM,IAEbh8D,KAAKs8D,QACLt8D,KAAKyD,cACA,GAAwC,IAApCzD,KAAKiS,qBAAqBC,MAC/BlS,KAAK4sC,eACPyvB,uBAAsB,KACpBr8D,KAAKg8D,MAAM,IASfh8D,KAAKs8D,QACLt8D,KAAKyD,cACA,GAAwC,IAApCzD,KAAKiS,qBAAqBC,MAAa,CAYhD,GAXIlS,KAAK4sC,eACPyvB,uBAAsB,KACpBr8D,KAAKg8D,MAAM,IASVh8D,KAAKiS,qBAAqBwwB,KAK7B,OAJAziC,KAAKs8D,QACLt8D,KAAKyD,SACLzD,KAAKiS,qBAAqBsqD,cAI9B,OAC6C,IAApCv8D,KAAKiS,qBAAqBC,OAE/BlS,KAAK4sC,eACP5sC,KAAKs8D,SAMPt8D,KAAKs8D,QACLt8D,KAAKyD,UAEP,MAAM+4D,EAAQN,YAAYC,MAC1Bn8D,KAAKy8D,IAAG,kBAAcz8D,KAAKiS,qBAAqBC,MAAK,2BAAmBlS,KACrEo7D,UAAS,kBAAUp7D,KAAKs7D,UAAUC,UAAUt3C,QAAQ,GAAE,4BACvDu4C,EAAQP,GACRh4C,QAAQ,GAAE,mBACZjkB,KAAK08D,QACP,CACWD,QAAIruD,GACbpO,KAAKy7D,KAAOrtD,CACd,CACWquD,UACT,OAAOz8D,KAAKy7D,IACd,CAGOkB,cAAcxB,GACnBn7D,KAAKm7D,gBAAkBA,CACzB,CACOyB,OAAOt5D,EAAeC,GAC3BvD,KAAK0jC,OAAOpgC,MAAQA,EACpBtD,KAAK0jC,OAAOngC,OAASA,CACvB,CACO+4D,QACLt8D,KAAK0D,IAAIm5D,UAAU,EAAG,EAAG78D,KAAK0jC,OAAOpgC,MAAOtD,KAAK0jC,OAAOngC,QACxDvD,KAAKk7D,QAAQ2B,UAAU,EAAG,EAAG78D,KAAK0jC,OAAOpgC,MAAOtD,KAAK0jC,OAAOngC,QACxDvD,KAAKm7D,iBACPn7D,KAAKm7D,gBAAgBmB,OAEzB,CACO1gC,YACL57B,KAAKiS,qBAAqBC,MAAQ,EAClClS,KAAKg8D,MACP,CACOngC,YACL77B,KAAKiS,qBAAqBC,MAAQ,EAClClS,KAAKg8D,MACP,CACOlgC,YACL97B,KAAKiS,qBAAqBC,MAAQ,EAClClS,KAAKg8D,MACP,CACOc,kBACL98D,KAAKiS,qBAAqBwwB,MAAO,CACnC,CACO1G,YACL/7B,KAAKiS,qBAAqBpP,QAC1B4J,YAAW,KACTzM,KAAKiS,qBAAqBC,MAAQ,EAClClS,KAAKg8D,MAAM,GACV,IACL,CACOhgC,YACLh8B,KAAKiS,qBAAqBpP,QAC1B4J,YAAW,KACTzM,KAAKiS,qBAAqBC,MAAQ,EAClClS,KAAKg8D,MAAM,GACV,IACL,CACO//B,YACLj8B,KAAKiS,qBAAqBpP,QAC1B4J,YAAW,KACTzM,KAAKiS,qBAAqBC,MAAQ,EAClClS,KAAKg8D,MAAM,GACV,IACL,EAEK,MAAMF,GAQXj8D,cAAe,KAPRs8D,SAAG,OACHY,WAAK,OACLxB,eAAS,OAERyB,KAAO,EAAE,KACTC,oBAAc,OACtBC,YAAM,CAGN,CACOd,YACLp8D,KAAKm8D,IAAMgB,OAAOjB,YAAYC,MAC9Bn8D,KAAKk9D,OAASl9D,KAAKm8D,IAAMn8D,KAAKg9D,KAC9Bh9D,KAAKg9D,KAAOh9D,KAAKm8D,IAEjBn8D,KAAK+8D,MAAQ/8D,KAAK+8D,MAAQzqD,KAAK8qD,IAAI,EAAGp9D,KAAKk9D,OAAS,KAEhDl9D,KAAK+8D,MAAQ/8D,KAAKu7D,YACpBv7D,KAAK+8D,MAAQ/8D,KAAK+8D,MAAQ/8D,KAAKu7D,WAGjCv7D,KAAK+8D,OAASM,KAAKlB,MAAQn8D,KAAKi9D,gBAAkB,IAClDj9D,KAAKi9D,eAAiBI,KAAKlB,MAC3Bn8D,KAAKu7D,UAAY,EAAIv7D,KAAK+8D,KAC5B,CACW1nD,SACT,OAAOrV,KAAK+8D,KACd,EAGK,MAAMhB,GAKXl8D,YAAYy9D,GAAuB,KAJnCA,kBAAY,OACJC,QAAU,EAAE,KACZC,OAAQ,EAAM,KACdC,UAAY,EAElBz9D,KAAKs9D,aAAeA,CACtB,CACW76B,WACT,OAAOziC,KAAKw9D,KACd,CACW/6B,SAAKv/B,GACdlD,KAAKy9D,UAAY,EACjBz9D,KAAKw9D,MAAQt6D,CACf,CACOq5D,eACLv8D,KAAKy9D,YAEDz9D,KAAKy9D,UAAYz9D,KAAKs9D,eACxBt9D,KAAKy9D,UAAY,EACjBz9D,KAAKyiC,MAAO,EAEhB,CACO5/B,QACL7C,KAAKu9D,QAAU,CACjB,CACWrrD,YACT,OAAOlS,KAAKu9D,MACd,CACWrrD,UAAMhP,GACflD,KAAKu9D,OAASr6D,CAChB,EAEK,MAAew6D,GAKpB79D,YAAY89D,GAAgC,KAH5CA,gBAAU,OACVj6B,YAAM,OACNk6B,kBAAY,EAEVF,GAAwBG,SAAW79D,KAEnCA,KAAK29D,WAAaA,EAClB39D,KAAK8R,MACP,CACOA,OACL9R,KAAK0jC,OAASh4B,SAASC,cAAc,UACrC3L,KAAK0jC,OAAOpjC,GAAK,YACjBN,KAAK0jC,OAAO93B,MAAME,OAAS,KAC3B9L,KAAK0jC,OAAO93B,MAAMC,SAAW,WAC7B7L,KAAK49D,aAAe59D,KAAK0jC,OAAOk4B,WAAW,MAG3C57D,KAAK0jC,OAAOpgC,MAAQtD,KAAK29D,WAAWr6D,MACpCtD,KAAK0jC,OAAOngC,OAASvD,KAAK29D,WAAWp6D,MAGvC,CACOmqD,aAAapqD,EAAeC,GACjCvD,KAAK49D,aAAal6B,OAAOpgC,MAAQA,EACjCtD,KAAK49D,aAAal6B,OAAOngC,OAASA,CACpC,CACO+4D,QACLt8D,KAAK49D,aAAaf,UAChB,EACA,EACA78D,KAAK49D,aAAal6B,OAAOpgC,MACzBtD,KAAK49D,aAAal6B,OAAOngC,OAE7B,EAnCoBm6D,GACbG,cAAQ,ECpRV,MAAMC,WAAgB7C,GAmC3Bp7D,YAAYkS,GAA+C,IAAjBwpD,EAAS,uDAAG,GACpDr2D,MACE6M,EAAcnD,oBAAoB4mB,aAAa3xB,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAC1F,uBACA,KAtCG6F,mBAAa,OACbwpD,eAAS,OACT73B,YAAM,OAENpjC,QAAE,OACFoD,SAAG,OACH6oB,UAAI,OACJC,UAAI,OACJuxC,iBAAW,OACXC,iBAAW,OACXC,aAAO,OACPC,aAAO,OACPC,YAAM,OACNC,gBAAU,OACVC,mBAAa,OACbC,uBAAiB,OACjBC,WAAK,OAGLC,cAAQ,OACRhD,YAAM,OACNyB,oBAAc,OACdF,WAAK,OACLZ,SAAG,OACHsC,KAAO,EAAE,KACTC,SAAW,EAAE,KACb1B,KAAO,EAAE,KACT2B,mBAAa,OACbC,aAAO,OACPC,eAAiB,EAAE,KACnBC,KAAO,EAAE,KACRC,mBAAa,OAEbC,WAAa,EAMnBh/D,KAAK+R,cAAgBA,EAErB/R,KAAKusB,KAAO,EACZvsB,KAAKwsB,KAAO,EACZxsB,KAAK+9D,YAAc,EACnB/9D,KAAKg+D,YAAc,EACnBh+D,KAAKi+D,QAAU,EACfj+D,KAAKk+D,QAAU,EACfl+D,KAAKm+D,OAAS,IAAI97D,EAAAA,GAAS,EAAG,EAAG,GACjCrC,KAAKi9D,eAAiB,EACtBj9D,KAAK+8D,MAAQ,EACb/8D,KAAK2+D,cAAgB,IACrB3+D,KAAKw+D,SAAW,GAChBx+D,KAAK0vD,cAAe,EACpB1vD,KAAKw7D,QAAS,EAEdx7D,KAAKu7D,UAAYA,EACjBv7D,KAAKs7D,UAAUC,UAAYA,EAC3Bv7D,KAAKi8B,YACLj8B,KAAKi/D,UAAY,CAMnB,CACWA,gBACT,OAAOj/D,KAAKg/D,UACd,CACWC,cAAU/7D,GACnBlD,KAAKg/D,WAAa97D,CACpB,CACOg8D,SAASC,GACdn/D,KAAK40D,SAAWuK,EAChBn/D,KAAK0D,IAAIkS,QAAUC,EAAAA,GAAAA,KACrB,CACIupD,0BAAsBl8D,GACxBlD,KAAK0D,IAAI07D,sBAAwBl8D,EACjClD,KAAKk7D,QAAQkE,sBAAwBl8D,CACvC,CACO6uD,eACL,OAAO/xD,KAAK0D,IAAIquD,aAAa,EAAG,EAAG/xD,KAAK0D,IAAIggC,OAAOpgC,MAAOtD,KAAK0D,IAAIggC,OAAOngC,OAC5E,CACOE,SAYL,GAJAzD,KAAKq/D,YAELr/D,KAAK8+D,MAAQ,MAER9+D,KAAK40D,SAIR,OAFA50D,KAAK+R,cAAcwlD,iBAAiB+E,aACpCt8D,KAAKk7D,QAAQ2B,UAAU,EAAG,EAAG78D,KAAKk7D,QAAQx3B,OAAOpgC,MAAOtD,KAAKk7D,QAAQx3B,OAAOngC,QAI9EvD,KAAK+R,cAAcwlD,iBAAiB+E,QAGpCt8D,KAAK+R,cAAcnD,oBAAoB0wD,gBAAgB77D,OAAOzD,KAAK0D,KAGnE1D,KAAKk7D,QAAQ2B,UAAU,EAAG,EAAG78D,KAAKk7D,QAAQx3B,OAAOpgC,MAAOtD,KAAKk7D,QAAQx3B,OAAOngC,QAElD,IAAtBvD,KAAK0jC,OAAOpgC,OAAsC,IAAvBtD,KAAK0jC,OAAOngC,OACzCvD,KAAKk7D,QAAQhW,UAAUllD,KAAK0jC,OAAQ,EAAG,IAEvC1jC,KAAKw7D,QAAS,EACdx7D,KAAK40D,UAAW,EAChB50D,KAAKiS,qBAAqBwwB,MAAO,EAErC,CACO65B,QACL,CAEK+C,YACLr/D,KAAK0D,IAAIm5D,UAAU,EAAG,EAAG78D,KAAK0jC,OAAOpgC,MAAOtD,KAAK0jC,OAAOngC,QACxDvD,KAAKk7D,QAAQ2B,UAAU,EAAG,EAAG78D,KAAK0jC,OAAOpgC,MAAOtD,KAAK0jC,OAAOngC,QACxDvD,KAAKm7D,iBACPn7D,KAAKm7D,gBAAgBmB,OAEzB,CACO5O,aAAapqD,EAAeC,GACjCvD,KAAK0D,IAAIggC,OAAOpgC,MAAQA,EACxBtD,KAAK0D,IAAIggC,OAAOngC,OAASA,EACzBvD,KAAKk7D,QAAQx3B,OAAOpgC,MAAQA,EAC5BtD,KAAKk7D,QAAQx3B,OAAOngC,OAASA,CAC/B,CACOg8D,UACLv/D,KAAK47B,YACL57B,KAAKw7D,QAAS,EACdx7D,KAAK40D,UAAW,EAChB50D,KAAKiS,qBAAqBwwB,MAAO,EACjCziC,KAAKg8D,KAAO,KACJ,EAERh8D,KAAKyD,OAAS,KACN,EAEJzD,KAAK0jC,OAAO72B,YACd7M,KAAK0jC,OAAO72B,WAAWE,YAAY/M,KAAK0jC,OAE5C,CACOg5B,SAOL,CAEShN,mBACT,OAAO1vD,KAAK++D,aACd,CACWrP,iBAAaxsD,GACtBlD,KAAK++D,cAAgB77D,CAEvB,CACOs8D,UAAgB,IAARj1D,EAAC,uDAAG,EACjBvK,KAAK40D,UAAW,EAChB50D,KAAK+R,cAAcwlD,iBAAiB+E,QACpCt8D,KAAKk7D,QAAQ2B,UAAU,EAAG,EAAG78D,KAAKk7D,QAAQx3B,OAAOpgC,MAAOtD,KAAKk7D,QAAQx3B,OAAOngC,QACxEgH,EAAI,GACNkC,YAAW,KACTzM,KAAKy/D,UAAU,GACdl1D,EAEP,CACOk1D,WACLz/D,KAAK40D,UAAW,EAChB50D,KAAKw7D,QAAS,EACdx7D,KAAK+R,cAAclD,cACnB7O,KAAKg8D,MACP,ECtLK,MAAM0D,GAOX7/D,YAAYkS,GAA+B,KANpCA,mBAAa,OACb2xB,YAAM,OACNhgC,SAAG,OACHkxD,UAAW,EAAK,KACf+K,gBAAU,OACVC,YAAM,EAEZ5/D,KAAK+R,cAAgBA,EACrB/R,KAAK2/D,WAAa,UAEhB3/D,KAAK+R,cAAcnD,oBAAoB4mB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAC3EqmB,cAAcuG,aAEjB1iC,KAAK4/D,OAAS,EAIhB5/D,KAAK8R,MACP,CACOA,OAEL9R,KAAK0jC,OAASh4B,SAASC,cAAc,UACrC3L,KAAK0jC,OAAOpjC,GAAK,0BACjBN,KAAK0jC,OAAO93B,MAAME,OAAS,IAC3B9L,KAAK0jC,OAAO93B,MAAMC,SAAW,WAC7B7L,KAAK0jC,OAAO93B,MAAMm4C,cAAgB,OAClC/jD,KAAK0D,IAAM1D,KAAK0jC,OAAOk4B,WAAW,MAElC57D,KAAK+R,cAAcnD,oBAAoB4mB,aAAa3xB,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAIC,YACjGnM,KAAK0jC,QAEP1jC,KAAK0D,IAAIm4D,yBAA2B,cAMpC77D,KAAK0jC,OAAOpgC,MAAQ,EACpBtD,KAAK0jC,OAAOngC,OAAS,EAGrBvD,KAAK6/D,YACP,CACIxoB,gBACF,OAAOr3C,KAAK2/D,UACd,CACItoB,cAAU1sC,GACZ3K,KAAK2/D,WAAah1D,EAClB3K,KAAK6/D,YACP,CACIv8D,YACF,OAAOtD,KAAK4/D,MACd,CACIt8D,UAAM+I,GACRrM,KAAK4/D,OAASvzD,EACdrM,KAAK6/D,YACP,CACOnS,aAAapqD,EAAeC,GACjCvD,KAAK0jC,OAAOpgC,MAAQA,EACpBtD,KAAK0jC,OAAOngC,OAASA,EACrBvD,KAAK6/D,YACP,CACOA,aACA7/D,KAAK40D,WAIV50D,KAAK0D,IAAIm5D,UAAU,EAAG,EAAG78D,KAAK0jC,OAAOpgC,MAAOtD,KAAK0jC,OAAOngC,QACxDvD,KAAK0D,IAAImV,UAAY,EACrB7Y,KAAK0D,IAAI2c,YAAcrgB,KAAK2/D,WAC5B3/D,KAAK0D,IAAIM,UAAYhE,KAAK2/D,WAC1B3/D,KAAK0D,IAAIO,YACTjE,KAAK0D,IAAIQ,KAAK,EAAG,EAAGlE,KAAK4/D,OAAQ5/D,KAAK0jC,OAAOngC,QAC7CvD,KAAK0D,IAAIQ,KAAKlE,KAAK0jC,OAAOpgC,MAAQtD,KAAK4/D,OAAQ,EAAG5/D,KAAK0jC,OAAOpgC,MAAOtD,KAAK0jC,OAAOngC,QACjFvD,KAAK0D,IAAIS,YACTnE,KAAK0D,IAAIU,OAEX,EC7EK,MAAM07D,WAAyBpC,GAMpC79D,YAAYkS,GACV7M,MAAM6M,EAAcC,QAAQ0xB,QAAQ,KAL/B3xB,mBAAa,OACb2xB,YAAM,OACNkxB,UAAW,EAAK,KAChBgJ,kBAAY,EAGjB59D,KAAK+R,cAAgBA,EAErB/R,KAAK0jC,OAAOpjC,GAAK,sBACjBN,KAAK49D,aAAawB,uBAAwB,CAG5C,CACO3e,YACLzgD,KAAK+R,cAAcnD,oBAAoB4mB,aAAa3xB,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAIC,YACjGnM,KAAK0jC,OAET,CACO4Q,YACLt0C,KAAK+R,cAAcnD,oBAAoB4mB,aAAa3xB,gBAAgBC,IAAIkI,MAAMC,iBAAiBC,IAAIa,YACjG/M,KAAK0jC,OAET,CACOq8B,uBACL,OAAO//D,KAAK49D,YACd,CACOtB,QACLt8D,KAAK49D,aAAaf,UAAU,EAAG,EAAG78D,KAAK0jC,OAAOpgC,MAAOtD,KAAK0jC,OAAOngC,OACnE,CACOy8D,cAAc5+D,EAAWC,GAC9B,IAAKrB,KAAK40D,SACR,MAAO,GAET,MAAM5C,EAAQhyD,KAAK49D,aAAa7L,aAAa3wD,EAAGC,EAAG,EAAG,GAAGP,KAEzD,MADS,cAAUkxD,EAAM,GAAE,YAAIA,EAAM,GAAE,YAAIA,EAAM,GAAE,IAErD,ECpCK,MAAMiO,GAKXpgE,YAAY+O,EAA0CuwD,GAA0B,KAJzEvwD,yBAAmB,OACnBoD,aAAO,OACPyxB,iBAAW,OACX8zB,sBAAgB,EAErBv3D,KAAK4O,oBAAsBA,EAE3B5O,KAAKgS,QAAU,IAAI8rD,GAAQ99D,MAE3BA,KAAKgS,QAAQ+pB,YACb/7B,KAAKu3D,iBAAmB,IAAIuI,GAAiB9/D,MAC7CA,KAAKyjC,YAAc,IAAIi8B,GAAY1/D,MACnCA,KAAKgS,QAAQktD,SAASC,EACxB,CACO3P,QAAc,IAARjlD,EAAC,uDAAG,EACfvK,KAAKgS,QAAQwtD,QAAQj1D,EACvB,CACOklD,SACLzvD,KAAKgS,QAAQytD,UACf,CACOF,UACLv/D,KAAKgS,QAAQutD,UACbv/D,KAAK40D,UAAW,CAClB,CACO/lD,cACL7O,KAAKgS,QAAQC,qBAAqBwwB,MAAO,CAC3C,CACOirB,aAAapqD,EAAeC,GACjCvD,KAAKgS,QAAQ07C,aAAapqD,EAAOC,GAO7BvD,KAAKu3D,mBACPv3D,KAAKu3D,iBAAiB7zB,OAAOpgC,MAAQA,EACrCtD,KAAKu3D,iBAAiB7zB,OAAOngC,OAASA,EAEtCvD,KAAKu3D,iBAAiB7zB,OAAO93B,MAAMtI,MAAQtD,KAAKgS,QAAQ0xB,OAAO93B,MAAMtI,MACrEtD,KAAKu3D,iBAAiB7zB,OAAO93B,MAAMrI,OAASvD,KAAKgS,QAAQ0xB,OAAO93B,MAAMrI,OAE1E,CACIqxD,aAAS1xD,GACXlD,KAAKgS,QAAQ4iD,SAAW1xD,EACxBlD,KAAKu3D,iBAAiB3C,SAAW1xD,EACjClD,KAAKyjC,YAAYmxB,SAAW1xD,EACxBA,GACFlD,KAAKgS,QAAQgqD,MAGjB,ECtDK,MAAMkE,GAEXrgE,YAAY+O,GAA2C,KADhDA,yBAAmB,EAExB5O,KAAK4O,oBAAsBA,CAC7B,CACO8+C,aAAapqD,EAAeC,GACjCvD,KAAK4O,oBAAoBmD,cAAc27C,aAAapqD,EAAOC,EAC7D,CACOE,OAAOC,GAEZ1D,KAAK4O,oBAAoB4mB,aAAa3xB,gBAAgBJ,OAAOC,EAE/D,ECVK,MAAMy8D,GAOXtgE,YAAY+D,EAAkCu7D,GAA0B,KANjE3pC,kBAAY,OAEZzjB,mBAAa,OACbutD,qBAAe,OACf3pD,4BAA8B,EAGnC3V,KAAKw1B,aAAe5xB,EACpB5D,KAAK+R,cAAgB,IAAIkuD,GAAcjgE,KAAMm/D,EAC/C,CACOD,WACLl/D,KAAKs/D,gBAAkB,IAAIY,GAAgBlgE,KAE7C,CACOwvD,QAAc,IAARjlD,EAAC,uDAAG,EACfvK,KAAK+R,cAAcy9C,MAAMjlD,EAC3B,CACOklD,SACLzvD,KAAK+R,cAAc09C,QACrB,CACO/B,aAAapqD,EAAeC,GACjCvD,KAAK+R,cAAc27C,aAAapqD,EAAOC,EACzC,CACOsL,cACL7O,KAAK+R,cAAclD,aACrB,CACO0wD,UACLv/D,KAAK+R,cAAcwtD,SACrB,EC5BK,MAAMa,GAAY,IAClB,MAAMC,GAIXxgE,YAAYkK,GAA2B,KAHhCA,QAAE,OACFu2D,kBAAY,OACZ7D,KAAM,EAEXz8D,KAAK+J,GAAKA,EACV/J,KAAK8R,MACP,CACOA,OACL9R,KAAKsgE,aAAe,CACtB,CACO9S,YAAYjgD,GACbvN,KAAKy8D,IAGT,MAAMxoB,EAAI,oBAAiC1mC,EAAGwF,WAC9C/S,KAAK+J,GAAGirD,WAAW/gB,EACrB,CACOssB,iBAAiBC,EAAiBt9D,GACvC,MAAM+wC,EAAC,UAAMusB,GAAO,OAAGJ,IAAS,OAAGl9D,GACnClD,KAAK+J,GAAGirD,WAAW/gB,EACrB,CACOwsB,kBAAkBxsB,GACnBj0C,KAAKy8D,GAMX,CACO3rD,iBAAiBmjC,GAKtB,GAJIj0C,KAAKy8D,KAIJxoB,EACH,OAEF,MAAMysB,EAAU,OAAoBxsB,KAAKyD,UAAU1D,GACnDj0C,KAAKsgE,eAELtgE,KAAK+J,GAAGirD,WAAW0L,GACnB1gE,KAAK+J,GAAGyrB,aAAa7xB,MAAMooD,cAC7B,CACOplC,eAAestB,GAIpB,GAHIj0C,KAAKy8D,IAGJxoB,EAGL,GAAIA,EAAEzzC,WAAY,CAChB,MAAMkgE,EAAO,gBAAYN,IAAS,OAAGlsB,KAAKyD,UAAU,CAAC1D,EAAE3zC,MAEvD,GAAIN,KAAK+J,GAAGyrB,aAAahqB,wBAAwB8C,aAAayQ,YACxD/e,KAAK+J,GAAGyrB,aAAa3xB,gBAAgBC,IAAI68D,MAAQC,EAAAA,GAAAA,cAAoB,CACvE,MAAMC,EAAY7gE,KAAK+J,GAAGyrB,aAAarf,eAAe2M,eAAe0vC,oBACrE,GAAIqO,EAAU3/D,OAEZ,YADAlB,KAAKm1D,oBAAoB0L,EAG7B,CAIA7gE,KAAK+J,GAAGyrB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeqmB,cAAcC,cAC5EC,EAAAA,GAAAA,YAEAr8B,KAAKsgE,eACLtgE,KAAK+J,GAAGirD,WAAW0L,IAEnB1gE,KAAK+J,GAAGirD,WAAW0L,EAEvB,KAAO,CACL,MAAMA,EAAO,kBAAcN,IAAS,OAAGlsB,KAAKyD,UAAU,CAAC1D,EAAE3zC,MACzDN,KAAKsgE,eACLtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,CAGF,CACOvL,oBAAoBvG,GACrB5uD,KAAKy8D,IAGT,MAAMiE,EAAO,gBAAYN,IAAS,OAAGlsB,KAAKyD,UAAUiX,IACpD5uD,KAAKsgE,eACLtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,CACOz2D,UAAUgqC,GAIf,GAHIj0C,KAAKy8D,IAGJxoB,EAGL,GAAIA,EAAEvzC,SAAU,CACd,MAAMggE,EAAU,QAAqBzsB,EAAE3zC,GACvCN,KAAKsgE,eACLtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,KAAO,CACL,MAAMA,EAAU,QAAqBzsB,EAAE3zC,GACvCN,KAAKsgE,eACLtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,CACF,CACO95C,WAAWqtB,GAIhB,GAHIj0C,KAAKy8D,IAGJxoB,EAGL,GAAIA,EAAExzC,OAAQ,CACZ,MAAMigE,EAAU,SAAsBzsB,EAAE3zC,GACxCN,KAAKsgE,eACLtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,KAAO,CACL,MAAMA,EAAU,SAAsBzsB,EAAE3zC,GACxCN,KAAKsgE,eAELtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,CACF,CACO3vD,eAAekjC,GAIpB,GAHIj0C,KAAKy8D,IAGJxoB,GAGDA,EAAExzC,OAAQ,CACZ,MAAMigE,EAAU,aAA0BzsB,EAAE3zC,GAC5CN,KAAKsgE,eACLtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,CACF,CACOtsB,YAAYH,GAIjB,GAHIj0C,KAAKy8D,KAGJxoB,EACH,OAEF,MAAMysB,EAAU,UAAuBxsB,KAAKyD,UAAU,CAAEr3C,GAAI2zC,EAAE3zC,GAAIR,QAASm0C,EAAEnzC,KAAKhB,UAClFE,KAAKsgE,eAELtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,CACOh0D,eAAeunC,GAIpB,GAHIj0C,KAAKy8D,KAGJxoB,EACH,OAEF,MAAMysB,EAAU,aAA0BxsB,KAAKC,MAAMD,KAAKyD,UAAU1D,IAAI3zC,GACxEN,KAAKsgE,eACLtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,CACO1zD,eAAeinC,GAIpB,GAHIj0C,KAAKy8D,KAGJxoB,EACH,OAEF,MAAMysB,EAAU,aAA0BxsB,KAAKC,MAAMD,KAAKyD,UAAU1D,IAAI3zC,GACxEN,KAAKsgE,eACLtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,CACO1wB,cAAciE,GAInB,GAHIj0C,KAAKy8D,KAGJxoB,EACH,OAEF,MAAMysB,EAAU,YAAyBxsB,KAAKC,MAAMD,KAAKyD,UAAU1D,IAAI3zC,GACvEN,KAAKsgE,eACLtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,CACO7wB,cAAcoE,GAInB,GAHIj0C,KAAKy8D,KAGJxoB,EACH,OAEF,MAAMysB,EAAU,YAAyBxsB,KAAKC,MAAMD,KAAKyD,UAAU1D,IAAI3zC,GACvEN,KAAKsgE,eACLtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,CACOvwB,iBAAiB8D,GAItB,GAHIj0C,KAAKy8D,KAGJxoB,EACH,OAEF,MAAMysB,EAAU,oBAAiCzsB,EAAE3zC,GACnDN,KAAKsgE,eAELtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,CACOzgC,eAAegU,GAIpB,GAHIj0C,KAAKy8D,KAGJxoB,EACH,OAEF,MAAMysB,EAAU,kBAA+BzsB,EAAE3zC,GACjDN,KAAKsgE,eAELtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,CACOI,eAAe7sB,GAIpB,GAHIj0C,KAAKy8D,KAGJxoB,EACH,OAEF,MAAMysB,EAAU,OAAoBxsB,KAAKyD,UAAU1D,GACnDj0C,KAAKsgE,eAGLtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,CACOK,oBAAoB9sB,GAIzB,GAHIj0C,KAAKy8D,KAGJxoB,EACH,OAGF,MAAMysB,EACJ,kBAA+BxsB,KAAKyD,UAAU,CAAEr3C,GAAI,QAAS0gE,QAAS/sB,EAAEnzC,KAAKhB,UAC/EE,KAAKsgE,eAGLtgE,KAAK+J,GAAGirD,WAAW0L,EACrB,CACOO,sBACDjhE,KAAKy8D,IAITz8D,KAAK+J,GAAGirD,WADQ,iBAElB,CACOrwC,oBAAoBsvB,GAIzB,GAHIj0C,KAAKy8D,KAGJxoB,EACH,OAEF,IAAIysB,EAAU,UACd,MAAMQ,EAAuB,GAC7BjtB,EAAEjuB,SAAS3V,IACT6wD,EAAW//D,KAAKkP,EAAE/P,GAAG,IAEvBN,KAAKsgE,eACLI,GAAWxsB,KAAKyD,UAAUupB,GAE1BlhE,KAAK+J,GAAGirD,WAAW0L,GACnB1gE,KAAK+J,GAAGyrB,aAAa7xB,MAAMooD,cAC7B,CACO1tC,eAAe41B,GAIpB,GAHIj0C,KAAKy8D,KAGJxoB,EACH,OAEF,MAAMysB,EAAU,aAA0BxsB,KAAKyD,UAAU1D,GAgBzDj0C,KAAKsgE,eAGLtgE,KAAK+J,GAAGirD,WAAW0L,GACnB1gE,KAAK+J,GAAGyrB,aAAa7xB,MAAMooD,cAC7B,CACO5qB,kBACDnhC,KAAKy8D,IAGT,MAAMiE,EAAUpS,EAAAA,GAAAA,WAChBtuD,KAAK+J,GAAGirD,WAAW0L,EACrB,CAEOS,gBAAgBC,EAAoB7K,GACzC,MAAM,GAAN,OAAU6K,GAAU,OAAGhB,IAAS,OACX,kBAAZ7J,EAAuBA,EAAUriB,KAAKyD,UAAU4e,GAE3D,CACO8K,eAAe/gE,EAAYoO,GAChC,MAAMw/C,EAAM,mBAAekS,GAAY9/D,EAAK8/D,GAAY1xD,GACxD1O,KAAK+J,GAAGirD,WAAW9G,EACrB,CACOoT,YAAYhhE,EAAYoO,GAC7B,MAAMw/C,EAAM,mBAAekS,GAAY9/D,EAAK8/D,GAAY1xD,GACxD1O,KAAK+J,GAAGirD,WAAW9G,EACrB,CACOqT,aAAajhE,GAClB,MAAM4tD,EAAM,sBAAkBkS,IAAS,OAAG9/D,GAC1CN,KAAK+J,GAAGirD,WAAW9G,EACrB,E,gBC9TK,MAAMsT,GAEX3hE,YAAYkK,GAA2B,KADhCA,QAAE,EAEP/J,KAAK+J,GAAKA,CACZ,CACO03D,gBAAgBv+D,GAErB,OAAQA,EAAE3C,MACR,KAAK+tD,EAAAA,GAAAA,MACHtuD,KAAK+J,GAAGyrB,aAAarf,eAAe2M,eAAezU,kBAAkBnL,EAAEqzD,SACvE,MACF,KAAKjI,EAAAA,GAAAA,gBACHtuD,KAAK+J,GAAGyrB,aAAa8F,WAAWC,YAAY66B,sBAAsBlzD,EAAEqzD,SACpE,MAOF,KAAKjI,EAAAA,GAAAA,MAIL,KAAKA,EAAAA,GAAAA,QAEHtuD,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cAKzD,CAEO6yD,WAAWx+D,GAEC,kBAANA,EACTlD,KAAK2hE,SAASz+D,GACQ,kBAANA,GAChBlD,KAAKyhE,gBAAgBv+D,EAEzB,CACQy+D,SAASC,GAMf,MAAM7yC,EAAQ6yC,EAASnvD,QAAQ2tD,GAAAA,GACzBlS,EAASn/B,EAAQ,EAAI,CAAC6yC,GAAY,CAACA,EAASC,UAAU,EAAG9yC,GAAQ6yC,EAASC,UAAU9yC,EAAQ,EAAG6yC,EAAS1gE,SACxGZ,EAAK4tD,EAAO,GACZ4T,EAAU9hE,KAAK+J,GAAGyrB,aAAa7xB,MAAMktD,aAC3C,IAAIxgD,EAAIrQ,KAAK+J,GAAGyrB,aAAa7xB,MAAMktD,aAAa3vD,OAChD,OAAQgtD,EAAO,IACb,IAAK,QAEH,MAAM6T,EAAM7tB,KAAKC,MAAM+Z,EAAO,IAC9BluD,KAAK+J,GAAGyrB,aAAarf,eAAe2M,eAAezU,kBAAkB0zD,GACrE,MACF,KAAKzT,EAAAA,GAAAA,eAEH,MAAM0T,EAAS9T,EAAO,GAMtBluD,KAAK+J,GAAGyrB,aAAahqB,wBAAwB2uB,iBAC3Cn6B,KAAK+J,GAAGk4D,eAAeD,IAGzBhiE,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,cACHtuD,KAAK+J,GAAGyrB,aAAahqB,wBAAwBwgD,eAAekC,EAAO,IACnE,MACF,KAAKI,EAAAA,GAAAA,gBACHtuD,KAAK+J,GAAGyrB,aAAa8F,WAAWC,YAAYk7B,gBAAgBn2D,GAC5DN,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,IAAK,cAKL,IAAK,YAGL,IAAK,iBAEH,MACF,IAAK,aACH,MAAMqzD,EAAQhuB,KAAKC,MAAMD,KAAKyD,UAAUuW,EAAO,KAE/CluD,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAes/C,iBAAiBwM,GAEpE,MACF,IAAK,YAEH,MACF,KAAK5T,EAAAA,GAAAA,mBACHtuD,KAAK+J,GAAGyrB,aAAa8F,WAAWC,YAAYo7B,yBAAyBr2D,GACrEN,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,KACHtuD,KAAK+J,GAAGyrB,aAAarf,eAAe2M,eAAegS,OACnD90B,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,KACHtuD,KAAK+J,GAAGyrB,aAAarf,eAAe2M,eAAegyC,OACnD90D,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,YAEHtuD,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,sBACHtuD,KAAK+J,GAAGyrB,aAAa8F,WAAWC,YAAYq7B,sBAAsBt2D,GAClEN,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,WACHtuD,KAAK+J,GAAGyrB,aAAa8F,WAAWC,YAAYs7B,WAAWv2D,GACvDN,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,cACHtuD,KAAK+J,GAAGyrB,aAAa8F,WAAWC,YAAYu7B,cAAcx2D,GAC1DN,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,UACHtuD,KAAK+J,GAAGyrB,aAAa8F,WAAWC,YAAYmB,YAC5C18B,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,iBAMH,MAAM6T,EAAWjuB,KAAKC,MAAM+Z,EAAO,IACnC4M,OAAOC,KAAKoH,GAAUn8C,SAAS6T,IACxB75B,KAAK+J,GAAGyrB,cAGbx1B,KAAK+J,GAAGyrB,aAAahqB,wBAAwB4iD,iBAC3C,YACAv0B,EACAsoC,EAAStoC,GACV,IAEH75B,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,cAEH,MAAM8T,EAAaluB,KAAKC,MAAM+Z,EAAO,IACrC4M,OAAOC,KAAKqH,GAAYp8C,SAAS6T,IAC/B75B,KAAK+J,GAAGyrB,aAAahqB,wBAAwB4iD,iBAC3CF,EAAO,GACPr0B,EACAuoC,EAAWvoC,GACZ,IAEH75B,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,iBACHtuD,KAAK+J,GAAGyrB,aAAahqB,wBAAwB4iD,iBAAiBF,EAAO,GAAIA,EAAO,IAChFluD,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,gBACH,KAAOj+C,KACL,GAAIyxD,EAAQzxD,GAAG/P,KAAOA,EAAI,CACxBwhE,EAAQzxD,GAAG7P,YAAa,EACxB,KACF,CAEFR,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,kBACH,KAAOj+C,KACL,GAAIyxD,EAAQzxD,GAAG/P,KAAOA,EAAI,CACxBwhE,EAAQzxD,GAAG7P,YAAa,EACxB,KACF,CAEFR,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,gBACH,KAAOj+C,KACDyxD,EAAQzxD,GAAG/P,KAAOA,EACpBwhE,EAAQzxD,GAAG7P,YAAa,EACfshE,EAAQzxD,GAAG7P,aACpBshE,EAAQzxD,GAAG7P,YAAa,GAG5BR,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,kBACH,KAAOj+C,KACDyxD,EAAQzxD,GAAG/P,KAAOA,GAAMwhE,EAAQzxD,GAAG7P,aACrCshE,EAAQzxD,GAAG7P,YAAa,GAG5BR,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,OACHtuD,KAAK+J,GAAGyrB,aAAarf,eAAe2M,eAAe6rC,YAAYT,EAAO,IACtEluD,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,eACHtuD,KAAK+J,GAAGyrB,aAAarf,eAAe2M,eAAeyX,4BACnDv6B,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,OACHtuD,KAAK+J,GAAGyrB,aAAahqB,wBAAwBwoC,iBAC3CE,KAAKC,MAAM+Z,EAAO,IAAI5tD,GACtB4tD,EAAO,IAGTluD,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,sBACHtuD,KAAK+J,GAAGyrB,aAAarf,eAAe2M,eAAeyxC,sBAAsBrgB,KAAKC,MAAM7zC,IACpFN,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,0BAIL,KAAKA,EAAAA,GAAAA,YAIL,KAAKA,EAAAA,GAAAA,MAIL,KAAKA,EAAAA,GAAAA,QAEHtuD,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,MACH,KAAOj+C,KACDyxD,EAAQzxD,GAAG/P,KAAOA,GACpBwhE,EAAQzxD,GAAGjG,SAAU,EAEjB03D,EAAQzxD,GAAGhK,eACby7D,EAAQzxD,GAAGlL,SAASmQ,MAAQ,EAC5BwsD,EAAQzxD,GAAGhG,WAAa,IAExBy3D,EAAQzxD,GAAGhG,WAAa,GAEjBy3D,EAAQzxD,GAAGjG,UACpB03D,EAAQzxD,GAAGjG,SAAU,EAEjB03D,EAAQzxD,GAAGhK,cACby7D,EAAQzxD,GAAGhG,WAAa,EAExBy3D,EAAQzxD,GAAGhG,WAAa,GAI9BrK,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,MACH,KAAOj+C,KAELyxD,EAAQzxD,GAAGjG,SAAU,EAIjB03D,EAAQzxD,GAAGhK,gBACby7D,EAAQzxD,GAAGhG,WAAa,GAG5BrK,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,KACHtuD,KAAK+J,GAAGyrB,aAAahqB,wBAAwByjD,OAAO/a,KAAKC,MAAM+Z,EAAO,KACtEluD,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,KACHtuD,KAAK+J,GAAGyrB,aAAahqB,wBAAwByH,KAAKihC,KAAKC,MAAM+Z,EAAO,KACpEluD,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,UACH,KAAOj+C,KACDyxD,EAAQzxD,GAAG/P,KAAOA,GACpBwhE,EAAQzxD,GAAGzD,mBAGf5M,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,UACH,KAAOj+C,KACDyxD,EAAQzxD,GAAG/P,KAAOA,GACpBwhE,EAAQzxD,GAAG9E,mBAGfvL,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,KAGHtuD,KAAK+J,GAAGyrB,aAAarf,eAAe+X,cAAcC,qBAClDnuB,KAAK+J,GAAGyrB,aAAarf,eAAe2M,eAAe6vC,uBAQnD,MAAM0P,EAAQ,IAAIC,IAGZC,EAASruB,KAAKC,MAAM7zC,GAG1Bw6D,OAAOC,KAAKwH,GAAkBv8C,SAAS6T,IACrCwoC,EAAMG,IAAI3oC,EAAK75B,KAAKyiE,yBAAyBF,EAAO1oC,IAAM,IAE5D75B,KAAK+J,GAAGyrB,aAAahqB,wBAAwBuiD,0BAA0BsU,GAEvEriE,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cAGnD,MACF,KAAKy/C,EAAAA,GAAAA,UAEH,MAWMoU,EAAqC,GAErCC,EAbczuB,KAAKC,MAAM+Z,EAAO,IAad0U,iBACxB,GAAID,EACF,IAAK,IAAI1hE,EAAI,EAAGA,EAAI0hE,EAAIzhE,SAAUD,EAAG,CACnC,MAAMkwB,EAAKnxB,KAAKyiE,yBAAyBE,EAAI1hE,IAC7CyhE,EAAqBvhE,KAAKgwB,EAC5B,CAGFnxB,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,WAIL,KAAKA,EAAAA,GAAAA,WAIL,KAAKA,EAAAA,GAAAA,SAIL,KAAKA,EAAAA,GAAAA,YAEHtuD,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,yBACHtuD,KAAK+J,GAAGyrB,aAAahqB,wBAAwB0jD,8BAA8B2T,WAAWviE,IACtFN,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,mCACHtuD,KAAK+J,GAAGyrB,aAAahqB,wBAAwB2jD,wCAC3C0T,WAAWviE,IAEbN,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MAEF,KAAKy/C,EAAAA,GAAAA,cAEH,MAAMwU,EAAmB5uB,KAAKC,MAAM+Z,EAAO,IAC3CluD,KAAK+J,GAAGyrB,aAAahqB,wBAAwB4jD,cAAc0T,GAC3D9iE,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cACnD,MACF,KAAKy/C,EAAAA,GAAAA,UACHtuD,KAAK+J,GAAGyrB,aAAahqB,wBAAwB6jD,UAAUnB,EAAO,IAC9DluD,KAAK+J,GAAGyrB,aAAarf,eAAeC,eAAevH,cAMzD,CAEOk0D,wBAAwBR,GAC7B,IAAIS,EAAgB15D,OAAOC,iBACvB05D,EAAgB35D,OAAOC,iBACvB25D,EAAgB55D,OAAO65D,iBACvBC,EAAgB95D,OAAO65D,iBAkB3B,OAhBArI,OAAOC,KAAKwH,GAAkBv8C,SAAS6T,IACrC,IAAK,IAAI54B,EAAI,EAAGA,EAAIshE,EAAO1oC,KAAQ54B,EAC7B+hE,EAAgBT,EAAO1oC,GAAK54B,GAAGoiE,OACjCL,EAAgBT,EAAO1oC,GAAK54B,GAAGoiE,MAE7BJ,EAAgBV,EAAO1oC,GAAK54B,GAAGqiE,OACjCL,EAAgBV,EAAO1oC,GAAK54B,GAAGqiE,MAE7BJ,EAAgBX,EAAO1oC,GAAK54B,GAAGoiE,OACjCH,EAAgBX,EAAO1oC,GAAK54B,GAAGoiE,MAE7BD,EAAgBb,EAAO1oC,GAAK54B,GAAGqiE,OACjCF,EAAgBb,EAAO1oC,GAAK54B,GAAGqiE,KAEnC,IAEK,CAACN,EAAeC,EAAeC,EAAeE,EACvD,CACQX,yBAAyBlsD,GAE/B,MAAM+3B,EAAQtuC,KAAK+J,GAAGk4D,eAAgB1rD,EAAMhW,MAGtCgjE,EAAO,IAAIljE,EAAWkW,EAAMjW,GAAI8L,EAAAA,GAAMkiC,IAAQ,GAAO,EAAO/3B,EAAM7V,UAwBxE,OAvBA6iE,EAAKxiE,SACHwV,EAAM3V,MAAM4iE,KAAKC,IACfC,EAAAA,EAAAA,IACED,EAAOvjE,GACPujE,EAAOtjE,GACPsjE,EAAOE,KACPF,EAAOG,IACPH,EAAOI,IACPJ,EAAOJ,KACPI,EAAOH,KACPG,EAAOK,cAIMnhE,IAAf4T,EAAMzV,OAGRyiE,EAAKziE,KAAOyV,EAAMzV,WAEC6B,IAAjB4T,EAAM1V,SACR0iE,EAAK1iE,OAAS0V,EAAM1V,QAGf0iE,CACT,ECtcK,MAAMQ,GAIXlkE,YAAY21B,GAA6B,KAHlCA,kBAAY,OACZwuC,+BAAyB,OACzBh6D,6BAAuB,EAE5BhK,KAAKw1B,aAAeA,EACpBx1B,KAAKgkE,0BAA4B,IAAIxC,GAA0BxhE,MAC/DA,KAAKgK,wBAA0B,IAAIq2D,GAAwBrgE,KAC7D,CAEOiiE,eAAeD,GAUpB,OATIA,IAAW3nC,EAAAA,GAAAA,aACb2nC,EAAS3nC,EAAAA,GAAAA,0BACA2nC,IAAW3nC,EAAAA,GAAAA,QACpB2nC,EAAS3nC,EAAAA,GAAAA,cACA2nC,IAAW3nC,EAAAA,GAAAA,cACpB2nC,EAAS3nC,EAAAA,GAAAA,QACA2nC,IAAW3nC,EAAAA,GAAAA,mBACpB2nC,EAAS3nC,EAAAA,GAAAA,wBAEJ2nC,CACT,CACOhN,WAAWl0D,GAEZd,KAAKw1B,aAAa3xB,gBAAgBC,IAAIC,aAIpCjD,EAAKkmB,MAAM,KAAK,GAMhBlmB,EAAKkmB,MAAM,KAAK,GAMhBlmB,EAAKkmB,MAAM,KAAK,IAMtBhnB,KAAKw1B,aAAa3xB,gBAAgBC,IAAIkI,MAAMyW,UAAUuyC,WAAWA,WAAWl0D,EAC9E,ECjDK,MAAMmjE,GAEXpkE,YAAYyE,GAAkB,KADvBA,UAAI,EAETtE,KAAKsE,KAAOA,CACd,CACOkL,WAAW9L,GAChB,IAAI1D,KAAKsE,KAAKX,MAAMgP,UAAW3S,KAAKsE,KAAKX,MAAMgP,QAAQpN,QAAvD,CAGA,GAAIvF,KAAKsE,KAAKi7B,WAKZ,OAJAv/B,KAAKsE,KAAK4/D,MAAQ,EAClBlkE,KAAKsE,KAAK6/D,OAAS,EACnBnkE,KAAKsE,KAAKiG,EAAI,OACdvK,KAAKsE,KAAKswD,UAAW,GAoBvB,GAfA50D,KAAKsE,KAAKpB,EAAE9B,EAAuB,GAAnBsC,EAAIggC,OAAOpgC,MACvBtD,KAAKsE,KAAKqzD,aACR33D,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwBiS,EAAEpc,EAAwB,GAApBqC,EAAIggC,OAAOngC,OAC9EvD,KAAKsE,KAAKpB,EAAE7B,EAAIqC,EAAIggC,OAAOngC,OAAS,GAEpCvD,KAAKsE,KAAKpB,EAAE7B,EAAK,GAGnBrB,KAAKsE,KAAKpB,EAAE7B,EAAIqC,EAAIggC,OAAOngC,OAAS,GAGtCG,EAAImV,UAAY,EAChBnV,EAAIM,UAAY,kBAChBN,EAAI2c,YAAc+jD,EAAAA,GAAAA,MAEd,EAAIpkE,KAAKsE,KAAK4/D,OAASlkE,KAAKsE,KAAK4/D,MAAQ,EAAG,CAC9C,MAAMlqB,EAAMh6C,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuR,gBAAgBC,gBACtE3W,KAAKsE,KAAKiG,GAEZ,GAAI,EAAIvK,KAAKsE,KAAKiG,EAAG,CACnB7G,EAAIO,YACJP,EAAIe,IAAIzE,KAAKsE,KAAKpB,EAAE9B,EAAGpB,KAAKsE,KAAKpB,EAAE7B,EAAG24C,EAAMh6C,KAAKsE,KAAK4M,OAAQ,EAAG,UACjExN,EAAIS,YACJT,EAAIU,OACJV,EAAI8c,SAEJ,MAAM6jD,EAAUrqB,EAAMh6C,KAAKsE,KAAKggE,UAChC5gE,EAAIwhD,UACFllD,KAAKsE,KAAKigE,SACVvkE,KAAKsE,KAAKpB,EAAE9B,EAAc,GAAVijE,EAChBrkE,KAAKsE,KAAKpB,EAAE7B,EAAc,GAAVgjE,EAChBA,EACAA,GAEFrkE,KAAKsE,KAAK8yD,QAAS,CACrB,MACEp3D,KAAKsE,KAAK8yD,QAAS,EAGrBp3D,KAAKsE,KAAKiG,GAAK,IACjB,MAAO,GAAI,EAAIvK,KAAKsE,KAAK6/D,QAAUnkE,KAAKsE,KAAK6/D,OAAS,EAAG,CACvD,MAAMnqB,EAAMh6C,KAAKsE,KAAKX,MAAMC,mBAAmBuB,SAASuR,gBAAgB8tD,cACtExkE,KAAKsE,KAAK6/D,QAGNM,EAAOzkE,KAAKsE,KAAK4M,OAAS8oC,EAAMh6C,KAAKsE,KAAK4M,OAChD,GAAI,EAAIuzD,EAAM,CACZ,GAAIzkE,KAAKsE,KAAK8yD,OAAQ,CAGpB1zD,EAAIO,YACJP,EAAIe,IAAIzE,KAAKsE,KAAKpB,EAAE9B,EAAGpB,KAAKsE,KAAKpB,EAAE7B,EAAGojE,EAAM,EAAG,UAC/C/gE,EAAIS,YACJT,EAAIU,OACJV,EAAI8c,SAEJ,MAAM6jD,EAAUrkE,KAAKsE,KAAKggE,UAAYtqB,EAAMh6C,KAAKsE,KAAKggE,UACtD5gE,EAAIwhD,UACFllD,KAAKsE,KAAKigE,SACVvkE,KAAKsE,KAAKpB,EAAE9B,EAAc,GAAVijE,EAChBrkE,KAAKsE,KAAKpB,EAAE7B,EAAc,GAAVgjE,EAChBA,EACAA,GAEFrkE,KAAKsE,KAAKiG,GAAK,GACXyvC,EAAM,IAERh6C,KAAKsE,KAAKogE,WAEd,CACI,GAAM1kE,KAAKsE,KAAK6/D,SAClBnkE,KAAKsE,KAAK8yD,QAAS,EACnBp3D,KAAKsE,KAAKqgE,uBAAwB,EAEtC,CACF,CArFA,CAsFF,EC7FK,MAAMzvD,GAEXrV,YAAYyE,GAAkB,KADvBA,UAAI,EAETtE,KAAKsE,KAAOA,CACd,CACOsgE,aACL,GAAI5kE,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAamzB,WAAY,CACtF,QAAgC9+B,IAA5B3C,KAAKsE,KAAKX,MAAMmb,QAClB9e,KAAKsE,KAAK4/D,OAAS,SACd,CAEL,GACElkE,KAAKsE,KAAKX,MAAMmb,QAAQve,OAAS6L,EAAAA,GAAAA,QACjCpM,KAAKsE,KAAKX,MAAMmb,QAAQve,OAAS6L,EAAAA,GAAAA,WACjCpM,KAAKsE,KAAKX,MAAMmb,QAAQve,OAAS6L,EAAAA,GAAAA,MAIjC,YADApM,KAAKsE,KAAKswD,UAAW,GAGvB,GAAI50D,KAAKsE,KAAKX,MAAMmb,QAAQve,OAAS6L,EAAAA,GAAAA,cAAqB,CAExD,GADepM,KAAKsE,KAAKX,MAAMmb,QACpBkrB,eAGT,YAFAhqC,KAAKsE,KAAKswD,UAAW,EAIzB,CAEA50D,KAAKsE,KAAKswD,UAAW,EACrB50D,KAAKsE,KAAK4/D,MAAQ,GACpB,CACIlkE,KAAKsE,KAAKqgE,sBACZ3kE,KAAKsE,KAAK6/D,QAAU,MAEpBnkE,KAAKsE,KAAK6/D,OAAS,CAEvB,MACMnkE,KAAKsE,KAAKi7B,WACZv/B,KAAKsE,KAAK4/D,OAAS,KAEnBlkE,KAAKsE,KAAK4/D,MAAQ,IAGlBlkE,KAAKsE,KAAKX,MAAMmb,SACd9e,KAAKsE,KAAKX,MAAMC,mBAAmB4H,wBAAwB8C,aAAamxB,OAC1Ez/B,KAAKsE,KAAK6/D,QAAU,MAG1B,EC1CK,MAAMU,GAwBXhlE,YAAY8D,GAAe,KAvBpBwB,cAAQ,OACRsQ,WAAK,OACL9R,WAAK,OACLT,OAAC,OACD0xD,UAAW,EAAM,KACjB1jD,OAAS,GAAG,KACZ3G,EAAI,EAAI,KACR25D,MAAQ,EAAI,KACZC,OAAS,EAAI,KACbW,YAAa,EAAM,KACnBC,YAAa,EAAM,KACnBtlC,MAAO,EAAM,KACb23B,QAAS,EAAM,KACf4N,OAAQ,EAAM,KACdC,UAAW,EAAM,KACjBC,qBAAuB,IAAI,KAC3BX,cAAQ,OACRD,UAAY,GAAG,KACf/kC,YAAa,EAAM,KACnBolC,uBAAwB,EAAM,KAC9BQ,MAAQ,EAAE,KACVxN,cAAwB,EAAK,KAC5ByN,aAAc,EAEpBplE,KAAK2D,MAAQA,EACb3D,KAAKolE,aAAc,EACnBplE,KAAKmF,SAAW,IAAI8+D,GAASjkE,MAC7BA,KAAKyV,MAAQ,IAAIP,GAAMlV,MACvBA,KAAKkD,EAAI,IAAIb,EAAAA,GAAS,EAAG,GACzBrC,KAAKukE,SAAW,IAAI7jB,MAIpB1gD,KAAKukE,SAASllB,IAAG,UAAMr/C,KAAK2D,MAAMC,mBAAmBC,gBAAgBC,IAAI+qC,OAAOwW,OAAOC,SAAQ,sEAGjG,CACOsf,aACL5kE,KAAKyV,MAAMmvD,YACb,CACOnhE,OAAOC,GACZ1D,KAAK4kE,aACL5kE,KAAKqlE,WAEDrlE,KAAK40D,UACP50D,KAAKmF,SAASqK,WAAW9L,EAE7B,CACO2hE,WACArlE,KAAK40D,YAIRrkD,EAAAA,EAAAA,IACE,CAACvQ,KAAKkD,EAAE9B,EAAGpB,KAAKkD,EAAE7B,EAAGrB,KAAKkD,EAAE5B,GAC5B,CACEtB,KAAK2D,MAAMC,mBAAmB4H,wBAAwBiS,EAAErc,EACxDpB,KAAK2D,MAAMC,mBAAmB4H,wBAAwBiS,EAAEpc,EACxD,IAEArB,KAAKklE,sBAETllE,KAAKkR,OAAS,GACdlR,KAAKskE,UAAY,GACjBtkE,KAAKglE,OAAQ,EACThlE,KAAKilE,WAAajlE,KAAKglE,QACzBhlE,KAAKilE,SAAWjlE,KAAKglE,MACrBhlE,KAAKuK,EAAI,MAGXvK,KAAKkR,OAAS,GACdlR,KAAKskE,UAAY,GACjBtkE,KAAKglE,OAAQ,EACThlE,KAAKilE,WAAajlE,KAAKglE,QACzBhlE,KAAKilE,SAAWjlE,KAAKglE,MACrBhlE,KAAKuK,EAAI,IAGf,CAgBOsqD,gCAAgC0N,GACrC,GAAIviE,KAAK2D,MAAMgP,SAAW3S,KAAK2D,MAAMgP,QAAQpN,QAC3C,OAEF,IAAItE,EAAIjB,KAAK2D,MAAMC,mBAAmBD,MAAMktD,aAAa3vD,OACzD,MAAMokE,EAA8B,GACpC,KAAOrkE,KAAK,CACV,MAAMoP,EAAIrQ,KAAK2D,MAAMC,mBAAmBD,MAAMktD,aAAa5vD,GAG3D,GAAIoP,EAAE7P,YAAc6P,EAAEzK,cAAgByK,EAAE5J,gBAAiB,CACvD,GAAI4J,EAAElJ,oBACJ,SAEF,GAAIkJ,EAAE9P,OAAS6L,EAAAA,GAAAA,gBAAuB,CACpC,MAAM9B,EAAiB+F,EACvB,GAAI/F,EAAe+I,WACjB,IAAInG,EAAAA,EAAAA,IAAY5C,EAAe+I,WAAWC,GAAItT,KAAKkD,GAAK,GAAI,CAC1DoH,EAAeG,mBAEf,MAAM2R,EAAO,GACb,IAAK,IAAInb,EAAI,EAAGA,EAAIshE,EAAOrhE,SAAUD,EAC/BshE,EAAOthE,GAAGX,KAAOgK,EAAehK,IAClC8b,EAAKjb,KAAKohE,EAAOthE,IAGrBshE,EAASnmD,CAEX,MAEEkpD,EAAWnkE,KAAKkP,QAIlBi1D,EAAWnkE,KAAKkP,EAEpB,MACEi1D,EAAWnkE,KAAKkP,EAGpB,CAEF,CACA,IAAK,IAAIpP,EAAI,EAAGA,EAAIqkE,EAAWpkE,SAAUD,EACvCqkE,EAAWrkE,GAAGwP,QAAO,GAEnB8xD,EAAOrhE,OAAS,GAClBlB,KAAK2D,MAAMC,mBAAmBmG,GAAGC,wBAAwB2a,oBAAoB49C,EAGjF,CACOmC,YACL,GAAI1kE,KAAK2D,MAAMgP,SAAW3S,KAAK2D,MAAMgP,QAAQpN,QAC3C,OAEF,IACGvF,KAAKglE,QACLhlE,KAAK2D,MAAMmb,UACX9e,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAamxB,KAEpE,OAGF,GAAQz/B,KAAK2D,MAAMmb,QAAQve,OACpB6L,EAAAA,GAAAA,gBAAL,CAGE,MAAM7B,EAAIvK,KAAK2D,MAAMmb,QACrB,GACEvU,EAAE8I,YACF9I,EAAE8I,WAAWR,cACX7S,KAAK2D,MAAMC,mBAAmB4H,wBAAwBiS,EAAErc,EACxDpB,KAAK2D,MAAMC,mBAAmB4H,wBAAwBiS,EAAEpc,GAkB1D,OAfI6L,EAAAA,EAAAA,IAAYlN,KAAKkD,EAAGqH,EAAE8I,WAAWC,IAAM,IAEzC/I,EAAEE,mBAEJzK,KAAK2D,MAAMmb,aAAUnc,EAIrB3C,KAAKkkE,OAAS,KACdlkE,KAAKmkE,OAAS,IAEdnkE,KAAK2D,MAAMC,mBAAmB4H,wBAAwB8C,aAAamzB,YAAa,OAChFzhC,KAAK2kE,uBAAwB,GAK3B3kE,KAAKolE,cAEPplE,KAAK2D,MAAMmb,aAAUnc,EACrB3C,KAAKu/B,YAAa,EAKf,MAEDv/B,KAAKolE,cAEPplE,KAAK2D,MAAMmb,aAAUnc,EACrB3C,KAAKu/B,YAAa,GAOxB,IAAI50B,EAAI3K,KAAK2D,MAAMktD,aAAa3vD,OAChC,GAAU,IAANyJ,EAGJ,KAAOA,KACD3K,KAAK2D,MAAMktD,aAAalmD,KAAgD,IAA1C3K,KAAK2D,MAAMktD,aAAalmD,GAAGnK,YACvDR,KAAKolE,cAEPplE,KAAK2D,MAAMmb,aAAUnc,EAErB3C,KAAKu/B,YAAa,EAM1B,EC/NK,MAAMgmC,GAUX1lE,YAAY+hC,GAAiC,KATtCA,oBAAc,OACdr3B,OAAC,OACD+K,WAAK,OACLxI,uBAAiB,OACjBmC,YAAM,OACNC,YAAM,OACNkG,SAAG,OACHhL,SAAU,EAAM,KAChBo7D,sBAAyC7iE,EAE9C3C,KAAK4hC,eAAiBA,EACtB5hC,KAAKuK,EAAI,EACTvK,KAAKsV,MAAQ,EACbtV,KAAK8M,kBAAoB,EACzB9M,KAAKiP,OAAS,EACdjP,KAAKkP,OAAS,EACdlP,KAAKoV,IAAM,CACb,CACOysB,uBAAuB3+B,GAE1BlD,KAAKwlE,iBADHtiE,QAGsBP,CAE5B,CAEOc,OAAOC,GACZ,GAAI1D,KAAKwlE,iBAAkB,CACzB,MAAMj5C,EAAOvsB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAM0lB,cAAcC,mBAAmBloB,EACxForB,EAAOxsB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAM0lB,cAAcC,mBAAmBjoB,EAC9FrB,KAAKsV,OAAS,KACdtV,KAAK4hC,eAAez8B,SAASmR,KAAKC,MAAMkvD,SAASC,SAAShiE,EAAK1D,KAAKwlE,iBAAiBpkE,EAAImrB,EAAMvsB,KAAKwlE,iBAAiBnkE,EAAImrB,EAAMxsB,KAAK4hC,eAAe9X,kBAAmB9pB,KAAK4hC,eAAez8B,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,QACxOtV,KAAK2lE,eAAejiE,EAAK6oB,EAAMC,EACjC,MACExsB,KAAKsV,MAAQ,CAEjB,CACOqwD,eAAejiE,EAA+B6oB,EAAcC,GAEjE,GAAIxsB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,SAAW3S,KAAKwlE,iBAAkB,CACpF,GAAIxlE,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,cAInE,OACK,GACLpM,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,eAKjE,OACK,GACLpM,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,OACjEpM,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,UACjE,CACA,MAAM+S,EAAKnf,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAE3D,GAAIwM,EAAG3C,OAAO,IAAM2C,EAAG3C,OAAO,GAAGgB,OAAOjd,OAAS6L,EAAAA,GAAAA,iBAAwB,CACvE,MAAMw5D,EAAKzmD,EAAG3C,OAAO,GAAGgB,OAClBxc,EAAKhB,KAAK6lE,yBAAyBD,GAUzC,YATA5lE,KAAK4hC,eAAez8B,SAASmR,KAAKC,MAAMwK,KAAK+kD,mBAC3CpiE,EACAkiE,EAAGviE,eAAe1C,YAClBK,EACA,CAACurB,EAAMC,IACP,GACA,EACA,GAIJ,CAAO,GACJrN,EAAG5N,MAAM,IAAM4N,EAAG5N,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,cACrC+S,EAAG5N,MAAM,GAAGhR,OAAS6L,EAAAA,GAAAA,aACrB,CACA,MAAMw5D,EAAKzmD,EAAG5N,MAAM,GACdvQ,EAAKhB,KAAK+lE,gBAAgBH,GAG1Bx0C,EAAepxB,KAAKoyB,cAAcpxB,EAAI,CAACurB,EAAMC,IAC7CsD,EAAS9vB,KAAKqyB,cAAcuzC,EAAGj5D,UAAW,IAC1C2kB,EAAoBtxB,KAAKsyB,oBAAoBlB,EAActB,GAGjE,YAFA9vB,KAAKiwB,WAAWvsB,EAAKkiE,EAAGj5D,UAAWykB,EAAcE,EAAmBs0C,EAGtE,CAEF,KAAO,IACL5lE,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,cACjE,CACA,MAAMw5D,EAAK5lE,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QACrD3R,EAAKhB,KAAKgmE,wBAAwBJ,EAAI,CAACr5C,EAAMC,IAUnD,YARAxsB,KAAK4hC,eAAez8B,SAASmR,KAAKC,MAAM2K,KAAK+kD,kBAC3CviE,EACAkiE,EAAGviE,eAAe1C,YAClBK,GACA,GACA,EACA,GAGJ,CAAO,GACLhB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,gBACjE,CACA,MAAMw5D,EAAK5lE,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAClDgP,QACH,GAAIizD,EAAGvyD,YACDuyD,EAAGxzB,qBAAsB,CAC3B,MAAM8zB,EAAM,IAAI7jE,EAAAA,GAASujE,EAAGvyD,WAAWo+B,SAASrwC,EAAGpB,KAAKwlE,iBAAiBnkE,GACnE8kE,EAAMnmE,KAAKwlE,iBACjBxlE,KAAK4hC,eAAez8B,SAASmR,KAAKC,MAAM7R,KAAKutC,iBAC3CvuC,EACAkiE,EAAGviE,eACHuiE,EAAGn2B,UACHy2B,EACAC,EACAP,EAAGzgE,SAASoF,EACZq7D,EAAGvyD,WAAWs+B,WACdi0B,EAAGvyD,WAAWjJ,QACdw7D,EAAG7/D,gBAEP,CAEF,MACF,EACF,CACF,CAEQ8/D,yBAAyB7mD,GAC/B,MAAMhe,EAAKge,EAAGrS,UACRuY,EAAkB,GACxB,GAAIllB,KAAKwlE,iBACP,IAAK,IAAIvkE,EAAI,EAAGA,EAAID,EAAGE,SAAUD,GAC3BiM,EAAAA,EAAAA,IAAYlM,EAAGC,GAAIjB,KAAKwlE,kBAAoBxlE,KAAK4hC,eAAe9X,kBAClE5E,EAAI/jB,KAAKnB,KAAKwlE,kBAEdtgD,EAAI/jB,KAAKH,EAAGC,IAIlB,OAAOikB,CACT,CACQ8gD,wBAAwBhnD,EAA0Bnd,GACxD,MAAMb,EAAKge,EAAGrS,UACRuY,EAAkB,GACxB,GAAIllB,KAAKwlE,iBACP,IAAK,IAAIvkE,EAAI,EAAGA,EAAID,EAAGE,SAAUD,GAC3BiM,EAAAA,EAAAA,IAAYlM,EAAGC,GAAIjB,KAAKwlE,kBAAoBxlE,KAAK4hC,eAAe9X,kBAClE5E,EAAI/jB,KAAK,IAAIkB,EAAAA,GAASrC,KAAKwlE,iBAAiBpkE,EAAIS,EAAO,GAAI7B,KAAKwlE,iBAAiBnkE,EAAIQ,EAAO,GAAI,IAEhGqjB,EAAI/jB,KAAK,IAAIkB,EAAAA,GAASrB,EAAGC,GAAGG,EAAIS,EAAO,GAAIb,EAAGC,GAAGI,EAAIQ,EAAO,GAAI,IAItE,OAAOqjB,CACT,CACQ6gD,gBAAgB/mD,GACtB,MAAMhe,EAAKge,EAAGrS,UACRuY,EAAkB,GACxB,GAAIllB,KAAKwlE,iBACP,IAAK,IAAIvkE,EAAI,EAAGA,EAAID,EAAGE,SAAUD,GAC3BiM,EAAAA,EAAAA,IAAYlM,EAAGC,GAAIjB,KAAKwlE,kBAAoBxlE,KAAK4hC,eAAe9X,kBAClE5E,EAAI/jB,KAAKnB,KAAKwlE,kBAEdtgD,EAAI/jB,KAAKH,EAAGC,IAIlB,OAAOikB,CACT,CACQkN,cAAcpxB,EAAgBa,GACpC,MAAMyxB,EAAoB,GAC1B,IAAK,MAAM7pB,KAAKzI,EAGdsyB,EAAQnyB,KAAKsI,EAAErI,EAAIS,EAAO,GAAI4H,EAAEpI,EAAIQ,EAAO,IAE7C,OAAOyxB,CACT,CACQjB,cAAclW,GAAyB,IAARE,EAAC,uDAAG,EACzC,MAAMyT,EAAmB,GACzB,IAAK,IAAI7uB,EAAI,EAAGA,EAAIkb,EAAIjb,SAAUD,EAChC6uB,EAAO3uB,KAAKkb,GAEd,OAAOyT,CACT,CACQwC,oBAAoBqc,EAAgBtd,GAC1C,MAAMlV,EAAgB,IAAIwyB,GAE1B,IAAIrd,EAA8B,GAClC,IAAK,IAAIrwB,EAAI,EAAGA,EAAIkb,EAAIjb,OAAS,EAAGD,GAAK,EACvCqwB,EAAoBA,EAAkBkC,OACpCoY,GAAO5b,iBACL7T,EAAIlb,GACJkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRkb,EAAIlb,EAAI,GACRowB,EAAYpwB,KAIlB,OAAOqwB,CACT,CACQrB,WACNvsB,EACA0iE,EACAp7B,EACAna,EACAvsB,GAEA,MAAM6X,EAAM6uB,EACNjb,EAAKc,EACLxkB,EAAI8P,EAAIjb,OAGR4rC,EAAQs5B,EAGRr5B,EAAS/sC,KAAK4hC,eAAez8B,SAASmR,KAAKC,MAAMwa,MACvDgc,EAAOC,oBACLtpC,EACAY,EAAKjB,eAAe1C,YACpBwb,EAAI,GACJA,EAAI,GACJ4T,EAAG,GACHA,EAAG,GACH5T,EAAI,GACJA,EAAI,IACJ,EACA2wB,GACA,EACA,GACA9sC,KAAK4hC,eAAez8B,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,QAClE,EACAhR,EAAKjB,eAAe0T,MAAMC,cAC1B,GAEF+1B,EAAOC,oBACLtpC,EACAY,EAAKjB,eAAe1C,YACpBwb,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,GACR0jB,EAAG,EAAI1jB,EAAI,IACX0jB,EAAG,EAAI1jB,EAAI,GACX8P,EAAI9P,EAAI,GACR8P,EAAI9P,EAAI,IACR,EACAygC,GACA,EACA,GACA9sC,KAAK4hC,eAAez8B,SAASuR,gBAAgBC,gBAAgB3W,KAAKsV,QAClE,EACAhR,EAAKjB,eAAe0T,MAAMC,cAC1B,GAEF+1B,EAAOE,oBACLvpC,EACAY,EAAKjB,eAAe1C,YACpB,IAAI0B,EAAAA,GAAS8Z,EAAI,GAAIA,EAAI,IACzB,IAAI9Z,EAAAA,GAAS0tB,EAAG,GAAIA,EAAG,IACvB5T,EAAI,GACJA,EAAI,GACJ7X,EAAKqoC,WACLroC,EAAK+D,eACL/D,EAAKsB,aACLtB,EAAK0C,YACL1C,EAAK4C,gBACL,EACA5C,EAAKyB,gBACLzB,EAAKjB,eAAe0T,MAAMC,cAExB1S,EAAK/D,OAAS6L,EAAAA,GAAAA,cAChB2gC,EAAOE,oBACLvpC,EACAY,EAAKjB,eAAe1C,YACpB,IAAI0B,EAAAA,GAAS8Z,EAAI,GAAIA,EAAI,IACzB,IAAI9Z,EAAAA,GAAS0tB,EAAG,GAAIA,EAAG,IACvB5T,EAAI,GACJA,EAAI,GACJ7X,EAAKqoC,WACLroC,EAAK+D,gBACL,EACA/D,EAAK0C,YACL1C,EAAK4C,gBACL,EACA5C,EAAKyB,gBACLzB,EAAKjB,eAAe0T,MAAMC,aAGhC,CAYOqvD,4BACL,GAAKrmE,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,SACjD3S,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,MAAa,CAChF,MAAMwe,EAAQ5qB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAC1DiY,EAAMpO,OAAO,IACfoO,EAAMpO,OAAO,GAAGgB,OAAO4D,cAE3B,CACF,CACOklD,wBACL,GACEtmE,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,SAChD3S,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,gBACjE,CACA,MAAM6sC,EAAMj5C,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAC5D,GAAIsmC,GAAOA,EAAI5lC,YAAcrT,KAAK4hC,eAAe2kC,eAAef,iBAAkB,CAChF,MAAMj5C,EAAO0sB,EAAI5lC,WAAWC,GAAGlS,EAAIpB,KAAK4hC,eAAe2kC,eAAef,iBAAiBpkE,EACjForB,EAAOysB,EAAI5lC,WAAWC,GAAGjS,EAAIrB,KAAK4hC,eAAe2kC,eAAef,iBAAiBnkE,EACvF43C,EAAItsB,aAAeJ,EACnB0sB,EAAIrsB,cAAgBJ,CACtB,CACF,CACF,EC/UK,MAAMg6C,GAEX3mE,YAAY+hC,GAAiC,KADtCA,oBAAc,EAEnB5hC,KAAK4hC,eAAiBA,CACxB,CACOC,uBAAuB3+B,GAC5BlD,KAAK4hC,eAAe2kC,eAAe1kC,uBAAuB3+B,EAC5D,CACOujE,mBAAmBvjE,GACxB,IAAKlD,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAAW,OAAO,EAEvE,GAAI3S,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAAQrI,eAC1D,OAAO,EAGT,IACE,IAAIrJ,EAAI,EACRA,EAAIjB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMqhC,oBAAoB9jC,SACtED,EACF,CACA,MAAMylE,EAAa1mE,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMqhC,oBACjE/jC,GACA6I,sBAAsB5G,GACxB,GAAIwjE,GAAcA,IAAexjE,EAE/B,OADAlD,KAAK6hC,uBAAuB6kC,IACrB,CAEX,CACA,OAAO,CACT,CACOC,sBAAsBzjE,GAC3B,IAAKlD,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAAW,OAAO,EAEvE,GAAI3S,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAAQrI,eAC1D,OAAO,EAGT,IACE,IAAIrJ,EAAI,EACRA,EAAIjB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMiuD,sBAAsB1wD,SACxED,EACF,CACA,MAAMylE,EAAa1mE,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMiuD,sBACjE3wD,GACA6I,sBAAsB5G,GACxB,GAAIwjE,GAAcA,IAAexjE,EAE/B,OADAlD,KAAK6hC,uBAAuB6kC,IACrB,CAEX,CACA,OAAO,CACT,CACOE,mBAAmB73C,GACxB,QAAK/uB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,SACjD3S,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,MAIvE,CACOy6D,uBAAuB93C,GAC5B,OACE/uB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,GAAOxuB,OACrE6L,EAAAA,GAAAA,cAIApM,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,GAAOxuB,OACrE6L,EAAAA,GAAAA,UAKJ,CA6EO06D,iBAAiB/3C,GACtB,MAAMrtB,EAAM1B,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QACtDo0D,EAAW/mE,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,GAE/E,SAAIrtB,GAAOqlE,IAENrlE,EAAInB,OAAS6L,EAAAA,GAAAA,OAAe1K,EAAInB,OAAS6L,EAAAA,GAAAA,aACzC26D,EAASxmE,OAAS6L,EAAAA,GAAAA,OAAe26D,EAASxmE,OAAS6L,EAAAA,GAAAA,YAGhD1K,EAAI6P,MAAMrQ,OAAS,GAAK6lE,EAASx1D,MAAMrQ,OAAS,GAC9CQ,EAAI6P,MAAM,KAAOw1D,EAASx1D,MAAM,GAa5C,CACOy1D,4BAA4Bj4C,GACjC,MAAMk4C,EAAcjnE,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QACpE,OAAKs0D,IAIDA,EAAY1mE,OAAS6L,EAAAA,GAAAA,gBAAwB66D,EAAY1mE,OAAS6L,EAAAA,GAAAA,gBAElEpM,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,IAC9D/uB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,KAAWk4C,GAGvEjnE,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,GAAOxuB,OACnE6L,EAAAA,GAAAA,gBACFpM,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,GAAOxuB,OACnE6L,EAAAA,GAAAA,cAOV,CACO86D,qCAAqCn4C,GAC1C,GAAI/uB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,UAEhD3S,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,OACjEpM,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,WACjE,CACA,MAAM3C,EAAIzJ,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMgP,QAC1D,GAAIlJ,EAAE8H,MAAM,GAAI,CACd,MAAMvQ,EAAKyI,EAAE8H,MAAM,GAAG5E,UACtB,IAAK,IAAI1L,EAAI,EAAGA,EAAID,EAAGE,SAAUD,EAC/B,GACEjB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,IAC9D/uB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,GAAOnsB,MAAQ5B,EAAGC,GAEhF,OAAO,CAGb,MAAO,GAAIwI,EAAE+S,OAAO,GAAI,CACtB,MAAMxb,EAAKyI,EAAE+S,OAAO,GAAGgB,OAAO7Q,UAC9B,IAAK,IAAI1L,EAAI,EAAGA,EAAID,EAAGE,SAAUD,EAC/B,GACEjB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,IAC9D/uB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,GAAOnsB,MAAQ5B,EAAGC,GAEhF,OAAO,CAGb,CACF,CAEF,OAAO,CACT,CAcOkmE,8BAA8BlmE,GAGnC,GAAIjB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMguD,cAAc1wD,GAAGV,OAAS6L,EAAAA,GAAAA,UAAiB,CAC7F,MAAMwe,EAAQ5qB,KAAK4hC,eAAez8B,SAASqwB,aAAa7xB,MAAMguD,cAAc1wD,GAC5E,GAAI2pB,EAAMpO,OAAO,IAAMoO,EAAMpO,OAAO,GAAGgB,OAAOjd,OAAS6L,EAAAA,GAAAA,iBACrD,OAAO,CAEX,CAMA,OAAO,CACT,EC1PK,MAAMg7D,GAMXvnE,YAAYsF,GAAqB,KAL1BA,cAAQ,OACRohE,oBAAc,OACdz8C,kBAAoB,GAAG,KACvBu9C,WAAa,EAAE,KACdC,uBAAiB,EAEvBtnE,KAAKmF,SAAWA,EAChBnF,KAAKsnE,kBAAoB,IAAId,GAAkBxmE,MAC/CA,KAAKumE,eAAiB,IAAIhB,GAAqBvlE,KACjD,CACO6hC,uBAAuB3+B,GAC5BlD,KAAKumE,eAAe1kC,uBAAuB3+B,EAC7C,CACOO,OAAOC,GACZ1D,KAAKumE,eAAe9iE,OAAOC,EAC7B,CACO0+B,oBAAoBl/B,EAAaqkE,GACtC,OAAIvnE,KAAKmF,SAASqwB,aAAagU,kBAAoBvzB,EAAAA,GAAAA,aAG9C/S,IAAMlD,KAAKmF,SAASqwB,aAAahqB,wBAAwB8C,aAAa6wB,uBAGvEn/B,KAAKqnE,aAAe,KAAO,GAAKE,IAClCvnE,KAAKwnE,eAAetkE,EAAGqkE,IAElB,GACT,CACQC,eAAetkE,EAAaqkE,GAClC,MAAME,EAAaznE,KAAKmF,SAASqwB,aAAa7xB,MAAMgP,QAGpD,GAAI80D,IACEA,EAAWlnE,OAAS6L,EAAAA,GAAAA,YAAoBq7D,EAAWlnE,OAAS6L,EAAAA,GAAAA,cAC9D,OAAO,EAIX,GACEq7D,IACCA,EAAWlnE,OAAS6L,EAAAA,GAAAA,cAAsBq7D,EAAWlnE,OAAS6L,EAAAA,GAAAA,cAE/D,OAAO,EAIT,GAAIq7D,GAAcA,EAAWlnE,OAAS6L,EAAAA,GAAAA,gBAAuB,CAC3D,MAAMojC,EAAiBi4B,EACvB,IAAKj4B,EAAe4C,qBAClB,OAAO,EAET,QAAkCzvC,IAA9B6sC,EAAen8B,WACjB,OAAO,CAEX,CAGA,GACErT,KAAKmF,SAASqwB,aAAa7xB,MAAMgP,SACjC3S,KAAKmF,SAASqwB,aAAa7xB,MAAMgP,QAAQpS,OAAS6L,EAAAA,GAAAA,cAClD,CACA,MAAM2uC,EAAK/6C,KAAKmF,SAASqwB,aAAa7xB,MAAMgP,QAAQxF,oBAChD4tC,IACF73C,EAAI63C,EAER,CAEA,IAAI99B,EAAMjd,KAAK8pB,kBACXiF,GAAS,EACT9tB,EAAIjB,KAAKmF,SAASqwB,aAAa7xB,MAAMguD,cAAczwD,OACvD,KAAOD,KAAK,CACV,MAAMymE,EAAY1nE,KAAKmF,SAASqwB,aAAa7xB,MAAMguD,cAAc1wD,GACjE,GAAIymE,EAAU9kE,IAAIxB,GAAKqmE,IAAeC,EAAW,CAC/C,GAAIA,EAAU3kE,WACZ,SAOF,GAAI/C,KAAKsnE,kBAAkBH,8BAA8BlmE,GACvD,SAGF,MAAM+nC,GAAS97B,EAAAA,EAAAA,IAAYw6D,EAAU9kE,IAAKM,GACtC8lC,EAAS/rB,IACXA,EAAM+rB,EACNja,EAAQ9tB,EAEZ,CACF,CAEA,GAAIjB,KAAKsnE,kBAAkBV,mBAAmB73C,GAC5C,OAAO,EAIT,IAAe,IAAXA,EACF,GAAIw4C,EAAW,CACb,IAAII,GAAW,EACf,IAAK,IAAI1mE,EAAI,EAAGA,EAAIjB,KAAKmF,SAASqwB,aAAa7xB,MAAMotD,yBAAyB7vD,SAAUD,EAAG,CACzF,MAAMkwB,EAAKnxB,KAAKmF,SAASqwB,aAAa7xB,MAAMotD,yBAC1C9vD,GAEF,GAAIkwB,IAAOs2C,EAAY,CACrB,MAAMl9C,EAAK4G,EAAGwZ,eAAeznC,GAC7B,GAAIqnB,IAAMrd,EAAAA,EAAAA,IAAYqd,EAAIrnB,GAAKlD,KAAK8pB,kBAAmB,CACrD5mB,EAAE9B,EAAImpB,EAAGnpB,EACT8B,EAAE7B,EAAIkpB,EAAGlpB,EAGTsmE,GAAW,EACXx2C,EAAGhhB,2BAEH,MAAMy3D,EAAwBH,EAE5BG,GACAA,EAAsBprD,QACtBorD,EAAsBprD,OAAO,IAE7BorD,EAAsBprD,OAAO,GAAGgB,OAAOrN,0BAE3C,CACF,CACAghB,EAAG2X,UAAUjB,YAASllC,EACtBwuB,EAAG2X,UAAUf,iBAAcplC,EAC3BwuB,EAAG2X,UAAUd,6BAA0BrlC,EACvCwuB,EAAG2X,UAAUhB,eAAYnlC,CAC3B,CACA,GAAIglE,EACF,OAAO,CAEX,MACE,IAAK,IAAI1mE,EAAI,EAAGA,EAAIjB,KAAKmF,SAASqwB,aAAa7xB,MAAMotD,yBAAyB7vD,SAAUD,EAAG,CACzF,MAAMkwB,EAAKnxB,KAAKmF,SAASqwB,aAAa7xB,MAAMotD,yBAC1C9vD,GAEF,GAAIkwB,IAAOs2C,EAAY,CACrB,MAAMl9C,EAAK4G,EAAGwZ,eAAeznC,GAC7B,GAAIqnB,IAAMrd,EAAAA,EAAAA,IAAYqd,EAAIrnB,GAAKlD,KAAK8pB,kBAAmB,CACrD,MAAM+rC,EAAK,IAAIxzD,EAAAA,GAASkoB,EAAGnpB,EAAGmpB,EAAGlpB,GAEjC,OADArB,KAAK6hC,uBAAuBg0B,IACrB,CACT,CACF,CACA71D,KAAK6hC,4BAAuBl/B,EAC9B,CAKJ,GAAI3C,KAAKsnE,kBAAkBR,iBAAiB/3C,GAC1C,OAAO,EAET,IAAK/uB,KAAKsnE,kBAAkBN,4BAA4Bj4C,GACtD,OAAO,EAGT,IAAK/uB,KAAKsnE,kBAAkBJ,qCAAqCn4C,GAC/D,OAAO,EAMT,GAAI/uB,KAAKsnE,kBAAkBX,sBAAsBzjE,GAa/C,OAZIqkE,IACFvnE,KAAKumE,eAAeD,wBAChBtmE,KAAKumE,eAAef,mBACtBtiE,EAAE9B,EAAIpB,KAAKumE,eAAef,iBAAiBpkE,EAC3C8B,EAAE7B,EAAIrB,KAAKumE,eAAef,iBAAiBnkE,EAK3CrB,KAAKumE,eAAeF,+BAGjB,EAET,GAAIrmE,KAAKsnE,kBAAkBb,mBAAmBvjE,GAa5C,OAZIqkE,IACFvnE,KAAKumE,eAAeD,wBAChBtmE,KAAKumE,eAAef,mBACtBtiE,EAAE9B,EAAIpB,KAAKumE,eAAef,iBAAiBpkE,EAC3C8B,EAAE7B,EAAIrB,KAAKumE,eAAef,iBAAiBnkE,EAK3CrB,KAAKumE,eAAeF,+BAGjB,EAKT,GACEppD,EAAMjd,KAAK8pB,mBACX9pB,KAAKmF,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,GAAOnsB,IAAIxB,EAC1D,CACA,GAAIpB,KAAKsnE,kBAAkBT,uBAAuB93C,GAChD,OAAO,EAGT,GAAIw4C,EAAW,CACb,MAAMh7C,EAAOvsB,KAAKmF,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,GAAOnsB,IAAIxB,EAAI8B,EAAE9B,EACvEorB,EAAOxsB,KAAKmF,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,GAAOnsB,IAAIvB,EAAI6B,EAAE7B,EAG7E,GAAIomE,GAAcA,EAAWlnE,OAAS6L,EAAAA,GAAAA,gBAAuB,CAC3D,MAAMojC,EAAiBi4B,EACvBj4B,EAAe7iB,aAAeJ,EAC9BijB,EAAe5iB,cAAgBJ,CACjC,CAEAtpB,EAAE9B,EAAIpB,KAAKmF,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,GAAOnsB,IAAIxB,EAChE8B,EAAE7B,EAAIrB,KAAKmF,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,GAAOnsB,IAAIvB,EAKhErB,KAAKumE,eAAeF,2BAMtB,KAAO,CACL,MAAMjlE,EAAIpB,KAAKmF,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,GAAOnsB,IAAIxB,EAC9DC,EAAIrB,KAAKmF,SAASqwB,aAAa7xB,MAAMguD,cAAc5iC,GAAOnsB,IAAIvB,EAC9Dw0D,EAAK,IAAIxzD,EAAAA,GAASjB,EAAGC,GAC3BrB,KAAK6hC,uBAAuBg0B,EAC9B,CACF,MACE71D,KAAK6hC,4BAAuBl/B,GAE9B,OAAO,CACT,EC1PK,MAAMklE,GAEXhoE,YAAY8gC,GAAqC,KAD1CA,eAAS,EAEd3gC,KAAK2gC,UAAYA,CACnB,CACOn9B,SACL,ECDG,MAAMskE,WAA+BD,GAK1ChoE,YAAY8gC,GACVz7B,MAAMy7B,GAAW,KALZx7B,cAAQ,OACR4iE,4BAA6B,EAAM,KACnCC,kBAAmB,EAAM,KACzBC,oBAAqB,EAG1BjoE,KAAKmF,SAAWw7B,EAAUA,UAAUx7B,QACtC,CAEO3B,UAEHxD,KAAKmF,SAASqwB,aAAahqB,wBAAwB8C,aAAak8C,WAChExqD,KAAK+nE,8BAEL/nE,KAAKkoE,4BACLloE,KAAK+nE,4BAA6B,IAEhC/nE,KAAKgoE,kBAAqBhoE,KAAKioE,oBAEjCjoE,KAAKiuB,WAET,CACOA,YACL,IAAK,IAAIhtB,EAAI,EAAGA,EAAIjB,KAAKmF,SAASqwB,aAAa7xB,MAAM0nD,2BAA2BnqD,SAAUD,EACxFjB,KAAKmF,SAASqwB,aAAa7xB,MAAM0nD,2BAA2BpqD,GAAG+D,UAAUxB,QAE7E,CAEO0kE,4BACL,IAAK,IAAIjnE,EAAI,EAAGA,EAAIjB,KAAKmF,SAASqwB,aAAa7xB,MAAM0nD,2BAA2BnqD,SAAUD,EACxFjB,KAAKmF,SAASqwB,aAAa7xB,MAAM0nD,2BAA2BpqD,GAAG+D,UAAUrD,eAAiB,GAExF3B,KAAKmF,SAASqwB,aAAahqB,wBAAwB8C,aAAak7C,wBAClExpD,KAAKmoE,mBAAmBnoE,KAAKmF,SAASqwB,aAAa7xB,MAAM0nD,2BAE7D,CACO+c,aAEHpoE,KAAKmF,SAASqwB,aAAahqB,wBAAwB8C,aAAai7C,4BAIpE,CACQ4e,mBAAmBE,GACzB,GAAIA,EAAe,KAEdA,EAAe,GAAG1kE,MAAMC,mBAAmB4H,wBAAwB8C,aACjEiB,uBAEH,OAGJ,IAAI04D,GAAqB,EACzB,IAAK,IAAIhnE,EAAI,EAAGA,EAAIonE,EAAennE,OAAS,IAAKD,EAAG,CAClD,MAAMqnE,EAAO,CAACD,EAAepnE,GAAG+D,UAAU/B,OAAQolE,EAAepnE,GAAG+D,UAAU7B,QAC9E,IAAK,IAAI+Y,EAAIjb,EAAI,EAAGib,EAAImsD,EAAennE,SAAUgb,EAAG,CAClD,MAAMqsD,EAAO,CAACF,EAAensD,GAAGlX,UAAU/B,OAAQolE,EAAensD,GAAGlX,UAAU7B,SAC1EqlE,EAAAA,EAAAA,IAAgBF,EAAMC,KAExBF,EAAepnE,GAAG+D,UAAUrD,eAAeR,KAAKknE,EAAensD,IAE/DmsD,EAAensD,GAAGlX,UAAUrD,eAAeR,KAAKknE,EAAepnE,IAC/DjB,KAAKgoE,kBAAmB,EACxBC,GAAqB,EAKzB,CACF,CACAjoE,KAAKioE,mBAAqBA,EACtBA,IACFjoE,KAAKgoE,kBAAmB,EAE5B,EC9EK,MAAMS,WAAuBZ,GAClChoE,YAAY8gC,GACVz7B,MAAMy7B,EACR,CACOn9B,SACLxD,KAAK0oE,oCAEP,CACOA,qCACL,IACE,IAAIznE,EAAI,EACRA,EAAIjB,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAM0nD,2BAA2BnqD,SAClFD,EACF,CACA,MAAMuuC,EAAiBxvC,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MACnE0nD,2BAA2BpqD,GAC9BuuC,EAAexqC,UAAUxC,YAAa,EACtCgtC,EAAexqC,UAAUpD,UAAY,EACrC4tC,EAAezsC,YAAa,CAC9B,CACA,IAAInB,EAAW,EACf,IACE,IAAIX,EAAI,EACRA,EAAIjB,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAM0nD,2BAA2BnqD,SAClFD,EACF,CACA,MAAMuuC,EAAiBxvC,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MACnE0nD,2BAA2BpqD,GAC9B,IACE,IAAIib,EAAI,EACRA,EAAIlc,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAM0nD,2BAA2BnqD,SAClFgb,EACF,CACA,MAAMnC,EAAQ/Z,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAC1D0nD,2BAA2BnvC,GAE5BnC,IAAUy1B,IACVg5B,EAAAA,EAAAA,IACE,CAACh5B,EAAexqC,UAAU/B,OAAQusC,EAAexqC,UAAU7B,QAC3D,CAAC4W,EAAM/U,UAAU/B,OAAQ8W,EAAM/U,UAAU7B,WAG3CqsC,EAAexqC,UAAUxC,YAAa,EACtCgtC,EAAexqC,UAAUpD,SAAWA,IACpC4tC,EAAezsC,YAAa,EAEhC,CACF,CACF,CACO4lE,8CACL,IACE,IAAI1nE,EAAI,EACRA,EAAIjB,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAM0nD,2BAA2BnqD,SAClFD,EACF,CACA,MAAMuuC,EAAiBxvC,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MACnE0nD,2BAA2BpqD,GAC9BuuC,EAAexqC,UAAUxC,YAAa,EACtCgtC,EAAexqC,UAAUpD,UAAY,EACrC4tC,EAAezsC,YAAa,CAC9B,CACA,IAAInB,EAAW,EACf,IACE,IAAIX,EAAI,EACRA,EAAIjB,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAM0nD,2BAA2BnqD,SAClFD,EACF,CACA,MAAMuuC,EAAiBxvC,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MACnE0nD,2BAA2BpqD,GAE9B,IAAIuuC,EAAe/oC,gBAInB,IACE,IAAIyV,EAAI,EACRA,EAAIlc,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAM0nD,2BAA2BnqD,SAClFgb,EACF,CACA,MAAMnC,EAAQ/Z,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAC1D0nD,2BAA2BnvC,GAC9B,GACEnC,IAAUy1B,IACVg5B,EAAAA,EAAAA,IACE,CAACh5B,EAAexqC,UAAU/B,OAAQusC,EAAexqC,UAAU7B,QAC3D,CAAC4W,EAAM/U,UAAU/B,OAAQ8W,EAAM/U,UAAU7B,SAE3C,CACAqsC,EAAexqC,UAAUxC,YAAa,EACtCgtC,EAAexqC,UAAUpD,SAAWA,IACpC4tC,EAAezsC,YAAa,EAC5B,KACF,CACF,CACF,CACF,EChGK,MAAM6lE,WAAsBf,GACjChoE,YAAY8gC,GACVz7B,MAAMy7B,EACR,CACOn9B,SACLxD,KAAK6oE,+BACP,CACQA,gCACN,IACE,IAAI5nE,EAAI,EACRA,EAAIjB,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAM0nD,2BAA2BnqD,SAClFD,EACF,CACA,MAAMuuC,EAAiBxvC,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MACnE0nD,2BAA2BpqD,GAC9BuuC,EAAelnC,kBAAmB,EAC9BknC,EAAesD,OAAO1D,SAAWI,EAAesD,OAAO1D,QAAQiG,SACjE7F,EAAesD,OAAO1D,QAAQiG,QAAS,EAE3C,CACF,ECpBK,MAAMyzB,WAAkBjB,GAC7BhoE,YAAY8gC,GACVz7B,MAAMy7B,EACR,CACOn9B,SACLxD,KAAK+oE,+BACP,CACQA,gCACN,ECFG,MAAMC,GAIXnpE,YAAY8gC,EAAsBpgC,GAAgC,KAH3DogC,eAAS,OACTsoC,qBAAe,OACdC,WAAK,EAEXlpE,KAAK2gC,UAAYA,EACjB3gC,KAAKO,KAAOA,CACd,CACWA,WACT,OAAOP,KAAKkpE,KACd,CACW3oE,SAAK2C,GAKd,OAJAlD,KAAKkpE,MAAQhmE,EACRlD,KAAK2gC,UAAUx7B,SAASqwB,aAAa3xB,gBAAgBC,IAAI43B,WAGtDx4B,GACN,KAAK2mD,EAAAA,GAAAA,KAEH,YADA7pD,KAAKipE,gBAAkB,IAAIH,GAAU9oE,OAEvC,KAAK6pD,EAAAA,GAAAA,UAEH,YADA7pD,KAAKipE,gBAAkB,IAAIR,GAAezoE,OAE5C,KAAK6pD,EAAAA,GAAAA,MAEH,YADA7pD,KAAKipE,gBAAkB,IAAInB,GAAuB9nE,OAEpD,QAEE,YADAA,KAAKipE,gBAAkB,IAAIL,GAAc5oE,OAG/C,CACOwD,SACLxD,KAAKipE,gBAAgBzlE,QACvB,ECxCK,MAAM2lE,GAEXtpE,YAAY8gC,GAA4B,KADjCA,eAAS,EAEd3gC,KAAK2gC,UAAYA,CACnB,CACOC,WAAWx/B,EAAWC,GAC3B,OAAO,CACT,CACOwzB,UAAUzzB,EAAWC,GAC1B,CAEKmC,SACL,CAEKC,OAAOC,GACZ,ECZG,MAAM0lE,GAIXvpE,YAAY8gC,GAA4B,KAHjCA,eAAS,OACT+kB,WAA8B,GAAG,KACjC1C,WAA8B,GAEnChjD,KAAK2gC,UAAYA,CACnB,CACOn9B,SACLxD,KAAKqpE,eAELrpE,KAAKgjD,WAAahjD,KAAKspE,kBAAkBtpE,KAAKgjD,YAC9ChjD,KAAK0lD,WAAa1lD,KAAKspE,kBAAkBtpE,KAAK0lD,YAE9C1lD,KAAKupE,eAGL,MAAMvmB,EAAahjD,KAAKwpE,WAAWxpE,KAAKgjD,YAClC0C,EAAa1lD,KAAKwpE,WAAWxpE,KAAK0lD,YAExC,GAAI1C,GAAc0C,EAAY,CAC5B1lD,KAAKypE,uBAAuBzmB,EAAY52C,EAAAA,GAAAA,gBACxCpM,KAAKypE,uBAAuB/jB,EAAYt5C,EAAAA,GAAAA,eAGxCpM,KAAK0pE,kCAEL,MAAMC,EAAU3pE,KAAK4pE,gBACjBD,EAAQzoE,OAAS,IAEnBlB,KAAK6pE,cAAcF,GAEnB3pE,KAAK8pE,mBAET,CACF,CACOP,eACLvpE,KAAK2gC,UAAUx7B,SAASokE,cAC1B,CACOE,uBAAuBM,EAAiCxpE,GAC7DP,KAAK2gC,UAAUx7B,SAASskE,uBAAuBM,EAAcxpE,EAC/D,CACQ8oE,eACNrpE,KAAKgjD,WAAa,GAClBhjD,KAAK0lD,WAAa,GAClB,IACE,IAAIzkD,EAAI,EACRA,EAAIjB,KAAK2gC,UAAUA,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAMq/C,WAAW9hD,SAC5ED,EAEF,IACEjB,KAAK2gC,UAAUA,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAMq/C,WAAW/hD,GAAGP,UAC5EV,KAAK2gC,UAAUA,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAMq/C,WAAW/hD,GAAGe,aAGzE,CACL,MAAM6tB,EAAK7vB,KAAK2gC,UAAUA,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAMq/C,WAAW/hD,GACrF4uB,EAAG7qB,UAAUnC,QACb7C,KAAKgjD,WAAW7hD,KAAK0uB,EACvB,CAEF,IACE,IAAI5uB,EAAI,EACRA,EAAIjB,KAAK2gC,UAAUA,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAM+hD,WAAWxkD,SAC5ED,EAEF,IACEjB,KAAK2gC,UAAUA,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAM+hD,WAAWzkD,GAAGP,UAC5EV,KAAK2gC,UAAUA,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAM+hD,WAAWzkD,GAAGe,aAGzE,CACL,MAAM6tB,EAAK7vB,KAAK2gC,UAAUA,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAM+hD,WAAWzkD,GACrF4uB,EAAG7qB,UAAUnC,QACb7C,KAAK0lD,WAAWvkD,KAAK0uB,EACvB,CAEJ,CACQy5C,kBAAkBU,GACxB,IAAK,IAAI/oE,EAAI,EAAGA,EAAI+oE,EAAW9oE,SAAUD,EAAG,CAC1C,MAAM4uB,EAAKm6C,EAAW/oE,GACtB,IAAK,IAAIib,EAAIjb,EAAI,EAAGib,EAAI8tD,EAAW9oE,SAAUgb,EAAG,CAC9C,MAAMnC,EAAQiwD,EAAW9tD,IAEtBnC,EAAMhX,YACPgX,IAAU8V,IACV24C,EAAAA,EAAAA,IACE,CAAC34C,EAAG7qB,UAAU/B,OAAQ4sB,EAAG7qB,UAAU7B,QACnC,CAAC4W,EAAM/U,UAAU/B,OAAQ8W,EAAM/U,UAAU7B,WAG3C0sB,EAAG7qB,UAAUxC,YAAa,EAC1BqtB,EAAG9sB,YAAa,EAChB8sB,EAAG/sB,SAAW,EACd+sB,EAAG7qB,UAAUrD,eAAeR,KAAK4Y,GAEjCA,EAAM/U,UAAUxC,YAAa,EAC7BuX,EAAMhX,YAAa,EACnBgX,EAAMjX,SAAW,EACjBiX,EAAM/U,UAAUrD,eAAeR,KAAK0uB,GAMxC,CACF,CACA,OAAOm6C,CACT,CACQR,WAAWQ,GACjB,MAAMC,EAAU,GAChB,IAAK,IAAIhpE,EAAI,EAAGA,EAAI+oE,EAAW9oE,SAAUD,EAAG,CAC1C,MAAMipE,EAAS,GACTC,EAAQ,CAACH,EAAW/oE,IAC1BkpE,EAAM,GAAGnlE,UAAUlD,WAAY,EAC/BooE,EAAO/oE,KAAKgpE,EAAM,IAElB,IACIC,EADAjyC,EAAY,EAEhB,UAAqCx1B,KAA7BynE,EAAUD,EAAMl6D,UAAwB,CAC9C,IAAK,IAAIhP,EAAI,EAAGA,EAAImpE,EAAQplE,UAAUrD,eAAeT,SAAUD,EACxDmpE,EAAQplE,UAAUrD,eAAeV,GAAG+D,UAAUlD,YACjDsoE,EAAQplE,UAAUrD,eAAeV,GAAG+D,UAAUlD,WAAY,EAC1DqoE,EAAMhpE,KAAKipE,EAAQplE,UAAUrD,eAAeV,IAC5CipE,EAAO/oE,KAAKipE,EAAQplE,UAAUrD,eAAeV,KAGjD,GAAIk3B,IAAc,IAEhB,MAEJ,CAEI+xC,EAAOhpE,OAAS,GAClB+oE,EAAQ9oE,KAAK+oE,EAEjB,CACA,OAAOD,CACT,CACOP,kCACL,IAAK,IAAIzoE,EAAI,EAAGA,EAAIjB,KAAK2gC,UAAUx7B,SAASklE,eAAenpE,SAAUD,EACnEjB,KAAKsqE,cAActqE,KAAK2gC,UAAUx7B,SAASklE,eAAeppE,GAAIjB,KAAKgjD,YAErE,IAAK,IAAI/hD,EAAI,EAAGA,EAAIjB,KAAK2gC,UAAUx7B,SAASolE,eAAerpE,SAAUD,EACnEjB,KAAKsqE,cAActqE,KAAK2gC,UAAUx7B,SAASolE,eAAetpE,GAAIjB,KAAKgjD,WAEvE,CACQsnB,cAAcE,EAAuBxX,GAC3C,IAAIvqC,EAAS,EACb,MAAM0hD,EAAQ,IAAInX,GAClB,KAAOmX,EAAMjpE,QAAQ,CACnB,MAAMQ,EAAMyoE,EAAMl6D,QAGlB,GAAIvO,EAAK,CAEP,GAAIA,EAAIoB,SAAW,IAAK,CACtBpB,EAAIoB,SAAW,EACf,KACF,CACA,GAAqB,IAAjBqnE,EAAMjpE,QACJ8xD,EAAW9xD,OAASunB,IACtB,MAKC/mB,EAAIsD,UAAUxC,cAEfgmE,EAAAA,EAAAA,IACE,CAAC9mE,EAAIsD,UAAU/B,OAAQvB,EAAIsD,UAAU7B,QACrC,CAACqnE,EAAQvnE,OAAQunE,EAAQrnE,UAG3BzB,EAAIsD,UAAUxC,YAAa,EAC3Bd,EAAIqB,YAAa,EACjBrB,EAAIoB,SAAW,EACf0nE,EAAQC,QAAQ/oE,KAEhBA,EAAIoB,WACJqnE,EAAMhpE,KAAKO,IAGjB,CACF,CACF,CACQkoE,gBACN,MAAMc,EAAe,GACrB,IAAK,IAAIzpE,EAAI,EAAGA,EAAIjB,KAAK2gC,UAAUx7B,SAASklE,eAAenpE,SAAUD,EAC/DjB,KAAK2gC,UAAUx7B,SAASklE,eAAeppE,GAAG2oE,iBAC5Cc,EAAavpE,KAAKnB,KAAK2gC,UAAUx7B,SAASklE,eAAeppE,IAG7D,IAAK,IAAIA,EAAI,EAAGA,EAAIjB,KAAK2gC,UAAUx7B,SAASolE,eAAerpE,SAAUD,EAC/DjB,KAAK2gC,UAAUx7B,SAASolE,eAAetpE,GAAG2oE,iBAC5Cc,EAAavpE,KAAKnB,KAAK2gC,UAAUx7B,SAASolE,eAAetpE,IAG7D,OAAOypE,CACT,CACQb,cAAcc,GACpB,IAAK,IAAI1pE,EAAI,EAAGA,EAAI0pE,EAASzpE,SAAUD,EACrC0pE,EAAS1pE,GAAG+lB,OAEhB,CACQ8iD,mBACN9pE,KAAK4qE,wBAAwB5qE,KAAK2gC,UAAUx7B,SAASklE,gBACrDrqE,KAAK4qE,wBAAwB5qE,KAAK2gC,UAAUx7B,SAASolE,eACvD,CACQK,wBAAwBD,GAC9B,IAAK,IAAI1pE,EAAI,EAAGA,EAAI0pE,EAASzpE,OAAS,IAAKD,EAAG,CAC5C,MAAMupE,EAAUG,EAAS1pE,GACzB,IAAK,IAAIib,EAAIjb,EAAI,EAAGib,EAAIyuD,EAASzpE,SAAUgb,EAAG,CAC5C,MAAMnC,EAAQ4wD,EAASzuD,GAClBnC,EAAMjY,YACLoL,EAAAA,EAAAA,IAAYs9D,EAAQ5nE,IAAKmX,EAAMnX,KAAO4nE,EAAQvkC,GAAK,KACrDlsB,EAAMjY,WAAY,EAClB0oE,EAAQK,MAAM9wD,GAGpB,CACF,CACF,EC/NK,MAAM+wD,GAGXjrE,YAAY8gC,GAA4B,KAFjCA,eAAS,OACTljB,EAAc,IAAIpb,EAAAA,GAAS,EAAG,GAEnCrC,KAAK2gC,UAAYA,CACnB,CACOC,WAAWx/B,EAAWC,GAC3BrB,KAAKyd,EAAErc,EAAIA,EACXpB,KAAKyd,EAAEpc,EAAIA,EACX,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAK2gC,UAAUx7B,SAASklE,eAAenpE,SAAUD,EAEnE,GAAIjB,KAAK2gC,UAAUx7B,SAASklE,eAAeppE,GAAGokE,SAASrlE,KAAKyd,GAG1D,OAAO,EAGX,IAAK,IAAIxc,EAAI,EAAGA,EAAIjB,KAAK2gC,UAAUx7B,SAASolE,eAAerpE,SAAUD,EACnE,GAAIjB,KAAK2gC,UAAUx7B,SAASolE,eAAetpE,GAAGokE,SAASrlE,KAAKyd,GAG1D,OAAO,EAGX,OAAO,CACT,CACOoX,UAAUzzB,EAAWC,GAC1BrB,KAAKyd,EAAErc,EAAIA,EACXpB,KAAKyd,EAAEpc,EAAIA,EACX,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAK2gC,UAAUx7B,SAASklE,eAAenpE,SAAUD,EACnEjB,KAAK2gC,UAAUx7B,SAASklE,eAAeppE,GAAGokE,SAASrlE,KAAKyd,GAE1D,IAAK,IAAIxc,EAAI,EAAGA,EAAIjB,KAAK2gC,UAAUx7B,SAASolE,eAAerpE,SAAUD,EACnEjB,KAAK2gC,UAAUx7B,SAASolE,eAAetpE,GAAGokE,SAASrlE,KAAKyd,EAE5D,ECjCK,MAAMstD,GA0BXlrE,YAAYsF,EAAoB6tD,EAA6BzyD,GAAc,KAzBpE4E,cAAQ,OACR6tD,gBAAU,OACVhtB,GAAa,GAAS,KACtBC,GAAa,GAAS,KACtB77B,SAAU,EAAM,KAChBtI,WAAY,EAAM,KAClBkpE,eAA2B,IAAI3oE,EAAAA,GACpCiH,OAAOC,iBACPD,OAAOC,iBACPD,OAAOC,kBACP,KACK0hE,eAA2B,IAAI5oE,EAAAA,GACpCiH,OAAO65D,iBACP75D,OAAO65D,iBACP75D,OAAO65D,kBACP,KACKlgE,YAAM,OACNE,YAAM,OACNP,IAAM,IAAIP,EAAAA,GAAS,EAAG,EAAG,GAAG,KAC5B9B,UAAI,OACHgK,EAAI,EAAI,KACR2gE,eAAiB,GAAG,KAEpBC,gBAA8B,GAAG,KACjCC,gBAAuC,GAE7CprE,KAAKmF,SAAWA,EAChBnF,KAAKgzD,WAAaA,EAClBhzD,KAAKO,KAAOA,EACZ,IAAK,IAAIU,EAAI,EAAGA,EAAIjB,KAAKgzD,WAAW9xD,SAAUD,EAC5CjB,KAAK4C,IAAIxB,GAAKpB,KAAKgzD,WAAW/xD,GAAG2B,IAAIxB,EACrCpB,KAAK4C,IAAIvB,GAAKrB,KAAKgzD,WAAW/xD,GAAG2B,IAAIvB,EACrCrB,KAAK8N,kBAAkB9N,KAAKgzD,WAAW/xD,GAAG2B,KAE5C5C,KAAK4C,IAAIxB,GAAKpB,KAAKgzD,WAAW9xD,OAC9BlB,KAAK4C,IAAIvB,GAAKrB,KAAKgzD,WAAW9xD,OAE9BlB,KAAKiD,OAAS,IAAIZ,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAIpB,KAAKimC,GAAIjmC,KAAK4C,IAAIvB,EAAIrB,KAAKimC,GAAI,GACvEjmC,KAAKmD,OAAS,IAAId,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAIpB,KAAKimC,GAAIjmC,KAAK4C,IAAIvB,EAAIrB,KAAKimC,GAAI,EAKzE,CACOo/B,SAAS5nD,GACd,OAAIvQ,EAAAA,EAAAA,IAAYlN,KAAK4C,IAAK6a,GAAKzd,KAAKimC,IAClCjmC,KAAKoK,SAAU,EACfpK,KAAKgzD,WAAW,GAAGrvD,MAAMC,mBAAmB4H,wBAAwBke,kBAAkBshC,0BACtFhrD,KAAKgzD,WAAW,GAAGrvD,MAAMC,mBAAmBuB,SAASmP,WAAY,EACjEtU,KAAKgzD,WAAW,GAAGrvD,MAAMC,mBAAmB4H,wBAAwB8C,aAAag7C,aAAc,GACxF,IAETtpD,KAAKoK,SAAU,GACR,EACT,CACOqgE,QAAQ/oE,GAEb,IAAI1B,KAAKgzD,WAAWK,SAAS3xD,GAA7B,CAIA1B,KAAKgzD,WAAW7xD,KAAKO,GACrB1B,KAAK4C,IAAM,IAAIP,EAAAA,GAAS,EAAG,EAAG,GAC9B,IAAK,IAAIpB,EAAI,EAAGA,EAAIjB,KAAKgzD,WAAW9xD,SAAUD,EAC5CjB,KAAK4C,IAAIxB,GAAKpB,KAAKgzD,WAAW/xD,GAAG2B,IAAIxB,EACrCpB,KAAK4C,IAAIvB,GAAKrB,KAAKgzD,WAAW/xD,GAAG2B,IAAIvB,EACrCrB,KAAK8N,kBAAkB9N,KAAKgzD,WAAW/xD,GAAG2B,KAE5C5C,KAAK4C,IAAIxB,GAAKpB,KAAKgzD,WAAW9xD,OAC9BlB,KAAK4C,IAAIvB,GAAKrB,KAAKgzD,WAAW9xD,OAE9BlB,KAAKiD,OAAS,IAAIZ,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAIpB,KAAKimC,GAAIjmC,KAAK4C,IAAIvB,EAAIrB,KAAKimC,GAAI,GACvEjmC,KAAKmD,OAAS,IAAId,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAIpB,KAAKimC,GAAIjmC,KAAK4C,IAAIvB,EAAIrB,KAAKimC,GAAI,EAbvE,CAcF,CACO2jC,gBACL,OAAI5pE,KAAKirE,eAAe7pE,EAAIpB,KAAKgrE,eAAe5pE,EAAIpB,KAAKkrE,gBAGrDlrE,KAAKirE,eAAe5pE,EAAIrB,KAAKgrE,eAAe3pE,EAAIrB,KAAKkrE,cAI3D,CACOlkD,QACLhnB,KAAK+d,aACL,MAAMstD,GACHrrE,KAAKirE,eAAe7pE,EAAIpB,KAAKgrE,eAAe5pE,GAAKpB,KAAKkrE,eAAiB,EACpE,GACClrE,KAAKirE,eAAe7pE,EAAIpB,KAAKgrE,eAAe5pE,GAAKpB,KAAKkrE,eACvDI,GACHtrE,KAAKirE,eAAe5pE,EAAIrB,KAAKgrE,eAAe3pE,GAAKrB,KAAKkrE,eAAiB,EACpE,GACClrE,KAAKirE,eAAe5pE,EAAIrB,KAAKgrE,eAAe3pE,GAAKrB,KAAKkrE,eACvDK,EAAOvrE,KAAKwrE,UAAUH,EAAMC,GAClCtrE,KAAKyrE,gBAAgBF,EAAMF,EAAMC,EACnC,CACOT,MAAM9wD,GACX/Z,KAAKgzD,WAAWx/B,OAAOzZ,EAAMi5C,YAC7BhzD,KAAK4C,IAAM,IAAIP,EAAAA,GAAS,EAAG,EAAG,GAC9B,IAAK,IAAIpB,EAAI,EAAGA,EAAIjB,KAAKgzD,WAAW9xD,SAAUD,EAC5CjB,KAAK4C,IAAIxB,GAAKpB,KAAKgzD,WAAW/xD,GAAG2B,IAAIxB,EACrCpB,KAAK4C,IAAIvB,GAAKrB,KAAKgzD,WAAW/xD,GAAG2B,IAAIvB,EACrCrB,KAAK8N,kBAAkB9N,KAAKgzD,WAAW/xD,GAAG2B,KAE5C5C,KAAK4C,IAAIxB,GAAKpB,KAAKgzD,WAAW9xD,OAC9BlB,KAAK4C,IAAIvB,GAAKrB,KAAKgzD,WAAW9xD,OAE9BlB,KAAKiD,OAAS,IAAIZ,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAIpB,KAAKimC,GAAIjmC,KAAK4C,IAAIvB,EAAIrB,KAAKimC,GAAI,GACvEjmC,KAAKmD,OAAS,IAAId,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAIpB,KAAKimC,GAAIjmC,KAAK4C,IAAIvB,EAAIrB,KAAKimC,GAAI,GACvElsB,EAAMgE,YACR,CACOA,aACL/d,KAAKmF,SAASumE,cAAc1rE,KAC9B,CACOwrE,UAAUH,EAAcC,GAC7BtrE,KAAKorE,gBAAkB,GACvB,MAAMO,EAAW,GACjB,IAAK,IAAItqE,EAAI,EAAGA,EAAIiqE,IAAQjqE,EAAG,CAC7B,MAAMuqE,EAAO5rE,KAAKgrE,eAAe3pE,EAAIA,EAAIrB,KAAKkrE,eACxCW,EAA4B,GAClC,IAAK,IAAIzqE,EAAI,EAAGA,EAAIiqE,IAAQjqE,EAAG,CAC7B,MAAM0qE,EAAO9rE,KAAKgrE,eAAe5pE,EAAIA,EAAIpB,KAAKkrE,eAC9CS,EAASxqE,KAAK,IAAIkB,EAAAA,GAASypE,EAAMF,IACjC,MAAM9J,EAA2B,GACjC+J,EAAO1qE,KAAK2gE,EACd,CACA9hE,KAAKorE,gBAAgBjqE,KAAK0qE,EAC5B,CAEA,OADA7rE,KAAKmrE,gBAAkBQ,EAChBA,CACT,CACOF,gBAAgBzqE,EAAgBqqE,EAAcC,GACnD,IAAK,IAAIrqE,EAAI,EAAGA,EAAIjB,KAAKgzD,WAAW9xD,SAAUD,EAC5CjB,KAAK+rE,eAAe/rE,KAAKgzD,WAAW/xD,GAAG2B,IAAKyoE,EAAMC,GAAMnqE,KAAKnB,KAAKgzD,WAAW/xD,IAE/E,IAAK,IAAII,EAAI,EAAGA,EAAIrB,KAAKorE,gBAAgBlqE,SAAUG,EACjD,IAAK,IAAID,EAAI,EAAGA,EAAIpB,KAAKorE,gBAAgB/pE,GAAGH,SAAUE,EAChDpB,KAAKorE,gBAAgB/pE,GAAGD,KACgB,IAAtCpB,KAAKorE,gBAAgB/pE,GAAGD,GAAGF,OAC7BlB,KAAKorE,gBAAgB/pE,GAAGD,GAAG,GAAG4D,UAAUnC,QAC/B7C,KAAKorE,gBAAgB/pE,GAAGD,GAAGF,OAAS,IACzClB,KAAKorE,gBAAgB/pE,GAAGD,GAAG,GAAGb,OAAS6L,EAAAA,GAAAA,eACzCpM,KAAKmF,SAASklE,eAAelpE,KAC3B,IAAI4pE,GACF/qE,KAAKmF,SACLnF,KAAKorE,gBAAgB/pE,GAAGD,GACxBpB,KAAKorE,gBAAgB/pE,GAAGD,GAAG,GAAGb,OAGzBP,KAAKorE,gBAAgB/pE,GAAGD,GAAG,GAAGb,OAAS6L,EAAAA,GAAAA,eAChDpM,KAAKmF,SAASolE,eAAeppE,KAC3B,IAAI4pE,GACF/qE,KAAKmF,SACLnF,KAAKorE,gBAAgB/pE,GAAGD,GACxBpB,KAAKorE,gBAAgB/pE,GAAGD,GAAG,GAAGb,QAQ9C,CACQwrE,eAAeC,EAAcX,EAAcC,GACjD,MAAM/a,EAAe,IAAIluD,EAAAA,GAAS2pE,EAAG5qE,EAAIpB,KAAKgrE,eAAe5pE,EAAG4qE,EAAG3qE,EAAIrB,KAAKgrE,eAAe3pE,GAE3F,IAAIJ,EAAYqR,KAAK25D,MAAM1b,EAAGnvD,EAAIpB,KAAKkrE,gBACnChvD,EAAY5J,KAAK25D,MAAM1b,EAAGlvD,EAAIrB,KAAKkrE,gBAiBvC,OAhBIjqE,GAAKoqE,IACPpqE,EAAIoqE,EAAO,GAETnvD,GAAKovD,IACPpvD,EAAIovD,EAAO,GAETrqE,EAAI,IACNA,EAAI,GAEFib,EAAI,IACNA,EAAI,GAENjb,EAAIqR,KAAK25D,MAAMhrE,GACfib,EAAI5J,KAAK25D,MAAM/vD,GAGRlc,KAAKorE,gBAAgBlvD,GAAGjb,EACjC,CACOqV,KAAK5S,EAA+ByB,GAEzC,GADAnF,KAAKksE,cAEH/mE,EAASw7B,UAAUA,UAAUA,UAAUx7B,SAASqwB,aAAahqB,wBAC1D8C,aAAa8b,eAChB,CACApqB,KAAK4C,IAAM,IAAIP,EAAAA,GAAS,EAAG,EAAG,GAC9BrC,KAAKgrE,eAAiB,IAAI3oE,EAAAA,GACxBiH,OAAOC,iBACPD,OAAOC,iBACPD,OAAOC,kBAETvJ,KAAKirE,eAAiB,IAAI5oE,EAAAA,GACxBiH,OAAO65D,iBACP75D,OAAO65D,iBACP75D,OAAO65D,kBAET,IAAK,IAAIliE,EAAI,EAAGA,EAAIjB,KAAKgzD,WAAW9xD,SAAUD,EAC5CjB,KAAK4C,IAAIxB,GAAKpB,KAAKgzD,WAAW/xD,GAAG2B,IAAIxB,EACrCpB,KAAK4C,IAAIvB,GAAKrB,KAAKgzD,WAAW/xD,GAAG2B,IAAIvB,EACrCrB,KAAK8N,kBAAkB9N,KAAKgzD,WAAW/xD,GAAG2B,KAE5C5C,KAAK4C,IAAIxB,GAAKpB,KAAKgzD,WAAW9xD,OAC9BlB,KAAK4C,IAAIvB,GAAKrB,KAAKgzD,WAAW9xD,OAC9BlB,KAAKiD,OAAS,IAAIZ,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAIpB,KAAKimC,GAAIjmC,KAAK4C,IAAIvB,EAAIrB,KAAKimC,GAAI,GACvEjmC,KAAKmD,OAAS,IAAId,EAAAA,GAASrC,KAAK4C,IAAIxB,EAAIpB,KAAKimC,GAAIjmC,KAAK4C,IAAIvB,EAAIrB,KAAKimC,GAAI,EAEzE,CAWA,GAVA9gC,EAASw7B,UAAUA,UAAUA,UAAUx7B,SAASmR,KAAKC,MAAMi0D,QAAQ2B,wBACjEzoE,EACA1D,KAAKgzD,WACLhzD,KAAK4C,IACL5C,KAAKgmC,GACLhmC,KAAKimC,GACLjmC,KAAKoK,QACLpK,KAAKuK,GAILpF,EAASw7B,UAAUA,UAAUA,UAAUx7B,SAASqwB,aAAa3xB,gBAAgBC,IAAIC,aAEjFL,EAAIO,YACJP,EAAIQ,KACFlE,KAAKiD,OAAO7B,EACZpB,KAAKiD,OAAO5B,EACZrB,KAAKmD,OAAO/B,EAAIpB,KAAKiD,OAAO7B,EAC5BpB,KAAKmD,OAAO9B,EAAIrB,KAAKiD,OAAO5B,GAE9BqC,EAAIS,YACJT,EAAIM,UAAY,qBAChBN,EAAIU,OAEJV,EAAImV,UAAY,GAChBnV,EAAIO,YACJP,EAAIQ,KACFlE,KAAKgrE,eAAe5pE,EACpBpB,KAAKgrE,eAAe3pE,EACpBrB,KAAKirE,eAAe7pE,EAAIpB,KAAKgrE,eAAe5pE,EAC5CpB,KAAKirE,eAAe5pE,EAAIrB,KAAKgrE,eAAe3pE,GAE9CqC,EAAIS,YACJT,EAAI8c,SAEAxgB,KAAKmrE,gBAAgBjqE,OAAS,GAChC,IAAK,IAAID,EAAI,EAAGA,EAAIjB,KAAKmrE,gBAAgBjqE,SAAUD,EACjDyC,EAAIO,YACJP,EAAIQ,KACFlE,KAAKmrE,gBAAgBlqE,GAAGG,EACxBpB,KAAKmrE,gBAAgBlqE,GAAGI,EACxBrB,KAAKkrE,eACLlrE,KAAKkrE,gBAEPxnE,EAAIS,YACJT,EAAI8c,QAIZ,CACQ0rD,cAEJlsE,KAAKgzD,WAAW,GAAGrvD,MAAMC,mBAAmB4H,wBAAwB8C,aAAag7C,aAEjFtpD,KAAKuK,GAAKvK,KAAKgzD,WAAW,GAAGrvD,MAAMC,mBAAmB6L,cAAcC,aAAa6E,WAAWC,gBAC5FxU,KAAKuK,EAAIvK,KAAKuK,EAAI,GAAM,GAAMvK,KAAKuK,IAEnCvK,KAAKuK,GAAKvK,KAAKgzD,WAAW,GAAGrvD,MAAMC,mBAAmB6L,cAAcC,aAAa6E,WAAWQ,gBAC5F/U,KAAKuK,EAAIvK,KAAKuK,EAAI,EAAI,EAAIvK,KAAKuK,EAEnC,CACQuD,kBAAkBlL,GACxB5C,KAAKgrE,eAAe5pE,EAAIwB,EAAIxB,EAAIpB,KAAKgrE,eAAe5pE,EAAIwB,EAAIxB,EAAIpB,KAAKgrE,eAAe5pE,EACpFpB,KAAKgrE,eAAe3pE,EAAIuB,EAAIvB,EAAIrB,KAAKgrE,eAAe3pE,EAAIuB,EAAIvB,EAAIrB,KAAKgrE,eAAe3pE,EACpFrB,KAAKirE,eAAe7pE,EAAIwB,EAAIxB,EAAIpB,KAAKirE,eAAe7pE,EAAIwB,EAAIxB,EAAIpB,KAAKirE,eAAe7pE,EACpFpB,KAAKirE,eAAe5pE,EAAIuB,EAAIvB,EAAIrB,KAAKirE,eAAe5pE,EAAIuB,EAAIvB,EAAIrB,KAAKirE,eAAe5pE,CACtF,ECzRK,MAAM4iE,GAIXpkE,YAAY8gC,GAA4B,KAHjC0pC,eAAiC,GAAG,KACpCE,eAAiC,GAAG,KACpC5pC,eAAS,EAEd3gC,KAAK2gC,UAAYA,CACnB,CACO4oC,eACLvpE,KAAKqqE,eAAiB,GACtBrqE,KAAKuqE,eAAiB,EACxB,CACOd,uBAAuB/nE,EAAwBnB,GACpD,GAAIA,IAAS6L,EAAAA,GAAAA,eACX,IAAK,IAAInL,EAAI,EAAGA,EAAIS,EAAIR,SAAUD,EAChCjB,KAAKqqE,eAAelpE,KAAK,IAAI4pE,GAAa/qE,KAAM0B,EAAIT,GAAIV,SAErD,GAAIA,IAAS6L,EAAAA,GAAAA,cAClB,IAAK,IAAInL,EAAI,EAAGA,EAAIS,EAAIR,SAAUD,EAChCjB,KAAKuqE,eAAeppE,KAAK,IAAI4pE,GAAa/qE,KAAM0B,EAAIT,GAAIV,GAG9D,CACOmrE,cAAclB,GACfA,EAAQxX,WAAW,GAAGzyD,OAAS6L,EAAAA,GAAAA,eACjCpM,KAAKqqE,eAAejtD,OAAOpd,KAAKqqE,eAAe53D,QAAQ+3D,GAAU,GACxDA,EAAQxX,WAAW,GAAGzyD,OAAS6L,EAAAA,GAAAA,eACxCpM,KAAKuqE,eAAentD,OAAOpd,KAAKuqE,eAAe93D,QAAQ+3D,GAAU,EAErE,CACO/mE,OAAOC,GACZ,GAAI1D,KAAKqqE,eAAenpE,OAAS,EAC/B,IAAK,IAAID,EAAI,EAAGA,EAAIjB,KAAKqqE,eAAenpE,SAAUD,EAChDjB,KAAKqqE,eAAeppE,GAAGqV,KAAK5S,EAAK1D,MAGrC,GAAIA,KAAKuqE,eAAerpE,OAAS,EAC/B,IAAK,IAAID,EAAI,EAAGA,EAAIjB,KAAKuqE,eAAerpE,SAAUD,EAChDjB,KAAKuqE,eAAetpE,GAAGqV,KAAK5S,EAAK1D,KAGvC,ECvCK,MAAMyoE,WAAuBU,GAIlCtpE,YAAY8gC,GACVz7B,MAAMy7B,GAAW,KAJZt7B,iBAAW,OACXF,cAAQ,OACRqM,WAAK,EAGVxR,KAAKqF,YAAc,IAAIylE,GAAY9qE,MACnCA,KAAKwR,MAAQ,IAAI43D,GAAMppE,MACvBA,KAAKmF,SAAW,IAAI8+D,GAASjkE,KAC/B,CACO4gC,WAAWx/B,EAAWC,GAC3B,QAAIrB,KAAKqF,YAAYu7B,WAAWx/B,EAAGC,EAIrC,CACOwzB,UAAUzzB,EAAWC,GAC1BrB,KAAKqF,YAAYwvB,UAAUzzB,EAAGC,EAChC,CACOoC,OAAOC,GACZ1D,KAAKmF,SAAS1B,OAAOC,EACvB,CACOF,SAELxD,KAAKwR,MAAMhO,QACb,EC3BK,MAAM4oE,GAYXvsE,YAAY8gC,GAAuB,KAX5BA,eAAS,OACT+kB,WAA8B,GAAG,KACjC1C,WAA8B,GAAG,KAEjCqpB,GAAK,GAAG,KACRC,GAAK,EAAE,KACPC,UAAY,EAAE,KACdC,UAAY,EAAE,KAEdC,MAAkB,GAGvBzsE,KAAK2gC,UAAYA,CACnB,CACOn9B,SAILxD,KAAK0sE,UAEP,CACQA,WACN1sE,KAAKysE,MAAQ,GACb,MAAMnpE,EAAQtD,KAAK2gC,UAAUA,UAAUA,UAAUx7B,SAASzB,IAAIggC,OAAOpgC,MAC/DC,EAASvD,KAAK2gC,UAAUA,UAAUA,UAAUx7B,SAASzB,IAAIggC,OAAOngC,OAEtEvD,KAAKusE,UAAYjpE,GAAStD,KAAKqsE,GAAK,GACpCrsE,KAAKwsE,UAAYjpE,GAAUvD,KAAKssE,GAAK,GAErC,IAAK,IAAIjrE,EAAI,EAAGA,EAAIrB,KAAKssE,GAAIjrE,IAAK,CAChC,MAAMsrE,EAAmB,GACzB,IAAK,IAAIvrE,EAAI,EAAGA,EAAIpB,KAAKqsE,GAAIjrE,IAC3BurE,EAASxrE,KAAK,IAAIyrE,GAAK5sE,KAAMoB,EAAGC,IAElCrB,KAAKysE,MAAMtrE,KAAKwrE,EAClB,CAIA,IACE,IAAI1rE,EAAI,EACRA,EAAIjB,KAAK2gC,UAAUA,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAMq/C,WAAW9hD,SAC5ED,EACF,CACA,MAAMwI,EAAIzJ,KAAK2gC,UAAUA,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAMq/C,WACvE/hD,GAEFjB,KAAK+rE,eAAetiE,EAAE7G,KAAK8xB,IAAIjrB,EACjC,CAEA,IAAK,IAAIpI,EAAI,EAAGA,EAAIrB,KAAKssE,KAAMjrE,EAC7B,IAAK,IAAID,EAAI,EAAGA,EAAIpB,KAAKqsE,KAAMjrE,EACzBpB,KAAKysE,MAAMprE,GAAGD,GAAG4xD,WAAW9xD,OAAS,IACvClB,KAAKysE,MAAMprE,GAAGD,GAAGY,cAAe,EAIxC,CACO+pE,eAAexb,GAEpB,IAAItvD,EAAYqR,KAAK25D,MAAM1b,EAAGnvD,EAAIpB,KAAKusE,WACnCrwD,EAAY5J,KAAK25D,MAAM1b,EAAGlvD,EAAIrB,KAAKwsE,WAavC,OAZIvrE,GAAKjB,KAAKqsE,KACZprE,EAAIjB,KAAKqsE,GAAK,GAEZnwD,GAAKlc,KAAKssE,KACZpwD,EAAIlc,KAAKssE,GAAK,GAEZrrE,EAAI,IACNA,EAAI,GAEFib,EAAI,IACNA,EAAI,GAEClc,KAAKysE,MAAMvwD,GAAGjb,EACvB,CACOwC,OAAOC,GACZ,IAAK,IAAIrC,EAAI,EAAGA,EAAIrB,KAAKysE,MAAMvrE,OAAQG,IACrC,IAAK,IAAID,EAAI,EAAGA,EAAIpB,KAAKysE,MAAMprE,GAAGH,OAAQE,IAExCpB,KAAKysE,MAAMprE,GAAGD,GAAGkV,KAAK5S,EAI5B,EAGF,MAAMkpE,GAWJ/sE,YAAY0rE,EAAYsB,EAAYC,GAAa,KAVjDvB,UAAI,OACJvlC,GAAa,GAAS,KACtBC,GAAa,GAAS,KACtBrjC,SAAG,OACHmqE,eAAS,OACTF,QAAE,OACFC,QAAE,OACF1iE,SAAU,EAAM,KAChB4oD,WAA8B,GAAG,KACjCga,mBAAoB,EAElBhtE,KAAKurE,KAAOA,EACZvrE,KAAK6sE,GAAKA,EACV7sE,KAAK8sE,GAAKA,EACV9sE,KAAK4C,IAAM,IAAIP,EAAAA,GAASwqE,EAAK7sE,KAAKurE,KAAKgB,UAAWO,EAAK9sE,KAAKurE,KAAKiB,WACjExsE,KAAKgzD,WAAa,EACpB,CACOt+B,IAAIhzB,GACTA,EAAIM,cAAe,EACnBhC,KAAKgzD,WAAW7xD,KAAKO,GAErB1B,KAAK+sE,UAAY,IAAI1qE,EAAAA,GAAS,EAAG,EAAG,GACpC,IAAK,IAAIpB,EAAI,EAAGA,EAAIjB,KAAKgzD,WAAW9xD,SAAUD,EAC5CjB,KAAK+sE,UAAU3rE,GAAKpB,KAAKgzD,WAAW/xD,GAAG2B,IAAIxB,EAC3CpB,KAAK+sE,UAAU1rE,GAAKrB,KAAKgzD,WAAW/xD,GAAG2B,IAAIvB,EAE7CrB,KAAK+sE,UAAU3rE,GAAKpB,KAAKgzD,WAAW9xD,OACpClB,KAAK+sE,UAAU1rE,GAAKrB,KAAKgzD,WAAW9xD,MACtC,CACWc,mBACT,OAAOhC,KAAKgtE,iBACd,CACWhrE,iBAAakB,GACtB,IAAKA,EAAG,CACN,IAAK,IAAIjC,EAAI,EAAGA,EAAIjB,KAAKgzD,WAAW9xD,SAAUD,EAC5CjB,KAAKgzD,WAAW/xD,GAAGe,cAAe,EAEpChC,KAAKgzD,WAAa,EACpB,CACAhzD,KAAKgtE,kBAAoB9pE,CAC3B,CAUOoT,KAAK5S,GAMV,GAAK1D,KAAKgC,aAAV,CAIA,GACEhC,KAAKurE,KAAK5qC,UAAUA,UAAUA,UAAUx7B,SAASqwB,aAAahqB,wBAC3D8C,aAAa8b,eAChB,CACApqB,KAAK+sE,UAAY,IAAI1qE,EAAAA,GAAS,EAAG,EAAG,GACpC,IAAK,IAAIpB,EAAI,EAAGA,EAAIjB,KAAKgzD,WAAW9xD,SAAUD,EAC5CjB,KAAK+sE,UAAU3rE,GAAKpB,KAAKgzD,WAAW/xD,GAAG2B,IAAIxB,EAC3CpB,KAAK+sE,UAAU1rE,GAAKrB,KAAKgzD,WAAW/xD,GAAG2B,IAAIvB,EAE7CrB,KAAK+sE,UAAU3rE,GAAKpB,KAAKgzD,WAAW9xD,OACpClB,KAAK+sE,UAAU1rE,GAAKrB,KAAKgzD,WAAW9xD,MAEtC,CASAwC,EAAIO,YACJP,EAAIe,IAAIzE,KAAK+sE,UAAU3rE,EAAGpB,KAAK+sE,UAAU1rE,EAAG,EAAG,EAAa,EAAViR,KAAK8Y,IACvD1nB,EAAIS,YACJT,EAAI8c,SAEJxgB,KAAKurE,KAAK5qC,UAAUA,UAAUA,UAAUx7B,SAASmR,KAAKC,MAAMi0D,QAAQ2B,wBAClEzoE,EACA1D,KAAKgzD,WACLhzD,KAAK+sE,UACL/sE,KAAKgmC,GACLhmC,KAAKimC,GACLjmC,KAAKoK,QAlCP,CAoCF,ECxLK,MAAM0gE,GAGXjrE,YAAY8gC,GAAuB,KAF5BA,eAAS,OACTljB,EAAc,IAAIpb,EAAAA,GAAS,EAAG,GAEnCrC,KAAK2gC,UAAYA,CACnB,CACOC,WAAWx/B,EAAWC,GAC3BrB,KAAKyd,EAAErc,EAAIA,EACXpB,KAAKyd,EAAEpc,EAAIA,EAEX,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAK2gC,UAAUx7B,SAAS8nE,cAAc/rE,SAAUD,EAElE,GAAIjB,KAAK2gC,UAAUx7B,SAAS8nE,cAAchsE,GAAGokE,SAASrlE,KAAKyd,GAGzD,OAAO,EAGX,OAAO,CACT,CACOoX,UAAUzzB,EAAWC,GAC1BrB,KAAKyd,EAAErc,EAAIA,EACXpB,KAAKyd,EAAEpc,EAAIA,EAEX,IAAK,IAAIJ,EAAI,EAAGA,EAAIjB,KAAK2gC,UAAUx7B,SAAS8nE,cAAc/rE,SAAUD,EAClEjB,KAAK2gC,UAAUx7B,SAAS8nE,cAAchsE,GAAGokE,SAASrlE,KAAKyd,EAE3D,EC1BK,MAAMwmD,GAGXpkE,YAAY8gC,GAAuB,KAF5BssC,cAAgC,GAAG,KACnCtsC,eAAS,EAEd3gC,KAAK2gC,UAAYA,CACnB,CACO4oC,eACLvpE,KAAKitE,cAAgB,EACvB,CACOC,aAAaxrE,EAAwBnB,GAC1C,IAAK,IAAIU,EAAI,EAAGA,EAAIS,EAAIR,SAAUD,EAChCjB,KAAKitE,cAAc9rE,KAAK,IAAI4pE,GAAarpE,EAAIT,GAAIV,GAErD,CACOkD,OAAOC,GACZ1D,KAAK2gC,UAAU4qC,KAAK9nE,OAAOC,EAM7B,EAGK,MAAMqnE,GAOXlrE,YAAYmzD,EAA6BzyD,GAAc,KANvDyyD,gBAAU,OACVhtB,GAAa,GAAS,KACtBC,GAAa,GAAS,KACtB77B,SAAU,EAAM,KACT7J,UAAI,OACHqC,IAAM,IAAIP,EAAAA,GAAS,EAAG,EAAG,GAE/BrC,KAAKgzD,WAAaA,EAClBhzD,KAAKO,KAAOA,EACZ,IAAK,IAAIU,EAAI,EAAGA,EAAIjB,KAAKgzD,WAAW9xD,SAAUD,EAC5CjB,KAAK4C,IAAIxB,GAAKpB,KAAKgzD,WAAW/xD,GAAG2B,IAAIxB,EACrCpB,KAAK4C,IAAIvB,GAAKrB,KAAKgzD,WAAW/xD,GAAG2B,IAAIvB,EAEvCrB,KAAK4C,IAAIxB,GAAKpB,KAAKgzD,WAAW9xD,OAC9BlB,KAAK4C,IAAIvB,GAAKrB,KAAKgzD,WAAW9xD,MAMhC,CACOmkE,SAAS5nD,GACd,OAAIvQ,EAAAA,EAAAA,IAAYlN,KAAK4C,IAAK6a,GAAKzd,KAAKimC,GAAK,GACvCjmC,KAAKoK,SAAU,GACR,IAETpK,KAAKoK,SAAU,GACR,EACT,CACOkM,KAAK5S,EAA+ByB,GACzC,GACEA,EAASw7B,UAAUA,UAAUA,UAAUx7B,SAASqwB,aAAahqB,wBAC1D8C,aAAa8b,eAChB,CACApqB,KAAK4C,IAAM,IAAIP,EAAAA,GAAS,EAAG,EAAG,GAC9B,IAAK,IAAIpB,EAAI,EAAGA,EAAIjB,KAAKgzD,WAAW9xD,SAAUD,EAC5CjB,KAAK4C,IAAIxB,GAAKpB,KAAKgzD,WAAW/xD,GAAG2B,IAAIxB,EACrCpB,KAAK4C,IAAIvB,GAAKrB,KAAKgzD,WAAW/xD,GAAG2B,IAAIvB,EAEvCrB,KAAK4C,IAAIxB,GAAKpB,KAAKgzD,WAAW9xD,OAC9BlB,KAAK4C,IAAIvB,GAAKrB,KAAKgzD,WAAW9xD,MAEhC,CACAiE,EAASw7B,UAAUA,UAAUA,UAAUx7B,SAASmR,KAAKC,MAAMi0D,QAAQ2B,wBACjEzoE,EACA1D,KAAKgzD,WACLhzD,KAAK4C,IACL5C,KAAKgmC,GACLhmC,KAAKimC,GACLjmC,KAAKoK,QAET,EC1EK,MAAM+iE,WAAkBhE,GAI7BtpE,YAAY8gC,GACVz7B,MAAMy7B,GAAW,KAJZt7B,iBAAW,OACXF,cAAQ,OACRomE,UAAI,EAGTvrE,KAAKqF,YAAc,IAAIylE,GAAY9qE,MACnCA,KAAKurE,KAAO,IAAIa,GAAKpsE,MACrBA,KAAKmF,SAAW,IAAI8+D,GAASjkE,KAC/B,CACO4gC,WAAWx/B,EAAWC,GAC3B,QAAIrB,KAAKqF,YAAYu7B,WAAWx/B,EAAGC,EAIrC,CACOwzB,UAAUzzB,EAAWC,GAC1BrB,KAAKqF,YAAYwvB,UAAUzzB,EAAGC,EAChC,CACOoC,OAAOC,GACZ1D,KAAKmF,SAAS1B,OAAOC,EACvB,CACOF,SAELxD,KAAKurE,KAAK/nE,QACZ,EC5BK,MAAMolE,WAAsBO,GACjCtpE,YAAY8gC,GACVz7B,MAAMy7B,EACR,CACOn9B,SACLxD,KAAK6oE,+BACP,CACQA,gCACN,IACE,IAAI5nE,EAAI,EACRA,EAAIjB,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAMq/C,WAAW9hD,SAClED,EACF,CACWjB,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAMq/C,WAAW/hD,GACxE+D,UAAUnC,OACf,CACA,IACE,IAAI5B,EAAI,EACRA,EAAIjB,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAM+hD,WAAWxkD,SAClED,EACF,CACWjB,KAAK2gC,UAAUA,UAAUx7B,SAASqwB,aAAa7xB,MAAM+hD,WAAWzkD,GACxE+D,UAAUnC,OACf,CACF,ECxBK,MAAMimE,WAAkBK,GAC7BtpE,YAAY8gC,GACVz7B,MAAMy7B,EACR,CACOn9B,SACLxD,KAAK+oE,+BACP,CACQA,gCACN,ECHG,MAAMqE,GAIXvtE,YAAY8gC,EAAsBpgC,GAAuB,KAHlDogC,eAAS,OACTsoC,qBAAe,OACdC,WAAK,EAEXlpE,KAAK2gC,UAAYA,EACjB3gC,KAAKO,KAAOA,CACd,CACWA,WACT,OAAOP,KAAKkpE,KACd,CACW3oE,SAAK2C,GAKd,OAJAlD,KAAKkpE,MAAQhmE,EACRlD,KAAK2gC,UAAUx7B,SAASqwB,aAAa3xB,gBAAgBC,IAAI43B,WAGtDx4B,GACN,KAAK6mD,EAAAA,GAAAA,KAEH,YADA/pD,KAAKipE,gBAAkB,IAAIH,GAAU9oE,OAEvC,KAAK+pD,EAAAA,GAAAA,KAEH,YADA/pD,KAAKipE,gBAAkB,IAAIkE,GAAUntE,OAEvC,KAAK+pD,EAAAA,GAAAA,UAEH,YADA/pD,KAAKipE,gBAAkB,IAAIR,GAAezoE,OAE5C,KAAK+pD,EAAAA,GAAAA,MACH,OACF,QAEE,YADA/pD,KAAKipE,gBAAkB,IAAIL,GAAc5oE,OAG/C,CACOwD,SACLxD,KAAKipE,gBAAgBzlE,QACvB,CACOC,OAAOC,GACR1D,KAAKipE,iBACPjpE,KAAKipE,gBAAgBxlE,OAAOC,EAEhC,CACOk9B,WAAWx/B,EAAWC,GAC3B,SAAIrB,KAAKipE,kBACHjpE,KAAKipE,gBAAgBroC,WAAWx/B,EAAGC,GAK3C,CACOwzB,UAAUzzB,EAAWC,GACtBrB,KAAKipE,iBACPjpE,KAAKipE,gBAAgBp0C,UAAUzzB,EAAGC,EAEtC,ECxDK,MAAMu5C,GAKX/6C,YAAYsF,GAAqB,KAJ1BA,cAAQ,OACPkoE,6BAAuB,OACvBC,oBAAc,OACdC,eAAiB,EAEvBvtE,KAAKmF,SAAWA,EAChBnF,KAAK8R,MACP,CACWy4C,yBACT,OAAOvqD,KAAKqtE,wBAAwB9sE,IACtC,CACWgqD,uBAAmBrnD,GAC5BlD,KAAKqtE,wBAAwB9sE,KAAO2C,CACtC,CACWmnD,gBACT,OAAOrqD,KAAKstE,eAAe/sE,IAC7B,CACW8pD,cAAUnnD,GACnBlD,KAAKstE,eAAe/sE,KAAO2C,CAC7B,CACQ4O,OACN9R,KAAKstE,eAAiB,IAAIF,GACxBptE,KACAA,KAAKmF,SAASqwB,aAAahqB,wBAAwB8C,aAAa87C,gBAElEpqD,KAAKqtE,wBAA0B,IAAIrE,GACjChpE,KACAA,KAAKmF,SAASqwB,aAAahqB,wBAAwB8C,aAAag8C,wBAEpE,CACO9mD,SACDxD,KAAKmF,SAASqwB,aAAahqB,wBAAwB8C,aAAayY,YAIlE/mB,KAAKmF,SAASqwB,aAAahqB,wBAAwB8C,aAAaoxB,wBAC9D1/B,KAAKutE,eAAiB,MAExBvtE,KAAKstE,eAAe9pE,SACpBxD,KAAKqtE,wBAAwB7pE,SAC7BxD,KAAKmF,SAASqwB,aAAahqB,wBAAwB8C,aAAaoxB,sBAAuB,EAE3F,CACOj8B,OAAOC,GACZ1D,KAAKstE,eAAe7pE,OAAOC,EAC7B,CACOk9B,WAAWx/B,EAAWC,GAC3B,QAAIrB,KAAKstE,eAAe1sC,WAAWx/B,EAAGC,EAIxC,CACOwzB,UAAUzzB,EAAWC,GAC1BrB,KAAKstE,eAAez4C,UAAUzzB,EAAGC,EACnC,ECxDK,MAAMmsE,GAGX3tE,YAAYsF,GAAqB,KAF1BA,cAAQ,OACL4pB,MAAQ,EAEhB/uB,KAAKmF,SAAWA,CAClB,CACOsoE,UAAU/pE,GASf,IARA1D,KAAKmF,SAASy8B,eAAen+B,OAAOC,GAGhC0iC,GAAAA,cACFA,GAAAA,aAAAA,WAAqC1iC,GAGvC1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMqhC,oBAAoB9jC,OAC3DlB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMqhC,oBAAoBhlC,KAAK+uB,OAAOtrB,OAAOC,GAI1E,IADA1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMotD,yBAAyB7vD,OAChElB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMotD,yBAAyB/wD,KAAK+uB,OAAOtrB,OAAOC,GAG/E,IADA1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMiuD,sBAAsB1wD,OAC7DlB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMiuD,sBAAsB5xD,KAAK+uB,OAAOtrB,OAAOC,GAI5E,IADA1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMmyB,0BAA0B50B,OACjElB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMmyB,0BAA0B91B,KAAK+uB,OAAOtrB,OAAOC,GAMhF,IAJI1D,KAAKmF,SAASqwB,aAAa7xB,MAAMoxB,0BACnC/0B,KAAKmF,SAASqwB,aAAa7xB,MAAMoxB,yBAAyBtxB,OAAOC,GAEnE1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAM+pE,0BAA0BxsE,OACjElB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAM+pE,0BAA0B1tE,KAAK+uB,OAAOtrB,OAAOC,GAGhF,IADA1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMgqE,cAAczsE,OACrDlB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMgqE,cAAc3tE,KAAK+uB,OAAOtrB,OAAOC,GAGpE,IADA1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMme,qBAAqB5gB,OAC5DlB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMme,qBAAqB9hB,KAAK+uB,OAAOtrB,OAAOC,GAI3E,IADA1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMmoC,WAAW5qC,OAClDlB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMmoC,WAAW9rC,KAAK+uB,OAAOtrB,OAAOC,GAGjE,IADA1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMqqC,WAAW9sC,OAClDlB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMqqC,WAAWhuC,KAAK+uB,OAAOtrB,OAAOC,GAOjE,IALIqqC,GAAOI,UAAUzsC,KACnBqsC,GAAOI,UAAUzsC,IAAI+B,OAAOC,GAG9B1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAM0nD,2BAA2BnqD,OAClElB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAM0nD,2BAA2BrrD,KAAK+uB,OAAOwmB,eAAe7xC,GAKzF,IADA1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMotD,yBAAyB7vD,OAChElB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMotD,yBAAyB/wD,KAAK+uB,OAAOwa,gBAAgB7lC,GAIxF,IADA1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMsY,WAAW/a,OAClDlB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMsY,WAAWjc,KAAK+uB,OAAOtrB,OAAOC,GAGjE,IADA1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAM+hD,WAAWxkD,OAClDlB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAM+hD,WAAW1lD,KAAK+uB,OAAOtrB,OAAOC,GAGjE,IADA1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAM2vD,WAAWpyD,OAClDlB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAM2vD,WAAWtzD,KAAK+uB,OAAOtrB,OAAOC,GAGjE,IADA1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMq/C,WAAW9hD,OAClDlB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAMq/C,WAAWhjD,KAAK+uB,OAAOtrB,OAAOC,GAOjE,IAJA1D,KAAKmF,SAASw7B,UAAUl9B,OAAOC,GAG/B1D,KAAK+uB,MAAQ/uB,KAAKmF,SAASqwB,aAAa7xB,MAAM0nD,2BAA2BnqD,OAClElB,KAAK+uB,SACV/uB,KAAKmF,SAASqwB,aAAa7xB,MAAM0nD,2BAA2BrrD,KAAK+uB,OAAOtrB,OAAOC,GAQjF,GAAI1D,KAAKmF,SAASqwB,aAAa3xB,gBAAgBC,IAAIC,WAAY,CAG7D,GAFAL,EAAIM,UAAY,UAChBN,EAAI3D,KAAI,aACJC,KAAKmF,SAASqwB,aAAa7xB,MAAMgP,QAAS,CAC5C,MAAMnO,EAAMxE,KAAKmF,SAASqwB,aAAa7xB,MAAMgP,QAAQ/P,IAC/C8B,EAAO1E,KAAKmF,SAASqwB,aAAa7xB,MAAMgP,QAAQpS,KACtDmD,EAAIkB,SAAS,GAAD,OAAIF,GAAQF,EAAIpD,EAAGoD,EAAInD,EAAI,GACzC,CAEA,MAAMusE,EAAS,GACTC,EAAS7tE,KAAKmF,SAASqwB,aAAa7xB,MAAMktD,aAAa3vD,OACvD4sE,EAAY9tE,KAAKmF,SAASqwB,aAAa7xB,MAAMsY,WAAW/a,OACxDyR,EAAU3S,KAAKmF,SAASqwB,aAAa7xB,MAAMmb,QAC7C9e,KAAKmF,SAASqwB,aAAa7xB,MAAMmb,QAAQve,UACzCoC,EACEmC,EAAW9E,KAAKmF,SAASqwB,aAAahqB,wBAAwB8C,aAAaE,SAC3Eu/D,EAAY/tE,KAAKmF,SAAS4oE,UAC1BhtC,EAAW/gC,KAAKmF,SAASqwB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eACnEgrB,eAAeC,SAClBr9B,EAAIkB,SAAS,eAAD,OACKipE,GAEb,GADF7tE,KAAKmF,SAASqwB,aAAa5mB,oBAAoBmD,cAAcC,QAAQtO,IAAIggC,OAAOpgC,MAE9E,IACFsqE,GAEFlqE,EAAIkB,SAAS,wBAAD,OACckpE,GAEtB,GADF9tE,KAAKmF,SAASqwB,aAAa5mB,oBAAoBmD,cAAcC,QAAQtO,IAAIggC,OAAOpgC,MAE9E,IACFsqE,EAAS,IAEXlqE,EAAIkB,SAAS,YAAD,OACE+N,GAEV,GADF3S,KAAKmF,SAASqwB,aAAa5mB,oBAAoBmD,cAAcC,QAAQtO,IAAIggC,OAAOpgC,MAE9E,EACFsqE,GAEFlqE,EAAIkB,SAAS,cAAD,OACIE,GAEZ,GADF9E,KAAKmF,SAASqwB,aAAa5mB,oBAAoBmD,cAAcC,QAAQtO,IAAIggC,OAAOpgC,MAE9E,IACA,EACFsqE,GAEFlqE,EAAIkB,SAAS,UAAD,OACAmpE,GAC8E,GAAxF/tE,KAAKmF,SAASqwB,aAAa5mB,oBAAoBmD,cAAcC,QAAQtO,IAAIggC,OAAOpgC,MACvE,EAATsqE,GAEFlqE,EAAIkB,SAAS,aAAD,OACGm8B,GAC2E,GAAxF/gC,KAAKmF,SAASqwB,aAAa5mB,oBAAoBmD,cAAcC,QAAQtO,IAAIggC,OAAOpgC,MACvE,EAATsqE,GAGF5tE,KAAKmF,SAASqwB,aAAahqB,wBAAwB0zB,UAAUz7B,OAAOC,EACtE,CACF,EClKK,MAAMsqE,GAIXnuE,YAAYsF,GAAqB,KAH1BA,cAAQ,OACR8oE,aAAO,OACPvqC,YAAM,EAEX1jC,KAAKmF,SAAWA,EAChBnF,KAAK0jC,OAASh4B,SAASC,cAAc,UACrC3L,KAAK0jC,OAAO93B,MAAMi1C,WAAa,UAC/B7gD,KAAK0jC,OAAO93B,MAAMC,SAAW,WAC7B,MAAMoiE,EAAUjuE,KAAK0jC,OAAOk4B,WAAW,MACnCqS,IACFjuE,KAAKiuE,QAAUA,EAGnB,CACOC,sBAAsBnwB,EAAuBtpC,GAMlDspC,EAAIua,YAAc,YAOlBt4D,KAAKiuE,QAAQ/oB,UAAUnH,EAAK,GAAI,GAqBlC,CACO9yB,iBACLvnB,EACA0U,EACAzN,EACAvJ,EACAC,EACA2kC,EACAC,EACA3gC,GAGA5B,EAAIO,YACJP,EAAIinB,QAAQvpB,EAAGC,EAAG2kC,EAAIC,EAAI,EAAG,EAAG,EAAI3zB,KAAK8Y,IAAI,GAC7C1nB,EAAIS,YAKJT,EAAIM,UAAY2G,EAEZrF,GACF5B,EAAIU,OAGNpE,KAAKmuE,oBAAoBzqE,EAAK0U,EAAIzN,EACpC,CACOwjE,oBAAoBzqE,EAA+B0U,EAAiBzN,GACzEjH,EAAImV,UAAYT,EAAGS,UAEnBnV,EAAI2c,YAAc1V,EAClBjH,EAAI8c,QACN,CACOgP,mBAAmB9rB,EAA+B+Q,EAAazT,GAEpE0C,EAAIO,YACJP,EAAI4c,OAAOtf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GAC1B,IAAK,IAAIJ,EAAI,EAAGA,EAAID,EAAGE,SAAUD,EAC/ByC,EAAI6c,OAAOvf,EAAGC,GAAGG,EAAGJ,EAAGC,GAAGI,GAE5BqC,EAAIM,UAAYyQ,EAChB/Q,EAAIS,YACJT,EAAIU,MAaN,CACO8sB,6BACLxtB,EACA0U,EACA3D,EACAyb,EACAC,EACAC,EACAC,EACAC,EACAC,GAEA7sB,EAAImV,UAAYT,EAAGS,UAAY,GAC/BnV,EAAI2c,YAAc5L,EAClB/Q,EAAIO,YACJP,EAAI4c,OAAO4P,EAAIC,GACfzsB,EAAI0qE,iBAAiBh+C,EAAIC,EAAIC,EAAIC,GACjC7sB,EAAI8c,SACJ9c,EAAIS,WACN,CAEOwnC,qBACLjoC,EACA0U,EACA3D,EACAyb,EACAC,EACAC,EACAC,EACAC,EACAC,EACA89C,EACAC,GAEA5qE,EAAImV,UAAYT,EAAGS,UAAY,GAC/BnV,EAAI2c,YAAc5L,EAClB/Q,EAAIO,YACJP,EAAI4c,OAAO4P,EAAIC,GACfzsB,EAAI6qE,cAAcn+C,EAAIC,EAAIC,EAAIC,EAAI89C,EAAIC,GACtC5qE,EAAI8c,SACJ9c,EAAIS,WACN,CACOsd,iBAAiB/d,EAA+B+Q,EAAazT,GAAyC,IAAzB6iD,EAAiB,uDAAG,GAEtGngD,EAAIM,UAAYyQ,EAChB/Q,EAAI2c,YAAc5L,EAClB/Q,EAAImV,UAAYgrC,EAChBngD,EAAIO,YACJP,EAAI4c,OAAOtf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GAC1B,IAAK,IAAIJ,EAAI,EAAGA,EAAID,EAAGE,SAAUD,EAC/ByC,EAAI6c,OAAOvf,EAAGC,GAAGG,EAAGJ,EAAGC,GAAGI,GAE5BqC,EAAIS,YACJT,EAAI8c,SACJ9c,EAAIU,MACN,CACOoqE,uBAAuB9qE,EAA+B+Q,EAAa0H,GAA0C,IAAzB0nC,EAAiB,uDAAG,GAC7GngD,EAAIM,UAAYyQ,EAChB/Q,EAAI2c,YAAc5L,EAClB/Q,EAAImV,UAAYgrC,EAChBngD,EAAIO,YACJP,EAAI4c,OAAOnE,EAAI,GAAG/a,EAAG+a,EAAI,GAAG9a,GAC5B,IAAK,IAAIJ,EAAI,EAAGA,EAAIkb,EAAIjb,SAAUD,EAChCyC,EAAI6c,OAAOpE,EAAIlb,GAAGG,EAAG+a,EAAIlb,GAAGI,GAE9BqC,EAAIS,YACJT,EAAI8c,SACJ9c,EAAIU,MACN,CACOqqE,6BACL/qE,EACA+Q,EACA0H,GAEA,IAAK,IAAIlb,EAAI,EAAGA,EAAIkb,EAAIjb,SAAUD,EAChCjB,KAAKwuE,uBAAuB9qE,EAAK+Q,EAAK0H,EAAIlb,GAE9C,CACOujD,gBAAgB9gD,EAA+B+Q,EAAavR,EAAa2B,GAqBvE,CACL,MAAMzD,EAAI8B,EAAE9B,EAAyE,GAArEpB,KAAKmF,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOjV,MACvEjC,EAAI6B,EAAE7B,EAAIrB,KAAKmF,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOhV,OAG7EG,EAAIO,YACJP,EAAIM,UAAYyQ,EAChB/Q,EAAIQ,KACF9C,EAAIpB,KAAKmF,SAASqwB,aAAa7xB,MAAM0lB,cAAcC,mBAAmBloB,GACE,GAArEpB,KAAKmF,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOjV,MACS,GAArEtD,KAAKmF,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOjV,MAAcuB,GAC/ExD,EAAIrB,KAAKmF,SAASqwB,aAAa7xB,MAAM0lB,cAAcC,mBAAmBjoB,GACnErB,KAAKmF,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOhV,OAC5DvD,KAAKmF,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOhV,OAASsB,GAC1E7E,KAAKmF,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOjV,MAAQuB,EACrE7E,KAAKmF,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOhV,OAASsB,GAExEnB,EAAIS,YACJT,EAAIU,MAEN,CACF,CACOsqE,0BACLhrE,EACA+Q,EACArT,EACAC,GAGC,IAFDmM,EAAM,uDAAG,EACTiyB,IAAI,yDAEJ,IAAKz/B,KAAKmF,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAChE,OAEF,IAAI+4B,EAAiB3uE,KAAKmF,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WACxE4iC,iBACC1X,EACFkvC,GAAkBnhE,EAElBmhE,GAAkBA,EAAiBnhE,EAqBnC9J,EAAIO,YACJP,EAAIM,UAAYyQ,EAChB/Q,EAAIQ,KACF9C,EACAC,EACArB,KAAKmF,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOjV,MAC7DtD,KAAKmF,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOhV,QAE/DG,EAAIS,YACJT,EAAIU,MAGR,ECpRK,MAAMwqE,GAIX/uE,YAAYyW,GAAa,KAHlBA,UAAI,OACJipC,WAAa,IAAI+iB,IAAsB,KACvC7iB,eAAc,GAEnBz/C,KAAKsW,KAAOA,CACd,CACOi4C,UAAUjuD,EAAYoO,GACtB1O,KAAKu/C,WAAWsvB,IAAIvuE,KACvBN,KAAKu/C,WAAWijB,IAAIliE,EAAIoO,GACxB1O,KAAKsW,KAAKnR,SAASqwB,aAAazrB,GAAGC,wBAAwBq3D,eAAe/gE,EAAIoO,GAOlF,CACO8/C,aAAaluD,GACdN,KAAKu/C,WAAWsvB,IAAIvuE,KACtBN,KAAKy/C,eAAiBn/C,EACtBN,KAAKsW,KAAKnR,SAASqwB,aAAahqB,wBAAwBohD,gBAAkB5sD,KAAKu/C,WAAWC,IACxFl/C,GAEFN,KAAKsW,KAAKnR,SAASqwB,aAAazrB,GAAGC,wBAAwBu3D,aAAajhE,GAE5E,ECxBK,MAAMwuE,GAGXjvE,YAAY0W,GAAqB,KAF1BA,WAAK,OACJwY,MAAQ,EAEd/uB,KAAKuW,MAAQA,CACf,CACOw4D,WAAWrrE,EAA+B0U,EAAiBhO,EAAkB5J,GAClFkD,EAAImV,UAAYT,EAAGS,UAAYT,EAAGzJ,WAAayJ,EAAGxK,YAG9C5N,KAAKuW,MAAMD,KAAKnR,SAASmP,YAAclK,EACzC1G,EAAI2c,YAAcjI,EAAGkC,wBAErB5W,EAAI2c,YAAcjI,EAAGqC,YAEnBja,IACFkD,EAAI2c,YAAcjI,EAAGqC,aAEvB/W,EAAI0c,YAAYhI,EAAGuC,MACnBjX,EAAI8c,SACJ9c,EAAI0c,YAAY,GAClB,CACO4uD,gBACLtrE,EACA0U,EACAhO,EACA5J,EACAgN,EACAnD,GAEA3G,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnCnB,EACAxN,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aAC5F/xB,EAAI2c,YAAcrgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BAI9FhyB,EAAIS,YAUJT,EAAI0c,YAAYhI,EAAGuC,MACnBjX,EAAI8c,SACJ9c,EAAI0c,YAAY,CAAC,EAAG,GACtB,CACOe,aACLzd,EACA0U,EACApX,EACAgG,EACAqD,GAIC,IAHDmD,EAAM,uDAAG,EACTpD,IAAO,yDACP5J,EAAmB,uCAInB,IAFAkD,EAAIO,YACJP,EAAI4c,OAAOtf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GACrBrB,KAAK+uB,MAAQ,EAAG/uB,KAAK+uB,MAAQ/tB,EAAGE,SAAUlB,KAAK+uB,MAClDrrB,EAAI6c,OAAOvf,EAAGhB,KAAK+uB,OAAO3tB,EAAGJ,EAAGhB,KAAK+uB,OAAO1tB,GAE9CrB,KAAKgvE,gBAAgBtrE,EAAK0U,EAAIhO,EAAS5J,EAAYgN,EAAQnD,EAC7D,CACOsgB,QAAQjnB,EAA+B0U,EAAiBhX,EAAWC,EAAW2kC,EAAYC,EAAY3gC,EAAiB8E,EAAkB5J,GAC9IkD,EAAIO,YACJP,EAAIinB,QAAQvpB,EAAGC,EAAG2kC,EAAIC,EAAI,EAAG,EAAG,EAAI3zB,KAAK8Y,IAAI,GAC7C1nB,EAAIS,YAMJT,EAAIM,UAAYoU,EAAGmC,UAEfva,KAAKuW,MAAMD,KAAKnR,SAASmP,UAC3B5Q,EAAIM,UAAYoU,EAAGkC,wBAIjB9Z,IACFkD,EAAIM,UAAYoU,EAAGkC,yBAUrBta,KAAK+uE,WAAWrrE,EAAK0U,EAAIhO,EAAS5J,EACpC,CACOyuE,iBACLvrE,EACA0U,EACAhX,EACAC,EACA2kC,EACAC,EACA3gC,EACA8E,EACA5J,GAGAkD,EAAIO,YACJP,EAAIinB,QAAQvpB,EAAGC,EAAG2kC,EAAIC,EAAI,EAAG,EAAG,EAAI3zB,KAAK8Y,IAAI,GAC7C1nB,EAAIS,YAEJ,MACM+qE,EAAcjpC,EAEdxxB,EAAM,CAAC,MAAW,MAAW,OAE7B06D,EAAWzrE,EAAI0rE,qBAAqBhuE,EAAGC,EALzB,EAKyCD,EAAGC,EAAG6tE,GACnEC,EAASE,aAAa,EAAE,QAAD,OAAU56D,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,WAC7D06D,EAASE,aAAa,EAAE,QAAD,OAAU56D,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,WAE7D/Q,EAAIM,UAAYmrE,EAChBzrE,EAAIU,MACN,CACOomB,aACL9mB,EACA0U,EACAhX,EACAC,EACA2kC,EACAC,EACAj/B,EACAqD,GAIC,IAHDmD,EAAM,uDAAG,EACTpD,IAAO,yDACP5J,EAAmB,yCAEnBkD,EAAIO,YACJP,EAAIinB,QAAQvpB,EAAGC,EAAG2kC,EAAIC,EAAI,EAAG,EAAG,EAAI3zB,KAAK8Y,IAAI,GAC7C1nB,EAAIS,YAEJnE,KAAKgvE,gBAAgBtrE,EAAK0U,EAAIhO,EAAS5J,EAAYgN,EAAQnD,EAC7D,CACOs0C,YACLj7C,EACA0U,EACApX,EACA2G,GAEC,IADD4kB,EAAI,uDAAG,EAGP,MAAMrb,EAASvJ,EACfjE,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnDjL,EAAI2c,YAAcjI,EAAGqC,YAErB/W,EAAIO,YAEJP,EAAI4c,OAAOtf,EAAG,GAAGI,EAAImrB,EAAOrb,EAAQlQ,EAAG,GAAGK,GAC1CqC,EAAI6c,OAAOvf,EAAG,GAAGI,EAAImrB,EAAOrb,EAAQlQ,EAAG,GAAGK,GAE1CqC,EAAI4rE,MAAMtuE,EAAG,GAAGI,EAAImrB,EAAMvrB,EAAG,GAAGK,EAAGL,EAAG,GAAGI,EAAImrB,EAAMvrB,EAAG,GAAGK,EAAI6P,EAAQA,GACrExN,EAAI6c,OAAOvf,EAAG,GAAGI,EAAImrB,EAAMvrB,EAAG,GAAGK,EAAI6P,GAErCxN,EAAI4rE,MAAMtuE,EAAG,GAAGI,EAAImrB,EAAMvrB,EAAG,GAAGK,EAAGL,EAAG,GAAGI,EAAImrB,EAAOrb,EAAQlQ,EAAG,GAAGK,EAAG6P,GACrExN,EAAI6c,OAAOvf,EAAG,GAAGI,EAAImrB,EAAOrb,EAAQlQ,EAAG,GAAGK,GAE1CqC,EAAI4rE,MAAMtuE,EAAG,GAAGI,EAAImrB,EAAMvrB,EAAG,GAAGK,EAAGL,EAAG,GAAGI,EAAImrB,EAAMvrB,EAAG,GAAGK,EAAI6P,EAAQA,GACrExN,EAAI6c,OAAOvf,EAAG,GAAGI,EAAImrB,EAAMvrB,EAAG,GAAGK,EAAI6P,GACrCxN,EAAI4rE,MAAMtuE,EAAG,GAAGI,EAAImrB,EAAMvrB,EAAG,GAAGK,EAAGL,EAAG,GAAGI,EAAImrB,EAAOrb,EAAQlQ,EAAG,GAAGK,EAAG6P,GAErExN,EAAI0c,YAAYhI,EAAGuC,MACnBjX,EAAI8c,SACJ9c,EAAI0c,YAAY,GAGlB,CACOmP,UAAU7rB,EAA+B0U,EAAiBpX,EAAgBupB,EAAcjlB,EAAiB8E,EAAkB5J,GAGhI,IAFAkD,EAAIO,YACJP,EAAI4c,OAAOtf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GACrBrB,KAAK+uB,MAAQ,EAAG/uB,KAAK+uB,MAAQ/tB,EAAGE,SAAUlB,KAAK+uB,MAClDrrB,EAAI6c,OAAOvf,EAAGhB,KAAK+uB,OAAO3tB,EAAGJ,EAAGhB,KAAK+uB,OAAO1tB,GAE9CqC,EAAIS,YAEJT,EAAIM,UAAYoU,EAAGmC,UAEfjV,IACEtF,KAAKuW,MAAMD,KAAKnR,SAASmP,UAC3B5Q,EAAIM,UAAYoU,EAAGkC,wBAIjB9Z,IACFkD,EAAIM,UAAYoU,EAAGkC,0BAUvBta,KAAK+uE,WAAWrrE,EAAK0U,EAAIhO,EAAS5J,EACpC,CACO8uB,eACL5rB,EACA0U,EACApX,EACAgG,EACAqD,GAIC,IAHDmD,EAAM,uDAAG,EACTpD,IAAO,yDACP5J,EAAmB,uCAInB,IAFAkD,EAAIO,YACJP,EAAI4c,OAAOtf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GACrBrB,KAAK+uB,MAAQ,EAAG/uB,KAAK+uB,MAAQ/tB,EAAGE,SAAUlB,KAAK+uB,MAClDrrB,EAAI6c,OAAOvf,EAAGhB,KAAK+uB,OAAO3tB,EAAGJ,EAAGhB,KAAK+uB,OAAO1tB,GAE9CrB,KAAKgvE,gBAAgBtrE,EAAK0U,EAAIhO,EAAS5J,EAAYgN,EAAQnD,EAC7D,CACOqP,QACLhW,EACA0U,EACApX,EACAuuE,EACAvoE,EACAqD,EACA/E,EACA8E,EACA5J,GAIA,IAFAkD,EAAIO,YACJP,EAAI4c,OAAOtf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GACrBrB,KAAK+uB,MAAQ,EAAG/uB,KAAK+uB,MAAQ/tB,EAAGE,SAAUlB,KAAK+uB,MAClDrrB,EAAI6c,OAAOvf,EAAGhB,KAAK+uB,OAAO3tB,EAAGJ,EAAGhB,KAAK+uB,OAAO1tB,GAmC9C,IAjCAqC,EAAIS,YAcAnE,KAAKuW,MAAMD,KAAKnR,SAASmP,UAC3B5Q,EAAIM,UAAYoU,EAAGkC,wBAIjB9Z,IACFkD,EAAIM,UAAYoU,EAAGkC,yBAWrB5W,EAAIO,YACJP,EAAI4c,OAAOtf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GACrBrB,KAAK+uB,MAAQ,EAAG/uB,KAAK+uB,MAAQ/tB,EAAGE,SAAUlB,KAAK+uB,MAClDrrB,EAAI6c,OAAOvf,EAAGhB,KAAK+uB,OAAO3tB,EAAGJ,EAAGhB,KAAK+uB,OAAO1tB,GAE9CqC,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WAW/C3O,KAAKuW,MAAMD,KAAKnR,SAASmP,YAAclK,EACzC1G,EAAI2c,YAAcjI,EAAGkC,wBAErB5W,EAAI2c,YAAcjI,EAAGqC,YAEnBja,IACFkD,EAAI2c,YAAcjI,EAAGqC,aAGvB/W,EAAI0c,YAAYhI,EAAGuC,MACf40D,GACF7rE,EAAI8c,SACJ9c,EAAIS,cAEJT,EAAIS,YACJT,EAAI8c,UAEN9c,EAAI0c,YAAY,GAClB,CACO6lD,kBACLviE,EACA0U,EACApX,EACAuuE,EACAvoE,EACAqD,GAIA,IAFA3G,EAAIO,YACJP,EAAI4c,OAAOtf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GACrBrB,KAAK+uB,MAAQ,EAAG/uB,KAAK+uB,MAAQ/tB,EAAGE,SAAUlB,KAAK+uB,MAClDrrB,EAAI6c,OAAOvf,EAAGhB,KAAK+uB,OAAO3tB,EAAGJ,EAAGhB,KAAK+uB,OAAO1tB,GAS9C,IANAqC,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAIS,YAGJT,EAAIO,YACJP,EAAI4c,OAAOtf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GACrBrB,KAAK+uB,MAAQ,EAAG/uB,KAAK+uB,MAAQ/tB,EAAGE,SAAUlB,KAAK+uB,MAClDrrB,EAAI6c,OAAOvf,EAAGhB,KAAK+uB,OAAO3tB,EAAGJ,EAAGhB,KAAK+uB,OAAO1tB,GAE9CqC,EAAI6c,OAAOvf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GAC1BqC,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnDjL,EAAI2c,YAAcjI,EAAGqC,YAEjB80D,GACF7rE,EAAI8c,SACJ9c,EAAIS,cAEJT,EAAIS,YACJT,EAAI8c,SAER,ECnVK,MAAMgvD,GAGX3vE,YAAY0W,GAAqB,KAF1BA,WAAK,OAKL41D,wBAA0B,SAC/BzoE,EACAsvD,EACApwD,EACAojC,EACAC,EACA77B,GAEI,IADJG,EAAC,uDAAG,EAEJ,MAAMi5C,EAAYwP,EAAW,GAAG3vD,eAAe1C,YAAY6Z,eAAewM,MAAM,KAC1ExM,EAAc,gBAAYgpC,EAAU,GAAGx8B,MAC3C,KACA,GAAE,cAAMw8B,EAAU,GAAE,cAAMA,EAAU,GAAE,eAAOA,EAAU,GAAGx8B,MAAM,KAAK,GAAK,IAAOzc,EAAC,KAC9EklE,EAAYzc,EAAW,GAAG3vD,eAAe1C,YAAY2Z,wBAG3D,GAAIlQ,EACF,IAAK,IAAInJ,EAAI,EAAGA,EAAI+xD,EAAW9xD,SAAUD,EACvCyC,EAAImV,UAAY,GAChBnV,EAAI2c,YAAc2yC,EAAW,GAAG3vD,eAAe1C,YAAY4Z,UAC3D7W,EAAIO,YACJP,EAAI4c,OAAO1d,EAAIxB,EAAGwB,EAAIvB,GACtBqC,EAAI6c,OAAOyyC,EAAW/xD,GAAG2B,IAAIxB,EAAG4xD,EAAW/xD,GAAG2B,IAAIvB,GAClDqC,EAAIS,YACJT,EAAI8c,SAGJ9c,EAAImV,UAAY,EAChBnV,EAAI2c,YAAc,yBAClB3c,EAAIM,UAAYgvD,EAAW,GAAG3vD,eAAe1C,YAAY4Z,UACzD7W,EAAIO,YACJP,EAAIe,IAAIuuD,EAAW/xD,GAAG2B,IAAIxB,EAAG4xD,EAAW/xD,GAAG2B,IAAIvB,EAAG,EAAG,EAAa,EAAViR,KAAK8Y,IAC7D1nB,EAAIS,YACJT,EAAIU,OACJV,EAAI8c,SAKJpW,GACF1G,EAAIM,UAAYgvD,EAAW,GAAG3vD,eAAe1C,YAAY4Z,UACzD7W,EAAIO,YACJP,EAAIe,IAAI7B,EAAIxB,EAAGwB,EAAIvB,EAAG,IAAK,EAAa,EAAViR,KAAK8Y,IACnC1nB,EAAIS,YACJT,EAAIU,SAOJV,EAAIO,YACJP,EAAIe,IAAI7B,EAAIxB,EAAGwB,EAAIvB,EAAG4kC,EAAI,EAAa,EAAV3zB,KAAK8Y,IAClC1nB,EAAIS,YACJT,EAAIM,UAAYwW,EAChB9W,EAAIU,OACJV,EAAIO,YACJP,EAAIe,IAAI7B,EAAIxB,EAAGwB,EAAIvB,EAAG2kC,EAAI,EAAa,EAAV1zB,KAAK8Y,IAClC1nB,EAAIS,YACJT,EAAIM,UAAYyrE,EAChB/rE,EAAIU,OAEJV,EAAIM,UAAS,yBACbN,EAAI3D,KAAO,kBAEX2D,EAAI8b,UAAY,SAChB9b,EAAIkB,SAAS,GAAD,OAAIouD,EAAW9xD,QAAU0B,EAAIxB,EAAGwB,EAAIvB,EAAI,GAExD,EAtEErB,KAAKuW,MAAQA,CACf,ECAK,MAAMm5D,GAGX7vE,YAAY0W,GAAqB,KAF1BA,WAAK,OACJwY,MAAQ,EAEd/uB,KAAKuW,MAAQA,CACf,CACO02B,oBACLvpC,EACA0U,EACAu3D,EACAC,EACA1/C,EACAC,EACAwc,EACAkjC,EACAzlE,EACApD,EACAqD,GAIC,IAFD7J,EAAmB,yCACnBwW,EAA0B,yCAE1B,MAAM84D,GAASC,EAAAA,EAAAA,KAAkChgE,EAAAA,EAAAA,IAAS4/D,IAAO5/D,EAAAA,EAAAA,IAAS6/D,IAC1ElsE,EAAI+nC,OACJ/nC,EAAI6P,UAAU2c,EAAIC,GAClBzsB,EAAIs6C,QAAU8xB,EAASx9D,KAAK8Y,GAAM,KAElC,MAAM7nB,EACJ,IACAvD,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6J,MAAM1U,MACvEgrE,EACIG,GACH,GACDhwE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6J,MAAM1U,MACvEgrE,EAoDF,GApCAnsE,EAAIO,YACJP,EAAI4c,OAAO,EAAG,GACd5c,EAAI6c,QAASyvD,EAAQrjC,GAAcppC,EAASopC,GAC5CjpC,EAAI6c,QAASyvD,EAAQrjC,EAAappC,EAASopC,GAE3CjpC,EAAIS,YAEJT,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WAgB/C3O,KAAKuW,MAAMD,KAAKnR,SAASmP,YAAclK,GACzC1G,EAAIM,UAAYoU,EAAGoC,eACnB9W,EAAI2c,YAAcjI,EAAGkC,0BAErB5W,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAI2c,YAAcjI,EAAGkC,yBAGnB9Z,IACFkD,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAI2c,YAAcjI,EAAGkC,yBAGnBlQ,GAIE4M,IAAiBM,EAAa2gC,gBAAiB,CACjD,MAAM3/B,GAAQF,EAAGqC,YAAYuM,MAAM,KAAK,GAEtCtjB,EAAI2c,YADF/H,EAAO,GACS,2BAEA,oBAEtB,CAIF5U,EAAI8c,SACJ9c,EAAIU,OACJV,EAAIgoC,SACN,CACOsB,oBACLtpC,EACA0U,EACA8X,EACAC,EACAC,EACAC,EACAC,EACAC,EACAnmB,EACAsV,EACA1Y,EACAqD,GAOC,IALD7J,EAAmB,yCAGnB2f,EAAc,0DAAG,EA4BjBzc,EAAIyc,eAAiBA,EAErBzc,EAAI0c,YAAYhI,EAAGuC,MASnBjX,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnDjL,EAAIO,YACJP,EAAI4c,OAAOgQ,EAAIC,GACf7sB,EAAI0qE,iBAAiBh+C,EAAIC,EAAIH,EAAIC,GAc7BnwB,KAAKuW,MAAMD,KAAKnR,SAASmP,UAC3B5Q,EAAI2c,YAAcjI,EAAGkC,wBAInB9Z,IACFkD,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAI2c,YAAcjI,EAAGkC,yBAGvB5W,EAAI8c,SACJ9c,EAAI0c,YAAY,GAClB,CACO6vD,eACLvsE,EACA0U,EACApX,EACA6D,EACAmC,EACAqD,GAIC,IAHDmD,EAAM,uDAAG,EACTpD,IAAO,yDACP5J,EAAmB,uCAEnB,IAAKR,KAAK+uB,MAAQ,EAAG/uB,KAAK+uB,MAAQ/tB,EAAGE,SAAUlB,KAAK+uB,MAClD/uB,KAAKuW,MAAMC,KAAKA,KAAK9S,EAAK0U,EAAIpX,EAAGhB,KAAK+uB,OAAO3tB,EAAGJ,EAAGhB,KAAK+uB,OAAO1tB,EAAGwD,GAEpE7E,KAAKuW,MAAM2K,KAAK8tD,gBAAgBtrE,EAAK0U,EAAIhO,EAAS5J,EAAYgN,EAAQnD,EACxE,CACO4mB,eACLvtB,EACA0U,EACA8X,EACAC,EACAC,EACAC,EACAC,EACAC,GAGC,IADD/vB,EAAmB,uCAEnBkD,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WAQ/C3O,KAAKuW,MAAMD,KAAKnR,SAASmP,UAC3B5Q,EAAI2c,YAAcjI,EAAGkC,wBAInB9Z,IACFkD,EAAI2c,YAAcjI,EAAGkC,yBAIvB5W,EAAIO,YACJP,EAAI4c,OAAO4P,EAAIC,GACfzsB,EAAI0qE,iBAAiBh+C,EAAIC,EAAIC,EAAIC,GAEjC7sB,EAAI8c,QAEN,CACOwQ,wBACLttB,EACA0U,EACA8X,EACAC,EACAC,EACAC,EACAC,EACAC,GAIC,IAHD/iB,EAAM,uDAAG,EAIT9J,EAAImV,UACFrL,EACA4K,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnC3O,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aAC9E/xB,EAAI2c,YAAcrgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BAE9FhyB,EAAIO,YACJP,EAAI4c,OAAO4P,EAAIC,GACfzsB,EAAI0qE,iBAAiBh+C,EAAIC,EAAIC,EAAIC,GACjC7sB,EAAI8c,QACN,CACO8qB,YACL5nC,EACA0U,EACA8X,EACAC,EACAC,EACAC,EACAC,EACAC,EACA89C,EACAC,EACAlkE,EACA5J,GAEAkD,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WAa/C3O,KAAKuW,MAAMD,KAAKnR,SAASmP,YAAclK,GACzC1G,EAAIM,UAAYoU,EAAGoC,eACnB9W,EAAI2c,YAAcjI,EAAGkC,0BAErB5W,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAI2c,YAAcjI,EAAGkC,yBAEnB9Z,IACFkD,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAI2c,YAAcjI,EAAGkC,yBAEvB5W,EAAIO,YACJP,EAAI4c,OAAO4P,EAAIC,GACfzsB,EAAI6qE,cAAcn+C,EAAIC,EAAIC,EAAIC,EAAI89C,EAAIC,GACtC5qE,EAAI8c,QACN,CACO0vD,iBACLxsE,EACA0U,EACA8X,EACAC,EACAC,EACAC,EACAC,EACAC,EACA89C,EACAC,GAEA5qE,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WAEnDjL,EAAI2c,YAAcjI,EAAGkC,wBAErB5W,EAAIO,YACJP,EAAI4c,OAAO4P,EAAIC,GACfzsB,EAAI6qE,cAAcn+C,EAAIC,EAAIC,EAAIC,EAAI89C,EAAIC,GAEtC5qE,EAAI8c,QAEN,CACO4qB,yBACL1nC,EACA0U,EACA8X,EACAC,EACAC,EACAC,EACAC,EACAC,EACA89C,EACAC,EACA9gE,GAGA9J,EAAImV,UACFrL,EACA4K,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnC3O,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aAE9E/xB,EAAI2c,YAAcjI,EAAGkC,wBACrB5W,EAAIO,YACJP,EAAI4c,OAAO4P,EAAIC,GACfzsB,EAAI6qE,cAAcn+C,EAAIC,EAAIC,EAAIC,EAAI89C,EAAIC,GACtC5qE,EAAI8c,QACN,CACO0qB,kBACLxnC,EACA0U,EACA8X,EACAC,EACAC,EACAC,EACAC,EACAC,EACA89C,EACAC,EACAlkE,EACA5J,GAEAkD,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WAa/C3O,KAAKuW,MAAMD,KAAKnR,SAASmP,YAAclK,GACzC1G,EAAIM,UAAYoU,EAAGoC,eACnB9W,EAAI2c,YAAcjI,EAAGkC,0BAErB5W,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAI2c,YAAcjI,EAAGkC,yBAEnB9Z,IACFkD,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAI2c,YAAcjI,EAAGkC,yBAEvB5W,EAAIO,YACJP,EAAI4c,OAAO4P,EAAIC,GACfzsB,EAAI6qE,cAAcn+C,EAAIC,EAAIC,EAAIC,EAAI89C,EAAIC,GACtC5qE,EAAI8c,QACN,CACOyqB,8BACLvnC,EACA0U,EACA8X,EACAC,EACAC,EACAC,EACAC,EACAC,EACA89C,EACAC,EACA9gE,GAEA9J,EAAImV,UACFrL,EACA4K,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnC3O,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aAE9E/xB,EAAI2c,YAAcjI,EAAGkC,wBAErB5W,EAAIO,YACJP,EAAI4c,OAAO4P,EAAIC,GACfzsB,EAAI6qE,cAAcn+C,EAAIC,EAAIC,EAAIC,EAAI89C,EAAIC,GACtC5qE,EAAI8c,QAGN,CACO+qB,sBACL7nC,EACA0U,EACA8X,EACAC,EACAC,EACAC,EACAC,EACAC,EACA89C,EACAC,GAGA5qE,EAAI2c,YAAcjI,EAAGkC,wBACrB5W,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WAGnDjL,EAAI6qE,cAAcn+C,EAAIC,EAAIC,EAAIC,EAAI89C,EAAIC,EAIxC,CACOjjC,4BACL3nC,EACA0U,EACA8X,EACAC,EACAC,EACAC,EACAC,EACAC,EACA/iB,GAEA9J,EAAImV,UACFrL,EACA4K,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnC3O,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aAE9E/xB,EAAI2c,YAAcjI,EAAGkC,wBAErB5W,EAAIO,YACJP,EAAI4c,OAAO4P,EAAIC,GACfzsB,EAAI0qE,iBAAiBh+C,EAAIC,EAAIC,EAAIC,GAEjC7sB,EAAI8c,QACN,CACOsqB,gBACLpnC,EACA0U,EACAhX,EACAC,EACA8uE,EACAC,GAGA1sE,EAAImV,UAAY,EAAIT,EAAGxK,YAAcwK,EAAGzJ,WACpC3O,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAW+E,SAC9E5V,EAAI2c,YAAcjI,EAAGqC,YAIvB/W,EAAIO,YACJP,EAAI4c,OAAOlf,EAAGC,GACdqC,EAAI6c,OAAO4vD,EAAIC,GACf1sE,EAAIS,YACJT,EAAI8c,SACJ9c,EAAIgoC,SACN,EClfK,MAAM2kC,GAGXxwE,YAAY0W,GAAqB,KAF1BA,WAAK,OACJwY,MAAQ,EAEd/uB,KAAKuW,MAAQA,CACf,CACO6jC,eAAe12C,EAA+BR,EAAeooB,EAAiBzS,GACnFnV,EAAIm4D,yBAA2ByU,EAAAA,GAAAA,OAC/B,MAAM77D,EAAG,eAAW6W,EAAM,GAAE,YAAIA,EAAM,GAAE,YAAIA,EAAM,GAAE,IAAI,IAAI,KAO5D,IANA5nB,EAAIM,UAAYyQ,EAChB/Q,EAAI2c,YAAc5L,EAClB/Q,EAAImV,UAAYA,EAEhBnV,EAAIO,YACJP,EAAI4c,OAAOpd,EAAE,GAAG9B,EAAG8B,EAAE,GAAG7B,GACnBrB,KAAK+uB,MAAQ,EAAG/uB,KAAK+uB,MAAQ7rB,EAAEhC,SAAUlB,KAAK+uB,MACjDrrB,EAAI6c,OAAOrd,EAAElD,KAAK+uB,OAAO3tB,EAAG8B,EAAElD,KAAK+uB,OAAO1tB,GAO5C,IALAqC,EAAI8c,SAKCxgB,KAAK+uB,MAAQ,EAAG/uB,KAAK+uB,MAAQ7rB,EAAEhC,SAAUlB,KAAK+uB,MACjDrrB,EAAIO,YACJP,EAAIe,IAAIvB,EAAElD,KAAK+uB,OAAO3tB,EAAG8B,EAAElD,KAAK+uB,OAAO1tB,EAAG,EAAG,EAAG,EAAIiR,KAAK8Y,IAAI,GAC7D1nB,EAAIS,YACJT,EAAI8c,SAEN9c,EAAIm4D,yBAA2ByU,EAAAA,GAAAA,UACjC,EC1BK,MAAMC,GAGX1wE,YAAY0W,GAAqB,KAF1BA,WAAK,OACJwY,MAAQ,EAEd/uB,KAAKuW,MAAQA,CACf,CACOwK,KACLrd,EACA0U,EACA8X,EACAC,EACAC,EACAC,EACAmgD,GAGA,IAAI3rE,EAAQuT,EAAGS,UACX23D,IAEF3rE,EAAQ7E,KAAKuW,MAAMD,KAAKnR,SAASuR,gBAAgB7R,MAAMA,IAIzDnB,EAAIO,YACJP,EAAI4c,OAAO4P,EAAIC,GACfzsB,EAAI6c,OAAO6P,EAAIC,GACf3sB,EAAIS,YACJT,EAAImV,UAAYhU,EAEhBnB,EAAI2c,YAAcjI,EAAGqC,YACrB/W,EAAI8c,QACN,CACOiwD,eAAe/sE,EAA+B0U,EAAiBpX,GAIpE,IAFA0C,EAAIwnB,YAAc,EAClBxnB,EAAIm4D,yBAA2ByU,EAAAA,GAAAA,OAC1BtwE,KAAK+uB,MAAQ,EAAG/uB,KAAK+uB,MAAQ/tB,EAAGE,OAAS,EAAGlB,KAAK+uB,OAAS,EAC7DrrB,EAAIO,YAEJP,EAAI4c,OAAOtf,EAAGhB,KAAK+uB,MAAQ,GAAG3tB,EAAGJ,EAAGhB,KAAK+uB,MAAQ,GAAG1tB,GACpDqC,EAAI6c,OAAOvf,EAAGhB,KAAK+uB,OAAO3tB,EAAGJ,EAAGhB,KAAK+uB,OAAO1tB,GAI5CqC,EAAImV,UAA2B,IAAfT,EAAGS,UAAmBT,EAAGxK,YAAcwK,EAAGzJ,WAM1DjL,EAAI2c,YAAcjI,EAAGqC,YACrB/W,EAAI8c,SACJ9c,EAAIS,YAENT,EAAIm4D,yBAA2ByU,EAAAA,GAAAA,UACjC,CACOt3D,SACLtV,EACA0U,EACApX,EACAgG,EACAqD,EACAD,EACA5J,GAcA,IAZAkD,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WAC/C3O,KAAKuW,MAAMD,KAAKnR,SAASmP,YAAclK,EACzC1G,EAAI2c,YAAcjI,EAAGsC,iBAErBhX,EAAI2c,YAAcjI,EAAGqC,YAEnBja,IACFkD,EAAI2c,YAAcjI,EAAGqC,aAGvB/W,EAAIO,YACJP,EAAI4c,OAAOtf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GACrBrB,KAAK+uB,MAAQ,EAAG/uB,KAAK+uB,MAAQ/tB,EAAGE,SAAUlB,KAAK+uB,MAClDrrB,EAAI6c,OAAOvf,EAAGhB,KAAK+uB,OAAO3tB,EAAGJ,EAAGhB,KAAK+uB,OAAO1tB,GAE9CqC,EAAI8c,SACJ9c,EAAIS,WACN,CACO6c,cACLtd,EACA0U,EACApX,EACAgG,EACAqD,GAGC,IAFDmD,EAAM,uDAAG,EAUT,IAPA9J,EAAImV,UACFrL,EACA4K,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnC3O,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aAC9E/xB,EAAI2c,YAAcjI,EAAGsC,iBACrBhX,EAAIO,YACJP,EAAI4c,OAAOtf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GACrBrB,KAAK+uB,MAAQ,EAAG/uB,KAAK+uB,MAAQ/tB,EAAGE,SAAUlB,KAAK+uB,MAClDrrB,EAAI6c,OAAOvf,EAAGhB,KAAK+uB,OAAO3tB,EAAGJ,EAAGhB,KAAK+uB,OAAO1tB,GAE9CqC,EAAI8c,SACJ9c,EAAI0c,YAAYhI,EAAGuC,MACnBjX,EAAIS,YACJT,EAAI0c,YAAY,CAAC,EAAG,GACtB,CACOgT,kBAAkB1vB,EAA+B0U,EAAiB8X,EAAYC,EAAYC,EAAYC,GAAkE,IAAtD7iB,EAAM,uDAAG,EAChI9J,EAAImV,UAAYrL,EAAS4K,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WAAa3O,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aACrJ/xB,EAAI2c,YAAcrgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BAG9FhyB,EAAIO,YACJP,EAAI4c,OAAO4P,EAAIC,GACfzsB,EAAI6c,OAAO6P,EAAIC,GACf3sB,EAAIS,YACJT,EAAI0c,YAAYhI,EAAGuC,MACnBjX,EAAI8c,SACJ9c,EAAI0c,YAAY,CAAC,EAAG,GACtB,CACOiT,yBAAyB3vB,EAA+B0U,EAAiBqO,GAC9E/iB,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnDjL,EAAI2c,YAAcjI,EAAGqC,YACrB/W,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAIO,YACJP,EAAIe,IACFgiB,EAAGrlB,EACHqlB,EAAGplB,EACHrB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa8G,KAAKM,QACtE,EACA,MAEFpT,EAAIS,YACJT,EAAI0c,YAAYhI,EAAGuC,MACnBjX,EAAI8c,SACJ9c,EAAI0c,YAAY,CAAC,EAAG,GACtB,CACO0lD,mBAAmBpiE,EAA+B0U,EAAiBpX,EAAgBa,EAAkB0tE,EAAkBvoE,EAAsBqD,GAClJ3G,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnDjL,EAAI2c,YAAcjI,EAAGqC,YACrB/W,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAIO,YACJP,EAAI4c,OAAOtf,EAAG,GAAGI,EAAIS,EAAO,GAAIb,EAAG,GAAGK,EAAIQ,EAAO,IACjD,IAAK,IAAIZ,EAAI,EAAGA,EAAID,EAAGE,SAAUD,EAC/ByC,EAAI6c,OAAOvf,EAAGC,GAAGG,EAAIS,EAAO,GAAIb,EAAGC,GAAGI,EAAGQ,EAAO,IAIhD6B,EAAI8c,QAIR,CACO4U,eAAe1xB,EAA+B0U,EAAiBxV,EAAiB8tE,EAAoBC,GACzGjtE,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnDjL,EAAI2c,YAAcjI,EAAGqC,YACrB/W,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAIO,YACJP,EAAI4c,OAAO1d,EAAI,GAAGxB,EAAGwB,EAAI,GAAGvB,GAC5B,IAAK,IAAIJ,EAAI,EAAGA,EAAI2B,EAAI1B,SAAUD,EAChCyC,EAAI6c,OAAO3d,EAAI3B,GAAGG,EAAGwB,EAAI3B,GAAGI,GAE9BqC,EAAI6c,OAAOmwD,EAAStvE,EAAGsvE,EAASrvE,GAEhCqC,EAAI8c,SAEAmwD,IAAUvkE,EAAAA,GAAAA,eACZ1I,EAAIU,MAkBR,CACOixB,cAAc3xB,EAA+B0U,EAAiBxV,EAAiB8tE,EAAoBC,GACxGjtE,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnDjL,EAAI2c,YAAcjI,EAAGqC,YACrB/W,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAIO,YACJP,EAAI4c,OAAO1d,EAAI,GAAGxB,EAAGwB,EAAI,GAAGvB,GAC5B,IAAK,IAAIJ,EAAI,EAAGA,EAAI2B,EAAI1B,SAAUD,EAChCyC,EAAI6c,OAAO3d,EAAI3B,GAAGG,EAAGwB,EAAI3B,GAAGI,GAE9BqC,EAAI6c,OAAOmwD,EAAStvE,EAAGsvE,EAASrvE,GAEhCqC,EAAIS,YACJT,EAAI8c,QAEN,CACOyH,QACLvkB,EACA0U,EACA8X,EACAC,EACAC,EACAC,EACAjM,GAEA,MAAMhjB,EAAI8uB,EAAiB,IAAXE,EAAKF,GACf7uB,EAAI8uB,EAAiB,IAAXE,EAAKF,GAEf2/C,GAASC,EAAAA,EAAAA,KACbhgE,EAAAA,EAAAA,IAAS,IAAI1N,EAAAA,GAAS6tB,EAAIC,KAC1BpgB,EAAAA,EAAAA,IAAS,IAAI1N,EAAAA,GAAS+tB,EAAIC,KAK5B3sB,EAAI6P,UAAUnS,EAAGC,GACjBqC,EAAIs6C,QAAS8xB,EAASx9D,KAAK8Y,GAAM,KAG7BprB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAW+E,SAC9E5V,EAAIM,UAAYogE,EAAAA,GAAAA,MAEhB1gE,EAAIM,UAAYogE,EAAAA,GAAAA,MAElB1gE,EAAIktE,aAAe,SACnBltE,EAAI8b,UAAY,SAQhB9b,EAAIkB,SAASwf,EAAIH,QAAQ,GAAGlR,WALf,GAKkC,GAAI,IACnDrP,EAAImtE,aAAa,EAAG,EAAG,EAAG,EAAG,EAAG,EAwBlC,EC7QK,MAAMC,GAGXjxE,YAAY0W,GAAqB,KAF1BA,WAAK,EAGVvW,KAAKuW,MAAQA,CACf,CACOmxB,KAAKhkC,EAA+ByY,EAAiB1b,EAAiBD,GAE3EkD,EAAIwnB,YAAc,EAElBxnB,EAAIO,YACJP,EAAI4c,OAAOnE,EAAI,GAAG/a,EAAG+a,EAAI,GAAG9a,GAC5B,IAAK,IAAIJ,EAAI,EAAGA,EAAIkb,EAAIjb,SAAUD,EAChCyC,EAAI6c,OAAOpE,EAAIlb,GAAGG,EAAG+a,EAAIlb,GAAGI,GAG9BqC,EAAIS,YAGJT,EAAIO,YACJP,EAAI4c,OAAOnE,EAAI,GAAG/a,EAAG+a,EAAI,GAAG9a,GAC5B,IAAK,IAAIJ,EAAI,EAAGA,EAAIkb,EAAIjb,SAAUD,EAChCyC,EAAI6c,OAAOpE,EAAIlb,GAAGG,EAAG+a,EAAIlb,GAAGI,GAI9BqC,EAAIS,YACJT,EAAI8c,QASN,CACOmnB,MAAMjkC,EAA+ByY,EAAe1b,EAAiBD,GAE1EkD,EAAIwnB,YAAc,EAElBxnB,EAAIO,YACJP,EAAI4c,OAAOnE,EAAI,GAAGvZ,IAAIxB,EAAG+a,EAAI,GAAGvZ,IAAIvB,GACpC,IAAK,IAAIJ,EAAI,EAAGA,EAAIkb,EAAIjb,SAAUD,EAChCyC,EAAI6c,OAAOpE,EAAIlb,GAAG2B,IAAIxB,EAAG+a,EAAIlb,GAAG2B,IAAIvB,GAEtC,MAAMsJ,EAAI3K,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAagK,QACxEjB,oBACH/U,EAAIM,UAAS,eAAW2G,EAAE,GAAE,YAAIA,EAAE,GAAE,YAAIA,EAAE,GAAE,YAAIA,EAAE,GAAE,KACpDjH,EAAIS,YACJT,EAAIU,OAEJV,EAAIO,YACJP,EAAI4c,OAAOnE,EAAI,GAAGvZ,IAAIxB,EAAG+a,EAAI,GAAGvZ,IAAIvB,GACpC,IAAK,IAAIJ,EAAI,EAAGA,EAAIkb,EAAIjb,SAAUD,EAChCyC,EAAI6c,OAAOpE,EAAIlb,GAAG2B,IAAIxB,EAAG+a,EAAIlb,GAAG2B,IAAIvB,GAItCqC,EAAIS,YACJT,EAAI8c,QASN,ECtEK,MAAMuwD,GAGXlxE,YAAY0W,GAAqB,KAF1BA,WAAK,EAGVvW,KAAKuW,MAAQA,CACf,CACOE,aACL/S,EACA0U,EACAhX,EACAC,EACAwD,EACA20B,GACQ,yDAGN91B,EAAImV,UAAYT,EAAGS,UACnBnV,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAI2c,YAAcjI,EAAGqC,YACrB/W,EAAIO,YACAu1B,EAAK,GACP91B,EAAIe,IACFrD,EACAC,GACCiR,KAAKyS,IAAI/kB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa8G,KAAKM,SAC9E,GACAjS,EACF,EACA,EAAIyN,KAAK8Y,IACT,GAGF1nB,EAAIe,IACFrD,EACAC,EACAiR,KAAKyS,IACH/kB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa8G,KAAKM,QAAU,GAEhFjS,EACA20B,EACF,EACA,EAAIlnB,KAAK8Y,IACT,KAIJ1nB,EAAImV,UAAYT,EAAGS,UACnBnV,EAAIM,UAAYoU,EAAGqC,YACnB/W,EAAI2c,YAAcjI,EAAGsC,iBACrBhX,EAAIO,YACAu1B,EAAK,GACP91B,EAAIe,IACFrD,EACAC,GACCiR,KAAKyS,IAAI/kB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa8G,KAAKM,SAC9E,GACAjS,EACF,EACA,EAAIyN,KAAK8Y,IACT,GAGF1nB,EAAIe,IACFrD,EACAC,EACAiR,KAAKyS,IAAI/kB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa8G,KAAKM,SAC7EjS,EACA20B,EACF,EACA,EAAIlnB,KAAK8Y,IACT,IAIN1nB,EAAIS,YACJT,EAAIU,OACJV,EAAI8c,QACN,CACO3J,qBACLnT,EACA0U,EACAhX,EACAC,EACAm4B,EACA30B,GAGC,IAFDmsE,EAAQ,wDACRh6D,EAA2B,uCAI3B,GAFAtT,EAAIO,YACJP,EAAImV,UAAYT,EAAGS,UACfm4D,EAmBF,OATAttE,EAAIM,UAAYoU,EAAGmC,UAEfif,EAAK,GACP91B,EAAIe,IAAIrD,EAAGC,EAAGwD,EAAO,EAAG,EAAIyN,KAAK8Y,IAAI,GAErC1nB,EAAIe,IAAIrD,EAAGC,EAAGwD,EAAQ20B,EAAI,EAAG,EAAIlnB,KAAK8Y,IAAI,GAE5C1nB,EAAIU,YACJV,EAAIS,YAMN,GAHAT,EAAIM,UAAYoU,EAAGqC,YACnB/W,EAAI2c,YAAcjI,EAAGsC,iBAEjB1D,IAAiBM,EAAa2gC,gBAAiB,CACjD,MAAM3/B,GAAQF,EAAGqC,YAAYuM,MAAM,KAAK,GAEtCtjB,EAAI2c,YADF/H,EAAO,GACS,2BAEA,oBAEtB,CAEIkhB,EAAK,GACP91B,EAAIe,IAAIrD,EAAGC,EAAGwD,EAAO,EAAG,EAAIyN,KAAK8Y,IAAI,GAErC1nB,EAAIe,IAAIrD,EAAGC,EAAGwD,EAAQ20B,EAAI,EAAG,EAAIlnB,KAAK8Y,IAAI,GAG5C1nB,EAAIS,YACJT,EAAIU,OACJV,EAAI8c,QACN,CACOuT,aACLrwB,EACA0U,EACAhX,EACAC,EACAm4B,GAEA91B,EAAImV,UAAYT,EAAGS,UAEnBnV,EAAIM,UAAYoU,EAAGqC,YACnB/W,EAAIO,YAEAu1B,EAAK,GACP91B,EAAIe,IACFrD,EACAC,EACAiR,KAAKyS,IAAI/kB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa8G,KAAKM,SAC/E,EACA,EAAIxE,KAAK8Y,IACT,GAGF1nB,EAAIe,IACFrD,EACAC,EACAiR,KAAKyS,IACH/kB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa8G,KAAKM,QAAU0iB,GAElF,EACA,EAAIlnB,KAAK8Y,IACT,GAGJ1nB,EAAIS,YACJT,EAAIU,MAEN,CAWO6S,UACLvT,EACA0U,EACAhX,EACAC,EACAwD,EACA20B,GAEA91B,EAAImV,UAAYT,EAAGS,UACnBnV,EAAI2c,YAAcjI,EAAGqC,YACrB/W,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAIO,YAEJP,EAAIe,IACFrD,EACAC,GACCiR,KAAKyS,IAAI/kB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa8G,KAAKtM,MAAQ,GACtFrF,EACF,EACA,EAAIyN,KAAK8Y,IACT,GAEF1nB,EAAIS,YACJT,EAAIU,OACJV,EAAI8c,QACN,CACOhK,KAAK9S,EAA+B0U,EAAiBhX,EAAWC,EAAWwD,GAChFnB,EAAImV,UAAYT,EAAGS,UACnBnV,EAAI2c,YAAcjI,EAAGqC,YACrB/W,EAAIM,UAAYoU,EAAGmC,UAEnB7W,EAAIO,YACJP,EAAIe,IACFrD,EACAC,GACCrB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa8G,KAAKtM,KAAO,GAAKrF,EACnF,EACA,EAAIyN,KAAK8Y,IACT,GAEF1nB,EAAIS,YACJT,EAAIU,OACJV,EAAI8c,QACN,CACOrJ,aACLzT,EACA0U,EACAhX,EACAC,EACAwD,GAEAnB,EAAImV,UAAYT,EAAGS,UACnBnV,EAAI2c,YAAcjI,EAAGqC,YACrB/W,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAIO,YACJP,EAAIe,IACFrD,EACAC,GACCrB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa8G,KAAKtM,KAAO,GAAKrF,EACnF,EACA,EAAIyN,KAAK8Y,IACT,GAEF1nB,EAAIS,YACJT,EAAIU,OACJV,EAAI8c,QACN,CACOtJ,UACLxT,EACA0U,EACAhX,EACAC,EACAwD,EACA20B,EACAxiB,GAMA,GAJAtT,EAAImV,UAAYT,EAAGS,UACnBnV,EAAIM,UAAYoU,EAAGmC,UACnB7W,EAAI2c,YAAcjI,EAAGqC,YAEjBzD,IAAiBM,EAAa2gC,gBAAiB,CACjD,MAAM3/B,GAAQF,EAAGqC,YAAYuM,MAAM,KAAK,GAEtCtjB,EAAI2c,YADF/H,EAAO,GACS,2BAEA,oBAEtB,CAEA5U,EAAIO,YACAu1B,EAAK,GACP91B,EAAIe,IACFrD,EACAC,EACAiR,KAAKyS,IAAI/kB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa8G,KAAKtM,KAAO,GACpFrF,EACF,EACA,EAAIyN,KAAK8Y,IACT,GAGF1nB,EAAIe,IACFrD,EACAC,EACAiR,KAAKyS,IAAI/kB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa8G,KAAKtM,KAAO,GACpFrF,EACA20B,EACF,EACA,EAAIlnB,KAAK8Y,IACT,GAGJ1nB,EAAIU,OACJV,EAAI8c,QACN,ECrSK,MAAMywD,GAGXpxE,YAAY0W,GAAqB,KAF1BA,WAAK,EAGVvW,KAAKuW,MAAQA,CACf,CACOguC,kCACL7gD,EACA0U,EACAhX,EACAC,EACAwD,GAOC,IAND2I,EAAM,uDAAG,EACTpD,IAAO,yDACP8mE,EAAe,wDAKXvC,EAAiB3uE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WACnF4iC,iBAWH,GATKn3C,KAAKuW,MAAMD,KAAKnR,SAASgsE,SAC5B/mE,GAAU,GAGRA,EACFukE,GAAkBnhE,EAElBmhE,GAAkBA,EAAiBnhE,EAEjC0jE,EAAiB,CACnBxtE,EAAImV,UACF,GACArL,EACE4K,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnC3O,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aAGhF,MAAM27C,EACJhwE,EAAoF,GAAhFpB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOjV,MAAc,EACtF+tE,EACJhwE,EAAIrB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOhV,OAAS,EACvF,GACEvD,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAC7DgrB,eAAevgC,OAAS+wE,EAAAA,GAAAA,KAG3B,YADAtxE,KAAKuxE,6CAA6C7tE,EAAK0U,EAAIg5D,EAAMC,GAKnE,MAAMG,EAAUxxE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOjV,MAClFmuE,EAAUzxE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOhV,OAClFghC,EAAsB,IAAVitC,EAElB9tE,EAAI+nC,OACJ/nC,EAAI6P,UACF69D,EAAyC,MAAjC7sC,EAAYA,EAAY1/B,GAChCwsE,GAAQI,EAAUA,EAAU5sE,IAE9BnB,EAAImB,MAAMA,EAAOA,GAGjBnB,EAAI2c,YAAcrgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BAC1F11B,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,KAC1ElyC,EAAI8c,OAAOxgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAIgM,QAEzFl+C,EAAIgoC,SACN,CACF,CACO2Y,0CACL3gD,EACA0U,EACAhX,EACAC,EACAwD,GAOC,IAND2I,EAAM,uDAAG,EACTpD,IAAO,yDACP8mE,EAAe,wDAKXvC,EAAiB3uE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WACnF4iC,iBAWH,GATKn3C,KAAKuW,MAAMD,KAAKnR,SAASgsE,SAC5B/mE,GAAU,GAGRA,EACFukE,GAAkBnhE,EAElBmhE,GAAkBA,EAAiBnhE,EAEjC0jE,EAAiB,CACnBxtE,EAAImV,UACF,GACArL,EACE4K,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnC3O,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aAGhF,MAAM27C,EACJhwE,EAAoF,GAAhFpB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOjV,MAAc,EACtF+tE,EACJhwE,EAAIrB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOhV,OAAS,EACvF,GACEvD,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAC7DgrB,eAAevgC,OAAS+wE,EAAAA,GAAAA,KAG3B,YADAtxE,KAAKuxE,6CAA6C7tE,EAAK0U,EAAIg5D,EAAMC,GAKnE3tE,EAAI+nC,OACJ/nC,EAAI6P,UAAU69D,EAAO,IAAKC,EAAO,MACjC3tE,EAAImB,MAAM,IAAK,OAEfnB,EAAI2c,YAAcjI,EAAGkC,wBACjBta,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,KAC1ElyC,EAAI8c,OAAOxgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAIgM,QAEzFl+C,EAAIgoC,UAGJhoC,EAAI+nC,OACJ/nC,EAAI6P,UAAU69D,EAAMC,GAEpB3tE,EAAI2c,YAAcrgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BAC1F11B,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,KAC1ElyC,EAAI8c,OACFxgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAIgM,QAGhFl+C,EAAIgoC,SACN,CACF,CACOyY,0BACLzgD,EACA0U,EACAhX,EACAC,EACAwD,GASC,IARD2I,EAAM,uDAAG,EACTiyB,IAAI,yDACJyxC,EAAe,wDAIf9mE,EAAgB,yCAChB5J,EAAmB,yCAEfmuE,EAAiB3uE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WACnF4iC,iBAcH,GAXKn3C,KAAKuW,MAAMD,KAAKnR,SAASgsE,SAC5B1xC,GAAO,EACPjyB,EAAS,GAGPiyB,EACFkvC,GAAkBnhE,EAElBmhE,GAAkBA,EAAiBnhE,EAErCnM,GAAsB,IAAjBstE,EACDuC,EAAiB,CACnB,IAAIvpE,EAAI,IAAMgnE,EACVhnE,EAAI,IACNA,EAAI,EAER,CAGE3H,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAegrB,eAC5EvgC,OAAS+wE,EAAAA,GAAAA,KAaVtxE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,KAC1E51C,KAAK0xE,sBACHhuE,EACA0U,EACAhX,EAAoF,GAAhFpB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOjV,MAAc,EAC1FjC,EAAIrB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOhV,OAAS,EACrFsB,EACAuF,EACA5J,GAnBFR,KAAK2xE,iCACHjuE,EACA0U,EACAhX,EAAoF,GAAhFpB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOjV,MAAc,EAC1FjC,EAAIrB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOhV,OAAS,EACrF6G,EACA5J,EAgBN,CACQkxE,sBACNhuE,EACA0U,EACAhX,EACAC,EACAwD,EACAuF,EACA5J,GAEC,IADDoxE,EAAS,wDAGT,MAAMJ,EAAUxxE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOjV,MAClFmuE,EAAUzxE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOhV,OAGpFvD,KAAKuW,MAAMD,KAAKnR,SAASmP,UAC3B5Q,EAAIM,UAAYoU,EAAGkC,wBAIjB9Z,IACFkD,EAAIM,UAAYoU,EAAGkC,yBAGrB,MAAMiqB,EAAsB,IAAVitC,EAElB9tE,EAAI+nC,OAKJ/nC,EAAI6P,UAAUnS,EAAsC,MAAjCmjC,EAAYA,EAAY1/B,GAAexD,GAAKowE,EAAUA,EAAU5sE,IACnFnB,EAAImB,MAAMA,EAAOA,GAEjBnB,EAAI2c,YAAcjI,EAAGqC,YAmBrB/W,EAAIU,KAAKpE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAIgM,OAAQ,WAC7Fl+C,EAAImV,UAAY,EACZ+4D,GACFluE,EAAI8c,OAAOxgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAIgM,QAqBzFl+C,EAAIgoC,SACN,CA8DOmmC,sBAAsBnuE,EAA+B0U,EAAiBhX,EAAWC,GAA0H,IAA/GmM,EAAM,uDAAG,EAAKiyB,IAAI,yDAASyxC,EAAe,wDAAgC7mE,EAAkB,uCAAES,EAAc,uCAC7M,IAAK9K,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAC3E,OAEF,IAAI+4B,EAAiB3uE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAW4iC,iBAmBjG,GAjBI1X,EACFkvC,GAAkBnhE,EAElBmhE,GAAkBA,EAAiBnhE,EAGrC9J,EAAIM,WAAY8tE,EAAAA,EAAAA,IAAgB1N,EAAAA,GAAAA,MAAgB,IAChD1gE,EAAIO,YACAw7B,EACF/7B,EAAIinB,QAAQvpB,EAAGC,EAAG,EAAG,IAAK,EAAG,EAAG,EAAIiR,KAAK8Y,IAAI,GAE7C1nB,EAAIinB,QAAQvpB,EAAGC,EAAI,EAAG,EAAG,EAAG,EAAG,EAAG,EAAIiR,KAAK8Y,IAAI,GAEjD1nB,EAAIS,YACJT,EAAIU,OAEJ/C,GAAsB,IAAjBstE,EACDuC,EAAiB,CACnB,IAAIvpE,EAAI,IAAMgnE,EACVhnE,EAAI,IACNA,EAAI,GAENjE,EAAI2c,YAAcjI,EAAGqC,YACrB/W,EAAImV,UAAYT,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnDjL,EAAIO,YACJP,EAAIe,IAAIrD,EAAGC,EAAqF,GAAjFrB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOhV,OAAcoE,EAAG,EAAG,EAAI2K,KAAK8Y,IAAI,GACxH1nB,EAAIS,YACJT,EAAIU,OACJV,EAAI8c,QACN,CAEIxgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,MAC1ElyC,EAAI+nC,OACJ/nC,EAAI6P,UAAUnS,EAAoF,GAAhFpB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOjV,MAAajC,EAAIrB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOhV,QACnLG,EAAIO,YACJ62D,OAAOC,KACL/6D,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAI8J,MAC5E8jB,KAAK3pC,IACL,MAAMxpB,EAAKrQ,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAI8J,KAAqB7lB,GAC5G,GAAIxpB,EAAG,CACL,MAAMkjB,EAAKsG,EAAI7S,MAAM,KAAK,GACf,MAAPuM,EACF7vB,EAAI4c,OAAOjQ,EAAE,GAAIA,EAAE,IACH,MAAPkjB,EACT7vB,EAAI6qE,cAAcl+D,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAClC,MAAPkjB,GAET7vB,EAAI6c,OAAOlQ,EAAE,GAAIA,EAAE,GAGvB,CACA,OAAO,CAAC,IAENvF,IAGFpH,EAAIM,WAAY+tE,EAAAA,EAAAA,IAAO,UAAW1nE,EAAa,KAEjD3G,EAAIS,YACJT,EAAIU,OAEJV,EAAIgoC,UAER,CACOmW,0CAA0Cn+C,EAA+B0U,EAAiBhX,EAAWC,EAAWwD,GAAiH,IAAlG2I,EAAM,uDAAG,EAAKpD,IAAO,yDAAS8mE,EAAe,wDACjL,MAAM3tE,EAASvD,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAOpM,OACvF,IAAIorE,EAAiB3uE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAW4iC,iBASjG,GARI/sC,EACFukE,GAAkBnhE,EAElBmhE,GAAkBA,EAAiBnhE,EAIrC9J,EAAIM,UAAYhE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BACxFw7C,EAAiB,CAInB,IAAIvpE,EAAIpE,EAASsB,EAAQ,GAAM,IAAO2I,EAASxN,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aACvH9tB,EAAI,IACNA,EAAI,GAENjE,EAAIO,YACJP,EAAIe,IAAIrD,EAAGC,EAAIkC,EAASsB,EAAQ,GAAK8C,EAAG,EAAG,EAAI2K,KAAK8Y,IAAI,GACxD1nB,EAAIS,YACJT,EAAIU,OAEJV,EAAI2c,YAAcjI,EAAGmC,UACrB7W,EAAImV,UAAY,IAChBnV,EAAIO,YACJP,EAAIe,IAAIrD,EAAGC,EAAIkC,EAASsB,EAAQ,GAAK8C,EAAI,EAAG,EAAG,EAAI2K,KAAK8Y,IAAI,GAC5D1nB,EAAIS,YACJT,EAAI8c,QACN,CACF,CACOihC,kCAAkC/9C,EAA+B0U,EAAiBhX,EAAWC,EAAWwD,GAAiH,IAAlG2I,EAAM,uDAAG,EAAKpD,IAAO,yDAAS8mE,EAAe,wDACzK,MAAM3tE,EAASvD,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAOpM,OACvF,IAAIorE,EAAiB3uE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAW4iC,iBASjG,GARI/sC,EACFukE,GAAkBnhE,EAElBmhE,GAAkBA,EAAiBnhE,EAIrC9J,EAAIM,UAAYhE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BACxFw7C,EAAiB,CAInB,IAAIvpE,EAAIpE,EAASsB,EAAQ,GAAM,IAAO2I,EAASxN,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aACvH9tB,EAAI,IACNA,EAAI,GAGNjE,EAAIO,YACJP,EAAIe,IAAIrD,EAAGC,EAAIkC,EAASsB,EAAQ,GAAK8C,EAAG,EAAG,EAAI2K,KAAK8Y,IAAI,GACxD1nB,EAAIS,YACJT,EAAIU,MACN,CACF,CACOs9C,0BAA0Bh+C,EAA+B0U,EAAiBhX,EAAWC,EAAWwD,GAAqJ,IAAtI2I,EAAM,uDAAG,EAAKiyB,IAAI,yDAASyxC,EAAe,wDAAsE1wE,EAAmB,yCAEvP,MAAM+C,EAASvD,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAOpM,OAASsB,EAC1FmtE,EAAchyE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAO9K,MAEvF7E,KAAKuW,MAAMD,KAAKnR,SAASgsE,SAC5B1xC,GAAO,EACPjyB,EAAS,GAIX,IAAImhE,EAAiB3uE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAW4iC,iBAsBjG,GArBI1X,EACFkvC,GAAkBnhE,EAElBmhE,GAAkBA,EAAiBnhE,EAYrCnM,GAAsB,IAAjBstE,EAILjrE,EAAI2c,YAAcjI,EAAGqC,YACrB/W,EAAIM,UAAYhE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BACxFw7C,EAAiB,CACnB,IAAIvpE,EAAI,IAAMqqE,EAAcrD,EACxBhnE,EAAI,IACNA,EAAI,GAGNjE,EAAIO,YACJP,EAAIe,IAAIrD,EAAGC,EAAa,GAATkC,EAAcoE,EAAG,EAAG,EAAI2K,KAAK8Y,IAAI,GAChD1nB,EAAIS,YACJT,EAAIU,MAEN,CAaIpE,KAAKuW,MAAMD,KAAKnR,SAASmP,UAC3B5Q,EAAIM,UAAYoU,EAAGkC,wBAIjB9Z,IACFkD,EAAIM,UAAYoU,EAAGkC,yBAKrB5W,EAAIO,YACJP,EAAIe,IAAIrD,EAAGC,EAAa,GAATkC,EAAuB,GAATA,EAAc,EAAa,EAAV+O,KAAK8Y,IACnD1nB,EAAIS,YACJT,EAAIU,MAkBN,CACO6tE,+BACLvuE,EACA0U,EACAhX,EACAC,GASC,IARDmM,EAAM,uDAAG,EACTiyB,IAAI,yDACJyxC,EAAe,wDAGfniD,EAAa,uCACb3kB,EAAgB,yCAChB5J,EAAmB,yCAEnB,MAAM+C,EAASvD,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAOpM,OAElFvD,KAAKuW,MAAMD,KAAKnR,SAASgsE,SAC5B1xC,GAAO,EACPjyB,EAAS,GAIX,IAAImhE,EAAiB3uE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WACnF4iC,iBAsBH,GArBI1X,EACFkvC,GAAkBnhE,EAElBmhE,GAAkBA,EAAiBnhE,EAIrC9J,EAAIM,WAAY8tE,EAAAA,EAAAA,IAAgB1N,EAAAA,GAAAA,MAAgB,IAC5C3kC,IACF/7B,EAAIO,YACJP,EAAIinB,QAAQvpB,EAAGC,EAAG,EAAG,IAAK,EAAG,EAAG,EAAIiR,KAAK8Y,IAAI,GAC7C1nB,EAAIS,YACJT,EAAIU,QAGN/C,GAAsB,IAAjBstE,EAILjrE,EAAI2c,YAAcjI,EAAGqC,YACrB/W,EAAIM,UAAYhE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BACxFw7C,EAAiB,CACnB,IAAIvpE,EACF,IACA3H,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAO9K,MACxE8pE,EACEhnE,EAAI,IACNA,EAAI,GAGNjE,EAAIO,YACJP,EAAIe,IAAIrD,EAAGC,EAAa,GAATkC,EAAe,EAAGoE,EAAG,EAAG,EAAI2K,KAAK8Y,IAAI,GACpD1nB,EAAIS,YACJT,EAAIU,MAEN,CAcIpE,KAAKuW,MAAMD,KAAKnR,SAASmP,UAC3B5Q,EAAIM,UAAYoU,EAAGkC,wBAKjB9Z,IACFkD,EAAIM,UAAYoU,EAAGkC,yBAKrB5W,EAAIO,YACJP,EAAIe,IAAIrD,EAAGC,EAAa,GAATkC,EAAe,EAAY,GAATA,EAAc,EAAa,EAAV+O,KAAK8Y,IACvD1nB,EAAIS,YACJT,EAAIU,OAEJ,MAAM89C,EAAO,UAAMliD,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAOumC,SAAQ,cAAMl2C,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAOsmC,YACjLvyC,EAAI3D,KAAOmiD,EAEX,MAAMztC,EAAMzU,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAC1EwmC,eAEDzyC,EAAIM,UADFoG,GAAW5J,EACA,eAAWiU,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,KAElD,eAAWA,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAK,GAAG,KAEvE/Q,EAAI8b,UAAY,SAEhB9b,EAAIkB,SAASmqB,EAAMhc,WAAY3R,EAAGC,EAAa,GAATkC,EAAe,EAEvD,CAEO06C,UACLv6C,EACA0U,EACAhX,EACAC,EACAmiC,EACA0uC,EACAn0B,EACAyyB,EACAxpE,EACAqD,GAGC,IADDmD,EAAM,0DAAG,EAET9J,EAAIwnB,YAAc7gB,EAClB3G,EAAIM,UAAYoU,EAAGmC,UAGnB,MACM43D,EAAuB,GAAT3kE,EAEdlK,EAHQ,GAGAkgC,EAAmB2uC,EAC3B5uE,EAJQ,GAIC2uE,EAAoBC,EAC7BlyB,EAAkB,GAAR38C,EACV48C,EAAmB,GAAT38C,EAEhBG,EAAIwhD,UAAUnH,EAAK38C,EAAI6+C,EAAS5+C,EAAI6+C,EAAS58C,EAAOC,EACtD,CAoCOohC,YAAYjhC,EAA+BtC,EAAWC,GAC3DqC,EAAIO,YACJP,EAAIe,IAAIrD,EAAGC,EAAG,EAAG,EAAG,EAAIiR,KAAK8Y,IAAI,GACjC1nB,EAAIS,YACJT,EAAIM,UAAY,QAChBN,EAAIU,MACN,CACOymB,kBAAkBnnB,EAA+BtC,EAAWC,GACjEqC,EAAImV,UAAY,EAChBnV,EAAI2c,YAAc,UAClB3c,EAAIO,YACJP,EAAI4c,OAAOlf,EAAGC,EAAI,KAClBqC,EAAI6c,OAAOnf,EAAGC,EAAI,KAClBqC,EAAI4c,OAAOlf,EAAI,IAAKC,GACpBqC,EAAI6c,OAAOnf,EAAI,IAAKC,GACpBqC,EAAI8c,QACN,CACQmxD,iCACNjuE,EACA0U,EACAhX,EACAC,EACA+I,EACA5J,GA2BA,GAxBAkD,EAAI+nC,OACJ/nC,EAAI6P,UAAUnS,EAAGC,GAUbrB,KAAKuW,MAAMD,KAAKnR,SAASmP,UAC3B5Q,EAAIM,UAAYoU,EAAGkC,wBAIjB9Z,IACFkD,EAAIM,UAAYoU,EAAGkC,yBAGrB5W,EAAI2c,YAAcjI,EAAGqC,YAErB/W,EAAImV,UAAY,EAGd7Y,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,KACxE51C,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAI8J,KAC5E,CACA,MAAM0yB,EAAWpyE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IACtF8J,KACHh8C,EAAIO,YACJ62D,OAAOC,KAAKqX,GAAU5O,KAAK3pC,IACzB,MAAMxpB,EAAI+hE,EAASv4C,GACnB,GAAIxpB,EAAG,CACL,MAAMkjB,EAAKsG,EAAI7S,MAAM,KAAK,GACf,MAAPuM,EACF7vB,EAAI4c,OAAOjQ,EAAE,GAAIA,EAAE,IACH,MAAPkjB,EACT7vB,EAAI6qE,cAAcl+D,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAClC,MAAPkjB,GAET7vB,EAAI6c,OAAOlQ,EAAE,GAAIA,EAAE,GAGvB,CACA,OAAO,CAAC,IAEV3M,EAAIS,YACJT,EAAIU,MACN,CACAV,EAAIgoC,SACN,CACQ6lC,6CACN7tE,EACA0U,EACAhX,EACAC,GAEAqC,EAAI+nC,OACJ/nC,EAAI6P,UAAUnS,EAAGC,GACjBqC,EAAI2c,YAAcrgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BAC9F,MAAM08C,EAAWpyE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAI8J,KAC7Fh8C,EAAIO,YACJ62D,OAAOC,KAAKqX,GAAU5O,KAAK3pC,IACzB,MAAMxpB,EAAI+hE,EAASv4C,GACnB,GAAIxpB,EAAG,CACL,MAAMkjB,EAAKsG,EAAI7S,MAAM,KAAK,GACf,MAAPuM,EACF7vB,EAAI4c,OAAOjQ,EAAE,GAAIA,EAAE,IACH,MAAPkjB,EACT7vB,EAAI6qE,cAAcl+D,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAClC,MAAPkjB,GACT7vB,EAAI6c,OAAOlQ,EAAE,GAAIA,EAAE,GAEvB,CACA,OAAO,CAAC,IAEV3M,EAAIS,YACJT,EAAI8c,SACJ9c,EAAIgoC,SACN,CACO0Y,aACL1gD,EACA0U,EACAhX,EACAC,EACAb,EACA4J,GAGEpK,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAegrB,eAC5EvgC,OAAS+wE,EAAAA,GAAAA,QACZtxE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAegrB,eAC5EvgC,OAAS+wE,EAAAA,GAAAA,OAId5tE,EAAIO,YACJP,EAAIinB,QAAQvpB,EAAGC,EAAI,EAAG,GAAI,IAAK,EAAG,EAAG,EAAIiR,KAAK8Y,IAAI,GAClD1nB,EAAIS,YAEFT,EAAIM,UADFxD,GAAc4J,EACApK,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOu9B,iBAExE91C,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOs9B,YAE1FnyC,EAAI2uE,OAAM,eAAWryE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOw9B,WAAU,OACvGryC,EAAIU,OACJV,EAAI2uE,OAAS,OACf,CACO/tB,kBACL5gD,EACA0U,EACAhX,EACAC,EACAwD,EACArE,EACA4J,GAGEpK,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAegrB,eAC5EvgC,OAAS+wE,EAAAA,GAAAA,QACZtxE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAegrB,eAC5EvgC,OAAS+wE,EAAAA,GAAAA,OAId5tE,EAAIO,YACJP,EAAIinB,QAAQvpB,EAAGC,EAAI,EAAG,GAAI,IAAK,EAAG,EAAG,EAAIiR,KAAK8Y,IAAI,GAClD1nB,EAAIS,YAIJT,EAAIM,UAAYhE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOs9B,YAExFnyC,EAAI2uE,OAAM,eAAWryE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOw9B,WAAU,OACvGryC,EAAIU,OACJV,EAAI2uE,OAAS,OACf,CACO/wB,aACL59C,EACA0U,EACAhX,EACAC,EACAwD,EACArE,EACA4J,GAGEpK,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAegrB,eAC5EvgC,OAAS+wE,EAAAA,GAAAA,QACZtxE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAegrB,eAC5EvgC,OAAS+wE,EAAAA,GAAAA,OAId5tE,EAAIO,YACJP,EAAIinB,QAAQvpB,EAAGC,EAAI,EAAG,GAAKwD,EAAO,IAAK,EAAG,EAAG,EAAIyN,KAAK8Y,IAAI,GAC1D1nB,EAAIS,YAEFT,EAAIM,UADFxD,GAAc4J,EACApK,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAOmmC,iBAExE91C,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAOkmC,YAE1FnyC,EAAI2uE,OAAM,eAAWryE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAOomC,WAAU,OACvGryC,EAAIU,OACJV,EAAI2uE,OAAS,OACf,CACOvwB,kBACLp+C,EACA0U,EACAhX,EACAC,EACAwD,EACArE,EACA4J,GAGEpK,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAegrB,eAC5EvgC,OAAS+wE,EAAAA,GAAAA,QACZtxE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAegrB,eAC5EvgC,OAAS+wE,EAAAA,GAAAA,OAId5tE,EAAIO,YACJP,EAAIinB,QAAQvpB,EAAGC,EAAI,EAAG,GAAKwD,EAAO,IAAK,EAAG,EAAG,EAAIyN,KAAK8Y,IAAI,GAC1D1nB,EAAIS,YAIJT,EAAIM,UAAYhE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAOkmC,YAExFnyC,EAAI2uE,OAAM,eAAWryE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAOomC,WAAU,OACvGryC,EAAIU,OACJV,EAAI2uE,OAAS,OACf,ECp7BK,MAAMC,GAGXzyE,YAAY0W,GAAqB,KAF1BA,WAAK,EAGVvW,KAAKuW,MAAQA,CACf,CACOwuC,iBAAiBrhD,EAA+BugD,EAAkC7rC,EAAiBhX,EAAWC,EAAWwD,GAAqK,IAAtJ2I,EAAM,uDAAG,EAAKiyB,IAAI,yDAASyxC,EAAe,wDAAoE9mE,EAAgB,yCAAE5J,EAAmB,yCAC5RmuE,EAAiB3uE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAW4iC,iBAcjG,GAXKn3C,KAAKuW,MAAMD,KAAKnR,SAASgsE,SAC5B1xC,GAAO,EACPjyB,EAAS,GAGPiyB,EACFkvC,GAAkBnhE,EAElBmhE,GAAkBA,EAAiBnhE,EAErCnM,GAAsB,IAAjBstE,EACDuC,EAAiB,CACnB,IAAIvpE,EAAI,IAAMgnE,EACVhnE,EAAI,IACNA,EAAI,EAER,CAEI3H,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAegrB,eAAevgC,OAAS+wE,EAAAA,GAAAA,KAKvGtxE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,KAC1E51C,KAAKuyE,sBAAsB7uE,EAAKugD,EAAiB7rC,EAAIhX,EAAGC,EAAGwD,EAAOuF,EAAS5J,GAL3ER,KAAKwyE,iCAAiC9uE,EAAKugD,EAAiB7rC,EAAIhX,EAAe,IAAXgX,EAAG9U,MAAeuB,EAAOxD,EAAI+W,EAAG7U,OAAS,EAAG6G,EAAS5J,EAO7H,CACQ+xE,sBAAsB7uE,EAA+BugD,EAAkC7rC,EAAiBhX,EAAWC,EAAWwD,EAAeuF,EAAkB5J,GAAyC,IAApBoxE,EAAS,wDACnM,MAAMJ,EAAUp5D,EAAG9U,MACbmuE,EAAUr5D,EAAG7U,OACbghC,EAAsB,IAAVitC,EAAiB3sE,EAenC,OAdI7E,KAAKuW,MAAMD,KAAKnR,SAASmP,UAC3B5Q,EAAIM,UAAYoU,EAAGkC,wBAIjB9Z,IACFkD,EAAIM,UAAYoU,EAAGkC,yBAErB5W,EAAI+nC,OACJ/nC,EAAI6P,UAAUnS,EAAImjC,EAAWljC,EAAIowE,EAAU5sE,GAC3CnB,EAAImB,MAAMA,EAAOA,GAEjBnB,EAAI2c,YAAcjI,EAAGqC,YAEbwpC,GACN,KAAKC,EAAAA,GAAAA,QACHxgD,EAAIU,KAAKpE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAIgM,OAAQ,WAC7Fl+C,EAAImV,UAAY,EACZ+4D,GACFluE,EAAI8c,OAAOxgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAIgM,QAEzF,MACF,KAAKsC,EAAAA,GAAAA,MAGClkD,KAAKo4D,aAAahgD,EAAG5E,MACvBxT,KAAKi+C,UACHv6C,EACA0U,EACA,EACA,EACA,GACA,GACApY,KAAKo4D,aAAahgD,EAAG5E,MACrB,GACA,EACA,EACApJ,EACA5J,GAORkD,EAAIgoC,SACN,CACOuS,UACLv6C,EACA0U,EACAhX,EACAC,EACAmiC,EACA0uC,EACAn0B,EACAyyB,EACAxpE,EACAqD,GAKC,IAJDD,EAAO,2DACP5J,EAAU,2DAIVkD,EAAIwnB,YAAc7gB,EAClB3G,EAAIM,UAAYoU,EAAGmC,UAEdnQ,GAAY5J,IACfkD,EAAIwnB,YAAc9S,EAAG/D,kBAEvB3Q,EAAIwhD,UAAUnH,EAAK38C,EAAGC,EAAGmiC,EAAU0uC,GACnCxuE,EAAIwnB,YAAc,CACpB,CACOunD,eACL/uE,EACA0U,EACAhX,EACAC,EACAmiC,EACA0uC,EACAn0B,EACAyyB,EACAxpE,EACAqD,GASA3G,EAAImV,UAAY,IAChBnV,EAAIO,YACJP,EAAIQ,KAAK9C,EAAI,EAAGC,EAAI,EAAGmiC,EAAW,EAAG0uC,EAAY,GACjDxuE,EAAIS,YACJT,EAAI2c,YAAc+jD,EAAAA,GAAAA,MAClB1gE,EAAI8c,SAEJ9c,EAAIO,YACJP,EAAIQ,KAAK9C,EAAGC,EAAGmiC,EAAU0uC,GACzBxuE,EAAIS,YACJT,EAAI2c,YAAc+jD,EAAAA,GAAAA,MAClB1gE,EAAI8c,QAoCN,CACOkyD,kBACLhvE,EACA0U,EACAhX,EACAC,EACAmiC,EACA0uC,EACAn0B,EACAyyB,EACAxpE,EACAqD,GAOI+N,EAAGlO,OAASvB,EAAAA,GAAAA,OACdjF,EAAImV,UAAY,IAChBnV,EAAIO,YACJP,EAAIQ,KAAK9C,EAAI,EAAGC,EAAI,GAAImiC,EAAW,GAAI0uC,EAAY,IACnDxuE,EAAIS,YAEJT,EAAI2c,YAAc+jD,EAAAA,GAAAA,MAClB1gE,EAAI8c,SAEJ9c,EAAIO,YACJP,EAAIQ,KAAK9C,EAAI,EAAGC,EAAI,GAAImiC,EAAW,EAAG0uC,EAAY,IAClDxuE,EAAIS,YACJT,EAAI2c,YAAc+jD,EAAAA,GAAAA,MAClB1gE,EAAI8c,WAEJ9c,EAAImV,UAAY,GAChBnV,EAAIO,YACJP,EAAIQ,KAAK9C,EAAI,EAAGC,EAAI,EAAGmiC,EAAW,EAAG0uC,EAAY,GACjDxuE,EAAIS,YAEJT,EAAI2c,YAAc+jD,EAAAA,GAAAA,MAClB1gE,EAAI8c,SAEJ9c,EAAIO,YACJP,EAAIQ,KAAK9C,EAAI,EAAGC,EAAI,EAAGmiC,EAAW,EAAG0uC,EAAY,GACjDxuE,EAAIS,YACJT,EAAI2c,YAAc+jD,EAAAA,GAAAA,MAClB1gE,EAAI8c,SAGR,CACOskC,iCAAiCphD,EAA+BugD,EAAkC7rC,EAAiBhX,EAAWC,EAAWwD,GAAiI,IAAlH2I,EAAM,uDAAG,EAAKpD,IAAO,yDAAS8mE,EAAe,wDACtMvC,EAAiB3uE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAW4iC,iBAGjG,MAAMs6B,EAAUr5D,EAAG7U,OAYnB,GATKvD,KAAKuW,MAAMD,KAAKnR,SAASgsE,SAC5B/mE,GAAU,GAGRA,EACFukE,GAAkBnhE,EAElBmhE,GAAkBA,EAAiBnhE,EAEjC0jE,EAAiB,CACnBxtE,EAAImV,UAAY,GAAMrL,EAClB4K,EAAGS,UACH7Y,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aAGhF,MAAM27C,EAAOhwE,EAAe,IAAXgX,EAAG9U,MAAeuB,EAC7BwsE,EAAOhwE,EAAI+W,EAAG7U,OAASsB,EAC7B,GAAI7E,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAegrB,eAAevgC,OAAS+wE,EAAAA,GAAAA,KAEzG,YADAtxE,KAAKuxE,6CAA6C7tE,EAAK0U,EAAIg5D,EAAMC,GAwBnE,GAnBA3tE,EAAI+nC,OACJ/nC,EAAI6P,UAAU69D,EAAM/vE,EAAIowE,EAAU5sE,GAClCnB,EAAImB,MAAMA,EAAOA,GAejBnB,EAAImV,UAAY,EAChBnV,EAAI2c,YAAcrgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BAC1F11B,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAC1E,OAAQqO,GACN,KAAKC,EAAAA,GAAAA,QACHxgD,EAAI8c,OAAOxgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAIgM,QACvF,MACF,KAAKsC,EAAAA,GAAAA,MACHlkD,KAAK0yE,kBAAkBhvE,EAAK0U,EAAIg5D,EAAMC,EAAM,GAAI,GAAIrxE,KAAKo4D,aAAahgD,EAAG5E,MAAM,GAAO,EAAO,GAMnG9P,EAAIgoC,SACN,CACF,CAEOsZ,yBACLthD,EACAugD,EACA7rC,EACAhX,EACAC,EACAwD,GAOC,IAND2I,EAAM,uDAAG,EACTpD,IAAO,yDACP8mE,EAAe,wDAKXvC,EAAiB3uE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WACnF4iC,iBAUH,GATKn3C,KAAKuW,MAAMD,KAAKnR,SAASgsE,SAC5B/mE,GAAU,GAGRA,EACFukE,GAAkBnhE,EAElBmhE,GAAkBA,EAAiBnhE,EAEjC0jE,EAAiB,CACnBxtE,EAAImV,UACF,GACArL,EACE4K,EAAGS,UACH7Y,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aAC5E,EAIJ,MAAM27C,EAAOhwE,EAAe,IAAXgX,EAAG9U,MAAeuB,EAC7BwsE,EAAOhwE,EAAI+W,EAAG7U,OAAS,EAC7B,GACEvD,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAC7DgrB,eAAevgC,OAAS+wE,EAAAA,GAAAA,KAG3B,YADAtxE,KAAKuxE,6CAA6C7tE,EAAK0U,EAAIg5D,EAAMC,GAKnE,MAAMG,EAAUp5D,EAAG9U,MACbmuE,EAAUr5D,EAAG7U,OACbghC,EAAsB,IAAVitC,EAAiB3sE,EASnC,OAPAnB,EAAI+nC,OACJ/nC,EAAI6P,UAAUnS,EAAImjC,EAAWljC,EAAIowE,EAAU5sE,GAC3CnB,EAAImB,MAAMA,EAAOA,GAGjBnB,EAAI2c,YAAcrgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BAEtFuuB,GACN,KAAKC,EAAAA,GAAAA,QACClkD,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,KAC1ElyC,EAAI8c,OAAOxgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAIgM,QAEzF,MACF,KAAKsC,EAAAA,GAAAA,MACHlkD,KAAKyyE,eAAe/uE,EAAK0U,EAAI,EAAG,EAAG,GAAI,GAAIpY,KAAKo4D,aAAahgD,EAAG5E,MAAM,GAAO,EAAO,GAKxF9P,EAAIgoC,SACN,CACF,CAGQ8mC,iCACN9uE,EACAugD,EACA7rC,EACAhX,EACAC,EACA+I,EACA5J,GA2BA,OAxBAkD,EAAI+nC,OACJ/nC,EAAI6P,UAAUnS,EAAGC,GAUbrB,KAAKuW,MAAMD,KAAKnR,SAASmP,UAC3B5Q,EAAIM,UAAYoU,EAAGkC,wBAIjB9Z,IACFkD,EAAIM,UAAYoU,EAAGkC,yBAGrB5W,EAAI2c,YAAcjI,EAAGqC,YAErB/W,EAAImV,UAAY,EAERorC,GACN,KAAKC,EAAAA,GAAAA,QACH,GACElkD,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,KACxE51C,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAI8J,KAC5E,CACA,MAAM0yB,EAAWpyE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAC/Eq9B,IAAI8J,KACPh8C,EAAIO,YACJ62D,OAAOC,KAAKqX,GAAU5O,KAAK3pC,IACzB,MAAMxpB,EAAI+hE,EAASv4C,GACnB,GAAIxpB,EAAG,CACL,MAAMkjB,EAAKsG,EAAI7S,MAAM,KAAK,GACf,MAAPuM,EACF7vB,EAAI4c,OAAOjQ,EAAE,GAAIA,EAAE,IACH,MAAPkjB,EACT7vB,EAAI6qE,cAAcl+D,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAClC,MAAPkjB,GAET7vB,EAAI6c,OAAOlQ,EAAE,GAAIA,EAAE,GAGvB,CACA,OAAO,CAAC,IAEV3M,EAAIS,YACJT,EAAIU,MACN,CAEF,KAAK8/C,EAAAA,GAAAA,OAOPxgD,EAAIgoC,SACN,CACQ6lC,6CACN7tE,EACA0U,EACAhX,EACAC,GAEAqC,EAAI+nC,OACJ/nC,EAAI6P,UAAUnS,EAAGC,GACjBqC,EAAI2c,YAAcrgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BAC9F,MAAM08C,EAAWpyE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IACtF8J,KACHh8C,EAAIO,YACJ62D,OAAOC,KAAKqX,GAAU5O,KAAK3pC,IACzB,MAAMxpB,EAAI+hE,EAASv4C,GACnB,GAAIxpB,EAAG,CACL,MAAMkjB,EAAKsG,EAAI7S,MAAM,KAAK,GACf,MAAPuM,EACF7vB,EAAI4c,OAAOjQ,EAAE,GAAIA,EAAE,IACH,MAAPkjB,EACT7vB,EAAI6qE,cAAcl+D,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAClC,MAAPkjB,GACT7vB,EAAI6c,OAAOlQ,EAAE,GAAIA,EAAE,GAEvB,CACA,OAAO,CAAC,IAEV3M,EAAIS,YACJT,EAAI8c,SACJ9c,EAAIgoC,SACN,CACQ0sB,aAAa5kD,GACnB,OAAOxT,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcmL,UAAUw9C,aAAa5kD,EACpF,ECxdO,MAAMm/D,GAGX9yE,YAAY0W,GAAqB,KAF1BA,WAAK,EAGVvW,KAAKuW,MAAQA,CACf,CACOorC,mBAAmBj+C,EAA+BkvE,EAAiBx6D,EAAiBhX,EAAWC,EAAWwD,GAAiM,IAApEuF,EAAgB,yCAAE5J,EAAmB,yCAAEoxE,EAAkB,2DAsBrS5xE,KAAK6yE,eAAenvE,EAAKkvE,EAASx6D,EAAIhX,EAAGC,EAAGwD,EAAOuF,EAAS5J,EAAYoxE,EAC1E,CACQiB,eAAenvE,EAA+BkvE,EAAiBx6D,EAAiBhX,EAAWC,EAAWwD,EAAeuF,EAAkB5J,GAA6D,IAAxCoxE,EAAS,wDAAUjD,EAAc,uDAAG,EACtM,MAAM6C,EAAUp5D,EAAG9U,MACbmuE,EAAUr5D,EAAG7U,OAEbghC,EAAsB,KAAVitC,EAAkB3sE,EAChC7E,KAAKuW,MAAMD,KAAKnR,SAASmP,UAC3B5Q,EAAIM,UAAYoU,EAAGkC,wBAIjB9Z,IACFkD,EAAIM,UAAYoU,EAAGkC,yBAIrB5W,EAAI+nC,OACJ/nC,EAAI6P,UACFnS,EAAImjC,EACJljC,EAAIowE,EAAU5sE,GAEhBnB,EAAImB,MAAMA,EAAOA,GAEjBnB,EAAI2c,YAAcjI,EAAGqC,YAGjBm3D,IACFluE,EAAImV,UAAY,EAAI81D,EACpBjrE,EAAI2c,YAAc,UAClB3c,EAAI8c,OAAOoyD,IAGblvE,EAAIU,KAAKwuE,EAAS,WAClBlvE,EAAIgoC,SAQN,CACOuS,UACLv6C,EACA0U,EACAhX,EACAC,EACAmiC,EACA0uC,EACAn0B,EACAyyB,EACAxpE,EACAqD,GAKC,IAJDD,EAAO,2DACP5J,EAAU,2DAIVkD,EAAIwnB,YAAc7gB,EAClB3G,EAAIM,UAAYoU,EAAGmC,UAEdnQ,GAAY5J,IACfkD,EAAIwnB,YAAc9S,EAAG/D,kBAEvB3Q,EAAIwhD,UAAUnH,EAAK38C,EAAGC,EAAGmiC,EAAU0uC,GACnCxuE,EAAIwnB,YAAc,CACpB,CACOunD,eACL/uE,EACA0U,EACAhX,EACAC,EACAmiC,EACA0uC,EACAn0B,EACAyyB,EACAxpE,EACAqD,GASA3G,EAAImV,UAAY,IAChBnV,EAAIO,YACJP,EAAIQ,KAAK9C,EAAI,EAAGC,EAAI,EAAGmiC,EAAW,EAAG0uC,EAAY,GACjDxuE,EAAIS,YACJT,EAAI2c,YAAc+jD,EAAAA,GAAAA,MAClB1gE,EAAI8c,SAEJ9c,EAAIO,YACJP,EAAIQ,KAAK9C,EAAGC,EAAGmiC,EAAU0uC,GACzBxuE,EAAIS,YACJT,EAAI2c,YAAc+jD,EAAAA,GAAAA,MAClB1gE,EAAI8c,QAoCN,CACOkyD,kBACLhvE,EACA0U,EACAhX,EACAC,EACAmiC,EACA0uC,EACAn0B,EACAyyB,EACAxpE,EACAqD,GAOI+N,EAAGlO,OAASvB,EAAAA,GAAAA,OACdjF,EAAImV,UAAY,IAChBnV,EAAIO,YACJP,EAAIQ,KAAK9C,EAAI,EAAGC,EAAI,GAAImiC,EAAW,GAAI0uC,EAAY,IACnDxuE,EAAIS,YAEJT,EAAI2c,YAAc+jD,EAAAA,GAAAA,MAClB1gE,EAAI8c,SAEJ9c,EAAIO,YACJP,EAAIQ,KAAK9C,EAAI,EAAGC,EAAI,GAAImiC,EAAW,EAAG0uC,EAAY,IAClDxuE,EAAIS,YACJT,EAAI2c,YAAc+jD,EAAAA,GAAAA,MAClB1gE,EAAI8c,WAEJ9c,EAAImV,UAAY,GAChBnV,EAAIO,YACJP,EAAIQ,KAAK9C,EAAI,EAAGC,EAAI,EAAGmiC,EAAW,EAAG0uC,EAAY,GACjDxuE,EAAIS,YAEJT,EAAI2c,YAAc+jD,EAAAA,GAAAA,MAClB1gE,EAAI8c,SAEJ9c,EAAIO,YACJP,EAAIQ,KAAK9C,EAAI,EAAGC,EAAI,EAAGmiC,EAAW,EAAG0uC,EAAY,GACjDxuE,EAAIS,YACJT,EAAI2c,YAAc+jD,EAAAA,GAAAA,MAClB1gE,EAAI8c,SAGR,CACOskC,iCACLphD,EACAugD,EACA7rC,EACAhX,EACAC,EACAwD,GAOC,IAND2I,EAAM,uDAAG,EACTpD,IAAO,yDACP8mE,EAAe,wDAKXvC,EAAiB3uE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WACnF4iC,iBAEH,MAAMq6B,EAAUp5D,EAAG9U,MACbmuE,EAAUr5D,EAAG7U,OACbghC,EAAsB,GAAVitC,EAAgB3sE,EAWlC,GATK7E,KAAKuW,MAAMD,KAAKnR,SAASgsE,SAC5B/mE,GAAU,GAGRA,EACFukE,GAAkBnhE,EAElBmhE,GAAkBA,EAAiBnhE,EAEjC0jE,EAAiB,CAiBnB,GAhBAxtE,EAAImV,UACF,GACArL,EACE4K,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnC3O,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aAOhF/xB,EAAI+nC,OACJ/nC,EAAI6P,UAAUnS,EAAImjC,EAAWljC,EAAIowE,EAAU5sE,GAC3CnB,EAAImB,MAAMA,EAAOA,GACjBnB,EAAImV,UAAY,EAChBnV,EAAI2c,YAAcjI,EAAGkC,wBACjBta,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAC1E,OAAQqO,GACN,KAAKC,EAAAA,GAAAA,QACHxgD,EAAI8c,OACFxgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAIgM,QAE9E,MACF,KAAKsC,EAAAA,GAAAA,MACHlkD,KAAK0yE,kBACHhvE,EACA0U,EACA,EACA,EACA,GACA,GACApY,KAAKo4D,aAAahgD,EAAG5E,MACrB,GACA,EACA,GASR,GAFA9P,EAAImV,UAAY,EAChBnV,EAAI2c,YAAcrgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BAC1F11B,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAC1E,OAAQqO,GACN,KAAKC,EAAAA,GAAAA,QACHxgD,EAAI8c,OACFxgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAIgM,QAE9E,MACF,KAAKsC,EAAAA,GAAAA,MACHlkD,KAAK0yE,kBACHhvE,EACA0U,EACA,EACA,EACA,GACA,GACApY,KAAKo4D,aAAahgD,EAAG5E,MACrB,GACA,EACA,GAOR9P,EAAIgoC,SACN,CACF,CAEOsZ,yBACLthD,EACAugD,EACA7rC,EACAhX,EACAC,EACAwD,GAOC,IAND2I,EAAM,uDAAG,EACTpD,IAAO,yDACP8mE,EAAe,wDAKXvC,EAAiB3uE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WACnF4iC,iBAUH,GATKn3C,KAAKuW,MAAMD,KAAKnR,SAASgsE,SAC5B/mE,GAAU,GAGRA,EACFukE,GAAkBnhE,EAElBmhE,GAAkBA,EAAiBnhE,EAEjC0jE,EAAiB,CACnBxtE,EAAImV,UACF,GACArL,EACE4K,EAAGS,UAAYT,EAAGxK,YAAcwK,EAAGzJ,WACnC3O,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aAC5E,EASJ,MAAM+7C,EAAUp5D,EAAG9U,MACbmuE,EAAUr5D,EAAG7U,OACbghC,EAAsB,GAAVitC,EAAgB3sE,EASlC,OAPAnB,EAAI+nC,OACJ/nC,EAAI6P,UAAUnS,EAAImjC,EAAWljC,EAAIowE,EAAU5sE,GAC3CnB,EAAImB,MAAMA,EAAOA,GAGjBnB,EAAI2c,YAAcrgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BAEtFuuB,GACN,KAAKC,EAAAA,GAAAA,QACClkD,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,KAC1ElyC,EAAI8c,OAAOxgB,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6I,OAAOq9B,IAAIgM,QAEzF,MACF,KAAKsC,EAAAA,GAAAA,MACHlkD,KAAKyyE,eAAe/uE,EAAK0U,EAAI,EAAG,EAAG,GAAI,GAAIpY,KAAKo4D,aAAahgD,EAAG5E,MAAM,GAAO,EAAO,GAKxF9P,EAAIgoC,SACN,CACF,CACO+V,kCAAkC/9C,EAA+BkvE,EAAiBx6D,EAAiBhX,EAAWC,EAAWwD,GAAiH,IAAlG2I,EAAM,uDAAG,EAAKpD,IAAO,yDAAS8mE,EAAe,wDAC1L,MAAM3tE,EAASvD,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAaC,OAAOpM,OACvF,IAAIorE,EAAiB3uE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAW4iC,iBASjG,GARI/sC,EACFukE,GAAkBnhE,EAElBmhE,GAAkBA,EAAiBnhE,EAIrC9J,EAAIM,UAAYhE,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWmhB,4BACxFw7C,EAAiB,CAInB,IAAIvpE,EAAIpE,EAASsB,EAAQ,GAAM,IAAO2I,EAASxN,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAa6E,WAAWkhB,aACvH9tB,EAAI,IACNA,EAAI,GAMNjE,EAAIU,KAAKwuE,EACX,CACF,CACQxa,aAAa5kD,GACnB,OAAOxT,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcmL,UAAUw9C,aAAa5kD,EACpF,EC7ZG,MAAMs/D,GAEXjzE,YAAY0W,GAAqB,KAD1BA,WAAK,EAEVvW,KAAKuW,MAAQA,CACf,CACO4c,mBAAmBzvB,EAA+B0U,EAAiB8X,EAAYC,EAAYC,EAAYC,GAC5G3sB,EAAI6c,OAAO2P,EAAIC,GACfzsB,EAAI6c,OAAO6P,EAAIC,EACjB,CACO0iD,aAAarvE,EAA+B0U,EAAiB8X,EAAYC,EAAYC,EAAYC,GACtG3sB,EAAI4c,OAAO4P,EAAIC,GACfzsB,EAAI6c,OAAO6P,EAAIC,EACjB,CACOY,eAAevtB,EAA+B0U,EAAiB8X,EAAYC,EAAYC,EAAYC,EAAYC,EAAYC,GAChI7sB,EAAI4c,OAAO4P,EAAIC,GACfzsB,EAAI0qE,iBAAiBh+C,EAAIC,EAAIC,EAAIC,EACnC,ECbK,MAAMyiD,GAEXnzE,YAAY0W,GAAqB,KAD1BA,WAAK,EAEVvW,KAAKuW,MAAQA,CACf,CACO4iB,eAAez1B,EAA+B1C,GAA0C,IAARuJ,EAAC,uDAAG,EACzF7G,EAAIm4D,yBAA2ByU,EAAAA,GAAAA,WAC/B5sE,EAAImV,UAAY,EAChBnV,EAAIyc,gBAAkB5V,EAEtB,IAAIkK,EAAMzU,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAawpB,UACxEhgB,sBACHxV,EAAI2c,YAAW,eAAW5L,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,UACtDA,EAAMzU,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAawpB,UACpEzgB,oBACH/U,EAAIM,UAAS,eAAWyQ,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,UAEpD/Q,EAAI0c,YAAY,CAAC,EAAG,IAEpB1c,EAAIO,YACJP,EAAI0c,YAAY,CAAC,EAAG,IACpB1c,EAAI4c,OAAOtf,EAAG,GAAGI,EAAGJ,EAAG,GAAGK,GAC1B,IAAK,IAAIJ,EAAI,EAAGA,EAAID,EAAGE,SAAUD,EAC/ByC,EAAI6c,OAAOvf,EAAGC,GAAGG,EAAGJ,EAAGC,GAAGI,GAE5BqC,EAAIS,YACJT,EAAIU,OACJV,EAAI8c,SAEJ9c,EAAI0c,YAAY,IAChB1c,EAAIm4D,yBAA2ByU,EAAAA,GAAAA,UACjC,CACOp3C,UACLx1B,EACAgiB,EACAC,GAGC,IAFD6S,EAAQ,wDACRjuB,EAAC,uDAAG,EAEJ7G,EAAIm4D,yBAA2ByU,EAAAA,GAAAA,WAC/B5sE,EAAImV,UAAY,EAChBnV,EAAIyc,gBAAkB5V,EAEtB,IAAIkK,EAAMzU,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAawpB,UACxEhgB,sBACHxV,EAAI2c,YAAW,eAAW5L,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,UACtDA,EAAMzU,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa/lB,cAAcC,aAAawpB,UACpEzgB,oBACH/U,EAAIM,UAAS,eAAWyQ,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,UAE/C+jB,EAGH90B,EAAI0c,YAAY,CAAC,EAAG,IAFpB1c,EAAI0c,YAAY,CAAC,EAAG,IAItB1c,EAAIO,YACJP,EAAI4c,OAAOoF,EAAGtkB,EAAGskB,EAAGrkB,GACpBqC,EAAI6c,OAAOmF,EAAGtkB,EAAGukB,EAAGtkB,GACpBqC,EAAI6c,OAAOoF,EAAGvkB,EAAGukB,EAAGtkB,GACpBqC,EAAI6c,OAAOoF,EAAGvkB,EAAGskB,EAAGrkB,GACpBqC,EAAIS,YACJT,EAAIU,OACJV,EAAI8c,SAEJ9c,EAAI0c,YAAY,IAChB1c,EAAIm4D,yBAA2ByU,EAAAA,GAAAA,UACjC,ECrEK,MAAM2C,GAEXpzE,YAAY0W,GAAqB,KAD1BA,WAAK,EAEVvW,KAAKuW,MAAQA,CACf,CACOmvD,SAAShiE,EAA+BtC,EAAWC,EAAW6I,GAA6B,IAAfsD,EAAM,uDAAG,EAEtFiH,EAAMzU,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAahqB,wBAAwB+f,sBAAsBC,YAC9F9nB,EAAI2c,YAAW,eAAW5L,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,UAEtD/Q,EAAIM,UAAS,eAAWyQ,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,UAEpD,IAAI9M,EAAIuC,EAAO,EAAIsD,EACf7F,EAAI,IACNA,EAAI,GAENjE,EAAIO,YACJP,EAAIe,IAAIrD,EAAGC,EAAGsG,EAAG,EAAG,EAAI2K,KAAK8Y,IAAI,GACjC1nB,EAAIS,YACJT,EAAIU,MACN,ECdK,MAAM8uE,GAGXrzE,YAAY0W,GAAqB,KAF1BA,WAAK,OACL48D,eAAgB,EAErBnzE,KAAKuW,MAAQA,CACf,CAEO6+B,iCACL1xC,EACA81B,EACA9T,EACApiB,EACAC,EACAoE,GAKC,IAFDyC,EAAgB,uCAChB5J,EAAmB,uCAEnBkD,EAAIO,YACJP,EAAIQ,KAAKwhB,EAAGtkB,EAAGskB,EAAGrkB,EAAGiC,EAAOC,GAC5BG,EAAIS,YAEJ,MAAMsQ,EAAM+kB,EAAG4e,SAASp0C,UACxBN,EAAIM,UAAS,eAAWyQ,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,QAEhDjU,IACFkD,EAAIM,UAAS,eAAWyQ,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,SAGpD+kB,EAAGziB,MAAMihC,YAAc1gC,EAAa2gC,iBACpCze,EAAGziB,MAAMihC,YAAc1gC,EAAayD,YAEpCrX,EAAIqyC,WAAa,GACjBryC,EAAImyC,YAAc,mBAClBnyC,EAAIU,OACJV,EAAIqyC,WAAa,IAGf/1C,KAAKuW,MAAMD,KAAKnR,SAASqwB,aAAa3xB,gBAAgBC,IAAIy9C,MAAM/X,kBAChEvzB,EAAAA,GAAAA,UAEAvS,EAAI2c,YAAW,eAAWmZ,EAAG0e,gBAAgB73B,YAAY,GAAE,aAAKmZ,EAAG0e,gBAAgB73B,YAAY,GAAE,aAAKmZ,EAAG0e,gBAAgB73B,YAAY,GAAE,SACnI7f,GAAc4J,KAChB1G,EAAImV,UAAY2gB,EAAG4e,SAASv/B,UAC5BnV,EAAI0c,YAAY,CAAC,EAAG,IACpB1c,EAAI8c,WAGR9c,EAAI0c,YAAY,IAEpB,CACO+wB,cACLztC,EACA81B,EACAp4B,EACAC,EACAiC,EACAC,GAEAG,EAAIO,YACJP,EAAI4c,OAAOlf,EAAIkC,EAAOjC,GACtBqC,EAAI6c,OAAOnf,EAAGC,EAAIkC,GAClBG,EAAI6c,OAAOnf,EAAIkC,EAAOjC,GACtBqC,EAAI6c,OAAOnf,EAAGC,EAAIkC,GAClBG,EAAIS,YACJT,EAAImV,UAAY2gB,EAAG2e,gBAAgBt/B,UACnCnV,EAAI2c,YAAW,eAAWmZ,EAAG2e,gBAAgB93B,YAAY,GAAE,aAAKmZ,EAAG2e,gBAAgB93B,YAAY,GAAE,aAAKmZ,EAAG2e,gBAAgB93B,YAAY,GAAE,aAAKmZ,EAAG2e,gBAAgB93B,YAAY,GAAE,KAC7K3c,EAAIM,UAAS,eAAWw1B,EAAG2e,gBAAgBn0C,UAAU,GAAE,aAAKw1B,EAAG2e,gBAAgBn0C,UAAU,GAAE,aAAKw1B,EAAG2e,gBAAgBn0C,UAAU,GAAE,aAAKw1B,EAAG2e,gBAAgBn0C,UAAU,GAAE,KACnKN,EAAIU,OACJV,EAAI8c,QACN,CACOyxB,iBACLvuC,EACA81B,EACA9T,EACAC,EACArS,EACA/I,EACAonC,EACAvnC,EACA5J,GAEA,MAAMiU,EAAM+kB,EAAG0e,gBAAgB73B,YACzBmjC,EAAS,eAAW/uC,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,aAAKA,EAAI,GAAE,KAEjE/Q,EAAIyc,eAAiB,EACrBzc,EAAIO,YAGAP,EAAI4c,OAAOoF,EAAGtkB,EAAGskB,EAAGrkB,GAWxBqC,EAAI6c,OAAOoF,EAAGvkB,EAAGukB,EAAGtkB,GACpBqC,EAAI6c,OAAOjN,EAAGlS,EAAGkS,EAAGjS,GASpBqC,EAAI0c,YAAYoZ,EAAG0e,gBAAgBv9B,MACnC3a,KAAKmzE,eAAgB,EACrBzvE,EAAI2c,YAAcmjC,EAClB9/C,EAAImV,UAAY2gB,EAAG0e,gBAAgBr/B,UACnCnV,EAAI8c,SACJ9c,EAAI0c,YAAY,KAEZhW,GAAW5J,KACbkD,EAAIO,YACJP,EAAIe,IAAI6O,EAAGlS,EAAGkS,EAAGjS,EAnCT,EAmCe,EAAG,MAC1BqC,EAAIS,YACJT,EAAI2c,YAAW,eAAWmZ,EAAGic,gBAAgBp1B,YAAY,GAAE,aAAKmZ,EAAGic,gBAAgBp1B,YAAY,GAAE,aAAKmZ,EAAGic,gBAAgBp1B,YAAY,GAAE,aAAKmZ,EAAGic,gBAAgBp1B,YAAY,GAAE,KAC7K3c,EAAIM,UAAS,eAAWw1B,EAAGic,gBAAgBzxC,UAAU,GAAE,aAAKw1B,EAAGic,gBAAgBzxC,UAAU,GAAE,aAAKw1B,EAAGic,gBAAgBzxC,UAAU,GAAE,aAAKw1B,EAAGic,gBAAgBzxC,UAAU,GAAE,KACnKN,EAAImV,UAAY2gB,EAAGic,gBAAgB58B,UACnCnV,EAAIU,OACJV,EAAI8c,SAER,ECzHK,MAAM4yD,GAgBXvzE,YAAYyW,GAAa,KAflBA,UAAI,OACJsU,WAAK,OACLi6B,kBAAY,OACZ1D,cAAQ,OACRqpB,aAAO,OACPh0D,UAAI,OACJuK,UAAI,OACJ0mB,UAAI,OACJvmB,UAAI,OACJxc,UAAI,OACJ+gE,cAAQ,OACR10C,WAAK,OACL/X,cAAQ,OACRkgB,eAAS,OACTihB,cAAQ,EAEbn6C,KAAKsW,KAAOA,EACZtW,KAAK4qB,MAAQ,IAAIqmD,GAAmBjxE,MACpCA,KAAK6kD,aAAe,IAAIytB,GAA0BtyE,MAClDA,KAAKmhD,SAAW,IAAIwxB,GAAsB3yE,MAC1CA,KAAKwW,KAAO,IAAIu6D,GAAkB/wE,MAClCA,KAAKwqE,QAAU,IAAIgF,GAAqBxvE,MACxCA,KAAK+gB,KAAO,IAAIwvD,GAAkBvwE,MAClCA,KAAKynC,KAAO,IAAIqpC,GAAkB9wE,MAClCA,KAAKkhB,KAAO,IAAI4tD,GAAkB9uE,MAClCA,KAAK0E,KAAO,IAAIwuE,GAAkBlzE,MAClCA,KAAK+wB,MAAQ,IAAI2+C,GAAmB1vE,MACpCA,KAAKgZ,SAAW,IAAI85D,GAAsB9yE,MAC1CA,KAAKk5B,UAAY,IAAI85C,GAAuBhzE,MAC5CA,KAAKm6C,SAAW,IAAIk2B,GAAsBrwE,MAC1CA,KAAKylE,SAAW,IAAIwN,GAAsBjzE,KAC5C,EC5CK,MAAMqzE,GAIXxzE,YAAYsF,GAAqB,KAH1BoR,WAAK,OACL+oC,WAAK,OACLn6C,cAAQ,EAEbnF,KAAKmF,SAAWA,EAChBnF,KAAK8R,MACP,CACOA,OACL9R,KAAKuW,MAAQ,IAAI68D,GAAYpzE,MAC7BA,KAAKs/C,MAAQ,IAAIsvB,GAAY5uE,KAC/B,ECJK,MAAMikE,GAuCXpkE,YAAY21B,EAA4B27C,GAAkC,IAAjB5V,EAAS,uDAAG,GAAE,KAtChE/lC,kBAAY,OACZmL,eAAS,OACTrqB,UAAI,OACJkL,eAAS,OACT8xD,SAAG,OACHvF,UAAY,EAAE,KACdv9D,eAAS,OACT0oB,eAAS,OACT3uB,OAAC,OACDgxD,eAAS,OACT4C,YAAM,OACN5xC,UAAI,OACJC,UAAI,OACJuxC,iBAAW,OACXC,iBAAW,OACXC,aAAO,OACPC,aAAO,OACPE,gBAAU,OACVC,mBAAa,OACbC,uBAAiB,OACjB/2D,mBAAa,OACbgsE,cAAe,EAAM,KACrB7vE,SAAG,OACHge,kBAAY,OAEZkgB,oBAAc,OACdlrB,qBAAe,OACf88D,SAAU,EAAM,KAEhBrC,QAAS,EAAM,KAEZ9J,WAAa,EAAE,KACfoM,iBAAmB,EAAE,KACrBC,eAAiB,EAAE,KAErBC,wBAAyB,EAAK,KAC9BC,YAAa,EAAM,KACnB7kD,MAAQ,EAEd/uB,KAAKw1B,aAAeA,EACpBx1B,KAAK0W,gBAAkB,IAAIm9D,EAAAA,GAC3B7zE,KAAKuK,EAAI,EACTvK,KAAKmxE,OAASA,EACdnxE,KAAKu7D,UAAYA,EACjBv7D,KAAKuH,eAAgB,EAErBvH,KAAKszE,IAAM,IAAI9F,GAAiBxtE,MAEhCA,KAAK4hC,eAAiB,IAAIwlC,GAAepnE,MACzCA,KAAKsW,KAAO,IAAI+8D,GAAKrzE,MACrBA,KAAKwhB,UAAY,IAAIwsD,GAAuBhuE,MAI1CA,KAAKw1B,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeqmB,cAAcC,cACzEC,EAAAA,GAAAA,YAEAr8B,KAAK8zE,cAEP9zE,KAAKk5B,UAAY,IAAIX,EAAWv4B,KAAKw1B,aAAa7xB,OAC9C3D,KAAKuH,gBACPvH,KAAKwQ,UAAY,IAAIq0D,GAAU7kE,KAAKw1B,aAAa7xB,OAErD,CACOu7D,WACLl/D,KAAK+zE,YAIL/zE,KAAKg0E,0BACLh0E,KAAK2gC,UAAY,IAAIia,GAAU56C,KACjC,CACWsU,gBACT,OAAOtU,KAAK4zE,UACd,CACWt/D,cAAUpR,GAEnBlD,KAAK4zE,YAAa,CACpB,CACWv+D,SACT,OAAOrV,KAAKw1B,aAAa5mB,oBAAoBmD,cAAcC,QAAQspD,UAAUjmD,EAC/E,CACO2+D,0BACLh0E,KAAK0hB,aAAe1hB,KAAKw1B,aAAa5mB,oBAAoBmD,cAAcwlD,iBAAiBqG,YAC3F,CACOkW,cAEL,CAEKC,YACL/zE,KAAKusB,KAAO,EACZvsB,KAAKwsB,KAAO,EACZxsB,KAAK+9D,YAAc,EACnB/9D,KAAKg+D,YAAc,EACnBh+D,KAAKi+D,QAAU,EACfj+D,KAAKk+D,QAAU,EACfl+D,KAAKo+D,WAAa,EAClBp+D,KAAKq+D,cAAgB,EACrBr+D,KAAKs+D,kBAAoB,EACzBt+D,KAAKm+D,OAAS,IAAI97D,EAAAA,GAAS,EAAG,EAAG,EACnC,CACO4xE,wBACL,MAAMnzE,EAAO,IAAIwhE,IAEjB,IADAtiE,KAAK+uB,MAAQ/uB,KAAKw1B,aAAa7xB,MAAMktD,aAAa3vD,OAC3ClB,KAAK+uB,SAAS,CACnB,MAAMklB,EAAIj0C,KAAKw1B,aAAa7xB,MAAMktD,aAAa7wD,KAAK+uB,OAAOvlB,cACjD7G,IAANsxC,GACFnzC,EAAK0hE,IAAIxiE,KAAKw1B,aAAa7xB,MAAMktD,aAAa7wD,KAAK+uB,OAAOzuB,GAAI2zC,EAElE,CACA,OAAOnzC,CACT,CACOglC,OACL,CAEKriC,OAAOC,GACZ1D,KAAKk0E,YACLl0E,KAAK2N,UAAUjK,GACnBywE,QAAQ1X,IAAI,gBAERz8D,KAAKszE,IAAI7F,UAAU/pE,GAEnB1D,KAAKwP,WAAW9L,GAChB1D,KAAKo0E,YACP,CACWC,4BACT,OAAOr0E,KAAK2zE,sBACd,CACWU,0BAAsBnxE,GAC/BlD,KAAK2zE,uBAAyBzwE,EAC9BlD,KAAKuK,EAAI,CACX,CACOg1D,UACL,CAEKr+B,iBAAiB5zB,GACtB,IAAIgnE,GAAsB,EAG1B,IAFAt0E,KAAK+uB,MAAQ/uB,KAAKw1B,aAAa7xB,MAAMktD,aAAa3vD,OAE3ClB,KAAK+uB,SAGN/uB,KAAKw1B,aAAa7xB,MAAMktD,aAAa7wD,KAAK+uB,OAAOhpB,kBACnDuuE,GAAsB,GAEpBt0E,KAAKw1B,aAAa7xB,MAAMktD,aAAa7wD,KAAK+uB,OAAOlc,cAAcvF,EAAElM,EAAGkM,EAAEjM,IACxErB,KAAKw1B,aAAa7xB,MAAMktD,aAAa7wD,KAAK+uB,OAAO3kB,SAAU,EAU3DpK,KAAKw1B,aAAarf,eAAe2M,eAAequC,kBAC9CnxD,KAAKw1B,aAAa7xB,MAAMktD,aAAa7wD,KAAK+uB,QAE5CulD,GAAsB,GAEtBt0E,KAAKw1B,aAAa7xB,MAAMktD,aAAa7wD,KAAK+uB,OAAO3kB,SAAU,EAK1DkqE,GACHt0E,KAAKw1B,aAAarf,eAAe2M,eAAequC,uBAAkBxuD,GAEpE3C,KAAKw1B,aAAarwB,SAASmP,UAAYggE,EACvCt0E,KAAKw1B,aAAahqB,wBAAwB8C,aAAag7C,YAAcgrB,CACvE,CACQJ,YAON,GANAl0E,KAAKw1B,aAAa7xB,MAAMd,QACxB7C,KAAKusB,KAAOvsB,KAAK+9D,YAAc/9D,KAAKi+D,QACpCj+D,KAAKwsB,KAAOxsB,KAAKg+D,YAAch+D,KAAKk+D,QACpCl+D,KAAKo+D,WAAap+D,KAAKs+D,kBAAoBt+D,KAAKq+D,cAChDr+D,KAAKuK,GAAK,IACVvK,KAAK+uB,MAAQ/uB,KAAKw1B,aAAa7xB,MAAMguD,cAAczwD,OAC/ClB,KAAKq0E,sBAAuB,CAK9B,GAFAr0E,KAAKw1B,aAAahqB,wBAAwB8C,aAAayY,WAAY,EAE/D/mB,KAAKyzE,mBAAqB,IAAM,EAClC,KAAOzzE,KAAK+uB,SACV/uB,KAAKw1B,aAAa7xB,MAAMguD,cAAc3xD,KAAK+uB,OAAOvrB,QAAO,GAGzDxD,KAAKuK,EAAI,KAGXvK,KAAKw1B,aAAahqB,wBAAwB8C,aAAayY,WAAY,EACnE/mB,KAAKq0E,uBAAwB,EAEjC,MAEE,GACEr0E,KAAKw1B,aAAahqB,wBAAwB8C,aAAayY,WACvD/mB,KAAKw1B,aAAahqB,wBAAwB8C,aAAak8C,UAGvD,KAAOxqD,KAAK+uB,SACV/uB,KAAKw1B,aAAa7xB,MAAMguD,cAAc3xD,KAAK+uB,OAAOvrB,cAGpD,GAAIxD,KAAKyzE,mBAAqB,IAAM,EAElC,KAAOzzE,KAAK+uB,SACV/uB,KAAKw1B,aAAa7xB,MAAMguD,cAAc3xD,KAAK+uB,OAAOvrB,SAM1DxD,KAAK2gC,UAAUn9B,QACjB,CACQ4wE,aACNp0E,KAAKi+D,QAAUj+D,KAAK+9D,YACpB/9D,KAAKk+D,QAAUl+D,KAAKg+D,YACpBh+D,KAAKq+D,cAAgBr+D,KAAKs+D,iBAC5B,CACQ3wD,UAAUjK,GACZ1D,KAAKwQ,WACPxQ,KAAKwQ,UAAU/M,OAAOC,EAE1B,CACQ8L,WAAW9L,GAaf,IARG1D,KAAKw1B,aAAa3xB,gBAAgBC,IAAIkI,MAAM8J,eAAeqmB,cAAcC,YAAgBC,EAAAA,GAAAA,WAO5Fr8B,KAAK+uB,MAAQ/uB,KAAKw1B,aAAa7xB,MAAM4vD,SAASryD,OACvClB,KAAK+uB,SACV/uB,KAAKw1B,aAAa7xB,MAAM4vD,SAASvzD,KAAK+uB,OAAOtrB,OAAOC,GASxD1D,KAAKu0E,mBAAmB7wE,GAExB1D,KAAKk5B,UAAUz1B,OAAOC,EACxB,CAaO6wE,mBAAmB7wE,GACxB1D,KAAKw1B,aAAa7xB,MAAM0lB,cAAckrD,mBAAmB7wE,EAC3D,EC9QK,MAAM8wE,GAKX30E,YAAYw1D,EAAwBof,EAA0BjpD,EAAqBkpD,GAAsB,KAJzGrf,SAAyB,GAAG,KAC5B7pC,YAAsB,UAAU,KAChCkpD,YAAsB,EAAE,KACxBD,iBAA2B,EAEzBz0E,KAAKq1D,SAAWA,EAChBr1D,KAAKy0E,gBAAkBA,EACvBz0E,KAAKwrB,YAAcA,EACnBxrB,KAAK00E,YAAcA,CACrB,EAEK,MAAMC,WAAqBC,EAAAA,GAIhC/0E,cACEqF,QAAQ,KAHA2vE,QAAwB,EAIlC,CACOC,YAAYh0E,EAAoB2zE,EAA0BjpD,EAAqBkpD,GACpF10E,KAAKmB,KAAK,IAAIqzE,GAAW1zE,EAAM2zE,EAAiBjpD,EAAakpD,GAC/D,CACOvzE,KAAKL,GACNd,KAAK+0E,aAAe/0E,KAAK60E,QAAQ3zE,OAAS,GAC5ClB,KAAK60E,QAAQz3D,OAAOpd,KAAK+0E,aAAe,EAAG/0E,KAAK60E,QAAQ3zE,QAE1DlB,KAAK60E,QAAQ1zE,KAAKL,GAClBd,KAAK+0E,aAAe/0E,KAAK60E,QAAQ3zE,OAAS,CAC5C,CACO4zB,OACL,GAA0B,IAAtB90B,KAAK+0E,aAIT,OADA/0E,KAAK+0E,eACE/0E,KAAK60E,QAAQ70E,KAAK+0E,aAC3B,CACOjgB,OAGL,OAFA90D,KAAK+0E,eACL/0E,KAAK+0E,aAAe/0E,KAAK+0E,aAAe/0E,KAAK60E,QAAQ3zE,OAASlB,KAAK+0E,aAAe/0E,KAAK60E,QAAQ3zE,OAAS,EACjGlB,KAAK60E,QAAQ70E,KAAK+0E,aAC3B,EC/CK,MAAMC,GAOTn1E,YAAY8D,GAAe,KANpBA,WAAK,OACLD,SAAG,OAIH4lB,wBAAkB,EAErBtpB,KAAK2D,MAAQA,CACjB,CACOsxE,kBAAkB7zE,EAAWC,GAChC,GAAQrB,KAAKspB,mBAAmB/S,QACvB2+D,EAAAA,GAAAA,OAAL,CACI,MAAMC,EAAen1E,KAAK2D,MAAMC,mBAAmBC,gBAAgBC,IAAIkI,MAAM+iD,aAAaC,uBAAuB5tD,EAAGC,GAEpH,OAAkB,IADRrB,KAAK0D,IAAIquD,aAAaojB,EAAa,GAAIA,EAAa,GAAI,EAAG,GAC/Dr0E,KAAK,EAIX,CAGA,OAAO,CAEjB,CACKs0E,mBAAmB7zB,GACtB,MAAM7d,EAASh4B,SAASC,cAAc,UAEtC+3B,EAAO93B,MAAMtI,MAAQ,OACrBogC,EAAO93B,MAAMrI,OAAS,OAEtBvD,KAAK0D,IAAMggC,EAAOk4B,WAAW,MAC7Bl4B,EAAOpgC,MAAQi+C,EAAMj+C,MACrBogC,EAAOngC,OAASg+C,EAAMh+C,OACtBvD,KAAKspB,mBAAqBi4B,EAE1BvhD,KAAK2D,MAAMC,mBAAmBuS,eAAeC,eAAevH,cAC5D7O,KAAKq1E,cAAcr1E,KAAK0D,IAC5B,CACO4xE,gBACCt1E,KAAKspB,mBAAmBisD,cAUhC,CACOC,qBACHx1E,KAAKspB,mBAAmBisD,gBAAkBv1E,KAAKspB,mBAAmBisD,cAEtE,CACOhB,mBAAmB7wE,GAClB1D,KAAKspB,mBAAmBisD,iBACxBE,EAAAA,EAAAA,IAAqB/xE,EAAK1D,KAAKspB,mBAAmB/S,MAAO,EAAG,EAAGvW,KAAKspB,mBAAmBhmB,MAAOtD,KAAKspB,mBAAmB/lB,QAAQ,GAGlIvD,KAAKs1E,eAoDT,CACQD,cAAc3xE,GAChB,GAAQ1D,KAAKspB,mBAAmB/S,QACzB2+D,EAAAA,GAAAA,OAAL,CACE,MAAM5xE,EAAwC,GAAhCtD,KAAKspB,mBAAmBhmB,MAChCC,EAA0C,GAAjCvD,KAAKspB,mBAAmB/lB,OACvCG,EAAIO,YACJP,EAAIQ,MAAM,GAAI,EAAGR,EAAIggC,OAAOpgC,MAAQ,EAAGI,EAAIggC,OAAOngC,OAAS,GAC3DG,EAAIinB,QAAQrnB,EAAQC,EAAQD,EAAOC,EAAQ,EAAG,EAAa,EAAV+O,KAAK8Y,IACtD1nB,EAAIS,YACJT,EAAIU,KAAK,UACJ,MAGLV,EAAIO,YACJP,EAAIQ,KAAK,EAAG,EAAGR,EAAIggC,OAAOpgC,MAAOtD,KAAKspB,mBAAmBjoB,GACzDqC,EAAIQ,KAAK,EAAGlE,KAAKspB,mBAAmBjoB,EAAIrB,KAAKspB,mBAAmB/lB,OAAQG,EAAIggC,OAAOpgC,MAAOI,EAAIggC,OAAOngC,QACrGG,EAAIQ,KAAK,EAAG,EAAGlE,KAAKspB,mBAAmBloB,EAAGsC,EAAIggC,OAAOngC,QACrDG,EAAIQ,KAAKlE,KAAKspB,mBAAmBloB,EAAIpB,KAAKspB,mBAAmBhmB,MAAQ,EAAGI,EAAIggC,OAAOpgC,MAAOI,EAAIggC,OAAOngC,QACrGG,EAAIS,YACJT,EAAIU,MAGd,EC7GG,MAAMsxE,GAkCX71E,YAAY21B,GAA6B,KAjClCq7B,aAAgC,GAAG,KACnCc,cAA8B,GAAG,KACjC11C,WAAuB,GAAG,KAC1BypC,WAAqC,GAAG,KACxC1C,WAAsC,GAAG,KACzCsQ,WAAkC,GAAG,KACrC1B,sBAA6C,GAAG,KAChD5sB,oBAAwC,GAAG,KAC3CljB,qBAA2C,GAAG,KAC9CsF,oBAAyC,GAAG,KAC5CuuD,iBAAmC,GAAG,KACtC5kB,yBAAmD,GAAG,KACtDj7B,0BAAqD,GAAG,KACxDf,8BAA6DpyB,EAAU,KACvEqrC,WAAuB,GAAG,KAC1BlC,WAAuB,GAAG,KAC1B6hC,cAA6B,GAAG,KAChCD,0BAAqD,GAAG,KACxDriB,2BAAuD,GAAG,KAC1DkI,SAAmB,GAAG,KACtBlC,cAAoC,CAAC,EAAE,KACvCf,aAAgC,GAAG,KACnCslB,gBAAwCjzE,EAAU,KAClDgQ,aAAqChQ,EAAU,KAC/C+a,eAAgC/a,EAAU,KAC1CixD,qBAA+CjxD,EAAU,KACzD0/B,oBAA4C1/B,EAAU,KACtDsyD,sBAA8CtyD,EAAU,KACxDq9B,iBAAkDr9B,EAAU,KAC5DkzE,kBAAY,OACZxsD,mBAAa,OACbzlB,wBAAkB,OAClBkyE,kBAA4B,EAEjC91E,KAAK4D,mBAAqB4xB,EAC1Bx1B,KAAK61E,aAAe,IAAIlB,GACxB30E,KAAKqpB,cAAgB,IAAI2rD,GAAch1E,KACzC,CACO80B,OACL,MAAM4rC,EAAU1gE,KAAK61E,aAAa/gD,YAElBnyB,IAAZ+9D,EACF1gE,KAAK4D,mBAAmBuS,eAAe2M,eAAe4vC,oBAEtD1yD,KAAK4D,mBAAmB4H,wBAAwB2hD,eAAeuT,EAAQgU,aACvE10E,KAAK4D,mBAAmB4H,wBAAwBqiD,iBAAiB6S,EAAQrL,UAErEqL,EAAQ+T,kBAAoBz0E,KAAK81E,mBAE7BpV,EAAQ+T,gBACVz0E,KAAK4D,mBAAmBC,gBAAgBC,IAAIkI,MAAM+iD,aAAagnB,eAK/D/1E,KAAK4D,mBAAmBC,gBAAgBC,IAAIkI,MAAM+iD,aAAainB,iBAMrEh2E,KAAK81E,iBAAmBpV,EAAQ+T,gBAChCz0E,KAAK4D,mBAAmBC,gBAAgBC,IAAImyE,IAAIC,6BAChDl2E,KAAKm2E,uBAEPn2E,KAAK4D,mBAAmBuB,SAASmP,WAAY,CAC/C,CACOwgD,OACL,MAAM4L,EAAU1gE,KAAK61E,aAAa/gB,YAElBnyD,IAAZ+9D,IACF1gE,KAAK4D,mBAAmB4H,wBAAwB2hD,eAAeuT,EAAQgU,aACvE10E,KAAK4D,mBAAmB4H,wBAAwBqiD,iBAAiB6S,EAAQrL,UAKrEqL,EAAQ+T,kBAAoBz0E,KAAK81E,mBAE/BpV,EAAQ+T,gBACVz0E,KAAK4D,mBAAmBC,gBAAgBC,IAAIkI,MAAM+iD,aAAagnB,eAI/D/1E,KAAK4D,mBAAmBC,gBAAgBC,IAAIkI,MAAM+iD,aAAainB,iBAMnEh2E,KAAK81E,iBAAmBpV,EAAQ+T,gBAChCz0E,KAAKm2E,uBAEPn2E,KAAK4D,mBAAmBuB,SAASmP,WAAY,CAC/C,CAIOy3C,eAGL,MAAMiH,EAA2B,GACjC,IAAK,IAAI/xD,EAAI,EAAGA,EAAIjB,KAAK6wD,aAAa3vD,SAAUD,EAAG,CACjD,MAAMH,EAAOd,KAAK6wD,aAAa5vD,GAAGuI,SAC9B1I,GACFkyD,EAAW7xD,KAAKL,EAEpB,CAEAd,KAAK81E,iBAAmB91E,KAAK4D,mBAAmBC,gBAAgBC,IAAIkI,MAAM+iD,aAAa+mB,iBACvF,MAAMtqE,EAA0BxL,KAAK4D,mBAAmB4H,wBACxDxL,KAAK61E,aAAaf,YAAY9hB,EAAYhzD,KAAK81E,iBAAkBtqE,EAAwB+f,sBAAsB4gC,iBAAkB3gD,EAAwBoC,aACzJ5N,KAAKm2E,qBACP,CACOA,sBACL,MAAMtB,EAAU70E,KAAK61E,aAAaO,kBAClCp2E,KAAK4D,mBAAmBmG,GAAGirD,WAAW,WAAD,OAAY9gB,KAAKyD,UAAUk9B,IAClE,CACO9rE,YAAYsH,GACjBrQ,KAAK6wD,aAAa1vD,KAAKkP,EACzB,CACOoO,eAAepO,GACpBrQ,KAAK6wD,aAAazzC,OAAOpd,KAAK6wD,aAAap+C,QAAQpC,GAAI,EACzD,CACOwB,aAAaxB,GAClBrQ,KAAK2xD,cAAcxwD,KAAKkP,EAC1B,CACOkO,gBAAgBlO,GACrBrQ,KAAK2xD,cAAcv0C,OAAOpd,KAAK2xD,cAAcl/C,QAAQpC,GAAI,EAC3D,CACOwM,UAAUxM,GACfrQ,KAAKic,WAAW9a,KAAKkP,EACvB,CACOmO,aAAanO,GAClBrQ,KAAKic,WAAWmB,OAAOpd,KAAKic,WAAWxJ,QAAQpC,GAAI,EACrD,CACOy1C,UAAUz1C,GACfrQ,KAAK0lD,WAAWvkD,KAAKkP,EACvB,CACO21C,aAAa31C,GAClBrQ,KAAK0lD,WAAWtoC,OAAOpd,KAAK0lD,WAAWjzC,QAAQpC,GAAI,EACrD,CACOqzC,UAAUrzC,GACfrQ,KAAKgjD,WAAW7hD,KAAKkP,EACvB,CACOyzC,aAAazzC,GAClBrQ,KAAKgjD,WAAW5lC,OAAOpd,KAAKgjD,WAAWvwC,QAAQpC,GAAI,EACrD,CACOmwC,UAAUnwC,GACfrQ,KAAKszD,WAAWnyD,KAAKkP,EACvB,CACO4wC,aAAa5wC,GAClBrQ,KAAKszD,WAAWl2C,OAAOpd,KAAKszD,WAAW7gD,QAAQpC,GAAI,EACrD,CAEOqf,qBAAqBrf,GAC1BrQ,KAAK4xD,sBAAsBzwD,KAAKkP,EAClC,CACOsf,wBAAwBtf,GAC7BrQ,KAAK4xD,sBAAsBx0C,OAAOpd,KAAK4xD,sBAAsBn/C,QAAQpC,GAAI,EAC3E,CACOoe,kBAAkBpe,GACvBrQ,KAAKglC,oBAAoB7jC,KAAKkP,EAChC,CACO2e,cAAc3e,GACnBrQ,KAAKglC,oBAAoB5nB,OAAOpd,KAAKglC,oBAAoBvyB,QAAQpC,GAAI,EACvE,CAEOq+B,UAAUr+B,GACfrQ,KAAKguC,WAAW7sC,KAAKkP,EACvB,CACOu+B,aAAav+B,GAClBrQ,KAAKguC,WAAW5wB,OAAOpd,KAAKguC,WAAWv7B,QAAQpC,GAAI,EACrD,CACO+7B,UAAU/7B,GACfrQ,KAAK8rC,WAAW3qC,KAAKkP,EACvB,CACOi8B,aAAaj8B,GAClBrQ,KAAK8rC,WAAW1uB,OAAOpd,KAAK8rC,WAAWr5B,QAAQpC,GAAI,EACrD,CACOstC,aAAattC,GAClBrQ,KAAK2tE,cAAcxsE,KAAKkP,EAC1B,CACOytC,gBAAgBztC,GACrBrQ,KAAK2tE,cAAcvwD,OAAOpd,KAAK2tE,cAAcl7D,QAAQpC,GAAI,EAC3D,CACOwqC,yBAAyBxqC,GAC9BrQ,KAAK0tE,0BAA0BvsE,KAAKkP,EACtC,CACO8sC,4BAA4B9sC,GACjCrQ,KAAK0tE,0BAA0BtwD,OAAOpd,KAAK0tE,0BAA0Bj7D,QAAQpC,GAAI,EACnF,CAEOumB,yBAAyBvmB,GAC9BrQ,KAAK81B,0BAA0B30B,KAAKkP,EACtC,CACOmnB,4BAA4BnnB,GACjCrQ,KAAK81B,0BAA0B1Y,OAAOpd,KAAK81B,0BAA0BrjB,QAAQpC,GAAI,EACnF,CACOwT,oBAAoBxT,GACzBrQ,KAAK8hB,qBAAqB3gB,KAAKkP,EACjC,CACOuU,uBAAuBvU,GAC5BrQ,KAAK8hB,qBAAqB1E,OAAOpd,KAAK8hB,qBAAqBrP,QAAQpC,GAAI,EACzE,CACOsX,mBAAmBtX,GACxBrQ,KAAKonB,oBAAoBjmB,KAAKkP,EAChC,CACOuX,sBAAsBvX,GAC3BrQ,KAAKonB,oBAAoBhK,OAAOpd,KAAKonB,oBAAoB3U,QAAQpC,GAAI,EACvE,CACOm6B,wBAAwBn6B,GAC7BrQ,KAAK+wD,yBAAyB5vD,KAAKkP,EACrC,CACOo6B,2BAA2Bp6B,GAChCrQ,KAAK+wD,yBAAyB3zC,OAAOpd,KAAK+wD,yBAAyBt+C,QAAQpC,GAAI,EACjF,CACOgmE,gBAAgBhmE,GACrBrQ,KAAK21E,iBAAiBx0E,KAAKkP,EAC7B,CACOimE,mBAAmBjmE,GACxBrQ,KAAK21E,iBAAiBv4D,OAAOpd,KAAK21E,iBAAiBljE,QAAQpC,GAAI,EACjE,CACOqpC,0BAA0BrpC,GAC/BrQ,KAAKqrD,2BAA2BlqD,KAAKkP,EACvC,CACOkkC,6BAA6BlkC,GAClCrQ,KAAKqrD,2BAA2BjuC,OAAOpd,KAAKqrD,2BAA2B54C,QAAQpC,GAAI,EACrF,CACOkmE,QAAQlmE,GACbrQ,KAAKuzD,SAASpyD,KAAKkP,EACrB,CACOmmE,WAAWnmE,GAChBrQ,KAAKuzD,SAASn2C,OAAOpd,KAAKuzD,SAAS9gD,QAAQpC,GAAI,EACjD,CACOpH,UACL,OAAOA,EAAAA,EAAAA,KACT,CACOC,aAAaxH,GAElB,OAAa,CACX,MAAM+S,GAAM28C,EAAAA,EAAAA,MACZ,IAAKpxD,KAAKqxD,cAAc58C,GAEtB,OADAzU,KAAKqxD,cAAc58C,GAAO/S,EACnB+S,CAEX,CACF,CACWqK,cACT,OAAO9e,KAAK2S,OACd,CACWmM,YAAQzO,GACbrQ,KAAK4D,mBAAmBC,gBAAgBC,IAAIC,kBACpCpB,IAAN0N,EACFrQ,KAAK4D,mBAAmB4H,wBAAwB0zB,UAAU/9B,KAAK,aAE/DnB,KAAK4D,mBAAmB4H,wBAAwB0zB,UAAU/9B,KAAKkP,EAAE9P,YAIhDoC,IAAjB3C,KAAK2S,UACP3S,KAAK2S,QAAQlM,iBAAkB,GAIjCzG,KAAK41E,WAAa51E,KAAK2S,QACnB3S,KAAK41E,aACP51E,KAAK41E,WAAWnvE,iBAAkB,GAGpCzG,KAAK2S,QAAUtC,EACXrQ,KAAK2S,UACP3S,KAAK4D,mBAAmBuS,eAAe2M,eAAeiH,4BACpD/pB,KAAK2S,SAEP3S,KAAK2S,QAAQlM,iBAAkB,EAE/BzG,KAAK2S,QAAQ3C,oBAGjB,CACOnN,QACL,CAGK08D,UACLv/D,KAAK4D,mBAAmBuS,eAAe2M,eAAeoZ,WACxD,ECrSK,MAAMu6C,GAaX52E,YAAYgE,EAAkCstE,EAAiBvc,EAAmBv8C,GAAc,KAXzF1U,WAAK,OACLiL,yBAAmB,OACnB/K,qBAAe,OACfsS,oBAAc,OACd3K,6BAAuB,OACvBrG,cAAQ,OACR4E,QAAE,OACF0F,mBAAa,OACb+5B,qBAAe,OACflO,gBAAU,EAGft7B,KAAK6D,gBAAkBA,EACvB7D,KAAKwpC,gBAAkBxpC,KAAK6D,gBAAgBC,IAAIkI,MAAM8J,eAAeC,oBAAoBC,KACzFhW,KAAKs7B,WAAa,IAAIs8B,GAAW53D,MACjCA,KAAK4O,oBAAsB,IAAIuxD,GAAoBngE,KAAM40D,GACzD50D,KAAK2D,MAAQ,IAAI+xE,GAAM11E,MACvBA,KAAKmF,SAAW,IAAI8+D,GAASjkE,KAAMmxE,GACnCnxE,KAAK+J,GAAK,IAAIg6D,GAAqB/jE,MACnCA,KAAKmW,eAAiB,IAAI2/C,GAAe91D,MACzCA,KAAKwL,wBAA0B,IAAIghD,GAAwBxsD,MAC3DA,KAAKyP,cAAgB,IAAIurD,GAAch7D,KAAMqY,GAC7CrY,KAAKmF,SAASzB,IAAM1D,KAAK4O,oBAAoBmD,cAAcC,QAAQtO,IACnE1D,KAAKmF,SAASuc,aAAe1hB,KAAK4O,oBAAoBmD,cAAcwlD,iBAAiBqG,aACjF59D,KAAKwpC,eAGX,CACO01B,WACLl/D,KAAK4O,oBAAoBswD,WACzBl/D,KAAK4O,oBAAoBmD,cAAcC,QAAQotD,uBAAwB,EACvEp/D,KAAKmF,SAAS+5D,UAChB,CACOtC,OAAOt5D,EAAeC,GAC3BvD,KAAK4O,oBAAoB8+C,aAAapqD,EAAOC,EAC/C,CACOg8D,UACLv/D,KAAKmF,SAASo6D,UAEdv/D,KAAK4O,oBAAoB2wD,SAC3B,CAEOlhC,qBAAqB/wB,GAC1BtN,KAAKwL,wBAAwB8uB,cAAc+D,qBAAqB/wB,EAClE,CACOo0D,WAAWx+D,GAChBlD,KAAK+J,GAAGi6D,0BAA0BtC,WAAWx+D,EAC/C,EC7DK,MAAMwzE,GAMX72E,YAAYiE,EAAsB8sD,GAAuB,KALlD9sD,SAAG,OACH8sD,aAAO,OACPp7B,kBAAY,OACZmhD,YAAM,EAGX32E,KAAK4wD,QAAUA,EACf5wD,KAAK8D,IAAMA,CAIb,CAEO8yE,6BAA6BzF,EAAiBvc,EAAmBv8C,GACtErY,KAAKw1B,aAAe,IAAIihD,GAAaz2E,KAAMmxE,EAAQvc,EAAUv8C,EAC/D,CAEOw+D,0BAA0B1F,EAAiBvc,EAAmBv8C,GACnE,CAGSu0B,mBAAe1pC,GACpBlD,KAAKw1B,eACPx1B,KAAKw1B,aAAahqB,wBAAwB8C,aAAas+B,eAAiB1pC,EAK5E,CACW4zE,iBAAa5zE,GAClBlD,KAAKw1B,eACPx1B,KAAKw1B,aAAahqB,wBAAwB6b,aAAenkB,EAK7D,CACW6zE,gBAAY7zE,GAChBA,GACClD,KAAKw1B,cACHx1B,KAAKw1B,aAAa5mB,oBAAoBmD,cAAc0xB,cACtDzjC,KAAKw1B,aAAa5mB,oBAAoBmD,cAAc0xB,YAAYngC,MAAQ,EAIhF,CAEO0zE,kBAGL,CAGKC,UAAU/zE,GACXlD,KAAKw1B,cACPx1B,KAAKw1B,aAAarf,eAAeC,eAAeo/C,cAActyD,EAElE,CAEOg8D,WACDl/D,KAAKw1B,cACPx1B,KAAKw1B,aAAa0pC,UAEtB,CACOtC,OAAOt5D,EAAeC,GACvBvD,KAAKw1B,cACPx1B,KAAKw1B,aAAaonC,OAAOt5D,EAAOC,EAEpC,CACO2zE,QAAc,IAAR3sE,EAAC,uDAAG,EACXvK,KAAKw1B,cACPx1B,KAAKw1B,aAAa5mB,oBAAoB4gD,MAAMjlD,EAEhD,CACOklD,SACDzvD,KAAKw1B,cACPx1B,KAAKw1B,aAAa5mB,oBAAoB6gD,QAE1C,CACOpxB,qBAAqB/wB,GAC1BtN,KAAKm3E,eAAe7pE,GAChBtN,KAAKw1B,cACPx1B,KAAKw1B,aAAa6I,qBAAqB/wB,GAErCtN,KAAK22E,QACP32E,KAAK22E,OAAOt4C,qBAAqB/wB,EAErC,CACOutB,wBAAwBtB,GAC7Bv5B,KAAKm3E,eAAe59C,GAChBv5B,KAAKw1B,cACPx1B,KAAKw1B,aAAahqB,wBAAwB8uB,cAAcO,wBAAwBtB,EAEpF,CACO2B,oCAAoC3B,GACzCv5B,KAAKm3E,eAAe59C,GAChBv5B,KAAKw1B,cACPx1B,KAAKw1B,aAAahqB,wBAAwB8uB,cAAcY,oCAAoC3B,EAEhG,CACOuK,qBAAqBv5B,GAC1BvK,KAAKm3E,eAAe5sE,GAChBvK,KAAKw1B,cACPx1B,KAAKw1B,aAAahqB,wBAAwB8uB,cAAcwJ,qBAAqBv5B,EAEjF,CACO9G,OAAOC,GACR1D,KAAKw1B,cACPx1B,KAAKw1B,aAAarwB,SAAS1B,OAAOC,EAEtC,CACO67D,UACDv/D,KAAKw1B,cACPx1B,KAAKw1B,aAAa+pC,UAEhBv/D,KAAK22E,QACP32E,KAAK22E,OAAOpX,SAEhB,CACOmC,WAAWx+D,GAEZlD,KAAKw1B,cACPx1B,KAAKw1B,aAAaksC,WAAWx+D,GAE3BlD,KAAK22E,QACP32E,KAAK22E,OAAOjV,WAAWx+D,EAE3B,CAQQi0E,eAAe7pE,GACjBtN,KAAKw1B,cAAiBx1B,KAAKw1B,aAAahqB,wBAAwB8C,aAAa4kB,WAKnF,E","sources":["njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/lib/IOGeometry/IOGeometry.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/lib/Extended/GeometryUtility.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Common/Base/ComponentTemplate/CollisionComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Common/Base/Inspector/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Common/Base/AGeometryBase.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Common/Base/APointBase.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/Helper/InterpolateColor.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/Helper/Timer.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Common/Base/ComponentTemplate/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/Base/Component/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Customization/ThemeRenderStyle/Utility.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/Helper/NColor.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/Helper/RenderStyle.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Common/Base/ComponentTemplate/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/Base/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/Base/Inspector/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/Base/APoint.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyLine/APolylineWrapper/Component/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyLine/APolylineWrapper/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyLine/APolylineWrapper/APolylineWrapper.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/APolygonWrapper/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/APolygonWrapper/APolygonWrapper.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/Helper/Dimension.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ACircleWrapper/Component/InteractionComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ACircleWrapper/Component/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ACircleWrapper/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Common/Base/ComponentTemplate/TransformationComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ACircleWrapper/Component/TransformationComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ACircleWrapper/ACircleWrapper.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ARectangleWrapper/Component/InteractionComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ARectangleWrapper/Component/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ARectangleWrapper/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ARectangleWrapper/Component/TransformationComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ARectangleWrapper/ARectangleWrapper.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyLine/APolylineGraphWrapper/Base/APolylineEdge.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyLine/APolylineGraphWrapper/Base/APolylineGraphShadow.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyLine/APolylineGraphWrapper/Component/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyLine/APolylineGraphWrapper/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyLine/APolylineGraphWrapper/APolylineGraphWrapper.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/ARemove.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/ASelection.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/ActiveCommandController/ActiveCommandEvent/KeyboardEventController/ShortcutImplementation.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/ActiveCommandController/ActiveCommandEvent/KeyboardEventController/KeyboardEventController.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/ActiveCommandController/ActiveCommandEvent/MouseEventController/MouseEvent/Base/MouseEventBase.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/ActiveCommandController/ActiveCommandEvent/MouseEventController/MouseEvent/MouseEventAnnoImage.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/ActiveCommandController/ActiveCommandEvent/MouseEventController/MouseEventController.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/ActiveCommandController/ActiveCommandImplementation/Base/ActiveCommandCommonWrapper.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/ActiveCommandController/ActiveCommandImplementation/ActiveCommandImplementationsCommon.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ACircle/Component/InteractionComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ACircle/Component/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ACircle/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ACircle/Component/TransformationComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ACircle/ACircle.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ANGonWrapper/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/ANGonWrapper/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/APolygonGraphWrapper/Base/GraphCore.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/APolygonGraphWrapper/Component/InteractionComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/APolygonGraphWrapper/Component/IOComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/APolygonGraphWrapper/Component/MouseEventComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/APolygonGraphWrapper/Component/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/APolygonGraphWrapper/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/APolygonGraphWrapper/Component/TransformationComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyArea/APolygonGraphWrapper/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyCurve/ACurveWrapper/Component/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyCurve/ACurveWrapper/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyCurve/ACurveWrapper/ACurve.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Common/Base/ALineBase.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Common/Base/ComponentTemplate/InteractionComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyLine/AArrowWrapper/Component/InteractionComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyLine/AArrowWrapper/Component/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyLine/AArrowWrapper/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyLine/AArrowWrapper/Component/TransformationComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyLine/AArrowWrapper/AArrow.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyText/ATextleaderline/Base/ATextLeaderlineDiv.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyText/ATextleaderline/Base/ATextLeaderlineNode.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyText/ATextleaderline/Base/ATextLeaderlineLine.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyText/ATextleaderline/Component/InteractionComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyText/ATextleaderline/Component/IOComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyText/ATextleaderline/Component/ProjectionComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyText/ATextleaderline/Component/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Customization/ThemeRenderStyle/StorymapsThemeStructure.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyText/ATextleaderline/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyText/ATextleaderline/Inspector/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyText/ATextleaderline/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyFreehand/AFreehandSmartDrawingWrapper/Component/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyFreehand/AFreehandSmartDrawingWrapper/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyFreehand/AFreehandSmartDrawingWrapper/AFreehandSmartDrawing.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyFreehand/AFreehandWrapper/Component/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyFreehand/AFreehandWrapper/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyFreehand/AFreehandWrapper/AFreehand.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/APointIconWrapper/Component/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/APointIconWrapper/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/APointIconWrapper/APointIconWrapper.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/APointNumberedWrapper/Component/InteractionComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/APointNumberedWrapper/Component/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/APointRegularWrapper/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/APointNumberedWrapper/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/APointNumberedWrapper/Component/TransformationComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/APointNumberedWrapper/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/APointRegularWrapper/Component/InteractionComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/APointRegularWrapper/Component/RendererComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/APointRegularWrapper/Component/RendererComponentGeneric.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/APointRegularWrapper/Component/StyleComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/GeometryAnnotation/FamilyPoint/APointRegularWrapper/Component/TransformationComponent.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/ActiveCommandController/ActiveCommandImplementation/ActiveCommandImplementationsShapes.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/ActiveCommandController/ActiveCommandProperties.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/ActiveCommandController/ActiveMouseCursor.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/ActiveCommandController/ActiveColor.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/ActiveCommandController/ScreenLog.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/ActiveCommandController/ActiveCommandController.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Common/GeometryAdvancedProcessing.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Common/GeometryCommonProcessing.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Common/GeometryCommonSelecting.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Common/GeometryCommonSupporting.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Common/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/APIWrapper/Addon/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/APIWrapper/Environment/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/APIWrapper/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Customization/ThemeRenderStyle/IconAsset.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Customization/ThemeRenderStyle/ThemeRenderStyle.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Customization/Shortcut/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Customization/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/GraphicsCoreWrapper/CanvasWrapper/Canvas/Utility/AbstractCanvasDynamic.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/GraphicsCoreWrapper/CanvasWrapper/Canvas/ACanvas.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/GraphicsCoreWrapper/CanvasWrapper/Canvas/ACanvasMask.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/GraphicsCoreWrapper/CanvasWrapper/Canvas/Utility/ACanvasOffScreen.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/GraphicsCoreWrapper/CanvasWrapper/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/GraphicsCoreWrapper/RendererWrapper/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/GraphicsCoreWrapper/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/IO/EventListener/EventListenerAnnotation.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/IO/StateProcessing/StateProcessingAnnotation.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/IO/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Blackhole/Component/Renderer.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Blackhole/Component/Timer.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Blackhole/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/ObjectSnapping/RenderGhost/AGhostObjectSnapping.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/ObjectSnapping/SnappingProcessor.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/ObjectSnapping/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/TextleaderlineOptimizer/Base/TextleaderlineOptimizerBase.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/TextleaderlineOptimizer/AgentBased/AgentBaseRectOptimizer.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/TextleaderlineOptimizer/CollisionBased/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/TextleaderlineOptimizer/NoneOptimizer/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/TextleaderlineOptimizer/ZoomBased/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/TextleaderlineOptimizer/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/PointOptimizer/Base/PointOptimizerBase.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/PointOptimizer/CollisionBased/Graph/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/PointOptimizer/CollisionBased/Interaction/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/PointOptimizer/CollisionBased/Geometry/PointCluster.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/PointOptimizer/CollisionBased/Renderer/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/PointOptimizer/CollisionBased/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/PointOptimizer/GridBased/Grid/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/PointOptimizer/GridBased/Interaction/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/PointOptimizer/GridBased/Renderer/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/PointOptimizer/GridBased/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/PointOptimizer/NoneOptimizer/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/PointOptimizer/ZoomBased/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/PointOptimizer/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Geometry/Optimizer/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Environment/EnvAnnotationMap.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Offscreen/DrawingPresetOffscreen.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ImagePreset/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ShapePreset/Preset/DrawingPresetArea.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ShapePreset/Preset/DrawingPresetCluster.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ShapePreset/Preset/DrawingPresetCurve.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ShapePreset/Preset/DrawingPresetFreeHand.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ShapePreset/Preset/DrawingPresetLine.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ShapePreset/Preset/DrawingPresetNGon.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ShapePreset/Preset/DrawingPresetNode.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ShapePreset/Preset/DrawingPresetPoint.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ShapePreset/Preset/DrawingPresetPointGeneric.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ShapePreset/Preset/DrawingPresetPointSVG.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ShapePreset/Preset/DrawingPresetPolyline.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ShapePreset/Preset/DrawingPresetSelection.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ShapePreset/Preset/DrawingPresetSnapping.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ShapePreset/Preset/DrawingPresetText.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/ShapePreset/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/Draw/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Renderer/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Scene/SceneManager.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Scene/ParamsEditing.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/Scene/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/ImageAnnotation/index.ts","njslab/Raster/AppImage/AppExpressImage/AppImageDrawing/Implementations/index.ts"],"sourcesContent":["import { RenderStyle } from '../../Implementations/ImageAnnotation/Geometry/GeometryAnnotation/Helper/RenderStyle';\nimport { GType, NVector3 } from '..';\nexport class IOData {\n  public content: string;\n  public font: string;\n  constructor(content = '', font = '') {\n    this.content = content;\n    this.font = font;\n  }\n}\nexport class IOGeoVec {\n  public sx: number;\n  public sy: number;\n  public sz: number;\n  constructor(sx: number, sy: number, sz: number) {\n    this.sx = sx;\n    this.sy = sy;\n    this.sz = sz;\n  }\n}\nexport class IOGeometry {\n  public id: string;\n  public type: string;\n  public renderStyle: RenderStyle;\n  public isSelected: boolean;\n  public isOver: boolean;\n  public isHidden: boolean;\n  public nodes: IOGeoVec[];\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public styles: any;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public data: any;\n  constructor(id: string, type: GType, isSelected: boolean, isOver: boolean, isHidden: boolean) {\n    this.id = id;\n    this.type = type;\n    this.isSelected = isSelected;\n    this.isOver = isOver;\n    this.isHidden = isHidden;\n    this.nodes = [];\n    this.data = {};\n  }\n  public pushNode(vs: NVector3[]) {\n    this.nodes = [];\n    for (let i = 0; i < vs.length; ++i) {\n      this.nodes.push(new IOGeoVec(vs[i].x, vs[i].y, vs[i].z));\n    }\n  }\n  public pushData(data: string, font?: string) {\n    this.data = new IOData(data, font);\n  }\n}\n","export { IOGeometry, IOGeoVec } from '../IOGeometry/IOGeometry';\nexport abstract class GeometryBase {\n  constructor() {\n    /* */\n  }\n  public abstract getLog(): string;\n  public abstract isMouseInside(x: number, y: number): boolean;\n  public abstract translate(x: number, y: number): void;\n  public abstract move(x: number, y: number): void;\n  public abstract remove(): void;\n}\n","import { NVector3 } from '../../../../../../lib';\nimport { AGeometryBase } from '../AGeometryBase';\nexport class CollisionComponent {\n  public neighborShapes: AGeometryBase[] = [];\n  public numOrder = -1;\n  public offset = -2;\n  public isVisited = false;\n\n  public isFixed = false;\n  public isRenderable = true;\n\n  private colA = 'rgba(0, 255, 0, 0.3)';\n  private colB = 'rgba(255, 0, 0, 0.3)';\n  private colC = 'rgba(0, 0, 0, 0.3)';\n\n  // private optiLevel = 0.1;\n  private cVec: NVector3 = new NVector3(0, 0);\n  // private cVecPre: NVector3 = new NVector3(0, 0);\n  // private velocity: NVector3 = new NVector3(0, 0);\n\n  private _minVec: NVector3;\n  private _maxVec: NVector3;\n\n  geo: AGeometryBase;\n  isCollided = false;\n  isCollidable = true;\n  geoCollided: AGeometryBase | undefined = undefined;\n  constructor(geo: AGeometryBase) {\n    this.geo = geo;\n    this._minVec = new NVector3(geo.vec.x - 1, geo.vec.y - 1);\n    this._maxVec = new NVector3(geo.vec.x + 1, geo.vec.y + 1);\n  }\n  public reset() {\n    this.neighborShapes = [];\n    this.numOrder = -1;\n    this.geo.numVisit = 0;\n    this.isCollided = false;\n    this.isVisited = false;\n    this.geo.isCollapse = false;\n  }\n  public updateBBox() {\n    /* */\n  }\n  public set minVec(v: NVector3) {\n    this._minVec.x = v.x - this.offset;\n    this._minVec.y = v.y - this.offset;\n  }\n  public get minVec() {\n    return this._minVec;\n  }\n  public set maxVec(v: NVector3) {\n    this._maxVec.x = v.x + this.offset;\n    this._maxVec.y = v.y + this.offset;\n  }\n  public get maxVec() {\n    return this._maxVec;\n  }\n  public updateByScale(v: number) {\n    this._minVec.x = this.geo.vec.x - ( this.geo.styleComponent.renderStyle.width * v * 0.25)\n    this._maxVec.x = this.geo.vec.x + ( this.geo.styleComponent.renderStyle.width * v * 0.25)\n\n    this._minVec.y = this.geo.vec.y - this.geo.styleComponent.renderStyle.height * v\n  }\n  public update() {\n    if (this.isFixed) {\n      return;\n    }\n\n    this.cVec.x = this._minVec.x + (this._maxVec.x - this._minVec.x) * 0.5;\n    this.cVec.y = this._minVec.y + (this._maxVec.y - this._minVec.y) * 0.5;\n\n    // // this.geo.UpdateBoundingBox();\n    // for (let i = 0; i < this.NeighborShapes.length; ++i) {\n    //     const other = this.NeighborShapes[i] as ATextleaderlineWrapper;\n    //     const cVecOther = new NVector3(other.v0.x + ((other.v1.x - other.v0.x) * 0.5), other.v0.y + ((other.v1.y - other.v0.y) * 0.5 ));\n\n    //     const vec = Sub(this.cVec, cVecOther);\n    //     // const vec = NVector3.Sub(this.NeighborShapes[i].vec, this.vec);\n    //     // const dis = NVector3.Distance(this.vec, this.NeighborShapes[i].vec);\n    //     const nor = Normalize(vec);\n    //     // const falloff = NVector3.CalculateFalloff(this.vec, this.NeighborShapes[i].vec, dis, 0.1);\n    //     this.velocity = Scale(nor, Math.random() * this.optiLevel);\n    //     // console.log(this.velocity.x);\n    //     const outV = Add(this.cVec, this.velocity);\n    //     const xOff = outV.x - this.cVec.x;\n    //     const yOff = outV.y - this.cVec.y;\n\n    //     console.log(xOff, yOff);\n    //     this._minVec.x += xOff;\n    //     this._minVec.y += yOff;\n\n    //     this._maxVec.x += xOff;\n    //     this._maxVec.y += yOff;\n    // }\n    // const txt = this.geo as ATextleaderlineWrapper;\n    // txt.v0.x = this._minVec.x;\n    // txt.v0.y = this._minVec.y;\n\n    // // txt.v1.x = this._maxVec.x;\n    // // txt.v1.y = this._maxVec.y;\n    // txt.UpdateBoundingBox();\n  }\n  public render(ctx: CanvasRenderingContext2D) {\n    if (!this.geo.scene.annotationInstance.implementations.app.INSPECTION) {\n      return;\n    }\n    if (!this.isRenderable) {\n      return;\n    }\n\n    if (this.isCollided) {\n      ctx.fillStyle = this.colB;\n    } else {\n      ctx.fillStyle = this.colA;\n    }\n    if (this.isFixed) {\n      ctx.fillStyle = this.colC;\n    }\n\n    ctx.beginPath();\n    ctx.rect(\n      this.minVec.x,\n      this.minVec.y,\n      this.maxVec.x - this.minVec.x,\n      this.maxVec.y - this.minVec.y\n    );\n    ctx.closePath();\n    ctx.fill();\n  }\n}\n","import { AGeometryBase } from '../AGeometryBase';\nexport class Inspector {\n  public host: AGeometryBase;\n  constructor(host: AGeometryBase) {\n    this.host = host;\n  }\n  public update(ctx: CanvasRenderingContext2D) {\n    if (!this.host.scene.annotationInstance.implementations.app.INSPECTION) {\n      return;\n    }\n    // this.Show(ctx);\n    ctx.font = `10px Arial`;\n    this.showStatus(ctx);\n  }\n  public showStatus(ctx: CanvasRenderingContext2D) {\n    const pos = this.host.vec;\n    ctx.beginPath();\n    ctx.arc(pos.x, pos.y, 5, 0, 3.14 * 2);\n    ctx.closePath();\n    ctx.fillStyle = '#ff0000';\n    ctx.fill();\n    const text = `IsTransform: ${this.host.isTransform}`;\n    ctx.fillText(text, pos.x + 10, pos.y + 10);\n\n    const type = `Type: ${this.host.type}`;\n    ctx.fillText(type, pos.x + 100, pos.y + 10);\n\n    const scale = `scale: ${this.host.scaleMap}`;\n    ctx.fillText(scale, pos.x + 10, pos.y + 25);\n\n    ctx.fillStyle = '#000000';\n    const numNeighbors = `neighbors: ${this.host.collision.neighborShapes.length}`;\n    ctx.fillText(numNeighbors, pos.x + 100, pos.y + 25);\n  }\n}\n","import { GeometryBase, IOGeometry } from '../../../../../lib/Extended/GeometryUtility';\nimport {\n  GType, Size,\n  MouseEventData,\n  deepCopy,\n  getDistance,\n  getDistanceByArray,\n  isInsideOfVecs,\n  isInsideOfVecsByCrossing,\n  compareTwoVectors,\n  origin,\n  NVector3,\n} from '../../../../../lib';\nimport { ActiveCommandController } from '../../../ActiveCommandController/ActiveCommandController';\n// import { Collision } from '../../GeometryAnnotation/Helper/CollisionDynamics';\nimport { Scene } from '../../../Scene';\nimport { APoint } from '../../GeometryAnnotation/FamilyPoint/Base/APoint';\nimport { ATextleaderlineWrapper } from '../../GeometryAnnotation/FamilyText/ATextleaderline';\nimport { CollisionComponent } from './ComponentTemplate/CollisionComponent';\nimport { InteractionComponent } from './ComponentTemplate/InteractionComponent';\nimport { RendererComponent } from './ComponentTemplate/RendererComponent';\nimport { StyleComponent } from './ComponentTemplate/StyleComponent';\nimport { TransformationComponent } from './ComponentTemplate/TransformationComponent';\nimport { Inspector } from './Inspector';\n// .................................................. base\nexport abstract class AGeometryBase extends GeometryBase {\n  public static list: GeometryBase[] = [];\n  public styleComponent: StyleComponent;\n  public renderer: RendererComponent;\n  public transformation: TransformationComponent;\n  public interaction: InteractionComponent;\n  public collision: CollisionComponent;\n  public id: string;\n  // public collisionHelper: Collision;\n\n  public isFill = false;\n  public isGhost = false;\n  public isTransformValue = false;\n  public needEmitRemoveByBlackhole = true;\n  public isVisited: boolean;\n  public isPinValue: boolean;\n  public isRemove: boolean;\n  public numVisit = 0;\n  public isHoverValue: boolean;\n  public isHoverPre: boolean;\n  public isGeoPos: boolean;\n  public isSelectedValue: boolean;\n  public isSelectable: boolean;\n  public isRenderable: boolean;\n  public isMovableValue: boolean;\n  public isDraggable: boolean;\n  public isDrag: boolean;\n  public isLeave: boolean;\n  public isHiddenValue: boolean;\n  public isHiddenPre: boolean;\n  public isAniAccel: boolean;\n  public isAniEasing: boolean;\n  public isCapturedValue: boolean;\n  public isMovedValue: boolean;\n  public isDrop: boolean;\n  public isInsideExtent: boolean;\n  public needEmit: boolean;\n  public needEmitHoverPost: boolean;\n  public isUndo: boolean;\n  public isGrayColor: boolean;\n  public enableEditValue: boolean;\n  public visibilityValue: number;\n  public isUnderConstruction: boolean;\n  public visTrajector: boolean;\n  public trajectoryVecs: NVector3[];\n  public type: GType;\n  public typeSub: GType;\n\n  public needBlackhole: boolean;\n  public zoomDisX: number;\n  public zoomDisY: number;\n  public vec: NVector3;\n  public tVec: NVector3;\n\n  public r: number;\n\n  public hasSound: boolean;\n  public isZoomStart: boolean;\n  protected hasPopupValue: boolean;\n  public hasPopupPre: boolean;\n  public hasGhostPopup: boolean;\n  public ghostPopupOffset: number;\n  public popup: HTMLDivElement | undefined;\n  public hashColor: string;\n  public scene: Scene;\n  public inspector: Inspector;\n\n  public scaleMap = 1;\n  public scaleForRender = 1.0;\n  public isRenderCollapse = false;\n  public timePopupDelay = 100;\n  public vecSelectedSnapping: NVector3 | undefined = undefined;\n  protected disableValue = false;\n  protected sizeValue: Size = Size.MEDIUM;\n  protected textLeaderlineValue: ATextleaderlineWrapper | undefined = undefined;\n  protected vecsHistory: NVector3[];\n  protected showPopupStackTimer: any;\n  constructor(scene: Scene) {\n    super();\n    this.scene = scene;\n    this.scene.addGeometry(this);\n    this.vec = origin();\n    this.id = this.scene.getUUID();\n    this.hashColor = this.scene.getHashColor(this);\n    this.isRemove = false;\n    this.isHoverValue = false;\n    this.isGeoPos = false;\n    this.isSelectedValue = false;\n    this.isPinValue = true;\n    this.isSelectable = true;\n    this.isRenderable = false;\n    this.isMovableValue = true;\n    this.isDraggable = false;\n    this.isLeave = false;\n    this.isInsideExtent = true;\n    this.isHiddenValue = false;\n    this.isHiddenPre = false;\n    this.isAniEasing = false;\n    this.isAniAccel = false;\n    this.isCapturedValue = false;\n    this.isMovedValue = false;\n    this.isUnderConstruction = true;\n    this.isVisited = false;\n    this.isGrayColor = false;\n    this.isDrop = false;\n    this.isDrag = false;\n    this.isSelectedValue = false;\n    this.needEmitHoverPost = true;\n\n    this.isHoverValue = false;\n    this.enableEditValue = false;\n    // this.sound = AGeometryCommon.sound;\n    this.hasSound = false;\n    this.vecsHistory = [];\n    // this.vecsHistory.push(new NVector3(x, y, z));\n    this.trajectoryVecs = [];\n    this.zoomDisX = 0;\n    this.zoomDisY = 0;\n    this.isZoomStart = true;\n    this.needEmit = true;\n    this.isUndo = true;\n    this.ghostPopupOffset = 5;\n\n    this.scaleForRender = 1.0;\n    this.visibilityValue = 1.0;\n    this.needBlackhole = false;\n    this.inspector = new Inspector(this);\n    // this.collisionHelper = new Collision(this);\n    this.collision = new CollisionComponent(this);\n    this.initScale();\n  }\n  public abstract getLog(): string;\n  public abstract renderPost(ctx: CanvasRenderingContext2D): void;\n  public abstract isMouseInside(x: number, y: number): boolean;\n  public abstract translateByMouseEventData(e: MouseEventData): void;\n  public abstract translate(x: number, y: number): void;\n  public abstract remove(needEmit?: boolean): void;\n  public abstract hide(): void;\n  public getNode() {\n    const v: NVector3[] = [];\n    v.push(this.vec);\n    return v;\n  }\n  public getArea(): number {\n    return Number.MAX_SAFE_INTEGER;\n  }\n  public toJSON(): IOGeometry | undefined {\n    const p = new IOGeometry(\n      this.id,\n      this.type,\n      this.isSelectedValue,\n      this.isHoverValue,\n      this.isHiddenValue\n    );\n    p.pushNode(this.getNode());\n    return p;\n  }\n  // ...............................................................\n  public isSelectedByWindow(vs: NVector3[]) {\n    return isInsideOfVecs(this.vec, vs);\n  }\n  public isSelectedByCrossing(vs: NVector3[]) {\n    return isInsideOfVecsByCrossing(this.vec, 5, 5, vs);\n  }\n  public isMouseInsideSnapFrom(v: NVector3): NVector3 | undefined {\n    return undefined;\n  }\n  // ...............................................................\n  public get v(): NVector3 {\n    return this.vec;\n  }\n  public set v(v: NVector3) {\n    this.vec = v;\n  }\n  public get isHidden() {\n    return this.isHiddenValue;\n  }\n  public set isHidden(v: boolean) {\n    this.isHiddenPre = this.isHiddenValue;\n    this.isHiddenValue = v;\n    // this.isGrayColor = v;\n    this.scene.annotationInstance.io.eventListenerAnnotation.hideStack(this.toJSON());\n  }\n  public get size() {\n    return this.sizeValue;\n  }\n  public set size(v: Size) {\n    this.sizeValue = v;\n  }\n  public get isMovable() {\n    return this.isMovableValue;\n  }\n  public set isMovable(v: boolean) {\n    this.isMovableValue = v;\n  }\n  public get isHover() {\n    return this.isHoverValue;\n  }\n  public set isHover(v: boolean) {\n    if (!v) {\n      this.needEmitHoverPost = true;\n    }\n    this.isHoverValue = v;\n  }\n  public get visibility() {\n    return this.visibilityValue;\n  }\n  public set visibility(v: number) {\n    this.visibilityValue = v;\n    // if (v === 0) {\n    //   this.IsHidden = true;\n    // } else {\n    //   this.IsHidden = false;\n    // }\n  }\n  public set isCollapse(v: boolean) {\n    this.isRenderCollapse = v;\n  }\n  public get isCollapse() {\n    return this.isRenderCollapse;\n  }\n  public get textLeaderline(): ATextleaderlineWrapper | undefined {\n    return this.textLeaderlineValue;\n  }\n  public set textLeaderline(t: ATextleaderlineWrapper | undefined) {\n    // console.log(t);\n    // console.trace();\n    if (t === this.textLeaderlineValue) {\n      return;\n    }\n    if (t && this.textLeaderlinePost(t)) {\n      return;\n    }\n    if (this.textLeaderlineValue) {\n      if (t) {\n        // this._textLeaderline.leaderline.v2 = new NVector3(this.vec.x, this.vec.y, this.vec.z);\n        // this._textLeaderline.isAttached = false;\n        this.textLeaderlineValue.removeLeaderline();\n        // console.log('dd');\n      }\n    }\n    // if (t) {\n    //   this._textLeaderline = t;\n    // }\n    // console.log(this._textLeaderline);\n    this.textLeaderlineValue = t;\n    // console.log('assign');\n  }\n  public updateColor(c: number[]) {\n    this.styleComponent.updateColor(c);\n  }\n  public textLeaderlinePost(t: ATextleaderlineWrapper) {\n    return false;\n  }\n  public updateLeaderlineSnap(v: NVector3, tor: number) {\n    // TODO\n  }\n  public get isPin() {\n    return this.isPinValue;\n  }\n  public set isPin(v: boolean) {\n    this.isPinValue = v;\n  }\n  public get isSelected() {\n    return this.isSelectedValue;\n  }\n  public set isSelected(v: boolean) {\n    this.isSelectedValue = v;\n  }\n  public get isCaptured() {\n    return this.isCapturedValue;\n  }\n  public set isCaptured(v: boolean) {\n    this.isCapturedValue = v;\n  }\n  public get isEditiable() {\n    return this.enableEditValue;\n  }\n  public set isEditiable(v: boolean) {\n    this.enableEditValue = v;\n  }\n  public get isTransform() {\n    return this.isTransformValue;\n  }\n  public set isTransform(v: boolean) {\n    // console.log(v);\n    // console.trace();\n    this.isTransformValue = v;\n  }\n  public get isMove() {\n    return this.isMovedValue;\n  }\n  public set isMove(v: boolean) {\n    this.isMovedValue = v;\n  }\n  public get disable() {\n    return this.disableValue;\n  }\n  public set disable(v: boolean) {\n    this.disableValue = v;\n  }\n  // ............................... popup\n  public get hasPopup() {\n    return this.hasPopupValue;\n  }\n  public set hasPopup(v: boolean) {\n    this.hasPopupValue = v;\n  }\n  public getNodePopup(): AGeometryBase | APoint | undefined {\n    return undefined;\n  }\n  public getBoundary(): NVector3[] {\n    return [this.vec];\n  }\n  public updateActiveCursor() {\n    // TODO\n  }\n  public showPopupSummary() {\n    if (!this.scene.annotationInstance.activeCommandController.needPopup()) {\n      return\n    }\n    // console.trace();\n    // console.log('pop');\n    if (this.hasPopupValue || this.isGhost) {\n      return;\n    }\n    // if (this.isGhost) { return; }\n    // console.trace();\n    this.hasPopupValue = true;\n    this.popup = document.createElement('div') as HTMLDivElement;\n    this.popup.id = 'pa-' + this.id;\n    this.popup.style.position = 'absolute';\n    this.popup.style.zIndex = '1000';\n    this.popup.style.height = '0px';\n    this.popup.style.width = '0px';\n    this.popup.style.backgroundColor = 'red';\n    this.scene.annotationInstance.implementations.app.model.modelViewWrapper.div.appendChild(\n      this.popup\n    );\n    // console.log(this.popup);\n    if (\n      this.type === GType.POLYLINE ||\n      this.type === GType.POLYLINE_BENDING ||\n      this.type === GType.POLYGON ||\n      this.type === GType.RECTANGLE ||\n      this.type === GType.CIRCLE\n    ) {\n      const n: APoint = this.getNodePopup() as APoint;\n      // console.log(n);\n      this.popup.style.top = n.vec.y + 'px';\n      this.popup.style.left = n.vec.x + 'px';\n    } else {\n      this.popup.style.top = this.vec.y + 'px';\n      this.popup.style.left = this.vec.x + 'px';\n    }\n\n    if (this.showPopupStackTimer) {\n      clearTimeout(this.showPopupStackTimer);\n    }\n    this.showPopupStackTimer = setTimeout(() => {\n      if (this.popup) {\n        this.scene.annotationInstance.io.eventListenerAnnotation.showPopupStack(this.toJSON());\n      }\n    }, this.timePopupDelay);\n  }\n  public getVecs() {\n    return [this.vec];\n  }\n  public hidePopUpSummary() {\n    if (this.popup && this.popup.parentNode) {\n      this.renderer.tOverPopupSummary = 0;\n      this.popup.parentNode.removeChild(this.popup);\n      if (this.type === GType.CNODE) {\n        const p = new IOGeometry(\n          this.id,\n          this.type,\n          this.isSelectedValue,\n          this.isHoverValue,\n          this.isHiddenValue\n        );\n        p.pushNode(this.getNode());\n        this.scene.annotationInstance.io.eventListenerAnnotation.hidePopupStack(p);\n      } else {\n        this.scene.annotationInstance.io.eventListenerAnnotation.hidePopupStack(this.toJSON());\n      }\n      this.hasPopupPre = false;\n      this.popup = undefined;\n      this.hasPopupValue = false;\n    }\n  }\n  // ............................... end popup\n  public needSnapping(v: NVector3) {\n    return [getDistance(this.vec, v), this.vec];\n  }\n  public getVecForSnapping(): NVector3 | undefined {\n    return this.vec;\n  }\n  // ............................... end snapping\n  public move(x: number, y: number) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n  }\n  public activateEasing(e: MouseEventData, ac: ActiveCommandController) {\n    /* */\n  }\n  public easing() {\n    /* */\n  }\n  public accelerating() {\n    /* */\n  }\n  public findClosestNode(x: number, y: number): undefined | APoint | AGeometryBase {\n    return undefined;\n  }\n  public renderPre(ctx: CanvasRenderingContext2D) {\n    this.styleComponent.renderStyle.scaleGlobal = this.scene.annotationInstance.activeCommandController.scaleGlobal;\n    return;\n  }\n  public setDash(v: number[]) {\n    return this.styleComponent.setDash(v);\n  }\n  public updateBoundingBox() {\n    /* */\n  }\n  public mouseDoubleClick() {\n    /* */\n  }\n  public outExtent() {\n    /* */\n  }\n  public inExtent() {\n    /* */\n  }\n  public updateTheme() {\n    /* */\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public updateStyle(s: any) {\n    /* */\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public updateStyleCustom(style: any): boolean {\n    return this.styleComponent.updateStyleCustom(style);\n  }\n  public initScale(v?: number) {\n    if (!this.scene.annotationInstance.activeCommandController.acProperties.activateMapScale) {\n      return;\n    }\n    if (v) {\n      this.scaleMap = v;\n    } else {\n      this.scaleMap = this.scene.annotationInstance.activeCommandController.acProperties.mapScale;\n    }\n  }\n  public setScaleLocal(value: number) {\n    this.styleComponent.renderStyle.scaleLocal = value;\n    this.scene.annotationInstance.graphicsCoreWrapper.renderForce();\n\n  }\n  public updateScaleByZoomLevel() {\n    if (!this.scene.annotationInstance.activeCommandController.acProperties.activateMapScale) {\n      return;\n    }\n    const v =\n      this.scaleMap / this.scene.annotationInstance.activeCommandController.acProperties.mapScale;\n    if (!this.scene.annotationInstance.activeCommandController.acProperties.isScaleDynamicRender) {\n      this.scaleForRender = 1;\n      return;\n    }\n    if (v > 1) {\n      this.scaleForRender = 1;\n    } else if (v < 0.05) {\n      this.scaleForRender = 0;\n    } else {\n      this.scaleForRender = v;\n    }\n    // console.log(this.scaleForRender);\n  }\n  public render(ctx: CanvasRenderingContext2D) {\n    this.renderPre(ctx);\n    if (Number.isNaN(this.vec.x)) {\n      this.outExtent();\n    } else {\n      this.inExtent();\n    }\n    if (this.isRemove || !this.isRenderable) {\n      return;\n    }\n    if (this.isHiddenValue && this.visibilityValue < 0.01) {\n      return;\n    }\n    if (this.isAniEasing) {\n      this.easing();\n    }\n    if (this.isAniAccel) {\n      this.accelerating();\n    }\n    if (this.isUndo && this.renderer) {\n      this.renderer.t = 1;\n      this.renderer.tDown1 = 1;\n      this.renderer.tDown2 = 1;\n    }\n    if (this.needBlackhole) {\n      this.removeByBlackhole();\n    }\n    this.isMoveUpdate();\n    this.updatePopup();\n    this.updateHoverPost();\n    if (this.scene.annotationInstance.activeCommandController.acProperties.needCollisionDetection) {\n      // this.collisionHelper.Render(ctx);\n    }\n    this.renderPost(ctx);\n  }\n  public updatePopup() {\n    if (this.hasPopupValue && this.popup !== undefined) {\n      if (this.hasGhostPopup) {\n        this.popup.style.top =\n          this.vec.y -\n          this.scene.annotationInstance.customization.themeCurrent.nPoint.height -\n          this.ghostPopupOffset +\n          'px';\n        this.popup.style.left = this.vec.x + 'px';\n      } else {\n        if (\n          this.type === GType.POLYLINE ||\n          this.type === GType.POLYLINE_BENDING ||\n          this.type === GType.POLYGON ||\n          this.type === GType.RECTANGLE ||\n          this.type === GType.CIRCLE\n        ) {\n          const n: APoint = this.getNodePopup() as APoint;\n          this.popup.style.top = n.vec.y + 'px';\n          this.popup.style.left = n.vec.x + 'px';\n        } else {\n          this.popup.style.top = this.vec.y + 'px';\n          this.popup.style.left = this.vec.x + 'px';\n        }\n      }\n    }\n  }\n  public updateHoverPost() {\n    // console.log('------------------------------------', this.tOverPopupSummary);\n    if (this.renderer.tOverPopupSummary > 0.2) {\n      if (this.needEmitHoverPost) {\n        // && !this.isSelected) {\n        // console.log(this.isSelected);\n        this.showPopupSummary();\n        this.emitHoverPostStack();\n        this.needEmitHoverPost = false;\n      }\n    }\n  }\n  public isMoveUpdate() {\n    // console.log(this.type);\n    if (\n      this.type === GType.ANODE ||\n      this.type === GType.ANODE_CIRCLE ||\n      this.type === GType.ANODE_NGON ||\n      this.type === GType.ANODE_RECT ||\n      this.type === GType.ANODE_TEXT ||\n      this.type === GType.AMIDPOINT\n    ) {\n      return;\n    }\n    if (this.vecsHistory.length < 1) {\n      return;\n    }\n    // console.log('move?');\n\n    if (compareTwoVectors(this.vecsHistory[this.vecsHistory.length - 1], this.vec)) {\n      // console.log(this.type, 'move false !!!');\n      this.isMove = false;\n    } else {\n      // console.log(this.type, 'move true !!!', this.vecsHistory.length, this.vecsHistory[this.vecsHistory.length - 1].long, this.vec.long );\n      this.isMove = true;\n      this.isTransform = true;\n    }\n    // const d = this.scene.annotationInstance.geometryCommon.ToMap(this.vec.x, this.vec.y);\n    // this.vec.long = d[0]; this.vec.lat = d[1];\n    // this.vecsHistory.push(this.vec);\n\n    // console.log(this.vecsHistory.length);\n  }\n  public initVecsHistory() {\n    this.vecsHistory = [];\n    this.vecsHistory.push(deepCopy(this.vec), deepCopy(this.vec), deepCopy(this.vec));\n  }\n  public updateVecsHistory() {\n    this.vecsHistory.push(deepCopy(this.vec));\n    while (this.vecsHistory.length > 3) {\n      this.vecsHistory.shift();\n    }\n  }\n  public deepCopy(x: number, y: number, z = 0): AGeometryBase | undefined {\n    return undefined;\n  }\n  public goToBlackhole() {\n    /* */\n  }\n  public updatePostTransformation() {\n    /* */\n  }\n  public fromJSON(g: IOGeometry) {\n    /* */\n  }\n  public dummy() {\n    /* */\n  }\n  public removeByBlackhole() {\n    if (\n      getDistanceByArray(\n        [\n          this.scene.annotationInstance.renderer.blackhole.v.x,\n          this.scene.annotationInstance.renderer.blackhole.v.y,\n          this.scene.annotationInstance.renderer.blackhole.v.z,\n        ],\n        [this.vec.x, this.vec.y, this.vec.z]\n      ) < 10\n    ) {\n      this.remove(this.needEmitRemoveByBlackhole);\n    }\n  }\n  public mouseLeftClick(x: number, y: number) {\n    /* */\n  }\n  public mouseRightClick(e: MouseEventData) {\n    /* */\n  }\n  public mouseUp() {\n    /* */\n  }\n  public emitAddStack() {\n    this.scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(this.toJSON());\n  }\n  public emitHoverPostStack() {\n    this.scene.annotationInstance.io.eventListenerAnnotation.hoverPostStack(this.toJSON());\n  }\n}\n","import { IOGeometry } from '../../../../../lib/Extended/GeometryUtility';\nimport {\n  GType,\n  MouseEventData,\n  getDistance, NVector3, plus, scale\n} from '../../../../../lib';\nimport { ActiveCommandController } from '../../../ActiveCommandController/ActiveCommandController';\nimport { Scene } from '../../../Scene';\nimport { APoint } from '../../GeometryAnnotation/FamilyPoint/Base/APoint';\nimport { AGeometryBase } from './AGeometryBase';\n\nexport class APointBase extends AGeometryBase {\n  // ........................................................ static methods\n  public visTrajector: boolean;\n  public trajectoryVecs: NVector3[];\n  public r: number;\n  public rOrigin: number;\n  public rTarget: number;\n  public type: GType;\n  public isMid: boolean;\n  public isLineNetwork = false;\n  public edges: AGeometryBase[];\n  public nodes: APoint[];\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public graph: any;\n  public isPointMid: boolean;\n  public weightLeft: number;\n  public weightRight: number;\n\n  public isAniUp: boolean;\n  public popup: HTMLDivElement | undefined;\n  // ........................................................ static methods\n  public static mouseRightClick(e: MouseEventData) {\n    /* */\n  }\n  public static mouseMiddleClick(e: MouseEventData) {\n    /* */\n  }\n  public static mouseLeftClick(scene: Scene, e: MouseEventData, type?: GType) {\n    /* */\n  }\n  public static onMouseMove(e: MouseEventData) {\n    /* */\n  }\n  public static mouseDrag(e: MouseEventData) {\n    /* */\n  }\n  public static mouseUp(e: MouseEventData) {\n    /* */\n  }\n\n  constructor(scene: Scene, x = 0, y = 0, z = 0, type: GType = GType.APOINT, radius = 5) {\n    super(scene);\n    this.vec = new NVector3(x, y, z);\n    this.trajectoryVecs = [];\n    this.edges = [];\n    this.nodes = [];\n    this.r = radius;\n    this.rOrigin = radius;\n    this.rTarget = radius + 10;\n    this.weightLeft = 0;\n    this.weightRight = 0;\n    this.type = type;\n\n    this.isMid = false;\n    this.isGeoPos = true;\n    this.isPointMid = false;\n    this.isAniUp = true;\n    this.hasPopupValue = false;\n    this.scene.addBasePoint(this);\n    this.isUnderConstruction = false;\n    // this.renderer.t = 0.0;\n    // this.renderer.tDown1 = 0.0, this.renderer.tDown2 = 0.0;\n    // this.renderer.tOver = 0.0, this.renderer.tUp = 0.0;\n\n    this.visTrajector = true;\n    this.collision.isFixed = true;\n    this.scaleForRender = 1.0;\n    this.updateBoundingBox();\n    this.initVecsHistory();\n    this.initScale();\n    this.init();\n  }\n  public init() {\n    // if (this.hasSound) { this.sound.PlayClickPoint(); }\n  }\n  public update(forcePrjection = false) {\n    if (forcePrjection) {\n      this.updatePostTransformation();\n      return;\n    }\n    if (\n      this.scene.annotationInstance.graphicsCoreWrapper.canvasWrapper.aCanvas.canvasLoopController\n        .level === 1\n    ) {\n      if (this.isPinValue) {\n        this.updateScreenVecForPan();\n        this.updatePostTransformation();\n      }\n    }\n  }\n  // public Update(forcePrjection: boolean = false) {\n  //     if (this.scene.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.isViewChanging || this.scene.annotationInstance.implementations.app.model.graphicsCoreWrapper.canvasWrapper.aCanvas.canvasLoopController.level === 1) {\n  //         if (this.isPin) { this.UpdateScreenVecForPan(); }\n  //     }\n  // }\n  // ........................................ projection\n  public updateScreenVecForPan() {\n    this.updateScaleByZoomLevel();\n  }\n  // ........................................ end projection\n  public getParentType() {\n    return 'APointBase';\n  }\n  public distance(x: number, y: number) {\n    // return GeometryCommon.model.nGraphics.nWebassemblyController.Distance(this.vec.x, this.vec.y, 0, x, y, 0);\n    return Math.sqrt((this.vec.x - x) * (this.vec.x - x) + (this.vec.y - y) * (this.vec.y - y));\n  }\n  public addEdge(e: AGeometryBase) {\n    // CLineBase\n    if (this.edges.indexOf(e) !== -1) {\n      return;\n    }\n    // this.type = GTYPE.NODE;\n    this.edges.push(e);\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public removeEdge(e: any) {\n    // this.edges.splice(this.edges.indexOf(e), 1);\n  }\n  public activateEasing(e: MouseEventData, ac: ActiveCommandController) {\n    this.scene.annotationInstance.scene.capture = undefined;\n    this.tVec = new NVector3(e.x, e.y, 0);\n    this.isAniEasing = true;\n  }\n  public easing() {\n    if (this.isAniEasing) {\n      this.vec = plus(scale(this.vec, 0.95), scale(this.tVec, 0.05));\n      if (getDistance(this.vec, this.tVec) < 1) {\n        this.isAniEasing = false;\n      }\n    }\n  }\n  // .......................................................................... show and Hide popUp\n\n  public accelerating() {\n    this.vec = plus(\n      scale(this.vec, 0.9),\n      scale(this.tVec, 0.1) // (1 / dis) * 0.00000001)\n    );\n    if (getDistance(this.vec, this.tVec) < 1) {\n      this.isAniEasing = false;\n    }\n\n    this.renderer.t += 0.01;\n  }\n  public get isPin() {\n    return this.isPinValue;\n  }\n  public set isPin(v: boolean) {\n    this.isPinValue = v;\n  }\n  // ................................... implementation\n  public remove() {\n    /* */\n  }\n  public move(x: number, y: number) {\n    this.vec.x = x;\n    this.vec.y = y;\n  }\n  public isMouseInside(x: number, y: number) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return false;\n    }\n    // return this.Distance(x, y) <= this.r + 3;\n    return this.distance(x, y) <= this.r * this.scaleForRender + 3 * this.scaleForRender;\n  }\n  // get IsMove() {\n  //     if (this.vecsHistory[this.vecsHistory.length - 1].Distance(this.vec) > 2) {\n  //         this.isMove = true; return true;\n  //     } else {\n  //         this.isMove = false;\n  //         return false;\n  //     }\n  // }\n  // DeepCopy(x: number, y: number, z: number) {\n  //     return undefined;\n  // }\n  public deepCopy(\n    x: number = this.vec.x,\n    y: number = this.vec.y,\n    z: number = this.vec.z\n  ): AGeometryBase | undefined {\n    let p = new APointBase(this.scene, x, y, this.vec.z, this.type, this.r) as AGeometryBase;\n    if (p) {\n      return p as AGeometryBase;\n    }\n    return undefined;\n  }\n  public get v(): NVector3 {\n    return this.vec;\n  }\n  public set v(v: NVector3) {\n    this.vec = v;\n  }\n  public get isHover() {\n    return this.isHoverValue;\n  }\n  public set isHover(v: boolean) {\n    this.isHoverValue = v;\n  }\n  public get isSelected() {\n    return this.isSelectedValue;\n  }\n  public set isSelected(v: boolean) {\n    this.isSelectedValue = v;\n  }\n  public getLog(): string {\n    const text =\n      'GUID : ' +\n      this.id +\n      '/' +\n      'TYPE : ' +\n      this.type.toString() +\n      '/' +\n      // 'PARENT : ' + this.edges[0].GetParentType()+\"<br>\"+\n      // 'Geo : ' +  'lat:' + this.vec.long.toFixed(5).toString() + ', Log:' + this.vec.lat.toFixed(5).toString() + '/' +\n      'Screen : ' +\n      // this.vec.ToString() +\n      '/' +\n      // 'Projected : ' + this.vec.proX.toFixed(5).toString() + ', Log:' + this.vec.proY.toFixed(5).toString() + '/' +\n      'SIZE : ' +\n      this.r +\n      ' pixel' +\n      '/' +\n      // 'STYLE : ' + this.style.toString() + '/' +\n      'CONNE :' +\n      this.edges.length.toString() +\n      '/' +\n      'IsCap :' +\n      this.isCapturedValue +\n      '/' +\n      'IsSEL : ' +\n      this.isSelectedValue +\n      '/' +\n      'IsHid : ' +\n      this.isHiddenValue +\n      '/' +\n      'IsDeg : ' +\n      this.isDrag +\n      '/' +\n      'isSelable : ' +\n      this.isSelectable +\n      '/' +\n      'hasTextLeaderline : ' +\n      this.textLeaderline;\n    return text;\n  }\n  public getLogDOM(): string {\n    const text =\n      'Geometry ID : ' +\n      this.id +\n      '<br>' +\n      'geometry Type : APointBase\" <br>' +\n      // \"parent : \"+this.parent.GetParentType()+\"<br>\"+\n      'position : ' +\n      // this.vec.ToString() +\n      '<br>' +\n      'size : ' +\n      this.r +\n      ' pixel<br>' +\n      'type : ' +\n      this.type +\n      '<br>' +\n      // 'color : ' + this.style.fillStyle + '<br>' +\n      // 'edges:' + this.edges.length + '<br>' +\n      'isSelected : ' +\n      this.isSelectedValue +\n      '<br>' +\n      'isSelectable : ' +\n      this.isSelectable +\n      '<br>';\n    // 'edges : ' + this.edges.length + '<br>'\n    return text;\n  }\n  public goToBlackhole() {\n    this.needBlackhole = true;\n    this.tVec = this.scene.annotationInstance.renderer.blackhole.v as NVector3;\n    this.isAniAccel = true;\n  }\n  public hide() {\n    // if (this.hasSound) { this.sound.PlayBlackhole(); }\n    this.isSelectable = false;\n    this.isRenderable = false;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue || this.isGhost) {\n      return;\n    }\n    this.vec.x += e.x - e.preX;\n    this.vec.y += e.y - e.preY;\n    this.isDrag = true;\n\n    if (this.textLeaderline) {\n      this.textLeaderline.translateByMouseEventData(e);\n      if (this.textLeaderline && this.textLeaderline.leaderline) {\n        // if (this.wrapping.needWrappingToLeft || this.wrapping.needWrappingToRight) {\n        this.textLeaderline.leaderline.v2.x = this.vec.x;\n        this.textLeaderline.leaderline.v2.y = this.vec.y;\n        // }\n      }\n    }\n    this.updatePostTransformation();\n  }\n  public translate(x: number, y: number) {\n    //\n  }\n  public getNode() {\n    const v: NVector3[] = [];\n    v.push(this.vec);\n    return v;\n  }\n  public toJSON(): IOGeometry | undefined {\n    if (this.isGhost) {\n      return undefined;\n    }\n    if (\n      this.type === GType.ANODE ||\n      this.type === GType.ANODE_CIRCLE ||\n      this.type === GType.AMIDPOINT ||\n      this.type === GType.AN_GON ||\n      this.type === GType.ANODE_RECT\n    ) {\n      return undefined;\n    }\n\n    const p = new IOGeometry(\n      this.id,\n      this.type,\n      this.isSelectedValue,\n      this.isHoverValue,\n      this.isHiddenValue\n    );\n    if (this.type === GType.POINT_REGULAR)\n      if (this.styleComponent.renderStyle.url) {\n        p.data = {\n          url: this.styleComponent.renderStyle.url,\n        };\n      }\n    p.pushNode(this.getNode());\n\n    const styles = this.styleComponent.toJson();\n    if (styles) {\n      p.styles = styles;\n    }\n\n    return p;\n  }\n  public getIOGeometry(): IOGeometry | undefined {\n    return this.toJSON();\n  }\n  public visTrajectory(ctx: CanvasRenderingContext2D, v: NVector3) {\n    this.trajectoryVecs.push(v);\n    if (this.trajectoryVecs.length > 6) {\n      this.trajectoryVecs.shift();\n    }\n    // CDrawingPreset.PointTrajectory(ctx, this.style, this.trajectoryVecs);\n  }\n  public outExtent() {\n    if (this.isInsideExtent) {\n      if (this.hasPopup) {\n        this.hidePopUpSummary();\n        this.hasPopupPre = true;\n      }\n      this.isInsideExtent = false;\n    }\n  }\n  public inExtent() {\n    if (!this.isInsideExtent) {\n      if (this.hasPopupPre) {\n        this.showPopupSummary();\n      }\n      this.isInsideExtent = true;\n    }\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    /* */\n  }\n  public updateDivPos() {\n    /**/\n  }\n  public updatePostTransformation() {\n    this.updateBoundingBox();\n  }\n  public set disable(v: boolean) {\n    this.disableValue = v;\n    if (this.disableValue) {\n      this.isSelectedValue = false;\n    } else {\n      this.isSelectedValue = true;\n    }\n  }\n}\n","import { linearColorInterpolation } from '../../../../../lib';\nimport { AGeometryBase } from '../../Common/Base/AGeometryBase';\nexport class InterpolateColor {\n  public value = 0.0;\n  protected host: AGeometryBase;\n  protected tOpacityA = 0.0;\n  protected tOpacityB = 0.0;\n  protected colorInterpolatedValue: string;\n  private _opacity = 1.0;\n  constructor(host: AGeometryBase) {\n    this.host = host;\n    if (this.host.styleComponent.renderStyle.colorInterpolated) {\n      this.interpolateColor();\n    }\n  }\n  public update() {\n    this.interpolateColor();\n    this.updateVauleNormalized();\n    this.host.styleComponent.renderStyle.interpolationNum = this._opacity;\n  }\n  public updateVauleNormalized() {\n    if (this.host.scene.annotationInstance.renderer.needFocus) {\n      this._opacity -= this.value;\n      this._opacity = this._opacity < 0.4 ? 0.4 : this._opacity;\n    } else {\n      this._opacity += this.value;\n      this._opacity = this._opacity > 1.0 ? 1.0 : this._opacity;\n    }\n  }\n  public interpolateColor() {\n    if (\n      !this.host.scene.annotationInstance.renderer.needFocus ||\n      this.host.isHover ||\n      this.host.isSelected\n    ) {\n      this.tOpacityA += this.host.scene.annotationInstance.customization.themeCurrent.properties.timeTransitionA;\n      this.tOpacityB = 0;\n      this.value = this.tOpacityA;\n      if (this.tOpacityA < 1.0) {\n        const col = linearColorInterpolation(\n          this.host.styleComponent.renderStyle.colorInterpolated.getArray(),\n          this.host.styleComponent.renderStyle.colorA.getArray(),\n          this.tOpacityA\n        );\n        this.host.styleComponent.renderStyle.colorInterpolated.r = col[0];\n        this.host.styleComponent.renderStyle.colorInterpolated.g = col[1];\n        this.host.styleComponent.renderStyle.colorInterpolated.b = col[2];\n        this.host.styleComponent.renderStyle.colorInterpolated.a = col[3];\n        this.value = this.tOpacityA;\n        // this._colorInterpolated = `rgba(${this.host.styleComponent.color[0]}, ${this.host.styleComponent.color[1]}, ${this.host.styleComponent.color[2]}, ${this.host.styleComponent.color[3]})`;\n      }\n    } else {\n      this.tOpacityA = 0.0;\n      this.tOpacityB += this.host.scene.annotationInstance.customization.themeCurrent.properties.timeTransitionB;\n      this.value = this.tOpacityB;\n      if (this.tOpacityB < 1.0) {\n        const col = linearColorInterpolation(\n          this.host.styleComponent.renderStyle.colorInterpolated.getArray(),\n          this.host.styleComponent.renderStyle.colorB.getArray(),\n          this.tOpacityB\n        );\n        this.host.styleComponent.renderStyle.colorInterpolated.r = col[0];\n        this.host.styleComponent.renderStyle.colorInterpolated.g = col[1];\n        this.host.styleComponent.renderStyle.colorInterpolated.b = col[2];\n        this.host.styleComponent.renderStyle.colorInterpolated.a = col[3];\n        this.value = this.tOpacityB;\n        // this._colorInterpolated = `rgba(${this.host.styleComponent.color[0]}, ${this.host.styleComponent.color[1]}, ${this.host.styleComponent.color[2]}, ${this.host.styleComponent.color[3]})`;\n      }\n    }\n  }\n  public get opacity() {\n    return this._opacity;\n  }\n  // public get colorInterpolated() {\n  //     return this._colorInterpolated;\n  // }\n}\n","import { RendererComponent } from '../../Common/Base/ComponentTemplate/RendererComponent';\nexport class Timer {\n  public host: RendererComponent;\n  public incrementTimePopupSummary: number;\n  constructor(host: RendererComponent) {\n    this.host = host;\n    this.incrementTimePopupSummary = 0.02;\n  }\n  public update() {\n    if (this.host.geo.isDrag) {\n      this.host.tUp += this.host.geo.scene.annotationInstance.renderer.dt * 0.5;\n      this.host.tDown2 = 0.0;\n    } else {\n      if (this.host.geo.isSelectedValue) {\n        this.host.tOver += this.host.geo.scene.annotationInstance.renderer.dt;\n        this.host.tDown1 = 0.0;\n        if (this.host.geo.isHoverValue) {\n          this.host.tOverPopupSummary += this.incrementTimePopupSummary;\n        } else {\n          this.host.tOverPopupSummary = 0;\n        }\n        this.host.geo.isLeave = true;\n      } else if (this.host.geo.isHoverValue) {\n        this.host.tOver += this.host.geo.scene.annotationInstance.renderer.dt * 0.5;\n        this.host.tOverPopupSummary += this.incrementTimePopupSummary;\n        this.host.tDown1 = 0.0;\n        this.host.geo.isLeave = true;\n      } else {\n        if (this.host.geo.isLeave && !this.host.geo.isDrag) {\n          this.host.tDown1 += this.host.geo.scene.annotationInstance.renderer.dt;\n          this.host.tOver = this.host.tOverPopupSummary = 0.0;\n          if (this.host.tDown1 > 0.15) {\n            this.host.geo.isLeave = false;\n          }\n        } else if (!this.host.geo.isDrag) {\n          this.host.tDown1 += this.host.geo.scene.annotationInstance.renderer.dt;\n          this.host.tOver = this.host.tOverPopupSummary = 0.0;\n        }\n      }\n      this.host.tUp = 0.0;\n      this.host.tDown2 += 0.01;\n    }\n    this.host.t += 0.01;\n  }\n  public updatePopupSummery() {\n    if (this.host.geo.isDrag) {\n      //\n    } else {\n      if (this.host.geo.isSelectedValue) {\n        //\n        if (this.host.geo.isHoverValue) {\n          this.host.tOverPopupSummary += this.incrementTimePopupSummary;\n        } else {\n          this.host.tOverPopupSummary = 0;\n        }\n        // this.host.geo.isLeave = true;\n      } else if (this.host.geo.isHoverValue) {\n        // this.host.tOver += 0.015;\n        this.host.tOverPopupSummary += this.incrementTimePopupSummary;\n        // this.host.tDown1 = 0.0;\n        // this.host.geo.isLeave = true;\n      } else {\n        if (this.host.geo.isLeave && !this.host.geo.isDrag) {\n          // this.host.tDown1 += 0.015;\n          this.host.tOverPopupSummary = 0.0;\n          if (this.host.tDown1 > 0.15) {\n            this.host.geo.isLeave = false;\n          }\n        } else if (!this.host.geo.isDrag) {\n          // this.host.tDown1 += 0.015;\n          this.host.tOverPopupSummary = 0.0;\n        }\n      }\n      // this.host.tUp = 0.0;\n      // this.host.tDown2 += 0.01;\n    }\n    // this.host.t += 0.01;\n  }\n}\n","import { InterpolateColor } from '../../../GeometryAnnotation/Helper/InterpolateColor';\nimport { Timer } from '../../../GeometryAnnotation/Helper/Timer';\nimport { AGeometryBase } from '../AGeometryBase';\nexport class RendererComponent {\n  public geo: AGeometryBase;\n  public timer: Timer;\n  public t = 0.0;\n  public tOver = 0.0;\n  public tOverPopupSummary = 0.0;\n  public tDown1 = 0.0;\n  public tDown2 = 0.0;\n  public tUp = 0.0;\n\n  public interpolateColor: InterpolateColor;\n\n  constructor(geo: AGeometryBase) {\n    this.geo = geo;\n    this.timer = new Timer(this);\n    this.interpolateColor = new InterpolateColor(this.geo);\n    this.geo.isRenderable = true;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    /* */\n  }\n}\n","import { GType, InteractionMode, Linecap } from '../../../../../../../lib';\nimport { RendererComponent as _RendererComponent } from '../../../../Common/Base/ComponentTemplate/RendererComponent';\nimport { APoint } from '../APoint';\nexport class RendererComponent extends _RendererComponent {\n  public host: APoint;\n  constructor(host: APoint) {\n    super(host);\n    this.host = host;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.timer.update();\n\n    // scale factor for nodes on rendering\n    this.host.scaleForRender = this.host.scene.annotationInstance.graphicsCoreWrapper.scaleScreenByRatioImageSize;\n    // if (this.host.edges[0]) {\n    //   this.host.scaleForRender = this.host.edges[0].styleComponent.renderStyle.scaleLocal * this.host.scene.annotationInstance.activeCommandController.scaleGlobal;\n    // }\n    // if (this.host.aEdges[0]) {\n    //   this.host.scaleForRender = this.host.aEdges[0].pGraph.styleComponent.renderStyle.scaleLocal * this.host.scene.annotationInstance.activeCommandController.scaleGlobal;\n    // }\n\n    ctx.lineCap = Linecap.Butt;\n    // this.UpdateScreenVecByProjectedPos();\n    if (this.host.scene.annotationInstance.implementations.app.model.appCoreWrapper.appControllerStatus.mode !== InteractionMode.Drawing) {\n      return;\n    }\n    // if (this.host.IsMove) { this.host.UpdateGoeVec(); }\n    if (this.host.isUnderConstruction) {\n      return;\n    }\n\n    if (this.host.type === GType.APOINT_PATH) {\n      // if (this.isHover) { this.host.scene.imageAnnoApp.renderer.preset.drawingPreset.APointPath( ctx, this.host.styleComponent.renderStyle, this.host.vec.x, this.host.vec.y ); }\n      return;\n    }\n\n    // this.VisTrajectory(ctx, new NVector3(this.host.vec.x, this.host.vec.y));\n    if (this.host.scene.annotationInstance.activeCommandController.acProperties.pressESC && this.host.isDrag) {\n      this.host.isDrag = false;\n      // this.host.vec = NVector3.DeepCopy(this.host.vecsHistory[this.host.vecsHistory.length - 1]);\n    }\n\n    // ........................................................... bg circle effect\n    // if (this.isSelectedSole && this.type === GTYPE.ANODE) {\n    //   const r = NumericalMotion.easeOutElastic2(this.tSelectedSole ) * 7 + 9;\n    //   this.host.scene.imageAnnoApp.renderer.preset.drawingPreset.NodeSelectedBGCircle(ctx, this.style, this.host.vec.x, this.host.vec.y, r, this.type);\n    //   this.tSelectedSole += 0.01;\n    // } else {\n    //   this.tSelectedSole = 0.0;\n    // }\n    const vec = this.host.scene.annotationInstance.geometryCommon.gcmdSupporting.toScreenVecOnCropping(this.host.vec);\n    // ........................................................... bg circle effect\n    if (this.host.type === GType.AMIDPOINT) {\n      // mid node\n      if (1 < this.tOver) {\n        // this.host.scene.imageAnnoApp.renderer.draw.shape.node.NodeMidStart(\n        //   ctx, this.host.styleComponent.renderStyle, vec.x, vec.y, NumericalMotion.easeOutElastic2(this.tOver * 2)\n        // );\n        this.host.scene.annotationInstance.renderer.draw.shape.node.nodeMidHover(\n          ctx,\n          this.host.styleComponent.renderStyle,\n          vec.x,\n          vec.y,\n          this.host.scaleForRender,\n          this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver * 2),\n          this.host.isSelectedSole\n        );\n      } else {\n        if (this.host.isHoverValue || this.host.isSelectedValue) {\n          this.host.scene.annotationInstance.renderer.draw.shape.node.nodeMidHover(\n            ctx,\n            this.host.styleComponent.renderStyle,\n            vec.x,\n            vec.y,\n            this.host.scaleForRender,\n            this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver * 2),\n            this.host.isSelectedSole\n          );\n          // this.host.scene.imageAnnoApp.renderer.draw.shape.node.NodeMidStart(\n          //   ctx, this.host.styleComponent.renderStyle, vec.x, vec.y, NumericalMotion.easeOutElastic2(this.tOver * 2)\n          // );\n        } else {\n          // this is for arrow\n          if (this.host.edges[0]) {\n            if (\n              this.host.edges[0].type === GType.ARROW_SINGLE ||\n              this.host.edges[0].type === GType.ARROW_DOUBLE\n            ) {\n              this.host.scene.annotationInstance.renderer.draw.shape.node.nodeMidHoverForArrow(\n                ctx,\n                this.host.styleComponent.renderStyle,\n                vec.x,\n                vec.y,\n                this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver * 2),\n                this.geo.scene.annotationInstance.customization.themeCurrent.node.sizeMid * this.host.scaleForRender,\n                this.host.isSelectedSole,\n                this.host.edges[0].styleComponent.state.themeColorId\n              );\n            }\n          }\n        }\n      }\n    } else {\n      // node\n      if (1 < this.tOver) {\n        if (this.host.isHoverValue || this.host.isSelectedValue) {\n          this.host.scene.annotationInstance.renderer.draw.shape.node.nodeHover(\n            ctx,\n            this.host.styleComponent.renderStyle,\n            vec.x,\n            vec.y,\n            this.host.scaleForRender,\n            this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(\n              this.tOver * 2\n            )\n          );\n        } else {\n          this.host.scene.annotationInstance.renderer.draw.shape.node.node(\n            ctx,\n            this.host.styleComponent.renderStyle,\n            vec.x,\n            vec.y,\n            this.host.scaleForRender\n          );\n        }\n      } else {\n        // for rendering nodes for arrow\n        if (this.host.edges[0]) {\n          if (\n            this.host.edges[0].type === GType.ARROW_SINGLE ||\n            this.host.edges[0].type === GType.ARROW_DOUBLE\n          ) {\n            this.host.scene.annotationInstance.renderer.draw.shape.node.nodeStart(\n              ctx,\n              this.host.styleComponent.renderStyle,\n              vec.x,\n              vec.y,\n              this.host.scaleForRender,\n              this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(\n                this.tOver * 2\n              ),\n              this.host.edges[0].styleComponent.state.themeColorId\n            );\n          } else {\n            this.host.scene.annotationInstance.renderer.draw.shape.node.nodeStart(\n              ctx,\n              this.host.styleComponent.renderStyle,\n              vec.x,\n              vec.y,\n              this.host.scaleForRender,\n              this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(\n                this.tOver * 2\n              )\n            );\n          }\n        } else {\n          this.host.scene.annotationInstance.renderer.draw.shape.node.nodeStart(\n            ctx,\n            this.host.styleComponent.renderStyle,\n            vec.x,\n            vec.y,\n            this.host.scaleForRender,\n            this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(\n              this.tOver * 2\n            )\n          );\n        }\n      }\n    }\n\n    if (this.host.isSelectedSole && this.host.type === GType.ANODE) {\n      this.host.scene.annotationInstance.renderer.draw.shape.node.nodeSelected(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        vec.x,\n        vec.y,\n        this.host.scaleForRender\n      );\n      this.host.tSelectedSole += 0.01;\n    } else {\n      this.host.tSelectedSole = 0.0;\n    }\n    // console.log(this.edges[0]);\n    // if (this.isHover && !AGeometry.appAnnotation.log.isHidden) { AdrawingPresetRenderStyle.PointDim(ctx, this.host.styleComponent.renderStyle, this.host.vec.x, this.host.vec.y, this.geoVec.x, this.geoVec.y); }\n    // if (this.hasPopup && this.IsMove) { this.UpdateDivPos(); }\n    this.t += this.host.scene.annotationInstance.renderer.dt;\n  }\n}\n","export enum LineTypeId {\n  Small = 'small',\n  Large = 'large',\n  Continuous = 'continuous',\n}\nexport enum ThemeColorId {\n  ThemeColor1 = 'themeColor1',\n  ThemeColor2 = 'themeColor2',\n  ThemeColor3 = 'themeColor3',\n  BackgroundColor = 'backgroundColor',\n  TitleColor = 'titleColor',\n  AccentColor1 = 'accentColor1',\n}\nexport const convertDashEnumToArray = (id: LineTypeId): number[] => {\n  switch (id) {\n    case LineTypeId.Large:\n      return [8, 4];\n    case LineTypeId.Small:\n      return [4, 4];\n    case LineTypeId.Continuous:\n      return [0, 0];\n    default:\n      return [];\n  }\n};\n","import {\n  hex2rgba,\n  rgb2Hex,\n} from '../../../../../lib';\nexport class NColor {\n  private _r: number;\n  private _g: number;\n  private _b: number;\n  private _a: number;\n  private rgnaStringValue: string;\n\n  public static fromHex(v: string, visibility = 1.0) {\n    const col = hex2rgba(v, visibility);\n    return new NColor(col[0], col[1], col[2], col[3]);\n  }\n  public static fromRGBA(r: number, g: number, b: number, a = 1.0) {\n    return new NColor(r, g, b, a);\n  }\n  public static toHex(c: NColor) {\n    return rgb2Hex(c.r, c.g, c.b);\n  }\n  constructor(r: number, g: number, b: number, a = 1.0) {\n    this.updateByRGBA(r, g, b, a);\n  }\n  public updateByRGBA(r: number, g: number, b: number, a = 1.0) {\n    this._r = r;\n    this._g = g;\n    this._b = b;\n    this._a = a;\n    this.updateString();\n  }\n  // .......................................................................\n  public get r() {\n    return this._r;\n  }\n  public set r(v: number) {\n    this._r = v;\n    this.updateString();\n  }\n  public get g() {\n    return this._g;\n  }\n  public set g(v: number) {\n    this._g = v;\n    this.updateString();\n  }\n  public get b() {\n    return this._b;\n  }\n  public set b(v: number) {\n    this._b = v;\n    this.updateString();\n  }\n  public get a() {\n    return this._a;\n  }\n  public set a(v: number) {\n    this._a = v;\n    this.updateString();\n  }\n  public normaliz() {\n    this.r /= 255;\n    this.g /= 255;\n    this.b /= 255;\n    return this;\n  }\n  public deepCopy() {\n    return new NColor(this._r, this._g, this._b, this._a);\n  }\n  public getArray() {\n    return [this._r, this._g, this._b, this._a];\n  }\n  // .......................................................................\n  public toRBGA_String(): string {\n    return this.rgnaStringValue;\n  }\n  private updateString() {\n    this.rgnaStringValue = `rgba(${this._r}, ${this._g}, ${this._b}, ${this._a})`;\n  }\n}\n","import { rgbaHueSaturationLightness, Linecap, Size } from '../../../../../lib';\nimport { ThemeObjectForStorymaps } from '../../../Customization/ThemeRenderStyle/StorymapsThemeStructure';\nimport { StyleComponent } from '../../Common/Base/ComponentTemplate/StyleComponent';\nimport { NColor } from './NColor';\nexport class RenderStyle {\n  public styleComponent: StyleComponent;\n  public interpolationNum: number;\n  public colorInterpolated: NColor;\n  public colorA: NColor;\n  public colorB: NColor;\n  public width = 32;\n  public height = 32;\n  public scaleLocal = 1;\n  public scaleGlobal = 1;\n  private _url: string | undefined = undefined;\n  private _colorFillFirst: NColor;\n  private _colorFillSecond: NColor;\n  private _colorStrokeFirst: NColor;\n  private _colorStrokeSecond: NColor;\n  private _lineWidth: number;\n  private _lineCap: Linecap = Linecap.Round;\n  private _dash: number[] = [];\n  private _size: Size = Size.MEDIUM;\n  public static updateRenderStyleRPoint(rs: RenderStyle, theme: ThemeObjectForStorymaps) {\n    const cols = theme.rPoint;\n    rs._colorFillFirst.updateByRGBA(\n      cols.fillStyleFirstArray[0],\n      cols.fillStyleFirstArray[1],\n      cols.fillStyleFirstArray[2],\n      cols.fillStyleFirstArray[3]\n    );\n    rs._colorFillSecond.updateByRGBA(\n      cols.fillStyleSecondArray[0],\n      theme.rPoint.fillStyleSecondArray[1],\n      theme.rPoint.fillStyleSecondArray[2],\n      theme.rPoint.fillStyleSecondArray[3]\n    );\n    rs._lineWidth = theme.rPoint.lineWidth;\n    rs.width = theme.rPoint.width;\n    rs.height = theme.rPoint.height;\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderColorRPointCustom(\n    rs: RenderStyle,\n    theme: ThemeObjectForStorymaps,\n    col: number[]\n  ) {\n    rs._colorFillFirst.updateByRGBA(col[0], col[1], col[2], col[3]);\n    rs._colorFillSecond.updateByRGBA(col[0], col[1], col[2], theme.properties.opacity);\n    rs._lineWidth = theme.rPoint.lineWidth;\n    rs.width = theme.rPoint.width;\n    rs.height = theme.rPoint.height;\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderStyleNPoint(rs: RenderStyle, theme: ThemeObjectForStorymaps) {\n    const cols = theme.nPoint;\n    rs._colorFillFirst.updateByRGBA(\n      cols.fillStyleFirstArray[0],\n      cols.fillStyleFirstArray[1],\n      cols.fillStyleFirstArray[2],\n      cols.fillStyleFirstArray[3]\n    );\n    rs._colorFillSecond.updateByRGBA(\n      cols.fillStyleSecondArray[0],\n      cols.fillStyleSecondArray[1],\n      cols.fillStyleSecondArray[2],\n      cols.fillStyleSecondArray[3]\n    );\n    // rs._colorStrokeSecond.UpdateByRGBA(theme.polylineColorHover[0], cols.strokeStyleSecondArray[1], cols.strokeStyleSecondArray[2], cols.strokeStyleSecondArray[3]);\n    rs._lineWidth = theme.nPoint.lineWidth;\n    rs.width = theme.nPoint.width;\n    rs.height = theme.nPoint.height;\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderColorNPoint(rs: RenderStyle, theme: ThemeObjectForStorymaps, cols: number[]) {\n    // const cols = theme.nPoint;\n    rs._colorFillFirst.updateByRGBA(cols[0], cols[1], cols[2], cols[3]);\n    rs._colorFillSecond.updateByRGBA(cols[0], cols[1], cols[2], theme.properties.opacity + 0.5);\n    // rs._colorStrokeSecond.UpdateByRGBA(theme.polylineColorHover[0], cols.strokeStyleSecondArray[1], cols.strokeStyleSecondArray[2], cols.strokeStyleSecondArray[3]);\n    // rs._lineWidth = theme.nPoint.lineWidth;\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderStylePolyline(rs: RenderStyle, theme: ThemeObjectForStorymaps) {\n    const cols = theme.polyline;\n    rs._colorStrokeFirst.updateByRGBA(\n      cols.strokeStyleFirstArray[0],\n      cols.strokeStyleFirstArray[1],\n      cols.strokeStyleFirstArray[2],\n      cols.strokeStyleFirstArray[3]\n    );\n    rs._colorStrokeSecond.updateByRGBA(\n      cols.strokeStyleSecondArray[0],\n      cols.strokeStyleSecondArray[1],\n      cols.strokeStyleSecondArray[2],\n      cols.strokeStyleSecondArray[3]\n    );\n    rs._lineWidth = theme.polyline.lineWidth;\n    rs.initInterpolationStroke(theme.properties.desaturationValue);\n  }\n  public static updateRenderColorPolyline(rs: RenderStyle, theme: ThemeObjectForStorymaps, cols: number[]) {\n    // const cols = theme.polyline;\n    rs._colorStrokeFirst.updateByRGBA(cols[0], cols[1], cols[2], cols[3]);\n    rs._colorStrokeSecond.updateByRGBA(cols[0], cols[1], cols[2], theme.properties.opacity + 0.5);\n    rs._lineWidth = theme.polyline.lineWidth;\n    rs.initInterpolationStroke(theme.properties.desaturationValue);\n  }\n  public static updateRenderStylePolylineNode(rs: RenderStyle, theme: ThemeObjectForStorymaps) {\n    const cols = theme.polyline;\n    rs._colorStrokeFirst.updateByRGBA(\n      cols.strokeStyleFirstArray[0],\n      cols.strokeStyleFirstArray[1],\n      cols.strokeStyleFirstArray[2],\n      cols.strokeStyleFirstArray[3]\n    );\n    rs._colorStrokeSecond.updateByRGBA(\n      cols.strokeStyleSecondArray[0],\n      cols.strokeStyleSecondArray[1],\n      cols.strokeStyleSecondArray[2],\n      cols.strokeStyleSecondArray[3]\n    );\n    rs._lineWidth = theme.polyline.lineWidth;\n    if (theme.properties.isDarkBG) {\n      rs._colorFillFirst.updateByRGBA(0, 0, 0, 1);\n    } else {\n      rs._colorFillFirst.updateByRGBA(255, 255, 255, 1);\n    }\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderColorPolylineNode(rs: RenderStyle, theme: ThemeObjectForStorymaps, cols: number[]) {\n    // const cols = theme.polyline;\n    rs._colorStrokeFirst.updateByRGBA(cols[0], cols[1], cols[2], cols[3]);\n    rs._colorStrokeSecond.updateByRGBA(cols[0], cols[1], cols[2], theme.properties.opacity + 0.5);\n    rs._lineWidth = theme.polyline.lineWidth;\n    if (theme.properties.isDarkBG) {\n      rs._colorFillFirst.updateByRGBA(0, 0, 0, 1);\n    } else {\n      rs._colorFillFirst.updateByRGBA(255, 255, 255, 1);\n    }\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderStylePolylineCustom(\n    rs: RenderStyle,\n    theme: ThemeObjectForStorymaps,\n    col: number[]\n  ) {\n    rs._colorStrokeFirst.updateByRGBA(col[0], col[1], col[2], col[3]);\n    rs._colorStrokeSecond.updateByRGBA(col[0], col[1], col[2], theme.properties.opacity);\n    rs._lineWidth = theme.polyline.lineWidth;\n    rs.initInterpolationStroke(theme.properties.desaturationValue);\n  }\n  public static updateRenderStylePolylineNodeCustom(\n    rs: RenderStyle,\n    theme: ThemeObjectForStorymaps,\n    col: number[]\n  ) {\n    rs._colorStrokeFirst.updateByRGBA(col[0], col[1], col[2], col[3]);\n    rs._colorStrokeSecond.updateByRGBA(col[0], col[1], col[2], theme.properties.opacity);\n    rs._lineWidth = theme.polyline.lineWidth;\n    if (theme.properties.isDarkBG) {\n      rs._colorFillFirst.updateByRGBA(0, 0, 0, 1);\n    } else {\n      rs._colorFillFirst.updateByRGBA(255, 255, 255, 1);\n    }\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n\n  public static updateRenderStyleArrow(rs: RenderStyle, theme: ThemeObjectForStorymaps) {\n    const cols = theme.arrow;\n    rs._colorFillFirst.updateByRGBA(\n      cols.fillStyleFirstArray[0],\n      cols.fillStyleFirstArray[1],\n      cols.fillStyleFirstArray[2],\n      cols.fillStyleFirstArray[3]\n    );\n    rs._colorFillSecond.updateByRGBA(\n      cols.fillStyleSecondArray[0],\n      cols.fillStyleSecondArray[1],\n      cols.fillStyleSecondArray[2],\n      cols.fillStyleSecondArray[3]\n    );\n    rs._colorStrokeFirst.updateByRGBA(\n      cols.strokeStyleFirstArray[0],\n      cols.strokeStyleFirstArray[1],\n      cols.strokeStyleFirstArray[2],\n      cols.strokeStyleFirstArray[3]\n    );\n    rs._colorStrokeSecond.updateByRGBA(\n      cols.strokeStyleSecondArray[0],\n      cols.strokeStyleSecondArray[1],\n      cols.strokeStyleSecondArray[2],\n      cols.strokeStyleSecondArray[3]\n    );\n    rs._lineWidth = cols.lineWidth;\n    rs.initInterpolationStroke(theme.properties.desaturationValue);\n  }\n  public static updateRenderStyleArrowNode(rs: RenderStyle, theme: ThemeObjectForStorymaps) {\n    const cols = theme.arrow;\n    // rs._colorFill.UpdateByRGBA(colsColorArray[0], colsColorArray[1], colsColorArray[2], colsColorArray[3]);\n    // rs._colorFillSecond.UpdateByRGBA(colsColorHoverArray[0], colsColorHoverArray[1], colsColorHoverArray[2], colsColorHoverArray[3]);\n    rs._colorStrokeFirst.updateByRGBA(\n      cols.strokeStyleFirstArray[0],\n      cols.strokeStyleFirstArray[1],\n      cols.strokeStyleFirstArray[2],\n      cols.strokeStyleFirstArray[3]\n    );\n    rs._colorStrokeSecond.updateByRGBA(\n      cols.strokeStyleSecondArray[0],\n      cols.strokeStyleSecondArray[1],\n      cols.strokeStyleSecondArray[2],\n      cols.strokeStyleSecondArray[3]\n    );\n    rs._lineWidth = cols.lineWidth;\n    if (theme.properties.isDarkBG) {\n      rs._colorFillFirst.updateByRGBA(0, 0, 0, 1);\n    } else {\n      rs._colorFillFirst.updateByRGBA(255, 255, 255, 1);\n    }\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderStyleArrowCustom(\n    rs: RenderStyle,\n    theme: ThemeObjectForStorymaps,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    styleCustom: any\n  ) {\n    const col = styleCustom.colorRgba;\n    rs._colorFillFirst.updateByRGBA(col[0], col[1], col[2], col[3]);\n    rs._colorFillSecond.updateByRGBA(col[0], col[1], col[2], theme.properties.opacity + 0.5);\n    rs._colorStrokeFirst.updateByRGBA(col[0], col[1], col[2], col[3]);\n    rs._colorStrokeSecond.updateByRGBA(col[0], col[1], col[2], theme.properties.opacity);\n    rs._lineWidth = styleCustom.width;\n    rs.initInterpolationStroke(theme.properties.desaturationValue);\n  }\n  public static updateRenderColorArrowCustom(rs: RenderStyle, theme: ThemeObjectForStorymaps, col: number[]) {\n    rs._colorFillFirst.updateByRGBA(col[0], col[1], col[2], col[3]);\n    rs._colorFillSecond.updateByRGBA(col[0], col[1], col[2], theme.properties.opacity + 0.5);\n    rs._colorStrokeFirst.updateByRGBA(col[0], col[1], col[2], col[3]);\n    rs._colorStrokeSecond.updateByRGBA(col[0], col[1], col[2], theme.properties.opacity);\n    rs._lineWidth = theme.arrow.lineWidth;\n    rs.initInterpolationStroke(theme.properties.desaturationValue);\n  }\n  public static updateRenderStyleArrowNodeCustom(\n    rs: RenderStyle,\n    theme: ThemeObjectForStorymaps,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    styleCustom: any\n  ) {\n    const col = styleCustom.colorRgba;\n    rs._colorStrokeFirst.updateByRGBA(col[0], col[1], col[2], col[3]);\n    rs._colorStrokeSecond.updateByRGBA(col[0], col[1], col[2], col[3]);\n    rs._lineWidth = styleCustom.width;\n    if (theme.properties.isDarkBG) {\n      rs._colorFillFirst.updateByRGBA(0, 0, 0, 1);\n    } else {\n      rs._colorFillFirst.updateByRGBA(255, 255, 255, 1);\n    }\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderColorArrowNodeCustom(rs: RenderStyle, theme: ThemeObjectForStorymaps, col: number[]) {\n    rs._colorStrokeFirst.updateByRGBA(col[0], col[1], col[2], col[3]);\n    rs._colorStrokeSecond.updateByRGBA(col[0], col[1], col[2], col[3]);\n\n    if (theme.properties.isDarkBG) {\n      rs._colorFillFirst.updateByRGBA(0, 0, 0, 1);\n    } else {\n      rs._colorFillFirst.updateByRGBA(255, 255, 255, 1);\n    }\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderStylePolygon(rs: RenderStyle, theme: ThemeObjectForStorymaps) {\n    const cols = theme.polygon;\n    rs._colorFillFirst.updateByRGBA(\n      cols.fillStyleFirstArray[0],\n      cols.fillStyleFirstArray[1],\n      cols.fillStyleFirstArray[2],\n      cols.fillStyleFirstArray[3]\n    );\n    rs._colorFillSecond.updateByRGBA(\n      cols.fillStyleSecondArray[0],\n      cols.fillStyleSecondArray[1],\n      cols.fillStyleSecondArray[2],\n      cols.fillStyleSecondArray[3]\n    );\n    rs._colorStrokeFirst.updateByRGBA(\n      cols.strokeStyleFirstArray[0],\n      cols.strokeStyleFirstArray[1],\n      cols.strokeStyleFirstArray[2],\n      cols.strokeStyleFirstArray[3]\n    );\n    rs._colorStrokeSecond.updateByRGBA(\n      cols.strokeStyleSecondArray[0],\n      cols.strokeStyleSecondArray[1],\n      cols.strokeStyleSecondArray[2],\n      cols.strokeStyleSecondArray[3]\n    );\n    rs._lineWidth = cols.lineWidth;\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderColorPolygon(rs: RenderStyle, theme: ThemeObjectForStorymaps, colsStroke: number[], colsFill: number[]) {\n    // const cols = theme.polygon;\n    rs._colorFillFirst.updateByRGBA(colsFill[0], colsFill[1], colsFill[2], colsFill[3]);\n    rs._colorFillSecond.updateByRGBA(colsFill[0], colsFill[1], colsFill[2], theme.properties.opacity + 0.5);\n    rs._colorStrokeFirst.updateByRGBA(colsStroke[0], colsStroke[1], colsStroke[2], colsStroke[3]);\n    rs._colorStrokeSecond.updateByRGBA(colsStroke[0], colsStroke[1], colsStroke[2], theme.properties.opacity + 0.5);\n    rs._lineWidth = theme.polygon.lineWidth; // rs.lineWidth;\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderStylePolygonNode(rs: RenderStyle, theme: ThemeObjectForStorymaps) {\n    const cols = theme.polygon;\n    rs._colorStrokeFirst.updateByRGBA(\n      cols.strokeStyleFirstArray[0],\n      cols.strokeStyleFirstArray[1],\n      cols.strokeStyleFirstArray[2],\n      cols.strokeStyleFirstArray[3]\n    );\n    rs._colorStrokeSecond.updateByRGBA(\n      cols.strokeStyleSecondArray[0],\n      cols.strokeStyleSecondArray[1],\n      cols.strokeStyleSecondArray[2],\n      cols.strokeStyleSecondArray[3]\n    );\n    rs._lineWidth = cols.lineWidth;\n    if (theme.properties.isDarkBG) {\n      rs._colorFillFirst.updateByRGBA(0, 0, 0, 1);\n    } else {\n      rs._colorFillFirst.updateByRGBA(255, 255, 255, 1);\n    }\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderColorPolygonNode(rs: RenderStyle, theme: ThemeObjectForStorymaps, cols: number[]) {\n    // const cols = theme.polygon;\n    rs._colorStrokeFirst.updateByRGBA(cols[0], cols[1], cols[2], cols[3]);\n    rs._colorStrokeSecond.updateByRGBA(cols[0], cols[1], cols[2], theme.properties.opacity + 0.5);\n    // rs._lineWidth = cols.lineWidth;\n    if (theme.properties.isDarkBG) {\n      rs._colorFillFirst.updateByRGBA(0, 0, 0, 1);\n    } else {\n      rs._colorFillFirst.updateByRGBA(255, 255, 255, 1);\n    }\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderStylePolygonCustom(\n    rs: RenderStyle,\n    theme: ThemeObjectForStorymaps,\n    col: number[],\n    fill: number[]\n  ) {\n    const cols = theme.polygon;\n    rs._colorFillFirst.updateByRGBA(fill[0], fill[1], fill[2], fill[3]);\n\n    if (fill[3] - theme.properties.opacity > 0) {\n      rs._colorFillSecond.updateByRGBA(\n        fill[0],\n        fill[1],\n        fill[2],\n        fill[3] - theme.properties.opacity\n      );\n    } else {\n      rs._colorFillSecond.updateByRGBA(fill[0], fill[1], fill[2], 0.3);\n    }\n\n    rs._colorStrokeFirst.updateByRGBA(col[0], col[1], col[2], col[3]);\n    rs._colorStrokeSecond.updateByRGBA(col[0], col[1], col[2], theme.properties.opacity);\n    rs._lineWidth = cols.lineWidth;\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderStylePolygonNodeCustom(\n    rs: RenderStyle,\n    theme: ThemeObjectForStorymaps,\n    col: number[],\n    fill: number[]\n  ) {\n    const cols = theme.polygon;\n    rs._colorStrokeFirst.updateByRGBA(col[0], col[1], col[2], col[3]);\n    rs._colorStrokeSecond.updateByRGBA(col[0], col[1], col[2], theme.properties.opacity);\n    rs._lineWidth = cols.lineWidth;\n    if (theme.properties.isDarkBG) {\n      rs._colorFillFirst.updateByRGBA(0, 0, 0, 1);\n    } else {\n      rs._colorFillFirst.updateByRGBA(255, 255, 255, 1);\n    }\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  // ..................................................................................... FREEHAND\n  public static updateRenderStyleFH(rs: RenderStyle, theme: ThemeObjectForStorymaps) {\n    const cols = theme.freehand;\n    rs._colorFillFirst.updateByRGBA(\n      cols.fillStyleFirstArray[0],\n      cols.fillStyleFirstArray[1],\n      cols.fillStyleFirstArray[2],\n      cols.fillStyleFirstArray[3]\n    );\n    rs._colorStrokeFirst.updateByRGBA(\n      cols.strokeStyleFirstArray[0],\n      cols.strokeStyleFirstArray[1],\n      cols.strokeStyleFirstArray[2],\n      cols.strokeStyleFirstArray[3]\n    );\n    rs._lineWidth = cols.lineWidth;\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderStyleFHPolyline(rs: RenderStyle, theme: ThemeObjectForStorymaps) {\n    const cols = theme.polyline;\n    const theOpacity = theme.properties.opacity;\n    rs._colorStrokeFirst.updateByRGBA(\n      cols.strokeStyleFirstArray[0],\n      cols.strokeStyleFirstArray[1],\n      cols.strokeStyleFirstArray[2],\n      theOpacity\n    );\n    rs._colorStrokeSecond.updateByRGBA(\n      cols.strokeStyleSecondArray[0],\n      cols.strokeStyleSecondArray[1],\n      cols.strokeStyleSecondArray[2],\n      theOpacity\n    );\n    rs._lineWidth = theme.polyline.lineWidth;\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderStyleFHPolylineNode(rs: RenderStyle, theme: ThemeObjectForStorymaps) {\n    const cols = theme.polyline;\n    const theOpacity = theme.properties.opacity;\n    rs._colorStrokeFirst.updateByRGBA(\n      cols.strokeStyleFirstArray[0],\n      cols.strokeStyleFirstArray[1],\n      cols.strokeStyleFirstArray[2],\n      theOpacity\n    );\n    rs._colorStrokeSecond.updateByRGBA(\n      cols.strokeStyleSecondArray[0],\n      cols.strokeStyleSecondArray[1],\n      cols.strokeStyleSecondArray[2],\n      theOpacity\n    );\n    rs._lineWidth = theme.polyline.lineWidth;\n    if (theme.properties.isDarkBG) {\n      rs._colorFillFirst.updateByRGBA(0, 0, 0, theOpacity);\n    } else {\n      rs._colorFillFirst.updateByRGBA(255, 255, 255, theOpacity);\n    }\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderStyleFHPolygon(rs: RenderStyle, theme: ThemeObjectForStorymaps) {\n    const cols = theme.polygon;\n    const theOpacity = theme.properties.opacity;\n    rs._colorFillFirst.updateByRGBA(\n      cols.fillStyleFirstArray[0],\n      cols.fillStyleFirstArray[1],\n      cols.fillStyleFirstArray[2],\n      theOpacity\n    );\n    rs._colorFillSecond.updateByRGBA(\n      cols.fillStyleSecondArray[0],\n      cols.fillStyleSecondArray[1],\n      cols.fillStyleSecondArray[2],\n      theOpacity\n    );\n    rs._colorStrokeFirst.updateByRGBA(\n      cols.strokeStyleFirstArray[0],\n      cols.strokeStyleFirstArray[1],\n      cols.strokeStyleFirstArray[2],\n      theOpacity\n    );\n    rs._colorStrokeSecond.updateByRGBA(\n      cols.strokeStyleSecondArray[0],\n      cols.strokeStyleSecondArray[1],\n      cols.strokeStyleSecondArray[2],\n      theOpacity\n    );\n    rs._lineWidth = cols.lineWidth;\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  public static updateRenderStyleFHPolygonNode(rs: RenderStyle, theme: ThemeObjectForStorymaps) {\n    const cols = theme.polygon;\n    const theOpacity = theme.properties.opacity;\n    rs._colorStrokeFirst.updateByRGBA(\n      cols.strokeStyleFirstArray[0],\n      cols.strokeStyleFirstArray[1],\n      cols.strokeStyleFirstArray[2],\n      theOpacity\n    );\n    rs._colorStrokeSecond.updateByRGBA(\n      cols.strokeStyleSecondArray[0],\n      cols.strokeStyleSecondArray[1],\n      cols.strokeStyleSecondArray[2],\n      theOpacity\n    );\n    rs._lineWidth = cols.lineWidth;\n    if (theme.properties.isDarkBG) {\n      rs._colorFillFirst.updateByRGBA(0, 0, 0, theOpacity);\n    } else {\n      rs._colorFillFirst.updateByRGBA(255, 255, 255, theOpacity);\n    }\n    rs.initInterpolation(theme.properties.desaturationValue);\n  }\n  // ..................................................................................... end FREEHAND\n  // public static UpdateRenderStyleATextleaderlineNode(\n  //   rs: RenderStyle,\n  //   theme: ThemeObjectForStorymaps\n  // ) {\n  //   const cols = theme.textleaderline;\n  //   rs._colorFillFirst.UpdateByRGBA(\n  //     cols.fillStyleFirstArray[0],\n  //     cols.fillStyleFirstArray[1],\n  //     cols.fillStyleFirstArray[2],\n  //     cols.fillStyleFirstArray[3]\n  //   );\n  //   rs._colorFillSecond.UpdateByRGBA(\n  //     cols.fillStyleSecondArray[0],\n  //     cols.fillStyleSecondArray[1],\n  //     cols.fillStyleSecondArray[2],\n  //     cols.fillStyleSecondArray[3]\n  //   );\n  //   // rs._colorStrokeFirst.UpdateByRGBA(cols.strokeStyleFirstArray[0], cols.strokeStyleFirstArray[1], cols.strokeStyleFirstArray[2], cols.strokeStyleFirstArray[3]);\n  //   // rs._colorStrokeSecond.UpdateByRGBA(cols.strokeStyleSecondArray[0], cols.strokeStyleSecondArray[1], cols.strokeStyleSecondArray[2], cols.strokeStyleSecondArray[3]);\n  //   rs._lineWidth = cols.lineWidth;\n  //   rs.InitInterpolation(theme.properties.desaturationValue);\n  // }\n  public static shiftNodeStyle(rs: RenderStyle, other: RenderStyle) {\n    other._colorFillFirst = rs._colorStrokeFirst.deepCopy();\n    other._colorStrokeFirst = rs._colorFillFirst.deepCopy();\n  }\n  public static shiftNodeStyleCustom(rs: RenderStyle, other: RenderStyle) {\n    other._colorFillFirst = rs._colorStrokeFirst.deepCopy();\n    other._colorStrokeFirst = rs._colorFillFirst.deepCopy();\n  }\n\n  public static deepCopy(rs: RenderStyle, other: RenderStyle) {\n    other._colorFillFirst = rs._colorFillFirst.deepCopy();\n    other._colorFillSecond = rs._colorFillSecond.deepCopy();\n    other._colorStrokeFirst = rs._colorStrokeFirst.deepCopy();\n    other._colorStrokeSecond = rs._colorStrokeSecond.deepCopy();\n    other._lineCap = rs._lineCap;\n    other._lineWidth = rs._lineWidth;\n  }\n  constructor(styleComponent?: StyleComponent) {\n    if (styleComponent) {\n      this.styleComponent = styleComponent;\n      this.scaleGlobal = styleComponent.geo.scene.annotationInstance.activeCommandController.scaleGlobal;\n    }\n    this._colorFillFirst = new NColor(0, 0, 0);\n    this._colorFillSecond = new NColor(0, 0, 0);\n    this._colorStrokeFirst = new NColor(0, 0, 0);\n    this._colorStrokeSecond = new NColor(0, 0, 0);\n    this._lineWidth = 3;\n  }\n  public initInterpolation(desaturateVaule: number) {\n    this.colorInterpolated = this._colorFillFirst.deepCopy(); // ColorUtility.RGB_String_To_Array(this.renderStyle.colorFill);\n    this.colorA = this._colorFillFirst.deepCopy(); // ColorUtility.RGB_String_To_Array(this.renderStyle.colorFill);\n    this.colorB = this._colorFillSecond.deepCopy(); // ColorUtility.RGB_String_To_Array(this.renderStyle.colorFillHover);\n    const col = rgbaHueSaturationLightness(\n      [this.colorB.r, this.colorB.g, this.colorB.b, this.colorB.a],\n      0,\n      desaturateVaule,\n      0\n    );\n    this.colorB.r = col[0];\n    this.colorB.g = col[1];\n    this.colorB.b = col[2];\n    this.colorB.a = col[3];\n  }\n  public initInterpolationStroke(desaturateVaule: number) {\n    this.colorInterpolated = this._colorStrokeFirst.deepCopy(); // ColorUtility.RGB_String_To_Array(this.renderStyle.colorFill);\n    this.colorA = this._colorStrokeFirst.deepCopy(); // ColorUtility.RGB_String_To_Array(this.renderStyle.colorFill);\n    this.colorB = this._colorStrokeSecond.deepCopy(); // ColorUtility.RGB_String_To_Array(this.renderStyle.colorFillHover);\n    const col = rgbaHueSaturationLightness(\n      [this.colorB.r, this.colorB.g, this.colorB.b, this.colorB.a],\n      0,\n      desaturateVaule,\n      0\n    );\n    this.colorB.r = col[0];\n    this.colorB.g = col[1];\n    this.colorB.b = col[2];\n    this.colorB.a = col[3];\n  }\n  public get colorInterpolatedString() {\n    return this.colorInterpolated.toRBGA_String();\n  }\n  public get colorFill() {\n    return this._colorFillFirst.toRBGA_String();\n  }\n  public get colorFillHover() {\n    return this._colorFillSecond.toRBGA_String();\n  }\n  public get colorStroke() {\n    return this._colorStrokeFirst.toRBGA_String();\n  }\n  public get colorStrokeHover() {\n    return this._colorStrokeSecond.toRBGA_String();\n  }\n  public get lineWidth() {\n    return this._lineWidth;\n  }\n  public get lineCap() {\n    return this._lineCap;\n  }\n  public get dash() {\n    return this._dash;\n  }\n  public set dash(v: number[]) {\n    this._dash = v;\n  }\n  public get url() {\n    return this._url as string;\n  }\n  public set url(v: string) {\n    this._url = v;\n    this.styleComponent.geo.scene.annotationInstance.customization.iconAsset.addIcon(v);\n  }\n  public get size() {\n    return this._size;\n  }\n  public set size(v: Size) {\n    this._size = v;\n  }\n}\n","import { LineTypeId, ThemeColorId } from '../../../../Customization/ThemeRenderStyle/Utility';\nimport { RenderStyle } from '../../../GeometryAnnotation/Helper/RenderStyle';\nimport { AGeometryBase } from '../AGeometryBase';\nexport class State {\n  public scale = 1;\n  public width = 2;\n  public themeColorId: ThemeColorId = ThemeColorId.TitleColor;\n  public lineTypeId: LineTypeId = LineTypeId.Continuous;\n}\nexport class StyleComponent {\n  public geo: AGeometryBase;\n  public renderStyle: RenderStyle;\n  public renderStyleNode: RenderStyle;\n  public isCustom = false;\n  public state: State;\n  protected tempColorRgba: number[] = [0, 0, 0, 0];\n  protected tempFillRgba: number[] = [0, 0, 0, 0];\n\n  constructor(geo: AGeometryBase) {\n    this.geo = geo;\n    this.state = new State();\n    this.renderStyle = new RenderStyle();\n    this.renderStyleNode = new RenderStyle();\n  }\n  public updateColor(v: number[] | undefined = undefined) {\n    /* */\n  }\n  public updateStyle() {\n    /* */\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public updateStyleCustom(style: any): boolean {\n    return false;\n  }\n  public setDash(v: number[]) {\n    /* */\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public toJson(): any | undefined {\n    return undefined;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  protected isSameStyle(style: any) {\n    return false;\n  }\n}\n","import { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { APoint } from '../APoint';\nexport class StyleComponent extends _StyleComponent {\n  public geoHost: APoint;\n  public renderStyle: RenderStyle;\n  public renderStyleNode: RenderStyle;\n  private renderStyleOrigin: RenderStyle;\n  private renderStyleOpposite: RenderStyle;\n  constructor(geo: APoint) {\n    super(geo);\n    this.renderStyle = new RenderStyle();\n    this.renderStyleNode = new RenderStyle();\n    this.renderStyleOrigin = new RenderStyle();\n    this.renderStyleOpposite = new RenderStyle();\n    this.updateStyle();\n  }\n  public updateStyle() {\n    // RenderStyle.UpdateRenderStyleRPoint(this.renderStyle, this.geo.scene.annotationInstance.customization.themeCurrent );\n  }\n  public updateStyleForNode(rs: RenderStyle) {\n    this.renderStyle = rs;\n    RenderStyle.deepCopy(rs, this.renderStyleOrigin);\n    RenderStyle.shiftNodeStyle(rs, this.renderStyleOpposite);\n  }\n  public shiftNodeStyle(v: boolean) {\n    if (v) {\n      this.renderStyle = this.renderStyleOpposite;\n    } else {\n      this.renderStyle = this.renderStyleOrigin;\n    }\n  }\n}\n","import { APoint } from '../APoint';\nexport class Inspector {\n  public host: APoint;\n  constructor(host: APoint) {\n    this.host = host;\n  }\n  public update(ctx: CanvasRenderingContext2D) {\n    if (!this.host.scene.annotationInstance.implementations.app.INSPECTION) {\n      return;\n    }\n    // this.Show(ctx);\n    this.showStatus(ctx);\n  }\n  public show(ctx: CanvasRenderingContext2D) {\n    let pos = this.host.vec;\n    ctx.beginPath();\n    ctx.arc(pos.x, pos.y, 5, 0, 3.14 * 2);\n    ctx.closePath();\n    ctx.fillStyle = '#ff0000';\n    ctx.fill();\n    const text = '0'; // `${pos.long} -- ${pos.proX}`;\n    ctx.fillText(text, pos.x, pos.y - 5);\n\n    pos = this.host.vec;\n    ctx.beginPath();\n    ctx.arc(pos.x, pos.y, 5, 0, 3.14 * 2);\n    ctx.closePath();\n    ctx.fillStyle = '#ff0000';\n    ctx.fill();\n    // text = `${pos.long} -- ${pos.proX}`;\n    ctx.fillText(text, pos.x, pos.y + 10);\n  }\n  public showStatus(ctx: CanvasRenderingContext2D) {\n    const pos = this.host.vec;\n    ctx.beginPath();\n    ctx.arc(pos.x, pos.y, 5, 0, 3.14 * 2);\n    ctx.closePath();\n    ctx.fillStyle = '#ff0000';\n    ctx.fill();\n    const text = `IsTransform: ${this.host.isTransform}`;\n    ctx.fillText(text, pos.x + 10, pos.y + 10);\n\n    const type = `Type: ${this.host.type}`;\n    ctx.fillText(type, pos.x + 100, pos.y + 10);\n  }\n}\n","import { IOGeometry, IOGeoVec } from '../../../../../../lib/Extended/GeometryUtility';\nimport { getDistance, NVector3, plus, scale, GType, MouseEventData } from '../../../../../../lib';\nimport { ActiveCommandController } from '../../../../ActiveCommandController/ActiveCommandController';\nimport { Scene } from '../../../../Scene';\nimport { AGeometryBase } from '../../../Common/Base/AGeometryBase';\nimport { ALineBase } from '../../../Common/Base/ALineBase';\nimport { APointBase } from '../../../Common/Base/APointBase';\nimport { APolygonWrapper } from '../../FamilyArea/APolygonWrapper/APolygonWrapper';\nimport { ARectangleWrapper } from '../../FamilyArea/ARectangleWrapper/ARectangleWrapper';\n// import { ACurve } from '../../FamilyCurve/ACurveWrapper/ACurve';\n// import { AArrow } from '../../FamilyLine/AArrowWrapper/AArrow';\nimport { APolylineEdge } from '../../FamilyLine/APolylineGraphWrapper/Base/APolylineEdge';\nimport { ATextleaderlineWrapper } from '../../FamilyText/ATextleaderline';\nimport { RendererComponent } from './Component/RendererComponent';\nimport { StyleComponent } from './Component/StyleComponent';\nimport { Inspector } from './Inspector';\nexport class APoint extends APointBase {\n  static id = 0;\n  public styleComponent: StyleComponent;\n  public renderer: RendererComponent;\n  public aEdges: APolylineEdge[] = [];\n  // aEdges: ALine[];\n  public isConnected: boolean;\n  public nodeID = -1;\n\n  public nodes: APoint[];\n\n  public tSelectedSole = 0.0;\n  public inspector: Inspector;\n  private _isSelectedSole = false;\n\n  static computeAllLineNetworkSnap(scene: Scene) {\n    for (let i = 0; i < scene.listAPoint.length - 1; ++i) {\n      // scene.listAPoint[i].UpdateGoeVec();\n      for (let j = i + 1; j < scene.listAPoint.length; ++j) {\n        const dis = getDistance(scene.listAPoint[i].vec, scene.listAPoint[j].vec);\n        if (dis < 5) {\n          scene.listAPoint[j].vec = scene.listAPoint[i].vec;\n        }\n      }\n    }\n  }\n  static computeLineNetworkSnap(p: APoint) {\n    //     let vs = [];\n    //     for (let i = 0; i < APoint.list.length; ++i) {\n    //         if (p !== APoint.list[i]) {\n    //             if (Distance(p.vec, APoint.list[i].vec) < 9) {\n    //                 // p.vec = APoint.list[i].vec;\n    //                 vs.push(APoint.list[i]);\n    //             }\n    //         }\n    //     }\n    //     let length = vs.length;\n    //     for (let i = 1; i < length; ++i) {\n    //         vs[i].vec = vs[0].vec;\n    //     }\n    //     if (length > 0) {\n    //         // if (vs[0].type === GTYPE.AMIDPOINT_ALINE) {\n    //         //     const np = vs[0].SplitMidPointbyNewVec(p.vec.x, p.vec.y) as APoint;\n    //         //     if (np) {\n    //         //         np.vec = vs[0].vec;\n    //         //         console.log('re');\n    //         //         this.ComputeLineNetworkSnap(np);\n    //         //     }\n    //         // }\n    //         p.vec = vs[0].vec;\n    //     }\n    //     return;\n  }\n  // .............................................. geometry mananging common\n  static getVecs(pts: APoint[]) {\n    const vs: NVector3[] = [];\n    let i = pts.length;\n    while (i--) {\n      vs.push(pts[i].vec);\n    }\n    return vs;\n  }\n  static getIndexFromParent(p: APoint): number {\n    const rect = p.edges[0] as ARectangleWrapper;\n    if (rect.pts[0] === p) {\n      return 0;\n    } else if (rect.pts[1] === p) {\n      return 1;\n    } else if (rect.pts[2] === p) {\n      return 2;\n    } else if (rect.pts[3] === p) {\n      return 3;\n    }\n    return -1;\n  }\n  static findAtPoint(scene: Scene, x: number, y: number): undefined | AGeometryBase {\n    for (let i = scene.listAPoint.length - 1; i >= 0; --i) {\n      if (scene.listAPoint[i].isSelectable && scene.listAPoint[i].isMouseInside(x, y)) {\n        return scene.listAPoint[i] as AGeometryBase;\n      }\n    }\n    return undefined;\n  }\n  static removeAllCapturedGeo(scene: Scene) {\n    const temp = scene.listAPoint;\n    for (let i = 0; i < temp.length; ++i) {\n      if (scene.listAPoint[i].isSelectedValue === true) {\n        scene.listAPoint[i].remove();\n      }\n    }\n  }\n  static DeSelecteCaptureObjects(scene: Scene) {\n    for (let i = 0; i < scene.listAPoint.length; ++i) {\n      scene.listAPoint[i].isSelectedValue = false;\n    }\n  }\n  static moveSelectedGeo(scene: Scene, e: MouseEventData) {\n    for (let i = 0; i < scene.listAPoint.length; ++i) {\n      if (scene.listAPoint[i].isSelectedValue === true && !scene.listAPoint[i].isHoverValue) {\n        scene.listAPoint[i].translateByMouseEventData(e);\n      }\n      if (scene.listAPoint[i].isHoverValue === true) {\n        scene.listAPoint[i].translateByMouseEventData(e);\n      }\n    }\n  }\n  static getNodeFromScreenPos(scene: Scene, g: NVector3, isUndo = false, isDeepCopy = false) {\n    const node = new APoint(scene, g.x, g.y, g.z, isUndo);\n    node.vec.w = g.w;\n    node.weightLeft = g.w;\n    node.weightRight = g.w;\n    node.isUnderConstruction = false;\n    return node;\n  }\n  static getNodeFromJSON(scene: Scene, g: IOGeoVec, isUndo = false, isDeepCopy = false) {\n    const node = new APoint(scene, g.sx, g.sy, 0, isUndo);\n    // node.vec.w = g.w;\n    // node.weightLeft = g.w;\n    // node.weightRight = g.w;\n    node.isUnderConstruction = false;\n    return node;\n  }\n  static getNodeFromVec(scene: Scene, g: NVector3, isUndo = false, isDeepCopy = false) {\n    return APoint.getNodeFromScreenPos(scene, g, isUndo, isDeepCopy);\n  }\n  static fromJSON(scene: Scene, g: IOGeometry, isUndo = false, isDeepCopy = false) {\n    // let mp = AGeometry.GetMapPoint(g.nodes[0].x, g.nodes[0].y);\n    // mp.longitude = g.nodes[0].x;\n    // mp.latitude = g.nodes[0].y;\n    // mp.spatialReference.wkid = 102100;\n    // let mp = new AGeometry.appAnnotation.drawingTool.mPointClass({ longitude: g.nodes[0].x, latitude: g.nodes[0].y, spatialReference: 102100 });\n    // let p = AGeometry.mapView.toScreen(mp);\n    // let p = scene.imageAnnoApp.geometryCommon.gcmdSupporting.toScreenFromProjectedPos(g.nodes[0].sx, g.nodes[0].sy ); // .toScreen(mp);\n    const cp = new APoint(scene, g.nodes[0].sx, g.nodes[0].sy, 0);\n    cp.type = GType[g.type];\n    // cp.style = g.style;\n    // cp.id = g.id;\n  }\n  // ......................................................................... mouse interaction\n  public static mouseRightClick(e: MouseEventData) {\n    /* */\n  }\n  public static mouseMiddleClick(e: MouseEventData) {\n    /* */\n  }\n  public static mouseLeftClick(scene: Scene, e: MouseEventData) {\n    if (scene.capture !== undefined) {\n      // if (scene.capture.type === GTYPE.ALINE) {\n      //   if (ALine.needAttach) {\n      //     let cLn = scene.capture as ALine;\n      //     cLn.splitLineByVec(new NVector3(e.x, e.y, 0));\n      //   } else {\n      //     // console.log('mouse click with no attach');\n      //   }\n      // }\n    } else {\n      const g = new APoint(scene, e.x, e.y, 0);\n      g.dummy();\n    }\n  }\n  constructor(\n    scene: Scene,\n    x = 0,\n    y = 0,\n    z = 0,\n    isUndo = false,\n    type: GType = GType.ANODE,\n    radius = 5\n  ) {\n    super(scene, x, y, z, type);\n    this.initComponent();\n    // console.log(x, y);\n    this.isUndo = isUndo;\n    this.aEdges = [];\n    this.isConnected = false;\n    this.inspector = new Inspector(this);\n    // console.log(this.vec);\n    // this.UpdateGoeVec();\n    // APoint.Add(this);\n    this.scene.addAPoint(this);\n  }\n  public init() {\n    // this.t = 0;\n    this.isPointMid = false;\n    // if (this.hasSound) { this.sound.PlayClickPoint(); }\n  }\n  public initComponent() {\n    this.styleComponent = new StyleComponent(this);\n    this.renderer = new RendererComponent(this);\n  }\n  public getParentType() {\n    return 'APoint';\n  }\n  public addEdge(e: AGeometryBase) {\n    // ALineBase\n    if (this.edges.indexOf(e) !== -1) {\n      return;\n    }\n    this.type = GType.ANODE;\n    this.edges.push(e);\n    if (this.edges[0]) {\n      this.styleComponent.updateStyleForNode(this.edges[0].styleComponent.renderStyleNode);\n    }\n  }\n  public addNode(n: APoint) {\n    if (this.nodes.indexOf(n) !== -1) {\n      return;\n    }\n    n.type = GType.ANODE;\n    this.nodes.push(n);\n  }\n  public getSharedNode(n: APoint): APoint | undefined {\n    for (const ee of this.edges) {\n      const e: ALineBase = ee as ALineBase;\n      let dis = getDistance(e.p0.vec, n.vec);\n      if (dis < 0.01) {\n        return e.p0;\n      }\n      dis = getDistance(e.p1.vec, n.vec);\n      if (dis < 0.01) {\n        return e.p1;\n      }\n    }\n    return undefined;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public removeEdge(e: any) {\n    // this.edges.splice(this.edges.indexOf(e), 1);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    this.edges.splice(this.edges.indexOf(e as any), 1);\n  }\n  public removeAPolylineEdge(e: APolylineEdge) {\n    this.aEdges.splice(this.aEdges.indexOf(e), 1);\n  }\n  public activateEasing(e: MouseEventData, ac: ActiveCommandController) {\n    this.scene.capture = undefined;\n    this.tVec = new NVector3(e.x, e.y, 0);\n    this.isAniEasing = true;\n  }\n  public makeUnique() {\n    for (const ee of this.edges) {\n      const e: ALineBase = ee as ALineBase;\n      if (e.p0.id === this.id) {\n        e.p0.vec = new NVector3(this.vec.x, this.vec.y, this.vec.z);\n      }\n      if (e.p1.id === this.id) {\n        e.p1.vec = new NVector3(this.vec.x, this.vec.y, this.vec.z);\n      }\n    }\n  }\n  public easing() {\n    if (this.isAniEasing) {\n      this.vec = plus(scale(this.vec, 0.95), scale(this.tVec, 0.05));\n      if (getDistance(this.vec, this.tVec) < 1) {\n        this.isAniEasing = false;\n      }\n    }\n    // this.UpdateGoeVec();\n  }\n  public accelerating() {\n    this.vec = plus(\n      scale(this.vec, 0.9),\n      scale(this.tVec, 0.1) // (1 / dis) * 0.00000001)\n    );\n    if (getDistance(this.vec, this.tVec) < 1.5) {\n      this.isRenderable = false;\n      this.isAniEasing = false;\n    }\n    this.renderer.t += 0.01;\n  }\n  // set isHOver(b: boolean) {\n  //     console.log(b);\n  //     if(this.isHoverPre && !b) {\n  //         this.isHover = b;\n  //     } else {\n  //         console.log('0.0');\n  //         // this.renderer.tOver = 0.0;\n  //         this.isHover = b;\n  //     }\n  //     this.isHoverPre = this.isHover;\n  // }\n  public move(x: number, y: number) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    this.vec.x = x;\n    this.vec.y = y;\n    // this.UpdateGoeVec();\n  }\n  public add_AEdge(e: APolylineEdge) {\n    this.aEdges.push(e);\n    if (this.aEdges[0]) {\n      this.styleComponent.updateStyleForNode(this.aEdges[0].pGraph.styleComponent.renderStyleNode);\n      // console.log(this.styleComponent.renderStyle);\n    }\n    this.isConnected = true;\n  }\n  // ................................... implementation\n  public get v(): NVector3 {\n    return this.vec;\n  }\n  public set v(v: NVector3) {\n    this.vec = v;\n  }\n  public get isHover() {\n    return this.isHoverValue;\n  }\n  public set isHover(v: boolean) {\n    if (this.edges[0] && this.edges[0].type === GType.POLYLINE_BENDING) {\n      if (\n        this.isMouseInside(\n          this.scene.annotationInstance.activeCommandController.m.x,\n          this.scene.annotationInstance.activeCommandController.m.y\n        )\n      ) {\n        if (this.renderer.tOver > 0.9) {\n          this.renderer.tOver = 0.0;\n        }\n      }\n    }\n    this.isHoverValue = v;\n    // if (!v) { this.isSelectedSole = false; }\n  }\n  public get isSelected() {\n    return this.isSelectedValue;\n  }\n  public set isSelected(v: boolean) {\n    // this.vecsHistory.push(DeepCopy(this.vec));\n    this.isSelectedValue = v;\n    if (!v) {\n      this.isSelectedSole = v;\n    }\n  }\n  public get isSelectedSole() {\n    return this._isSelectedSole;\n  }\n  public set isSelectedSole(v: boolean) {\n    this._isSelectedSole = v;\n    this.styleComponent.shiftNodeStyle(v);\n    // console.log(this);\n    // if (!v) { this.isSelectedSole = v; }\n  }\n  // ............................... popup\n  public showPopupSummary() {\n    if (this.edges[0]) {\n      this.edges[0].showPopupSummary();\n    }\n  }\n  public hidePopUpSummary() {\n    if (this.edges[0]) {\n      this.edges[0].hidePopUpSummary();\n    }\n  }\n  // ............................... end popup\n  public isMouseInside(x: number, y: number) {\n    if (!this.edges[0]) { return false; }\n    // if (this.isRemove || !this.isRenderable || this.isHidden) {\n    //   return false;\n    // }\n    if (this.distance(x, y) <= this.r + 9 * this.scene.annotationInstance.activeCommandController.scaleGlobal) {\n      if (this.edges[0].type === GType.CIRCLE || this.edges[0].type === GType.RECTANGLE) {\n        this.scene.capturePT = this;\n      }\n      return true;\n    }\n    return false;\n    // return this.scene.imageAnnoApp.geometryCommon.IsMouseInsideByOffScreen(x, y, this.hashColor); //\n  }\n  public mergeTwoEdge() {\n    if (this.aEdges.length > 1) {\n      let otherAA;\n      let otherBB;\n      if (this.aEdges[0].p0 === this) {\n        otherAA = this.aEdges[0].p1;\n        this.aEdges[0].pm.deepRemove();\n      } else {\n        otherAA = this.aEdges[0].p0;\n        this.aEdges[0].pm.deepRemove();\n      }\n      if (this.aEdges[1].p0 === this) {\n        otherBB = this.aEdges[1].p1;\n        this.aEdges[1].pm.deepRemove();\n      } else {\n        otherBB = this.aEdges[1].p0;\n        this.aEdges[1].pm.deepRemove();\n      }\n\n      if (otherAA && otherBB) {\n        otherAA.removeAPolylineEdge(this.aEdges[0]);\n        otherBB.removeAPolylineEdge(this.aEdges[1]);\n\n        const ne = this.aEdges[0].pGraph.addEdge(otherAA, otherBB);\n        this.aEdges[0].pGraph.edges.push(ne);\n\n        ne.pGraph.removeEdge(this.aEdges[0]);\n        ne.pGraph.removeEdge(this.aEdges[1]);\n        ne.pGraph.checkMinPt();\n        // let iGeo = ne.pGraph.ToJSON();\n        // if (iGeo) {\n        //     APolylineGraph.FromJSON(iGeo, true, true);\n        //     ne.pGraph.Remove();\n        // }\n\n        ne.pGraph.computeCenterVec(); // to prevent from an additional emit after adding a new node\n        ne.pGraph.initVecsHistory(); // to prevent from an additional emit after adding a new node\n      }\n    } else {\n      this.aEdges[0].pm.remove();\n      this.aEdges[0].pGraph.removeEdge(this.aEdges[0]);\n\n      // let iGeo = this.aEdges[0].pGraph.ToJSON();\n      // if (iGeo) {\n      //     APolylineGraph.FromJSON(iGeo, true, true);\n      //     this.aEdges[0].pGraph.Remove();\n      // }\n    }\n  }\n  public remove() {\n    if (this.isRemove) {\n      return;\n    }\n    // console.log(this.type);\n    if (this.popup) {\n      this.hidePopUpSummary();\n    }\n\n    // ...... check for Polyline bending object\n    if (this.aEdges[0]) {\n      if (this.type === GType.ANODE && this.aEdges.length > 0 && !this.isRemove) {\n        // bending polyline removing a vertex\n        // for removing Bending polyline\n        // this.MergeTwoEdge();\n        // this.isRemove = true;\n        if (this.scene.annotationInstance.activeCommandController.acProperties.pressKey) {\n          // we only need remove nodes of polyline by delete keyboard, NOT Block hole\n          if (this.aEdges[0].pGraph) {\n            if (this.aEdges[0].pGraph.getVecs().length === 3) {\n              // in this moment the polyline itself could not exist. Thus, we need remove all remain nodes\n              if (this.aEdges[0].p0 !== this) {\n                this.aEdges[0].p0.deepRemove();\n              }\n              if (this.aEdges[0].p1 !== this) {\n                this.aEdges[0].p1.deepRemove();\n              }\n              this.deepRemove();\n              this.aEdges[0].pGraph.remove(true);\n              this.aEdges[0].pGraph.deepRemove();\n            } else {\n              this.aEdges[0].pGraph.remove(false);\n              const ioGeo = this.aEdges[0].pGraph.toJSON();\n              if (ioGeo) {\n                this.scene.annotationInstance.io.eventListenerAnnotation.transformStack([ioGeo]);\n              }\n            }\n          }\n        }\n        return;\n      }\n      if (this.type === GType.AMIDPOINT && this.aEdges.length > 0 && !this.isRemove) {\n        // for removing Bending polyline from point mid\n        // this.MergeTwoEdge();\n        if (this.scene.annotationInstance.activeCommandController.acProperties.pressKey) {\n          // we only need remove nodes of polyline by delete keyboard, NOT Block hole\n          this.isRemove = true;\n          if (this.aEdges[0].pGraph) {\n            this.aEdges[0].pGraph.remove();\n            const ioGeo = this.aEdges[0].pGraph.toJSON();\n            if (ioGeo) {\n              this.scene.annotationInstance.io.eventListenerAnnotation.transformStack([ioGeo]);\n            }\n          }\n        }\n        return;\n      }\n    }\n    // ...... end check for Polyline bending object\n\n    // ...... check for arrow and other shapes in this.edges array\n    if (this.edges[0]) {\n      if (\n        this.type === GType.ANODE &&\n        this.edges.length > 0 &&\n        !this.isRemove &&\n        !this.edges[0].isUnderConstruction\n      ) {\n        // for removing polygon\n        // this.MergeTwoEdge();\n        // console.trace();\n        // console.log(this.edges[0].isUnderConstruction);\n        // console.log('del all');\n        this.isRemove = true;\n        this.edges[0].remove();\n        const ioGeo = this.edges[0].toJSON();\n        if (ioGeo) {\n          this.scene.annotationInstance.io.eventListenerAnnotation.transformStack([ioGeo]);\n        }\n        return;\n      }\n      // console.log(this);\n      if ((this.type === GType.ANODE || this.type === GType.AMIDPOINT) && this.edges.length > 0) {\n        // for removing arrow\n        // console.log(this);\n        if (\n          this.edges[0].type === GType.ARROW_SINGLE ||\n          this.edges[0].type === GType.ARROW_DOUBLE\n        ) {\n          this.isRemove = true;\n          // console.trace();\n          if (this.edges[0]) {\n            this.edges[0].remove();\n\n            const ioGeo = this.edges[0].toJSON();\n            if (ioGeo) {\n              this.scene.annotationInstance.io.eventListenerAnnotation.transformStack([ioGeo]);\n            }\n          }\n          return;\n        }\n      }\n    }\n    // ...... end check for arrow and other shapes in this.edges array\n    this.deepRemove();\n  }\n  public deepRemove() {\n    if (this.isRemove) {\n      return;\n    }\n    if (this.textLeaderline) {\n      this.textLeaderline.removeByAttachedShape();\n      this.textLeaderline = undefined;\n    }\n\n    this.isSelectable = false;\n    this.isRenderable = false;\n    this.isRemove = true;\n    this.scene.removeBasePoint(this);\n    this.scene.removeAPoint(this);\n    this.scene.removeGeometry(this as AGeometryBase);\n  }\n  // IsMove() {\n  //   if (this.vecsHistory[this.vecsHistory.length - 1].Distance(this.vec) > 2) return true;\n  //   return false;\n  // }\n  public goToBlackhole() {\n    this.isSelectable = false;\n    this.tVec = this.scene.annotationInstance.renderer.blackhole.v as NVector3;\n    this.isAniAccel = true;\n  }\n  public hide() {\n    // if (this.hasSound) { this.sound.PlayBlackhole(); }\n    this.isSelectable = false;\n    this.isRenderable = false;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    // ........... safeguard: for the node of rect and circle, return;\n    if (this.type === GType.ANODE_RECT) {\n      return;\n    }\n    if (this.type === GType.ANODE_CIRCLE) {\n      return;\n    }\n    // ........... end safeguard\n\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n\n    // console.log(this.textLeaderline)\n    // if (this.textLeaderline) {\n    if (this.textLeaderline) {\n      this.textLeaderline.translateByMouseEventData(e);\n      // if (this.wrapping.needWrappingToLeft || this.wrapping.needWrappingToRight) {\n      // this.textLeaderline.leaderline.v2.x = this.vec.x;\n      // this.textLeaderline.leaderline.v2.y = this.vec.y;\n\n      // this.textLeaderline.leaderline.v2.x += xo;\n      // this.textLeaderline.leaderline.v2.y += yo;\n      // let v = this.scene.imageAnnoApp.geometryCommon.gcmdSupporting.ToMap(this.textLeaderline.leaderline.v2.x, this.textLeaderline.leaderline.v2.y);\n      // this.textLeaderline.leaderline.v2.long = v[0];\n      // this.textLeaderline.leaderline.v2.lat = v[1];\n      // this.textLeaderline.leaderline.v2.sx = v[2];\n      // this.textLeaderline.leaderline.v2.sy = v[3];\n      // }\n    }\n    // }\n\n    // console.log('1');\n\n    if (this.aEdges.length > 0) {\n      this.translateForCurvedPolyline(e);\n      return;\n    } // this is node!! not a mid point\n    // console.log('1-1');\n    // if (this.type === GTYPE.ANODE_TEXT) { this.TranslateForText(e); return; }\n    if (this.type === GType.AMIDPOINT_ALINE) {\n      this.translateForLineMidPoint(e);\n      return;\n    }\n\n    // console.log('2');\n    if (this.scene.annotationInstance.activeCommandController.acProperties.pressCtrlKey) {\n      this.splitPointbyNewVec(e.x, e.y);\n    } else {\n      // this.vec.x += e.x - e.preX;\n      // this.vec.y += e.y - e.preY;\n      this.vec.x = e.x;\n      this.vec.y = e.y;\n      this.isDrag = true;\n      // this.UpdateGoeVec();\n    }\n\n    if (this.type === GType.ANODE && this.edges[0] && this.edges[0].type === GType.POLYGON) {\n      // const polygon = this.edges[0] as APolygonWrapper;\n      // polygon.wrapping.UpdateProjection(polygon.vecs);\n      return;\n    }\n    // console.log('3');\n    if (this.edges[0].type === GType.ARROW_SINGLE || this.edges[0].type === GType.ARROW_DOUBLE) {\n      // const arrow = this.edges[0] as AArrow;\n      // arrow.wrapping.UpdateProjection(arrow.vecs);\n      return;\n    }\n    // console.log('4');\n    if (this.edges[0].type === GType.CURVE_OPEN || this.edges[0].type === GType.CURVE_CLOSE) {\n      // const curve = this.edges[0] as ACurve;\n      // curve.wrapping.UpdateProjection(curve.vecs);\n      return;\n    }\n    // console.log('5');\n    if (this.edges[0].type === GType.ALINE) {\n      // let ln = this.edges[0] as ALine;\n      // // ln.wrapping.UpdateProjection(ln.vecs);\n      // // ALine.UpdateGraph(); // for graph update\n      // ALine.updatePathFinding();\n      return;\n    }\n  }\n  public translate(x: number, y: number) {\n    //\n  }\n  public splitPointbyNewVec(x: number, y: number) {\n    const pts = this.scene.listAPoint;\n    for (let i = 0; i < pts.length; ++i) {\n      if (getDistance(pts[i].vec, this.vec) < 5) {\n        this.vec = new NVector3(x, y);\n        // this.UpdateGoeVec();\n        this.scene.Capture = pts[i] as AGeometryBase;\n        this.scene.annotationInstance.activeCommandController.acProperties.pressCtrlKey = false;\n      }\n    }\n  }\n  public mouseLeftClick() {\n    // ....... Safeguard: mouse click on a node of rect and circle\n    // if (this.edges.length > 0 && (this.edges[0].type === GType.CIRCLE || this.edges[0].type === GType.RECTANGLE)) {\n    //   this.edges[0].IsSelected = true;\n    //   return;\n    // }\n    // ....... end Safeguard: mouse click on a node of rect and circle\n\n    // console.log('sel pt');\n    // this.isSelected = !this.isSelected;\n    // this.isSelectedSole = !this.isSelectedSole;\n    // if (this.isSelectedSole) {\n    //   if (this.aEdges.length > 0) {\n    //     this.aEdges[0].pGraph.IsSelected  = true;\n    //   }\n    //   if (this.edges.length > 0) {\n    //     this.edges[0].IsSelected  = true;\n    //   }\n    // }\n\n    if (this.aEdges.length > 0) {\n      if (!this.scene.annotationInstance.activeCommandController.acProperties.pressShift) {\n        const pl = this.aEdges[0] as APolylineEdge;\n        for (let i = 0; i < pl.pGraph.edges.length; ++i) {\n          if (pl.pGraph.edges[i].p0 !== this && pl.pGraph.edges[i].p0.isSelectedSole) {\n            pl.pGraph.edges[i].p0.isSelectedSole = false;\n          }\n          if (pl.pGraph.edges[i].p1 !== this && pl.pGraph.edges[i].p1.isSelectedSole) {\n            pl.pGraph.edges[i].p1.isSelectedSole = false;\n          }\n          if (pl.pGraph.edges[i].pm !== this && pl.pGraph.edges[i].pm.isSelectedSole) {\n            pl.pGraph.edges[i].pm.isSelectedSole = false;\n          }\n        }\n      }\n      this.isSelectedSole = !this.isSelectedSole;\n      this.aEdges[0].pGraph.isSelected = true;\n      return;\n    }\n\n    if (this.edges.length > 0) {\n      // ........... safeguard: interact with popup when you click the mid node of arrow\n      if (this.edges[0].type === GType.ARROW_SINGLE || this.edges[0].type === GType.ARROW_DOUBLE) {\n        this.isSelected = false;\n        this.edges[0].isSelected = !this.edges[0].isSelected;\n        return;\n      }\n      // ........... end safeguard\n\n      if (!this.scene.annotationInstance.activeCommandController.acProperties.pressShift) {\n        const pl = this.edges[0] as APolygonWrapper;\n        for (let i = 0; i < pl.pts.length; ++i) {\n          if (pl.pts[i] !== this && pl.pts[i].isSelectedSole) {\n            pl.pts[i].isSelectedSole = false;\n          }\n        }\n      }\n      this.isSelectedSole = !this.isSelectedSole;\n      this.edges[0].isSelected = true;\n      return;\n    }\n  }\n  // public TranslateForText(e: MouseEventData) {\n  //   if (this.isRemove || !this.isRenderable || this.isHidden) { return; }\n  //   let xOff = e.x - e.preX;\n  //   this.vec.x += xOff;\n  //   let t = this.edges[0] as AText;\n  //   let dis = t.p1.vec.x - t.p0.vec.x;\n\n  //   if (dis < 50) {\n  //     this.vec.x -= xOff;\n  //     t.WidthTextArea = 50;\n  //   } else if (dis > 700) {\n  //     this.vec.x += xOff;\n  //     t.WidthTextArea = 700;\n  //   } else {\n  //     t.WidthTextArea = t.p1.vec.x - t.p0.vec.x;\n  //   }\n  //   this.UpdateGoeVec();\n  //   // t.wrapping.UpdateProjection(t.vecs);\n  // }\n  public translateForLineMidPoint(e: MouseEventData) {\n    // console.log(this);\n    // const ee = this.edges[0] as ALine;\n    // const np = ee.splitLineByVec(new NVector3(e.x, e.y), true);\n    // this.scene.Capture = np as AGeometryBase;\n    // const pts = this.scene.listAPoint;\n    // for (let i = 0; i < pts.length - 1; ++i) {\n    //   for (let j = i + 1; j < pts.length; ++j) {\n    //     if (getDistance(pts[i].vec, pts[j].vec) < 5) {\n    //       pts[i].vec = pts[j].vec;\n    //     }\n    //   }\n    // }\n    // ALine.UpdateGraph(); // for graph update\n  }\n  public splitMidPointbyNewVec(x: number, y: number) {\n    // const ee = this.edges[0] as ALine;\n    // const np = ee.splitLineByVec(new NVector3(x, y), true);\n    // return np;\n  }\n  public translateForCurvedPolyline(e: MouseEventData) {\n    this.vec.x += e.x - e.preX;\n    this.vec.y += e.y - e.preY;\n    this.isDrag = true;\n\n    // console.log(this.id);\n    if (this.type === GType.AMIDPOINT) {\n      if (this.scene.annotationInstance.activeCommandController.acProperties.pressCtrlKey) {\n        this.aEdges[0].checkIsCurved();\n      } else {\n        const np = this.aEdges[0].splitEdge(this); // it locks the splitedge.\n        if (np) {\n          np.isSelected = false;\n          this.scene.Capture = np as AGeometryBase;\n        }\n      }\n    } else {\n      for (let i = 0; i < this.aEdges.length; ++i) {\n        this.aEdges[i].moveMidPt(e);\n      }\n    }\n    // if (this.aEdges.length > 0) { this.aEdges[0].CheckIsCurved(); console.log(this.aEdges.length); }\n    // this.UpdateGoeVec();\n    // c.wrapping.UpdateProjection(c.vecs);\n  }\n  public deepCopy(\n    x: number = this.vec.x,\n    y: number = this.vec.y,\n    z: number = this.vec.z\n  ): AGeometryBase | undefined {\n    if (this.type === GType.AMIDPOINT || this.type === GType.ANODE) {\n      return undefined;\n    }\n    const p = new APoint(this.scene, x, y, this.vec.z, false, this.type, this.r) as AGeometryBase;\n    if (p) {\n      return p as AGeometryBase;\n    }\n    return undefined;\n  }\n  public mouseRightClick(e: MouseEventData) {\n    // // this.isPin = !this.isPin;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.inspector.update(ctx);\n    this.renderer.renderPost(ctx);\n  }\n  public mouseUp() {\n    /* */\n  }\n  public textLeaderlinePost(t: ATextleaderlineWrapper) {\n    if (this.type === GType.ANODE_CIRCLE || this.type === GType.ANODE_RECT) {\n      if (this.edges[0].type === GType.CIRCLE || this.edges[0].type === GType.RECTANGLE) {\n        this.edges[0].textLeaderline = t;\n        return true;\n      }\n    }\n    return false;\n  }\n}\n","import { NVector3, GType, InteractionMode } from '../../../../../../../lib';\nimport { RendererComponent as _RendererComponent } from '../../../../Common/Base/ComponentTemplate/RendererComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { APolylineWrapper } from '../APolylineWrapper';\nexport class RendererComponent extends _RendererComponent {\n  public host: APolylineWrapper;\n  public renderStyle: RenderStyle;\n  public renderStyleNode: RenderStyle;\n  constructor(host: APolylineWrapper) {\n    super(host);\n    this.host = host;\n    this.initRenderTheme();\n  }\n  public initRenderTheme() {\n    // RenderStyle.UpdateRenderStyle(this.host.renderStyle, this.host.type, this.host.scene.annotationInstance.themeRenderStyle.themeCurrent);\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    // console.log('p', this.host.styleComponent.renderStyle);\n    if ((this.host.isConstraint && this.host.isHoverValue) || this.host.isSelected) {\n      ctx.textAlign = 'center';\n      ctx.fillStyle = '#000000';\n      ctx.fillText(\n        `Total constraint length: ${this.host.constraintTargetDistance} Mile`,\n        this.host.vecs[0].x,\n        this.host.vecs[0].y - 10\n      );\n    }\n    if (this.host.scene.annotationInstance.activeCommandController.acProperties.showUnit) {\n      if (!this.host.isConstraint) {\n        if (this.host.type === GType.POLYGON) {\n          if (this.host.isHoverValue || this.host.isUnderConstruction) {\n            this.host.dimension.renderLength(ctx, true, this.host.vecs);\n            this.host.dimension.renderTotalArea(ctx, this.host.vecs);\n          }\n        } else {\n          if (this.host.isHoverValue || this.host.isUnderConstruction) {\n            this.host.dimension.renderLength(ctx, false, this.host.vecs);\n            this.host.dimension.renderTotalLength(ctx, this.host.vecs);\n          }\n        }\n      }\n    }\n\n    // console.log(this.isFill);\n    // console.log(this.host.isConstraint);\n    // this.host.isConstraint = true;\n\n    if (this.host.isConstraint) {\n      this.renderPostGeometryConstraint(ctx);\n    } else {\n      this.renderPostGeometry(ctx);\n    }\n    this.offscreenRender();\n\n    // if (this.hasPopup && this.IsMove) { this.UpdateDivPos(); }\n    this.host.renderer.t += this.host.scene.annotationInstance.renderer.dt;\n  }\n  private renderPostGeometryConstraint(ctx: CanvasRenderingContext2D) {\n    if (this.host.type === GType.POLYLINE) {\n      if (this.host.isHoverValue || this.host.isSelectedValue || this.host.isUnderConstruction) {\n        ctx.lineDashOffset = -this.host.renderer.t;\n        ctx.setLineDash([4, 4]);\n        ctx.strokeStyle = this.host.styleComponent.renderStyle.colorStroke;\n        ctx.lineWidth = 1;\n        ctx.beginPath();\n        ctx.moveTo(this.host.vecs[0].x, this.host.vecs[0].y);\n        for (let i = 1; i < this.host.vecs.length; ++i) {\n          ctx.lineTo(this.host.vecs[i].x, this.host.vecs[i].y);\n        }\n        ctx.stroke();\n        ctx.setLineDash([0, 0]);\n        // console.log(this.host.t);\n      }\n      if (this.host.isConstraint) {\n        if (this.host.renderConstraintTargetDistance) {\n          // this.host.constraintDrawing.renderByConstraintTargetDistance(ctx, this.host.vecs, false, this.host.constraintTargetDistance);\n        }\n        if (this.host.renderConstraintTargetDistancePercentage) {\n          // this.host.constraintDrawing.renderByConstraintTargetDistancePercentage(ctx, this.host.vecs, false, this.host.constraintTargetDistancePercentage);\n        }\n      }\n      if (this.host.isHoverValue || this.host.isUnderConstruction) {\n        // this.host.dimension.renderRemainLengthByValue(ctx, this.host.constraintDrawing.target, this.host.constraintDrawing.remain);\n      }\n    } else if (this.host.type === GType.POLYGON) {\n      if (this.host.isConstraint) {\n        // this.host.constraintDrawingArea.render(ctx, this.host.vecs, false, this.host.constraintTargetArea);\n      }\n    }\n  }\n  // .................................................................................... wrapping\n  private renderPostGeometry(ctx: CanvasRenderingContext2D) {\n    if (this.host.type === GType.POLYLINE) {\n      if (this.host.isUnderConstruction) {\n        this.renderPolyline(ctx);\n        if (\n          this.host.scene.annotationInstance.implementations.app.model.appCoreWrapper\n            .appControllerStatus.mode === InteractionMode.Drawing\n        ) {\n          this.renderMidVec(ctx);\n        }\n      } else {\n        if (this.host.isCurvedPolyline) {\n          // if (!this.aPolylineGraph) {\n          //     let thePts: APoint[] = [];\n          //     this.mPts = [];\n          //     if (this.vecMid) {\n          //         for (let i = 0; i < this.vecMid.length - 2; ++i) {\n          //             let nP = new APoint(this.vecMid[i].x, this.vecMid[i].y, this.vecMid[i].z);\n          //             nP.t = 5;\n          //             this.mPts.push(nP);\n          //             thePts.push(this.pts[i], nP);\n          //         }\n          //     }\n          //     thePts.push(this.pts[this.pts.length - 1]);\n          //     // this.aPolylineGraph = new APolylineGraph(thePts);\n          // } else {\n          //     this.aPolylineGraph.RenderPost(ctx);\n          //     return;\n          // }\n        } else {\n          this.renderPolyline(ctx);\n          if (\n            this.host.scene.annotationInstance.implementations.app.model.appCoreWrapper\n              .appControllerStatus.mode === InteractionMode.Drawing\n          ) {\n            this.renderMidVec(ctx);\n          }\n        }\n      }\n    } else {\n      this.renderPolygon(ctx, this.host.getVecs());\n    }\n  }\n  private renderPolyline(ctx: CanvasRenderingContext2D) {\n    // console.log('ddd');\n    if (this.host.isHoverValue || this.host.isSelectedValue) {\n      this.host.scene.annotationInstance.renderer.draw.shape.line.polylineHover(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        this.host.getVecs(),\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n        this.host.isHoverValue\n      );\n      this.tOver += 0.015;\n      this.tDown1 = 0;\n      this.host.isLeave = true;\n      this.host.scene.annotationInstance.renderer.draw.shape.line.polyline(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        this.host.getVecs(),\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.host.isHoverValue,\n        this.host.isSelectedValue\n      );\n    } else {\n      this.tOver = 0;\n      this.host.scene.annotationInstance.renderer.draw.shape.line.polyline(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        this.host.getVecs(),\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.host.isHoverValue,\n        this.host.isSelectedValue\n      );\n    }\n  }\n  private renderPolygon(ctx: CanvasRenderingContext2D, ves: NVector3[]) {\n    this.offscreenRender();\n    if (this.host.isHoverValue || this.host.isSelectedValue) {\n      this.host.scene.annotationInstance.renderer.draw.shape.area.polygonHover(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        ves,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n        this.host.isHoverValue,\n        this.host.isSelectedValue\n      );\n      this.tOver += 0.01;\n      this.tDown1 = 0;\n      this.host.isLeave = true;\n      this.host.scene.annotationInstance.renderer.draw.shape.area.polygon(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        ves,\n        this.host.isUnderConstruction,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.host.isFill,\n        this.host.isHover,\n        this.host.isSelectedValue\n      );\n    } else {\n      this.tOver = 0;\n      this.host.scene.annotationInstance.renderer.draw.shape.area.polygon(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        ves,\n        this.host.isUnderConstruction,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.host.isFill,\n        this.host.isHover,\n        this.host.isSelectedValue\n      );\n    }\n  }\n  private renderMidVec(ctx: CanvasRenderingContext2D) {\n    if (this.host.isHoverValue || this.host.isSelectedValue || this.host.isUnderConstruction) {\n      this.host.updateMidVec();\n      let l = this.host.vecMid.length;\n      while (l--) {\n        this.host.scene.annotationInstance.renderer.draw.shape.node.nodeMidHover(\n          ctx,\n          this.host.styleComponent.renderStyleNode,\n          this.host.vecMid[l].x,\n          this.host.vecMid[l].y,\n          this.host.scaleForRender,\n          this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver)\n        );\n      }\n    }\n  }\n  private offscreenRender() {\n    if (this.host.type === GType.POLYGON) {\n      this.offscreenRenderPolygon();\n    }\n  }\n  private offscreenRenderPolygon() {\n    this.host.scene.annotationInstance.renderer.offscreen.polygonOffScreen(\n      this.host.scene.annotationInstance.renderer.ctxOffscreen,\n      this.host.hashColor,\n      this.host.getVecs()\n    );\n  }\n}\n","import { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { APolylineWrapper } from '../APolylineWrapper';\nexport class StyleComponent extends _StyleComponent {\n  public geo: APolylineWrapper;\n  constructor(geo: APolylineWrapper) {\n    super(geo);\n    this.updateStyle();\n  }\n  public updateStyle() {\n    RenderStyle.updateRenderStylePolyline(\n      this.renderStyle,\n      this.geo.scene.annotationInstance.customization.themeCurrent\n    );\n    RenderStyle.updateRenderStylePolylineNode(\n      this.renderStyleNode,\n      this.geo.scene.annotationInstance.customization.themeCurrent\n    );\n    if (this.geo.pts) {\n      for (let i = 0; i < this.geo.pts.length; ++i) {\n        this.geo.pts[i].styleComponent.updateStyleForNode(this.renderStyleNode);\n      }\n    }\n  }\n}\n","import { IOGeometry } from '../../../../../../lib/Extended/GeometryUtility';\nimport {\n  distanceMouseWithTwoVecs,\n  getCenterVecFromVecs,\n  getDistance,\n  getDistanceByArray,\n  get1KMLatLongGeoUnit,\n  getDivideByNum,\n  getMinMaxVecFromVecs,\n  getGeoArea,\n  midVec,\n  normalize,\n  NVector3,\n  plus,\n  scale,\n  sub,\n  MouseEventData,\n  GType,\n} from '../../../../../../lib';\nimport { Scene } from '../../../../Scene';\nimport { AGeometryBase } from '../../../Common/Base/AGeometryBase';\nimport { APoint } from '../../FamilyPoint/Base/APoint';\nimport { Dimension } from '../../Helper/Dimension';\nimport { RendererComponent } from './Component/RendererComponent';\nimport { StyleComponent } from './Component/StyleComponent';\nexport class APolylineWrapper extends AGeometryBase {\n  public static split = false;\n  public static isDone = false;\n  public static construction: APolylineWrapper | undefined;\n  public isFill: boolean;\n  public isCurvedPolyline: boolean;\n\n  public vec: NVector3;\n  public vecs: NVector3[];\n  public vecMid: NVector3[];\n  public relatedVecs: NVector3[];\n\n  public pts: APoint[];\n  public mPts: APoint[];\n  public isClosed: boolean;\n  public lineWidth: number;\n\n  public dimension: Dimension;\n  // public constraintDrawing: ConstraintDrawing;\n  // public constraintDrawingArea: ConstraintDrawingArea;\n  public isConstraint: boolean;\n  public constraintTargetArea = 340; // km\n\n  // ........................... for wrapping\n  // vecOthers: NVector3[];\n\n  // .........custom\n  public vecSelected = -1;\n  public vecsBound: NVector3[];\n\n  public isPan = false;\n\n  public renderConstraintTargetDistancePercentage = false;\n  public renderConstraintTargetDistance = false;\n  private _constraintTargetDistancePercentage = 0.5;\n  private _constraintTargetDistance = 340; // km\n  // needWrapCompute: boolean = true;\n  // needWrappingDuplicate: boolean = false;\n  // needWrapping: boolean = false;\n\n  public static findAtPoint(scene: Scene, e: MouseEventData) {\n    for (let i = scene.listAPolylineWrapper.length - 1; i >= 0; --i) {\n      if (\n        scene.listAPolylineWrapper[i].isSelectable &&\n        scene.listAPolylineWrapper[i].isMouseInside(e.x, e.y)\n      ) {\n        return scene.listAPolylineWrapper[i];\n      }\n    }\n    return undefined;\n  }\n  public static getLengthSelection(scene: Scene) {\n    let i = scene.listAPolylineWrapper.length;\n    let count = 0;\n    while (i--) {\n      if (scene.listAPolylineWrapper[i].isSelected) {\n        count += 1;\n      }\n    }\n    return count;\n  }\n  public static computeOver(scene: Scene, e: MouseEventData) {\n    const cl = APolylineWrapper.findAtPoint(scene, e);\n    if (cl !== undefined) {\n      cl.isHoverValue = true;\n    }\n  }\n  // ............................................................... construction\n  public static fromJSON(scene: Scene, g: IOGeometry, isUndo = false, isDeepCopy = false) {\n    let isConstraint = false;\n    // eslint:disable-next-line:no-string-literal\n    if (g.data['isConstraint']) {\n      isConstraint = true;\n    } else {\n      isConstraint = false;\n    }\n\n    const geo = new APolylineWrapper(\n      scene,\n      APoint.getNodeFromJSON(scene, g.nodes[0], isUndo),\n      isUndo,\n      isConstraint\n    );\n\n    // eslint:disable-next-line:no-string-literal\n    if (isConstraint) {\n      geo.constraintTargetDistance = +g.data['constraintTargetDistance'];\n    }\n\n    if (isUndo) {\n      geo.isUndo = isUndo;\n      for (let i = 1; i < g.nodes.length; ++i) {\n        geo.addPT(APoint.getNodeFromJSON(scene, g.nodes[i], isUndo));\n      }\n    } else {\n      for (let i = 1; i < g.nodes.length; ++i) {\n        geo.addPT(APoint.getNodeFromJSON(scene, g.nodes[i]));\n      }\n    }\n    geo.type = GType[g.type];\n    // geo.style = g.style;\n    if (isDeepCopy) {\n      geo.id = scene.getUUID();\n    } else {\n      geo.id = g.id;\n    }\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n    geo.isHover = false;\n    // geo.AppendDivForShape();\n    geo.isHiddenValue = g.isHidden;\n    if (g.isHidden) {\n      geo.visibilityValue = 0;\n    } else {\n      geo.visibilityValue = 1.0;\n    }\n\n    geo.initVecsHistory();\n    if (!isUndo) {\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n    }\n\n    return geo;\n  }\n  public static getPolylineByVecs(scene: Scene, v: NVector3[]) {\n    const c = new APolylineWrapper(scene, new APoint(scene, v[0].x, v[0].y, 0));\n    for (let i = 1; i < v.length; ++i) {\n      c.addPT(new APoint(scene, v[i].x, v[i].y, 0));\n    }\n    c.computeCenterVec();\n    c.IsSelectable = true;\n    c.isUnderConstruction = false;\n    scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(c.toJSON());\n  }\n  public static drawShadow(e: MouseEventData, consType: GType = GType.ALINE) {\n    if (APolylineWrapper.construction !== undefined) {\n      APolylineWrapper.construction.pts[APolylineWrapper.construction.pts.length - 1].move(\n        e.x,\n        e.y\n      );\n      // APolylineWrapper.construction.ComputeMidPts()\n\n      // APolylineWrapper.construction.ComputeMidPT(APolylineWrapper.construction.pts.length - 2);\n\n      //     let p2 = new APoint(e.x, e.y, 0);\n      //     p2.isSelectable = false;\n      //     if (consType === GType.LINE ) APolylineWrapper.condition = new APolylineWrapper(APolylineWrapper.condition.v0, p2);\n      //     if (APolylineWrapper.condition.geo !== undefined) APolylineWrapper.condition.geo.isSelectable = false;\n      //     // APolylineWrapper.condition.geo.isUnderConstruction = true;\n      // }\n      // else {\n      //     if (APolylineWrapper.condition.geo.pts[1] !== undefined) APolylineWrapper.condition.geo.pts[1].Move(e.x, e.y);\n    }\n  }\n  public static getLine(scene: Scene, e: MouseEventData, isConstraint = false) {\n    if (APolylineWrapper.construction !== undefined) {\n      APolylineWrapper.construction.addPT(new APoint(scene, e.x, e.y));\n    } else {\n      APolylineWrapper.construction = new APolylineWrapper(\n        scene,\n        new APoint(scene, e.x, e.y),\n        false,\n        isConstraint\n      );\n      APolylineWrapper.construction.pts[0].isSelectable = true;\n      APolylineWrapper.construction.addPT(new APoint(scene, e.x, e.y));\n    }\n  }\n  public static getLineByPt(p: APoint) {\n    /* */\n  }\n  public static undo(scene: Scene, e: MouseEventData) {\n    if (!APolylineWrapper.construction) {\n      return;\n    }\n    let i = APolylineWrapper.construction.pts.length - 1;\n    if (i === 1) {\n      APolylineWrapper.cancel(scene);\n      return;\n    }\n    APolylineWrapper.construction.removePT(APolylineWrapper.construction.pts[--i]);\n    APolylineWrapper.construction.pts[i].vec.x = e.x;\n    APolylineWrapper.construction.pts[i].vec.y = e.y;\n  }\n  public static done(scene: Scene) {\n    if (APolylineWrapper.construction !== undefined) {\n      APolylineWrapper.construction.IsSelectable = true;\n      APolylineWrapper.construction.isUnderConstruction = true;\n      APolylineWrapper.construction.removePT(\n        APolylineWrapper.construction.pts[APolylineWrapper.construction.pts.length - 1]\n      );\n      if (\n        getDistance(\n          APolylineWrapper.construction.pts[APolylineWrapper.construction.pts.length - 1].vec,\n          APolylineWrapper.construction.pts[0].vec\n        ) < 3\n      ) {\n        APolylineWrapper.construction.removePT(\n          APolylineWrapper.construction.pts[APolylineWrapper.construction.pts.length - 1]\n        );\n      }\n\n      APolylineWrapper.construction.computeCenterVec();\n\n      APolylineWrapper.construction.removePT(\n        APolylineWrapper.construction.pts[APolylineWrapper.construction.pts.length - 1]\n      );\n      // APolylineWrapper.construction.AppendDivForShape();\n      APolylineWrapper.construction.isUnderConstruction = false;\n\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n        APolylineWrapper.construction.toJSON()\n      );\n\n      // APolylineWrapper.construction.GetVecsFromDivision();\n      // APolylineWrapper.construction.GetVecsFromNumber();\n      APolylineWrapper.construction = undefined;\n      scene.annotationInstance.activeCommandController.goToACMode();\n    }\n    scene.annotationInstance.implementations.app.model.ioWrapper.eventInteraction.isEnableZoomByDoubleClick = true;\n  }\n  public static doneByKeyboard(scene: Scene) {\n    if (APolylineWrapper.construction !== undefined) {\n      APolylineWrapper.construction.IsSelectable = true;\n\n      APolylineWrapper.construction.removePT(\n        APolylineWrapper.construction.pts[APolylineWrapper.construction.pts.length - 1]\n      );\n      APolylineWrapper.construction.isUnderConstruction = false;\n      // APolylineWrapper.construction.AppendDivForShape();\n      APolylineWrapper.construction.computeCenterVec();\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n        APolylineWrapper.construction.toJSON()\n      );\n      APolylineWrapper.construction = undefined;\n      scene.annotationInstance.activeCommandController.goToACMode();\n    }\n  }\n  public static cancel(scene: Scene) {\n    if (APolylineWrapper.construction !== undefined) {\n      APolylineWrapper.construction.needEmit = false;\n      APolylineWrapper.construction.remove();\n      APolylineWrapper.construction = undefined;\n    }\n  }\n  // ................................... end implementation\n\n  // .................................................................... end implementation\n  public static mouseDown(scene: Scene, e: MouseEventData, isConstraint = false) {\n    if (scene.annotationInstance.activeCommandController.acProperties.isSmartSelectionWhenDrawing) {\n      const cGeo = scene.annotationInstance.geometryCommon.gcmdProcessing.findAtPoint(e);\n      if (APolylineWrapper.construction) {\n        APolylineWrapper.getLine(scene, e);\n        if (cGeo) {\n          // && cGeo === APolylineWrapper.construction.pts[0]) {\n          APolylineWrapper.construction.type = GType.POLYGON;\n          APolylineWrapper.construction.isClosed = true;\n          APolylineWrapper.construction.removePT(\n            APolylineWrapper.construction.pts[APolylineWrapper.construction.pts.length - 1]\n          );\n          APolylineWrapper.construction.removePT(\n            APolylineWrapper.construction.pts[APolylineWrapper.construction.pts.length - 1]\n          );\n\n          cGeo.isSelectedValue = false;\n          cGeo.isHoverValue = false;\n          cGeo.isCapturedValue = false;\n          cGeo.isSelectable = false;\n\n          APolylineWrapper.construction.IsSelectable = true;\n          APolylineWrapper.construction.isUnderConstruction = false;\n          APolylineWrapper.construction.computeCenterVec();\n          APolylineWrapper.construction.initVecsHistory();\n          scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n            APolylineWrapper.construction.toJSON()\n          );\n\n          // APolylineWrapper.isDone = true;\n          // if (AGeometryCommon.capture) {\n          //     AGeometryCommon.capture.isCaptured = false;\n          //     AGeometryCommon.capture = undefined;\n          // }\n          APolylineWrapper.construction = undefined;\n        }\n      }\n    } else {\n      APolylineWrapper.getLine(scene, e, isConstraint);\n    }\n  }\n  public static mouseLeftClick(scene: Scene, e: MouseEventData, isConstraint = false) {\n    if (scene.capture !== undefined) {\n      return;\n    }\n    if (APolylineWrapper.construction !== undefined && APolylineWrapper.isDone) {\n      APolylineWrapper.construction.isSelectedValue = false;\n      APolylineWrapper.construction = undefined;\n      APolylineWrapper.isDone = false;\n      return;\n    } else if (APolylineWrapper.construction === undefined) {\n      APolylineWrapper.getLine(scene, e, isConstraint);\n    }\n  }\n  public static mouseMove(e: MouseEventData) {\n    if (APolylineWrapper.construction !== undefined) {\n      APolylineWrapper.drawShadow(e);\n    }\n  }\n  public static mouseDoubleClick(scene: Scene, e: MouseEventData) {\n    if (APolylineWrapper.construction !== undefined) {\n      APolylineWrapper.done(scene);\n    }\n  }\n\n  constructor(scene: Scene, p: APoint, isUndo = false, isConstraint = false) {\n    super(scene);\n    this.isFill = false;\n    this.pts = [];\n    this.isUndo = isUndo;\n    this.isConstraint = isConstraint;\n\n    // this.style = 0;\n    this.lineWidth = 8;\n    this.isUnderConstruction = true;\n    this.vec = new NVector3(p.vec.x, p.vec.y, p.vec.z);\n    // this.vecsHistory.push(DeepCopy(this.vec));\n    this.isMove = true;\n    this.initComponent();\n    this.addPT(p);\n    this.initVecsHistory();\n    this.initPolyline();\n    this.scene.annotationInstance.implementations.app.model.ioWrapper.eventInteraction.isEnableZoomByDoubleClick = false;\n  }\n  private initComponent() {\n    this.styleComponent = new StyleComponent(this);\n    this.renderer = new RendererComponent(this);\n  }\n  public initPolyline() {\n    // if (this.isConstraint) {\n    // this.constraintDrawing = new ConstraintDrawing(this, this.vecs);\n    // this.constraintDrawingArea = new ConstraintDrawingArea(this, this.vecs);\n    // this.dimension = new Dimension(this);\n    // }\n    this.isCurvedPolyline = false;\n    this.type = GType.POLYLINE;\n    this.scene.addAPolylineWrapper(this);\n  }\n  public updateScreenVec() {\n    /**/\n  }\n  public updatePan() {\n    /**/\n  }\n  public updateZoom() {\n    /**/\n  }\n  public getLog(): string {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return '';\n    }\n    let text = '';\n    if (this.type === GType.POLYGON) {\n      text +=\n        'GUID : ' +\n        this.id +\n        '/' +\n        'TYPE : ' +\n        this.type.toString() +\n        '/' +\n        // 'PARENT : ' + this.edges[0].GetParentType()+'<br>'+\n        // 'Geo : ' + 'lat:' + this.geoVec.x.toFixed(5).toString() + ', Log:' + this.geoVec.y.toFixed(5).toString() + '/' +\n        'Screen : ' +\n        // this.vec.ToString() +\n        '/' +\n        'pos : ' +\n        this.pts.length +\n        '/' +\n        'Area : ' +\n        this.getArea().toFixed(3).toString() +\n        ' m2' +\n        '/' +\n        // 'STYLE : ' + this.style.toString() + '/' +\n        // 'CONNE :' + this.edges.length.toString() + '/' +\n        'IsSEL : ' +\n        this.isSelectedValue +\n        '/' +\n        'isSelable : ' +\n        this.isSelectable;\n      return text;\n    }\n    if (this.type === GType.POLYLINE) {\n      text +=\n        'GUID : ' +\n        this.id +\n        '/' +\n        'TYPE : ' +\n        this.type.toString() +\n        '/' +\n        // 'PARENT : ' + this.edges[0].GetParentType()+'<br>'+\n        // 'Geo : ' + 'lat:' + this.geoVec.x.toFixed(5).toString() + ', Log:' + this.geoVec.y.toFixed(5).toString() + '/' +\n        'Screen : ' +\n        // this.vec.ToString() +\n        '/' +\n        'pos : ' +\n        this.pts.length +\n        '/' +\n        'length : ' +\n        this.getArea().toFixed(3).toString() +\n        ' m2' +\n        '/' +\n        // 'STYLE : ' + this.style.toString() + '/' +\n        // 'CONNE :' x+ this.edges.length.toString() + '/' +\n        'IsSEL : ' +\n        this.isSelectedValue +\n        '/' +\n        'isSelable : ' +\n        this.isSelectable;\n      return text;\n    }\n    return text;\n  }\n  public getLogDOM() {\n    const text =\n      'Geometry ID : ' +\n      this.id +\n      '<br>' +\n      'geometry Type : CCircle' +\n      '<br>' +\n      // 'parent : ' + this.parent.GetParentType() + '<br>' +\n      'position : ' +\n      // this.vec.ToString() +\n      '<br>' +\n      'size : ' +\n      this.r +\n      ' pixel<br>';\n    // 'color :' + this.style.fillStyle + '<br>';\n    return text;\n  }\n  public isColse() {\n    /* */\n  }\n  public isMouseInside(x: number, y: number): boolean {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return false;\n    }\n    if (this.isUnderConstruction === true || this.isUnderConstruction === undefined) {\n      return false;\n    }\n    if (this.checkDistance(x, y)) {\n      this.isHover = true;\n      return true;\n    }\n    this.isHover = false;\n    return false;\n  }\n  public checkDistance(x: number, y: number) {\n    // if (this.type !== GType.POLYLINE) {\n    const len = this.pts.length;\n    for (let i = 0; i < len; ++i) {\n      if (i < len - 1) {\n        if (\n          distanceMouseWithTwoVecs(new NVector3(x, y), this.pts[i].vec, this.pts[i + 1].vec) <\n          this.lineWidth\n        ) {\n          return true;\n        }\n      } else {\n        if (this.type !== GType.POLYLINE) {\n          if (\n            distanceMouseWithTwoVecs(new NVector3(x, y), this.pts[i].vec, this.pts[0].vec) <\n            this.lineWidth\n          ) {\n            return true;\n          }\n        }\n      }\n    }\n    // ....................................... duplicated polyline or gon\n\n    // ....................................... end duplicated polyline or gon\n    if (\n      this.scene.annotationInstance.geometryCommon.gcmdProcessing.isMouseInsideByOffScreen(\n        x,\n        y,\n        this.hashColor\n      )\n    ) {\n      return true;\n    }\n    return false;\n  }\n  public hasSamePtWtithCapture() {\n    for (let i = 0; i < this.pts.length; ++i) {\n      if (this.pts[i] === this.scene.capture) {\n        return true;\n      }\n    }\n    return false;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    if (this.hasSamePtWtithCapture()) {\n      return;\n    }\n    // console.log(this.vecSelected);\n    if (this.vecSelected !== -1) {\n      this.pts[this.vecSelected].translateByMouseEventData(e);\n      // this.wrapping.UpdateProjection(this.vecs);\n      return;\n    }\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    const xo = e.x - e.preX;\n    const yo = e.y - e.preY;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].vec.x += xo;\n      this.pts[i].vec.y += yo;\n\n      if (this.pts[i].textLeaderline) {\n        const p = this.pts[i] as APoint;\n        this.translateForTextLeaderline(e, p);\n      }\n    }\n    if (this.isCurvedPolyline && this.mPts) {\n      for (let i = 0; i < this.mPts.length; ++i) {\n        this.mPts[i].vec.x += xo;\n        this.mPts[i].vec.y += yo;\n      }\n    }\n    // this.wrapping.UpdateProjection(this.vecs);\n  }\n  private translateForTextLeaderline(e: MouseEventData, p: APoint) {\n    if (p.textLeaderline) {\n      p.textLeaderline.translateByMouseEventData(e);\n      if (p.textLeaderline.leaderline) {\n        // if (this.wrapping.needWrappingToLeft || this.wrapping.needWrappingToRight) {\n        p.textLeaderline.leaderline.v2.x = p.vec.x;\n        p.textLeaderline.leaderline.v2.y = p.vec.y;\n        // }\n        return true;\n      }\n    }\n    return false;\n  }\n  public translate(x: number, y: number): void {\n    //\n  }\n  public move(x: number, y: number) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    this.computeCenterVec();\n    const xo = x - this.vec.x;\n    const yo = y - this.vec.y;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].vec.x += xo;\n      this.pts[i].vec.y += yo;\n    }\n  }\n  public remove(needEmit = true): void {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].deepRemove();\n    }\n    this.isSelectable = false;\n    this.isRenderable = false;\n    // if (this.APolylineWrapperGraph) { this.APolylineWrapperGraph.Remove(); }\n    this.hidePopUpSummary();\n    if (needEmit) {\n      const ioGeo = this.toJSON();\n      if (ioGeo) {\n        this.scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack([ioGeo]);\n      }\n    }\n\n    this.scene.removeAPolylineWrapper(this);\n    this.scene.removeGeometry(this);\n  }\n  public hide(): void {\n    // throw new Error('Method not implemented.');\n  }\n  public getLength() {\n    if (this.pts.length < 2) {\n      return 0;\n    }\n    let sum = 0;\n    for (let i = 0; i < this.pts.length - 1; ++i) {\n      sum += 0;\n    }\n    return Math.abs(sum);\n  }\n  public findClosestNode(x: number, y: number) {\n    for (let i = 0; i < this.pts.length; ++i) {\n      if (this.pts[i].isMouseInside(x, y)) {\n        return this.pts[i];\n      }\n    }\n    return undefined;\n  }\n  public removeByBlackhole() {\n    this.computeCenterVec();\n    if (\n      getDistanceByArray(\n        [\n          this.scene.annotationInstance.renderer.blackhole.v.x,\n          this.scene.annotationInstance.renderer.blackhole.v.y,\n          this.scene.annotationInstance.renderer.blackhole.v.z,\n        ],\n        [this.vec.x, this.vec.y, this.vec.z]\n      ) < 10\n    ) {\n      // this.Remove(this.needEmitRemoveByBlackhole);\n      this.remove(true); // dont know why it false, but we can force true for emitting data\n    }\n  }\n  public getArea() {\n    this.vecs = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.vecs.push(this.pts[i].vec);\n    }\n    const area = getGeoArea(this.vecs); // in screen space\n    // console.log(area);\n\n    // if (unit === UNIT.METER) { return dis * 1000; }\n    // if (unit === UNIT.KM) { return dis; }\n    // if (unit === UNIT.MILE) { return MathUtility.MilesFromKM(dis); }\n    // return -1;\n    return area;\n  }\n  // ................................................ constraint\n  public get constraintTargetDistance() {\n    return this._constraintTargetDistance;\n  }\n  public set constraintTargetDistance(v: number) {\n    this.renderConstraintTargetDistance = true;\n    this.renderConstraintTargetDistancePercentage = false;\n    this._constraintTargetDistance = v;\n  }\n  public get constraintTargetDistancePercentage() {\n    return this._constraintTargetDistancePercentage;\n  }\n  public set constraintTargetDistancePercentage(v: number) {\n    this.renderConstraintTargetDistance = false;\n    this.renderConstraintTargetDistancePercentage = true;\n    if (v <= 0) {\n      this._constraintTargetDistancePercentage = 0.001;\n    } else {\n      this._constraintTargetDistancePercentage = v;\n    }\n  }\n  // ................................................ end constraint\n  public getNodePopup(): APoint | undefined {\n    let out = this.pts[0];\n    for (let i = 1; i < this.pts.length; ++i) {\n      if (this.pts[i].vec.x < out.vec.x) {\n        out = this.pts[i];\n      }\n    }\n    return out;\n  }\n  public addPT(p: APoint) {\n    if (this.type === GType.POLYLINE) {\n      p.type = GType.ANODE;\n    } else if (this.type === GType.POLYGON) {\n      p.type = GType.AN_GON;\n    }\n\n    p.isSelectable = false;\n    p.addEdge(this);\n\n    // let mv = MidVec(p.vec, this.pts[this.pts.length - 1].vec);\n    // let mp = new APoint(mv.x, mv.y, mv.z);\n    // mp.isMid = true;\n    // mp.isSelectable = false;\n    // p.type = GTYPE.NODE;\n    // mp.AddNode(this.pts[this.pts.length - 1]);\n    // mp.AddNode(p);\n    // mp.AddEdge(this);\n\n    // p.AddNode(mp);\n    // this.pts[this.pts.length - 1].AddNode(mp);\n\n    // this.pts.push(mp);\n    this.pts.push(p);\n    // if (this.pts.length > 2) this.ComputeCurve();\n  }\n  public toJSON(): IOGeometry {\n    const p = new IOGeometry(\n      this.id,\n      this.type,\n      this.isSelectedValue,\n      this.isHoverValue,\n      this.isHiddenValue\n    );\n    p.pushNode(this.getVecs());\n\n    // eslint:disable-next-line:no-string-literal\n    p.data['isConstraint'] = this.isConstraint;\n    p.data['constraintTargetDistance'] = this.constraintTargetDistance;\n    return p;\n  }\n  public getVecsFromDivision(numDis = 1) {\n    this.getLength();\n    for (let i = 0; i < this.pts.length - 1; ++i) {\n      const geoVec = this.pts[i].vec;\n      const geoDis = get1KMLatLongGeoUnit(geoVec.x, geoVec.y);\n      const scVec = this.scene.annotationInstance.geometryCommon.gcmdSupporting.toScreen(\n        geoDis.x,\n        geoDis.y\n      ); // new NVector3(geoVec.x + 0.01, geoVec.y + 0.01));\n      // let xd = geoVec.y - scVec.x;\n      // let yd = geoVec.y - scVec.y;\n      // console.log(xd, yd)\n      const scDis = getDistance(new NVector3(scVec[0], scVec[1]), this.pts[i].vec) * 0.7 * 1; // bugfix needed for 0.7\n\n      const v0 = this.pts[i].vec,\n        v1 = this.pts[i + 1].vec;\n      let v = scale(normalize(sub(v0, v1)), scDis);\n\n      v = plus(v0, v);\n      const g = new APoint(this.scene, v.x, v.y, v.z);\n      g.dummy();\n    }\n  }\n  public getVecsFromNumber(n = 5) {\n    for (let i = 0; i < this.pts.length - 1; ++i) {\n      const v0 = this.pts[i].vec;\n      const v1 = this.pts[i + 1].vec;\n      const vs = getDivideByNum(v0, v1, n);\n      vs.forEach((v) => {\n        const p = new APoint(this.scene, v.x, v.y, v.z);\n        p.dummy();\n      });\n    }\n  }\n  public getBoundary(): NVector3[] {\n    return this.getVecs();\n  }\n  public computeVec() {\n    this.computeCenterVec();\n    this.computeBoundingVecs();\n  }\n  public goToBlackhole() {\n    this.isSelectable = false;\n    this.needBlackhole = true;\n    this.pts.forEach((p) => {\n      p.goToBlackhole();\n    });\n  }\n  public updateMidVec() {\n    this.vecMid = [];\n    if (this.type === GType.POLYLINE) {\n      for (let i = 0; i < this.pts.length - 1; ++i) {\n        this.vecMid.push(midVec(this.pts[i].vec, this.pts[i + 1].vec));\n      }\n    }\n  }\n  public computeMidPts() {\n    let i = this.pts.length;\n    while (i--) {\n      if (this.pts[i].isMid) {\n        const p = this.pts[i];\n        p.vec = midVec(p.nodes[0].vec, p.nodes[1].vec);\n      }\n    }\n  }\n  public computeCenterVec() {\n    const vs: NVector3[] = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      vs.push(this.pts[i].vec);\n    }\n    this.vec = getCenterVecFromVecs(vs);\n    // const v = this.scene.annotationInstance.geometryCommon.gcmdSupporting.toMap(\n    //   this.vec.x,\n    //   this.vec.y\n    // );\n    return this.vec;\n  }\n  public computeBoundingVecs() {\n    this.vecs = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.vecs.push(this.pts[i].vec);\n    }\n    this.vecsBound = getMinMaxVecFromVecs(this.vecs);\n  }\n  public computeMidPT(i: number) {\n    if (this.pts.length < 3) {\n      return;\n    }\n    const mp = this.pts[i];\n    const mv = midVec(this.pts[i - 1].vec, this.pts[i + 1].vec);\n    mp.vec = mv;\n  }\n  public removePT(p: APoint) {\n    this.pts.splice(this.pts.indexOf(p), 1);\n    p.remove();\n  }\n  // AppendDivForShape() {\n  //     this.pts[this.pts.length - 1].HasPopup = true;\n  // }\n  public getVecs() {\n    const vs: NVector3[] = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      vs.push(this.pts[i].vec);\n    }\n    this.vecs = vs;\n    return vs;\n  }\n  public deepCopy(x: number, y: number, z = 0) {\n    const g = this.toJSON();\n    // if (g) {\n    const ng = APolylineWrapper.fromJSON(this.scene, g, true, true);\n    ng.move(x, y);\n    ng.isHoverValue = true;\n    ng.emitAddStack();\n    // }\n    return ng;\n  }\n  public get isHidden() {\n    return this.isHiddenValue;\n  }\n  public set isHidden(v: boolean) {\n    this.isHiddenPre = this.isHiddenValue;\n    this.isHiddenValue = v;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].isHiddenValue = v;\n      this.pts[i].visibility = 0;\n    }\n    this.scene.annotationInstance.io.eventListenerAnnotation.hideStack(this.toJSON());\n  }\n  public set IsSelectable(v: boolean) {\n    this.isSelectable = v;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].isSelectable = v;\n    }\n  }\n  public get IsSelectable() {\n    return this.isSelectable;\n  }\n  public get v() {\n    return this.vec;\n  }\n  public set v(v: NVector3) {\n    this.vec = v;\n  }\n  public get isSelected() {\n    return this.isSelectedValue;\n  }\n  public set isSelected(v: boolean) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    this.isSelectedValue = v;\n    for (const p of this.pts) {\n      p.isRenderable = v;\n    }\n    this.scene.annotationInstance.io.eventListenerAnnotation.selectionStack(this.toJSON());\n  }\n  public get isHover() {\n    return this.isHoverValue;\n  }\n\n  /*\n    public set IsHover(v: boolean) {\n        if (this.isUnderConstruction) { return; }\n        this.isHover = v;\n        if (this.isHover && !this.isHoverPre) {\n            this.scene.annotationInstance.io.eventListenerAnnotation.HoverStack(this.ToJSON());\n        } else if (!this.isHover && this.isHoverPre) {\n            this.scene.annotationInstance.io.eventListenerAnnotation.HoverStack(this.ToJSON());\n        }\n        this.isHoverPre = this.isHover;\n        if (!v) { this.needEmitHoverPost = true; this.HidePopUpSummary(); }\n    }\n    */\n  // /*\n  public set isHover(v: boolean) {\n    if (this.isUnderConstruction) {\n      return;\n    }\n    this.isHoverValue = v;\n\n    if (this.isHoverValue && !this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    } else if (!this.isHoverValue && this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    }\n    this.isHoverPre = this.isHoverValue;\n    if (!this.isSelectedValue) {\n      for (const p of this.pts) {\n        p.isRenderable = v;\n        // if (p.isSelectedSole) { p.isRenderable = true; }\n      }\n    }\n\n    // for (let p of this.pts) {\n    //     if (p.isSelected) {\n    //         p.isRenderable = true;\n    //         p.IsHover = true;\n    //         console.log(p);\n    //     } else {\n    //         // p.isRenderable = false;\n    //     }\n    // }\n\n    // ....\n    // if (this.APolylineWrapperGraph) { this.APolylineWrapperGraph.IsHover = v; }\n    // for (let p of this.mPts) { p.isRenderable = v; }\n    if (!v) {\n      this.needEmitHoverPost = true;\n      this.hidePopUpSummary();\n    }\n    // if (v && !this.isHoverPre) {\n    //     for (let p of this.pts) {\n    //         p.t = 0.0;\n    //     }\n    // }\n    // console.log(this.isHover, this.isHoverPre);\n  }\n  //  */\n  public mouseLeftClick() {\n    // console.log('polygon');\n    this.scene.annotationInstance.geometryCommon.gcmdProcessing.removeAllPopup();\n    this.showPopupSummary();\n    // if (this.isConstraint) {\n    // console.log('left');\n    // }\n    this.dimension.renderTotalLengthInput();\n  }\n  public mouseRightClick() {\n    // console.log(this.constraintTargetDistance);\n    // this.constraintTargetDistance += 50;\n    // this.isFill = !this.isFill;\n  }\n  public update() {\n    //\n  }\n  // UpdateProjection() {\n  //     this.wrapping.ComputeCheck(this.vecs);\n\n  //     if (this.wrapping.isIntersectLeft) {\n  //         this.vecOthers = this.wrapping.ComputeWrappingDuplication(this.vecs, 1);\n  //     } else if (this.wrapping.isIntersectRight) {\n  //         this.vecOthers = this.wrapping.ComputeWrappingDuplication(this.vecs, -1);\n  //     }\n\n  //     const dir = this.scene.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.extent.dirction;\n  //     // console.log(dir);\n  //     if (this.wrapping.needWrappingToRight &&  0 < dir  ) {\n  //         for (let i = 0; i < this.vecs.length; ++i) {\n  //             let p = this.scene.annotationInstance.geometryCommon.WrappingProjectedPosShape(this.vecs[i].proX, this.vecs[i].proY, 1);\n  //             this.vecs[i].proX = p[0]; this.vecs[i].proY = p[1];\n\n  //             // p = this.scene.annotationInstance.geometryCommon.ToScreenFromProjectedPos(p[0], p[1]);\n  //             // this.vecs[i].x = p[0]; this.vecs[i].y = p[1];\n  //             // console.log('right');\n  //         }\n  //     } else if (this.wrapping.needWrappingToLeft && dir < 0) {\n  //         for (let i = 0; i < this.vecs.length; ++i) {\n  //             let p = this.scene.annotationInstance.geometryCommon.WrappingProjectedPosShape(this.vecs[i].proX, this.vecs[i].proY, -1);\n  //             this.vecs[i].proX = p[0]; this.vecs[i].proY = p[1];\n\n  //             // p = this.scene.annotationInstance.geometryCommon.ToScreenFromProjectedPos(p[0], p[1]);\n  //             // this.vecs[i].x = p[0]; this.vecs[i].y = p[1];\n  //             // console.log('left');\n  //         }\n  //     }\n\n  //     if (this.wrapping.needWrappingToRight) {\n  //         for (let i = 0; i < this.vecOthers.length; ++i) {\n  //             const p = this.scene.annotationInstance.geometryCommon.ToScreenFromProjectedPos(this.vecOthers[i].proX, this.vecOthers[i].proY);\n  //             this.vecs[i].x = p[0]; this.vecs[i].y = p[1];\n  //             // console.log('needWrappingToRight');\n  //         }\n  //     } else if (this.wrapping.needWrappingToLeft) {\n  //         for (let i = 0; i < this.vecOthers.length; ++i) {\n  //             const p = this.scene.annotationInstance.geometryCommon.ToScreenFromProjectedPos(this.vecOthers[i].proX, this.vecOthers[i].proY);\n  //             this.vecs[i].x = p[0]; this.vecs[i].y = p[1];\n  //             // console.log('needWrappingToLeft');\n  //         }\n  //         console.log('!!');\n  //     }\n  //     // console.log(this.wrapping.needWrappingToLeft, this.wrapping.needWrappingToRight);\n\n  //     // ...... set false;\n  //     this.wrapping.needWrappingToLeft = false;\n  //     this.wrapping.needWrappingToRight = false;\n  // }\n  // ............................................................................................... render\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    // console.log(this.isMoved);\n    this.update();\n    this.computeVec();\n\n    // if (this.scene.annotationInstance.implementations.app.model.appCoreWrapper.appAccessibility.mode === INTERACTION_MODE.DRAWING) {\n    this.renderer.timer.updatePopupSummery();\n    // }\n\n    if (this.scene.annotationInstance.activeCommandController.acProperties.isPanning) {\n      // this.wrapping.UpdateProjectionShapes(this.vecs);\n    }\n\n    // console.log('needWrapping', this.wrapping.needWrapping);\n    // console.log('needWrappingDuplicate', this.wrapping.needWrappingDuplicate);\n\n    this.renderer.renderPost(ctx);\n  }\n}\n","import { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { APolygonWrapper } from '../APolygonWrapper';\nexport class StyleComponent extends _StyleComponent {\n  public geo: APolygonWrapper;\n  constructor(geo: APolygonWrapper) {\n    super(geo);\n  }\n  public updateStyle() {\n    RenderStyle.updateRenderStylePolygon(\n      this.renderStyle,\n      this.geo.scene.annotationInstance.customization.themeCurrent\n    );\n    RenderStyle.updateRenderStylePolygonNode(\n      this.renderStyleNode,\n      this.geo.scene.annotationInstance.customization.themeCurrent\n    );\n    if (this.geo.pts) {\n      for (let i = 0; i < this.geo.pts.length; ++i) {\n        this.geo.pts[i].styleComponent.updateStyleForNode(this.renderStyleNode);\n      }\n    }\n  }\n}\n","import { \n  GType,\n  MouseEventData,\n  getDistance, \n  NVector3,\n} from '../../../../../../lib';\nimport { IOGeometry } from '../../../../../../lib/Extended/GeometryUtility';\nimport { Scene } from '../../../../Scene';\nimport { APolylineWrapper } from '../../FamilyLine/APolylineWrapper/APolylineWrapper';\nimport { APoint } from '../../FamilyPoint/Base/APoint';\nimport { ANGonWrapper } from '../ANGonWrapper';\nimport { StyleComponent } from './Component/StyleComponent';\nexport class APolygonWrapper extends APolylineWrapper {\n  public static split = false;\n  public static isDone = false;\n  public static construction: APolygonWrapper | undefined;\n  // ...............................................................\n  public static addGhost(x: number, y: number) {\n    // let gp = APolygonWrapper.FromJSON()\n    // gp.Dummy();\n    // gp.visibility = 0.5;\n  }\n  public static findAtPoint(scene: Scene, e: MouseEventData) {\n    for (let i = scene.listAPolygonWrapper.length - 1; i >= 0; --i) {\n      if (\n        scene.listAPolygonWrapper[i].isSelectable &&\n        scene.listAPolygonWrapper[i].isMouseInside(e.x, e.y)\n      ) {\n        return scene.listAPolygonWrapper[i];\n      }\n    }\n    return undefined;\n  }\n  public static computeOver(scene: Scene, e: MouseEventData) {\n    const cl = scene.annotationInstance.geometryCommon.gcmdProcessing.findAtPoint(e);\n    if (cl !== undefined) {\n      cl.isHoverValue = true;\n    }\n  }\n  public static aPolygonFromNGon(scene: Scene, ng: ANGonWrapper) {\n    const geo = new APolygonWrapper(scene, ng.pts[0].deepCopy() as APoint);\n    for (let i = 1; i < ng.pts.length; ++i) {\n      geo.addPT(ng.pts[i].deepCopy() as APoint);\n    }\n    geo.type = GType.POLYGON; // geo.type = GType[ng.type];\n    geo.id = ng.id;\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n    return geo;\n  }\n  public static getPolygonbyVecs(scene: Scene, vs: NVector3[]) {\n    const geo = new APolygonWrapper(scene, new APoint(scene, vs[0].x, vs[0].y));\n    for (let i = 1; i < vs.length - 1; ++i) {\n      geo.addPT(new APoint(scene, vs[i].x, vs[i].y));\n    }\n    geo.type = GType.POLYGON;\n    geo.computeCenterVec();\n    geo.initVecsHistory();\n    scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n    geo.isHover = false;\n    geo.visibilityValue = 1.0;\n    geo.isRenderable = true;\n    return geo;\n  }\n  // ............................................................... construction\n  // static APolygonWrapperFromNGon(ng: CNGon) {\n  //     let geo = new APolygonWrapper(ng.pts[0].DeepCopy());\n  //     for (let i = 1; i < ng.pts.length; ++i) { geo.AddPT(ng.pts[i].DeepCopy()); }\n  //     geo.type = GType[ng.type];\n  //     geo.style = ng.style;\n  //     geo.id = ng.id;\n  //     geo.IsSelectable = true;\n  //     geo.isUnderConstruction = false;\n  //     return geo;\n  // }\n  public static fromJSON(scene: Scene, g: IOGeometry, isUndo = false, isDeepCopy = false) {\n    const geo = new APolygonWrapper(scene, APoint.getNodeFromJSON(scene, g.nodes[0], isUndo));\n    if (isUndo) {\n      geo.isUndo = isUndo;\n      for (let i = 1; i < g.nodes.length; ++i) {\n        geo.addPT(APoint.getNodeFromJSON(scene, g.nodes[i], isUndo));\n      }\n    } else {\n      for (let i = 1; i < g.nodes.length; ++i) {\n        geo.addPT(APoint.getNodeFromJSON(scene, g.nodes[i]));\n      }\n    }\n    geo.type = GType[g.type];\n    // geo.style = g.style;\n    if (isDeepCopy) {\n      geo.id = scene.getUUID();\n    } else {\n      geo.id = g.id;\n    }\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n    geo.isHover = false;\n    geo.isHiddenValue = g.isHidden;\n    if (g.isHidden) {\n      geo.visibilityValue = 0;\n    } else {\n      geo.visibilityValue = 1.0;\n    }\n    // geo.wrapping.InitProjectionShapesFromJSON(geo.GetVecs());\n    // geo.wrapping.UpdateProjection(geo.vecs);\n    geo.computeCenterVec();\n    geo.initVecsHistory();\n    if (!isUndo) {\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n    }\n    return geo;\n  }\n  public static drawShadow(e: MouseEventData) {\n    if (APolygonWrapper.construction !== undefined) {\n      APolygonWrapper.construction.pts[APolygonWrapper.construction.pts.length - 1].move(e.x, e.y);\n    }\n  }\n  public static getLine(\n    scene: Scene,\n    e: MouseEventData,\n    isConstraint = false,\n    type: GType = GType.AN_GON\n  ) {\n    if (APolygonWrapper.construction !== undefined) {\n      APolygonWrapper.construction.addPT(new APoint(scene, e.x, e.y, 0, false, GType.ANODE_NGON));\n    } else {\n      APolygonWrapper.construction = new APolygonWrapper(\n        scene,\n        new APoint(scene, e.x, e.y),\n        false,\n        isConstraint\n      );\n      APolygonWrapper.construction.pts[0].isSelectable = true;\n\n      APolygonWrapper.construction.addPT(new APoint(scene, e.x, e.y, 0, false, GType.ANODE_NGON));\n      APolygonWrapper.construction.isUnderConstruction = true;\n    }\n  }\n  public static getLineByPt(p: APoint) {\n    /**/\n  }\n  public static undo(scene: Scene, e: MouseEventData): undefined {\n    if (!APolygonWrapper.construction) {\n      return undefined;\n    }\n    let i = APolygonWrapper.construction.pts.length - 1;\n    if (i === 1) {\n      APolygonWrapper.cancel(scene);\n      return undefined;\n    }\n    APolygonWrapper.construction.removePT(APolygonWrapper.construction.pts[--i]);\n    APolygonWrapper.construction.pts[i].vec.x = e.x;\n    APolygonWrapper.construction.pts[i].vec.y = e.y;\n    return undefined\n  }\n  public static done(scene: Scene) {\n    if (scene.annotationInstance.activeCommandController.IsTouchEvent) {\n      this.doneByTouch(scene);\n    } else {\n      this.doneByMouseClick(scene);\n    }\n    scene.annotationInstance.implementations.app.model.ioWrapper.eventInteraction.isEnableZoomByDoubleClick = true;\n  }\n  public static doneByTouch(scene: Scene) {\n    if (APolygonWrapper.construction !== undefined) {\n      APolygonWrapper.construction.IsSelectable = true;\n\n      APolygonWrapper.construction.removePT(APolygonWrapper.construction.pts[0]);\n      if (\n        getDistance(\n          APolygonWrapper.construction.pts[APolygonWrapper.construction.pts.length - 1].vec,\n          APolygonWrapper.construction.pts[0].vec\n        ) < 15\n      ) {\n        APolygonWrapper.construction.removePT(\n          APolygonWrapper.construction.pts[APolygonWrapper.construction.pts.length - 1]\n        );\n      }\n      APolygonWrapper.construction.removePT(\n        APolygonWrapper.construction.pts[APolygonWrapper.construction.pts.length - 1]\n      );\n      APolygonWrapper.construction.computeCenterVec();\n      APolygonWrapper.construction.initVecsHistory();\n\n      APolygonWrapper.construction.isUnderConstruction = false;\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n        APolygonWrapper.construction.toJSON()\n      );\n\n      if (APolygonWrapper.construction.pts.length < 2) {\n        APolygonWrapper.construction.remove();\n      }\n      APolygonWrapper.construction = undefined;\n      scene.annotationInstance.activeCommandController.goToACMode();\n    }\n    // console.log('by touch');\n  }\n  public static doneByMouseClick(scene: Scene) {\n    if (APolygonWrapper.construction !== undefined) {\n      APolygonWrapper.construction.IsSelectable = true;\n\n      APolygonWrapper.construction.removePT(\n        APolygonWrapper.construction.pts[APolygonWrapper.construction.pts.length - 1]\n      );\n      if (\n        getDistance(\n          APolygonWrapper.construction.pts[APolygonWrapper.construction.pts.length - 1].vec,\n          APolygonWrapper.construction.pts[0].vec\n        ) < 2\n      ) {\n        APolygonWrapper.construction.removePT(\n          APolygonWrapper.construction.pts[APolygonWrapper.construction.pts.length - 1]\n        );\n      }\n      APolygonWrapper.construction.removePT(\n        APolygonWrapper.construction.pts[APolygonWrapper.construction.pts.length - 1]\n      );\n      APolygonWrapper.construction.computeCenterVec();\n\n      APolygonWrapper.construction.isUnderConstruction = false;\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n        APolygonWrapper.construction.toJSON()\n      );\n\n      if (APolygonWrapper.construction.pts.length < 2) {\n        APolygonWrapper.construction.remove();\n      }\n      APolygonWrapper.construction = undefined;\n      scene.annotationInstance.activeCommandController.goToACMode();\n    }\n  }\n  public static doneByKeyboard(scene: Scene) {\n    if (APolygonWrapper.construction !== undefined) {\n      APolygonWrapper.construction.IsSelectable = true;\n\n      APolygonWrapper.construction.removePT(\n        APolygonWrapper.construction.pts[APolygonWrapper.construction.pts.length - 1]\n      );\n      APolygonWrapper.construction.isUnderConstruction = false;\n      APolygonWrapper.construction.computeCenterVec();\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n        APolygonWrapper.construction.toJSON()\n      );\n\n      if (APolygonWrapper.construction.pts.length < 2) {\n        APolygonWrapper.construction.remove();\n      }\n      APolygonWrapper.construction = undefined;\n      scene.annotationInstance.activeCommandController.goToACMode();\n    }\n  }\n  public static cancel(scene: Scene) {\n    if (APolygonWrapper.construction !== undefined) {\n      APolygonWrapper.construction.needEmit = false;\n      APolygonWrapper.construction.remove();\n      APolygonWrapper.construction = undefined;\n      scene.annotationInstance.activeCommandController.goToACMode();\n    }\n  }\n  // ................................... end implementation\n\n  // .................................................................... end implementation\n\n  public static mouseDown(scene: Scene, e: MouseEventData) {\n    if (scene.annotationInstance.activeCommandController.acProperties.isSmartSelectionWhenDrawing) {\n      const cGeo = scene.annotationInstance.geometryCommon.gcmdProcessing.findAtPoint(e);\n      if (APolygonWrapper.construction) {\n        APolygonWrapper.getLine(scene, e);\n        if (cGeo) {\n          // Geo === APolygonWrapper.construction.pts[0]) {\n          APolygonWrapper.construction.type = GType.POLYGON;\n          APolygonWrapper.construction.isClosed = true;\n          APolygonWrapper.construction.removePT(\n            APolygonWrapper.construction.pts[APolygonWrapper.construction.pts.length - 1]\n          );\n          APolygonWrapper.construction.removePT(\n            APolygonWrapper.construction.pts[APolygonWrapper.construction.pts.length - 1]\n          );\n          cGeo.isSelectedValue = false;\n          cGeo.isHoverValue = false;\n          cGeo.isCapturedValue = false;\n          cGeo.isSelectable = false;\n\n          APolygonWrapper.construction.IsSelectable = true;\n          APolygonWrapper.construction.isUnderConstruction = false;\n\n          APolygonWrapper.construction.computeCenterVec();\n          scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n            APolygonWrapper.construction.toJSON()\n          );\n\n          // APolygonWrapper.isDone = true;\n          // if (AGeometryCommon.capture) {\n          //     AGeometryCommon.capture.isCaptured = false;\n          //     AGeometryCommon.capture = undefined;\n          // }\n          APolygonWrapper.construction = undefined;\n        }\n      }\n    } else {\n      APolygonWrapper.getLine(scene, e);\n    }\n  }\n  public static mouseLeftClick(scene: Scene, e: MouseEventData, isConstraint = false, type: GType = GType.POLYGON): undefined {\n    if (scene.capture !== undefined) {\n      return undefined;\n    }\n    if (APolygonWrapper.construction !== undefined && APolygonWrapper.isDone) {\n      APolygonWrapper.construction.isSelectedValue = false;\n      APolygonWrapper.construction = undefined;\n      APolygonWrapper.isDone = false;\n      return undefined;\n    } else if (APolygonWrapper.construction === undefined) {\n      APolygonWrapper.getLine(scene, e, isConstraint, type);\n    }\n    return undefined\n  }\n  public static mouseMove(e: MouseEventData): undefined {\n    if (APolygonWrapper.construction === undefined) {\n      return undefined;\n    }\n    if (\n      APolygonWrapper.construction.scene.annotationInstance.activeCommandController.acProperties\n        .pressShift &&\n      APolygonWrapper.construction.pts.length > 1\n    ) {\n      const p0 = APolygonWrapper.construction.pts[APolygonWrapper.construction.pts.length - 2];\n      if (getDistance(p0.vec, new NVector3(e.x, e.y)) > 20) {\n        this.mouseDown(APolygonWrapper.construction.scene, e);\n      }\n    }\n    APolygonWrapper.drawShadow(e);\n    return undefined\n  }\n  public static mouseDoubleClick(scene: Scene, e: MouseEventData) {\n    if (APolygonWrapper.construction !== undefined) {\n      APolygonWrapper.done(scene);\n    }\n  }\n  // ........................................................................................ class implementation\n  constructor(scene: Scene, p: APoint, isUndo = false, isConstraint = false) {\n    super(scene, p, isUndo);\n    this.initComponentPolygon();\n    p.styleComponent.updateStyleForNode(this.styleComponent.renderStyleNode);\n\n    this.isConstraint = isConstraint;\n    this.isFill = true;\n    scene.annotationInstance.implementations.app.model.ioWrapper.eventInteraction.isEnableZoomByDoubleClick = false;\n    this.initPolygon();\n  }\n  private initComponentPolygon() {\n    this.styleComponent = new StyleComponent(this);\n  }\n  private initPolygon() {\n    this.type = GType.POLYGON;\n    this.scene.addAPolygonWrapper(this);\n  }\n  public getLog(): string {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return '';\n    }\n    const text =\n      'GUID : ' +\n      this.id +\n      '/' +\n      'TYPE : ' +\n      this.type.toString() +\n      '/' +\n      // 'PARENT : ' + this.edges[0].GetParentType()+'<br>'+\n      // 'Geo : ' + 'lat:' + this.geoVec.x.toFixed(5).toString() + ', Log:' + this.geoVec.y.toFixed(5).toString() + '/' +\n      'Screen : ' +\n      // this.vec.ToString() +\n      '/' +\n      'pos : ' +\n      this.pts.length +\n      '/' +\n      'Area : ' +\n      this.getArea().toFixed(3).toString() +\n      ' m2' +\n      '/' +\n      // 'STYLE : ' + this.style.toString() + '/' +\n      // 'CONNE :' + this.edges.length.toString() + '/' +\n      'IsSEL : ' +\n      this.isSelectedValue +\n      '/' +\n      'isSelable : ' +\n      this.isSelectable;\n    return text;\n  }\n  public getLogDOM() {\n    const text =\n      'Geometry ID : ' +\n      this.id +\n      '<br>' +\n      'geometry Type : CCircle' +\n      '<br>' +\n      // 'parent : ' + this.parent.GetParentType() + '<br>' +\n      'position : ' +\n      // this.vec.ToString() +\n      '<br>' +\n      'size : ' +\n      this.r +\n      ' pixel<br>';\n    // 'color :' + this.style.fillStyle + '<br>';\n    return text;\n  }\n  // reference https://www.wikihow.com/Calculate-the-Area-of-a-Polygon\n  public set IsSelectable(v: boolean) {\n    this.isSelectable = v;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].isSelectable = v;\n    }\n  }\n  public get IsSelectable() {\n    return this.isSelectable;\n  }\n  public set isHidden(v: boolean) {\n    this.isHiddenPre = this.isHiddenValue;\n    this.isHiddenValue = v;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].isHiddenValue = v;\n      this.pts[i].visibility = 0;\n    }\n    this.scene.annotationInstance.io.eventListenerAnnotation.hideStack(this.toJSON());\n  }\n  public get isHidden() {\n    return this.isHiddenValue;\n  }\n  public mouseRightClick() {\n    // this.isFill = !this.isFill;\n  }\n  public findClosestNode(x: number, y: number) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return undefined;\n    }\n    for (let i = 0; i < this.pts.length; ++i) {\n      if (this.pts[i].isMouseInside(x, y)) {\n        return this.pts[i];\n      }\n    }\n    return undefined;\n  }\n  public remove(needEmit = true): void {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return undefined;\n    }\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].deepRemove();\n    }\n    this.isSelectable = false;\n    this.isRenderable = false;\n    this.hidePopUpSummary();\n    if (!this.isUnderConstruction && needEmit) {\n      const ioGeo = this.toJSON();\n      if (ioGeo) {\n        this.scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack([ioGeo]);\n      }\n    }\n    this.scene.removeAPolygonWrapper(this);\n    this.scene.removeGeometry(this);\n  }\n  public deepCopy(x: number, y: number, z = 0) {\n    const g = this.toJSON();\n    // if (g) {\n    const ng = APolygonWrapper.fromJSON(this.scene, g, true, true);\n    ng.move(x, y);\n    ng.isHoverValue = true;\n    ng.emitAddStack();\n    return ng;\n  }\n  // public RenderPost(ctx: CanvasRenderingContext2D) { // we do not need to overright this render post func\n  //     this.renderer.RenderPost(ctx);\n  // }\n}\n","import { GType,  NVector3 } from '../../../../../lib';\n// import { ALog } from './ALog';\nimport { AGeometryBase } from '../../Common/Base/AGeometryBase';\nexport class Dimension {\n  public geometryBase: AGeometryBase;\n  public numToFixed = 2;\n  constructor(geometryBase: AGeometryBase, numToFixed = 2) {\n    this.geometryBase = geometryBase;\n    this.numToFixed = numToFixed;\n  }\n  public render(ctx: CanvasRenderingContext2D, isClosed: boolean, vs: NVector3[]) {\n    this.renderLength(ctx, isClosed, vs);\n    this.renderDimTotal(ctx, vs);\n    this.renderTotalArea(ctx, vs);\n  }\n  public renderLength(ctx: CanvasRenderingContext2D, isClosed: boolean, vs: NVector3[]) {\n    for (let i = 0; i < vs.length - 1; ++i) {\n      if (vs[i].x < vs[i + 1].x) {\n        this.geometryBase.scene.annotationInstance.renderer.draw.shape.line.lineDim(\n          ctx,\n          this.geometryBase.styleComponent.renderStyle,\n          vs[i].x,\n          vs[i].y,\n          vs[i + 1].x,\n          vs[i + 1].y,\n          0\n        );\n      } else {\n        this.geometryBase.scene.annotationInstance.renderer.draw.shape.line.lineDim(\n          ctx,\n          this.geometryBase.styleComponent.renderStyle,\n          vs[i + 1].x,\n          vs[i + 1].y,\n          vs[i].x,\n          vs[i].y,\n          0\n        );\n      }\n    }\n    if (isClosed) {\n      if (vs[vs.length - 1].x < vs[0].x) {\n        this.geometryBase.scene.annotationInstance.renderer.draw.shape.line.lineDim(\n          ctx,\n          this.geometryBase.styleComponent.renderStyle,\n          vs[vs.length - 1].x,\n          vs[vs.length - 1].y,\n          vs[0].x,\n          vs[0].y,\n          0\n        );\n      } else {\n        this.geometryBase.scene.annotationInstance.renderer.draw.shape.line.lineDim(\n          ctx,\n          this.geometryBase.styleComponent.renderStyle,\n          vs[0].x,\n          vs[0].y,\n          vs[vs.length - 1].x,\n          vs[vs.length - 1].y,\n          0\n        );\n      }\n    }\n\n    if (isClosed) {\n      for (let i = 0; i < vs.length; ++i) {\n        if (i === vs.length - 1) {\n          this.geometryBase.scene.annotationInstance.renderer.draw.shape.line.lineDim(\n            ctx,\n            this.geometryBase.styleComponent.renderStyle,\n            vs[i].x,\n            vs[i].y,\n            vs[0].x,\n            vs[0].y,\n            0\n          );\n        } else {\n          if (vs[i].x < vs[i + 1].x) {\n            this.geometryBase.scene.annotationInstance.renderer.draw.shape.line.lineDim(\n              ctx,\n              this.geometryBase.styleComponent.renderStyle,\n              vs[i].x,\n              vs[i].y,\n              vs[i + 1].x,\n              vs[i + 1].y,\n              0\n            );\n          } else {\n            this.geometryBase.scene.annotationInstance.renderer.draw.shape.line.lineDim(\n              ctx,\n              this.geometryBase.styleComponent.renderStyle,\n              vs[i + 1].x,\n              vs[i + 1].y,\n              vs[i].x,\n              vs[i].y,\n              0\n            );\n          }\n        }\n      }\n    } else {\n      for (let i = 0; i < vs.length - 1; ++i) {\n        if (vs[i].x < vs[i + 1].x) {\n          this.geometryBase.scene.annotationInstance.renderer.draw.shape.line.lineDim(\n            ctx,\n            this.geometryBase.styleComponent.renderStyle,\n            vs[i].x,\n            vs[i].y,\n            vs[i + 1].x,\n            vs[i + 1].y,\n            0\n          );\n        } else {\n          this.geometryBase.scene.annotationInstance.renderer.draw.shape.line.lineDim(\n            ctx,\n            this.geometryBase.styleComponent.renderStyle,\n            vs[i + 1].x,\n            vs[i + 1].y,\n            vs[i].x,\n            vs[i].y,\n            0\n          );\n        }\n      }\n    }\n\n    // if (this.geometryBase.needWrappingDuplicate) {\n    //     if (this.geometryBase.type === GType.POLYGON || isClosed) {\n    //         for (let i = 0; i < this.vecOthers.length; ++i) {\n    //             if (i === this.vecOthers.length - 1) {\n    //                 this.geometryBase.scene.imageAnnoApp.renderer.draw.shape.line.LineDim(ctx, this.geometryBase.styleComponent.renderStyle, this.vecOthers[i].x, this.vecOthers[i].y, this.vecOthers[0].x, this.vecOthers[0].y, ALine.DistancefromGeoV(this.vecOthers[i], this.vecOthers[0]));\n    //             } else {\n    //                 this.geometryBase.scene.imageAnnoApp.renderer.draw.shape.line.LineDim(ctx, this.geometryBase.styleComponent.renderStyle, this.vecOthers[i].x, this.vecOthers[i].y, this.vecOthers[i + 1].x, this.vecOthers[i + 1].y, ALine.DistancefromGeoV(this.vecOthers[i], this.vecOthers[i + 1]));\n    //             }\n    //         }\n    //     } else {\n    //         for (let i = 0; i < this.vecOthers.length - 1; ++i) {\n    //             this.geometryBase.scene.imageAnnoApp.renderer.draw.shape.line.LineDim(ctx, 0, this.vecOthers[i].x, this.vecOthers[i].y, this.vecOthers[i + 1].x, this.vecOthers[i + 1].y, ALine.DistancefromGeoV(this.vecOthers[i], this.vecOthers[i + 1]));\n    //         }\n    //     }\n    // }\n    // if (isArea) {\n    //     this.RenderTotallength(ctx, vs);\n    // } else {\n    //     this.RenderArea(ctx, vs);\n    // }\n  }\n  public renderDimTotal(ctx: CanvasRenderingContext2D, vs: NVector3[]) {\n    if (vs.length > 2 && this.geometryBase.type === GType.POLYLINE) {\n      this.renderTotalLength(ctx, vs);\n    }\n    // if (vs.length > 2 && this.geometryBase.type === GType.POLYGON) { this.RenderArea(ctx); }\n  }\n  public renderTotalArea(ctx: CanvasRenderingContext2D, vs: NVector3[], addition = '') {\n    // let result = Math.abs(NVector3.GetAreayConvexGPS(vs)).toFixed(this.numToFixed);\n    // ALog.alog.Text = 'Total Area : ' + result.toString() + ' ' + this.geometryBase.scene.annotationViewer.activeCommandController.unit + addition;\n  }\n  public renderTotalLength(ctx: CanvasRenderingContext2D, vs: NVector3[]) {\n    // let result = 0;\n    // for (let i = 0; i < vs.length - 1; ++i) {\n    //   result += Math.abs(0);\n    // }\n    // console.debug(result);\n    // ALog.alog.Text = 'Total Length : ' + result.toFixed(this.numToFixed).toString() + ' ' + this.geometryBase.scene.annotationViewer.activeCommandController.unit;\n  }\n  // .......................... circle\n  public renderLengthCircle(ctx: CanvasRenderingContext2D, v: NVector3, vs: NVector3[]) {\n    // this.geometryBase.scene.imageAnnoApp.renderer.draw.shape.line.LineDim(ctx, 0, v.x, v.y, vs[0].x, vs[0].y, ALine.DistancefromGeoV(v, vs[0]));\n    // this.geometryBase.scene.imageAnnoApp.renderer.draw.shape.line.LineDim(ctx, 0, v.x, v.y, vs[1].x, vs[1].y, ALine.DistancefromGeoV(v, vs[1]));\n    // this.geometryBase.scene.imageAnnoApp.renderer.draw.shape.line.LineDim(ctx, 0, vs[2].x, vs[2].y, v.x, v.y, ALine.DistancefromGeoV(v, vs[2]));\n    // this.geometryBase.scene.imageAnnoApp.renderer.draw.shape.line.LineDim(ctx, 0, vs[3].x, vs[3].y, v.x, v.y, ALine.DistancefromGeoV(v, vs[3]));\n  }\n  public renderTotalAreaCircle(ctx: CanvasRenderingContext2D, v: NVector3, vs: NVector3[]) {\n    // const rA0 = ALine.DistancefromGeoV(v, vs[0]);\n    // const rA1 = ALine.DistancefromGeoV(v, vs[1]);\n    // const resultA = Math.PI * rA0 * rA1 * 0.5;\n    // const rB0 = ALine.DistancefromGeoV(v, vs[2]);\n    // const rB1 = ALine.DistancefromGeoV(v, vs[3]);\n    // const resultB = Math.PI * rB0 * rB1 * 0.5;\n    // ALog.alog.Text = 'Total Area : ' + (resultA + resultB).toFixed(this.numToFixed).toString() + ' ' + this.geometryBase.scene.annotationViewer.activeCommandController.unit;\n  }\n  // .......................... rect\n  public renderLengthRect(ctx: CanvasRenderingContext2D, vs: NVector3[]) {\n    // this.geometryBase.scene.imageAnnoApp.renderer.draw.shape.line.LineDim(ctx, 0, vs[0].x, vs[0].y, vs[1].x, vs[1].y, ALine.DistancefromGeoV(vs[0], vs[1]));\n    // this.geometryBase.scene.imageAnnoApp.renderer.draw.shape.line.LineDim(ctx, 0, vs[1].x, vs[1].y, vs[2].x, vs[2].y, ALine.DistancefromGeoV(vs[1], vs[2]));\n    // this.geometryBase.scene.imageAnnoApp.renderer.draw.shape.line.LineDim(ctx, 0, vs[3].x, vs[3].y, vs[2].x, vs[2].y, ALine.DistancefromGeoV(vs[3], vs[2]));\n  }\n  public renderTotalAreaRect(ctx: CanvasRenderingContext2D, vs: NVector3[], addition = '') {\n    // const height = ALine.DistancefromGeoV(vs[0], vs[3]);\n    // const withA = ALine.DistancefromGeoV(vs[0], vs[1]);\n    // const withB = ALine.DistancefromGeoV(vs[3], vs[2]);\n    // const result = (height * withA * 0.5) + (height * withB * 0.5);\n    // ALog.alog.Text = 'Total Area : ' + result.toFixed(this.numToFixed).toString() + ' ' + this.geometryBase.scene.annotationViewer.activeCommandController.unit + addition;\n  }\n  // .......................... curve\n  public renderLengthCurve(ctx: CanvasRenderingContext2D, vs: NVector3[], isClosed: boolean) {\n    //\n  }\n  public renderTotalLengthCurve(ctx: CanvasRenderingContext2D, vs: NVector3[], isClosed: boolean) {\n    // let result = 0;\n    for (let i = 0; i < vs.length - 1; ++i) {\n      // result += ALine.DistancefromGeoV(vs[i], vs[i + 1]);\n    }\n    if (isClosed) {\n      // result += ALine.DistancefromGeoV(vs[vs.length - 1], vs[0]);\n    }\n    // ALog.alog.Text = 'Total Length : ' + result.toString() + ' ' + this.geometryBase.scene.annotationViewer.activeCommandController.unit;\n  }\n  public renderRemainLengthByValue(ctx: CanvasRenderingContext2D, v: number, remain: number) {\n    if (remain === 0) {\n      // ALog.alog.Text = 'No Length Remaining';\n    } else {\n      // ALog.alog.Text = 'The Length of Remain of ' + v + ' : ' + remain.toFixed(5).toString() + ' ' + this.geometryBase.scene.annotationViewer.activeCommandController.unit;\n    }\n  }\n  public renderTotalAreaCurve(ctx: CanvasRenderingContext2D, vs: NVector3[], isClosed: boolean) {\n    // let result = 0;\n    for (let i = 0; i < vs.length - 1; ++i) {\n      // result += ALine.DistancefromGeoV(vs[i], vs[i + 1]);\n    }\n    if (isClosed) {\n      // result += ALine.DistancefromGeoV(vs[vs.length - 1], vs[0]);\n    }\n    // ALog.alog.Text = 'Total Area : ' + result.toString() + ' ' + this.geometryBase.scene.annotationViewer.activeCommandController.unit;\n  }\n  // .........\n  public renderTotalLengthInput() {\n    // console.log();\n  }\n}\n","import { Cursor, distanceMouseWithTwoVecs, getDistance, NVector3, isInsideEllipse } from '../../../../../../../lib';\nimport { AGeometryBase } from '../../../../Common/Base/AGeometryBase';\nimport { ACircleWrapper } from '../ACircleWrapper';\n\nexport class InteractionComponent {\n  public geo: AGeometryBase;\n  public host: ACircleWrapper;\n  constructor(geo: AGeometryBase) {\n    this.geo = geo;\n    this.host = geo as ACircleWrapper;\n  }\n  public isMouseInside(x: number, y: number): boolean {\n    const mv = new NVector3(x, y);\n\n    if (this.host.isRemove || !this.host.isRenderable || this.host.isHiddenValue) {\n      return false;\n    }\n    if (this.host.isUnderConstruction === true || this.host.isUnderConstruction === undefined) {\n      return false;\n    }\n    if (this.geo.isCollapse) {\n      return false;\n    }\n    this.host.isRotate = false;\n\n    if (this.isMouseInsidePt(mv)) {\n      return true;\n    }\n\n    if (this.isMouseInsideCPMid(mv) || this.isMouseInsideCP(mv)) {\n      this.host.isHover = true;\n      return true;\n    }\n\n    if (getDistance(this.host.vecRotationHandler, mv) < 10) {\n      this.host.isRotate = true;\n      this.host.isHover = true;\n      return true;\n    }\n\n    if (this.checkDistance(x, y)) {\n      this.host.isHover = true;\n      return true;\n    }\n\n    if (isInsideEllipse(this.host.vec, mv, this.host.width * 0.5, this.host.height * 0.5)) {\n      return true;\n    }\n\n    this.host.isHover = false;\n    return false;\n  }\n  public getLog(): string {\n    // this.UpdateGoeVec();\n    const text =\n      'GUID : ' +\n      this.host.id +\n      '/' +\n      'TYPE : ' +\n      this.host.type.toString() +\n      '/' +\n      // 'PARENT : ' + this.host.edges[0].GetParentType()+'<br>'+\n      // 'Geo : ' + 'lat:' + this.host.geoVec.x.toFixed(5).toString() + ', Log:' + this.host.geoVec.y.toFixed(5).toString() + '/' +\n      'Screen : ' +\n      // this.host.vec.ToString() +\n      '/' +\n      'Area : ' +\n      this.host.getArea().toFixed(3).toString() +\n      ' m2' +\n      '/' +\n      // 'STYLE : ' + this.host.style.toString() + '/' +\n      // 'CONNE :' + this.host.edges.length.toString() + '/' +\n      'IsSEL : ' +\n      this.host.isSelectedValue +\n      '/' +\n      'isSelable : ' +\n      this.host.isSelectable;\n    return text;\n  }\n  public hide(): void {\n    //\n  }\n  private isMouseInsideCPMid(m: NVector3): boolean {\n    for (let i = 0; i < this.host.vecsCP.length; ++i) {\n      if (getDistance(this.host.vecsCP[i], m) < 10) {\n        this.host.vecSelectedCp = i;\n        this.host.isHoverDuplicatedVecs = false;\n        return true;\n      }\n    }\n\n    this.host.vecSelectedCp = -1;\n    return false;\n  }\n  private isMouseInsideCP(m: NVector3): boolean {\n    for (let i = 0; i < this.host.pts.length - 1; ++i) {\n      if (distanceMouseWithTwoVecs(m, this.host.pts[i].vec, this.host.pts[i + 1].vec) < 10) {\n        this.host.isHoverDuplicatedVecs = false;\n        return true;\n      }\n    }\n    return false;\n  }\n  private isMouseInsidePt(m: NVector3): boolean {\n    for (let i = 0; i < this.host.pts.length; ++i) {\n      if (getDistance(this.host.pts[i].vec, m) < 10) {\n        this.host.vecSelected = i;\n        return true;\n      }\n    }\n    this.host.vecSelected = -1;\n    return false;\n  }\n  private checkDistance(x: number, y: number): boolean {\n    return this.geo.scene.annotationInstance.geometryCommon.gcmdProcessing.isMouseInsideByOffScreen(\n      x - this.geo.scene.paramsEditing.croppingMaskParams.x,\n      y - this.geo.scene.paramsEditing.croppingMaskParams.y,\n      this.geo.hashColor\n    );\n    // const mouse = new NVector3(x, y);\n    // const dx = x - this.host.vec.x;\n    // const dy = y - this.host.vec.y;\n    // return (dx * dx) / (this.host.Width  * 0.5  * this.host.Width * 0.5) + (dy * dy) / (this.host.Height  * 0.5  * this.host.Height * 0.5) <= 1.1;\n    // // if (this.type !== GTYPE.POLYLINE) {\n    // let len = this.host.pts.length;\n    // for (let i = 0; i < len; ++i) {\n    //   if (i < len - 1) {\n    //     if (distanceMouseWithTwoVecs(mouse, this.host.pts[i].vec, this.host.pts[i + 1].vec) < this.host.lineWidth) { return true; }\n    //   } else {\n    //     if (distanceMouseWithTwoVecs(mouse, this.host.pts[i].vec, this.host.pts[0].vec) < this.host.lineWidth) { return true; }\n    //   }\n    // }\n    // // ....................................... duplicated polyline or gon\n    // if (this.CheckDistanceDuplication(mouse)) { return true; }\n\n    // // ....................................... end duplicated polyline or gon\n    // if (this.host.isFill) {\n    //   if (IsInsideOfVecs(mouse, this.host.vecs)) { return true; }\n    // }\n    // return false;\n  }\n  public updateActiveMouseCursor(): void {\n    if (this.host.vecSelectedCp > -1) {\n      this.setMouseCursorMidCP();\n    } else {\n      this.setMouseCursorCP();\n    }\n  }\n  private setMouseCursorCP(): void {\n    if (this.host.scene.capturePT) {\n      const index = this.host.pts.indexOf(this.host.scene.capturePT);\n      if (index % 2 === 0) {\n        this.host.scene.annotationInstance.activeCommandController.activeMouseCursor.setActiveCursor(\n          Cursor.NWSEresize\n        );\n      } else {\n        this.host.scene.annotationInstance.activeCommandController.activeMouseCursor.setActiveCursor(\n          Cursor.NESWresize\n        );\n      }\n    } else {\n      this.host.scene.annotationInstance.activeCommandController.activeMouseCursor.setActiveCursorDrag();\n    }\n  }\n  private setMouseCursorMidCP(): void {\n    if (this.host.vecSelectedCp === -1) {\n      this.host.scene.annotationInstance.activeCommandController.activeMouseCursor.setActiveCursorDrag();\n    }\n    if (this.host.vecSelectedCp % 2 === 0) {\n      this.host.scene.annotationInstance.activeCommandController.activeMouseCursor.setActiveCursor(\n        Cursor.NSresize\n      );\n    } else {\n      this.host.scene.annotationInstance.activeCommandController.activeMouseCursor.setActiveCursor(\n        Cursor.EWresize\n      );\n    }\n  }\n\n  // .............................................................................. Leaderline\n  public isMouseInsideSnapFrom(v: NVector3): NVector3 | undefined {\n    this.host.vecSelectedSnapping = undefined;\n    for (let i = 0; i < this.host.vecsCP.length; i += 1) {\n      const dis = getDistance(this.host.vecsCP[i], v);\n      if (\n        dis <\n        this.host.scene.annotationInstance.activeCommandController.acProperties.toleranceSnapping\n      ) {\n        // const mapVec = this.host.scene.annotationInstance.geometryCommon.gcmdSupporting.toMap(\n        //   this.host.vecsCP[i].x,\n        //   this.host.vecsCP[i].y\n        // );\n        this.host.vecSelectedSnapping = this.host.vecsCP[i];\n        return this.host.vecSelectedSnapping;\n      }\n    }\n    const dis = getDistance(this.host.vec, v);\n    if (\n      dis <\n      this.host.scene.annotationInstance.activeCommandController.acProperties.toleranceSnapping\n    ) {\n      this.host.vecSelectedSnapping = this.host.vec;\n      return this.host.vecSelectedSnapping;\n    }\n    return undefined;\n  }\n  public checkAttachedTextleaderline(): boolean {\n    if (!this.host.textLeaderline || !this.host.textLeaderline.leaderline) {\n      return false;\n    }\n\n    let hasLeaderline = false;\n\n    // find center node having leaderline\n    if (getDistance(this.host.vec, this.host.textLeaderline.leaderline.v2) < 5) {\n      hasLeaderline = true;\n    }\n\n    // find cp node having leaderline\n    for (let i = 0; i < this.host.vecsCP.length; ++i) {\n      if (getDistance(this.host.vecsCP[i], this.host.textLeaderline.leaderline.v2) < 5) {\n        hasLeaderline = true;\n      }\n    }\n    if (hasLeaderline) {\n      return true;\n    }\n    this.host.textLeaderline.attachedShape = undefined;\n    this.host.textLeaderline = undefined;\n    return false;\n  }\n  public updateLeaderlineSnap(v: NVector3, tor: number): void {\n    this.host.computeCenterVec();\n    this.host.updateVecsCP();\n    if (getDistance(this.host.vec, v) < 5) {\n      this.host.vecSelectedSnapping = this.host.vec;\n      return;\n    }\n    for (let i = 0; i < this.host.vecsCP.length; ++i) {\n      if (getDistance(this.host.vecsCP[i], v) < 5) {\n        this.host.vecSelectedSnapping = this.host.vecsCP[i];\n        return;\n      }\n    }\n  }\n}\n","import { InteractionMode , NVector3 } from '../../../../../../../lib';\nimport { RendererComponent as _RendererComponent } from '../../../../Common/Base/ComponentTemplate/RendererComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { ACircleWrapper } from '../ACircleWrapper';\nexport class RendererComponent extends _RendererComponent {\n  public host: ACircleWrapper;\n  public renderStyle: RenderStyle;\n  public renderStyleNode: RenderStyle;\n\n  // public vecsRendering = [];\n  constructor(host: ACircleWrapper) {\n    super(host);\n    this.host = host;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.interpolateColor.update();\n    this.timer.update();\n    this.timer.updatePopupSummery();\n\n    // if(this.host.enableRotate) {\n    this.host.transformation.updateRotationAbsolute();\n    // }\n\n    if (\n      this.host.scene.annotationInstance.activeCommandController.acProperties.isPanning ||\n      this.host.scene.annotationInstance.activeCommandController.acProperties.extentChanging\n    ) {\n      this.host.computeVec();\n    }\n\n    if (\n      this.host.scene.annotationInstance.activeCommandController.acProperties.showUnit &&\n      this.host.isConstraintRatio &&\n      this.host.isHoverValue\n    ) {\n      ctx.textAlign = 'center';\n      ctx.fillStyle = '#ffffff';\n      if (100 < Math.abs(this.host.width)) {\n        ctx.fillText('constrained by ratio', this.host.vec.x, this.host.vec.y);\n      }\n      // ALog.alog.Text = 'Total Length : is con';\n    }\n\n    if (this.host.scene.annotationInstance.activeCommandController.acProperties.showUnit) {\n      if (this.host.isHoverValue || this.host.isUnderConstruction) {\n        this.host.dimension.renderLengthRect(ctx, this.host.vecs);\n        if (this.host.isConstraintRatio) {\n          this.host.dimension.renderTotalAreaRect(ctx, this.host.vecs, ', constrained by ratio');\n        } else {\n          this.host.dimension.renderTotalAreaRect(ctx, this.host.vecs);\n        }\n      }\n    }\n\n    /* center point\n    ctx.fillStyle = '#ff0000';\n    ctx.beginPath();\n    ctx.arc(this.host.vec.x, this.host.vec.y, 10, 0 , Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n    */\n\n    // this.GetRelatedVec();\n    // this.ComputeCenterVec();\n    // if (this.scene.annotationInstance.implementation.app.model.activeCommands.isViewChanging) {\n    //     this.ComputeCenterVec();\n    // }\n    // console.log(this.ResizeConstraintRatio());\n\n    // if (this.scene.annotationInstance.implementation.app.versionJSAPI === '4.8') {\n    //     if (this.wrapping.needWrappingDuplicate) {\n    //         this.RenderPostGeometryDuplicationCustom(ctx);\n    //     } else {\n    //         this.RenderPostGeometry(ctx, this.GetVecs());\n    //     }\n    // } else {\n    // this.host.wrapping.UpdateProjectionShapes(this.host.GetVecs());\n\n    this.renderPostGeometry(ctx, this.host.scene.annotationInstance.geometryCommon.gcmdSupporting.toScreenVecsOnCropping(this.host.getVecs()));\n  }\n  private renderPostGeometry(ctx: CanvasRenderingContext2D, vecs: NVector3[]) {\n\n\n//     this.vecsRendering = this.host.scene.annotationInstance.geometryCommon.gcmdSupporting.toScreenVecsOnCropping(this.host.vecs);\n// console.log(this.vecsRendering)\n    const cv = this.host.scene.annotationInstance.geometryCommon.gcmdSupporting.toScreenVecOnCropping(this.host.vec);\n\n    const width = Math.abs(this.host.vecsCP[1].x - this.host.vecsCP[0].x);\n    const height = Math.abs((this.host.vecsCP[2].y - this.host.vecsCP[0].y) * 0.5);\n\n    this.host.updateVecsCP();\n\n    // console.log(this.isFill);\n    // this.isFill = t;\n\n    if (this.host.isHoverValue || this.host.isSelectedValue) {\n      this.host.scene.annotationInstance.renderer.draw.shape.area.ellipseHover(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        cv.x,\n        cv.y,\n        width,\n        height,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.host.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.host.renderer.tOver),\n        this.host.isHoverValue,\n        this.host.isSelectedValue,\n      );\n      this.host.renderer.tOver += this.host.scene.annotationInstance.renderer.dt;\n      this.host.renderer.tDown1 = 0;\n      this.host.isLeave = true;\n      if (\n        this.host.scene.annotationInstance.implementations.app.model.appCoreWrapper.appControllerStatus\n          .mode === InteractionMode.Drawing\n      ) {\n        if (this.host.enableRotate) {\n          this.renderRotationHandler(ctx);\n        }\n      }\n    } else {\n      this.host.renderer.tOver = 0;\n    }\n    const localTint = false;\n    if (localTint) {\n      this.host.scene.annotationInstance.renderer.draw.shape.area.ellipseLocalTint(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        cv.x,\n        cv.y,\n        width,\n        height,\n        true,\n        true,\n        false\n      );\n    } else {\n      this.host.scene.annotationInstance.renderer.draw.shape.area.ellipse(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        cv.x,\n        cv.y,\n        width,\n        height,\n        true,\n        true,\n        false\n      );\n    }\n\n    if (this.host.isHoverValue || this.host.isSelectedValue || this.host.isUnderConstruction) {\n      if (this.host.scene.annotationInstance.implementations.app.model.appCoreWrapper.appControllerStatus.mode === InteractionMode.Drawing) {\n        this.host.scene.annotationInstance.renderer.draw.shape.point.centerPointCircle(ctx, cv.x, cv.y);\n        this.renderBoundingBox(ctx, vecs);\n        this.renderCP(ctx, this.host.vecsCP);\n      }\n    }\n    this.t += this.host.scene.annotationInstance.renderer.dt;\n    this.renderPostGeometryOffScreen(cv);\n  }\n  private renderCP(ctx: CanvasRenderingContext2D, vecsCP: NVector3[]) {\n    if (\n      (this.host.scene.annotationInstance.implementations.app.model.appCoreWrapper.appControllerStatus.mode === InteractionMode.Drawing &&\n      this.host.isHoverValue) ||\n      this.host.isSelectedValue ||\n      this.host.isUnderConstruction\n    ) {\n      for (let i = 0; i < vecsCP.length; ++i) {\n        const v = this.host.scene.annotationInstance.geometryCommon.gcmdSupporting.toScreenVecOnCropping(vecsCP[i]);\n        this.host.scene.annotationInstance.renderer.draw.shape.node.nodeHover(\n          ctx,\n          this.host.pts[0].styleComponent.renderStyle,\n          v.x,\n          v.y,\n          this.host.scene.annotationInstance.graphicsCoreWrapper.scaleScreenByRatioImageSize,\n          // this.host.pts[0].styleComponent.renderStyle.scaleLocal * this.geo.scene.annotationInstance.activeCommandController.scaleGlobal,\n          1\n        );\n      }\n    }\n  }\n  private renderPostGeometryOffScreen(v: any) {\n    this.host.scene.annotationInstance.renderer.offscreen.ellipseOffScreen(\n      this.host.scene.annotationInstance.renderer.ctxOffscreen,\n      this.host.styleComponent.renderStyle,\n      this.host.hashColor,\n      v.x,\n      v.y,\n      Math.abs(this.host.width) * 0.5,\n      Math.abs(this.host.height) * 0.5,\n      this.host.isFill\n    );\n  }\n  private renderBoundingBox(ctx: CanvasRenderingContext2D, vs: NVector3[]) {\n    ctx.globalAlpha = 1.0;\n    ctx.lineWidth = 1; // this.host.styleComponent.renderStyle.lineWidth;\n    ctx.strokeStyle = this.host.styleComponent.renderStyle.colorStroke;\n    ctx.beginPath();\n    ctx.moveTo(vs[0].x, vs[0].y);\n    ctx.lineTo(vs[1].x, vs[1].y);\n    ctx.lineTo(vs[2].x, vs[2].y);\n    ctx.lineTo(vs[3].x, vs[3].y);\n    ctx.closePath();\n    ctx.stroke();\n  }\n  private renderRotationHandler(ctx: CanvasRenderingContext2D) {\n    if (this.host.isHover) {\n      if (this.host.enableRotate) {\n        this.host.transformation.updateRotationHandler();\n      }\n      ctx.strokeStyle = this.host.styleComponent.renderStyle.colorStroke;\n      ctx.beginPath();\n      ctx.moveTo(this.host.vecRotationHandler.x, this.host.vecRotationHandler.y);\n      ctx.lineTo(\n        this.host.vecs[0].x + (this.host.vecs[1].x - this.host.vecs[0].x) * 0.5,\n        this.host.vecs[0].y + (this.host.vecs[1].y - this.host.vecs[0].y) * 0.5\n      );\n      ctx.closePath();\n      ctx.stroke();\n\n      // this.host.scene.annotationInstance.renderer.draw.shape.node.NodeHover(ctx, this.host.styleComponent.renderStyle,\n      //   this.host.vecRotationHandler.x, this.host.vecRotationHandler.y, 1, 1\n      //   );\n\n      ctx.fillStyle = this.host.styleComponent.renderStyle.colorStroke;\n      ctx.beginPath();\n      ctx.arc(this.host.vecRotationHandler.x, this.host.vecRotationHandler.y, 7, 0, Math.PI * 2);\n      ctx.closePath();\n      ctx.fill();\n    }\n  }\n  // RenderPostGeometryDuplicationCustom(ctx: CanvasRenderingContext2D) {\n\n  //     this.vecOthersCustom = this.wrapping.ComputeWrappingDuplicationCustom(this.GetVecs());\n\n  //     if (this.scene.annotationInstance.activeCommandController.showUnit) {\n  //         if (this.vecOthersCustom !== undefined) {\n  //             const dimVec = this.vecOthersCustom[1];\n  //             if (dimVec.length > 1) {\n  //                 if (this.isHover || this.isUnderConstruction) {\n  //                     this.dimension.RenderLengthRect(ctx, dimVec);\n  //                     if (this.isConstraintRatio) {\n  //                         this.dimension.RenderTotalAreaRect(ctx, dimVec, ', constrained by ratio');\n  //                     } else {\n  //                         this.dimension.RenderTotalAreaRect(ctx, dimVec);\n  //                     }\n  //                 }\n  //             }\n  //         }\n  //     }\n\n  //     if (this.vecOthersCustom && this.vecOthersCustom.length > 0) {\n  //         if (this.isHover || this.isSelected) {\n  //             this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVecHover(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[0], this.isGrayColor, this.visibility, NumericalMotion.easeOutElastic2(this.renderer.tOver), this.isHover);\n  //             this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVec(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[0], this.isUndo, this.isGrayColor, this.visibility);\n  //             this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVecNode(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[0], this.isGrayColor, this.visibility, NumericalMotion.easeOutElastic2(this.renderer.tOver), this.isHover);\n\n  //             if (this.vecOthersCustom[1].length > 0) {\n  //                 this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVecHover(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[1], this.isGrayColor, this.visibility, NumericalMotion.easeOutElastic2(this.renderer.tOver), this.isHover);\n  //                 this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVec(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[1], this.isUndo, this.isGrayColor, this.visibility);\n  //                 this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVecNode(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[1], this.isGrayColor, this.visibility, NumericalMotion.easeOutElastic2(this.renderer.tOver), this.isHover);\n  //             }\n  //         } else {\n  //             this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVec(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[0], this.isUndo, this.isGrayColor, this.visibility);\n  //             if (this.vecOthersCustom[1].length > 0) {\n  //                 this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVec(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[1], this.isUndo, this.isGrayColor, this.visibility);\n  //             }\n  //         }\n  //     }\n  // }\n}\n","import { ThemeColorId } from '../../../../../Customization/ThemeRenderStyle/Utility';\nimport { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { ACircleWrapper } from '../ACircleWrapper';\nexport class StyleComponent extends _StyleComponent {\n  public geo: ACircleWrapper;\n  constructor(geo: ACircleWrapper) {\n    super(geo);\n    this.updateStyle();\n    this.updateColor();\n  }\n  public updateStyle() {\n    if (!this.isCustom) {\n      this.state.themeColorId = ThemeColorId.AccentColor1;\n      this.isCustom = true;\n      RenderStyle.updateRenderStylePolygon(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n      RenderStyle.updateRenderStylePolygonNode(\n        this.renderStyleNode,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n      for (let i = 0; i < this.geo.pts.length; ++i) {\n        this.geo.pts[i].styleComponent.updateStyleForNode(this.renderStyleNode);\n      }\n    }\n  }\n  public updateColor(color: number[] | undefined = undefined) {\n    this.isCustom = true;\n    if (color === undefined) {\n      color = this.geo.scene.annotationInstance.activeCommandController.activeColorController.activeColor;\n    }\n    RenderStyle.updateRenderColorPolygon(\n      this.renderStyle,\n      this.geo.scene.annotationInstance.customization.themeCurrent,\n      color,\n      [0,0,0,0]\n    );\n    RenderStyle.updateRenderColorPolygonNode(\n      this.renderStyleNode,\n      this.geo.scene.annotationInstance.customization.themeCurrent,\n      color\n    );\n    for (let i = 0; i < this.geo.pts.length; ++i) {\n      this.geo.pts[i].styleComponent.updateStyleForNode(this.renderStyleNode);\n    }\n    this.tempColorRgba = color;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public updateStyleCustom(style: any): boolean {\n    // if (this.isSameStyle(style)) {\n    //   return false;\n    // }\n    const needEmit = false;\n\n    if (style.width) {\n      this.state.width = style.width;\n    }\n    if (style.color !== undefined) {\n      this.state.themeColorId = style.color as ThemeColorId;\n    }\n\n    if (style.colorRgba.length > 0 && style.fill.length > 0) {\n      this.tempColorRgba = style.colorRgba;\n      this.tempFillRgba = style.fill;\n      RenderStyle.updateRenderStylePolygonCustom(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent,\n        style.colorRgba,\n        style.fill\n      );\n      RenderStyle.updateRenderStylePolygonNodeCustom(\n        this.renderStyleNode,\n        this.geo.scene.annotationInstance.customization.themeCurrent,\n        style.colorRgba,\n        style.fill\n      );\n      for (let i = 0; i < this.geo.pts.length; ++i) {\n        this.geo.pts[i].styleComponent.updateStyleForNode(this.renderStyleNode);\n      }\n    }\n    if (style.scale) {\n      this.renderStyle.scaleLocal = style.scale;\n      this.state.scale = style.scale;\n    }\n    this.isCustom = true;\n    if (needEmit && !this.geo.isUnderConstruction) {\n      this.geo.isTransform = true;\n    }\n    return true;\n  }\n  public setDash(v: number[]) {\n    this.renderStyle.dash = v;\n    this.geo.scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n      this.geo.toJSON()\n    );\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public toJson(): any | undefined {\n    if (!this.isCustom) {\n      return undefined;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const output: any = {\n      width: this.state.width,\n      scale: this.renderStyle.scaleLocal,\n      // this is necessary for updating state on React side\n      colorRgba: this.tempColorRgba,\n      fill: this.tempFillRgba,\n    };\n    if (this.state.themeColorId !== ThemeColorId.AccentColor1) {\n      output.color = this.state.themeColorId;\n    }\n    return output;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  protected isSameStyle(style: any) {\n    if (\n      style.colorRgba.length === this.tempColorRgba.length ||\n      style.fill.length === this.tempFillRgba\n    ) {\n      for (let i = 0; i < style.colorRgba.length; i++) {\n        if (style.colorRgba[i] !== this.tempColorRgba[i]) {\n          return false;\n        }\n      }\n      for (let i = 0; i < style.fill.length; i++) {\n        if (style.fill[i] !== this.tempFillRgba[i]) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n}\n","import { MouseEventData } from '../../../../../../../../lib/EventData/MouseEventData';\nimport { AGeometryBase } from '../AGeometryBase';\nexport class TransformationComponent {\n  public geo: AGeometryBase;\n  constructor(geo: AGeometryBase) {\n    this.geo = geo;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    /* */\n  }\n  public translate(x: number, y: number): void {\n    /* */\n  }\n  public move(x: number, y: number): void {\n    /* */\n  }\n}\n","import {\n  MouseEventData,\n  getRatioByNewHeight,\n  getRatioByNewWidth,\n  crossProduct,\n  getDistance,\n  moveVecs,\n  NVector3,\n  rotateVecs,\n} from '../../../../../../../lib';\nimport { AGeometryBase } from '../../../../Common/Base/AGeometryBase';\nimport { TransformationComponent as _TransformationComponent } from '../../../../Common/Base/ComponentTemplate/TransformationComponent';\nimport { ACircleWrapper } from '../ACircleWrapper';\nexport class TransformationComponent extends _TransformationComponent {\n  public geo: AGeometryBase;\n  public host: ACircleWrapper;\n  public v: NVector3;\n  public anglePre = 0.0;\n  public angle = 0.0;\n  constructor(geo: AGeometryBase) {\n    super(geo);\n    this.geo = geo;\n    this.host = geo as ACircleWrapper;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    // console.log(e);\n\n    if (this.host.vecSelected > -1) {\n      this.translateByMouseEventDataNode(e, this.host.vecSelected);\n      return;\n    }\n\n    if (this.host.isRotate) {\n      this.rotatingShape(e.x, e.y);\n      return;\n    }\n    if (this.host.isRemove || !this.host.isRenderable || this.host.isHiddenValue) {\n      return;\n    }\n    const xo = e.x - e.preX;\n    const yo = e.y - e.preY;\n\n    if (this.host.vecSelectedCp !== -1) {\n      this.translateCPByMouseEventData(e);\n      this.host.computeCenterVec();\n      this.updateTextleaderlineVec();\n      return;\n    }\n    if (this.host.vecSelected !== -1) {\n      this.host.pts[this.host.vecSelected].translateByMouseEventData(e);\n      this.host.computeCenterVec();\n      this.updateTextleaderlineVec();\n      return;\n    }\n\n    for (let i = 0; i < this.host.pts.length; ++i) {\n      this.host.pts[i].vec.x += xo;\n      this.host.pts[i].vec.y += yo;\n      // this.host.pts[i].UpdateGoeVec();\n    }\n    this.host.computeCenterVec();\n\n    if (this.host.textLeaderline) {\n      // Safeguard: resize rect and circle with the attached leaderline\n      // If it has a Textleaderline, it try to re-find the vec, in case that it has undefined vec.\n      if (!this.host.vecSelectedSnapping) {\n        this.host.updateLeaderlineSnap(this.host.textLeaderline.vec, 5);\n      }\n      // end Safeguard: resize rect and circle with the attached leaderline\n\n      this.updateTextleaderlineVec();\n      this.host.textLeaderline.translateByMouseEventData(e);\n    }\n  }\n  public translate(x: number, y: number): void {\n    // if (this.vecSelected !== -1) {\n    //     this.pts[this.vecSelected].Translate(e);\n    //     return;\n    // }\n    // if (this.isRemove || !this.isRenderable || this.isHidden) { return; }\n    // let xo = e.x - e.preX;\n    // let yo = e.y - e.preY;\n    // for (let i = 0; i < this.pts.length; ++i) {\n    //     this.pts[i].vec.x += xo;\n    //     this.pts[i].vec.y += yo;\n    //     this.pts[i].UpdateGoeVec();\n    // }\n    // this.ComputeCenterVec();\n  }\n  public updateRotationAbsolute(): void {\n    this.angle =\n      (Math.atan2(\n        this.host.vecRotationHandler.y - this.host.vec.y,\n        this.host.vecRotationHandler.x - this.host.vec.x\n      ) *\n        180) /\n      Math.PI;\n  }\n  private translateCPByMouseEventData(e: MouseEventData): void {\n    if (this.host.vecSelectedCp === 0) {\n      const y = e.y - this.host.pts[0].vec.y;\n      this.host.pts[0].vec.y += y;\n      this.host.pts[1].vec.y += y;\n      if (this.host.height < 16) {\n        this.host.pts[0].vec.y -= y;\n        this.host.pts[1].vec.y -= y;\n      }\n      // this.host.pts[0].UpdateGoeVec();\n      // this.host.pts[1].UpdateGoeVec();\n    } else if (this.host.vecSelectedCp === 2) {\n      const y = e.y - this.host.pts[2].vec.y;\n      this.host.pts[2].vec.y += y;\n      this.host.pts[3].vec.y += y;\n      if (this.host.height < 16) {\n        this.host.pts[2].vec.y -= y;\n        this.host.pts[3].vec.y -= y;\n      }\n      // this.host.pts[2].UpdateGoeVec();\n      // this.host.pts[3].UpdateGoeVec();\n    } else if (this.host.vecSelectedCp === 1) {\n      const x = this.host.isHoverDuplicatedVecs ? e.x : e.x - this.host.pts[1].vec.x;\n      this.host.pts[1].vec.x += x;\n      this.host.pts[2].vec.x += x;\n      if (this.host.width < 16) {\n        this.host.pts[1].vec.x -= x;\n        this.host.pts[2].vec.x -= x;\n      }\n      // this.host.pts[1].UpdateGoeVec();\n      // this.host.pts[2].UpdateGoeVec();\n    } else if (this.host.vecSelectedCp === 3) {\n      const x = this.host.isHoverDuplicatedVecs ? e.x : e.x - this.host.pts[0].vec.x;\n      this.host.pts[0].vec.x += x;\n      this.host.pts[3].vec.x += x;\n      if (this.host.width < 16) {\n        this.host.pts[0].vec.x -= x;\n        this.host.pts[3].vec.x -= x;\n      }\n      // this.host.pts[0].UpdateGoeVec();\n      // this.host.pts[3].UpdateGoeVec();\n    }\n  }\n  public translateByMouseEventDataNode(e: MouseEventData, i: number): void {\n    for (let i = 0; i < this.host.pts.length; ++i) {\n      this.host.pts[i].isRenderable = true;\n    }\n\n    // ............. Safeguard: resize rect and circle with the attached leaderline\n    // ............. If it has a Textleaderline, it try to re-find the vec, in case that it has undefined vec.\n    if (this.host.textLeaderline && !this.host.vecSelectedSnapping) {\n      this.host.updateLeaderlineSnap(this.host.textLeaderline.vec, 5);\n    }\n    // ............. end Safeguard: resize rect and circle with the attached leaderline\n\n    let xOff = e.x - e.preX;\n    let yOff = e.y - e.preY;\n\n    if (i === 0 || i === 2) {\n      if (Math.abs(xOff) > Math.abs(yOff)) {\n        yOff = xOff;\n      } else {\n        xOff = yOff;\n      }\n    } else if (i === 1 || i === 3) {\n      if (Math.abs(xOff) > Math.abs(yOff)) {\n        yOff = xOff * -1;\n      } else {\n        xOff = yOff * -1;\n      }\n    }\n\n    if (this.host.isConstraintRatio) {\n      this.computeConstraintRatio(i, xOff, yOff);\n    } else {\n      if (i === 0) {\n        this.translatePt(0, xOff, yOff);\n        this.translatePt(3, xOff, 0);\n        this.translatePt(1, 0, yOff);\n        if (this.host.width < 16 || this.host.height < 16) {\n          this.translatePt(0, -xOff, -yOff);\n          this.translatePt(3, -xOff, 0);\n          this.translatePt(1, 0, -yOff);\n        }\n      } else if (i === 1) {\n        this.translatePt(1, xOff, yOff);\n        this.translatePt(2, xOff, 0);\n        this.translatePt(0, 0, yOff);\n        if (this.host.width < 16 || this.host.height < 16) {\n          this.translatePt(1, -xOff, -yOff);\n          this.translatePt(2, -xOff, 0);\n          this.translatePt(0, 0, -yOff);\n        }\n      } else if (i === 2) {\n        this.translatePt(2, xOff, yOff);\n        this.translatePt(1, xOff, 0);\n        this.translatePt(3, 0, yOff);\n        if (this.host.width < 16 || this.host.height < 16) {\n          this.translatePt(2, -xOff, -yOff);\n          this.translatePt(1, -xOff, 0);\n          this.translatePt(3, 0, -yOff);\n        }\n      } else if (i === 3) {\n        this.translatePt(3, xOff, yOff);\n        this.translatePt(0, xOff, 0);\n        this.translatePt(2, 0, yOff);\n        if (this.host.width < 16 || this.host.height < 16) {\n          this.translatePt(3, -xOff, -yOff);\n          this.translatePt(0, -xOff, 0);\n          this.translatePt(2, 0, -yOff);\n        }\n      }\n    }\n    this.host.computeCenterVec();\n    // this.host.UpdateGeoPos();\n    // this.host.pts[i].UpdateGoeVec();\n    // node.UpdateGoeVec();\n    this.host.transformation.updateTextleaderlineVec();\n    return;\n  }\n  private translatePt(i: number, x = 0, y = 0): void {\n    this.host.pts[i].vec.x += x;\n    this.host.pts[i].vec.y += y;\n    return;\n  }\n  public updateTextleaderlineVec(): void {\n    let offset = 0;\n    if (\n      this.host.vecSelectedSnapping &&\n      this.host.textLeaderline &&\n      this.host.textLeaderline.leaderline\n    ) {\n      offset = this.host.textLeaderline.leaderline.v2.x - this.host.vecSelectedSnapping.x;\n      this.host.textLeaderline.leaderline.v2.x = this.host.vecSelectedSnapping.x;\n      this.host.textLeaderline.widthOffset += offset;\n\n      offset = this.host.textLeaderline.leaderline.v2.y - this.host.vecSelectedSnapping.y;\n      this.host.textLeaderline.leaderline.v2.y = this.host.vecSelectedSnapping.y;\n      this.host.textLeaderline.heightOffset += offset;\n\n      this.host.textLeaderline.computeCenterVec(); // before update UpdateVecsHistory, we need to keep tracking vecs for transformation stack\n    }\n  }\n  private rotatingShape(x: number, y: number): void {\n    const angle = (Math.atan2(y - this.host.vec.y, x - this.host.vec.x) * 180) / Math.PI;\n    // this.anglePre = angle;\n    // const theAngle = this.anglePre - angle;\n    const angleRelative = angle - this.angle;\n\n    let vecs = this.rotateVecsLoal([this.host.vecRotationHandler], this.host.vec, angleRelative);\n    this.host.vecRotationHandler.x = vecs[0].x;\n    this.host.vecRotationHandler.y = vecs[0].y;\n    this.host.vecRotationHandler.z = vecs[0].z;\n\n    vecs = this.rotateVecsLoal(this.host.vecs, this.host.vec, angleRelative);\n    this.host.vecs[0].x = vecs[0].x;\n    this.host.vecs[0].y = vecs[0].y;\n    this.host.vecs[0].z = vecs[0].z;\n    this.host.vecs[1].x = vecs[1].x;\n    this.host.vecs[1].y = vecs[1].y;\n    this.host.vecs[1].z = vecs[1].z;\n    this.host.vecs[2].x = vecs[2].x;\n    this.host.vecs[2].y = vecs[2].y;\n    this.host.vecs[2].z = vecs[2].z;\n    this.host.vecs[3].x = vecs[3].x;\n    this.host.vecs[3].y = vecs[3].y;\n    this.host.vecs[3].z = vecs[3].z;\n\n    this.angle += angleRelative;\n    // this.host.UpdateGeoVec();\n  }\n  private rotateVecsLoal(vecs: NVector3[], cv: NVector3, angle: number): NVector3[] {\n    const cptToWorld = new NVector3(-cv.x, -cv.y, -cv.z);\n    let temp: NVector3[] = moveVecs(vecs, cptToWorld);\n    temp = rotateVecs(temp, angle);\n    temp = moveVecs(temp, cv);\n    return temp;\n  }\n  public updateRotationHandler() {\n    this.host.vecRotationHandler.x =\n      this.host.vecs[0].x + (this.host.vecs[1].x - this.host.vecs[0].x) * 0.5;\n    this.host.vecRotationHandler.y =\n      this.host.vecs[0].y + (this.host.vecs[1].y - this.host.vecs[0].y) * 0.5;\n\n    const pV = crossProduct(this.host.vecs[0], this.host.vecs[1]);\n    // console.log(this.host.transformation.angle / 180 * Math.PI);\n    const dirV = new NVector3(\n      this.host.vecs[1].x - this.host.vecs[0].x,\n      this.host.vecs[1].y - this.host.vecs[0].y,\n      this.host.vecs[1].z - this.host.vecs[0].z\n    );\n    const offV = crossProduct(pV, dirV);\n    offV.unitize();\n\n    this.host.vecRotationHandler.x += offV.x * 20;\n    this.host.vecRotationHandler.y += offV.y * 20;\n\n    if (getDistance(this.host.vec, this.host.vecRotationHandler) < this.host.height * 0.5) {\n      this.host.vecRotationHandler.x += -offV.x * 40;\n      this.host.vecRotationHandler.y += -offV.y * 40;\n    } else {\n      // this.host.vecRotationHandler.x += offV.x * 20;\n      // this.host.vecRotationHandler.y += offV.y * 20;\n    }\n  }\n  // public UpdateTextLeaderline(e: MouseEventData) {\n  //   if (this.geo.textLeaderline) {\n  //     this.geo.textLeaderline.TranslateByMouseEventData(e);\n  //     if (this.geo.textLeaderline && this.geo.textLeaderline.leaderline) {\n  //       // this.geo.textLeaderline.leaderline.v2.x += xo;\n  //       // this.geo.textLeaderline.leaderline.v2.y += yo;\n  //       // let v = this.geo.scene.annotationInstance.geometryCommon.gcmdSupporting.ToMap(this.geo.textLeaderline.leaderline.v2.x, this.geo.textLeaderline.leaderline.v2.y);\n  //       // this.geo.textLeaderline.leaderline.v2.long = v[0];\n  //       // this.geo.textLeaderline.leaderline.v2.lat = v[1];\n  //       // this.geo.textLeaderline.leaderline.v2.proX = v[2];\n  //       // this.geo.textLeaderline.leaderline.v2.proY = v[3];\n  //       //   if (this.geo.textLeaderline.leaderline && this.geo.graphCore.selVecForTextLeaderline) {\n  //       //     this.geo.textLeaderline.leaderline.v2.x = this.geo.graphCore.selVecForTextLeaderline.x;\n  //       //     this.geo.textLeaderline.leaderline.v2.y = this.geo.graphCore.selVecForTextLeaderline.y;\n  //       //   }\n  //     }\n  //   }\n  // }\n  public computeConstraintRatio(i: number, xOff: number, yOff: number): void {\n    const ratio = this.resizeConstraintRatio();\n\n    if (i === 0) {\n      if (Math.abs(xOff) > Math.abs(yOff)) {\n        const newRatio = getRatioByNewWidth(ratio[0], ratio[1], ratio[0] + xOff);\n        this.host.pts[i].vec.x += xOff;\n        this.host.pts[i].vec.y -= ratio[1] - newRatio[1];\n        this.host.pts[i + 1].vec.y -= ratio[1] - newRatio[1];\n        this.host.pts[i + 3].vec.x += xOff;\n      } else {\n        const newRatio = getRatioByNewHeight(ratio[0], ratio[1], ratio[1] + yOff);\n        this.host.pts[i].vec.x -= ratio[0] - newRatio[0];\n        this.host.pts[i].vec.y += yOff;\n        this.host.pts[i + 1].vec.y += yOff;\n        this.host.pts[i + 3].vec.x -= ratio[0] - newRatio[0];\n      }\n    } else if (i === 1) {\n      if (Math.abs(xOff) > Math.abs(yOff)) {\n        this.host.pts[i].vec.x += xOff;\n        const newRatio = getRatioByNewWidth(ratio[0], ratio[1], ratio[0] + xOff);\n        this.host.pts[i].vec.y += ratio[1] - newRatio[1];\n        this.host.pts[i + 1].vec.x += xOff;\n        this.host.pts[i - 1].vec.y += ratio[1] - newRatio[1];\n      } else {\n        const newRatio = getRatioByNewHeight(ratio[0], ratio[1], ratio[1] + yOff);\n        this.host.pts[i].vec.x += ratio[0] - newRatio[0];\n        this.host.pts[i].vec.y += yOff;\n        this.host.pts[i + 1].vec.x += ratio[0] - newRatio[0];\n        this.host.pts[i - 1].vec.y += yOff;\n      }\n    } else if (i === 2) {\n      if (Math.abs(xOff) > Math.abs(yOff)) {\n        const newRatio = getRatioByNewWidth(ratio[0], ratio[1], ratio[0] + xOff);\n        this.host.pts[i].vec.x += xOff;\n        this.host.pts[i].vec.y = this.host.pts[0].vec.y + newRatio[1];\n        this.host.pts[i - 1].vec.x += xOff;\n        this.host.pts[i + 1].vec.y = this.host.pts[0].vec.y + newRatio[1];\n      } else {\n        const newRatio = getRatioByNewHeight(ratio[0], ratio[1], ratio[1] + yOff);\n        this.host.pts[i].vec.x = this.host.pts[0].vec.x + newRatio[0];\n        this.host.pts[i].vec.y += yOff;\n        this.host.pts[i - 1].vec.x = this.host.pts[0].vec.x + newRatio[0];\n        this.host.pts[i + 1].vec.y += yOff;\n      }\n    } else if (i === 3) {\n      if (Math.abs(xOff) > Math.abs(yOff)) {\n        const newRatio = getRatioByNewWidth(ratio[0], ratio[1], ratio[0] + xOff);\n        this.host.pts[i].vec.x += xOff;\n        this.host.pts[i].vec.y += ratio[1] - newRatio[1];\n        this.host.pts[i - 1].vec.y += ratio[1] - newRatio[1];\n        this.host.pts[0].vec.x += xOff;\n      } else {\n        const newRatio = getRatioByNewHeight(ratio[0], ratio[1], ratio[1] + yOff);\n        this.host.pts[i].vec.x += ratio[0] - newRatio[0];\n        this.host.pts[i].vec.y += yOff;\n        this.host.pts[i - 1].vec.y += yOff;\n        this.host.pts[0].vec.x += ratio[0] - newRatio[0];\n      }\n    }\n  }\n  private resizeConstraintRatio(): number[] {\n    const xx = this.host.pts[1].vec.x - this.host.pts[0].vec.x;\n    const yy = this.host.pts[2].vec.y - this.host.pts[1].vec.y;\n    return [xx, yy];\n  }\n}\n","import { IOGeometry } from '../../../../../../lib/Extended/GeometryUtility';\nimport {\n  MouseEventData,\n  getBoundingByVecs,\n  getCenterVecFromVecs,\n  getDistance,\n  NVector3,\n  GType,\n} from '../../../../../../lib';\nimport { Scene } from '../../../../Scene';\nimport { AGeometryBase } from '../../../Common/Base/AGeometryBase';\nimport { APointBase } from '../../../Common/Base/APointBase';\nimport { APoint } from '../../FamilyPoint/Base/APoint';\nimport { Dimension } from '../../Helper/Dimension';\nimport { ARectangleWrapper } from '../ARectangleWrapper/ARectangleWrapper';\nimport { InteractionComponent } from './Component/InteractionComponent';\nimport { RendererComponent } from './Component/RendererComponent';\nimport { StyleComponent } from './Component/StyleComponent';\nimport { TransformationComponent } from './Component/TransformationComponent';\nexport class ACircleWrapper extends AGeometryBase {\n  public static isDone = false;\n  public static split = false;\n  public static construction: ACircleWrapper | undefined;\n  public static isConstraintRatio = false;\n\n  public interaction: InteractionComponent;\n  public transformation: TransformationComponent;\n\n  public pts: APoint[];\n  public vecsCP: NVector3[] = [];\n  public lineWidth: number;\n  public isFill: boolean;\n  public vecRotationHandler: NVector3 = new NVector3(0, 0, 0);\n  public vecs: NVector3[];\n  public isRotate = false;\n  public isConstraintRatio: boolean;\n  public isHoverDuplicatedVecs = false;\n  // ........................... for wrapping\n  // vecOthers: NVector3[];\n  // vecOthersCustom: NVector3[][] | undefined;\n  public vecSelected = -1;\n  public vecSelectedCp = -1;\n  public dimension: Dimension;\n  public enableRotate = false;\n  public static getRectangleFromVoice(scene: Scene) {\n    const cv = new NVector3(\n      scene.annotationInstance.geometryCommon.gcmdProcessing.width * 0.5,\n      scene.annotationInstance.geometryCommon.gcmdProcessing.height * 0.5\n    );\n    this.getRectByVecs(scene, [\n      new NVector3(cv.x - 100, cv.y - 100),\n      new NVector3(cv.x + 100, cv.y - 100),\n      new NVector3(cv.x + 100, cv.y + 100),\n      new NVector3(cv.x - 100, cv.y + 100),\n    ]);\n  }\n  public static findAtPoint(e: MouseEventData): undefined {\n    return undefined;\n  }\n  public static computeOver(e: MouseEventData) {\n    // if (CLine.list.length < 2)return;\n    const obj = ACircleWrapper.findAtPoint(e);\n\n    if (obj !== null) {\n      // obj.over = true;\n      /* */\n    }\n    // console.log('over');\n  }\n  public static getRectByVecs(scene: Scene, vs: NVector3[]) {\n    const cv = getBoundingByVecs(vs);\n    const geo = new ACircleWrapper(scene, cv[0].x, cv[0].y, 0, false);\n    const xx = cv[1].x - cv[0].x;\n    const yy = cv[1].y - cv[0].y;\n    geo.pts[1].vec.x += xx;\n    geo.pts[2].vec.x += xx;\n    geo.pts[2].vec.y += yy;\n    geo.pts[3].vec.y += yy;\n\n    // geo.UpdateGeoPos();\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n    // safeguard for wrapping // do not change it!!\n    geo.updatePos(2, geo.pts[1].vec.x + 1, geo.pts[3].vec.y + 1, 0);\n    scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n  }\n  // public static GetLengthSelection() {\n  //   let i = this.list.length;\n  //   let count = 0;\n  //   while (i--) {\n  //     if (this.list[i].IsSelected) {\n  //       count += 1;\n  //     }\n  //   }\n  //   return count;\n  // }\n  public static getRectByTouch(scene: Scene, e: MouseEventData) {\n    const cv = new NVector3(e.x, e.y, 0);\n    this.getRectByVecs(scene, [\n      new NVector3(cv.x - 100, cv.y - 100),\n      new NVector3(cv.x + 100, cv.y - 100),\n      new NVector3(cv.x + 100, cv.y + 100),\n      new NVector3(cv.x - 100, cv.y + 100),\n    ]);\n  }\n  public static getRect(scene: Scene, e: MouseEventData) {\n    if (ACircleWrapper.construction === undefined) {\n      ACircleWrapper.construction = new ACircleWrapper(scene, e.x, e.y);\n      ACircleWrapper.construction.IsSelectable = false;\n      return;\n    }\n    ACircleWrapper.construction.isUnderConstruction = false;\n    ACircleWrapper.construction.IsSelectable = true;\n    // ACircleWrapper.construction.Translate(e);\n    // ACircleWrapper.construction.UpdateGeoPos();\n\n    // safeguard for wrapping // do not change it!!\n    ACircleWrapper.construction.updatePos(\n      2,\n      ACircleWrapper.construction.pts[1].vec.x,\n      ACircleWrapper.construction.pts[3].vec.y + 0.1,\n      0\n    );\n    // ACircleWrapper.construction.pts[1].vec.x += 1;\n    // ACircleWrapper.construction.pts[3].vec.y += 1;\n\n    scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n      ACircleWrapper.construction.toJSON()\n    );\n    ACircleWrapper.construction = undefined;\n    return;\n  }\n  public static getRectByPt(p: APoint) {\n    /* */\n  }\n  public static drawShadow(scene: Scene, e: MouseEventData) {\n    if (ACircleWrapper.construction === undefined) {\n      const p2 = new APoint(scene, e.x, e.y, 0);\n      p2.isSelectable = false;\n    } else {\n      // ACircleWrapper.construction.ComputeRecPtsWithMouse(e.x, e.y);\n      ACircleWrapper.construction.pts[1].move(e.x, ACircleWrapper.construction.pts[1].vec.y);\n      ACircleWrapper.construction.pts[2].move(e.x, e.y); // TranslateByMouseEventData(e);\n      ACircleWrapper.construction.pts[3].move(ACircleWrapper.construction.pts[3].vec.x, e.y);\n      ACircleWrapper.construction.computeCenterVec();\n      // ACircleWrapper.construction.UpdateGeoVec();\n      // ACircleWrapper.construction.pts[2].UpdateGoeVec();\n    }\n  }\n  // .............................................. geometry mananging common\n  public static fromJSON(scene: Scene, g: IOGeometry, isUndo = false, isDeepCopy = false) {\n    const p = APoint.getNodeFromJSON(scene, g.nodes[0], isUndo);\n    const geo = new ACircleWrapper(scene, p.vec.x, p.vec.y, 0, isUndo);\n    p.remove();\n    for (let i = 1; i < geo.pts.length; ++i) {\n      const v = APoint.getNodeFromJSON(scene, g.nodes[i], isUndo);\n      geo.pts[i].vec.x = v.vec.x;\n      geo.pts[i].vec.y = v.vec.y;\n      geo.pts[i].type = GType.ANODE_CIRCLE;\n      v.remove();\n    }\n    // geo.UpdateGeoPos();\n    geo.type = GType[g.type];\n\n    geo.isHiddenValue = g.isHidden;\n    if (g.isHidden) {\n      geo.visibility = 0;\n    } else {\n      geo.visibility = 1.0;\n    }\n\n    if (g.styles && g.styles.dash) {\n      geo.styleComponent.renderStyle.dash = g.styles.dash;\n    }\n\n    if (isDeepCopy) {\n      geo.id = scene.getUUID();\n    } else {\n      geo.id = g.id;\n    }\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n    geo.isHover = false;\n    if (g.styles) {\n      geo.updateStyleCustom(g.styles);\n    }\n\n    geo.initVecsHistory();\n    geo.computeCenterVec();\n    if (!isUndo) {\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n    }\n    // ARectangle.construction = undefined;\n    return geo;\n  }\n  public static cancel() {\n    if (ACircleWrapper.construction !== undefined) {\n      ACircleWrapper.construction.remove();\n    }\n    ACircleWrapper.construction = undefined;\n  }\n  // ................................... end implementation\n\n  // .................................................................... end implementation\n  public static mouseDown(scene: Scene, e: MouseEventData) {\n    // scene.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.enablePan = false;\n    // ACircleWrapper.GetRect(scene, e);\n    /*\n    if (ACircleWrapper.construction !== undefined) {\n      ACircleWrapper.GetRect(scene, e);\n      ACircleWrapper.construction = undefined;\n      ACircleWrapper.isDone = true;\n    }\n    */\n  }\n  public static onMouseLeftClick(scene: Scene, e: MouseEventData, width = 128, height = 128) {\n    if (ACircleWrapper.construction) {\n      ACircleWrapper.construction.remove();\n    }\n    const shape = new ACircleWrapper(scene, e.x - width * 0.5, e.y - height * 0.5);\n    shape.pts[1].vec.x += width;\n    shape.pts[2].vec.x += width;\n    shape.pts[2].vec.y += height;\n    shape.pts[3].vec.y += height;\n    // shape.UpdateGeoPos();\n    shape.computeCenterVec();\n    shape.IsSelectable = true;\n    shape.isUnderConstruction = false;\n    shape.isHover = false;\n    shape.emitAddStack();\n    scene.annotationInstance.activeCommandController.goToACMode();\n    /*\n    if (scene.annotationInstance.activeCommandController.IsTouchEvent) {\n      this.GetRectByTouch(scene, e);\n      scene.annotationInstance.activeCommandController.SetActiveCommand(ACTIVECOMMAND_MODE.SELECT);\n      return;\n    }\n    if (ACircleWrapper.isDone) {\n      ACircleWrapper.isDone = false;\n      scene.annotationInstance.activeCommandController.GoToACMode();\n      return;\n    }\n    if (scene.capture !== undefined) {\n      return;\n    }\n    if (ACircleWrapper.construction === undefined) {\n      ACircleWrapper.GetRect(scene, e);\n    }\n    */\n  }\n  public static onMouseMiddleClick(e: MouseEventData) {\n    /* */\n  }\n  public static onMouseRightClick(e: MouseEventData) {\n    /* */\n  }\n  public static onMouseDoubleClick(e: MouseEventData) {\n    /* */\n  }\n  // ..........................................\n  public static onMouseMove(scene: Scene, e: MouseEventData) {\n    if (ACircleWrapper.construction !== undefined) {\n      ACircleWrapper.drawShadow(scene, e);\n    }\n  }\n  public static onMouseDrag(scene: Scene, e: MouseEventData) {\n    if (ACircleWrapper.construction !== undefined) {\n      ACircleWrapper.drawShadow(scene, e);\n    } else {\n      scene.annotationInstance.geometryCommon.gcmdSelecting.deSelectAllObjects();\n      ACircleWrapper.getRect(scene, e);\n    }\n  }\n  public static onMouseUp(scene: Scene, e: MouseEventData) {\n    if (ACircleWrapper.construction) {\n      ACircleWrapper.swap(ACircleWrapper.construction);\n      scene.annotationInstance.activeCommandController.goToACMode();\n      ACircleWrapper.construction.IsSelectable = true;\n      ACircleWrapper.construction.isUnderConstruction = false;\n      ACircleWrapper.construction.isHover = false;\n      // safeguard for creating the min sized rect\n      if (\n        getDistance(\n          ACircleWrapper.construction.pts[0].vec,\n          ACircleWrapper.construction.pts[1].vec\n        ) < 5\n      ) {\n        // console.log('safeguard executed')\n        ACircleWrapper.construction.pts[0].vec.x += -60;\n        ACircleWrapper.construction.pts[0].vec.y += -60;\n        ACircleWrapper.construction.pts[1].vec.x += 60;\n        ACircleWrapper.construction.pts[1].vec.y += -60;\n        ACircleWrapper.construction.pts[2].vec.x += 60;\n        ACircleWrapper.construction.pts[2].vec.y += 60;\n        ACircleWrapper.construction.pts[3].vec.x += -60;\n        ACircleWrapper.construction.pts[3].vec.y += 60;\n        // ACircleWrapper.construction.UpdateGeoPos();\n      }\n      ACircleWrapper.construction.isSelectedValue = false;\n      ACircleWrapper.construction.isSelected = false;\n      ACircleWrapper.construction.computeCenterVec();\n      ACircleWrapper.construction.emitAddStack();\n      ACircleWrapper.construction = undefined;\n      ACircleWrapper.isDone = true;\n    }\n    // scene.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.enablePan = true;\n  }\n  public static swap(shape: ACircleWrapper | ARectangleWrapper) {\n    let x,\n      y,\n      z = 0;\n    if (shape.pts[0].vec.x > shape.pts[1].vec.x) {\n      x = shape.pts[0].vec.x;\n      y = shape.pts[0].vec.y;\n      z = shape.pts[0].vec.z;\n      shape.pts[0].vec.x = shape.pts[1].vec.x;\n      shape.pts[0].vec.y = shape.pts[1].vec.y;\n      shape.pts[0].vec.z = shape.pts[1].vec.z;\n      shape.pts[1].vec.x = x;\n      shape.pts[1].vec.y = y;\n      shape.pts[1].vec.z = z;\n      x = shape.pts[3].vec.x;\n      y = shape.pts[3].vec.y;\n      z = shape.pts[3].vec.z;\n      shape.pts[3].vec.x = shape.pts[2].vec.x;\n      shape.pts[3].vec.y = shape.pts[2].vec.y;\n      shape.pts[3].vec.z = shape.pts[2].vec.z;\n      shape.pts[2].vec.x = x;\n      shape.pts[2].vec.y = y;\n      shape.pts[2].vec.z = z;\n    }\n    if (shape.pts[0].vec.y > shape.pts[3].vec.y) {\n      x = shape.pts[0].vec.x;\n      y = shape.pts[0].vec.y;\n      z = shape.pts[0].vec.z;\n      shape.pts[0].vec.x = shape.pts[3].vec.x;\n      shape.pts[0].vec.y = shape.pts[3].vec.y;\n      shape.pts[0].vec.z = shape.pts[3].vec.z;\n      shape.pts[3].vec.x = x;\n      shape.pts[3].vec.y = y;\n      shape.pts[3].vec.z = z;\n      x = shape.pts[1].vec.x;\n      y = shape.pts[1].vec.y;\n      z = shape.pts[1].vec.z;\n      shape.pts[1].vec.x = shape.pts[2].vec.x;\n      shape.pts[1].vec.y = shape.pts[2].vec.y;\n      shape.pts[1].vec.z = shape.pts[2].vec.z;\n      shape.pts[2].vec.x = x;\n      shape.pts[2].vec.y = y;\n      shape.pts[2].vec.z = z;\n    }\n  }\n  constructor(scene: Scene, x: number, y: number, z = 0, isUndo = false, lineWidth = 8) {\n    super(scene);\n    this.type = GType.CIRCLE;\n    this.pts = [];\n    this.pts.push(new APoint(scene, x, y, 0, isUndo));\n    this.pts.push(new APoint(scene, x, y, 0, isUndo));\n    this.pts.push(new APoint(scene, x, y, 0, isUndo));\n    this.pts.push(new APoint(scene, x, y, 0, isUndo));\n    for (let i = 0; i < this.pts.length; ++i) {\n      if (isUndo) {\n        this.pts[i].isHoverValue = false;\n      }\n      this.pts[i].type = GType.ANODE_CIRCLE;\n    }\n    this.lineWidth = lineWidth;\n    this.initComponent();\n    this.initVecsCP();\n    this.computeRecPts();\n    // this.vecsHistory.push(this.ComputeCenterVec());\n    // this.vec = new NVector3(x, y, 0);\n    this.isConstraintRatio = false;\n    this.initShape();\n    if (!isUndo) {\n      // once mouse up, we want to emit.\n      // this.scene.annotationInstance.io.eventListenerAnnotation.AddGeometryStack(this.ToJSON());\n    }\n  }\n  private initComponent() {\n    this.styleComponent = new StyleComponent(this);\n    this.renderer = new RendererComponent(this);\n    this.interaction = new InteractionComponent(this);\n    this.transformation = new TransformationComponent(this);\n  }\n  private initShape() {\n    this.dimension = new Dimension(this);\n\n    this.isFill = true;\n    this.scene.addACircleWrapper(this);\n  }\n  public computeCenterVec() {\n    const vec = getCenterVecFromVecs([\n      this.pts[0].vec,\n      this.pts[1].vec,\n      this.pts[2].vec,\n      this.pts[3].vec,\n    ]);\n    // const v = this.scene.annotationInstance.geometryCommon.gcmdSupporting.toMap(vec.x, vec.y);\n    this.vec.x = vec.x;\n    this.vec.y = vec.y;\n    return this.vec;\n  }\n  public computeRecPts() {\n    const v0 = this.pts[0].vec;\n    const v1 = this.pts[2].vec;\n    let x = 0;\n    let y = 0;\n    let z = 0;\n    if (v0.x < v1.x) {\n      x = v0.x;\n    } else {\n      x = v1.x;\n    }\n    if (v0.y < v1.y) {\n      y = v0.y;\n    } else {\n      y = v1.y;\n    }\n    if (v0.z < v1.z) {\n      z = v0.z;\n    } else {\n      z = v1.z;\n    }\n    const nv0 = new NVector3(x, y, z);\n    if (v0.x > v1.x) {\n      x = v0.x;\n    } else {\n      x = v1.x;\n    }\n    if (v0.y > v1.y) {\n      y = v0.y;\n    } else {\n      y = v1.y;\n    }\n    if (v0.z > v1.z) {\n      z = v0.z;\n    } else {\n      z = v1.z;\n    }\n    const nv1 = new NVector3(x, y, z);\n    this.updatePos(1, nv1.x, nv0.y, nv0.z);\n    this.updatePos(3, nv0.x, nv1.y, nv0.z);\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].addEdge(this);\n      this.pts[i].type = GType.ANODE_CIRCLE;\n    }\n    this.updateVecsCP();\n  }\n  public getRelatedVec() {\n    const vs = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      const p = this.pts[i];\n      vs.push(new NVector3(p.vec.x - this.vec.x, p.vec.y - this.vec.y, p.vec.z - this.vec.z));\n    }\n  }\n  public updatePos(i: number, x: number, y: number, z: number) {\n    this.pts[i].vec.x = x;\n    this.pts[i].vec.y = y;\n    this.pts[i].vec.z = z;\n  }\n  public getNodePopup(): APoint | undefined {\n    return this.pts[this.pts.length - 2];\n  }\n  public getArea() {\n    return (this.pts[1].vec.x - this.pts[0].vec.x) * (this.pts[2].vec.y - this.pts[0].vec.y);\n  }\n  public getLog(): string {\n    return this.interaction.getLog();\n  }\n  public set visibility(v: number) {\n    this.visibilityValue = v;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].visibilityValue = v;\n    }\n  }\n  public set IsHiddenChildren(v: boolean) {\n    this.isHiddenPre = this.isHiddenValue;\n    this.isHiddenValue = v;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].isHiddenValue = v;\n    }\n  }\n  public set isHidden(v: boolean) {\n    this.isHiddenPre = this.isHiddenValue;\n    this.isHiddenValue = v;\n    this.IsHiddenChildren = v;\n\n    this.scene.annotationInstance.io.eventListenerAnnotation.hideStack(this.toJSON());\n  }\n  public move(x: number, y: number) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    const xo = x - this.vec.x - (this.pts[1].vec.x - this.pts[0].vec.x) * 0.5;\n    const yo = y - this.vec.y - (this.pts[2].vec.y - this.pts[0].vec.y) * 0.5;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].vec.x += xo;\n      this.pts[i].vec.y += yo;\n      // this.pts[i].UpdateGoeVec();\n    }\n    this.computeCenterVec();\n  }\n  public goToBlackhole() {\n    this.isSelectable = false;\n    this.needBlackhole = true;\n    this.pts.forEach((p) => {\n      p.goToBlackhole();\n    });\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    return this.transformation.translateByMouseEventData(e);\n  }\n  public translate(x: number, y: number): void {\n    return this.transformation.translate(x, y);\n  }\n  public computeConstraintRatio(i: number, xOff: number, yOff: number): void {\n    return this.transformation.computeConstraintRatio(i, xOff, yOff);\n  }\n  public isMouseInside(x: number, y: number): boolean {\n    return this.interaction.isMouseInside(x, y);\n  }\n  public updateVecsBySnapping(p: APointBase, xOff: number, yOff: number) {\n    let index = -1;\n    for (let i = 0; i < this.pts.length; ++i) {\n      if (p === this.pts[i]) {\n        index = i;\n      }\n    }\n    if (index === 0) {\n      this.pts[1].vec.y += yOff;\n      this.pts[3].vec.x += xOff;\n    } else if (index === 1) {\n      this.pts[0].vec.y += yOff;\n      this.pts[2].vec.x += xOff;\n    } else if (index === 2) {\n      this.pts[3].vec.y += yOff;\n      this.pts[1].vec.x += xOff;\n    } else if (index === 3) {\n      this.pts[2].vec.y += yOff;\n      this.pts[0].vec.x += xOff;\n    }\n\n    this.computeCenterVec();\n    // this.UpdateGeoPos();\n  }\n  private initVecsCP() {\n    this.vecsCP.push(\n      new NVector3(\n        this.pts[0].vec.x + (this.pts[1].vec.x - this.pts[0].vec.x) * 0.5,\n        this.pts[0].vec.y + (this.pts[1].vec.y - this.pts[0].vec.y) * 0.5,\n        0\n      )\n    );\n    this.vecsCP.push(\n      new NVector3(\n        this.pts[1].vec.x + (this.pts[2].vec.x - this.pts[1].vec.x) * 0.5,\n        this.pts[1].vec.y + (this.pts[2].vec.y - this.pts[1].vec.y) * 0.5,\n        0\n      )\n    );\n    this.vecsCP.push(\n      new NVector3(\n        this.pts[2].vec.x + (this.pts[3].vec.x - this.pts[2].vec.x) * 0.5,\n        this.pts[2].vec.y + (this.pts[3].vec.y - this.pts[2].vec.y) * 0.5,\n        0\n      )\n    );\n    this.vecsCP.push(\n      new NVector3(\n        this.pts[3].vec.x + (this.pts[0].vec.x - this.pts[3].vec.x) * 0.5,\n        this.pts[3].vec.y + (this.pts[0].vec.y - this.pts[3].vec.y) * 0.5,\n        0\n      )\n    );\n  }\n  public updateVecsCP() {\n    this.vecsCP[0].x = this.pts[0].vec.x + (this.pts[1].vec.x - this.pts[0].vec.x) * 0.5;\n    this.vecsCP[0].y = this.pts[0].vec.y + (this.pts[1].vec.y - this.pts[0].vec.y) * 0.5;\n\n    this.vecsCP[1].x = this.pts[1].vec.x + (this.pts[2].vec.x - this.pts[1].vec.x) * 0.5;\n    this.vecsCP[1].y = this.pts[1].vec.y + (this.pts[2].vec.y - this.pts[1].vec.y) * 0.5;\n\n    this.vecsCP[2].x = this.pts[2].vec.x + (this.pts[3].vec.x - this.pts[2].vec.x) * 0.5;\n    this.vecsCP[2].y = this.pts[2].vec.y + (this.pts[3].vec.y - this.pts[2].vec.y) * 0.5;\n\n    this.vecsCP[3].x = this.pts[3].vec.x + (this.pts[0].vec.x - this.pts[3].vec.x) * 0.5;\n    this.vecsCP[3].y = this.pts[3].vec.y + (this.pts[0].vec.y - this.pts[3].vec.y) * 0.5;\n  }\n  public getVecs() {\n    this.vecs = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.vecs.push(this.pts[i].vec);\n    }\n    // v.push(this.pts[0].vec);\n    return this.vecs;\n  }\n  public remove(needEmit = true): void {\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].remove();\n    }\n    if (needEmit) {\n      const ioGeo = this.toJSON();\n      if (ioGeo) {\n        this.scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack([ioGeo]);\n      }\n    }\n    this.deepRemove();\n  }\n  public deepRemove() {\n    this.isSelectable = false;\n    this.isRenderable = false;\n    this.hidePopUpSummary();\n    this.scene.removeACircle(this);\n    this.scene.removeGeometry(this);\n  }\n  public getParentType() {\n    return 'ACircle,ID:' + this.id;\n  }\n  public hide(): void {\n    throw new Error('Method not implemented.');\n  }\n  public set IsSelectable(v: boolean) {\n    this.isSelectable = v;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].isSelectable = v;\n    }\n  }\n  public get IsSelectable() {\n    return this.isSelectable;\n  }\n  public set IsRenderable(bool: boolean) {\n    this.isRenderable = bool;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].isRenderable = bool;\n    }\n  }\n  // .......................................................................... implementation\n  public get isSelected() {\n    return this.isSelectedValue;\n  }\n  public set isSelected(v: boolean) {\n    this.isSelectedValue = v;\n    for (const p of this.pts) {\n      p.isRenderable = v;\n      p.isSelectable = v;\n      p.isSelectedValue = v;\n    }\n    // for (let i = 0; i < this.pts.length; ++i) { this.pts[i].isHidden = v; this.pts[i].Visibility = 0; }\n    this.scene.annotationInstance.io.eventListenerAnnotation.selectionStack(this.toJSON());\n    // if (v) {\n    // }\n  }\n  public get isHover() {\n    return this.isHoverValue;\n  }\n  public set isHover(v: boolean) {\n    if (this.isUnderConstruction) {\n      return;\n    }\n    this.isHoverValue = v;\n\n    if (this.isHoverValue && !this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    } else if (!this.isHoverValue && this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    }\n    this.isHoverPre = this.isHoverValue;\n    if (!this.isSelectedValue) {\n      for (const p of this.pts) {\n        p.isRenderable = v;\n        p.isSelectable = v;\n      }\n    }\n    if (!v) {\n      this.needEmitHoverPost = true;\n      this.hidePopUpSummary();\n    }\n  }\n  public getNode() {\n    const v: NVector3[] = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      v.push(this.pts[i].vec);\n    }\n    return v;\n  }\n  public toJSON(): IOGeometry {\n    const p = new IOGeometry(\n      this.id,\n      this.type,\n      this.isSelectedValue,\n      this.isHoverValue,\n      this.isHiddenValue\n    );\n    p.pushNode(this.getNode());\n\n    const styles = this.styleComponent.toJson();\n    if (styles) {\n      p.styles = styles;\n    }\n\n    return p;\n  }\n  public deepCopy(x: number, y: number, z = 0) {\n    const g = this.toJSON();\n    // if (g) {\n    const ng = ACircleWrapper.fromJSON(this.scene, g, true, true);\n    ng.move(x, y);\n    ng.emitAddStack();\n    return ng;\n  }\n  public get width() {\n    return this.pts[1].vec.x - this.pts[0].vec.x;\n  }\n  public get height() {\n    return this.pts[2].vec.y - this.pts[1].vec.y;\n  }\n  public computeBoundingVecs() {\n    this.vecs = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.vecs.push(this.pts[i].vec);\n    }\n  }\n  public getBoundary(): NVector3[] {\n    return this.getVecs();\n  }\n  public computeVec() {\n    this.computeCenterVec();\n    this.computeBoundingVecs();\n    this.updateVecsCP();\n  }\n  public mouseRightClick() {\n    this.isFill = !this.isFill;\n    this.isConstraintRatio = !this.isConstraintRatio;\n  }\n  public updateActiveCursor() {\n    this.interaction.updateActiveMouseCursor();\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.renderer.renderPost(ctx);\n  }\n  public getVecForSnapping(): NVector3 | undefined {\n    return this.vecSelectedSnapping;\n  }\n  // .................................................................... Leaderline\n  public isMouseInsideSnapFrom(v: NVector3): NVector3 | undefined {\n    return this.interaction.isMouseInsideSnapFrom(v);\n  }\n  public CheckAttachedTextleaderline(): boolean {\n    return this.interaction.checkAttachedTextleaderline();\n  }\n  public updateLeaderlineSnap(v: NVector3, tor: number) {\n    return this.interaction.updateLeaderlineSnap(v, tor);\n  }\n  // .................................................................... end Leaderline\n}\n","import {\n  distanceMouseWithTwoVecs,\n  getDistance,\n  isInsideOfVecs,\n  NVector3,\n  Cursor\n} from '../../../../../../../lib';\nimport { AGeometryBase } from '../../../../Common/Base/AGeometryBase';\nimport { ARectangleWrapper } from '../ARectangleWrapper';\nexport class InteractionComponent {\n  public geo: AGeometryBase;\n  public host: ARectangleWrapper;\n  constructor(geo: AGeometryBase) {\n    this.geo = geo;\n    this.host = geo as ARectangleWrapper;\n  }\n  public isMouseInside(x: number, y: number): boolean {\n    const mv = new NVector3(x, y);\n    if (this.host.isRemove || !this.host.isRenderable || this.host.isHiddenValue) {\n      return false;\n    }\n    if (this.host.isUnderConstruction === true || this.host.isUnderConstruction === undefined) {\n      return false;\n    }\n    if (this.geo.isCollapse) {\n      return false;\n    }\n    this.host.isRotate = false;\n    if (getDistance(this.host.vecRotationHandler, mv) < 10) {\n      this.host.isRotate = true;\n      this.host.isHover = true;\n      return true;\n    }\n    if (this.isMouseInsidePt(mv)) {\n      return true;\n    }\n    if (this.isMouseInsideCP(mv)) {\n      return true;\n    }\n    if (this.checkDistance(x, y)) {\n      this.host.isHover = true;\n      return true;\n    }\n    this.host.isHover = false;\n    return false;\n  }\n  public getLog(): string {\n    // this.UpdateGoeVec();\n    const text =\n      'GUID : ' +\n      this.host.id +\n      '/' +\n      'TYPE : ' +\n      this.host.type.toString() +\n      '/' +\n      // 'PARENT : ' + this.host.edges[0].GetParentType()+'<br>'+\n      // 'Geo : ' + 'lat:' + this.host.geoVec.x.toFixed(5).toString() + ', Log:' + this.host.geoVec.y.toFixed(5).toString() + '/' +\n      'Screen : ' +\n      // this.host.vec.ToString() +\n      '/' +\n      'Area : ' +\n      this.host.getArea().toFixed(3).toString() +\n      ' m2' +\n      '/' +\n      // 'STYLE : ' + this.host.style.toString() + '/' +\n      // 'CONNE :' + this.host.edges.length.toString() + '/' +\n      'IsSEL : ' +\n      this.host.isSelectedValue +\n      '/' +\n      'isSelable : ' +\n      this.host.isSelectable;\n    return text;\n  }\n  public hide(): void {\n    //\n  }\n  private isMouseInsidePt(m: NVector3): boolean {\n    for (let i = 0; i < this.host.pts.length; ++i) {\n      if (getDistance(this.host.pts[i].vec, m) < 10) {\n        this.host.vecSelected = i;\n        return true;\n      }\n    }\n    // const vsOther = this.host.wrapping.vsOther;\n    // if (vsOther) {\n    //   let cpVec = new NVector3(0, 0, 0);\n    //   for (let i  = 0 ; i < vsOther.length; ++i) {\n    //     if (i === vsOther.length -1) {\n    //       cpVec.x = vsOther[i].x + (vsOther[0].x - vsOther[i].x) * 0.5;\n    //       cpVec.y = vsOther[i].y + (vsOther[0].y - vsOther[i].y) * 0.5;\n    //     } else {\n    //       cpVec.x = vsOther[i].x + (vsOther[i+1].x - vsOther[i].x) * 0.5;\n    //       cpVec.y = vsOther[i].y + (vsOther[i+1].y - vsOther[i].y) * 0.5;\n    //     }\n    //     if (Distance(cpVec, m) < 10) {\n    //       this.host.vecSelected = i;\n    //       return true;\n    //     }\n    //   }\n    // }\n    this.host.vecSelected = -1;\n    return false;\n  }\n  private isMouseInsideCP(m: NVector3): boolean {\n    for (let i = 0; i < this.host.vecsCP.length; ++i) {\n      if (getDistance(this.host.vecsCP[i], m) < 10) {\n        this.host.vecSelectedCp = i;\n        this.host.isHoverDuplicatedVecs = false;\n        return true;\n      }\n    }\n    // const vsOther = this.host.wrapping.vsOther;\n    // if (vsOther) {\n    //   let cpVec = new NVector3(0, 0, 0);\n    //   for (let i  = 0 ; i < vsOther.length; ++i) {\n    //     if (i === vsOther.length -1) {\n    //       cpVec.x = vsOther[i].x + (vsOther[0].x - vsOther[i].x) * 0.5;\n    //       cpVec.y = vsOther[i].y + (vsOther[0].y - vsOther[i].y) * 0.5;\n    //     } else {\n    //       cpVec.x = vsOther[i].x + (vsOther[i+1].x - vsOther[i].x) * 0.5;\n    //       cpVec.y = vsOther[i].y + (vsOther[i+1].y - vsOther[i].y) * 0.5;\n    //     }\n    //     if (Distance(cpVec, m) < 10) {\n    //       this.host.vecSelectedCp = i;\n    //       this.host.isHoverDuplicatedVecs = true;\n    //       return true;\n    //     }\n    //   }\n    // }\n    this.host.vecSelectedCp = -1;\n    return false;\n  }\n  private checkDistance(x: number, y: number): boolean {\n    const mouse = new NVector3(x, y);\n\n    // if (this.type !== GTYPE.POLYLINE) {\n    const len = this.host.pts.length;\n    for (let i = 0; i < len; ++i) {\n      if (i < len - 1) {\n        if (\n          distanceMouseWithTwoVecs(mouse, this.host.pts[i].vec, this.host.pts[i + 1].vec) <\n          this.host.lineWidth\n        ) {\n          return true;\n        }\n      } else {\n        if (\n          distanceMouseWithTwoVecs(mouse, this.host.pts[i].vec, this.host.pts[0].vec) <\n          this.host.lineWidth\n        ) {\n          return true;\n        }\n      }\n    }\n    // ....................................... duplicated polyline or gon\n    // if (this.CheckDistanceDuplication(mouse)) { return true; }\n\n    // ....................................... end duplicated polyline or gon\n    if (this.host.isFill) {\n      if (isInsideOfVecs(mouse, this.host.vecs)) {\n        return true;\n      }\n    }\n    return false;\n  }\n  public updateActiveMouseCursor(): void {\n    if (this.host.vecSelectedCp > -1) {\n      this.setMouseCursorMidCP();\n    } else {\n      this.setMouseCursorCP();\n    }\n  }\n  private setMouseCursorCP(): void {\n    if (this.host.scene.capturePT) {\n      const index = this.host.pts.indexOf(this.host.scene.capturePT);\n      if (index % 2 === 0) {\n        this.host.scene.annotationInstance.activeCommandController.activeMouseCursor.setActiveCursor(\n          Cursor.NWSEresize\n        );\n      } else {\n        this.host.scene.annotationInstance.activeCommandController.activeMouseCursor.setActiveCursor(\n          Cursor.NESWresize\n        );\n      }\n    } else {\n      this.host.scene.annotationInstance.activeCommandController.activeMouseCursor.setActiveCursorDrag();\n    }\n  }\n  private setMouseCursorMidCP(): void {\n    if (this.host.vecSelectedCp === -1) {\n      this.host.scene.annotationInstance.activeCommandController.activeMouseCursor.setActiveCursorDrag();\n    }\n    if (this.host.vecSelectedCp % 2 === 0) {\n      this.host.scene.annotationInstance.activeCommandController.activeMouseCursor.setActiveCursor(\n        Cursor.NSresize\n      );\n    } else {\n      this.host.scene.annotationInstance.activeCommandController.activeMouseCursor.setActiveCursor(\n        Cursor.EWresize\n      );\n    }\n  }\n  // .................................................................. Leaderline\n  public isMouseInsideSnapFrom(v: NVector3): NVector3 | undefined {\n    this.host.vecSelectedSnapping = undefined;\n\n    for (let i = 0; i < this.host.pts.length; i += 1) {\n      const dis = getDistance(this.host.pts[i].vec, v);\n      if (\n        dis <\n        this.host.scene.annotationInstance.activeCommandController.acProperties.toleranceSnapping\n      ) {\n        this.host.vecSelectedSnapping = this.host.pts[i].vec;\n        return this.host.vecSelectedSnapping;\n      }\n    }\n    const dis = getDistance(this.host.vec, v);\n    if (\n      dis <\n      this.host.scene.annotationInstance.activeCommandController.acProperties.toleranceSnapping\n    ) {\n      this.host.vecSelectedSnapping = this.host.vec;\n      return this.host.vecSelectedSnapping;\n    }\n    return undefined;\n  }\n  public checkAttachedTextleaderline(): boolean {\n    // console.log(this.textLeaderline);\n    if (!this.host.textLeaderline || !this.host.textLeaderline.leaderline) {\n      return false;\n    }\n    let hasLeaderline = false;\n    // for the other rest node with no leaderline attached.\n    // if (this.host.graphCore.selVec) {\n    //   if (this.host.textLeaderline && this.host.textLeaderline.leaderline) {\n    //     if (Distance(this.host.graphCore.selVec, this.host.textLeaderline.leaderline.v2) > 5) {\n    //       this.host.skipTranslationForLeaderline = true;\n    //       return false  // we donot need to check others, thus just return\n    //     } else {\n    //       this.host.skipTranslationForLeaderline = false;\n    //     }\n    //   }\n    // }\n    // end for the other rest node with no leaderline attached.\n    // console.log('CheckAttachedTextleaderline');\n\n    for (let i = 0; i < this.host.pts.length; ++i) {\n      if (getDistance(this.host.pts[i].vec, this.host.textLeaderline.leaderline.v2) < 5) {\n        hasLeaderline = true;\n      }\n    }\n\n    // find center node having leaderline\n    if (getDistance(this.host.vec, this.host.textLeaderline.leaderline.v2) < 5) {\n      hasLeaderline = true;\n    }\n\n    // find cp node having leaderline\n    for (let i = 0; i < this.host.vecsCP.length; ++i) {\n      if (getDistance(this.host.vecsCP[i], this.host.textLeaderline.leaderline.v2) < 5) {\n        hasLeaderline = true;\n      }\n    }\n    if (hasLeaderline) {\n      return true;\n    }\n    this.host.textLeaderline.attachedShape = undefined;\n    this.host.textLeaderline = undefined;\n    return false;\n  }\n  public updateLeaderlineSnap(v: NVector3, tor: number): void {\n    this.host.computeCenterVec();\n    if (getDistance(this.host.vec, v) < 5) {\n      this.host.vecSelectedSnapping = this.host.vec;\n      return;\n    }\n    for (let i = 0; i < this.host.pts.length; ++i) {\n      if (getDistance(this.host.pts[i].vec, v) < 5) {\n        this.host.vecSelectedSnapping = this.host.pts[i].vec;\n        return;\n      }\n    }\n  }\n}\n","import { NVector3, InteractionMode } from '../../../../../../../lib';\nimport { RendererComponent as _RendererComponent } from '../../../../Common/Base/ComponentTemplate/RendererComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { ARectangleWrapper } from '../ARectangleWrapper';\nexport class RendererComponent extends _RendererComponent {\n  public host: ARectangleWrapper;\n  public renderStyle: RenderStyle;\n  public renderStyleNode: RenderStyle;\n  constructor(host: ARectangleWrapper) {\n    super(host);\n    this.host = host;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.interpolateColor.update();\n    this.timer.update();\n    this.timer.updatePopupSummery();\n\n    // if(this.host.enableRotate) {\n    this.host.transformation.updateRotationAbsolute();\n    // }\n\n\n    if (this.host.scene.annotationInstance.activeCommandController.acProperties.isPanning) {\n      this.host.computeVec();\n      // this.host.wrapping.UpdateProjection(this.host.GetVecs());\n    }\n\n    if (\n      this.host.scene.annotationInstance.activeCommandController.acProperties.showUnit &&\n      this.host.isConstraintRatio &&\n      this.host.isHoverValue\n    ) {\n      ctx.textAlign = 'center';\n      ctx.fillStyle = '#ffffff';\n      if (100 < Math.abs(this.host.width)) {\n        ctx.fillText('constrained by ratio', this.host.vec.x, this.host.vec.y);\n      }\n      // ALog.alog.Text = 'Total Length : is con';\n    }\n\n    if (this.host.scene.annotationInstance.activeCommandController.acProperties.showUnit) {\n      if (this.host.isHoverValue || this.host.isUnderConstruction) {\n        this.host.dimension.renderLengthRect(ctx, this.host.vecs);\n        if (this.host.isConstraintRatio) {\n          this.host.dimension.renderTotalAreaRect(ctx, this.host.vecs, ', constrained by ratio');\n        } else {\n          this.host.dimension.renderTotalAreaRect(ctx, this.host.vecs);\n        }\n      }\n    }\n\n    /* center point\n    ctx.fillStyle = '#ff0000';\n    ctx.beginPath();\n    ctx.arc(this.host.vec.x, this.host.vec.y, 10, 0 , Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n    */\n\n    // this.GetRelatedVec();\n    // this.ComputeCenterVec();\n    // if (this.scene.annotationInstance.implementation.app.model.activeCommands.isViewChanging) {\n    //     this.ComputeCenterVec();\n    // }\n    // console.log(this.ResizeConstraintRatio());\n\n    // if (this.scene.annotationInstance.implementation.app.versionJSAPI === '4.8') {\n    //     if (this.wrapping.needWrappingDuplicate) {\n    //         this.RenderPostGeometryDuplicationCustom(ctx);\n    //     } else {\n    //         this.RenderPostGeometry(ctx, this.GetVecs());\n    //     }\n    // } else {\n    // this.RenderPostGeometryDuplication(ctx, this.host.wrapping.vsOther);\n    this.renderPostGeometry(\n      ctx,\n      this.host.scene.annotationInstance.geometryCommon.gcmdSupporting.toScreenVecsOnCropping(this.host.getVecs())\n      );\n    // }\n\n    // debug for center vec\n    // ctx.beginPath();\n    // ctx.arc(this.host.vec.x, this.host.vec.y, 10, 0 , 3.14*2)\n    // ctx.closePath();\n    // ctx.fill();\n  }\n  private renderPostGeometry(ctx: CanvasRenderingContext2D, vecs: NVector3[]) {\n    // const width  = Math.abs((this.host.vecsCP[1].x - this.host.vecsCP[0].x));\n    // const height = Math.abs((this.host.vecsCP[2].y - this.host.vecsCP[0].y) * 0.5);\n\n    // this.host.UpdateVecsCP();\n    const cv = this.host.scene.annotationInstance.geometryCommon.gcmdSupporting.toScreenVecOnCropping(this.host.vec);\n\n    // console.log(this.isFill);\n    // this.isFill = t;\n\n    if (this.host.isHoverValue || this.host.isSelectedValue) {\n      this.host.scene.annotationInstance.renderer.draw.shape.area.rectangleHover(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        vecs,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.host.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(\n          this.host.renderer.tOver\n        ),\n        this.host.isHoverValue,\n        this.host.isSelectedValue\n      );\n      this.host.renderer.tOver += this.host.scene.annotationInstance.renderer.dt;\n      this.host.renderer.tDown1 = 0;\n      this.host.isLeave = true;\n      if (\n        this.host.scene.annotationInstance.implementations.app.model.appCoreWrapper.appControllerStatus\n          .mode === InteractionMode.Drawing\n      ) {\n        if (this.host.enableRotate) {\n          this.renderRotationHandler(ctx);\n        }\n      }\n    } else {\n      this.host.renderer.tOver = 0;\n    }\n\n    // we want to disable dim effect out\n    /*\n    this.host.scene.annotationInstance.renderer.draw.shape.area.rectangle(\n      ctx,\n      this.host.styleComponent.renderStyle,\n      vecs,\n      this.host.vec,\n      this.host.isFill,\n      this.host.isHoverValue,\n      this.host.isSelectedValue\n    );\n    */\n\n    this.host.scene.annotationInstance.renderer.draw.shape.area.rectangle(\n      ctx,\n      this.host.styleComponent.renderStyle,\n      vecs,\n      this.host.vec,\n      true,\n      true,\n      false\n    );\n\n    if (this.host.isHoverValue || this.host.isSelectedValue || this.host.isUnderConstruction) {\n      if (\n        this.host.scene.annotationInstance.implementations.app.model.appCoreWrapper.appControllerStatus.mode === InteractionMode.Drawing) {\n        this.host.scene.annotationInstance.renderer.draw.shape.point.centerPointCircle(ctx, cv.x, cv.y);\n        this.renderCP(ctx, vecs);\n      }\n    }\n    this.t += this.host.scene.annotationInstance.renderer.dt;\n    this.renderPostGeometryOffScreen(vecs);\n  }\n  private renderCP(ctx: CanvasRenderingContext2D, vecs: NVector3[]) {\n    this.host.updateVecsCP();\n    let x = 0,\n      y = 0;\n    for (let i = 0; i < vecs.length; ++i) {\n      if (i === vecs.length - 1) {\n        x = vecs[i].x + (vecs[0].x - vecs[i].x) * 0.5;\n        y = vecs[i].y + (vecs[0].y - vecs[i].y) * 0.5;\n      } else {\n        x = vecs[i].x + (vecs[i + 1].x - vecs[i].x) * 0.5;\n        y = vecs[i].y + (vecs[i + 1].y - vecs[i].y) * 0.5;\n      }\n      this.host.scene.annotationInstance.renderer.draw.shape.node.nodeHover(\n        ctx,\n        this.host.pts[0].styleComponent.renderStyle,\n        x,\n        y,\n        // this.host.pts[0].styleComponent.renderStyle.scaleLocal * this.geo.scene.annotationInstance.activeCommandController.scaleGlobal,\n        this.host.scene.annotationInstance.graphicsCoreWrapper.scaleScreenByRatioImageSize,\n        1\n      );\n    }\n  }\n  private renderPostGeometryOffScreen(vecs: NVector3[]) {\n    this.host.scene.annotationInstance.renderer.offscreen.rectangleOffScreen(\n      this.host.scene.annotationInstance.renderer.ctxOffscreen,\n      this.host.hashColor,\n      vecs\n    );\n  }\n  private renderRotationHandler(ctx: CanvasRenderingContext2D) {\n    if (this.host.isHover) {\n      if (this.host.enableRotate) {\n        this.host.transformation.updateRotationHandler();\n      }\n      ctx.strokeStyle = this.host.styleComponent.renderStyle.colorStroke;\n      ctx.beginPath();\n      ctx.moveTo(this.host.vecRotationHandler.x, this.host.vecRotationHandler.y);\n      ctx.lineTo(\n        this.host.vecs[0].x + (this.host.vecs[1].x - this.host.vecs[0].x) * 0.5,\n        this.host.vecs[0].y + (this.host.vecs[1].y - this.host.vecs[0].y) * 0.5\n      );\n      ctx.closePath();\n      ctx.stroke();\n\n      // this.host.scene.annotationInstance.renderer.draw.shape.node.NodeHover(ctx, this.host.styleComponent.renderStyle,\n      //   this.host.vecRotationHandler.x, this.host.vecRotationHandler.y, 1, 1\n      //   );\n\n      ctx.fillStyle = this.host.styleComponent.renderStyle.colorStroke;\n      ctx.beginPath();\n      ctx.arc(this.host.vecRotationHandler.x, this.host.vecRotationHandler.y, 7, 0, Math.PI * 2);\n      ctx.closePath();\n      ctx.fill();\n    }\n  }\n  // RenderPostGeometryDuplicationCustom(ctx: CanvasRenderingContext2D) {\n\n  //     this.vecOthersCustom = this.wrapping.ComputeWrappingDuplicationCustom(this.GetVecs());\n\n  //     if (this.scene.annotationInstance.activeCommandController.showUnit) {\n  //         if (this.vecOthersCustom !== undefined) {\n  //             const dimVec = this.vecOthersCustom[1];\n  //             if (dimVec.length > 1) {\n  //                 if (this.isHover || this.isUnderConstruction) {\n  //                     this.dimension.RenderLengthRect(ctx, dimVec);\n  //                     if (this.isConstraintRatio) {\n  //                         this.dimension.RenderTotalAreaRect(ctx, dimVec, ', constrained by ratio');\n  //                     } else {\n  //                         this.dimension.RenderTotalAreaRect(ctx, dimVec);\n  //                     }\n  //                 }\n  //             }\n  //         }\n  //     }\n\n  //     if (this.vecOthersCustom && this.vecOthersCustom.length > 0) {\n  //         if (this.isHover || this.isSelected) {\n  //             this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVecHover(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[0], this.isGrayColor, this.visibility, NumericalMotion.easeOutElastic2(this.renderer.tOver), this.isHover);\n  //             this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVec(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[0], this.isUndo, this.isGrayColor, this.visibility);\n  //             this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVecNode(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[0], this.isGrayColor, this.visibility, NumericalMotion.easeOutElastic2(this.renderer.tOver), this.isHover);\n\n  //             if (this.vecOthersCustom[1].length > 0) {\n  //                 this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVecHover(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[1], this.isGrayColor, this.visibility, NumericalMotion.easeOutElastic2(this.renderer.tOver), this.isHover);\n  //                 this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVec(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[1], this.isUndo, this.isGrayColor, this.visibility);\n  //                 this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVecNode(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[1], this.isGrayColor, this.visibility, NumericalMotion.easeOutElastic2(this.renderer.tOver), this.isHover);\n  //             }\n  //         } else {\n  //             this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVec(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[0], this.isUndo, this.isGrayColor, this.visibility);\n  //             if (this.vecOthersCustom[1].length > 0) {\n  //                 this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.PolygonByVec(ctx, this.styleComponent.renderStyle, this.vecOthersCustom[1], this.isUndo, this.isGrayColor, this.visibility);\n  //             }\n  //         }\n  //     }\n  // }\n}\n","import { ThemeColorId } from '../../../../../Customization/ThemeRenderStyle/Utility';\nimport { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { ARectangleWrapper } from '../ARectangleWrapper';\nexport class StyleComponent extends _StyleComponent {\n  public geo: ARectangleWrapper;\n  constructor(geo: ARectangleWrapper) {\n    super(geo);\n    this.updateStyle();\n    this.updateColor();\n  }\n  public updateStyle() {\n    if (!this.isCustom) {\n      this.state.themeColorId = ThemeColorId.AccentColor1;\n      this.isCustom = true;\n      RenderStyle.updateRenderStylePolygon(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n      RenderStyle.updateRenderStylePolygonNode(\n        this.renderStyleNode,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n      for (let i = 0; i < this.geo.pts.length; ++i) {\n        this.geo.pts[i].styleComponent.updateStyleForNode(this.renderStyleNode);\n      }\n    }\n  }\n  public updateColor(color: number[] | undefined = undefined) {\n    this.isCustom = true;\n    if (color === undefined) {\n      color = this.geo.scene.annotationInstance.activeCommandController.activeColorController.activeColor;\n    }\n    RenderStyle.updateRenderColorPolygon(\n      this.renderStyle,\n      this.geo.scene.annotationInstance.customization.themeCurrent,\n      color,\n      [0,0,0,0]\n    );\n    RenderStyle.updateRenderColorPolygonNode(\n      this.renderStyleNode,\n      this.geo.scene.annotationInstance.customization.themeCurrent,\n      color\n    );\n    for (let i = 0; i < this.geo.pts.length; ++i) {\n      this.geo.pts[i].styleComponent.updateStyleForNode(this.renderStyleNode);\n    }\n    this.tempColorRgba = color;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public updateStyleCustom(style: any): boolean {\n    // if (this.isSameStyle(style)) {\n    //   return false;\n    // }\n    const needEmit = false;\n\n    if (style.width) {\n      this.state.width = style.width;\n    }\n    if (style.color !== undefined) {\n      this.state.themeColorId = style.color as ThemeColorId;\n    }\n\n    if (style.colorRgba.length > 0 && style.fill.length > 0) {\n      this.tempColorRgba = style.colorRgba;\n      this.tempFillRgba = style.fill;\n      RenderStyle.updateRenderStylePolygonCustom(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent,\n        style.colorRgba,\n        style.fill\n      );\n      RenderStyle.updateRenderStylePolygonNodeCustom(\n        this.renderStyleNode,\n        this.geo.scene.annotationInstance.customization.themeCurrent,\n        style.colorRgba,\n        style.fill\n      );\n      for (let i = 0; i < this.geo.pts.length; ++i) {\n        this.geo.pts[i].styleComponent.updateStyleForNode(this.renderStyleNode);\n      }\n    }\n    if (style.scale) {\n      this.renderStyle.scaleLocal = style.scale;\n      this.state.scale = style.scale;\n    }\n    this.isCustom = true;\n    if (needEmit && !this.geo.isUnderConstruction) {\n      this.geo.isTransform = true;\n    }\n    return true;\n  }\n  public setDash(v: number[]) {\n    this.renderStyle.dash = v;\n    this.geo.scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n      this.geo.toJSON()\n    );\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public toJson(): any | undefined {\n    if (!this.isCustom) {\n      return undefined;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const output: any = {\n      width: this.state.width,\n      scale: this.renderStyle.scaleLocal,\n      // this is necessary for updating state on React side\n      colorRgba: this.tempColorRgba,\n      fill: this.tempFillRgba,\n    };\n    if (this.state.themeColorId !== ThemeColorId.AccentColor1) {\n      output.color = this.state.themeColorId;\n    }\n    return output;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  protected isSameStyle(style: any) {\n    if (\n      style.colorRgba.length === this.tempColorRgba.length ||\n      style.fill.length === this.tempFillRgba\n    ) {\n      for (let i = 0; i < style.colorRgba.length; i++) {\n        if (style.colorRgba[i] !== this.tempColorRgba[i]) {\n          return false;\n        }\n      }\n      for (let i = 0; i < style.fill.length; i++) {\n        if (style.fill[i] !== this.tempFillRgba[i]) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n}\n","import {\n  crossProduct,\n  getDistance,\n  moveVecs,\n  NVector3,\n  rotateVecs,\n  getRatioByNewHeight, \n  getRatioByNewWidth,\n  MouseEventData,\n} from '../../../../../../../lib';\nimport { AGeometryBase } from '../../../../Common/Base/AGeometryBase';\nimport { TransformationComponent as _TransformationComponent } from '../../../../Common/Base/ComponentTemplate/TransformationComponent';\nimport { ARectangleWrapper } from '../ARectangleWrapper';\nexport class TransformationComponent extends _TransformationComponent {\n  public geo: AGeometryBase;\n  public host: ARectangleWrapper;\n  public v: NVector3;\n  public anglePre = 0.0;\n  public angle = 0.0;\n  constructor(geo: AGeometryBase) {\n    super(geo);\n    this.geo = geo;\n    this.host = geo as ARectangleWrapper;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    // console.log(e);\n\n    if (this.host.vecSelected > -1) {\n      this.translateByMouseEventDataNode(e, this.host.vecSelected);\n      return;\n    }\n\n    if (this.host.isRotate) {\n      this.rotatingShape(e.x, e.y);\n      return;\n    }\n    const xo = e.x - e.preX;\n    const yo = e.y - e.preY;\n\n    if (this.host.vecSelectedCp !== -1) {\n      this.translateCPByMouseEventData(e);\n      this.host.computeCenterVec();\n      this.updateTextleaderlineVec();\n      return;\n    }\n    if (this.host.vecSelected !== -1) {\n      this.host.pts[this.host.vecSelected].translateByMouseEventData(e);\n      this.host.computeCenterVec();\n      this.updateTextleaderlineVec();\n      return;\n    }\n\n    for (let i = 0; i < this.host.pts.length; ++i) {\n      this.host.pts[i].vec.x += xo;\n      this.host.pts[i].vec.y += yo;\n    }\n    this.host.computeCenterVec();\n\n    if (this.host.textLeaderline) {\n      // Safeguard: resize rect and circle with the attached leaderline\n      // If it has a Textleaderline, it try to re-find the vec, in case that it has undefined vec.\n      if (!this.host.vecSelectedSnapping) {\n        this.host.updateLeaderlineSnap(this.host.textLeaderline.vec, 5);\n      }\n      // end Safeguard: resize rect and circle with the attached leaderline\n\n      this.updateTextleaderlineVec();\n      this.host.textLeaderline.translateByMouseEventData(e);\n    }\n  }\n  public translateByMouseEventDataNode(e: MouseEventData, i: number): void {\n    for (let i = 0; i < this.host.pts.length; ++i) {\n      this.host.pts[i].isRenderable = true;\n    }\n\n    // ............. Safeguard: resize rect and circle with the attached leaderline\n    // ............. If it has a Textleaderline, it try to re-find the vec, in case that it has undefined vec.\n    if (this.host.textLeaderline && !this.host.vecSelectedSnapping) {\n      this.host.updateLeaderlineSnap(this.host.textLeaderline.vec, 5);\n    }\n    // ............. end Safeguard: resize rect and circle with the attached leaderline\n\n    let xOff = e.x - e.preX;\n    let yOff = e.y - e.preY;\n\n    if (i === 0 || i === 2) {\n      if (Math.abs(xOff) > Math.abs(yOff)) {\n        yOff = xOff;\n      } else {\n        xOff = yOff;\n      }\n    } else if (i === 1 || i === 3) {\n      if (Math.abs(xOff) > Math.abs(yOff)) {\n        yOff = xOff * -1;\n      } else {\n        xOff = yOff * -1;\n      }\n    }\n\n    if (this.host.isConstraintRatio) {\n      this.computeConstraintRatio(i, xOff, yOff);\n    } else {\n      if (i === 0) {\n        this.translatePt(0, xOff, yOff);\n        this.translatePt(3, xOff, 0);\n        this.translatePt(1, 0, yOff);\n        if (this.host.width < 16 || this.host.height < 16) {\n          this.translatePt(0, -xOff, -yOff);\n          this.translatePt(3, -xOff, 0);\n          this.translatePt(1, 0, -yOff);\n        }\n      } else if (i === 1) {\n        this.translatePt(1, xOff, yOff);\n        this.translatePt(2, xOff, 0);\n        this.translatePt(0, 0, yOff);\n        if (this.host.width < 16 || this.host.height < 16) {\n          this.translatePt(1, -xOff, -yOff);\n          this.translatePt(2, -xOff, 0);\n          this.translatePt(0, 0, -yOff);\n        }\n      } else if (i === 2) {\n        this.translatePt(2, xOff, yOff);\n        this.translatePt(1, xOff, 0);\n        this.translatePt(3, 0, yOff);\n        if (this.host.width < 16 || this.host.height < 16) {\n          this.translatePt(2, -xOff, -yOff);\n          this.translatePt(1, -xOff, 0);\n          this.translatePt(3, 0, -yOff);\n        }\n      } else if (i === 3) {\n        this.translatePt(3, xOff, yOff);\n        this.translatePt(0, xOff, 0);\n        this.translatePt(2, 0, yOff);\n        if (this.host.width < 16 || this.host.height < 16) {\n          this.translatePt(3, -xOff, -yOff);\n          this.translatePt(0, -xOff, 0);\n          this.translatePt(2, 0, -yOff);\n        }\n      }\n    }\n    this.host.computeCenterVec();\n    // node.UpdateGoeVec();\n    this.host.transformation.updateTextleaderlineVec();\n    return;\n  }\n  public translate(x: number, y: number): void {\n    // if (this.vecSelected !== -1) {\n    //     this.host.pts[this.vecSelected].Translate(e);\n    //     return;\n    // }\n    // if (this.isRemove || !this.isRenderable || this.isHidden) { return; }\n    // let xo = e.x - e.preX;\n    // let yo = e.y - e.preY;\n    // for (let i = 0; i < this.host.pts.length; ++i) {\n    //     this.host.pts[i].vec.x += xo;\n    //     this.host.pts[i].vec.y += yo;\n    //     this.host.pts[i].UpdateGoeVec();\n    // }\n    // this.ComputeCenterVec();\n  }\n  public updateRotationAbsolute(): void {\n    this.angle =\n      (Math.atan2(\n        this.host.vecRotationHandler.y - this.host.vec.y,\n        this.host.vecRotationHandler.x - this.host.vec.x\n      ) *\n        180) /\n      Math.PI;\n  }\n  private translatePt(i: number, x = 0, y = 0): void {\n    this.host.pts[i].vec.x += x;\n    this.host.pts[i].vec.y += y;\n    return;\n  }\n  private translateCPByMouseEventData(e: MouseEventData): void {\n    if (this.host.vecSelectedCp === 0) {\n      const y = e.y - this.host.pts[0].vec.y;\n      this.host.pts[0].vec.y += y;\n      this.host.pts[1].vec.y += y;\n      if (this.host.height < 16) {\n        this.host.pts[0].vec.y -= y;\n        this.host.pts[1].vec.y -= y;\n      }\n    } else if (this.host.vecSelectedCp === 2) {\n      const y = e.y - this.host.pts[2].vec.y;\n      this.host.pts[2].vec.y += y;\n      this.host.pts[3].vec.y += y;\n      if (this.host.height < 16) {\n        this.host.pts[2].vec.y -= y;\n        this.host.pts[3].vec.y -= y;\n      }\n    } else if (this.host.vecSelectedCp === 1) {\n      const x = this.host.isHoverDuplicatedVecs ? e.x : e.x - this.host.pts[1].vec.x;\n      this.host.pts[1].vec.x += x;\n      this.host.pts[2].vec.x += x;\n      if (this.host.width < 16) {\n        this.host.pts[1].vec.x -= x;\n        this.host.pts[2].vec.x -= x;\n      }\n    } else if (this.host.vecSelectedCp === 3) {\n      const x = this.host.isHoverDuplicatedVecs ? e.x : e.x - this.host.pts[0].vec.x;\n      this.host.pts[0].vec.x += x;\n      this.host.pts[3].vec.x += x;\n      if (this.host.width < 16) {\n        this.host.pts[0].vec.x -= x;\n        this.host.pts[3].vec.x -= x;\n      }\n    }\n  }\n  private rotatingShape(x: number, y: number): void {\n    const angle = (Math.atan2(y - this.host.vec.y, x - this.host.vec.x) * 180) / Math.PI;\n    // this.anglePre = angle;\n    // const theAngle = this.anglePre - angle;\n    const angleRelative = angle - this.angle;\n\n    let vecs = this.rotateVecsLoal([this.host.vecRotationHandler], this.host.vec, angleRelative);\n    this.host.vecRotationHandler.x = vecs[0].x;\n    this.host.vecRotationHandler.y = vecs[0].y;\n    this.host.vecRotationHandler.z = vecs[0].z;\n\n    vecs = this.rotateVecsLoal(this.host.vecs, this.host.vec, angleRelative);\n    this.host.vecs[0].x = vecs[0].x;\n    this.host.vecs[0].y = vecs[0].y;\n    this.host.vecs[0].z = vecs[0].z;\n    this.host.vecs[1].x = vecs[1].x;\n    this.host.vecs[1].y = vecs[1].y;\n    this.host.vecs[1].z = vecs[1].z;\n    this.host.vecs[2].x = vecs[2].x;\n    this.host.vecs[2].y = vecs[2].y;\n    this.host.vecs[2].z = vecs[2].z;\n    this.host.vecs[3].x = vecs[3].x;\n    this.host.vecs[3].y = vecs[3].y;\n    this.host.vecs[3].z = vecs[3].z;\n\n    this.angle += angleRelative;\n  }\n  private rotateVecsLoal(vecs: NVector3[], cv: NVector3, angle: number): NVector3[] {\n    const cptToWorld = new NVector3(-cv.x, -cv.y, -cv.z);\n    let temp: NVector3[] = moveVecs(vecs, cptToWorld);\n    temp = rotateVecs(temp, angle);\n    temp = moveVecs(temp, cv);\n    return temp;\n  }\n  public updateTextleaderlineVec(): void {\n    let offset = 0;\n    if (\n      this.host.vecSelectedSnapping &&\n      this.host.textLeaderline &&\n      this.host.textLeaderline.leaderline\n    ) {\n      offset = this.host.textLeaderline.leaderline.v2.x - this.host.vecSelectedSnapping.x;\n      this.host.textLeaderline.leaderline.v2.x = this.host.vecSelectedSnapping.x;\n      this.host.textLeaderline.widthOffset += offset;\n\n      offset = this.host.textLeaderline.leaderline.v2.y - this.host.vecSelectedSnapping.y;\n      this.host.textLeaderline.leaderline.v2.y = this.host.vecSelectedSnapping.y;\n      this.host.textLeaderline.heightOffset += offset;\n\n      this.host.textLeaderline.computeCenterVec(); // before update UpdateVecsHistory, we need to keep tracking vecs for transformation stack\n    }\n  }\n  public updateRotationHandler(): void {\n    this.host.vecRotationHandler.x =\n      this.host.vecs[0].x + (this.host.vecs[1].x - this.host.vecs[0].x) * 0.5;\n    this.host.vecRotationHandler.y =\n      this.host.vecs[0].y + (this.host.vecs[1].y - this.host.vecs[0].y) * 0.5;\n\n    const pV = crossProduct(this.host.vecs[0], this.host.vecs[1]);\n    // console.log(this.host.transformation.angle / 180 * Math.PI);\n    const dirV = new NVector3(\n      this.host.vecs[1].x - this.host.vecs[0].x,\n      this.host.vecs[1].y - this.host.vecs[0].y,\n      this.host.vecs[1].z - this.host.vecs[0].z\n    );\n    const offV = crossProduct(pV, dirV);\n    offV.unitize();\n\n    this.host.vecRotationHandler.x += offV.x * 20;\n    this.host.vecRotationHandler.y += offV.y * 20;\n\n    if (getDistance(this.host.vec, this.host.vecRotationHandler) < this.host.height * 0.5) {\n      this.host.vecRotationHandler.x += -offV.x * 40;\n      this.host.vecRotationHandler.y += -offV.y * 40;\n    } else {\n      // this.host.vecRotationHandler.x += offV.x * 20;\n      // this.host.vecRotationHandler.y += offV.y * 20;\n    }\n  }\n  public computeConstraintRatio(i: number, xOff: number, yOff: number): void {\n    const ratio = this.resizeConstraintRatio();\n\n    if (i === 0) {\n      if (Math.abs(xOff) > Math.abs(yOff)) {\n        const newRatio = getRatioByNewWidth(ratio[0], ratio[1], ratio[0] + xOff);\n        this.host.pts[i].vec.x += xOff;\n        this.host.pts[i].vec.y -= ratio[1] - newRatio[1];\n        this.host.pts[i + 1].vec.y -= ratio[1] - newRatio[1];\n        this.host.pts[i + 3].vec.x += xOff;\n      } else {\n        const newRatio = getRatioByNewHeight(ratio[0], ratio[1], ratio[1] + yOff);\n        this.host.pts[i].vec.x -= ratio[0] - newRatio[0];\n        this.host.pts[i].vec.y += yOff;\n        this.host.pts[i + 1].vec.y += yOff;\n        this.host.pts[i + 3].vec.x -= ratio[0] - newRatio[0];\n      }\n    } else if (i === 1) {\n      if (Math.abs(xOff) > Math.abs(yOff)) {\n        this.host.pts[i].vec.x += xOff;\n        const newRatio = getRatioByNewWidth(ratio[0], ratio[1], ratio[0] + xOff);\n        this.host.pts[i].vec.y += ratio[1] - newRatio[1];\n        this.host.pts[i + 1].vec.x += xOff;\n        this.host.pts[i - 1].vec.y += ratio[1] - newRatio[1];\n      } else {\n        const newRatio = getRatioByNewHeight(ratio[0], ratio[1], ratio[1] + yOff);\n        this.host.pts[i].vec.x += ratio[0] - newRatio[0];\n        this.host.pts[i].vec.y += yOff;\n        this.host.pts[i + 1].vec.x += ratio[0] - newRatio[0];\n        this.host.pts[i - 1].vec.y += yOff;\n      }\n    } else if (i === 2) {\n      if (Math.abs(xOff) > Math.abs(yOff)) {\n        const newRatio = getRatioByNewWidth(ratio[0], ratio[1], ratio[0] + xOff);\n        this.host.pts[i].vec.x += xOff;\n        this.host.pts[i].vec.y = this.host.pts[0].vec.y + newRatio[1];\n        this.host.pts[i - 1].vec.x += xOff;\n        this.host.pts[i + 1].vec.y = this.host.pts[0].vec.y + newRatio[1];\n      } else {\n        const newRatio = getRatioByNewHeight(ratio[0], ratio[1], ratio[1] + yOff);\n        this.host.pts[i].vec.x = this.host.pts[0].vec.x + newRatio[0];\n        this.host.pts[i].vec.y += yOff;\n        this.host.pts[i - 1].vec.x = this.host.pts[0].vec.x + newRatio[0];\n        this.host.pts[i + 1].vec.y += yOff;\n      }\n    } else if (i === 3) {\n      if (Math.abs(xOff) > Math.abs(yOff)) {\n        const newRatio = getRatioByNewWidth(ratio[0], ratio[1], ratio[0] + xOff);\n        this.host.pts[i].vec.x += xOff;\n        this.host.pts[i].vec.y += ratio[1] - newRatio[1];\n        this.host.pts[i - 1].vec.y += ratio[1] - newRatio[1];\n        this.host.pts[0].vec.x += xOff;\n      } else {\n        const newRatio = getRatioByNewHeight(ratio[0], ratio[1], ratio[1] + yOff);\n        this.host.pts[i].vec.x += ratio[0] - newRatio[0];\n        this.host.pts[i].vec.y += yOff;\n        this.host.pts[i - 1].vec.y += yOff;\n        this.host.pts[0].vec.x += ratio[0] - newRatio[0];\n      }\n    }\n  }\n  private resizeConstraintRatio(): number[] {\n    const xx = this.host.pts[1].vec.x - this.host.pts[0].vec.x;\n    const yy = this.host.pts[2].vec.y - this.host.pts[1].vec.y;\n    return [xx, yy];\n  }\n}\n","import { IOGeometry } from '../../../../../../lib/Extended/GeometryUtility';\nimport {\n  getBoundingByVecs,\n  getCenterVecFromVecs,\n  getDistance,\n  NVector3,\n  GType,\n  MouseEventData,\n} from '../../../../../../lib';\nimport { Scene } from '../../../../Scene';\nimport { AGeometryBase } from '../../../Common/Base/AGeometryBase';\nimport { APointBase } from '../../../Common/Base/APointBase';\nimport { APoint } from '../../FamilyPoint/Base/APoint';\nimport { ATextleaderlineWrapper } from '../../FamilyText/ATextleaderline';\nimport { Dimension } from '../../Helper/Dimension';\nimport { ACircleWrapper } from '../ACircleWrapper/ACircleWrapper';\nimport { InteractionComponent } from './Component/InteractionComponent';\nimport { RendererComponent } from './Component/RendererComponent';\nimport { StyleComponent } from './Component/StyleComponent';\nimport { TransformationComponent } from './Component/TransformationComponent';\nexport class ARectangleWrapper extends AGeometryBase {\n  public static isDone = false;\n  public static split = false;\n  public static construction: ARectangleWrapper | undefined;\n  public static isConstraintRatio = false;\n\n  public interaction: InteractionComponent;\n  public transformation: TransformationComponent;\n\n  public pts: APoint[];\n  public vecsCP: NVector3[] = [];\n  public lineWidth: number;\n  public isFill: boolean;\n  public vecRotationHandler: NVector3 = new NVector3(0, 0, 0);\n  public vecs: NVector3[];\n  public isRotate = false;\n  public isConstraintRatio: boolean;\n  public isHoverDuplicatedVecs = false;\n  // ........................... for wrapping\n  // vecOthers: NVector3[];\n  // vecOthersCustom: NVector3[][] | undefined;\n  public vecSelected = -1;\n  public vecSelectedCp = -1;\n  public dimension: Dimension;\n  public enableRotate = false;\n  public static getRectangleFromVoice(scene: Scene) {\n    const cv = new NVector3(\n      scene.annotationInstance.geometryCommon.gcmdProcessing.width * 0.5,\n      scene.annotationInstance.geometryCommon.gcmdProcessing.height * 0.5\n    );\n    this.getRectByVecs(scene, [\n      new NVector3(cv.x - 100, cv.y - 100),\n      new NVector3(cv.x + 100, cv.y - 100),\n      new NVector3(cv.x + 100, cv.y + 100),\n      new NVector3(cv.x - 100, cv.y + 100),\n    ]);\n  }\n  public static findAtPoint(e: MouseEventData): undefined {\n    return undefined;\n  }\n  public static computeHover(e: MouseEventData) {\n    // if (CLine.list.length < 2)return;\n    const obj = ARectangleWrapper.findAtPoint(e);\n\n    if (obj !== null) {\n      // obj.over = true;\n      /* */\n    }\n    // console.log('over');\n  }\n  public static getRectByVecs(scene: Scene, vs: NVector3[]) {\n    const cv = getBoundingByVecs(vs);\n    const geo = new ARectangleWrapper(scene, cv[0].x, cv[0].y, 0, false);\n    const xx = cv[1].x - cv[0].x;\n    const yy = cv[1].y - cv[0].y;\n    geo.pts[1].vec.x += xx;\n    geo.pts[2].vec.x += xx;\n    geo.pts[2].vec.y += yy;\n    geo.pts[3].vec.y += yy;\n\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n    // safeguard for wrapping // do not change it!!\n    geo.updatePos(2, geo.pts[1].vec.x + 1, geo.pts[3].vec.y + 1, 0);\n    scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n  }\n  // public static GetLengthSelection() {\n  //   let i = this.list.length;\n  //   let count = 0;\n  //   while (i--) {\n  //     if (this.list[i].IsSelected) {\n  //       count += 1;\n  //     }\n  //   }\n  //   return count;\n  // }\n  public static getRectByTouch(scene: Scene, e: MouseEventData) {\n    const cv = new NVector3(e.x, e.y, 0);\n    this.getRectByVecs(scene, [\n      new NVector3(cv.x - 100, cv.y - 100),\n      new NVector3(cv.x + 100, cv.y - 100),\n      new NVector3(cv.x + 100, cv.y + 100),\n      new NVector3(cv.x - 100, cv.y + 100),\n    ]);\n  }\n  public static getRect(scene: Scene, e: MouseEventData) {\n    if (ARectangleWrapper.construction === undefined) {\n      ARectangleWrapper.construction = new ARectangleWrapper(scene, e.x, e.y);\n      ARectangleWrapper.construction.IsSelectable = false;\n      return;\n    }\n    ARectangleWrapper.construction.isUnderConstruction = false;\n    ARectangleWrapper.construction.IsSelectable = true;\n\n    // safeguard for wrapping // do not change it!!\n    ARectangleWrapper.construction.updatePos(\n      2,\n      ARectangleWrapper.construction.pts[1].vec.x,\n      ARectangleWrapper.construction.pts[3].vec.y + 0.1,\n      0\n    );\n    // ARectangleWrapper.construction.pts[1].vec.x += 1;\n    // ARectangleWrapper.construction.pts[3].vec.y += 1;\n\n    scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n      ARectangleWrapper.construction.toJSON()\n    );\n    ARectangleWrapper.construction = undefined;\n    return;\n  }\n  public static getRectByPt(p: APoint) {\n    /* */\n  }\n  public static drawShadow(scene: Scene, e: MouseEventData) {\n    if (ARectangleWrapper.construction === undefined) {\n      const p2 = new APoint(scene, e.x, e.y, 0);\n      p2.isSelectable = false;\n    } else {\n      // ARectangleWrapper.construction.ComputeRecPtsWithMouse(e.x, e.y);\n      ARectangleWrapper.construction.pts[1].move(e.x, ARectangleWrapper.construction.pts[1].vec.y);\n      ARectangleWrapper.construction.pts[2].move(e.x, e.y); // TranslateByMouseEventData(e);\n      ARectangleWrapper.construction.pts[3].move(ARectangleWrapper.construction.pts[3].vec.x, e.y);\n      ARectangleWrapper.construction.computeCenterVec();\n      // ARectangleWrapper.construction.UpdateGeoVec();\n      // ARectangleWrapper.construction.pts[2].UpdateGoeVec();\n    }\n  }\n  // .............................................. geometry mananging common\n  public static fromJSON(scene: Scene, g: IOGeometry, isUndo = false, isDeepCopy = false) {\n    const p = APoint.getNodeFromJSON(scene, g.nodes[0], isUndo);\n    const geo = new ARectangleWrapper(scene, p.vec.x, p.vec.y, 0, isUndo);\n    p.remove();\n    for (let i = 1; i < geo.pts.length; ++i) {\n      const v = APoint.getNodeFromJSON(scene, g.nodes[i], isUndo);\n      geo.pts[i].vec.x = v.vec.x;\n      geo.pts[i].vec.y = v.vec.y;\n      geo.pts[i].type = GType.ANODE_RECT;\n      v.remove();\n    }\n    geo.type = GType[g.type];\n\n    geo.isHiddenValue = g.isHidden;\n    if (g.isHidden) {\n      geo.visibility = 0;\n    } else {\n      geo.visibility = 1.0;\n    }\n\n    if (g.styles && g.styles.dash) {\n      geo.styleComponent.renderStyle.dash = g.styles.dash;\n    }\n\n    if (isDeepCopy) {\n      geo.id = scene.getUUID();\n    } else {\n      geo.id = g.id;\n    }\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n    geo.isHover = false;\n    if (g.styles) {\n      geo.updateStyleCustom(g.styles);\n    }\n\n    geo.initVecsHistory();\n\n    if (!isUndo) {\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n    }\n    // ARectangle.construction = undefined;\n    return geo;\n  }\n  public static cancel() {\n    if (ARectangleWrapper.construction !== undefined) {\n      ARectangleWrapper.construction.remove();\n    }\n    ARectangleWrapper.construction = undefined;\n  }\n  // ................................... end implementation\n\n  // .................................................................... end implementation\n  public static mouseDown(scene: Scene, e: MouseEventData) {\n    // scene.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.enablePan = false;\n    // ARectangleWrapper.GetRect(scene, e);\n    /*\n    if (ARectangleWrapper.construction !== undefined) {\n      ARectangleWrapper.GetRect(scene, e);\n      ARectangleWrapper.construction = undefined;\n      ARectangleWrapper.isDone = true;\n    }\n    */\n  }\n  public static onMouseLeftClick(scene: Scene, e: MouseEventData, width = 128, height = 128) {\n    if (ARectangleWrapper.construction) {\n      ARectangleWrapper.construction.remove();\n    }\n    const shape = new ARectangleWrapper(scene, e.x - width * 0.5, e.y - height * 0.5);\n    shape.pts[1].vec.x += width;\n    shape.pts[2].vec.x += width;\n    shape.pts[2].vec.y += height;\n    shape.pts[3].vec.y += height;\n    shape.IsSelectable = true;\n    shape.isUnderConstruction = false;\n    shape.isHover = false;\n    shape.emitAddStack();\n    scene.annotationInstance.activeCommandController.goToACMode();\n    /*\n    if (scene.annotationInstance.activeCommandController.IsTouchEvent) {\n      this.GetRectByTouch(scene, e);\n      scene.annotationInstance.activeCommandController.SetActiveCommand(ACTIVECOMMAND_MODE.SELECT);\n      return;\n    }\n    if (ARectangleWrapper.isDone) {\n      ARectangleWrapper.isDone = false;\n      scene.annotationInstance.activeCommandController.GoToACMode();\n      return;\n    }\n    if (scene.capture !== undefined) {\n      return;\n    }\n    if (ARectangleWrapper.construction === undefined) {\n      ARectangleWrapper.GetRect(scene, e);\n    }\n    */\n  }\n  public static onMouseMiddleClick(e: MouseEventData) {\n    /* */\n  }\n  public static onMouseRightClick(e: MouseEventData) {\n    /* */\n  }\n  public static onMouseDoubleClick(e: MouseEventData) {\n    /* */\n  }\n  // ..........................................\n  public static onMouseMove(scene: Scene, e: MouseEventData) {\n    if (ARectangleWrapper.construction !== undefined) {\n      ARectangleWrapper.drawShadow(scene, e);\n    }\n  }\n  public static onMouseDrag(scene: Scene, e: MouseEventData) {\n    if (ARectangleWrapper.construction !== undefined) {\n      ARectangleWrapper.drawShadow(scene, e);\n    } else {\n      scene.annotationInstance.geometryCommon.gcmdSelecting.deSelectAllObjects();\n      ARectangleWrapper.getRect(scene, e);\n    }\n  }\n  public static onMouseUp(scene: Scene, e: MouseEventData) {\n    if (ARectangleWrapper.construction) {\n      ACircleWrapper.swap(ARectangleWrapper.construction);\n      scene.annotationInstance.activeCommandController.goToACMode();\n      ARectangleWrapper.construction.IsSelectable = true;\n      ARectangleWrapper.construction.isUnderConstruction = false;\n      ARectangleWrapper.construction.isHover = false;\n      // safeguard for creating the min sized rect\n      if (\n        getDistance(\n          ARectangleWrapper.construction.pts[0].vec,\n          ARectangleWrapper.construction.pts[1].vec\n        ) < 5\n      ) {\n        // console.log('safeguard executed')\n        ARectangleWrapper.construction.pts[0].vec.x += -60;\n        ARectangleWrapper.construction.pts[0].vec.y += -60;\n        ARectangleWrapper.construction.pts[1].vec.x += 60;\n        ARectangleWrapper.construction.pts[1].vec.y += -60;\n        ARectangleWrapper.construction.pts[2].vec.x += 60;\n        ARectangleWrapper.construction.pts[2].vec.y += 60;\n        ARectangleWrapper.construction.pts[3].vec.x += -60;\n        ARectangleWrapper.construction.pts[3].vec.y += 60;\n      }\n      ARectangleWrapper.construction.isSelected = false;\n      ARectangleWrapper.construction.computeCenterVec();\n      ARectangleWrapper.construction.emitAddStack();\n      ARectangleWrapper.construction = undefined;\n      ARectangleWrapper.isDone = true;\n    }\n    // scene.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.enablePan = true;\n  }\n  constructor(scene: Scene, x: number, y: number, z = 0, isUndo = false, lineWidth = 8) {\n    super(scene);\n    this.type = GType.RECTANGLE;\n    this.pts = [];\n    this.pts.push(new APoint(scene, x, y, 0, isUndo));\n    this.pts.push(new APoint(scene, x, y, 0, isUndo));\n    this.pts.push(new APoint(scene, x, y, 0, isUndo));\n    this.pts.push(new APoint(scene, x, y, 0, isUndo));\n    for (let i = 0; i < this.pts.length; ++i) {\n      if (isUndo) {\n        this.pts[i].isHoverValue = false;\n      }\n      this.pts[i].type = GType.ANODE_RECT;\n    }\n    this.lineWidth = lineWidth;\n    this.initComponent();\n    this.initVecsCP();\n    this.computeRecPts();\n    this.computeVec();\n    // this.vecsHistory.push(this.computeCenterVec());\n    // this.vec = new NVector3(x, y, 0);\n    this.isConstraintRatio = false;\n    this.initShape();\n    if (!isUndo) {\n      // once mouse up, we want to emit.\n      // this.scene.annotationInstance.io.eventListenerAnnotation.AddGeometryStack(this.ToJSON());\n    }\n  }\n  private initComponent() {\n    this.styleComponent = new StyleComponent(this);\n    this.renderer = new RendererComponent(this);\n    this.interaction = new InteractionComponent(this);\n    this.transformation = new TransformationComponent(this);\n  }\n  private initShape() {\n    this.dimension = new Dimension(this);\n\n    this.isFill = true;\n    this.scene.addARectangleWrapper(this);\n  }\n  public computeCenterVec() {\n    // const v = this.scene.annotationInstance.geometryCommon.gcmdSupporting.toMap(vec.x, vec.y);\n    // this.vec.x = vec.x;\n    // this.vec.y = vec.y;\n    this.vec = getCenterVecFromVecs([\n      this.pts[0].vec,\n      this.pts[1].vec,\n      this.pts[2].vec,\n      this.pts[3].vec,\n    ]);\n    return this.vec;\n  }\n  public computeRecPts() {\n    const v0 = this.pts[0].vec;\n    const v1 = this.pts[2].vec;\n    let x = 0;\n    let y = 0;\n    let z = 0;\n    if (v0.x < v1.x) {\n      x = v0.x;\n    } else {\n      x = v1.x;\n    }\n    if (v0.y < v1.y) {\n      y = v0.y;\n    } else {\n      y = v1.y;\n    }\n    if (v0.z < v1.z) {\n      z = v0.z;\n    } else {\n      z = v1.z;\n    }\n    const nv0 = new NVector3(x, y, z);\n    if (v0.x > v1.x) {\n      x = v0.x;\n    } else {\n      x = v1.x;\n    }\n    if (v0.y > v1.y) {\n      y = v0.y;\n    } else {\n      y = v1.y;\n    }\n    if (v0.z > v1.z) {\n      z = v0.z;\n    } else {\n      z = v1.z;\n    }\n    const nv1 = new NVector3(x, y, z);\n    this.updatePos(1, nv1.x, nv0.y, nv0.z);\n    this.updatePos(3, nv0.x, nv1.y, nv0.z);\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].addEdge(this);\n      this.pts[i].type = GType.ANODE_RECT;\n    }\n    this.updateVecsCP();\n  }\n  public getRelatedVec() {\n    const vs = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      const p = this.pts[i];\n      vs.push(new NVector3(p.vec.x - this.vec.x, p.vec.y - this.vec.y, p.vec.z - this.vec.z));\n    }\n  }\n  public updatePos(i: number, x: number, y: number, z: number) {\n    this.pts[i].vec.x = x;\n    this.pts[i].vec.y = y;\n    this.pts[i].vec.z = z;\n  }\n  public getNodePopup(): APoint | undefined {\n    return this.pts[this.pts.length - 2];\n  }\n  public getArea() {\n    return (this.pts[1].vec.x - this.pts[0].vec.x) * (this.pts[2].vec.y - this.pts[0].vec.y);\n  }\n  public getLog(): string {\n    return this.interaction.getLog();\n  }\n  public set visibility(v: number) {\n    this.visibilityValue = v;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].visibilityValue = v;\n    }\n  }\n  public set IsHiddenChildren(v: boolean) {\n    this.isHiddenPre = this.isHiddenValue;\n    this.isHiddenValue = v;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].isHiddenValue = v;\n    }\n  }\n  public set isHidden(v: boolean) {\n    this.isHiddenPre = this.isHiddenValue;\n    this.isHiddenValue = v;\n    this.IsHiddenChildren = v;\n\n    this.scene.annotationInstance.io.eventListenerAnnotation.hideStack(this.toJSON());\n  }\n  public move(x: number, y: number) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    const xo = x - this.vec.x - (this.pts[1].vec.x - this.pts[0].vec.x) * 0.5;\n    const yo = y - this.vec.y - (this.pts[2].vec.y - this.pts[0].vec.y) * 0.5;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].vec.x += xo;\n      this.pts[i].vec.y += yo;\n    }\n    this.computeCenterVec();\n  }\n  public goToBlackhole() {\n    this.isSelectable = false;\n    this.needBlackhole = true;\n    this.pts.forEach((p) => {\n      p.goToBlackhole();\n    });\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    return this.transformation.translateByMouseEventData(e);\n  }\n  public translate(x: number, y: number): void {\n    return this.transformation.translate(x, y);\n  }\n  public computeConstraintRatio(i: number, xOff: number, yOff: number): void {\n    return this.transformation.computeConstraintRatio(i, xOff, yOff);\n  }\n  public isMouseInside(x: number, y: number): boolean {\n    return this.interaction.isMouseInside(x, y);\n  }\n  public updateVecsBySnapping(p: APointBase, xOff: number, yOff: number) {\n    let index = -1;\n    for (let i = 0; i < this.pts.length; ++i) {\n      if (p === this.pts[i]) {\n        index = i;\n      }\n    }\n    if (index === 0) {\n      this.pts[1].vec.y += yOff;\n      this.pts[3].vec.x += xOff;\n    } else if (index === 1) {\n      this.pts[0].vec.y += yOff;\n      this.pts[2].vec.x += xOff;\n    } else if (index === 2) {\n      this.pts[3].vec.y += yOff;\n      this.pts[1].vec.x += xOff;\n    } else if (index === 3) {\n      this.pts[2].vec.y += yOff;\n      this.pts[0].vec.x += xOff;\n    }\n\n    this.computeCenterVec();\n  }\n  private initVecsCP() {\n    this.vecsCP.push(\n      new NVector3(\n        this.pts[0].vec.x + (this.pts[1].vec.x - this.pts[0].vec.x) * 0.5,\n        this.pts[0].vec.y + (this.pts[1].vec.y - this.pts[0].vec.y) * 0.5,\n        0\n      )\n    );\n    this.vecsCP.push(\n      new NVector3(\n        this.pts[1].vec.x + (this.pts[2].vec.x - this.pts[1].vec.x) * 0.5,\n        this.pts[1].vec.y + (this.pts[2].vec.y - this.pts[1].vec.y) * 0.5,\n        0\n      )\n    );\n    this.vecsCP.push(\n      new NVector3(\n        this.pts[2].vec.x + (this.pts[3].vec.x - this.pts[2].vec.x) * 0.5,\n        this.pts[2].vec.y + (this.pts[3].vec.y - this.pts[2].vec.y) * 0.5,\n        0\n      )\n    );\n    this.vecsCP.push(\n      new NVector3(\n        this.pts[3].vec.x + (this.pts[0].vec.x - this.pts[3].vec.x) * 0.5,\n        this.pts[3].vec.y + (this.pts[0].vec.y - this.pts[3].vec.y) * 0.5,\n        0\n      )\n    );\n  }\n  public updateVecsCP() {\n    this.vecsCP[0].x = this.pts[0].vec.x + (this.pts[1].vec.x - this.pts[0].vec.x) * 0.5;\n    this.vecsCP[0].y = this.pts[0].vec.y + (this.pts[1].vec.y - this.pts[0].vec.y) * 0.5;\n\n    this.vecsCP[1].x = this.pts[1].vec.x + (this.pts[2].vec.x - this.pts[1].vec.x) * 0.5;\n    this.vecsCP[1].y = this.pts[1].vec.y + (this.pts[2].vec.y - this.pts[1].vec.y) * 0.5;\n\n    this.vecsCP[2].x = this.pts[2].vec.x + (this.pts[3].vec.x - this.pts[2].vec.x) * 0.5;\n    this.vecsCP[2].y = this.pts[2].vec.y + (this.pts[3].vec.y - this.pts[2].vec.y) * 0.5;\n\n    this.vecsCP[3].x = this.pts[3].vec.x + (this.pts[0].vec.x - this.pts[3].vec.x) * 0.5;\n    this.vecsCP[3].y = this.pts[3].vec.y + (this.pts[0].vec.y - this.pts[3].vec.y) * 0.5;\n  }\n  public getVecs() {\n    this.vecs = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.vecs.push(this.pts[i].vec);\n    }\n    // v.push(this.pts[0].vec);\n    return this.vecs;\n  }\n  public remove(needEmit = true): void {\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].remove();\n    }\n    if (needEmit) {\n      const ioGeo = this.toJSON();\n      if (ioGeo) {\n        this.scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack([ioGeo]);\n      }\n    }\n    this.deepRemove();\n  }\n  public deepRemove() {\n    this.isSelectable = false;\n    this.isRenderable = false;\n    this.hidePopUpSummary();\n    this.scene.removeARectangleWrapper(this);\n    this.scene.removeGeometry(this);\n  }\n  public getParentType() {\n    return 'ARectangle,ID:' + this.id;\n  }\n  public hide(): void {\n    throw new Error('Method not implemented.');\n  }\n  public set IsSelectable(v: boolean) {\n    this.isSelectable = v;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].isSelectable = v;\n    }\n  }\n  public get IsSelectable() {\n    return this.isSelectable;\n  }\n  public set IsRenderable(bool: boolean) {\n    this.isRenderable = bool;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].isRenderable = bool;\n    }\n  }\n  // .......................................................................... implementation\n  public get isSelected() {\n    return this.isSelectedValue;\n  }\n  public set isSelected(v: boolean) {\n    this.isSelectedValue = v;\n    for (const p of this.pts) {\n      p.isRenderable = v;\n      p.isSelectable = v;\n      p.isSelectedValue = v;\n    }\n    // for (let i = 0; i < this.pts.length; ++i) { this.pts[i].isHidden = v; this.pts[i].Visibility = 0; }\n    this.scene.annotationInstance.io.eventListenerAnnotation.selectionStack(this.toJSON());\n    // if (v) {\n    // }\n  }\n  public get isHover() {\n    return this.isHoverValue;\n  }\n  public set isHover(v: boolean) {\n    if (this.isUnderConstruction) {\n      return;\n    }\n    this.isHoverValue = v;\n\n    if (this.isHoverValue && !this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    } else if (!this.isHoverValue && this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    }\n    this.isHoverPre = this.isHoverValue;\n    if (!this.isSelectedValue) {\n      for (const p of this.pts) {\n        p.isRenderable = v;\n        p.isSelectable = v;\n      }\n    }\n    if (!v) {\n      this.needEmitHoverPost = true;\n      this.hidePopUpSummary();\n    }\n  }\n  public getNode() {\n    const v: NVector3[] = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      v.push(this.pts[i].vec);\n    }\n    return v;\n  }\n  public toJSON(): IOGeometry {\n    const p = new IOGeometry(\n      this.id,\n      this.type,\n      this.isSelectedValue,\n      this.isHoverValue,\n      this.isHiddenValue\n    );\n    p.pushNode(this.getNode());\n\n    const styles = this.styleComponent.toJson();\n    if (styles) {\n      p.styles = styles;\n    }\n\n    return p;\n  }\n  public deepCopy(x: number, y: number, z = 0) {\n    const g = this.toJSON();\n    // if (g) {\n    const ng = ARectangleWrapper.fromJSON(this.scene, g, true, true);\n    ng.move(x, y);\n    ng.emitAddStack();\n    return ng;\n  }\n  public get width() {\n    return this.pts[1].vec.x - this.pts[0].vec.x;\n  }\n  public get height() {\n    return this.pts[2].vec.y - this.pts[1].vec.y;\n  }\n  public computeBoundingVecs() {\n    this.vecs = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.vecs.push(this.pts[i].vec);\n    }\n  }\n  public getBoundary(): NVector3[] {\n    return this.getVecs();\n  }\n  public computeVec() {\n    this.computeBoundingVecs();\n    this.updateVecsCP();\n    this.computeCenterVec();\n  }\n  public mouseRightClick() {\n    this.isFill = !this.isFill;\n    this.isConstraintRatio = !this.isConstraintRatio;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.renderer.renderPost(ctx);\n  }\n  public getVecForSnapping(): NVector3 | undefined {\n    return this.vecSelectedSnapping;\n  }\n  public updateActiveCursor() {\n    this.interaction.updateActiveMouseCursor();\n  }\n  // .................................................................... Leaderline\n  public isMouseInsideSnapFrom(v: NVector3): NVector3 | undefined {\n    return this.interaction.isMouseInsideSnapFrom(v);\n  }\n  public checkAttachedTextleaderline(): boolean {\n    return this.interaction.checkAttachedTextleaderline();\n  }\n  public updateLeaderlineSnap(v: NVector3, tor: number) {\n    return this.interaction.updateLeaderlineSnap(v, tor);\n  }\n  // .................................................................... Leaderline\n  public set textLeaderline(t: ATextleaderlineWrapper | undefined) {\n    // console.log(t);\n    // console.trace();\n    if (t === this.textLeaderlineValue) {\n      return;\n    }\n    if (this.textLeaderlineValue) {\n      if (t) {\n        // this._textLeaderline.leaderline.v2 = new NVector3(this.vec.x, this.vec.y, this.vec.z);\n        // this._textLeaderline.isAttached = false;\n        this.textLeaderlineValue.removeLeaderline();\n        // console.log('dd');\n      }\n    }\n    // if (t) {\n    //   this._textLeaderline = t;\n    // }\n    // console.log(this._textLeaderline);\n    this.textLeaderlineValue = t;\n    // console.log('assigned');\n  }\n  public get textLeaderline(): ATextleaderlineWrapper | undefined {\n    // console.trace();\n    return this.textLeaderlineValue;\n  }\n}\n","import {\n  distanceMouseWithTwoVecs,\n  getDistance,\n  getDistance2,\n  midVec,\n  NVector3,\n  GType,\n  InteractionMode,\n  MouseEventData,\n} from '../../../../../../../lib';\nimport { Scene } from '../../../../../Scene';\nimport { APoint } from '../../../FamilyPoint/Base/APoint';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { APolylineGraphWrapper } from '../APolylineGraphWrapper';\nexport class APolylineEdge {\n  public static isLeave = false;\n  public static tOver = 0;\n  public static tDown1 = 0;\n  public scene: Scene;\n  public pGraph: APolylineGraphWrapper;\n  // pts: APoint[];\n  public p0: APoint;\n  public pm: APoint;\n  public p1: APoint;\n  public arrayVertexs: number[];\n  public arrayWeight: number[];\n  public arrayControlPoint: number[];\n  public isHover: boolean;\n  public isSelected: boolean;\n  public isCurved: boolean;\n  public isRemove: boolean;\n  public isRenderable: boolean;\n  public isSelectable: boolean;\n  public detectionTolerance = 10;\n  public curveTolerance = 3;\n  public needBend = true;\n  public tOver: number;\n  public tDown1: number;\n  public isLeave: boolean;\n  public isHidden: boolean;\n  public isHiddenPre: boolean;\n  public visibility: number;\n  public static renderEdge(scene: Scene, ctx: CanvasRenderingContext2D, rs: RenderStyle, vs: NVector3[], isHover: boolean, isSelected: boolean, isUndo = false, isGrayColor = false, visibility = 0, hashColor: string) {\n    for (let i = 0; i < vs.length - 2; i += 2) {\n      const pt = [vs[i].x, vs[i].y, vs[i + 1].x, vs[i + 1].y, vs[i + 2].x, vs[i + 2].y];\n      const weight = [0.5, 0.5, 0.5, 0.5, 0.5, 0.5];\n      const cp = this.getControlPoints(\n        vs[i].x,\n        vs[i].y,\n        vs[i + 1].x,\n        vs[i + 1].y,\n        vs[i + 2].x,\n        vs[i + 2].y,\n        0.5\n      );\n      this.drawSpline(scene, ctx, rs, pt, cp, weight, isHover, isSelected);\n      this.offscreenRender(scene, rs, hashColor, pt, cp, pt.length);\n    }\n  }\n  public static getControlPoints(x0: number, y0: number, x1: number, y1: number, x2: number, y2: number, t: number) {\n    const d01 = Math.sqrt(Math.pow(x1 - x0, 2) + Math.pow(y1 - y0, 2));\n    const d12 = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n    const fa = (t * d01) / (d01 + d12);\n    const fb = t - fa;\n    const p1x = x1 + fa * (x0 - x2);\n    const p1y = y1 + fa * (y0 - y2);\n    const p2x = x1 - fb * (x0 - x2);\n    const p2y = y1 - fb * (y0 - y2);\n    return [p1x, p1y, p2x, p2y];\n  }\n  public static drawSpline(scene: Scene, ctx: CanvasRenderingContext2D, rs: RenderStyle, cPoints: number[], cps: number[], weights: number[], isHover: boolean, isSelected: boolean) {\n    const pts = cPoints;\n    const cp = cps;\n    const n = pts.length;\n\n    if (isHover || isSelected) {\n      // ADrawingPreset.ShadowMidPointForBending(ctx, MidVec(new NVector3(pts[0], pts[1]), new NVector3(pts[4], pts[5])));\n      scene.annotationInstance.renderer.draw.shape.curve.edgeCurveQuadraticHover(\n        ctx,\n        rs,\n        pts[0],\n        pts[1],\n        cp[0],\n        cp[1],\n        pts[2],\n        pts[3],\n        scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n        isHover,\n        isSelected\n      );\n      scene.annotationInstance.renderer.draw.shape.curve.edgeCurveQuadraticHover(\n        ctx,\n        rs,\n        pts[n - 2],\n        pts[n - 1],\n        cp[2 * n - 10],\n        cp[2 * n - 9],\n        pts[n - 4],\n        pts[n - 3],\n        scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n        isHover,\n        isSelected\n      );\n      this.tOver += 0.015;\n      this.tDown1 = 0;\n      this.isLeave = true;\n    } else {\n      this.tOver = 0;\n    }\n    scene.annotationInstance.renderer.draw.shape.curve.curveQuadratic(\n      ctx,\n      rs,\n      pts[0],\n      pts[1],\n      cp[0],\n      cp[1],\n      pts[2],\n      pts[3],\n      isHover,\n      isSelected\n    );\n    scene.annotationInstance.renderer.draw.shape.curve.curveQuadratic(\n      ctx,\n      rs,\n      pts[n - 2],\n      pts[n - 1],\n      cp[2 * n - 10],\n      cp[2 * n - 9],\n      pts[n - 4],\n      pts[n - 3],\n      isHover,\n      isSelected\n    );\n  }\n  public static offscreenRender(scene: Scene,rs: RenderStyle,hashColor: string,pts: number[],cp: number[],n: number) {\n    scene.annotationInstance.renderer.offscreen.curveQuadraticArrowOffScreen(\n      scene.annotationInstance.renderer.ctxOffscreen,\n      rs,\n      hashColor,\n      pts[0],\n      pts[1],\n      cp[0],\n      cp[1],\n      pts[2],\n      pts[3]\n    );\n    scene.annotationInstance.renderer.offscreen.curveQuadraticArrowOffScreen(\n      scene.annotationInstance.renderer.ctxOffscreen,\n      rs,\n      hashColor,\n      pts[n - 2],\n      pts[n - 1],\n      cp[2 * n - 10],\n      cp[2 * n - 9],\n      pts[n - 4],\n      pts[n - 3]\n    );\n    // if (this.vecOthers && this.vecOthers.length > 0) { scene.annotationInstance.renderer.offscreen.PolygonOffScreenByVecs(this.hashColor, this.vecOthers); }\n  }\n  // .........................................................................................................\n  constructor(scene: Scene, pg: APolylineGraphWrapper, p0: APoint, pm: APoint, p1: APoint) {\n    this.scene = scene;\n    this.pGraph = pg;\n    // this.pts = [];\n    this.tOver = 0;\n    this.tDown1 = 0;\n    this.isLeave = true;\n    this.isHiddenPre = false;\n    this.isRemove = false;\n    this.visibility = 1.0;\n\n    p0.add_AEdge(this);\n    pm.add_AEdge(this);\n    p1.add_AEdge(this);\n\n    this.p0 = p0;\n    this.pm = pm;\n    this.p1 = p1;\n\n    this.p0.type = GType.ANODE;\n    this.pm.type = GType.AMIDPOINT;\n    this.p1.type = GType.ANODE;\n\n    // this.pts.push(this.p0, this.pm, this.p1);\n\n    this.isCurved = false;\n    this.init();\n  }\n  public init() {\n    this.IsHidden = false;\n    this.IsRenderable = true;\n    this.IsSelectable = true;\n  }\n  public get IsHover() {\n    return this.isHover;\n  }\n  public set IsHover(v: boolean) {\n    this.isHover = v;\n    this.p0.isHover = v;\n    this.pm.isHover = v;\n    this.p1.isHover = v;\n  }\n  public get IsRenderable() {\n    return this.isRenderable;\n  }\n  public set IsRenderable(v: boolean) {\n    this.isRenderable = v;\n    if (v) {\n      // const dis = this.p0.vec.Distance(this.pm.vec);\n      // if (30 < dis ) {\n      //     this.p0.isRenderable = true;\n      //     this.pm.isRenderable = true;\n      //     this.p1.isRenderable = true;\n      // } else if (15 < dis && dis <= 30 ) {\n      //     this.p0.isRenderable = true;\n      //     this.pm.isRenderable = false;\n      //     this.p1.isRenderable = true;\n      // } else {\n      //     this.p0.isRenderable = false;\n      //     this.pm.isRenderable = false;\n      //     this.p1.isRenderable = false;\n      // }\n      this.p0.isRenderable = v;\n      this.pm.isRenderable = v;\n      this.p1.isRenderable = v;\n    } else {\n      this.p0.isRenderable = v;\n      this.pm.isRenderable = v;\n      this.p1.isRenderable = v;\n    }\n  }\n  public get IsHidden() {\n    return this.isHidden;\n  }\n  public set IsHidden(v: boolean) {\n    this.isHiddenPre = this.isHidden;\n    this.isHidden = v;\n    // for (let i = 0; i < this.pts.length; ++i) { this.pts[i].IsHidden = v; }\n    this.p0.isHidden = v;\n    this.pm.isHidden = v;\n    this.p1.isHidden = v;\n  }\n  public get Visibility() {\n    return this.visibility;\n  }\n  public set Visibility(v: number) {\n    this.visibility = v;\n    // for (let i = 0; i < this.pts.length; ++i) { this.pts[i].Visibility = 0; }\n    this.p0.visibility = 0;\n    this.pm.visibility = 0;\n    this.p1.visibility = 0;\n  }\n  public get IsSelected() {\n    return this.isSelected;\n  }\n  public set IsSelected(v: boolean) {\n    this.isSelected = v;\n    // this.p0.IsSelected = v; this.pm.IsSelected = v; this.p1.IsSelected = v;\n    this.p0.isRenderable = v;\n    this.pm.isRenderable = v;\n    this.p1.isRenderable = v;\n    // for (let p of this.pts) { p.IsSelected = v; }\n  }\n  public getClosePt(x: number, y: number) {\n    const tor = 10;\n    if (this.p0.distance(x, y) < tor) {\n      return this.p0;\n    }\n    if (this.p1.distance(x, y) < tor) {\n      return this.p1;\n    }\n    if (this.pm.distance(x, y) < tor) {\n      return this.pm;\n    }\n    return undefined;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    // if (this.TranslateDuplicated(e)) { return; }\n    // for (let i = 0; i < this.pts.length; ++i) { this.pts[i].TranslateByMouseEventData(e); }\n    if (!this.p0.isVisited) {\n      this.p0.isVisited = true;\n      this.p0.translateByMouseEventData(e);\n      if (this.p0.textLeaderline) {\n        this.translateForTextLeaderline(e, this.p0);\n        // this.p0.textLeaderline.TranslateByMouseEventData(e);\n      }\n    }\n    if (!this.p1.isVisited) {\n      this.p1.isVisited = true;\n      this.p1.translateByMouseEventData(e);\n      if (this.p1.textLeaderline) {\n        this.translateForTextLeaderline(e, this.p1);\n        // this.p1.textLeaderline.TranslateByMouseEventData(e);\n      }\n    }\n    if (this.isCurved) {\n      if (!this.pm.isVisited) {\n        this.pm.isVisited = true;\n\n        this.pm.vec.x += e.x - e.preX;\n        this.pm.vec.y += e.y - e.preY;\n        // this.pm.TranslateByMouseEventData(e);\n        if (this.pm.textLeaderline) {\n          this.pm.textLeaderline.translateByMouseEventData(e);\n          this.translateForTextLeaderline(e, this.pm);\n        }\n      }\n    }\n  }\n  private translateForTextLeaderline(e: MouseEventData, p: APoint) {\n    if (p.textLeaderline) {\n      // p.textLeaderline.TranslateByMouseEventData(e);\n      if (p.textLeaderline.leaderline) {\n        // if (this.wrapping.needWrappingToLeft || this.wrapping.needWrappingToRight) {\n        p.textLeaderline.leaderline.v2.x = p.vec.x;\n        p.textLeaderline.leaderline.v2.y = p.vec.y;\n        // }\n        return true;\n      }\n    }\n    return false;\n  }\n  public splitEdge(p: APoint) {\n    if (p.type !== GType.AMIDPOINT) {\n      return undefined;\n    }\n\n    const index = this.pGraph.edges.indexOf(this);\n    this.pGraph.edges.splice(index, 1);\n\n    const np = new APoint(this.scene, p.vec.x, p.vec.y, p.vec.z);\n    np.type = GType.ANODE;\n\n    const e0 = this.pGraph.addEdge(this.p0, np);\n    const e1 = this.pGraph.addEdge(np, this.p1);\n\n    this.p0.aEdges.splice(this.p0.aEdges.indexOf(this), 1);\n    this.p1.aEdges.splice(this.p1.aEdges.indexOf(this), 1);\n\n    this.pGraph.edges.splice(index, 0, e1); // insert second one first\n    this.pGraph.edges.splice(index, 0, e0); // insert fist one seond in order\n    // this.pGraph.edges.push(e0);\n    // this.pGraph.edges.push(e1);\n    p.deepRemove();\n    this.pGraph.reBuildConnection();\n    return np;\n  }\n  // reference http://scaledinnovation.com/analytics/splines/aboutSplines.html\n  public computeCurve(weight = 0.5) {\n    this.computeVertex(weight);\n    this.computeWeight(weight);\n    this.computeControlPoint();\n  }\n  public checkIsCurved() {\n    const mv = midVec(this.p0.vec, this.p1.vec);\n    const dis = getDistance(mv, this.pm.vec);\n\n    if (dis < this.curveTolerance) {\n      this.pm.vec.x = mv.x;\n      this.pm.vec.y = mv.y;\n      this.isCurved = false;\n      // this.pm.UpdateGoeVec();\n      return false;\n    }\n    this.isCurved = true;\n    // this.pm.UpdateGoeVec();\n    return true;\n  }\n  public checkIsSnapStraight() {\n    if (this.isCurved) {\n      this.needBend = false;\n      this.curveTolerance = 3;\n    } else {\n      this.needBend = true;\n      this.curveTolerance = 0;\n    }\n  }\n  public isMouseInsideByCurve(x: number, y: number) {\n    this.computeCurve(0.3);\n    if (this.isInsideFirstAndLastCurves(x, y)) {\n      this.IsHover = true;\n      return true;\n    }\n    this.IsHover = false;\n    return false;\n  }\n  public isMouseInside(x: number, y: number): boolean {\n    if (this.isCurved) {\n      if (this.isMouseInsideByCurve(x, y)) {\n        return true;\n      }\n    } else {\n      if (this.distance(x, y) < this.detectionTolerance * this.scene.annotationInstance.activeCommandController.scaleGlobal) {\n        return true;\n      }\n    }\n    return false;\n  }\n  public getOtherPt(p: APoint) {\n    if (this.p0 === p) {\n      return this.p1;\n    }\n    return this.p0;\n  }\n  public distance(x: number, y: number) {\n    return distanceMouseWithTwoVecs(new NVector3(x, y), this.p0.vec, this.p1.vec);\n  }\n  public moveMidPt(e: MouseEventData) {\n    if (this.isCurved) {\n      // this.isDrag = true;\n    } else {\n      const v = midVec(this.p0.vec, this.p1.vec);\n      this.pm.vec.x = v.x;\n      this.pm.vec.y = v.y;\n    }\n    // this.pm.UpdateGoeVec();\n  }\n  public remove() {\n    this.isRemove = true;\n    this.isRenderable = false;\n    this.p0.deepRemove();\n    this.pm.deepRemove();\n    this.p1.deepRemove();\n    this.removeFromParent();\n  }\n  public getCenVec() {\n    return new NVector3(\n      (this.p0.vec.x + this.pm.vec.x + this.p1.vec.x) / 3,\n      (this.p0.vec.y + this.pm.vec.y + this.p1.vec.y) / 3,\n      (this.p0.vec.z + this.pm.vec.z + this.p1.vec.z) / 3\n    );\n  }\n  public getVecs() {\n    return [this.p0.vec, this.pm.vec, this.p1.vec];\n  }\n  public deepRemove() {\n    // this.RemoveFromParent();\n  }\n  public removeFromParent() {\n    this.pGraph.removeEdge(this);\n  }\n  public get IsSelectable() {\n    return this.isSelectable;\n  }\n  public set IsSelectable(v: boolean) {\n    this.isSelectable = v;\n    this.p0.isSelectable = v;\n    this.pm.isSelectable = v;\n    this.p1.isSelectable = v;\n  }\n  public updateMidVec() {\n    if (!this.isCurved) {\n      const mv = midVec(this.p0.vec, this.p1.vec);\n      this.pm.vec.x = mv.x;\n      this.pm.vec.y = mv.y;\n    }\n  }\n  // ..................................................................................... render loop\n  public renderPostHover(ctx: CanvasRenderingContext2D) {\n    if (this.pGraph.isPath) {\n      if (!this.isHover) {\n        return;\n      }\n    }\n\n    if (this.isCurved) {\n      this.computeCurve(); // I need to remove this line because it will be computed anyway.\n      this.drawSplineHover(\n        ctx,\n        this.pGraph.styleComponent.renderStyle,\n        this.arrayVertexs,\n        this.arrayControlPoint,\n        this.arrayWeight,\n        this.isHover,\n        this.isSelected\n      );\n    } else {\n      this.drawLineHover(\n        ctx,\n        this.pGraph.styleComponent.renderStyle,\n        this.isHover,\n        this.isSelected\n      );\n    }\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    if (this.pGraph.isPath) {\n      if (!this.isHover) {\n        return;\n      }\n    }\n    const xOff = this.scene.paramsEditing.croppingMaskParams.x;\n    const yOff = this.scene.paramsEditing.croppingMaskParams.y;\n\n    // this.pm.UpdateGoeVec();\n    if (this.isCurved) {\n      this.computeCurve();\n      this.drawSpline(\n        ctx,\n        this.pGraph.styleComponent.renderStyle,\n        this.arrayVertexs,\n        this.arrayControlPoint,\n        this.arrayWeight,\n        this.isHover,\n        this.isSelected\n      );\n      // ...... offscreen\n      // console.log(this.pGraph.hashColor);\n      APolylineEdge.offscreenRender(\n        this.scene,\n        this.pGraph.styleComponent.renderStyle,\n        this.pGraph.hashColor,\n        this.arrayVertexs,\n        this.arrayControlPoint,\n        this.arrayVertexs.length\n      );\n      // ...... end offscreen\n    } else {\n      this.drawLine(ctx, this.pGraph.styleComponent.renderStyle, this.isHover, this.isSelected);\n\n      // ...... offscreen\n      const pt = [\n        this.p0.vec.x - xOff,\n        this.p0.vec.y - yOff,\n        this.pm.vec.x - xOff,\n        this.pm.vec.y - yOff,\n        this.p1.vec.x - xOff,\n        this.p1.vec.y - yOff,\n      ];\n      const cp = APolylineEdge.getControlPoints(\n        this.p0.vec.x - xOff,\n        this.p0.vec.y - yOff,\n        this.pm.vec.x - xOff,\n        this.pm.vec.y - yOff,\n        this.p1.vec.x - xOff,\n        this.p1.vec.y - yOff,\n        0.5\n      );\n      APolylineEdge.offscreenRender(\n        this.scene,\n        this.pGraph.styleComponent.renderStyle,\n        this.pGraph.hashColor,\n        pt,\n        cp,\n        pt.length\n      );\n      // ...... end offscreen\n    }\n    if (!this.pGraph.scene.annotationInstance.activeCommandController.acProperties.isHiddenLog) {\n      const id = this.pGraph.edges.indexOf(this);\n      ctx.font = '30px Arial';\n      ctx.fillText(id.toString(), this.pm.vec.x, this.pm.vec.y);\n    }\n  }\n  // ............................................................................ render\n  private drawLine(ctx: CanvasRenderingContext2D, rs: RenderStyle, isHover: boolean, isSelected: boolean) {\n    const xOff = this.scene.paramsEditing.croppingMaskParams.x;\n    const yOff = this.scene.paramsEditing.croppingMaskParams.y;\n    // if (isHover || isSelected) {\n    //     this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.EdgePolylineHover(ctx, 0, this.p0.vec.x, this.p0.vec.y, this.p1.vec.x, this.p1.vec.y, NumericalMotion.easeOutElastic2(this.tOver), isHover, this.isSelected);\n    //     this.tOver += 0.015;\n    //     this.tDown1 = 0;\n    //     this.isLeave = true;\n    // } else { this.tOver = 0; }\n    this.scene.annotationInstance.renderer.draw.shape.polyline.edgePolylineLineTo(\n      ctx,\n      this.pGraph.styleComponent.renderStyle,\n      this.p0.vec.x - xOff,\n      this.p0.vec.y - yOff,\n      this.p1.vec.x - xOff,\n      this.p1.vec.y - yOff,\n      false,\n      false,\n      1,\n      1,\n      isHover,\n      this.isSelected\n    );\n  }\n  private drawLineHover(ctx: CanvasRenderingContext2D, rs: RenderStyle, isHover: boolean, isSelected: boolean) {\n    if (isHover || isSelected) {\n      const xOff = this.scene.paramsEditing.croppingMaskParams.x;\n      const yOff = this.scene.paramsEditing.croppingMaskParams.y;\n      this.scene.annotationInstance.renderer.draw.shape.line.edgePolylineHover(ctx, rs, this.p0.vec.x - xOff, this.p0.vec.y - yOff, this.p1.vec.x - xOff, this.p1.vec.y - yOff, this.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver), isHover, this.isSelected);\n      this.tOver += 0.015;\n      this.tDown1 = 0;\n      this.isLeave = true;\n    } else {\n      this.tOver = 0;\n    }\n  }\n  private drawSplineHover(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    cPoints: number[],\n    cps: number[],\n    weights: number[],\n    isHover: boolean,\n    isSelected: boolean\n  ) {\n    // let scale = style.strokeSize;\n    const pts = cPoints;\n    const cp = cps;\n    const n = pts.length;\n    // // ctx.restore();\n    if (isHover || isSelected) {\n      if (\n        this.scene.annotationInstance.implementations.app.model.appCoreWrapper.appControllerStatus\n          .mode === InteractionMode.Drawing\n      ) {\n        this.scene.annotationInstance.renderer.draw.shape.line.shadowMidPointForBending(\n          ctx,\n          rs,\n          midVec(this.p0.vec, this.p1.vec)\n        );\n      }\n      this.scene.annotationInstance.renderer.draw.shape.curve.edgeCurveQuadraticHover(\n        ctx,\n        rs,\n        pts[0],\n        pts[1],\n        cp[0],\n        cp[1],\n        pts[2],\n        pts[3],\n        this.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n        isHover,\n        isSelected\n      );\n      this.scene.annotationInstance.renderer.draw.shape.curve.edgeCurveQuadraticHover(\n        ctx,\n        rs,\n        pts[n - 2],\n        pts[n - 1],\n        cp[2 * n - 10],\n        cp[2 * n - 9],\n        pts[n - 4],\n        pts[n - 3],\n        1,\n        isHover,\n        isSelected\n      );\n      this.tOver += 0.015;\n      this.tDown1 = 0;\n      this.isLeave = true;\n    } else {\n      this.tOver = 0;\n    }\n  }\n  private drawSpline(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    cPoints: number[],\n    cps: number[],\n    weights: number[],\n    isHover: boolean,\n    isSelected: boolean\n  ) {\n    // let scale = style.strokeSize;\n    const pts = cPoints;\n    const cp = cps;\n    const n = pts.length;\n    // // ctx.restore();\n    // if (isHover || isSelected) {\n    //     if (this.scene.annotationInstance.implementations.app.model.appCoreWrapper.appAccessibility.mode === InteractionMode.DRAWING ) {\n    //         this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.ShadowMidPointForBending(ctx, MidVec(this.p0.vec, this.p1.vec));\n    //     }\n    //     this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.EdgeCurveQuadraticHover(ctx, pts[0], pts[1], cp[0], cp[1], pts[2], pts[3], NumericalMotion.easeOutElastic2(this.tOver), isHover);\n    //     this.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.EdgeCurveQuadraticHover(ctx, pts[n - 2], pts[n - 1], cp[2 * n - 10], cp[2 * n - 9], pts[n - 4], pts[n - 3], 1, isHover);\n    //     this.tOver += 0.015;\n    //     this.tDown1 = 0;\n    //     this.isLeave = true;\n    // } else { this.tOver = 0; }\n    this.scene.annotationInstance.renderer.draw.shape.polyline.curveQuadratic(\n      ctx,\n      rs,\n      pts[0],\n      pts[1],\n      cp[0],\n      cp[1],\n      pts[2],\n      pts[3],\n      this.isHover,\n      this.isSelected\n    );\n    this.scene.annotationInstance.renderer.draw.shape.polyline.curveQuadratic(\n      ctx,\n      rs,\n      pts[n - 2],\n      pts[n - 1],\n      cp[2 * n - 10],\n      cp[2 * n - 9],\n      pts[n - 4],\n      pts[n - 3],\n      this.isHover,\n      this.isSelected\n    );\n  }\n  private computeVertex(weight: number) {\n    const vertexs: number[] = [];\n    // for (let p of this.pts) {\n    this.p0.weightLeft = weight;\n    this.p0.weightRight = weight;\n    const xOff = this.scene.paramsEditing.croppingMaskParams.x;\n    const yOff = this.scene.paramsEditing.croppingMaskParams.y;\n    vertexs.push(this.p0.vec.x - xOff, this.p0.vec.y - yOff);\n    this.pm.weightLeft = weight;\n    this.pm.weightRight = weight;\n    vertexs.push(this.pm.vec.x - xOff, this.pm.vec.y - yOff);\n    this.p1.weightLeft = weight;\n    this.p1.weightRight = weight;\n    vertexs.push(this.p1.vec.x - xOff, this.p1.vec.y - yOff);\n    // }\n    this.arrayVertexs = vertexs;\n  }\n  private computeWeight(w = 1) {\n    const weight: number[] = [w, w, w];\n    // for (let i = 0; i < this.pts.length; ++i) { weight.push(w); }\n    this.arrayWeight = weight;\n  }\n  private computeControlPoint() {\n    const pts: number[] = [];\n    for (const ii of this.arrayVertexs) {\n      pts.push(ii);\n    }\n    let cps: number[] = [];\n\n    for (let i = 0; i < pts.length - 4; i += 2) {\n      cps = cps.concat(\n        APolylineEdge.getControlPoints(\n          pts[i] - this.scene.paramsEditing.croppingMaskParams.x,\n          pts[i + 1] - this.scene.paramsEditing.croppingMaskParams.y,\n          pts[i + 2] - this.scene.paramsEditing.croppingMaskParams.x,\n          pts[i + 3] - this.scene.paramsEditing.croppingMaskParams.y,\n          pts[i + 4] - this.scene.paramsEditing.croppingMaskParams.x,\n          pts[i + 5] - this.scene.paramsEditing.croppingMaskParams.y,\n          this.arrayWeight[i]\n        )\n      );\n    }\n    this.arrayControlPoint = cps;\n    return;\n  }\n  private isInsideFirstAndLastCurves(x: number, y: number, r = 100) {\n    const pts = this.arrayVertexs;\n    const cp = this.arrayControlPoint;\n    for (let t = 0.0; t < 1.0; t += 0.001) {\n      // https://stackoverflow.com/questions/7801628/finding-a-point-on-a-b%C3%A9zier-curve-when-given-the-distance-from-the-start-point\n      const x0 =\n        Math.abs(Math.pow(1 - t, 3)) * pts[0] +\n        3 * Math.pow(1 - t, 2) * t * cp[0] +\n        3 * Math.abs(1 - t) * Math.pow(t, 2) * cp[0] +\n        Math.abs(Math.pow(t, 3)) * pts[2];\n      const y0 =\n        Math.abs(Math.pow(1 - t, 3)) * pts[1] +\n        3 * Math.pow(1 - t, 2) * t * cp[1] +\n        3 * Math.abs(1 - t) * Math.pow(t, 2) * cp[1] +\n        Math.abs(Math.pow(t, 3)) * pts[3];\n      const x1 =\n        Math.abs(Math.pow(1 - t, 3)) * pts[2] +\n        3 * Math.pow(1 - t, 2) * t * cp[2] +\n        3 * Math.abs(1 - t) * Math.pow(t, 2) * cp[2] +\n        Math.abs(Math.pow(t, 3)) * pts[4];\n      const y1 =\n        Math.abs(Math.pow(1 - t, 3)) * pts[3] +\n        3 * Math.pow(1 - t, 2) * t * cp[3] +\n        3 * Math.abs(1 - t) * Math.pow(t, 2) * cp[3] +\n        Math.abs(Math.pow(t, 3)) * pts[5];\n      const dis1 = getDistance2(new NVector3(x0, y0), new NVector3(x, y));\n      if (dis1 < r) {\n        return true;\n      }\n      const dis = getDistance2(new NVector3(x1, y1), new NVector3(x, y));\n      if (dis < r) {\n        return true;\n      }\n    }\n    return false;\n  }\n}\n","import { GType, midVec, NVector3, removeVecsWithinDis } from '../../../../../../../lib';\nimport { Scene } from '../../../../../Scene';\nimport { Dimension } from '../../../Helper/Dimension';\n// import { RendererComponent } from '../../../ComponentTemplate/RendererComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\n// import {} from '../../../../'\nexport class ShadowNode {\n  public v: NVector3;\n  public t: number;\n  public type: GType;\n  public isRender: boolean;\n  public scene: Scene;\n  public renderStyleNode: RenderStyle;\n  constructor(scene: Scene, v: NVector3, type: GType) {\n    this.scene = scene;\n    this.type = GType.APOINT;\n    this.v = new NVector3(v.x, v.y);\n    this.t = 0.0;\n    this.isRender = false;\n    this.renderStyleNode = new RenderStyle();\n    this.initStyle(type);\n  }\n  private initStyle(type: GType) {\n    if (type === GType.POLYLINE_BENDING) {\n      RenderStyle.updateRenderColorPolylineNode(\n        this.renderStyleNode,\n        this.scene.annotationInstance.customization.themeCurrent,\n        this.scene.annotationInstance.activeCommandController.activeColorController.activeColor\n      );\n    } else if (type === GType.POLYGON_GRAPH) {\n      RenderStyle.updateRenderColorPolygonNode(\n        this.renderStyleNode,\n        this.scene.annotationInstance.customization.themeCurrent,\n        this.scene.annotationInstance.activeCommandController.activeColorController.activeColor\n      );\n    }\n  }\n  public move(x: number, y: number) {\n    this.v.x = x;\n    this.v.y = y;\n  }\n  public update() {\n    //\n  }\n  public render(ctx: CanvasRenderingContext2D) {\n    if (!this.isRender) {\n      return;\n    }\n    this.t += 0.01;\n    this.update();\n    this.renderPost(ctx);\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.scene.annotationInstance.renderer.draw.shape.node.nodeStart(\n      ctx,\n      this.renderStyleNode,\n      this.v.x - this.scene.paramsEditing.croppingMaskParams.x,\n      this.v.y - this.scene.paramsEditing.croppingMaskParams.y,\n      1,\n      this.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.t)\n    );\n  }\n  // private UpdateScreenVec() {\n  //     const sp = this.scene.annotationInstance.geometryCommon.ToScreen(this.v.long, this.v.lat);\n  //     console.log(this.v.x);\n  //     this.v.x = sp[0]; this.v.y = sp[1];\n  // }\n}\nexport class ShadowMidNode extends ShadowNode {\n  constructor(scene: Scene, v: NVector3, type: GType) {\n    super(scene, v, type);\n    this.type = GType.AMIDPOINT;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.scene.annotationInstance.renderer.draw.shape.node.nodeMidStart(\n      ctx,\n      this.renderStyleNode,\n      this.v.x - this.scene.paramsEditing.croppingMaskParams.x,\n      this.v.y - this.scene.paramsEditing.croppingMaskParams.y,\n      this.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.t)\n    );\n  }\n}\n\nexport class APolylineGraphShadow {\n  type: GType;\n  ps: ShadowNode[];\n  psMid: ShadowNode[];\n  MouseVec: NVector3;\n\n  isConstraintDrawing: boolean;\n  constraintLength: number;\n\n  dimension: Dimension;\n  scene: Scene;\n  renderStyle: RenderStyle;\n  constructor(scene: Scene, type: GType, constraintLength = 100) {\n    this.scene = scene;\n    this.type = type;\n    this.constraintLength = constraintLength;\n    if (constraintLength !== 0) {\n      this.isConstraintDrawing = true;\n    } else {\n      this.isConstraintDrawing = false;\n    }\n    this.ps = [];\n    this.psMid = [];\n    this.renderStyle = new RenderStyle();\n    // this.\n    this.renderStyle.scaleGlobal = this.scene.annotationInstance.activeCommandController.scaleGlobal;\n    this.initStyle(type);\n  }\n  private initStyle(type: GType) {\n    if (type === GType.POLYLINE_BENDING) {\n      RenderStyle.updateRenderColorPolyline(\n        this.renderStyle,\n        this.scene.annotationInstance.customization.themeCurrent,\n        this.scene.annotationInstance.activeCommandController.activeColorController.activeColor\n      );\n    } else if (type === GType.POLYGON_GRAPH) {\n      RenderStyle.updateRenderColorPolygon(\n        this.renderStyle,\n        this.scene.annotationInstance.customization.themeCurrent,\n        this.scene.annotationInstance.activeCommandController.activeColorController.activeColor,\n        this.scene.annotationInstance.activeCommandController.activeColorController.activeColor\n      );\n    }\n  }\n  public getVecs(): NVector3[] | undefined {\n    const vs: NVector3[] = [];\n    for (let i = 1; i < this.ps.length; ++i) {\n      const p = this.ps[i].v;\n      vs.push(p);\n    }\n    // const mp = this.scene.annotationInstance.geometryCommon.gcmdSupporting.ToMap();\n    const mmp = new NVector3(this.MouseVec.x + this.scene.paramsEditing.croppingMaskParams.x, this.MouseVec.y + this.scene.paramsEditing.croppingMaskParams.y);\n    vs.push(mmp);\n    return removeVecsWithinDis(vs, 2);\n\n    // for (let i = 1; i < this.ps.length; ++i) { vs.push(this.ps[i].v); }\n    // if (vs.length < 3) {\n    //     return undefined;\n    // } else {\n    //     return RemoveVecsWithinDis(vs, 2);\n    // }\n  }\n  public getVecsVis() {\n    const vs: NVector3[] = [];\n    for (let i = 1; i < this.ps.length; ++i) {\n      const p = this.ps[i].v;\n      // const mp = this.scene.annotationInstance.geometryCommon.ToMap(p.x, p.y);\n      // p.long = mp[0]; p.lat = mp[1];\n      vs.push(new NVector3(p.x - this.scene.paramsEditing.croppingMaskParams.x, p.y - this.scene.paramsEditing.croppingMaskParams.y));\n    }\n    return vs;\n  }\n  public add(v: NVector3) {\n    const sn = new ShadowNode(this.scene, new NVector3(v.x, v.y), this.type);\n    this.ps.push(sn);\n    if (this.ps.length > 2) {\n      this.ps[this.ps.length - 1].isRender = true;\n      this.MouseVec = new NVector3(\n        this.ps[this.ps.length - 1].v.x - this.scene.paramsEditing.croppingMaskParams.x,\n        this.ps[this.ps.length - 1].v.y - this.scene.paramsEditing.croppingMaskParams.y\n      );\n      this.addMid(this.ps[this.ps.length - 2].v, this.ps[this.ps.length - 1].v);\n    } else {\n      this.ps[0].isRender = true;\n      this.MouseVec = new NVector3(\n        this.ps[this.ps.length - 1].v.x - this.scene.paramsEditing.croppingMaskParams.x,\n        this.ps[this.ps.length - 1].v.y - this.scene.paramsEditing.croppingMaskParams.y\n      );\n    }\n  }\n  public mouseMove(x: number, y: number) {\n    this.MouseVec.x = x - this.scene.paramsEditing.croppingMaskParams.x;\n    this.MouseVec.y = y - this.scene.paramsEditing.croppingMaskParams.y;\n  }\n  public undo() {\n    if (this.ps.length < 3) {\n      this.scene.listAPolylineGraphShadow = undefined;\n      this.scene.annotationInstance.activeCommandController.goToACMode();\n      return;\n    }\n    this.ps.pop();\n    this.psMid.pop();\n  }\n  public render(ctx: CanvasRenderingContext2D) {\n    this.update();\n    this.renderPLine(ctx);\n    // this.RenderMidNode(ctx); // we do not want to render mid pts when constructing\n    this.renderNode(ctx);\n\n    if (this.scene.annotationInstance.activeCommandController.acProperties.showUnit) {\n      const vecs = this.getVecs();\n      if (vecs) {\n        // console.log(vecs);\n        // console.log(vecs[vecs.length - 2].x, vecs[vecs.length - 2].y);\n        // console.log(vecs[vecs.length - 1].x, vecs[vecs.length - 1].y);\n        this.dimension.renderLength(ctx, false, vecs);\n        this.dimension.renderTotalLength(ctx, vecs);\n      }\n    }\n  }\n  private addMid(v0: NVector3, v1: NVector3) {\n    const v = midVec(v0, v1);\n    const vm = new ShadowMidNode(this.scene, new NVector3(v.x, v.y), this.type);\n    vm.isRender = true;\n    this.psMid.push(vm);\n  }\n  private update() {\n    let l = this.ps.length;\n    while (l--) {\n      this.ps[l].update();\n    }\n    l = this.psMid.length;\n    while (l--) {\n      this.psMid[l].update();\n    }\n  }\n  private renderPLine(ctx: CanvasRenderingContext2D) {\n    if (this.type === GType.POLYLINE_BENDING) {\n      this.scene.annotationInstance.renderer.draw.shape.line.polylineShadow(\n        ctx,\n        this.renderStyle,\n        this.getVecsVis(),\n        this.MouseVec,\n        this.type\n      );\n    } else if (this.type === GType.POLYGON_GRAPH) {\n      this.scene.annotationInstance.renderer.draw.shape.line.polygonShadow(\n        ctx,\n        this.renderStyle,\n        this.getVecsVis(),\n        this.MouseVec,\n        this.type\n      );\n    }\n  }\n  private renderNode(ctx: CanvasRenderingContext2D) {\n    // console.log(this.ps.length);\n    let l = this.ps.length;\n    while (l--) {\n      this.ps[l].render(ctx);\n    }\n  }\n  // private RenderMidNode(ctx: CanvasRenderingContext2D) {\n  //     let l = this.psMid.length; while (l--) { this.psMid[l].Render(ctx); }\n  // }\n}\n","import { RendererComponent as _RendererComponent } from '../../../../Common/Base/ComponentTemplate/RendererComponent';\nimport { APolylineGraphWrapper } from '../APolylineGraphWrapper';\nexport class RendererComponent extends _RendererComponent {\n  public host: APolylineGraphWrapper;\n  constructor(host: APolylineGraphWrapper) {\n    super(host);\n    this.host = host;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    if (this.host.isRemove || !this.host.isRenderable) {\n      return;\n    }\n    this.interpolateColor.update();\n\n    this.host.computeCenterVec();\n    this.timer.updatePopupSummery();\n\n    // if (this.host.scene.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.isViewChanging) {\n    //   for (let ii = 0; ii < this.host.edges.length; ++ii) {\n    //     this.host.edges[ii].UpdateGoeVec();\n    //   }\n    // }\n    this.host.updateProjection();\n\n    this.renderPostGeometry(ctx);\n  }\n  private renderPostGeometry(ctx: CanvasRenderingContext2D) {\n    if (this.host.scene.annotationInstance.activeCommandController.acProperties.showUnit) {\n      if (this.host.isHoverValue || this.host.isUnderConstruction) {\n        this.host.dimension.renderLength(ctx, false, this.host.getVecs());\n        // this.host.dimension.RenderTotalLength(ctx, this.host.vecs);\n      }\n    }\n\n    this.renderHoverEffect(ctx);\n\n    // ... render polyline\n    if (this.host.scene.annotationInstance.renderer.draw.shape.draw.renderer.needFocus && !this.host.isHoverValue) {\n      ctx.strokeStyle = this.host.styleComponent.renderStyle.colorInterpolatedString;\n    } else {\n      ctx.strokeStyle = this.host.styleComponent.renderStyle.colorInterpolatedString;\n    }\n    if (this.host.isSelectedValue) {\n      ctx.strokeStyle = this.host.styleComponent.renderStyle.colorInterpolatedString;\n    }\n\n    ctx.lineWidth = this.host.styleComponent.renderStyle.lineWidth * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal;\n    ctx.beginPath();\n\n    let x =  this.host.edges[0].p0.vec.x - this.host.scene.paramsEditing.croppingMaskParams.x;\n    let y =  this.host.edges[0].p0.vec.y - this.host.scene.paramsEditing.croppingMaskParams.y;\n    ctx.moveTo(x, y)\n    const i = this.host.edges.length;\n    for (let index = 0; index < i; ++index) {\n      this.host.edges[index].renderPost(ctx);\n    }\n    ctx.lineCap = 'round';\n    ctx.setLineDash(this.host.styleComponent.renderStyle.dash);\n    ctx.stroke();\n    ctx.setLineDash([0, 0]);\n\n    // ... end render polyline\n\n    // APolylineEdge.OffscreenRender(this.host.scene, this.host.hashColor, )\n  }\n  private renderHoverEffect(ctx: CanvasRenderingContext2D) {\n    const methodNew = true;\n    const i = this.host.edges.length;\n\n    if (this.host.isHover || this.host.isSelected) {\n      if (!methodNew) { // render for each segment including straight lines and bending curves\n        for (let index = 0; index < i; ++index) {\n          this.host.edges[index].renderPostHover(ctx);\n        }\n      } else {\n        this.tOver += 0.015;\n        this.tDown1 = 0;\n        this.host.isLeave = true;\n\n        const xOff = this.host.scene.paramsEditing.croppingMaskParams.x;\n        const yOff = this.host.scene.paramsEditing.croppingMaskParams.y;\n        const rs = this.host.styleComponent.renderStyle;\n\n        const easing = this.host.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver)\n        ctx.lineWidth = easing * rs.lineWidth * rs.scaleGlobal * rs.scaleLocal * this.host.scene.annotationInstance.implementations.imageAnnoApp.customization.themeCurrent.properties.elasticScale;\n\n        ctx.beginPath();\n        for (let index = 0; index < i; ++index) {\n          const p0 = this.host.edges[index].p0;\n          ctx.moveTo(p0.vec.x - xOff, p0.vec.y - yOff);\n          const p1 = this.host.edges[index].p1;\n          ctx.strokeStyle = this.host.scene.annotationInstance.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString;\n          ctx.lineTo(p1.vec.x - xOff, p1.vec.y - yOff);\n        }\n        ctx.setLineDash(rs.dash);\n        ctx.lineCap = 'round';\n        ctx.stroke();\n        ctx.setLineDash([0, 0]);\n      }\n    } else {\n      this.tOver = 0;\n    }\n  }\n}\n","// import { SIZE } from '../../../../../../../../../lib/Enum';\nimport { ThemeColorId } from '../../../../../Customization/ThemeRenderStyle/Utility';\nimport { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { APolylineGraphWrapper } from '../APolylineGraphWrapper';\nexport class StyleComponent extends _StyleComponent {\n  public geo: APolylineGraphWrapper;\n  constructor(geo: APolylineGraphWrapper) {\n    super(geo);\n    this.updateStyle();\n    this.updateColor();\n  }\n  public updateStyle() {\n    if (!this.isCustom) {\n      this.state.themeColorId = ThemeColorId.AccentColor1;\n      this.isCustom = true;\n      RenderStyle.updateRenderStylePolyline(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n      RenderStyle.updateRenderStylePolylineNode(\n        this.renderStyleNode,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n      if (this.geo.edges) {\n        for (let i = 0; i < this.geo.edges.length; ++i) {\n          this.geo.edges[i].p0.styleComponent.updateStyleForNode(this.renderStyleNode);\n          this.geo.edges[i].pm.styleComponent.updateStyleForNode(this.renderStyleNode);\n          this.geo.edges[i].p1.styleComponent.updateStyleForNode(this.renderStyleNode);\n        }\n      }\n    }\n  }\n  public updateColor(color: number[] | undefined = undefined) {\n    this.isCustom = true;\n    if (color === undefined) {\n      color = this.geo.scene.annotationInstance.activeCommandController.activeColorController.activeColor;\n    }\n    RenderStyle.updateRenderColorPolyline(\n      this.renderStyle,\n      this.geo.scene.annotationInstance.customization.themeCurrent,\n      color\n    );\n    RenderStyle.updateRenderColorPolylineNode(\n      this.renderStyleNode,\n      this.geo.scene.annotationInstance.customization.themeCurrent,\n      color\n    );\n    if (this.geo.edges) {\n      for (let i = 0; i < this.geo.edges.length; ++i) {\n        this.geo.edges[i].p0.styleComponent.updateStyleForNode(this.renderStyleNode);\n        this.geo.edges[i].pm.styleComponent.updateStyleForNode(this.renderStyleNode);\n        this.geo.edges[i].p1.styleComponent.updateStyleForNode(this.renderStyleNode);\n      }\n    }\n    this.tempColorRgba = color;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public updateStyleCustom(style: any): boolean {\n    // if (this.isSameStyle(style)) {\n    //   return false;\n    // }\n    const needEmit = false;\n\n    if (style.width) {\n      this.state.width = style.width;\n    }\n    if (style.color !== undefined) {\n      this.state.themeColorId = style.color as ThemeColorId;\n    }\n\n    if (style.colorRgba.length > 0) {\n      this.tempColorRgba = style.colorRgba;\n      RenderStyle.updateRenderStylePolylineCustom(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent,\n        style.colorRgba\n      );\n      RenderStyle.updateRenderStylePolylineNodeCustom(\n        this.renderStyleNode,\n        this.geo.scene.annotationInstance.customization.themeCurrent,\n        style.colorRgba\n      );\n      if (this.geo.edges) {\n        for (let i = 0; i < this.geo.edges.length; ++i) {\n          this.geo.edges[i].p0.styleComponent.updateStyleForNode(this.renderStyleNode);\n          this.geo.edges[i].pm.styleComponent.updateStyleForNode(this.renderStyleNode);\n          this.geo.edges[i].p1.styleComponent.updateStyleForNode(this.renderStyleNode);\n        }\n      }\n    }\n    if (style.scale) {\n      this.renderStyle.scaleLocal = style.scale;\n      this.state.scale = style.scale;\n    }\n    this.isCustom = true;\n    if (needEmit && !this.geo.isUnderConstruction) {\n      this.geo.isTransform = true;\n      // this.geoHost.scene.annotationInstance.io.eventListenerAnnotation.TransformStack([this.geoHost.ToJSON()]);\n    }\n    if (style.colorRgba.length > 0) {\n      this.updateColor(style.colorRgba);\n    }\n    return true;\n  }\n  public setDash(v: number[]) {\n    this.renderStyle.dash = v;\n    this.geo.scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n      this.geo.toJSON()\n    );\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public toJson(): any | undefined {\n    if (!this.isCustom) {\n      return undefined;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const output: any = {\n      width: this.state.width,\n      scale: this.renderStyle.scaleLocal,\n      colorRgba: this.tempColorRgba, // this is necessary for updating state on React side\n    };\n\n    // box: {\n    //   dash: this.styleBox.dash,\n    //   fill: this.styleBox.fillStyle,\n    //   width: this.styleBox.lineWidth,\n    //   strokeStyle: this.styleBox.strokeStyle\n    // },\n    // anchorNode: {\n    //   dash: this.styleAnchorNode.dash,\n    //   fill: this.styleAnchorNode.fillStyle,\n    //   width: this.styleAnchorNode.lineWidth,\n    //   strokeStyle: this.styleAnchorNode.strokeStyle\n    // },\n    // handleNode: {\n    //   dash: this.styleHandleNode.dash,\n    //   fill: this.styleHandleNode.fillStyle,\n    //   width: this.styleHandleNode.lineWidth,\n    //   strokeStyle: this.styleHandleNode.strokeStyle\n    // },\n    // leaderline: {\n    //   dash: this.styleLeaderline.dash,\n    //   width: this.styleLeaderline.lineWidth,\n    //   strokeStyle: this.styleLeaderline.strokeStyle,\n    // },\n    // width: this.state.width,\n    // scale: this.state.scale,\n    // colorRgba: this.tempColorRgba,\n    // };\n\n    // if (this.state.backgroundColor !== ThemeColorId.TitleColor) {\n    //   output.backgroundColor = this.state.backgroundColor;\n    // }\n    if (this.state.themeColorId !== ThemeColorId.AccentColor1) {\n      output.color = this.state.themeColorId;\n    }\n\n    // if (this.state.lineTypeId !== LineTypeId.Continuous) {\n    //   output.lineDash = this.state.lineTypeId;\n    // }\n    return output;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  protected isSameStyle(style: any) {\n    if (style.colorRgba.length === this.tempColorRgba.length) {\n      for (let i = 0; i < style.colorRgba.length; i++) {\n        if (style.colorRgba[i] !== this.tempColorRgba[i]) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n}\n","import { IOGeometry } from '../../../../../../lib/Extended/GeometryUtility';\nimport {\n  getCenterVecFromVecs,\n  getDistance,\n  midVec,\n  NVector3,\n  GType,\n  MouseEventData,\n} from '../../../../../../lib';\nimport { Scene } from '../../../../Scene';\nimport { AGeometryBase } from '../../../Common/Base/AGeometryBase';\nimport { APolygonWrapper } from '../../FamilyArea/APolygonWrapper/APolygonWrapper';\nimport { APoint } from '../../FamilyPoint/Base/APoint';\n// import { CPathAni } from '../../../../AppMapticon/CMapticon/CPathAni';\nimport { Dimension } from '../../Helper/Dimension';\n// import { CPoint } from '../AGeometry/CPoint';\nimport { APolylineEdge } from './Base/APolylineEdge';\nimport { APolylineGraphShadow } from './Base/APolylineGraphShadow';\nimport { RendererComponent } from './Component/RendererComponent';\nimport { StyleComponent } from './Component/StyleComponent';\nexport class APolylineGraphWrapper extends AGeometryBase {\n  public static isSplit = true;\n  public edges: APolylineEdge[];\n  // protected _isHover: boolean;\n  // vecs: NVector3[];\n  // vecsMid: NVector3[];\n  public isClosed: boolean;\n  public isPath: boolean;\n  // cPathAni: CPathAni | undefined;\n\n  public dimension: Dimension;\n  public torVisMidPt = 10;\n\n  // ........................... for wrapping\n  public vecOthers: NVector3[] | undefined;\n\n  public vecOthersCustom: NVector3[][] | undefined;\n  public vecSelected = -1;\n  public vecsBound: NVector3[];\n\n  public renderer: RendererComponent;\n\n  public static findAtPoint(scene: Scene, e: MouseEventData) {\n    for (let i = scene.listAPolylineGraphWrapper.length - 1; i >= 0; --i) {\n      if (\n        scene.listAPolylineGraphWrapper[i].isSelectable &&\n        scene.listAPolylineGraphWrapper[i].isMouseInside(e.x, e.y)\n      ) {\n        return scene.listAPolylineGraphWrapper[i];\n      }\n    }\n    return undefined;\n  }\n  public static getLengthSelection(scene: Scene) {\n    let i = scene.listAPolylineGraphWrapper.length;\n    let count = 0;\n    while (i--) {\n      if (scene.listAPolylineGraphWrapper[i].isSelected) {\n        count += 1;\n      }\n    }\n    return count;\n  }\n  public static computeOver(scene: Scene, e: MouseEventData) {\n    const cl = this.findAtPoint(scene, e);\n    if (cl !== undefined) {\n      cl.isHoverValue = true;\n    }\n  }\n  public static computeVectorsForBuild() {\n    /* */\n  }\n  // ............................................................... construction\n  public static fromJSON(scene: Scene, g: IOGeometry, isUndo = false, isDeepCopy = false) {\n    const vs: NVector3[] = [];\n    for (let i = 0; i < g.nodes.length; i += 2) {\n      const sp = [g.nodes[i].sx, g.nodes[i].sy];\n      const p = new NVector3(sp[0], sp[1]);\n      vs.push(p);\n    }\n    const geo = new APolylineGraphWrapper(scene, vs, GType.POLYLINE_BENDING, isUndo, true);\n\n    // geo.UpdateGeometryByProjectedpos(pros);\n    geo.type = GType[g.type];\n    if (isDeepCopy) {\n      geo.id = scene.getUUID();\n    } else {\n      geo.id = g.id;\n    }\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n    geo.isHover = false;\n\n    // const k = 1;\n    // for (let i = 0; i < geo.edges.length; ++i) {\n    //   let p = g.nodes[k];\n    //   let sp = scene.annotationInstance.geometryCommon.gcmdSupporting.toScreenFromProjectedPos(p.proX, p.proY);\n    //   geo.edges[i].pm.vec.x = sp[0];\n    //   geo.edges[i].pm.vec.y = sp[1];\n    //   geo.edges[i].pm.updateScreenVec();\n    //   geo.edges[i].checkIsCurved();\n    //   k += 2;\n    // }\n\n    if (g.styles && g.styles.dash) {\n      geo.styleComponent.renderStyle.dash = g.styles.dash;\n    }\n\n    geo.isHiddenValue = g.isHidden;\n    if (g.isHidden) {\n      geo.visibilityValue = 0;\n    } else {\n      geo.visibilityValue = 1.0;\n    }\n    if (g.styles) {\n      geo.updateStyleCustom(g.styles);\n    }\n    // geo.wrapping.InitProjectionShapesFromJSON(geo.GetVecs());\n    // geo.wrapping.UpdateProjection(geo.GetVecs());\n    geo.computeCenterVec();\n    geo.initVecsHistory();\n    if (!isUndo) {\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n    }\n    return geo;\n  }\n  public static getLine(e: MouseEventData) {\n    /* */\n  }\n  public static getLineByPt(p: APoint) {\n    /* */\n  }\n\n  // ................................... end implementation\n  // static Add(g: APolylineGraphWrapper) {\n  //\n  //     APolylineGraphWrapper.list.push(g);\n  // }\n  // static Remove(g: APolylineGraphWrapper) {\n  //\n  //     APolylineGraphWrapper.list.splice(APolylineGraphWrapper.list.indexOf(g), 1);\n  // }\n  // .................................................................... end implementation\n  // static MouseDown(e: MouseEventData) {\n  //     /* */\n  // }\n  public static mouseDown(scene: Scene, e: MouseEventData) {\n    // let cGeo = AGeometryCommon.FindAtPoint(e);\n    // if (cGeo) { return; }\n    if (scene.listAPolylineGraphShadow === undefined) {\n      return;\n    }\n    if (scene.listAPolylineGraphShadow.ps.length > 0) {\n      scene.listAPolylineGraphShadow.add(new NVector3(e.x, e.y));\n    }\n  }\n  public static mouseLeftClick(scene: Scene, e: MouseEventData) {\n    if (scene.capture !== undefined) {\n      return;\n    }\n    if (scene.listAPolylineGraphShadow === undefined) {\n      scene.listAPolylineGraphShadow = new APolylineGraphShadow(scene, GType.POLYLINE_BENDING);\n      scene.listAPolylineGraphShadow.add(new NVector3(e.x, e.y));\n      scene.listAPolylineGraphShadow.add(new NVector3(e.x, e.y));\n    }\n    scene.annotationInstance.implementations.app.model.ioWrapper.eventInteraction.isEnableZoomByDoubleClick = false;\n  }\n  public static mouseMove(scene: Scene, e: MouseEventData) {\n    if (scene.listAPolylineGraphShadow === undefined) {\n      return;\n    }\n    if (scene.annotationInstance.activeCommandController.acProperties.pressShift) {\n      const p0 = scene.listAPolylineGraphShadow.ps[scene.listAPolylineGraphShadow.ps.length - 1];\n      if (getDistance(p0.v, new NVector3(e.x, e.y)) > 20) {\n        scene.listAPolylineGraphShadow.add(new NVector3(e.x, e.y));\n      }\n    }\n    if (scene.listAPolylineGraphShadow.ps.length > 1) {\n      scene.listAPolylineGraphShadow.mouseMove(e.x, e.y);\n      // scene.listAPolylineGraphShadow.ps[scene.listAPolylineGraphShadow.ps.length - 1].Move(e.x, e.y);\n    }\n  }\n  public static mouseDoubleClick(scene: Scene, e: MouseEventData) {\n    if (scene.listAPolylineGraphShadow === undefined) {\n      return;\n    }\n\n    // console.log(scene.annotationInstance.activeCommandController.IsTouchEvent);\n    if (scene.annotationInstance.activeCommandController.IsTouchEvent) {\n      if (scene.listAPolylineGraphShadow.ps.length > 1) {\n        let vs = scene.listAPolylineGraphShadow.getVecs();\n        if (vs) {\n          vs = vs.slice(0, vs.length - 1);\n          if (vs) {\n            APolylineGraphWrapper.getPolyline(scene, vs);\n            scene.listAPolylineGraphShadow = undefined;\n            scene.annotationInstance.activeCommandController.goToACMode();\n          } else {\n            scene.listAPolylineGraphShadow = undefined;\n            scene.annotationInstance.activeCommandController.goToACMode();\n          }\n        }\n      }\n    } else {\n      if (scene.listAPolylineGraphShadow.ps.length > 1) {\n        const vs = scene.listAPolylineGraphShadow.getVecs();\n        if (vs) {\n          APolylineGraphWrapper.getPolyline(scene, vs);\n          scene.listAPolylineGraphShadow = undefined;\n          scene.annotationInstance.activeCommandController.goToACMode();\n        } else {\n          scene.listAPolylineGraphShadow = undefined;\n          scene.annotationInstance.activeCommandController.goToACMode();\n        }\n      }\n    }\n\n    scene.annotationInstance.implementations.app.model.ioWrapper.eventInteraction.isEnableZoomByDoubleClick = true;\n  }\n  public static undo(scene: Scene, e: MouseEventData) {\n    if (scene.listAPolylineGraphShadow !== undefined) {\n      scene.listAPolylineGraphShadow.undo();\n    }\n  }\n  public static doneByKeyboard(scene: Scene) {\n    if (scene.listAPolylineGraphShadow !== undefined) {\n      const vs = scene.listAPolylineGraphShadow.getVecs();\n      if (vs) {\n        APolylineGraphWrapper.getPolyline(scene, vs);\n        scene.listAPolylineGraphShadow = undefined;\n        scene.annotationInstance.activeCommandController.goToACMode();\n      } else {\n        scene.listAPolylineGraphShadow = undefined;\n        scene.annotationInstance.activeCommandController.goToACMode();\n      }\n    }\n  }\n  public static cancel(scene: Scene) {\n    if (scene.listAPolylineGraphShadow !== undefined) {\n      scene.listAPolylineGraphShadow = undefined;\n    }\n  }\n  public static getPolyline(scene: Scene, vs: NVector3[], autoClosing = false) {\n    if (vs.length < 2) {\n      return undefined;\n    }\n    if (autoClosing) {\n      if (getDistance(vs[0], vs[vs.length - 1]) < 10) {\n        APolygonWrapper.getPolygonbyVecs(scene, vs);\n        return undefined;\n      }\n    }\n    scene.listAPolylineGraphShadow = undefined;\n    return new APolylineGraphWrapper(scene, vs, GType.POLYLINE_BENDING, false, true);\n  }\n  // ..........................................................................................\n  constructor(\n    scene: Scene,\n    vs: NVector3[],\n    type: GType = GType.POLYLINE_BENDING,\n    isUndo = false,\n    isScreen = true\n  ) {\n    super(scene);\n    // console.log(vs);\n    // this.vec = NVector3.GetCenterVecFromVecs(vs);\n    // let mp = this.scene.annotationInstance.geometryCommon.ToMap(this.vec.x, this.vec.y);\n    // (this.vec.long = mp[0]), (this.vec.lat = mp[1]);\n    // (this.vec.proX = mp[2]), (this.vec.proY = mp[3]);\n    // console.log();\n    // console.log(this.vec.long);\n    // this.vecs = vs;\n    this.type = type;\n    this.isUnderConstruction = false;\n    this.isSelectable = true;\n    this.isRenderable = true;\n    this.isUndo = isUndo;\n    this.isPath = false;\n    this.initComponent();\n    // this.vecsMid = [];\n    this.checkIsClosed(vs);\n    const pts = this.computeNode(vs, isScreen);\n    this.computeEdge(pts);\n    this.computeCenterVec();\n    this.initVecsHistory();\n\n    this.isMovedValue = true; // reset for transform stack to solve the issue that it never emit the stack when it happens first time.\n    // this.IsMove = false;\n    // this.IsTransform = false;\n    this.initPolylineGraph();\n  }\n  public initPolylineGraph() {\n    this.dimension = new Dimension(this);\n    if (!this.isUndo) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(this.toJSON());\n    }\n\n    this.scene.addAPolylineGraphWrapper(this);\n  }\n  public initComponent() {\n    this.styleComponent = new StyleComponent(this);\n    this.renderer = new RendererComponent(this);\n    // this.transformation = new TransformationComponent(this);\n    // this.interaction = new InteractionComponent(this);\n  }\n  public get isHidden() {\n    return this.isHiddenValue;\n  }\n  public set isHidden(v: boolean) {\n    this.isHiddenPre = this.isHiddenValue;\n    this.isHiddenValue = v;\n    for (let i = 0; i < this.edges.length; ++i) {\n      this.edges[i].IsHidden = v;\n      this.edges[i].Visibility = 0;\n    }\n    this.scene.annotationInstance.io.eventListenerAnnotation.hideStack(this.toJSON());\n  }\n  public get isHover() {\n    return this.isHoverValue;\n  }\n  public set isHover(v: boolean) {\n    this.isHoverValue = v;\n    if (this.isHoverValue && !this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    } else if (!this.isHoverValue && this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    }\n    this.isHoverPre = this.isHoverValue;\n    if (!this.isSelectedValue) {\n      let i = this.edges.length;\n      while (i--) {\n        this.edges[i].IsRenderable = v;\n        this.edges[i].IsHover = v;\n      }\n    }\n\n    // this.isHover;\n\n    if (!v) {\n      this.needEmitHoverPost = true;\n      this.hidePopUpSummary();\n      // console.log('dd');\n    }\n  }\n  public get IsSelectable() {\n    return this.isSelectable;\n  }\n  public set IsSelectable(v: boolean) {\n    this.isSelectable = v;\n    for (let i = 0; i < this.edges.length; ++i) {\n      this.edges[i].IsSelectable = v;\n    }\n  }\n  public get isSelected() {\n    return this.isSelectedValue;\n  }\n  public set isSelected(v: boolean) {\n    if (this.isRemove || this.isHiddenValue) {\n      return;\n    }\n    this.isSelectedValue = v;\n    for (const e of this.edges) {\n      e.IsSelected = v;\n    }\n\n    let needEmit = true;\n    for (const e of this.edges) {\n      if (e.p0.isSelectedValue) {\n        needEmit = false;\n        break;\n      }\n      if (e.pm.isSelectedValue) {\n        needEmit = false;\n        break;\n      }\n      if (e.p1.isSelectedValue) {\n        needEmit = false;\n        break;\n      }\n    }\n    if (needEmit) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.selectionStack(this.toJSON());\n    }\n  }\n  public move(x: number, y: number) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    this.computeCenterVec();\n    const xo = x - this.vec.x;\n    const yo = y - this.vec.y;\n    for (let i = 0; i < this.edges.length; ++i) {\n      this.edges[i].p0.vec.x += xo;\n      this.edges[i].p0.vec.y += yo;\n      // this.edges[i].p0.UpdateGoeVec();\n      this.edges[i].pm.vec.x += xo;\n      this.edges[i].pm.vec.y += yo;\n      // this.edges[i].pm.UpdateGoeVec();\n      this.edges[i].p1.vec.x += xo;\n      this.edges[i].p1.vec.y += yo;\n      // this.edges[i].p1.UpdateGoeVec();\n    }\n  }\n  public computeCenterVec() {\n    const vs: NVector3[] = [];\n    for (let i = 0; i < this.edges.length; ++i) {\n      vs.push(this.edges[i].p0.vec, this.edges[i].pm.vec, this.edges[i].p1.vec);\n    }\n    this.vec = getCenterVecFromVecs(vs);\n    // const mp = this.scene.annotationInstance.geometryCommon.gcmdSupporting.toMap(\n    //   this.vec.x,\n    //   this.vec.y\n    // );\n  }\n  public computeEdge(pts: APoint[]) {\n    this.edges = [];\n    // this.ptsMid = [];\n    for (let i = 0; i < pts.length - 1; ++i) {\n      this.edges.push(this.addEdge(pts[i], pts[i + 1]));\n    }\n  }\n  public addEdge(p0: APoint, p1: APoint) {\n    const mv = midVec(p0.vec, p1.vec);\n    // this.vecsMid.push(mv);\n    const nm = new APoint(this.scene, mv.x, mv.y, 0, false, GType.AMIDPOINT);\n    // nm.edges.push(this);\n    // this.ptsMid.push(nm);\n    return new APolylineEdge(this.scene, this, p0, nm, p1);\n  }\n  public getNodePopup(): APoint | undefined {\n    if (this.edges.length === 0) {\n      return undefined;\n    }\n    let out: APoint = this.edges[0].p0;\n    let x: number = Number.MAX_SAFE_INTEGER;\n    for (let i = 0; i < this.edges.length; ++i) {\n      if (this.edges[i].p0.vec.x < x) {\n        out = this.edges[i].p0;\n        x = this.edges[i].p0.vec.x;\n      }\n      if (this.edges[i].pm.vec.x < x) {\n        out = this.edges[i].pm;\n        x = this.edges[i].pm.vec.x;\n      }\n      if (this.edges[i].p1.vec.x < x) {\n        out = this.edges[i].p1;\n        x = this.edges[i].p1.vec.x;\n      }\n    }\n    return out;\n  }\n  public computeNode(vs: NVector3[], isScreen = true) {\n    const pts = [];\n    // console.log(isScreen);\n    // console.log(this.vecs);\n    if (isScreen) {\n      for (let i = 0; i < vs.length; ++i) {\n        const p = new APoint(this.scene, vs[i].x, vs[i].y);\n        p.type = GType.ANODE;\n        p.edges.push(this);\n        p.isUnderConstruction = false;\n        pts.push(p);\n      }\n    } else {\n      for (let i = 0; i < vs.length; ++i) {\n        const p = APoint.getNodeFromScreenPos(this.scene, vs[i]);\n        p.type = GType.ANODE;\n        p.isUnderConstruction = false;\n        p.edges.push(this);\n        pts.push(p);\n      }\n    }\n    return pts;\n  }\n  public removeAndAppendEdge(e: APolylineEdge, es: APolylineEdge[]) {\n    const i = this.edges.indexOf(e);\n    this.edges.splice(i, 1);\n    for (let j = 0; j < es.length; ++j) {\n      this.edges.splice(i, 0, es[j]);\n    }\n  }\n  public removeEdge(e: APolylineEdge) {\n    this.edges.splice(this.edges.indexOf(e), 1);\n    // this.RemovePt(e.pm);\n    // this.ptsMid.splice(this.ptsMid.indexOf(e.pm), 1);\n    // e.pm.DeepRemove();\n    // d\n  }\n  public RemovePt(p: APoint) {\n    // console.log(p);\n    // this.pts.splice(this.pts.indexOf(p), 1);\n  }\n  public remove(needEmit = true): void {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n\n    if (this.scene.Capture && this.scene.Capture.type === GType.ANODE) {\n      const p = this.scene.Capture as APoint;\n\n      if (p.aEdges[1] && p.aEdges[0]) {\n        // in case that it has two connections\n        const pA = p.aEdges[0].p0 === p ? p.aEdges[0].p1 : p.aEdges[0].p0;\n        const pB = p.aEdges[1].p0 === p ? p.aEdges[1].p1 : p.aEdges[1].p0;\n\n        let nList: APolylineEdge[] = [];\n        pA.aEdges.forEach((e: APolylineEdge) => {\n          if (e.p0 !== p && e.p1 !== p) {\n            nList.push(e);\n          }\n        });\n        pA.aEdges = nList;\n\n        nList = [];\n        pB.aEdges.forEach((e: APolylineEdge) => {\n          if (e.p0 !== p && e.p1 !== p) {\n            nList.push(e);\n          }\n        });\n        pB.aEdges = nList;\n\n        const indexFistEdge = this.edges.lastIndexOf(p.aEdges[0]);\n        const indexSecondEdge = this.edges.lastIndexOf(p.aEdges[1]);\n\n        const ne = this.addEdge(pA, pB);\n        const indexInsert = indexFistEdge < indexSecondEdge ? indexFistEdge : indexSecondEdge;\n        this.edges.splice(indexInsert, 0, ne);\n\n        p.aEdges[0].pm.deepRemove();\n        p.aEdges[1].pm.deepRemove();\n\n        this.edges.splice(this.edges.indexOf(p.aEdges[0]), 1);\n        this.edges.splice(this.edges.indexOf(p.aEdges[1]), 1);\n      } else if (p.aEdges[0]) {\n        // first and last edge\n        const pA = p.aEdges[0].p0 === p ? p.aEdges[0].p1 : p.aEdges[0].p0;\n\n        const nList: APolylineEdge[] = [];\n        pA.aEdges.forEach((e: APolylineEdge) => {\n          if (e.p0 !== p && e.p1 !== p) {\n            nList.push(e);\n          }\n        });\n        pA.aEdges = nList;\n\n        p.aEdges[0].pm.deepRemove();\n        this.edges.splice(this.edges.indexOf(p.aEdges[0]), 1);\n\n        // console.log(this.edges.length);\n      }\n      p.deepRemove();\n      this.reBuildConnection();\n      this.computeCenterVec();\n      this.initVecsHistory();\n      if (needEmit) {\n        const ioGeo = this.toJSON();\n        if (ioGeo) {\n          this.scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack([ioGeo]);\n        }\n      }\n      return;\n    }\n    let i = this.edges.length;\n    while (i--) {\n      this.edges[i].remove();\n    }\n    if (needEmit) {\n      const ioGeo = this.toJSON();\n      if (ioGeo) {\n        this.scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack([ioGeo]);\n      }\n    }\n    this.deepRemove();\n  }\n  public deepRemove() {\n    this.isSelectable = false;\n    this.isRenderable = false;\n    this.hidePopUpSummary();\n    // if (this.aPolylineGraph) { this.aPolylineGraph.Remove(); }\n    // if (this.cPathAni) { this.cPathAni.Remove(); }\n    this.scene.removeAPolylineGraphWrapper(this);\n    this.scene.removeGeometry(this);\n  }\n  public removeOrphanNode() {\n    // for (let n of this.edges) {\n    //     n.p0.isConnected = true; n.pm.isConnected = true; n.p1.isConnected = true;\n    // }\n    // for (let p of this.pts) { if (!p.isConnected) { p.DeepRemove(); } }\n  }\n  public checkMinPt() {\n    // let remove = false;\n    // if (this.edges.length < 2 || this.pts.length < 3) { remove = true; }\n    // if (remove) {\n    //     for (let n of this.pts) { n.DeepRemove(); }\n    //     // for (let e of this.edges) { e.DeepRemove(); }\n    //     this.DeepRemove();\n    // }\n  }\n  public updateGeometryByProjectedpos(vs: NVector3[]) {\n    // for (let i = 0; i < vs.length; ++i) {\n    //     this.pts[i].vec.proX = vs[i].proX;\n    //     this.pts[i].vec.proY = vs[i].proY;\n    //     this.pts[i].vec.proZ = vs[i].proZ;\n    // }\n  }\n  public getLog(): string {\n    return this.type;\n  }\n  public goToBlackhole() {\n    this.isSelectable = false;\n    this.needBlackhole = true;\n    this.edges.forEach((e) => {\n      e.p0.goToBlackhole();\n      e.pm.goToBlackhole();\n      e.p1.goToBlackhole();\n    });\n    // this.ptsMid.forEach(p => { p.GoToBlackhole(); });\n  }\n  public isMouseInside(x: number, y: number): boolean {\n    let isHover = false;\n    for (let i = 0; i < this.edges.length; ++i) {\n      if (this.edges[i].isMouseInside(x, y)) {\n        isHover = true;\n      }\n    }\n\n    if (this.vecOthers) {\n      const offset = this.vecOthers[0].x - this.edges[0].p0.vec.x;\n      for (let i = 0; i < this.edges.length; ++i) {\n        if (this.edges[i].isMouseInside(x - offset, y)) {\n          isHover = true;\n        }\n      }\n    }\n    // console.log('is mo');\n    for (let i = 0; i < this.edges.length; ++i) {\n      this.edges[i].IsHover = isHover;\n    }\n    return isHover;\n  }\n  public isMouseInsideNode(x: number, y: number): boolean {\n    // for (let i = 0; i < this.pts.length; ++i) {\n    //     if (this.pts[i].IsMouseInside(x, y)) { return true; }\n    // }\n    return false;\n  }\n  public hasSamePtWtithCapture() {\n    for (let i = 0; i < this.edges.length; ++i) {\n      if (this.edges[i].p0 === this.scene.capture) {\n        return true;\n      }\n      if (this.edges[i].pm === this.scene.capture) {\n        return true;\n      }\n      if (this.edges[i].p1 === this.scene.capture) {\n        return true;\n      }\n    }\n    return false;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    if (this.hasSamePtWtithCapture()) {\n      return;\n    }\n    this.resetVisitPt();\n    // if (this.TranslateDuplicated(e)) { return; }\n\n    for (let i = 0; i < this.edges.length; ++i) {\n      // if (this.edges[i].isCurved) { this.edges[i].pm.TranslateByMouseEventData(e); }\n      this.edges[i].translateByMouseEventData(e);\n    }\n    // for (let i = 0; i < this.edges.length; ++i) { if (this.edges[i].isCurved) { this.edges[i].pm.TranslateByMouseEventData(e); } }\n  }\n  public translateByMouseEventDataForTextLeaderline(e: MouseEventData) {\n    //\n  }\n  public mouseLeftClick() {\n    // console.log('click');\n    this.scene.annotationInstance.geometryCommon.gcmdProcessing.removeAllPopup();\n    this.showPopupSummary();\n  }\n  public translate(x: number, y: number) {\n    /* */\n  }\n  public getVecForSnapping(): NVector3 | undefined {\n    return undefined; // we donot want to snap while dragging the whole body of polyline Graph!!!\n  }\n  // TranslateDuplicated(e: MouseEventData) {\n  //     let m = new NVector3(e.x, e.y);\n  //     if (this.vecOthersCustom && this.vecOthersCustom.length > 0 && this.vecOthersCustom[1].length > 0) {\n\n  //         let result = NVector3.GetIndexByShortDistance(m, this.vecOthersCustom[1]);\n  //         if (result[1] < 19) {\n  //             let pt: APoint | undefined = undefined;\n  //             for (let i = 0; i < this.edges.length; ++i) {\n  //                 if (this.edges[i].p0.vec === this.vecs[result[0]]) { pt = this.edges[i].p0; }\n  //                 if (this.edges[i].pm.vec === this.vecs[result[0]]) { pt = this.edges[i].pm; }\n  //                 if (this.edges[i].p1.vec === this.vecs[result[0]]) { pt = this.edges[i].p1; }\n  //             }\n  //             if (pt) {\n  //                 pt.TranslateByMouseEventData(e);\n  //                 return true;\n  //             }\n  //         }\n  //     }\n  //     return false;\n  // }\n  public hide(): void {\n    /* */\n  }\n  public updateProjection() {\n    if (this.isUnderConstruction) {\n      return;\n    }\n\n    // let vecs: NVector3[] = this.GetVecs();\n    // // console.log(vecs);\n    // if (this.wrapping.isIntersectLeft) {\n    //   this.vecOthers = this.wrapping.ComputeWrappingDuplication(vecs, 1);\n    // } else if (this.wrapping.isIntersectRight) {\n    //   this.vecOthers = this.wrapping.ComputeWrappingDuplication(vecs, -1);\n    // }\n    // const dir = this.scene.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper\n    //   .mapViewCore.extent.dirctionTo;\n    // // console.log(dir);\n    // this.ResetVisitPt();\n    // if (this.wrapping.needWrappingToRight && 0 < dir) {\n    //   for (let i = 0; i < this.edges.length; ++i) {\n    //     let e = this.edges[i];\n    //     this.WrappingProjectedPosShape(e.p0, 1);\n    //     this.WrappingProjectedPosShape(e.pm, 1);\n    //     this.WrappingProjectedPosShape(e.p1, 1);\n    //   }\n    //   // for (let i = 0; i < vecs.length; ++i) {\n    //   //   if (!vecs[i].isModified) {\n    //   //     const p = this.scene.annotationInstance.geometryCommon.WrappingProjectedPosShape(vecs[i].proX, vecs[i].proY, 1);\n    //   //     vecs[i].proX = p[0]; vecs[i].proY = p[1];\n    //   //     vecs[i].isModified = true;\n    //   //     // console.log('right');\n    //   //   }\n    //   // }\n    // } else if (this.wrapping.needWrappingToLeft && dir < 0) {\n    //   for (let i = 0; i < this.edges.length; ++i) {\n    //     let e = this.edges[i];\n    //     this.WrappingProjectedPosShape(e.p0, -1);\n    //     this.WrappingProjectedPosShape(e.pm, -1);\n    //     this.WrappingProjectedPosShape(e.p1, -1);\n    //   }\n    //   // if (!vecs[i].isModified) {\n    //   //   const p = this.scene.annotationInstance.geometryCommon.WrappingProjectedPosShape(vecs[i].proX, vecs[i].proY, -1);\n    //   //   vecs[i].proX = p[0]; vecs[i].proY = p[1];\n    //   //   vecs[i].isModified = true;\n    //   // }\n    //   // console.log('left');\n    // }\n    // // console.log(this.wrapping.needWrappingToLeft, this.wrapping.needWrappingToRight);\n\n    // this.wrapping.needWrappingToLeft = false;\n    // this.wrapping.needWrappingToRight = false;\n    // console.log(this.wrapping.needWrappingToLeft, this.wrapping.needWrappingToRight);\n  }\n  public wrappingProjectedPosShape(pv: APoint, direction: number) {\n    if (pv.isVisited) {\n      return;\n    }\n    pv.isVisited = true;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.renderer.renderPost(ctx);\n  }\n  public getVecs() {\n    const vecs = [];\n    for (let i = 0; i < this.edges.length; ++i) {\n      if (i === this.edges.length - 1) {\n        // this.edges[i].p0.vec.isModified = false; this.edges[i].pm.vec.isModified = false; this.edges[i].p1.vec.isModified = false;\n        vecs.push(this.edges[i].p0.vec);\n        vecs.push(this.edges[i].pm.vec);\n        vecs.push(this.edges[i].p1.vec);\n      } else {\n        // this.edges[i].p0.vec.isModified = false; this.edges[i].pm.vec.isModified = false;\n        vecs.push(this.edges[i].p0.vec);\n        vecs.push(this.edges[i].pm.vec);\n      }\n    }\n    return vecs;\n  }\n  public checkIsClosed(vs: NVector3[], isAutoClosing = false) {\n    if (!isAutoClosing) {\n      this.isClosed = false;\n      return;\n    }\n    if (getDistance(vs[0], vs[vs.length - 1]) < 20) {\n      this.isClosed = true;\n      this.type = GType.POLYGON;\n    }\n  }\n  public getNode() {\n    const vs = [];\n    for (let i = 0; i < this.edges.length; ++i) {\n      if (i === this.edges.length - 1) {\n        vs.push(this.edges[i].p0.vec);\n        vs.push(this.edges[i].pm.vec);\n        vs.push(this.edges[i].p1.vec);\n      } else {\n        vs.push(this.edges[i].p0.vec);\n        vs.push(this.edges[i].pm.vec);\n      }\n    }\n    return vs;\n  }\n  public toJSON(): IOGeometry | undefined {\n    const p = new IOGeometry(this.id, this.type, this.isSelectedValue, this.isHoverValue, this.isHiddenValue);\n    p.pushNode(this.getNode());\n\n    const styles = this.styleComponent.toJson();\n    if (styles) {\n      p.styles = styles;\n    }\n\n    return p;\n  }\n  public deepCopy(x: number, y: number, z = 0): AGeometryBase | undefined {\n    const s = this.toJSON();\n    if (s) {\n      const ap = APolylineGraphWrapper.fromJSON(this.scene, s, false, true);\n      ap.move(x, y);\n      // ap.ComputeEdge();\n\n      // console.log(AGeometryCommon.annotationStatic.implementation.app.model.nGraphics.mouseInteraction.e);\n      // ap.Translate(AGeometryCommon.annotationStatic.implementation.app.model.nGraphics.mouseInteraction.e);\n      return ap;\n    }\n    return undefined;\n  }\n  public reBuildConnection() {\n    if (this.edges.length > 0) {\n      this.edges = this.reorderEdges();\n    }\n  }\n  public updatePostTransformation() {\n    for (let i = 0; i < this.edges.length; ++i) {\n      this.edges[i].updateMidVec();\n    }\n  }\n  private resetVisitPt() {\n    this.edges.forEach((e: APolylineEdge) => {\n      e.p0.isVisited = false;\n      e.pm.isVisited = false;\n      e.p1.isVisited = false;\n    });\n  }\n  private reorderEdges() {\n    const list = [this.edges[0]];\n\n    let safeguard = 1000;\n    let ls: APolylineEdge = this.edges[0];\n\n    let node = this.edges[0].p0.aEdges.length === 1 ? this.edges[0].p1 : this.edges[0].p0;\n    while (node) {\n      if (node.aEdges.length === 2) {\n        ls = node.aEdges[0] === ls ? node.aEdges[1] : node.aEdges[0];\n        list.push(ls);\n        node = node === ls.p0 ? ls.p1 : ls.p0;\n      } else {\n        break;\n      }\n      safeguard--;\n      if (safeguard < 0) {\n        break;\n      }\n    }\n    return list;\n  }\n  public checkAttachedTextleaderline() {\n    for (const e of this.edges) {\n      if (e.p0.textLeaderline && e.p0.textLeaderline.leaderline) {\n        if (getDistance(e.p0.vec, e.p0.textLeaderline.leaderline.v2) < 5) {\n          return true;\n        }\n        e.p0.textLeaderline.attachedShape = undefined;\n        e.p0.textLeaderline = undefined;\n      }\n      if (e.pm.textLeaderline && e.pm.textLeaderline.leaderline) {\n        if (getDistance(e.pm.vec, e.pm.textLeaderline.leaderline.v2) < 5) {\n          return true;\n        }\n        e.pm.textLeaderline.attachedShape = undefined;\n        e.pm.textLeaderline = undefined;\n      }\n      if (e.p1.textLeaderline && e.p1.textLeaderline.leaderline) {\n        if (getDistance(e.p1.vec, e.p1.textLeaderline.leaderline.v2) < 5) {\n          return true;\n        }\n        e.p1.textLeaderline.attachedShape = undefined;\n        e.p1.textLeaderline = undefined;\n      }\n    }\n    return false;\n  }\n  public updateMidVec() {\n    for (let i = 0; i < this.edges.length; ++i) {\n      if (!this.edges[i].isCurved) {\n        const mv = midVec(this.edges[i].p0.vec, this.edges[i].p1.vec);\n        this.edges[i].pm.vec.x = mv.x;\n        this.edges[i].pm.vec.y = mv.y;\n      }\n    }\n  }\n}\n","import { MouseEventData } from '../../../../../../lib/EventData/MouseEventData';\nimport { Scene } from '../../Scene';\nimport { AGeometryBase } from '../Common/Base/AGeometryBase';\nexport class ARemove {\n  public static mouseDown(scene: Scene, e: MouseEventData) {\n    const cGeo: AGeometryBase = scene.annotationInstance.geometryCommon.gcmdProcessing.findAtPoint(\n      e\n    ) as AGeometryBase;\n    if (cGeo) {\n      cGeo.remove();\n    }\n  }\n  public static mouseMove(e: MouseEventData) {\n    // AppAnnotation. .aGeometryRender.UpdateMouseOver(e);\n  }\n  constructor() {\n    /* */\n  }\n}\n","import { MouseEventData } from '../../../../../../lib/EventData/MouseEventData';\nimport { getBoundingVecs, NVector3, removeVecsWithinDis } from '../../../../lib';\nimport { Scene } from '../../Scene';\nexport class ASelection {\n  public static construction: ASelection | undefined;\n  public static isLasso = false;\n  public static isTooltipRenderable = false;\n  public scene: Scene;\n  public v0: NVector3 | undefined;\n  public v1: NVector3 | undefined;\n  public vecs: NVector3[];\n  public isWindow: boolean;\n  public t: number;\n  // canvasTooltip: CanvasTooltip;\n  public vecTooltip: NVector3;\n  constructor(scene: Scene) {\n    this.scene = scene;\n    this.vecs = [];\n    this.isWindow = false;\n    this.t = 0;\n    // this.canvasTooltip = new CanvasTooltip(this);\n    this.vecTooltip = new NVector3(0, 0);\n  }\n  public computeRecPtsWithMouse(x: number, y: number) {\n    /* */\n  }\n  public addVecs(x: number, y: number) {\n    this.vecs.push(new NVector3(x, y));\n  }\n  public remove() {\n    /* */\n  }\n  public cancel() {\n    if (ASelection.construction !== undefined) {\n      ASelection.construction.remove();\n    }\n    ASelection.construction = undefined;\n  }\n  // .................................................................... end implementation\n  public drawShadow(e: MouseEventData) {\n    if (ASelection.construction === undefined) {\n      // let p2 = new CPoint(e.x, e.y, 0);\n      // p2.isSelectable = false;\n    } else {\n      ASelection.construction.computeRecPtsWithMouse(e.x, e.y);\n    }\n  }\n  public mouseDown(e: MouseEventData) {\n    this.v0 = new NVector3(e.x, e.y);\n    this.vecTooltip.x = -100;\n    this.vecTooltip.y = -100;\n    ASelection.isTooltipRenderable = false;\n  }\n  public mouseDrag(e: MouseEventData) {\n    if (ASelection.isLasso) {\n      this.addVecs(e.x, e.y);\n    } else {\n      this.v1 = new NVector3(e.x, e.y);\n    }\n  }\n  public mouseUp(e: MouseEventData) {\n    this.scene.annotationInstance.geometryCommon.gcmdSelecting.deSelectCaptureObjects();\n\n    if (ASelection.isLasso) {\n      if (this.vecs.length < 1) {\n        return;\n      }\n      this.scene.annotationInstance.geometryCommon.gcmdSelecting.selecteObjectsByVecs(\n        removeVecsWithinDis(this.vecs)\n      );\n      this.vecs = [];\n    } else {\n      if (this.v0 === undefined || this.v1 === undefined) {\n        return;\n      }\n      this.scene.annotationInstance.geometryCommon.gcmdSelecting.selecteObjectsByVecs(\n        getBoundingVecs(this.v0, this.v1),\n        this.isWindow\n      );\n      this.v0 = undefined;\n      this.v1 = undefined;\n    }\n    // CanvasCommandChain.GetCommandChain(this.scene);\n  }\n  public mouseMove(e: MouseEventData) {\n    this.vecTooltip.x = e.x;\n    this.vecTooltip.y = e.y;\n  }\n  // ................................... end implementation\n  public render(ctx: CanvasRenderingContext2D) {\n    if (ASelection.isTooltipRenderable) {\n      // this.canvasTooltip.StaticRenderClickAndDragToSelect(ctx, this.vecTooltip);\n    }\n\n    if (ASelection.isLasso) {\n      if (this.vecs.length < 1) {\n        return;\n      }\n      this.scene.annotationInstance.renderer.draw.shape.selection.selectionLasso(\n        ctx,\n        this.vecs,\n        false,\n        this.t\n      );\n    } else {\n      if (this.v0 === undefined || this.v1 === undefined) {\n        return;\n      }\n      if (this.v0.x > this.v1.x || this.v0.y > this.v1.y) {\n        this.isWindow = true;\n      } else {\n        this.isWindow = false;\n      }\n\n      this.scene.annotationInstance.renderer.draw.shape.selection.selection(\n        ctx,\n        this.v0,\n        this.v1,\n        this.isWindow,\n        this.t\n      );\n    }\n    this.t += 0.5;\n  }\n}\n","import {\n  ActiveCommandMode,\n} from '../../../../../lib';\nimport { KeyboardEventData } from '../../../../../../../lib/EventData/KeyboardEventData';\nimport { KeyboardEventController } from './KeyboardEventController';\nexport class ShortcutImplementation {\n    keyEventController: KeyboardEventController;\n    constructor(keyEventController: KeyboardEventController) {\n      this.keyEventController = keyEventController;\n    }\n    public keypress(k: KeyboardEventData): boolean {\n      const sc = this.keyEventController.acWrapper.acs.imageAnnoApp.customization.shortcut.shortcutCommands[k.key.toUpperCase()];\n      if (sc !== undefined && k.hasCtrlKey === sc.hasControl && k.hasShiftKey === sc.hasShift) {\n        this.keyEventController.acWrapper.acs.setActiveCommand(sc.ac as ActiveCommandMode);\n        return true;\n      }\n      return false;\n    }\n    public ByDeleteKey() {\n      if (\n        this.keyEventController.acWrapper.acs.type === ActiveCommandMode.POLYLINE ||\n        this.keyEventController.acWrapper.acs.type === ActiveCommandMode.POLYGON ||\n        this.keyEventController.acWrapper.acs.type === ActiveCommandMode.CPOLYLINE ||\n        this.keyEventController.acWrapper.acs.type === ActiveCommandMode.CPOLYGON ||\n        this.keyEventController.acWrapper.acs.type === ActiveCommandMode.POLYLINE_BENDING ||\n        this.keyEventController.acWrapper.acs.type === ActiveCommandMode.POLYGON_GRAPH\n      ) {\n        this.keyEventController.acWrapper.acs.activeCommand.undo();\n      }\n      this.keyEventController.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.removeAllCapturedGeoGroup();\n      this.keyEventController.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n    }\n    public ByESCKey() {\n      this.keyEventController.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSelecting.cancelActiveCommand();\n      this.keyEventController.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSelecting.deSelectCaptureObjects();\n      this.keyEventController.acWrapper.acs.acProperties.pressESC = true;\n      this.keyEventController.acWrapper.acs.goToACMode();\n      this.keyEventController.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n    }\n  }\n","import {\n  ActiveCommandMode,\n  CompileMode,\n  InteractionMode,\n  PressType,\n} from '../../../../../lib';\nimport { KeyboardEventData } from '../../../../../../../lib/EventData/KeyboardEventData';\nimport { ActiveCommandCommonWrapper } from '../../ActiveCommandImplementation/Base/ActiveCommandCommonWrapper';\nimport { ShortcutImplementation } from './ShortcutImplementation';\nexport class KeyboardEventController {\n  public acWrapper: ActiveCommandCommonWrapper;\n  public shortcutImplementation: ShortcutImplementation;\n  constructor(activeCommandCommon: ActiveCommandCommonWrapper) {\n    this.acWrapper = activeCommandCommon;\n    this.shortcutImplementation = new ShortcutImplementation(this);\n    // console.log(this.shortcut);\n  }\n  public keyboardEventController(k: KeyboardEventData) {\n    switch (k.PRESS_TYPE) {\n      case PressType.Down:\n        this.keydownPre(k);\n        break;\n      case PressType.Up:\n        this.keyUpPre(k);\n        break;\n      default:\n        break;\n    }\n  }\n  public keyboardEventControllerFromDocument(k: KeyboardEventData) {\n    switch (k.PRESS_TYPE) {\n      case PressType.Down:\n        this.keydownPreFromDocument(k);\n        break;\n      case PressType.Up:\n        this.keyUpPreFromDocument(k);\n        break;\n      default:\n        break;\n    }\n  }\n  private keydownPre(k: KeyboardEventData) {\n    // console.log(k);\n    this.acWrapper.acs.acProperties.pressKey = true;\n    // this.acWrapper.acs.imageAnnoApp.mapticon.key = k.keyCode;\n    // console.log(k.keyCode);\n\n    if (k.hasCtrlKey) {\n      this.acWrapper.acs.acProperties.pressCtrlKey = true;\n    }\n    if (k.hasShiftKey && k.hasCtrlKey && k.keyCode === 76) {\n      this.acWrapper.acs.imageAnnoApp.apiWrapper.environment.shiftLog();\n      return;\n    }\n    if (k.hasShiftKey && k.hasCtrlKey && k.keyCode === 32) {\n      this.acWrapper.acs.imageAnnoApp.implementations.app.initViewController();\n      return;\n    }\n    if (this.shortcutImplementation.keypress(k)) {\n      return;\n    }\n    // ......................................... debugger mode\n    if (\n      !this.acWrapper.acs.imageAnnoApp.implementations.app.PRODUCTION &&\n      k.hasShiftKey &&\n      k.keyCode === 49\n    ) {\n      this.acWrapper.acs.imageAnnoApp.apiWrapper.environment.toggleDebuggerMode();\n      return;\n    }\n    if (\n      !this.acWrapper.acs.imageAnnoApp.implementations.app.PRODUCTION &&\n      k.hasShiftKey &&\n      k.keyCode === 50\n    ) {\n      this.acWrapper.acs.imageAnnoApp.apiWrapper.environment.shiftOptimizerTextleaderline();\n      return;\n    }\n    if (\n      !this.acWrapper.acs.imageAnnoApp.implementations.app.PRODUCTION &&\n      k.hasShiftKey &&\n      k.keyCode === 51\n    ) {\n      this.acWrapper.acs.imageAnnoApp.apiWrapper.environment.shiftScaleDynamicRender();\n      return;\n    }\n    if (\n      !this.acWrapper.acs.imageAnnoApp.implementations.app.PRODUCTION &&\n      k.hasShiftKey &&\n      k.keyCode === 52\n    ) {\n      this.acWrapper.acs.imageAnnoApp.apiWrapper.environment.shiftActiveCluster();\n      return;\n    }\n    if (k.hasShiftKey && k.keyCode === 73) {\n      this.acWrapper.acs.activecommandIconPoint();\n      return;\n    }\n    if (k.hasShiftKey && k.keyCode === 67) {\n      // C\n      this.acWrapper.acs.imageAnnoApp.activeCommandController.setActiveCommand(\n        ActiveCommandMode.CIRCLE\n      );\n      this.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n      return;\n    }\n    if (k.hasShiftKey && k.keyCode === 82) {\n      // R\n      this.acWrapper.acs.imageAnnoApp.activeCommandController.setActiveCommand(\n        ActiveCommandMode.RECTANGLE\n      );\n      this.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n      return;\n    }\n    if (k.hasShiftKey && k.keyCode === 70) {\n      // D\n      this.acWrapper.acs.imageAnnoApp.apiWrapper.environment.shiftDash();\n      this.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n      return;\n    }\n\n    if (\n      !this.acWrapper.acs.imageAnnoApp.implementations.app.PRODUCTION &&\n      k.hasShiftKey &&\n      k.keyCode === 83\n    ) {\n      // Shift + S\n      this.acWrapper.acs.imageAnnoApp.apiWrapper.environment.shiftScaleForRPoint();\n      return;\n    }\n    if (\n      !this.acWrapper.acs.imageAnnoApp.implementations.app.PRODUCTION &&\n      k.hasShiftKey &&\n      k.keyCode === 87\n    ) {\n      // Shift + W\n      this.acWrapper.acs.imageAnnoApp.apiWrapper.environment.shiftRenderShapeForRPoint();\n      return;\n    }\n    if (\n      !this.acWrapper.acs.imageAnnoApp.implementations.app.PRODUCTION &&\n      k.hasShiftKey &&\n      k.keyCode === 69\n    ) {\n      // Shift + R\n      this.acWrapper.acs.imageAnnoApp.apiWrapper.environment.shiftIcon();\n      return;\n    }\n\n    // .................................................................................. text\n    // if (this.acWrapper.acs.isTextEditing || !this.acWrapper.acs.isShortCutActive) {\n    //     if (k.keyCode === 8 || k.keyCode === 46) {\n    //     this.acWrapper.acs.annotationInstance.geometryCommon.RemoveCapturedTextLeaderline();\n    //     this.acWrapper.acs.annotationInstance.geometryCommon.RenderForce();\n    //     }\n    //     return;\n    // }\n    // .................................................................................. text end\n\n    if (k.keyCode === 49) {\n      this.acWrapper.acs.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.setLevel1();\n    } else if (k.keyCode === 50) {\n      this.acWrapper.acs.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.setLevel2();\n    } else if (k.keyCode === 51) {\n      this.acWrapper.acs.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.setLevel3();\n    } else if (k.keyCode === 52) {\n      this.acWrapper.acs.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.setLevel4();\n    } else if (k.keyCode === 53) {\n      this.acWrapper.acs.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.setLevel5();\n    } else if (k.keyCode === 54) {\n      this.acWrapper.acs.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.setLevel6();\n    }\n    // console.log('--------------------');\n    // console.log('key works', k.keyCode);\n\n    if (\n      this.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus\n        .mode !== InteractionMode.Drawing\n    ) {\n      return;\n    }\n\n    if ((k.hasShiftKey && k.keyCode === 8) || (k.hasShiftKey && k.keyCode && k.keyCode === 46)) {\n      this.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.removeAll();\n      return; // } //  shift' bakscape\n    }\n    if (k.keyCode === 8 || k.keyCode === 46) {\n      this.shortcutImplementation.ByDeleteKey();\n      return;\n    } // Backspace\n    // .............................................................................................................................. development\n    if (\n      this.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appProperties\n        .compileMode !== CompileMode.Production\n    ) {\n      if (k.keyCode === 9 && k.hasShiftKey) {\n        this.acWrapper.acs.acProperties.shiftDTMode++;\n        if (this.acWrapper.acs.acProperties.shiftDTMode % 3 === 0) {\n          this.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus.mode =\n            InteractionMode.Drawing;\n        } else if (this.acWrapper.acs.acProperties.shiftDTMode % 3 === 1) {\n          this.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus.mode =\n            InteractionMode.InteractiveViewer;\n        } else if (this.acWrapper.acs.acProperties.shiftDTMode % 3 === 2) {\n          this.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus.mode =\n            InteractionMode.ObserveViewer;\n        }\n        this.acWrapper.acs.setActiveCommand(ActiveCommandMode.NONE);\n        this.acWrapper.acs.imageAnnoApp.apiWrapper.environment.logCommon(\n          this.acWrapper.acs.m.x,\n          this.acWrapper.acs.m.y\n        );\n      }\n      if (k.hasShiftKey && k.keyCode === 68) {\n        this.acWrapper.acs.imageAnnoApp.implementations.app.model.ioWrapper.download();\n      } //  shift' d\n      if (k.hasShiftKey && k.keyCode === 79) {\n        this.acWrapper.acs.imageAnnoApp.implementations.app.model.ioWrapper.open();\n      } //  shift' o\n      // if (k.keyCode === 77) { this.acWrapper.acs.app.hasSound = !this.acWrapper.acs.app.hasSound; } // m for mute\n      if (k.keyCode === 85) {\n        this.acWrapper.acs.imageAnnoApp.apiWrapper.environment.shiftUnit();\n      }\n      // if (k.keyCode === 67) { this.acWrapper.acs.ShiftTheme(); } // c for vis\n      // if (k.keyCode === 80) { if (this.acWrapper.acs.annotationInstance.renderer.mouseVis) { this.acWrapper.acs.annotationInstance.renderer.mouseVis.HidePointer(); } } // p\n      // if (\n      //   this.acWrapper.acs.annotationInstance.implementations.app.viewController &&\n      //   k.keyCode === 76\n      // ) {\n      //   this.acWrapper.acs.ShiftLog();\n      // } // l\n      // if (k.keyCode === 81) { this.acWrapper.acs.annotationInstance.themeAnnotation.ShiftThemeinOrder(); }\n    }\n    // .............................................................................................................................. development\n    if (k.hasShiftKey) {\n      this.acWrapper.acs.acProperties.pressShift = true;\n    }\n    if (k.hasAltKey) {\n      this.acWrapper.acs.acProperties.pressAltKey = true;\n      this.acWrapper.acs.acProperties.needDuplicateByAlt = true;\n    }\n\n    if (\n      this.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus\n        .mode === InteractionMode.ObserveViewer &&\n      !this.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus\n        .currentControllerStatus.keyDown\n    ) {\n      return;\n    }\n\n    if (k.keyCode === 71) {\n      this.acWrapper.acs.imageAnnoApp.apiWrapper.environment.shiftGrid();\n    } // g\n    if (\n      this.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus\n        .mode === InteractionMode.InteractiveViewer &&\n      !this.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus\n        .currentControllerStatus.keyDown\n    ) {\n      return;\n    }\n\n    if (k.keyCode === 77) {\n      this.acWrapper.acs.imageAnnoApp.apiWrapper.environment.shiftMeasure();\n    } // m\n    if (k.keyCode === 70) {\n      this.acWrapper.acs.imageAnnoApp.apiWrapper.environment.shiftMapfilter();\n    } // f\n    if (k.keyCode === 27) {\n      this.shortcutImplementation.ByESCKey();\n    } // Escape\n    if (k.keyCode === 83) {\n      this.acWrapper.acs.imageAnnoApp.activeCommandController.acProperties.snap = !this.acWrapper\n        .acs.imageAnnoApp.activeCommandController.acProperties.snap;\n      return;\n    } // s\n    if (k.keyCode === 49) {\n      this.acWrapper.acs.imageAnnoApp.apiWrapper.environment.toggleBorderFeaturePolygon();\n      return;\n    } // 1\n    if (k.hasShiftKey && k.keyCode === 65) {\n      this.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSelecting.selectAllObjects();\n    } // shift . a\n    // if (k.keyCode === 84) { this.acWrapper.acs.app.quickTransform.HideToogle(); } // t\n    if ((k.hasAltKey || k.hasMetaCommand || k.hasCtrlKey) && k.keyCode === 67) {\n      this.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.copySelGeo();\n    } //  Meta/ctrl' C\n    if (\n      ((k.hasAltKey || k.hasMetaCommand || k.hasCtrlKey) && k.keyCode === 90) ||\n      k.keyCode === 90\n    ) {\n      /* this.Undo();*/\n      // console.log(k.keyCode);\n      this.acWrapper.acs.activeCommand.undo();\n    } // u for mute\n    if ((k.hasAltKey || k.hasMetaCommand || k.hasCtrlKey) && k.keyCode === 86) {\n      // Meta/ctrl' v\n      this.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdAProcessing.pasteSelGeo(\n        this.acWrapper.acs.imageAnnoApp.activeCommandController.m.x,\n        this.acWrapper.acs.imageAnnoApp.activeCommandController.m.y\n      );\n      this.acWrapper.acs.setActiveCommand(ActiveCommandMode.NONE);\n    }\n    // this.acWrapper.acs.app.activeCommandReactController.keydown(k);\n\n    this.acWrapper.keydown(k);\n    this.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n  }\n  private keyUpPre(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      this.acWrapper.acs.acProperties.pressESC = false;\n    }\n    if (k.keyCode === 16) {\n      this.acWrapper.acs.acProperties.pressShift = false;\n    }\n\n    this.acWrapper.acs.acProperties.pressCtrlKey = false;\n    // this.acWrapper.acs.app.activeCommandReactController.keyUp(k);\n    this.acWrapper.keyUp(k);\n    this.acWrapper.acs.acProperties.pressKey = false;\n  }\n  private keydownPreFromDocument(k: KeyboardEventData) {\n    this.acWrapper.acs.acProperties.pressKey = true;\n    this.acWrapper.acs.acProperties.pressShift = k.hasShiftKey;\n    this.acWrapper.acs.acProperties.pressCtrlKey = k.hasCtrlKey;\n\n    // this.acWrapper.acs.imageAnnoApp.mapticon.key = k.keyCode;\n    // this.acWrapper.acs.imageAnnoApp.sketch.key = k.keyCode;\n    // console.log(k.key)\n    switch (k.key) {\n      // this.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdAProcessing.downloadImage();\n      case 'Backspace':\n        this.shortcutImplementation.ByDeleteKey();\n        break;\n      case 'Delete':\n        this.shortcutImplementation.ByDeleteKey();\n        break;\n      case 'Escape':\n        this.shortcutImplementation.ByESCKey();\n        break\n      // case 'C':\n      //   this.acWrapper.acs.imageAnnoApp.scene.paramsEditing.toggleCropGraphics()\n        // this.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.removeAllCapturedGeo();\n        // break;\n      default:\n        break;\n    }\n  }\n  private keyUpPreFromDocument(k: KeyboardEventData) {\n    this.acWrapper.acs.acProperties.pressKey = false;\n    this.acWrapper.acs.acProperties.pressShift = k.hasShiftKey;\n    this.acWrapper.acs.acProperties.pressCtrlKey = k.hasCtrlKey;\n  }\n}\n","import { MouseEventController } from '../../MouseEventController';\nimport { MouseEventData } from '../../../../../../../../../lib/EventData/MouseEventData';\nexport class MouseEventBase {\n  public mc: MouseEventController;\n  constructor(mouseEventController: MouseEventController) {\n    this.mc = mouseEventController;\n  }\n  public mouseDownPre(e: MouseEventData) {\n    //\n  }\n  public mouseLeftClickPre(e: MouseEventData) {\n    //\n  }\n  public mouseMiddleClickPre(e: MouseEventData) {\n    //\n  }\n  public mouseRightClickPre(e: MouseEventData) {\n    //\n  }\n  public mouseUpPre(e: MouseEventData) {\n    //\n  }\n  public mouseDoubleClickPre(e: MouseEventData) {\n    //\n  }\n  public mouseMovePre(e: MouseEventData) {\n    //\n  }\n  public mouseDragPre(e: MouseEventData) {\n    //\n  }\n  public mouseWheelPre(e: MouseEventData) {\n    //\n  }\n}\n","import {\n  MouseEventData,\n  getDistance, NVector3,\n  ActiveCommandMode,\n  GType,\n  InteractionMode,\n} from '../../../../../../lib';\nimport { APolygonGraphWrapper } from '../../../../Geometry/GeometryAnnotation/FamilyArea/APolygonGraphWrapper';\nimport { AGeometryBase } from '../../../../Geometry/Common/Base/AGeometryBase';\nimport { APoint } from '../../../../Geometry/GeometryAnnotation/FamilyPoint/Base/APoint';\nimport { ATextleaderlineWrapper } from '../../../../Geometry/GeometryAnnotation/FamilyText/ATextleaderline';\nimport { MouseEventController } from '../MouseEventController';\nimport { MouseEventBase } from './Base/MouseEventBase';\nexport class MouseEventAnnotationImage extends MouseEventBase {\n  private _frameMove = 0;\n  constructor(mouseEventController: MouseEventController) {\n    super(mouseEventController);\n  }\n  public mouseDownPre(e: MouseEventData) {\n    // this.mc.acWrapper.acs.imageAnnoApp.mapticon.mouseDown(e.x, e.y);\n    // this.mc.acWrapper.acs.imageAnnoApp.sketch.mouseDown(e.x, e.y);\n    if (this.mc.acWrapper.acs.imageAnnoApp.implementations.app.INSPECTION) {\n      this.mc.acWrapper.acs.screenLog.push('MouseDownPre');\n      // console.log('MouseDownPre');\n    }\n    // console.log(this.mc.acWrapper.acs.type);\n    if (\n      this.mc.acWrapper.acs.type !== ActiveCommandMode.SELECT &&\n      this.mc.acWrapper.acs.acProperties.isActivateSnapping\n    ) {\n      // allow snapping for drawing polyline or gon\n      this.mc.updatePosBySnapping(e);\n    }\n\n    const annotationInstance = this.mc.acWrapper.acs.imageAnnoApp;\n\n    // capture the mouse position to compare mouse up event for undo / redo process before commonEvent process below\n    this.mc.mDownPos.x = e.x;\n    this.mc.mDownPos.y = e.y;\n    e = this.mc.acWrapper.acs.commonEvent(e);\n\n    if (annotationInstance.renderer.blackhole) {\n      annotationInstance.renderer.blackhole.stopRender = false;\n    }\n    annotationInstance.activeCommandController.acProperties.isDown = true;\n    annotationInstance.activeCommandController.acProperties.isUp = false;\n\n    this.mc.acWrapper.acs.acProperties.needExecuteOptimizer = true;\n\n    // console.log(this.mc.acWrapper.acs.annotationInstance.scene.Capture);\n\n    if (annotationInstance.activeCommandController.acProperties.clickMenu) {\n      annotationInstance.activeCommandController.acProperties.clickMenu = false;\n      return;\n    }\n    // if (annotationInstance.activeCommandController) { annotationInstance.activeCommandController.IsTextEditing = false; }\n    if (this.mc.acWrapper.acs.acProperties.isReturn) {\n      return;\n    }\n    if (\n      !annotationInstance.implementations.app.model.appCoreWrapper.appControllerStatus\n        .currentControllerStatus.mouseDown\n    ) {\n      return;\n    }\n\n    e.isDown = true;\n\n    annotationInstance.geometryCommon.gcmdProcessing.resetTranformation();\n\n    if (!annotationInstance.geometryCommon.gcmdProcessing.hasMultiSel()) {\n      // if (!e.native.shiftKey) { annotationInstance.geometryCommon.gcmdProcessing.DeSelecteAllObjects(); }\n    }\n    // ........................................................... textleaderline\n    if (annotationInstance.activeCommandController) {\n      annotationInstance.activeCommandController.acProperties.isTextEditing = false;\n      if (annotationInstance.scene.captureText) {\n        annotationInstance.io.eventListenerAnnotation.endEditingText(\n          annotationInstance.scene.captureText.toJSON()\n        );\n        annotationInstance.scene.captureText = undefined;\n      }\n    }\n    // ........................................................... end textleaderline\n\n    // ...................................... // polygon interaction and popup on the viewer mode // safeguard\n    if (\n      annotationInstance.implementations.app.model.appCoreWrapper.appControllerStatus.mode ===\n      InteractionMode.InteractiveViewer\n    ) {\n      if (\n        this.mc.acWrapper.acs.IsTouchEvent &&\n        this.mc.acWrapper.acs.type === ActiveCommandMode.SELECT\n      ) {\n        return;\n      }\n      return;\n    }\n    // ...................................... // end polygon interaction // safeguard\n\n    //   if(  this.mc.acWrapper.acs.app.nGraphics.appMapFilter) {\n    //     this.mc.acWrapper.acs.app.nGraphics.appMapFilter.activeCommand\n    //   }\n    if (\n      this.mc.acWrapper.acs.acProperties.isSmartSelectionWhenDrawing ||\n      !this.mc.acWrapper.acs.acProperties.isDrawing\n    ) {\n      let cGeo: AGeometryBase = annotationInstance.geometryCommon.gcmdProcessing.findAtPoint(e) as AGeometryBase;\n      let aGeo: AGeometryBase = annotationInstance.geometryCommon.gcmdProcessing.findAtPointFromAPoint(e) as AGeometryBase;\n      const pGeo = annotationInstance.geometryCommon.gcmdProcessing.findAtPointFromPolygonGraph(e);\n      // console.log(cGeo, aGeo);\n\n      if (pGeo) {\n        aGeo = pGeo;\n      }\n\n      // This is a safeguard for dragging one of the node of polyline and polygon family with multiple selection\n      if (cGeo) {\n        this.filterNodeSelectionForMovingMultipleShapes(cGeo, e)\n      }\n\n      // This condition for checking picking point families(Regular and numbered point) overlapping the polyline-bending shapes.\n      if (cGeo && aGeo && cGeo.type === GType.POLYLINE_BENDING && (aGeo.type === GType.POINT_REGULAR || aGeo.type === GType.POINT_NUMBERED)) {\n        cGeo = aGeo\n      }\n\n      // console.log(cGeo, aGeo );\n      // prevent from zoom by double click on textleaderline\n      if (cGeo && cGeo.type === GType.TEXT_LEADERLINE) {\n        annotationInstance.implementations.app.model.ioWrapper.eventInteraction.isEnableZoomByDoubleClick = false;\n\n        // .... safeguard: when you resize the circle with attached Textleaderline, it allows us to select the node, not the tip of the leaderline.\n        const leaderline = cGeo as ATextleaderlineWrapper;\n        if (\n          leaderline.attachedShape &&\n          leaderline.leaderline &&\n          getDistance(\n            leaderline.leaderline.v2,\n            new NVector3(this.mc.acWrapper.acs.m.x, this.mc.acWrapper.acs.m.y)\n          ) < 10\n        ) {\n          cGeo = leaderline.attachedShape;\n        }\n        // .... end safeguard\n      } else {\n        // we do not need to wait it for 500 ms, so we use _isEnableZoomByDoubleClick\n        annotationInstance.implementations.app.model.ioWrapper.eventInteraction.isEnableZoomByDoubleClick = true;\n      }\n\n      // console.log(cGeo, aGeo);\n      if (cGeo !== undefined && cGeo.type !== GType.POLYGON_MULTIPLE) {\n        if (cGeo.type === GType.TEXT_LEADERLINE && aGeo) {\n          cGeo = aGeo;\n        } // for selecting apoint over the point of textleaderline\n        // console.log(cGeo);\n\n        // .... safeguard: we want to select shape by the type of node.\n        if (cGeo.type === GType.ANODE_RECT || cGeo.type === GType.ANODE_CIRCLE) {\n          cGeo = (cGeo as APoint).edges[0];\n        }\n        // .... end safeguard\n\n        if (annotationInstance.scene.Capture) {\n          // console.log(annotationInstance.scene.Capture);\n          if (!this.mc.acWrapper.acs.acProperties.pressShift) {\n            if (annotationInstance.scene.Capture.isSelected) {\n              annotationInstance.scene.Capture.isSelected = false;\n            }\n          }\n          annotationInstance.scene.Capture.isCapturedValue = false;\n        }\n        // if (annotationInstance.scene.Capture !== cGeo) { // when you press mouse on the same selected shape\n        annotationInstance.scene.Capture = cGeo;\n        annotationInstance.scene.Capture.isCapturedValue = true;\n        // }\n      } else {\n        // for GTYPE.POLYGON_MULTIPLE\n        if (annotationInstance.scene.Capture) {\n          annotationInstance.scene.Capture.isCapturedValue = false;\n        }\n        annotationInstance.scene.Capture = undefined;\n      }\n      // if (!this.mc.acWrapper.acs.acProperties.isDrawing) {\n      //     if (this.mc.acWrapper.acs.type === ActiveCommandMode.SELECT || this.mc.acWrapper.acs.type === ActiveCommandMode.NONE) {\n\n      //     }\n      // }\n    }\n    // ............................................... detect bending a edge or not\n    if (\n      annotationInstance.scene.Capture &&\n      annotationInstance.scene.Capture.type === GType.AMIDPOINT\n    ) {\n      const nodeForEdge = annotationInstance.scene.Capture as APoint;\n      if (nodeForEdge.aEdges[0]) {\n        nodeForEdge.aEdges[0].checkIsSnapStraight();\n      }\n    }\n    // ............................................... end detect bending a edge or not\n    // if (CanvasCommandChain.app) { CanvasCommandChain.app.OnMouseDown(); }\n\n    // this.mc.acWrapper.acs.app.activeCommandReactController.MouseDown(e);\n    // console.log('down------------------------------');\n\n    this.mc.acWrapper.mouseDown(e);\n  }\n  public mouseLeftClickPre(e: MouseEventData) {\n    // this.mc.acWrapper.acs.imageAnnoApp.sketch.mouseLeftClick(e.x, e.y);\n    // this.mc.acWrapper.acs.imageAnnoApp.mapticon.mouseLeftClick(e.x, e.y);\n    if (this.mc.acWrapper.acs.imageAnnoApp.implementations.app.INSPECTION) {\n      this.mc.acWrapper.acs.screenLog.push('MouseLeftClickPre');\n      // console.log('MouseLeftClickPre');\n    }\n\n    this.mc.acWrapper.acs.imageAnnoApp.activeCommandController.acProperties.isClick = true;\n    if (this.mc.acWrapper.acs.acProperties.isReturn) {\n      return;\n    }\n    if (\n      !this.mc.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus\n        .currentControllerStatus.clickLeft\n    ) {\n      return;\n    }\n    // if (this.mc.acWrapper.acs.app.nGraphics.compileMode !== COMPILE_MODE.PRODUCTION) {\n    //     if (this.mc.acWrapper.acs.annotationInstance.renderer.mouseVis) { this.mc.acWrapper.acs.annotationInstance.renderer.mouseVis.OnMouseLeftClick(e); }\n    // }\n\n    // // for mobile environment, we want to reset the selection when you touch on the screen\n    // if (this.mc.acWrapper.acs.annotationInstance.implementations.app.model.appCoreWrapper.browserUtility.isMobile) {\n    //   this.mc.acWrapper.acs.annotationInstance.geometryCommon.gcmdProcessing.DeSelecteAllObjects();\n    //   this.mc.acWrapper.acs.annotationInstance.geometryCommon.gcmdProcessing.RemoveAllPopup();\n    // }\n\n    e = this.mc.acWrapper.acs.commonEvent(e);\n\n    if (this.mc.acWrapper.acs.imageAnnoApp.renderer.optimizer.mouseClick(e.x, e.y)) {\n      return;\n    }\n    // console.log(this.mc.acWrapper.acs.annotationInstance.renderer.optimizer.MouseClick);\n    // console.log('click');\n\n    if (\n      this.mc.acWrapper.acs.type === ActiveCommandMode.SELECT &&\n      this.mc.acWrapper.acs.acProperties.isActivateSnapping\n    ) {\n      // disble snapping for point families\n      this.mc.updatePosBySnapping(e);\n    }\n\n    if (\n      !this.mc.acWrapper.acs.acProperties.pressShift &&\n      this.mc.acWrapper.acs.acProperties.deselectNeeded\n    ) {\n      this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSelecting.deSelectCaptureObjects();\n    } else {\n      this.mc.acWrapper.acs.acProperties.deselectNeeded = true;\n    }\n\n    if (\n      this.mc.acWrapper.acs.acProperties.isSmartSelectionWhenDrawing ||\n      !this.mc.acWrapper.acs.acProperties.isDrawing\n    ) {\n      let cGeo: AGeometryBase;\n      // for mobile environment, we want to reset the selection when you touch on the screen\n      if (\n        this.mc.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.browserUtility\n          .isMobile &&\n        this.mc.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus\n          .mode !== InteractionMode.Drawing\n      ) {\n        // popup for view\n        // console.log('-------------------mobile');\n        cGeo = this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.findAtPointByTouch(\n          e\n        ) as AGeometryBase;\n      } else {\n        cGeo = this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.findAtPoint(\n          e\n        ) as AGeometryBase;\n      }\n      // console.log('cGeo', cGeo);\n\n      if (cGeo) {\n        this.mc.acWrapper.acs.imageAnnoApp.scene.Capture = cGeo;\n      }\n      // console.log(cGeo);\n      if (\n        this.mc.acWrapper.acs.type === ActiveCommandMode.APOINT ||\n        this.mc.acWrapper.acs.type === ActiveCommandMode.POINT_ICON ||\n        this.mc.acWrapper.acs.type === ActiveCommandMode.POINT_NUMBERED ||\n        this.mc.acWrapper.acs.type === ActiveCommandMode.POINT_REGULAR ||\n        this.mc.acWrapper.acs.type === ActiveCommandMode.TEXT\n      ) {\n        if (this.mc.acWrapper.acs.imageAnnoApp.scene.capture !== undefined) {\n          if (\n            this.mc.acWrapper.acs.imageAnnoApp.scene.capture.type === GType.POINT_ICON ||\n            this.mc.acWrapper.acs.imageAnnoApp.scene.capture.type === GType.POINT_NUMBERED ||\n            this.mc.acWrapper.acs.imageAnnoApp.scene.capture.type === GType.POINT_REGULAR ||\n            this.mc.acWrapper.acs.imageAnnoApp.scene.capture.type === GType.TEXT ||\n            this.mc.acWrapper.acs.imageAnnoApp.scene.capture.type === GType.APOINT ||\n            this.mc.acWrapper.acs.imageAnnoApp.scene.capture.type === GType.CNODE\n          ) {\n            // console.log(AGeometryCommon.gcmdProcessing.capture);\n            // let dd = AGeometryCommon.gcmdProcessing.GetShapeByHashCol(AGeometryCommon.gcmdProcessing.capture.hashColor);\n            this.mc.acWrapper.acs.imageAnnoApp.scene.capture.isSelected = !this.mc.acWrapper.acs\n              .imageAnnoApp.scene.capture.isSelected;\n          } else {\n            this.mc.acWrapper.acs.imageAnnoApp.scene.capture.isCapturedValue = false;\n            this.mc.acWrapper.acs.imageAnnoApp.scene.capture = undefined;\n          }\n        }\n      } else {\n        if (this.mc.acWrapper.acs.imageAnnoApp.scene.capture !== undefined) {\n          if (this.mc.acWrapper.acs.imageAnnoApp.scene.capture.type === GType.TEXT) {\n            /* */\n          } else {\n            // console.log('serl');\n            this.mc.acWrapper.acs.imageAnnoApp.scene.capture.isSelected = !this.mc.acWrapper.acs\n              .imageAnnoApp.scene.capture.isSelected;\n            this.mc.acWrapper.acs.imageAnnoApp.scene.capture.mouseLeftClick(e.x, e.y);\n          }\n        } else {\n          // when you click a slected point\n          // console.log(this.mc.acWrapper.acs.annotationInstance.scene.capture);\n          // this.mc.acWrapper.acs.annotationInstance.scene.capture.IsSelected = true;\n        }\n        // ..................................... for Interactive Viewer Mode\n        if (\n          this.mc.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper\n            .appControllerStatus.mode === InteractionMode.InteractiveViewer\n        ) {\n          this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.processSelectionViewerMode();\n        }\n      }\n    }\n    // if (AGeometry.capture) {\n    //     const data = AGeometry.capture.ToJSON();\n    //     console.log(data);\n    // }\n    // CanvasCommandChain.GetCommandChain();\n    // ....................................\n    // if (AGeometry.capture) {\n    //     if (AGeometry.capture.type === GTYPE.ARROW_SINGLE || AGeometry.capture.type === GTYPE.ARROW_DOUBLE) {\n    //         AGeometry.Capture = undefined;\n    //         console.log(AGeometry.capture);\n    //     }\n    // }\n    // console.log(AGeometry.capture);\n    // this.mc.acWrapper.acs.app.activeCommandReactController.MouseLeftClick(e);\n\n    if (\n      this.mc.acWrapper.acs.type === ActiveCommandMode.NONE ||\n      this.mc.acWrapper.acs.type === ActiveCommandMode.SELECT ||\n      this.mc.acWrapper.acs.type === ActiveCommandMode.SELECT_LASSO ||\n      this.mc.acWrapper.acs.type === ActiveCommandMode.SELECT_RECT\n    ) {\n      this.mc.acWrapper.acs.imageAnnoApp.renderer.updateMouseHover(e); // to check the status when mouse click on map, to render shapes withno opacity;\n    }\n\n    if (!this.mc.acWrapper.acs.imageAnnoApp.scene.capture) {\n      // when clicking map, we want to deselect all the nodes of shapes in the scene\n      for (let i = 0; i < this.mc.acWrapper.acs.imageAnnoApp.scene.listAPoint.length; ++i) {\n        this.mc.acWrapper.acs.imageAnnoApp.scene.listAPoint[i].isSelectedSole = false;\n      }\n    }\n\n    if (\n      !this.mc.acWrapper.acs.imageAnnoApp.scene.Capture &&\n      this.mc.acWrapper.acs.type === ActiveCommandMode.SELECT\n    ) {\n      this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.removeAllPopup();\n      this.mc.acWrapper.acs.imageAnnoApp.io.eventListenerAnnotation.pointerOutStack();\n    }\n\n    this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.emitSelections();\n    this.mc.acWrapper.mouseLeftClick(e);\n  }\n  public mouseMiddleClickPre(e: MouseEventData) {\n    if (\n      !this.mc.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus\n        .currentControllerStatus.clickMiddle\n    ) {\n      return;\n    }\n\n    e = this.mc.acWrapper.acs.commonEvent(e);\n\n    // this.mc.acWrapper.acs.app.activeCommandReactController.MouseMiddleClick(e);\n    this.mc.acWrapper.mouseMiddleClick(e);\n  }\n  public mouseRightClickPre(e: MouseEventData) {\n    if (\n      !this.mc.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus\n        .currentControllerStatus.clickRight\n    ) {\n      return;\n    }\n\n    // console.log(e);\n    e = this.mc.acWrapper.acs.commonEvent(e);\n    // if (AGeometry.capture !== undefined) {\n    //   AGeometry.capture.MouseRightClick(e);\n    // }\n    this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.rightClickOnHoverGeo(e);\n\n    // this.mc.acWrapper.acs.app.activeCommandReactController.MouseRightClick(e);\n    this.mc.acWrapper.mouseRightClick(e);\n  }\n  public mouseUpPre(e: MouseEventData) {\n    // this.mc.acWrapper.acs.imageAnnoApp.sketch.mouseUp(e.x, e.y);\n    // this.mc.acWrapper.acs.imageAnnoApp.mapticon.mouseUp(e.x, e.y);\n    if (this.mc.acWrapper.acs.imageAnnoApp.implementations.app.INSPECTION) {\n      this.mc.acWrapper.acs.screenLog.push('MouseUpPre');\n      // console.log('MouseUpPre');\n    }\n\n    this.mc.acWrapper.acs.imageAnnoApp.activeCommandController.acProperties.isDragging = false;\n    this.mc.acWrapper.acs.imageAnnoApp.activeCommandController.acProperties.isUp = true;\n    this.mc.acWrapper.acs.imageAnnoApp.activeCommandController.acProperties.isDown = false;\n    this.mc.acWrapper.acs.imageAnnoApp.activeCommandController.acProperties.isClick = false;\n    e.isDown = false;\n\n    // if (this.mc.acWrapper.acs.app.nGraphics.compileMode !== COMPILE_MODE.PRODUCTION) {\n    //     if (this.mc.acWrapper.acs.annotationInstance.renderer.mouseVis) { this.mc.acWrapper.acs.annotationInstance.renderer.mouseVis.OnMouseUp(e); }\n    // }\n    // console.log(this.mc.acWrapper.acs.app.mapView);\n    // this.mc.acWrapper.acs.app.map.enablePan();\n    // if (AGeometry.capture !== undefined) { AGeometry.capture.isCaptured = false; AGeometry.capture = undefined; }\n    // if (this.mc.acWrapper.acs.app.nGraphics.compileMode !== COMPILE_MODE.PRODUCTION) {\n    //     if (this.mc.acWrapper.acs.annotationInstance.renderer.blackhole) { this.mc.acWrapper.acs.annotationInstance.renderer.blackhole.CheckGoBackPos(); }\n    // }\n    // console.log(AGeometry.capture);\n    // if (AGeometry.capture) { AGeometry.capture.MouseUp(); }\n\n    // ....................................................................................... update transformation stack\n    if (this.mc.acWrapper.acs.imageAnnoApp.scene.capture) {\n      const v = this.mc.acWrapper.acs.imageAnnoApp.scene.capture.getVecForSnapping();\n      if (v) {\n        this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.autoSnapping(v);\n      }\n    }\n\n    // ....................................................................................... end transformation stack\n\n    this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.doneDragging();\n\n    if (\n      this.mc.acWrapper.acs.imageAnnoApp.scene.Capture &&\n      this.mc.acWrapper.acs.imageAnnoApp.scene.Capture.type === GType.ANODE\n    ) {\n      // const ap = this.mc.acWrapper.acs.annotationInstance.scene.Capture as APoint;\n      // // console.log(ap);\n      // // ALine.InsertPoint(ap.vec);\n      // APoint.ComputeAllLineNetworkSnap();\n    }\n    // console.log(AGeometryCommon.gcmdProcessing.Capture);\n    if (this.mc.acWrapper.acs.acProperties.isDrawing) {\n      this.mc.acWrapper.acs.imageAnnoApp.scene.Capture = undefined;\n    }\n    // CUIController.MouseUp(e);\n\n    // for (let i = 0; i < ATextLeaderlineWrapper.list.length; ++i) { ATextLeaderlineWrapper.list[i].enableDrag = true; }\n\n    // ...............................................\n    if (this.mc.acWrapper.acs.imageAnnoApp.scene.Capture) {\n      // if(this.mc.acWrapper.acs.annotationInstance.scene.Capture.type === GTYPE.TEXT_LEADERLINE) {\n      //   // if (this.mc.acWrapper.acs.annotationInstance.scene.Capture && this.mc.acWrapper.acs.annotationInstance.scene.Capture.type === GTYPE.TEXT_LEADERLINE) {\n      //   // if (this.mc.acWrapper.acs.annotationInstance.scene.Capture && this.mc.acWrapper.acs.annotationInstance.scene.Capture.type === GTYPE.TEXT_LEADERLINE ) {\n      //   const t = this.mc.acWrapper.acs.annotationInstance.scene.Capture; // as ATextLeaderlineWrapper;\n      //   t.MouseUp();\n      //   // }\n      //   // const listATextLeaderlineWrapper= this.mc.acWrapper.acs.annotationInstance.scene.listATextLeaderlineWrapper\n      //   // for (let i = 0;i < listATextLeaderlineWrapper.length;++i) {\n      //   //   listATextLeaderlineWrapper[i].enableDrag = true;\n      //   //   console.log('ddddd');\n      //   //   listATextLeaderlineWrapper[i].EmitTransformationStackRightNode();\n      //   // }\n      //   }\n      this.mc.acWrapper.acs.imageAnnoApp.scene.Capture.mouseUp();\n    }\n\n    this.mc.acWrapper.acs.imageAnnoApp.renderer.objectSnapping.updateGhostSnappingVec(undefined);\n    // ALine.UpdatePathFinding();\n    // this.mc.acWrapper.acs.app.activeCommandReactController.MouseUp(e);\n\n    this.mc.acWrapper.acs.imageAnnoApp.scene.capturePT = undefined;\n    this.mc.acWrapper.acs.activeMouseCursor.updateActiveCursorByUp(this.mc.acWrapper.acs.type);\n\n    this.mc.acWrapper.mouseUp(e);\n    this.mouseUpPost(e);\n  }\n  public mouseUpPost(e: MouseEventData) {\n    if (this.mc.mDownPos.x !== e.x && this.mc.mDownPos.y !== e.y) {\n      this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.transformStack();\n    }\n\n  }\n  public mouseDoubleClickPre(e: MouseEventData) {\n    if (\n      !this.mc.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus\n        .currentControllerStatus.clickDouble\n    ) {\n      return;\n    }\n    e = this.mc.acWrapper.acs.commonEvent(e);\n\n    const cGeo: AGeometryBase = this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.findAtPoint(\n      e\n    ) as AGeometryBase;\n    if (cGeo !== undefined) {\n      if (cGeo.type === GType.TEXT_LEADERLINE) {\n        // const textLeaderline = cGeo as ATextLeaderlineWrapper;\n        // textLeaderline.MouseDoubleClick();\n      } else {\n        cGeo.mouseDoubleClick();\n      }\n      // console.log(cGeo);\n    }\n    // CUIController.MouseDouble(e);\n    // AText.MouseDouble(e);\n\n    // this.mc.acWrapper.acs.app.activeCommandReactController.MouseDoubleClick(e);\n    this.mc.acWrapper.mouseDoubleClick(e);\n  }\n  public mouseMovePre(e: MouseEventData) {\n    if (\n      !this.mc.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus\n        .currentControllerStatus.mouseMove\n    ) {\n      return;\n    }\n    if (e.isDown) {\n      this.mouseDragPre(e);\n      return;\n    }\n    // this.mc.acWrapper.acs.imageAnnoApp.mapticon.mouseMove(e.x, e.y);\n    // this.mc.acWrapper.acs.imageAnnoApp.sketch.mouseMove(e.x, e.y);\n    if (this._frameMove++ % 2 === 0) {\n      e = this.mc.acWrapper.acs.commonEvent(e);\n\n      if (!this.mc.acWrapper.acs.acProperties.isDrawing) {\n        if (\n          this.mc.acWrapper.acs.type === ActiveCommandMode.SELECT ||\n          this.mc.acWrapper.acs.type === ActiveCommandMode.NONE\n        ) {\n          this.mc.acWrapper.acs.imageAnnoApp.renderer.updateMouseHover(e);\n        }\n      }\n\n      if (\n        this.mc.acWrapper.acs.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas\n          .canvasLoopController.level === 3\n      ) {\n        this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n      }\n\n      this.mc.acWrapper.acs.activeMouseCursor.updateActiveCursorByMove(this.mc.acWrapper.acs.type);\n      this.mc.acWrapper.mouseMove(e);\n      this.mc.acWrapper.acs.imageAnnoApp.renderer.optimizer.mouseMove(e.x, e.y);\n    } else {\n      // console.log('skipping dragging execution');\n    }\n  }\n  public mouseDragPre(e: MouseEventData) {\n    // this.mc.acWrapper.acs.imageAnnoApp.sketch.mouseDrag(e.x, e.y);\n    // this.mc.acWrapper.acs.imageAnnoApp.mapticon.mouseDrag(e.x, e.y);\n    // if (this.mc.acWrapper.acs.type !== ActiveCommandMode.SELECT && this.mc.acWrapper.acs.acProperties.isActivateSnapping) { this.UpdatePosBySnapping(e); }\n    // console.log('drg');\n    // console.log(this.mc.acWrapper.acs.annotationInstance.scene.capture);\n    // // if (this.mc.acWrapper.acs.annotationInstance.scene.capture) {\n    // if (this.mc.acWrapper.acs.pressCtrlKey && this.mc.acWrapper.acs.annotationInstance.scene.capture ) {\n    //     this.MouseDownPre(e);\n    //     // this.mc.acWrapper.acs.annotationInstance.scene.capture = this.mc.acWrapper.acs.annotationInstance.geometryCommon.gcmdProcessing.FindAtPoint(e) as AGeometryBase;\n    //     // if (this.mc.acWrapper.acs.annotationInstance.scene.capture.type) {\n    //     //     console.log(this.mc.acWrapper.acs.annotationInstance.scene.capture.type);\n    //     //     this.mc.acWrapper.acs.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.enablePan = true;\n    //     // }\n    // }\n    // console.log(this.mc.acWrapper.acs.pressCtrlKey, this.mc.acWrapper.acs.annotationInstance.scene.capture);\n    // }\n\n    if (\n      !this.mc.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus\n        .currentControllerStatus.mouseDrag\n    ) {\n      return;\n    }\n    e = this.mc.acWrapper.acs.commonEvent(e);\n    this.mc.acWrapper.acs.imageAnnoApp.activeCommandController.acProperties.isDragging = true;\n\n    // if (this.mc.acWrapper.acs.app.nGraphics.compileMode !== COMPILE_MODE.PRODUCTION) {\n    //     if (this.mc.acWrapper.acs.annotationInstance.renderer.blackhole) { this.mc.acWrapper.acs.annotationInstance.renderer.blackhole.MovePos(e); }\n    // }\n    if (e.isDown === true) {\n      // console.log('drag-0', e.isDown, this.mc.acWrapper.acs.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.enablePan);\n      // if (AGeometryCommon.gcmdProcessing.HasSelectedOvered()) {\n      // console.log('-1', this.mc.acWrapper.acs.annotationInstance.scene.capture);\n      // if (!this.mc.acWrapper.acs.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.enablePan) {\n      // console.log('drag0', this.mc.acWrapper.acs.annotationInstance.scene.capture);\n      this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.moveMidPoint(e);\n      this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.moveSelectedGeo(e);\n      if (this.mc.acWrapper.acs.imageAnnoApp.scene.capture) {\n        // console.log('drag1', this.mc.acWrapper.acs.annotationInstance.scene.capture);\n        // console.log(this.mc.acWrapper.acs.annotationInstance.scene.capture);\n\n        if (\n          this.mc.acWrapper.acs.imageAnnoApp.scene.capture.type === GType.APOINT ||\n          this.mc.acWrapper.acs.imageAnnoApp.scene.capture.type === GType.CNODE\n        ) {\n          const p = this.mc.acWrapper.acs.imageAnnoApp.scene.capture as APoint;\n          // console.log('drag2', this.mc.acWrapper.acs.annotationInstance.scene.capture);\n          p.move(e.x, e.y);\n          // console.log(p);\n        }\n      }\n\n      // ............................... start copy by dragging with alt key\n      if (this.mc.acWrapper.acs.acProperties.pressAltKey) {\n        if (this.mc.acWrapper.acs.acProperties.needDuplicateByAlt) {\n          // this.mc.acWrapper.acs.annotationInstance.geometryCommon.gcmdProcessing.DuplicateByDragging()\n          this.mc.acWrapper.acs.acProperties.needDuplicateByAlt = false;\n        }\n      }\n      // ............................... end copy by dragging with alt key\n      // }\n    }\n    // CUIController.MouseDrag(e);\n    // this.mc.acWrapper.acs.app.screen.aGeometryRender.UpdateMouseOver(e); // if activate, curve cp become sensitive to drag\n    // this.mc.acWrapper.acs.app.activeCommandReactController.MouseDrag(e);\n\n    if (this.mc.acWrapper.acs.imageAnnoApp.scene.capture) {\n      const v = this.mc.acWrapper.acs.imageAnnoApp.scene.capture.getVecForSnapping();\n      if (v) {\n        this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.autoSnappingTracker(v);\n      }\n    }\n\n    if (\n      this.mc.acWrapper.acs.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas\n        .canvasLoopController.level === 3\n    ) {\n      // for loop 3\n      this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n    }\n\n    if (this.mc.acWrapper.acs.imageAnnoApp.scene.captureHovered) {\n      this.mc.acWrapper.acs.activeMouseCursor.updateActiveCursorByDrag(\n        this.mc.acWrapper.acs.imageAnnoApp.scene.captureHovered\n      );\n    }\n    this.mc.acWrapper.acs.acProperties.needExecuteOptimizer = true;\n    this.mc.acWrapper.mouseDrag(e);\n  }\n  private filterNodeSelectionForMovingMultipleShapes(cGeo: AGeometryBase, e: MouseEventData) {\n    // when dragging one of the node of polyline or polygon, we need to disable the\n    // console.log(cGeo.type);\n\n    // for the mid point of Arrow family\n    if (\n      (cGeo.type === GType.AMIDPOINT && (cGeo as APoint).edges[0].type === GType.ARROW_SINGLE) ||\n      (cGeo.type === GType.AMIDPOINT && (cGeo as APoint).edges[0].type === GType.ARROW_DOUBLE)\n    ) {\n      const mp = cGeo as APoint;\n      this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSelecting.deSelectAllObjects();\n      mp.edges[0].isHover = true;\n      mp.isSelected = true;\n      return;\n    }\n    // for the end points of Arrow family\n    if (\n      (cGeo as AGeometryBase).type === GType.ARROW_SINGLE ||\n      (cGeo as AGeometryBase).type === GType.ARROW_DOUBLE\n    ) {\n      const v = cGeo.findClosestNode(e.x, e.y) as APoint;\n      if (v) {\n        this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSelecting.deSelectAllObjects();\n        v.edges[0].isHover = true;\n        v.isSelected = true;\n      }\n      return;\n    }\n\n    if (cGeo.type === GType.ANODE) {\n      this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSelecting.deSelectAllObjects();\n      (cGeo as APoint).aEdges[0].pGraph.isSelected = true;\n      return;\n    }\n\n    if (cGeo.type === GType.ANODE_RECT) {\n      this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSelecting.deSelectAllObjects();\n      (cGeo as AGeometryBase).isSelected = true;\n      return;\n    }\n\n    if (cGeo.type === GType.ANODE_CIRCLE) {\n      this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSelecting.deSelectAllObjects();\n      (cGeo as AGeometryBase).isSelected = true;\n      return;\n    }\n\n    if (cGeo.type === GType.POLYGON_GRAPH) {\n      const pg = cGeo as APolygonGraphWrapper;\n      const v = pg.getVecForSnapping();\n      if (v) {\n        this.mc.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdSelecting.deSelectAllObjects();\n        cGeo.isSelected = true;\n      }\n      return;\n    }\n\n  }\n}\n","import {\n  ClickType,\n  MouseEventData,\n  NVector3\n} from '../../../../../lib';\nimport { ActiveCommandCommonWrapper } from '../../ActiveCommandImplementation/Base/ActiveCommandCommonWrapper';\nimport { MouseEventBase } from './MouseEvent/Base/MouseEventBase';\nimport { MouseEventAnnotationImage } from './MouseEvent/MouseEventAnnoImage';\nexport class MouseEventController {\n  public acWrapper: ActiveCommandCommonWrapper;\n  public MouseEvent: MouseEventBase;\n  public mDownPos = new NVector3(-1, -1);\n  constructor(activeCommandCommon: ActiveCommandCommonWrapper) {\n    this.acWrapper = activeCommandCommon;\n    this.MouseEvent = new MouseEventAnnotationImage(this);\n  }\n  public mouseEventController(e: MouseEventData) {\n    if (\n      this.acWrapper.acs.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.canvasLoopController.level < 3\n    ) {\n      return;\n    }\n    if (\n      this.acWrapper.acs.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.canvasLoopController.level === 4\n    ) {\n      // for loop 3\n      this.acWrapper.acs.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.canvasLoopController.stop = false;\n    }\n    if (\n      !this.acWrapper.acs.imageAnnoApp.implementations.app.model.appCoreWrapper.appProperties.isStandalone\n    ) {\n      if (this.isOutsideExtent(e)) {\n        return;\n      }\n    }\n\n    switch (e.CLICK_TYPE) {\n      case ClickType.Down:\n        this.MouseEvent.mouseDownPre(e);\n        this.mouseDownPost(e);\n        break;\n      case ClickType.Up:\n        this.MouseEvent.mouseUpPre(e);\n        this.mouseUpPost(e);\n        break;\n      case ClickType.Left:\n        this.MouseEvent.mouseLeftClickPre(e);\n        this.mouseLeftClickPost(e);\n        break;\n      case ClickType.Middle:\n        this.MouseEvent.mouseMiddleClickPre(e);\n        this.mouseMiddleClickPost(e);\n        break;\n      case ClickType.Right:\n        this.MouseEvent.mouseRightClickPre(e);\n        this.mouseRightClickPost(e);\n        break;\n      case ClickType.Double:\n        this.MouseEvent.mouseDoubleClickPre(e);\n        this.mouseDoubleClickPost(e);\n        break;\n      case ClickType.Move:\n        this.MouseEvent.mouseMovePre(e);\n        this.mouseMovePost(e);\n        break;\n      case ClickType.Drag:\n        this.MouseEvent.mouseDragPre(e);\n        this.mouseDragPost(e);\n        break;\n      case ClickType.Wheel:\n        this.MouseEvent.mouseWheelPre(e);\n        this.mouseWheelPost(e);\n        break;\n      default:\n        break;\n    }\n  }\n  public updatePosBySnapping(e: MouseEventData) {\n    // project the position to screen space\n    const posBySnapping = this.acWrapper.acs.imageAnnoApp.geometryCommon.gcmdProcessing.getPosBySnapping(e.x, e.y, 20);\n    e.x = posBySnapping[0];\n    e.y = posBySnapping[1];\n  }\n  // ..............................................................................................\n  private isOutsideExtent(e: MouseEventData) {\n    const theWidth = this.acWrapper.acs.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvasMask.width;\n    if (theWidth > e.x) {\n      return true;\n    }\n    if (this.acWrapper.acs.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvasMask.canvas.width - theWidth < e.x ) {\n      return true;\n    }\n    return false;\n  }\n  // ..................................................\n  private mouseDownPost(e: MouseEventData) {\n    //\n  }\n  private mouseUpPost(e: MouseEventData) {\n    //\n  }\n  private mouseLeftClickPost(e: MouseEventData) {\n    //\n  }\n  private mouseMiddleClickPost(e: MouseEventData) {\n    //\n  }\n  private mouseRightClickPost(e: MouseEventData) {\n    //\n  }\n  private mouseDoubleClickPost(e: MouseEventData) {\n    //\n  }\n  private mouseMovePost(e: MouseEventData) {\n    // if (this.acWrapper.acs.imageAnnoApp.implementations.app.addon) {\n    //   //\n    // }\n  }\n  private mouseDragPost(e: MouseEventData) {\n    //\n  }\n  private mouseWheelPost(e: MouseEventData) {\n    //\n  }\n  // .............................................................................................. Guided Tour\n}\n","import { KeyboardEventData } from '../../../../../../../lib/EventData/KeyboardEventData';\nimport { MouseEventData } from '../../../../../../../lib/EventData/MouseEventData';\nimport { TouchEventDataList } from '../../../../../../../lib/EventData/TouchEventData';\nimport { ActiveCommandController } from '../../ActiveCommandController';\nimport { KeyboardEventController } from '../../ActiveCommandEvent/KeyboardEventController/KeyboardEventController';\nimport { MouseEventController } from '../../ActiveCommandEvent/MouseEventController/MouseEventController';\nexport class ActiveCommandCommonWrapper {\n  public acs: ActiveCommandController;\n  private mouseController: MouseEventController;\n  private keyboardController: KeyboardEventController;\n  constructor(acs: ActiveCommandController) {\n    this.acs = acs;\n    this.mouseController = new MouseEventController(this);\n    this.keyboardController = new KeyboardEventController(this);\n  }\n  public mouseEventController(e: MouseEventData) {\n    this.mouseController.mouseEventController(e);\n  }\n  public keyboardEventController(k: KeyboardEventData) {\n    this.keyboardController.keyboardEventController(k);\n  }\n  public keyboardEventControllerFromDocument(k: KeyboardEventData) {\n    this.keyboardController.keyboardEventControllerFromDocument(k);\n  }\n  public touchEventController(t: TouchEventDataList) {\n    // this.touchController.touchEventController(t);\n  }\n  // .................................................................. implementation needed\n  public mouseDown(e: MouseEventData) {\n    /* */\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    /* */\n  }\n  public mouseMiddleClick(e: MouseEventData) {\n    /* */\n  }\n  public mouseRightClick(e: MouseEventData) {\n    /* */\n  }\n  public mouseDoubleClick(e: MouseEventData) {\n    /* */\n  }\n  public mouseUp(e: MouseEventData) {\n    /* */\n  }\n  public mouseMove(e: MouseEventData) {\n    /* */\n  }\n  public mouseDrag(e: MouseEventData) {\n    /* */\n  }\n  public keydown(k: KeyboardEventData) {\n    /* */\n  }\n  public keyUp(k: KeyboardEventData) {\n    /* */\n  }\n  public undo() {\n    /* */\n  }\n  public cancel() {\n    /* */\n  }\n}\n","import { MouseEventData } from '../../../../../../lib/EventData/MouseEventData';\nimport { ARemove } from '../../Geometry/GeometryAnnotation/ARemove';\nimport { ASelection } from '../../Geometry/GeometryAnnotation/ASelection';\nimport { ActiveCommandController } from '../ActiveCommandController';\nimport { ActiveCommandCommonWrapper } from './Base/ActiveCommandCommonWrapper';\nexport class CActiveCommandNone extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    /* */\n  }\n}\nexport class CActiveCommandRemove extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    ARemove.mouseDown(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseMove(e: MouseEventData) {\n    ARemove.mouseMove(e);\n  }\n}\nexport class CActiveCommandSelection extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    // this.acs.app.map.disablePan();\n    this.acs.imageAnnoApp.renderer.selection.mouseDown(e);\n  }\n  public mouseDrag(e: MouseEventData) {\n    /**/\n  }\n  public mouseUp(e: MouseEventData) {\n    /**/\n  }\n}\nexport class CActiveCommandSelectionRect extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    this.acs.imageAnnoApp.geometryCommon.gcmdSelecting.deSelectAllObjects();\n    this.acs.imageAnnoApp.renderer.selection.mouseDown(e);\n  }\n  public mouseDrag(e: MouseEventData) {\n    // CSelection.isLasso = false;\n    ASelection.isLasso = false;\n    this.acs.imageAnnoApp.renderer.selection.mouseDrag(e);\n  }\n  public mouseUp(e: MouseEventData) {\n    // CSelection.isLasso = false;\n    ASelection.isLasso = false;\n    this.acs.imageAnnoApp.renderer.selection.mouseUp(e);\n    this.acs.goToACMode();\n  }\n  public mouseMove(e: MouseEventData) {\n    this.acs.imageAnnoApp.renderer.selection.mouseMove(e);\n  }\n}\nexport class CActiveCommandSelectionLasso extends CActiveCommandSelectionRect {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    this.acs.imageAnnoApp.geometryCommon.gcmdSelecting.deSelectAllObjects();\n    this.acs.imageAnnoApp.renderer.selection.mouseDown(e);\n  }\n  public mouseDrag(e: MouseEventData) {\n    // CSelection.isLasso = true;\n    ASelection.isLasso = true;\n    this.acs.imageAnnoApp.renderer.selection.mouseDrag(e);\n  }\n  public mouseUp(e: MouseEventData) {\n    // CSelection.isLasso = true;\n    ASelection.isLasso = true;\n    this.acs.imageAnnoApp.renderer.selection.mouseUp(e);\n    this.acs.goToACMode();\n  }\n  public mouseMove(e: MouseEventData) {\n    this.acs.imageAnnoApp.renderer.selection.mouseMove(e);\n  }\n}\n","import { getDistance, NVector3 } from '../../../../../../../lib';\nimport { AGeometryBase } from '../../../../Common/Base/AGeometryBase';\nimport { ACircle } from '../ACircle';\nexport class InteractionComponent {\n  public geo: AGeometryBase;\n  public host: ACircle;\n  constructor(geo: AGeometryBase) {\n    this.geo = geo;\n    this.host = geo as ACircle;\n  }\n  public isMouseInside(x: number, y: number) {\n    if (this.host.isRemove || !this.host.isRenderable || this.host.isHiddenValue) {\n      return false;\n    }\n    if (this.checkCP(x, y)) {\n      return true;\n    }\n    const dx = x - this.host.vec.x;\n    const dy = y - this.host.vec.y;\n    return (\n      (dx * dx) / (this.host.widthHalf * this.host.widthHalf) +\n        (dy * dy) / (this.host.heightHalf * this.host.heightHalf) <=\n      1.1\n    );\n    // return this.Distance(x, y) <= this.r;\n  }\n  public getLog() {\n    // this.UpdateGoeVec();\n    const text =\n      'GUID : ' +\n      this.host.id +\n      '/' +\n      'TYPE : ' +\n      this.host.type.toString() +\n      '/' +\n      // 'PARENT : ' + this.host.edges[0].GetParentType()+'<br>'+\n      // 'Geo : ' + 'lat:' + this.host.vec.long.toFixed(5).toString() + ', Log:' + this.host.vec.lat.toFixed(5).toString() + '/' +\n      'Screen : ' +\n      // this.host.vec.ToString() +\n      '/' +\n      'heightHalf : ' +\n      this.host.widthHalf.toFixed(3).toString() +\n      ' pixel' +\n      '/' +\n      'R2 : ' +\n      this.host.heightHalf.toFixed(3).toString() +\n      ' pixel' +\n      '/' +\n      'Area : ' +\n      this.host.getArea().toFixed(3).toString() +\n      ' m2' +\n      '/' +\n      // 'STYLE : ' + this.host.style.toString() + '/' +\n      // 'CONNE :' + this.host.edges.length.toString() + '/' +\n      'IsSEL : ' +\n      this.host.isSelectedValue +\n      '/' +\n      'isSelable : ' +\n      this.host.isSelectable;\n    return text;\n  }\n  public checkCP(x: number, y: number) {\n    const m = new NVector3(x, y);\n    for (let i = 0; i < this.host.vecsCP.length; ++i) {\n      if (getDistance(m, this.host.vecsCP[i]) < 10) {\n        this.host.vecSelectedCp = i;\n        return true;\n      }\n    }\n    this.host.vecSelectedCp = -1;\n    return false;\n  }\n  public hide(): void {\n    //\n  }\n}\n","import { NVector3 } from '../../../../../../../lib';\nimport { RendererComponent as _RendererComponent } from '../../../../Common/Base/ComponentTemplate/RendererComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { ACircle } from '../ACircle';\nexport class RendererComponent extends _RendererComponent {\n  public host: ACircle;\n  public renderStyle: RenderStyle;\n  public renderStyleNode: RenderStyle;\n  constructor(host: ACircle) {\n    super(host);\n    this.host = host;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.host.getCenterVec();\n    this.interpolateColor.update();\n    this.timer.update();\n    this.timer.updatePopupSummery();\n\n    // if (this.host.scene.annotationInstance.activeCommandController.acProperties.showUnit) {\n    //   if (this.host.isHover || this.host.isUnderConstruction) {\n    //     this.host.dimension.RenderLengthCircle(ctx, this.host.vec, this.host.vecs);\n    //     this.host.dimension.RenderTotalAreaCircle(ctx, this.host.vec, this.host.vecs);\n    //   }\n    // }\n\n    // if (this.scene.annotationInstance.implementation.app.versionJSAPI === '4.8') {\n    //     if (this.wrapping.needWrappingDuplicate) {\n    //         this.RenderPostGeometryDuplicationCustom(ctx);\n    //     } else {\n    //         this.RenderPostGeometry(ctx);\n    //     }\n    // } else {\n    this.renderPostGeometry(ctx);\n    // }\n  }\n  private renderPostGeometry(ctx: CanvasRenderingContext2D) {\n    if (this.host.isHoverValue || this.host.isSelectedValue) {\n      this.renderBoundbox(ctx);\n      this.host.scene.annotationInstance.renderer.draw.shape.point.centerPoint(\n        ctx,\n        this.host.vec.x,\n        this.host.vec.y\n      );\n      // this.host.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.CircleOver(ctx, this.host.style, this.host.vec.x, this.host.vec.y, this.host.r);\n      this.host.scene.annotationInstance.renderer.draw.shape.area.ellipseHover(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        this.host.vec.x,\n        this.host.vec.y,\n        this.host.widthHalf,\n        this.host.heightHalf,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.host.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(\n          this.host.renderer.tOver\n        ),\n        this.host.isHoverValue,\n        this.host.isSelectedValue\n      );\n      this.host.scene.annotationInstance.renderer.draw.shape.area.ellipse(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        this.host.vec.x,\n        this.host.vec.y,\n        this.host.widthHalf,\n        this.host.heightHalf,\n        this.host.isFill,\n        this.host.isHoverValue,\n        this.host.isSelectedValue\n      );\n\n      this.host.renderer.tOver += this.host.scene.annotationInstance.renderer.dt;\n      this.host.renderer.tDown1 = 0;\n      this.host.isLeave = true;\n    } else {\n      // if(this.host.isPointMid) this.host.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.CircleMid(ctx,this.host.vec.x, this.host.vec.y)\n      // this.host.scene.annotationInstance.renderer.preset.drawingPresetRenderStyle.Circle(ctx, this.host.style, this.host.vec.x, this.host.vec.y, this.host.r);\n      this.host.scene.annotationInstance.renderer.draw.shape.area.ellipse(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        this.host.vec.x,\n        this.host.vec.y,\n        this.host.widthHalf,\n        this.host.heightHalf,\n        this.host.isFill,\n        this.host.isHoverValue,\n        this.host.isSelectedValue\n      );\n      this.host.renderer.tOver = 0;\n    }\n\n    if (\n      this.host.isUnderConstruction ||\n      this.host.isHoverValue // &&\n      // this.host.scene.annotationInstance.uiWrapper &&\n      // !this.host.scene.annotationInstance.uiWrapper.log.isHidden\n    ) {\n      // this.host.scene.annotationInstance.renderer.draw.shape.area.EllipseDim(ctx, this.host.styleComponent.renderStyle, this.host.vec.x, this.host.vec.y, this.host.widthHalf, this.host.heightHalf, this.host.GetArea().toFixed(3).toString());\n    }\n    this.renderPostGeometryOffScreen(this.host.vec);\n  }\n  private renderBoundbox(ctx: CanvasRenderingContext2D): void {\n    this.host.vecsCP[0].x = this.host.vec.x - this.host.widthHalf;\n    this.host.vecsCP[0].y = this.host.vec.y - this.host.heightHalf;\n\n    this.host.vecsCP[1].x = this.host.vec.x + this.host.widthHalf;\n    this.host.vecsCP[1].y = this.host.vec.y - this.host.heightHalf;\n\n    this.host.vecsCP[2].x = this.host.vec.x + this.host.widthHalf;\n    this.host.vecsCP[2].y = this.host.vec.y + this.host.heightHalf;\n\n    this.host.vecsCP[3].x = this.host.vec.x - this.host.widthHalf;\n    this.host.vecsCP[3].y = this.host.vec.y + this.host.heightHalf;\n\n    ctx.lineWidth = 1.5;\n    ctx.strokeStyle = this.host.styleComponent.renderStyle.colorStroke;\n    ctx.beginPath();\n    ctx.moveTo(this.host.vecsCP[0].x, this.host.vecsCP[0].y);\n    for (let i = 1; i < this.host.vecsCP.length; ++i) {\n      ctx.lineTo(this.host.vecsCP[i].x, this.host.vecsCP[i].y);\n    }\n    ctx.closePath();\n    ctx.stroke();\n\n    ctx.fillStyle = this.host.styleComponent.renderStyleNode.colorFill;\n    ctx.lineWidth = this.host.styleComponent.renderStyleNode.lineWidth;\n    ctx.strokeStyle = this.host.styleComponent.renderStyleNode.colorStroke;\n    for (let i = 0; i < this.host.vecsCP.length; ++i) {\n      ctx.beginPath();\n      ctx.arc(this.host.vecsCP[i].x, this.host.vecsCP[i].y, 5, 0.0, Math.PI * 2.0);\n      ctx.closePath();\n      ctx.fill();\n      ctx.stroke();\n    }\n  }\n  // private RenderDimension(ctx: CanvasRenderingContext2D) {\n  //   // if (!this.host.isConstraint) {\n  //   if (this.host.type === GTYPE.POLYGON) {\n  //     if (this.host.isHover || this.host.isUnderConstruction) {\n  //       this.host.dimension.RenderLengthCircle(ctx, this.host.vecOtherCenter, this.host.wrapping.vsOther);\n  //     }\n  //   } else {\n  //     if (this.host.isHover || this.host.isUnderConstruction) {\n  //       this.host.dimension.RenderLengthCircle(ctx, this.host.vecOtherCenter, this.host.wrapping.vsOther);\n  //     }\n  //   }\n  // }\n  private renderPostGeometryOffScreen(cp: NVector3) {\n    this.host.scene.annotationInstance.renderer.offscreen.ellipseOffScreen(\n      this.host.scene.annotationInstance.renderer.ctxOffscreen,\n      this.host.styleComponent.renderStyle,\n      this.host.hashColor,\n      cp.x,\n      cp.y,\n      this.host.widthHalf,\n      this.host.heightHalf,\n      this.host.isFill\n    );\n  }\n}\n","import { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { ACircle } from '../ACircle';\nexport class StyleComponent extends _StyleComponent {\n  public geo: ACircle;\n  public renderStyle: RenderStyle;\n  public renderStyleNode: RenderStyle;\n  constructor(geo: ACircle) {\n    super(geo);\n    this.renderStyle = new RenderStyle(this);\n    this.renderStyleNode = new RenderStyle(this);\n    this.updateStyle();\n  }\n  public updateStyle() {\n    RenderStyle.updateRenderStylePolygon(\n      this.renderStyle,\n      this.geo.scene.annotationInstance.customization.themeCurrent\n    );\n    RenderStyle.updateRenderStylePolygonNode(\n      this.renderStyleNode,\n      this.geo.scene.annotationInstance.customization.themeCurrent\n    );\n    for (let i = 0; i < this.geo.pts.length; ++i) {\n      this.geo.pts[i].styleComponent.updateStyleForNode(this.renderStyleNode);\n    }\n  }\n  public setDash(v: number[]) {\n    this.renderStyle.dash = v;\n    this.geo.scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n      this.geo.toJSON()\n    );\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public toJson(): any | undefined {\n    if (this.renderStyle.dash.length > 0) {\n      return { dash: this.renderStyle.dash };\n    }\n    return undefined;\n  }\n}\n","import { MouseEventData } from '../../../../../../../lib';\nimport { AGeometryBase } from '../../../../Common/Base/AGeometryBase';\nimport { TransformationComponent as _TransformationComponent } from '../../../../Common/Base/ComponentTemplate/TransformationComponent';\nimport { ACircle } from '../ACircle';\nexport class TransformationComponent extends _TransformationComponent {\n  public geo: AGeometryBase;\n  public host: ACircle;\n  // v: NVector3;\n  constructor(geo: AGeometryBase) {\n    super(geo);\n    this.geo = geo;\n    this.host = geo as ACircle;\n  }\n  public translateByMouseEventData(e: MouseEventData) {\n    if (this.host.vecSelected !== -1) {\n      // console.log(this.host.vecSelected);\n      this.host.pts[this.host.vecSelected].translateByMouseEventData(e);\n      return;\n    }\n    if (this.host.isRemove || !this.host.isRenderable || this.host.isHiddenValue) {\n      return;\n    }\n    this.host.vec.x += e.x - e.preX;\n    this.host.vec.y += e.y - e.preY;\n    this.host.updateCP();\n  }\n}\n","import { IOGeometry } from '../../../../../../lib/Extended/GeometryUtility';\nimport {\n  MouseEventData,\n  GType,\n  getCenterVecFromVecs,\n  getDistance,\n  getXYDimForCircle,\n  NVector3,\n  plus,\n  scale,\n  getRadiusByArea, \n  getRadiusByCircumference,\n} from '../../../../../../lib';\nimport { ActiveCommandController } from '../../../../ActiveCommandController/ActiveCommandController';\nimport { Scene } from '../../../../Scene';\nimport { AGeometryBase } from '../../../Common/Base/AGeometryBase';\nimport { APoint } from '../../FamilyPoint/Base/APoint';\nimport { Dimension } from '../../Helper/Dimension';\nimport { InteractionComponent } from './Component/InteractionComponent';\nimport { RendererComponent } from './Component/RendererComponent';\nimport { StyleComponent } from './Component/StyleComponent';\nimport { TransformationComponent } from './Component/TransformationComponent';\nexport class ACircle extends AGeometryBase {\n  public static isDone = false;\n  public static construction: ACircle | undefined = undefined;\n  public interaction: InteractionComponent;\n  public pts: APoint[];\n  public vec: NVector3;\n  public vecs: NVector3[] = [];\n  public vecsCP: NVector3[] = [];\n  public tVec: NVector3;\n  public widthHalf: number;\n  public heightHalf: number;\n  public rOrigin: number;\n  public rTaget: number;\n  public vecSelected = -1;\n  public vecSelectedCp = -1;\n  public isFill: boolean;\n  // block: BlockCircle;\n  public vecOtherCenter: NVector3;\n  // ...................................\n  public dimension: Dimension;\n\n  static fromJSON(scene: Scene, g: IOGeometry, isUndo = false, isDeepCopy = false) {\n    const p = APoint.getNodeFromJSON(scene, g.nodes[0], isUndo);\n    const geo = new ACircle(scene, p.vec.x, p.vec.y, 0, isUndo);\n    p.remove();\n\n    const p0 = APoint.getNodeFromJSON(scene, g.nodes[1]);\n    const p1 = APoint.getNodeFromJSON(scene, g.nodes[2]);\n\n    geo.R0 = p0.vec.x - geo.vec.x;\n    geo.R1 = p1.vec.y - geo.vec.y;\n    p0.remove();\n    p1.remove();\n\n    geo.type = GType[g.type];\n    // geo.style = g.style;\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n\n    geo.isHiddenValue = g.isHidden;\n    if (g.isHidden) {\n      geo.visibilityValue = 0;\n    } else {\n      geo.visibilityValue = 1.0;\n    }\n\n    if (g.styles && g.styles.dash) {\n      geo.styleComponent.renderStyle.dash = g.styles.dash;\n    }\n\n    if (!isDeepCopy) {\n      geo.id = g.id;\n    } else {\n      geo.id = scene.getUUID();\n    }\n\n    geo.initVecsHistory();\n    if (!isUndo && isDeepCopy) {\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n    } else {\n      geo.isHover = false;\n    }\n    return geo;\n  }\n  static cancel() {\n    if (ACircle.construction !== undefined) {\n      ACircle.construction.remove();\n    }\n    ACircle.construction = undefined;\n  }\n  static getLengthSelection(scene: Scene) {\n    let i = scene.listACircleWrapperr.length;\n    let count = 0;\n    while (i--) {\n      if (scene.listACircleWrapperr[i].isSelected) {\n        count += 1;\n      }\n    }\n    return count;\n  }\n  static drawShadow(e: MouseEventData) {\n    if (ACircle.construction !== undefined) {\n      ACircle.construction.R = ACircle.construction.distance(e.x, e.y);\n      ACircle.construction.updateCP();\n    }\n  }\n  static getCircleFromVoice(scene: Scene) {\n    const cv = new NVector3(\n      scene.annotationInstance.geometryCommon.gcmdProcessing.width * 0.5,\n      scene.annotationInstance.geometryCommon.gcmdProcessing.height * 0.5\n    );\n    this.getCircleByVecs(scene, [\n      cv,\n      new NVector3(cv.x + 100, cv.y),\n      new NVector3(cv.x, cv.y + 100),\n    ]);\n  }\n  static getCircleByVecs(scene: Scene, vs: NVector3[]) {\n    const cv = getCenterVecFromVecs(vs);\n    const dim = getXYDimForCircle(vs);\n\n    const geo = new ACircle(scene, cv.x, cv.y, 0, false, dim[0] * 2);\n    geo.updateCP();\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n    scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n  }\n  static getCircleByArea(scene: Scene, area: number, x: number, y: number) {\n    let radius = getRadiusByArea(area);\n    radius = scene.annotationInstance.geometryCommon.gcmdProcessing.toMapConvertGeoDis(\n      x,\n      y,\n      radius\n    );\n    const geo = new ACircle(scene, x, y, 0, false, radius);\n    geo.updateCP();\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n    scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n    ACircle.construction = geo;\n  }\n  static getCircleByCircumference(scene: Scene, circumference: number, x: number, y: number) {\n    let radius = getRadiusByCircumference(circumference);\n    radius = scene.annotationInstance.geometryCommon.gcmdProcessing.toMapConvertGeoDis(\n      x,\n      y,\n      radius\n    );\n    const geo = new ACircle(scene, x, y, 0, false, radius);\n    geo.updateCP();\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n    scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n    ACircle.construction = geo;\n  }\n  static getCircle(scene: Scene, e: MouseEventData) {\n    if (ACircle.construction !== undefined) {\n      ACircle.construction.r = ACircle.construction.distance(e.x, e.y);\n      ACircle.construction.IsSelectable = true;\n      ACircle.construction.isUnderConstruction = false;\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n        ACircle.construction.toJSON()\n      );\n      ACircle.construction = undefined;\n    } else {\n      ACircle.construction = new ACircle(scene, e.x, e.y);\n      ACircle.construction.IsSelectable = false;\n    }\n  }\n  // ................................................................\n  static mouseDown(scene: Scene, e: MouseEventData) {\n    /*\n    if (ACircle.construction !== undefined) {\n      ACircle.GetCircle(scene, e);\n      ACircle.construction = undefined;\n      ACircle.isDone = true;\n    }\n    */\n  }\n  static onMouseMiddleClick(e: MouseEventData) {\n    /* */\n  }\n  static onMouseRightClick(e: MouseEventData) {\n    /* */\n  }\n  static onMouseLeftClick(scene: Scene, e: MouseEventData) {\n    this.getCirlceByTouch(scene, e);\n    /*\n    if (scene.annotationInstance.activeCommandController.IsTouchEvent) {\n      this.GetCirlceByTouch(scene, e);\n      scene.annotationInstance.activeCommandController.SetActiveCommand(ACTIVECOMMAND_MODE.SELECT);\n      return;\n    }\n    if (ACircle.isDone) {\n      ACircle.isDone = false;\n      scene.annotationInstance.activeCommandController.GoToACMode();\n      return;\n    }\n    if (scene.capture !== undefined) {\n      return;\n    }\n    if (ACircle.construction === undefined) {\n      ACircle.GetCircle(scene, e);\n    }\n    */\n  }\n  static onMouseMove(e: MouseEventData) {\n    // if (ACircle.construction !== undefined) {\n    //   ACircle.DrawShadow(e);\n    // }\n  }\n  static onMouseDrag(scene: Scene, e: MouseEventData) {\n    if (ACircle.construction !== undefined) {\n      ACircle.drawShadow(e);\n    } else {\n      ACircle.getCircle(scene, e);\n      // ACircle.construction = undefined;\n      // ACircle.isDone = true;\n    }\n  }\n  static onMouseUp(scene: Scene, e: MouseEventData) {\n    if (ACircle.construction) {\n      ACircle.construction.IsSelectable = true;\n      ACircle.construction.isUnderConstruction = false;\n      ACircle.construction.isSelected = false;\n      ACircle.construction = undefined;\n      ACircle.isDone = true;\n      scene.annotationInstance.activeCommandController.goToACMode();\n    }\n  }\n  static getCirlceByTouch(scene: Scene, e: MouseEventData) {\n    const geo = new ACircle(scene, e.x, e.y, 0, false, 128 * 0.5);\n    geo.updateCP();\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n    geo.isSelected = false;\n    scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n    scene.annotationInstance.activeCommandController.goToACMode();\n  }\n\n  constructor(\n    scene: Scene,\n    x = 0,\n    y = 0,\n    z = 0,\n    isUndo = false,\n    radius = 5,\n    colorCircle = 'white',\n    colorBorder = 'black'\n  ) {\n    super(scene);\n    this.isUndo = isUndo;\n    this.vec = new NVector3(x, y, z);\n    // const mp = this.scene.annotationInstance.geometryCommon.gcmdSupporting.toMap(x, y);\n    // this.vec.long = mp[0]; this.vec.long = mp[1];\n    // this.vec.proX = mp[2]; this.vec.proY = mp[3];\n\n    this.widthHalf = radius;\n    this.heightHalf = radius;\n    this.rOrigin = radius;\n    this.rTaget = radius + 10;\n\n    this.pts = [];\n    this.r = 1;\n    this.initComponent();\n\n    this.pts[0] = new APoint(\n      this.scene,\n      this.vec.x + this.r * 0.5,\n      this.vec.y + this.r * 0.5,\n      this.vec.z,\n      this.isUndo\n    );\n    this.pts[2] = new APoint(\n      this.scene,\n      this.vec.x + this.r * 0.5,\n      this.vec.y + this.r * 0.5,\n      this.vec.z + this.r * 0.5,\n      this.isUndo\n    );\n\n    this.pts[1] = new APoint(\n      this.scene,\n      this.vec.x,\n      this.vec.y - this.r * 0.5,\n      this.vec.z,\n      this.isUndo\n    );\n    this.pts[3] = new APoint(\n      this.scene,\n      this.vec.x + this.r * 0.5,\n      this.vec.y + this.r * 0.5,\n      this.vec.z + this.r * 0.5,\n      this.isUndo\n    );\n\n    this.pts[0].addEdge(this as AGeometryBase);\n    this.pts[1].addEdge(this as AGeometryBase);\n    this.pts[2].addEdge(this as AGeometryBase);\n    this.pts[3].addEdge(this as AGeometryBase);\n    this.pts[0].type = GType.ANODE_CIRCLE;\n    this.pts[1].type = GType.ANODE_CIRCLE;\n    this.pts[2].type = GType.ANODE_CIRCLE;\n    this.pts[3].type = GType.ANODE_CIRCLE;\n\n    this.vecsCP = [];\n    this.vecsCP.push(new NVector3(this.pts[3].vec.x, this.pts[0].vec.y, 0));\n    this.vecsCP.push(new NVector3(this.pts[1].vec.x, this.pts[0].vec.y, 0));\n    this.vecsCP.push(new NVector3(this.pts[1].vec.x, this.pts[2].vec.y, 0));\n    this.vecsCP.push(new NVector3(this.pts[3].vec.x, this.pts[2].vec.y, 0));\n    // this.colorCircle = colorCircle;\n    // this.colorBorder = colorBorder;\n    // this.parent = this;\n    // this.x0 = 0;\n    // this.y0 = 0;\n\n    // this.style = JSON.parse(JSON.stringify(MercatorDrawingTheme.circle));\n\n    this.initCircle();\n  }\n  private initComponent() {\n    this.styleComponent = new StyleComponent(this);\n    this.renderer = new RendererComponent(this);\n    this.interaction = new InteractionComponent(this);\n    this.transformation = new TransformationComponent(this);\n  }\n  Init() {\n    /* */\n  }\n  initCircle() {\n    this.dimension = new Dimension(this);\n    this.type = GType.CIRCLE;\n    // this.scene.AddACircle(this);\n    this.isRemove = false;\n    this.isHoverValue = false;\n    this.isFill = true;\n    this.isSelectable = true;\n    this.isRenderable = true;\n    this.isDraggable = false;\n    this.isSelectedValue = false;\n    this.isAniEasing = false;\n    this.isUnderConstruction = true;\n  }\n  getArea() {\n    return Math.PI * this.heightHalf * this.widthHalf;\n  }\n  getLog(): string {\n    return this.interaction.getLog();\n  }\n  getLogDOM() {\n    const text =\n      'Geometry ID : ' +\n      this.id +\n      '<br>' +\n      'geometry Type : ACircle' +\n      '<br>' +\n      // 'parent : ' + this.parent.GetParentType() + '<br>' +\n      'position : ' +\n      // this.vec.ToString() +\n      '<br>' +\n      'size : ' +\n      this.r +\n      ' pixel<br>';\n    // 'color :' + this.style.fillStyle + '<br>';\n    return text;\n  }\n  getParentType() {\n    // if (this.hasBoth) return 'CArrow(double),ID:' + this.id\n    // else return 'CArrow(single),ID:' + this.id\n    return '';\n  }\n  getType() {\n    return 'ACircle';\n  }\n  getVecs() {\n    const vs: NVector3[] = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      vs.push(this.pts[i].vec);\n    }\n    this.vecs = vs;\n    return vs;\n  }\n  public set visibility(v: number) {\n    this.visibilityValue = v;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].visibilityValue = v;\n    }\n  }\n  public set IsHiddenChildren(v: boolean) {\n    this.isHiddenPre = this.isHiddenValue;\n    this.isHiddenValue = v;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].isHiddenValue = v;\n    }\n  }\n  public set isHidden(v: boolean) {\n    this.isHiddenPre = this.isHiddenValue;\n    this.isHiddenValue = v;\n    this.IsHiddenChildren = v;\n\n    this.scene.annotationInstance.io.eventListenerAnnotation.hideStack(this.toJSON());\n  }\n  // ................................................................ update control point\n  public updateCP(r0: number = this.widthHalf, r1: number = this.heightHalf) {\n    this.widthHalf = r0;\n    this.heightHalf = r1;\n    this.pts[0].vec.x = this.vec.x + this.widthHalf;\n    this.pts[0].vec.y = this.vec.y;\n    // this.pts[0].UpdateGoeVec();\n    this.pts[2].vec.x = this.vec.x - this.widthHalf;\n    this.pts[2].vec.y = this.vec.y;\n    // this.pts[2].UpdateGoeVec();\n    this.pts[1].vec.x = this.vec.x;\n    this.pts[1].vec.y = this.vec.y - this.heightHalf;\n    // this.pts[1].UpdateGoeVec();\n    this.pts[3].vec.x = this.vec.x;\n    this.pts[3].vec.y = this.vec.y + this.heightHalf;\n    // this.pts[3].UpdateGoeVec();\n  }\n  public getCenterVec() {\n    this.vec = new NVector3(0, 0, 0);\n    this.vec = plus(this.vec, this.pts[0].vec);\n    this.vec = plus(this.vec, this.pts[1].vec);\n    this.vec = plus(this.vec, this.pts[2].vec);\n    this.vec = plus(this.vec, this.pts[3].vec);\n    this.vec.divByVal(4);\n    this.widthHalf = Math.abs(this.pts[0].vec.x - this.vec.x);\n    this.heightHalf = Math.abs(this.pts[1].vec.y - this.vec.y);\n    return this.vec;\n  }\n  public goToBlackhole() {\n    this.isSelectable = false;\n    this.needBlackhole = true;\n    this.pts.forEach((p) => {\n      p.goToBlackhole();\n    });\n  }\n  public getNodePopup(): APoint | undefined {\n    return this.pts[0];\n  }\n  public set R(r: number) {\n    this.widthHalf = r;\n    this.heightHalf = r;\n    // this.rOrigin = r;\n    // this.rTaget = r + 10;\n  }\n  public set R0(r: number) {\n    this.widthHalf = r;\n    this.pts[0].vec.x = this.vec.x + this.widthHalf;\n    this.pts[0].vec.y = this.vec.y;\n    this.pts[2].vec.x = this.vec.x - this.widthHalf;\n    this.pts[2].vec.y = this.vec.y;\n  }\n  public set R1(r: number) {\n    this.heightHalf = r;\n    this.pts[1].vec.x = this.vec.x;\n    this.pts[1].vec.y = this.vec.y - this.heightHalf;\n    this.pts[3].vec.x = this.vec.x;\n    this.pts[3].vec.y = this.vec.y + this.heightHalf;\n  }\n  public set IsSelectable(b: boolean) {\n    this.isSelectable = b;\n    this.pts[0].isSelectable = b;\n    this.pts[1].isSelectable = b;\n    this.pts[2].isSelectable = b;\n    this.pts[3].isSelectable = b;\n  }\n  public isMouseInside(x: number, y: number) {\n    return this.interaction.isMouseInside(x, y);\n  }\n  public distance(x: number, y: number) {\n    return Math.sqrt((this.vec.x - x) * (this.vec.x - x) + (this.vec.y - y) * (this.vec.y - y));\n  }\n  public geoToScreen() {\n    /* */\n  }\n  public activateEasing(e: MouseEventData, ac: ActiveCommandController) {\n    // ac.capture = null;\n    this.tVec = new NVector3(e.x, e.y, 0);\n    this.isAniEasing = true;\n    this.updateCP();\n  }\n  public easing() {\n    if (this.isAniEasing) {\n      this.vec = plus(scale(this.vec, 0.95), scale(this.tVec, 0.05));\n      if (getDistance(this.vec, this.tVec) < 1) {\n        this.isAniEasing = false;\n      }\n    }\n    this.updateCP();\n  }\n  public remove(needEmit = true) {\n    this.isRemove = false;\n    this.isRenderable = false;\n    this.pts[0].remove();\n    this.pts[1].remove();\n    this.pts[2].remove();\n    this.pts[3].remove();\n    // ACircle.Remove(this);\n    if (needEmit) {\n      const ioGeo = this.toJSON();\n      if (ioGeo) {\n        this.scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack([ioGeo]);\n      }\n    }\n    // AGeometryCommon.Remove(this as AGeometryBase);\n    // this.scene.RemoveACircle(this);\n    this.scene.removeGeometry(this);\n  }\n  public hide() {\n    /* */\n  }\n  public move(x: number, y: number) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    this.vec.x = x;\n    this.vec.y = y;\n    this.updateCP();\n  }\n  public translateByMouseEventData(e: MouseEventData) {\n    return this.transformation.translateByMouseEventData(e);\n  }\n  public translate(x: number, y: number) {\n    //\n  }\n  // .......................................................................... implementation\n  public get isSelected() {\n    return this.isSelectedValue;\n  }\n  public set isSelected(v: boolean) {\n    this.isSelectedValue = v;\n    this.pts[0].isRenderable = v;\n    this.pts[1].isRenderable = v;\n    this.pts[2].isRenderable = v;\n    this.pts[3].isRenderable = v;\n    // for (let i = 0; i < this.pts.length; ++i) { this.pts[i].isHidden = v; this.pts[i].Visibility = 0; }\n    this.scene.annotationInstance.io.eventListenerAnnotation.selectionStack(this.toJSON());\n  }\n  public get isHover() {\n    return this.isHoverValue;\n  }\n  public set isHover(v: boolean) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    if (this.isUnderConstruction) {\n      return;\n    }\n    this.isHoverValue = v;\n\n    if (this.isHoverValue && !this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    } else if (!this.isHoverValue && this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    }\n    this.isHoverPre = this.isHoverValue;\n    if (!this.isSelectedValue) {\n      this.pts[0].isRenderable = v;\n      this.pts[1].isRenderable = v;\n      this.pts[2].isRenderable = v;\n      this.pts[3].isRenderable = v;\n    }\n    if (!v) {\n      this.needEmitHoverPost = true;\n      this.hidePopUpSummary();\n    }\n  }\n  public getNode() {\n    const v: NVector3[] = [];\n    v.push(this.vec);\n    v.push(this.pts[0].vec);\n    v.push(this.pts[1].vec); \n    v.push(this.pts[2].vec);\n    v.push(this.pts[3].vec);\n    return v;\n  }\n  public toJSON(): IOGeometry | undefined {\n    const p = new IOGeometry(\n      this.id,\n      this.type,\n      this.isSelectedValue,\n      this.isHoverValue,\n      this.isHiddenValue\n    );\n    p.pushNode(this.getNode());\n\n    const styles = this.styleComponent.toJson();\n    if (styles) {\n      p.styles = styles;\n    }\n\n    return p;\n  }\n  public deepCopy(x: number, y: number, z = 0) {\n    const g = this.toJSON();\n    if (g) {\n      const ng = ACircle.fromJSON(this.scene, g, true, true);\n      ng.move(x, y);\n      ng.emitAddStack();\n      return ng;\n    }\n    return undefined;\n  }\n  public mouseRightClick() {\n    this.isFill = !this.isFill;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.renderer.renderPost(ctx);\n  }\n}\n","import { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { ANGonWrapper } from '..';\nexport class StyleComponent extends _StyleComponent {\n  public geo: ANGonWrapper;\n  constructor(geo: ANGonWrapper) {\n    super(geo);\n  }\n  public updateStyle() {\n    RenderStyle.updateRenderStylePolygon(\n      this.renderStyle,\n      this.geo.scene.annotationInstance.customization.themeCurrent\n    );\n    RenderStyle.updateRenderStylePolygonNode(\n      this.renderStyleNode,\n      this.geo.scene.annotationInstance.customization.themeCurrent\n    );\n    if (this.geo.pts) {\n      for (let i = 0; i < this.geo.pts.length; ++i) {\n        this.geo.pts[i].styleComponent.updateStyleForNode(this.renderStyleNode);\n      }\n    }\n  }\n}\n","import { IOGeometry } from '../../../../../../lib/Extended/GeometryUtility';\nimport {\n  deepCopy,\n  distanceMouseWithTwoVecs,\n  getAngleByTwoVectors,\n  getCenterVecFromVecs,\n  isInsideOfVecs,\n  NVector3,\n  sub,\n  GType,\n  MouseEventData,\n} from '../../../../../../lib';\nimport { Scene } from '../../../../Scene';\nimport { AGeometryBase } from '../../../Common/Base/AGeometryBase';\nimport { APolygonWrapper } from '../APolygonWrapper/APolygonWrapper';\nimport { APoint } from '../../FamilyPoint/Base/APoint';\nimport { StyleComponent } from './Component/StyleComponent';\n\nexport class ANGonWrapper extends AGeometryBase {\n  public static list: ANGonWrapper[] = [];\n  public static isDone = false;\n  public static numClick = 0;\n  public static split = false;\n  public static nNumber = 5;\n  public static construction: ANGonWrapper | undefined;\n  public vecs: NVector3[];\n  public pts: APoint[];\n  public n: number;\n  public r1: number;\n  public r2: number;\n  public lineWidth: number;\n  public numClick: number;\n  public static findAtPoint(e: MouseEventData) {\n    for (let i = ANGonWrapper.list.length - 1; i >= 0; --i) {\n      if (ANGonWrapper.list[i].isSelectable && ANGonWrapper.list[i].isMouseInside(e.x, e.y)) {\n        return ANGonWrapper.list[i];\n      }\n    }\n    return undefined;\n  }\n  public static computeOver(e: MouseEventData) {\n    const cl = ANGonWrapper.findAtPoint(e);\n    if (cl !== undefined) {\n      cl.isHoverValue = true;\n    }\n  }\n  // ............................................................... construction\n  public static fromJSON(\n    scene: Scene,\n    g: IOGeometry,\n    isUndo = false,\n    isDeepCopy = false,\n    isStart = false\n  ) {\n    const p = APoint.getNodeFromJSON(scene, g.nodes[0]);\n    const geo = new ANGonWrapper(scene, p.vec.x, p.vec.y);\n    geo.type = GType[g.type];\n    p.remove();\n\n    for (let i = 1; i < geo.pts.length; ++i) {\n      const v = APoint.getNodeFromJSON(scene, g.nodes[i]);\n      geo.pts[i].vec.x = v.vec.x;\n      geo.pts[i].vec.y = v.vec.y;\n      geo.pts[i].type = GType.CNODE;\n      // v.Remove();\n    }\n\n    // geo.style = g.style;\n    geo.id = g.id;\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n\n    scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n    ANGonWrapper.construction = undefined;\n  }\n  public static getLine(scene: Scene, e: MouseEventData, type: GType) {\n    if (ANGonWrapper.construction !== undefined) {\n      if (ANGonWrapper.construction.type === GType.CN_GON) {\n        ANGonWrapper.construction.IsSelectable = true;\n        ANGonWrapper.construction.isUnderConstruction = false;\n        APolygonWrapper.aPolygonFromNGon(scene, ANGonWrapper.construction);\n        ANGonWrapper.construction.remove();\n        scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n          ANGonWrapper.construction.toJSON()\n        );\n        ANGonWrapper.construction = undefined;\n      } else if (ANGonWrapper.construction.type === GType.CN_STAR) {\n        ANGonWrapper.construction.numClick++;\n        if (ANGonWrapper.construction.numClick === 2) {\n          ANGonWrapper.construction.IsSelectable = true;\n          ANGonWrapper.construction.isUnderConstruction = false;\n          scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n            ANGonWrapper.construction.toJSON()\n          );\n          APolygonWrapper.aPolygonFromNGon(scene, ANGonWrapper.construction);\n          ANGonWrapper.construction.remove();\n          ANGonWrapper.construction = undefined;\n        }\n      }\n    } else {\n      ANGonWrapper.construction = new ANGonWrapper(scene, e.x, e.y, 0, type);\n      ANGonWrapper.construction.shiftNGon();\n      ANGonWrapper.construction.isUnderConstruction = true;\n      ANGonWrapper.construction.IsSelectable = false;\n    }\n  }\n  public static getLineByPt(p: APoint) {\n    /* */\n  }\n  public static cancel() {\n    if (ANGonWrapper.construction !== undefined) {\n      ANGonWrapper.construction.IsSelectable = true;\n      ANGonWrapper.construction.isUnderConstruction = false;\n      ANGonWrapper.construction.remove();\n      ANGonWrapper.construction = undefined;\n    }\n  }\n  public static drawShadow(e: MouseEventData) {\n    if (ANGonWrapper.construction !== undefined) {\n      ANGonWrapper.construction.updateGeo(e.x, e.y);\n    }\n  }\n  // ................................... end implementation\n  public static add(g: ANGonWrapper) {\n    ANGonWrapper.list.push(g);\n  }\n  public static remove(scene: Scene, g: ANGonWrapper) {\n    const geo = g.toJSON();\n    if (geo) {\n      scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack([geo]);\n      ANGonWrapper.list.splice(ANGonWrapper.list.indexOf(g), 1);\n    }\n  }\n  // .................................................................... end implementation\n  public static mouseDown(scene: Scene, e: MouseEventData, type: GType) {\n    if (ANGonWrapper.construction !== undefined) {\n      if (type === GType.CN_GON) {\n        ANGonWrapper.getLine(scene, e, type);\n        ANGonWrapper.construction = undefined;\n        ANGonWrapper.isDone = true;\n        scene.annotationInstance.activeCommandController.goToACMode();\n      } else if (type === GType.CN_STAR) {\n        ANGonWrapper.getLine(scene, e, type);\n        if (ANGonWrapper.numClick++ > 0) {\n          ANGonWrapper.construction = undefined;\n          ANGonWrapper.isDone = true;\n          ANGonWrapper.numClick = 0;\n          scene.annotationInstance.activeCommandController.goToACMode();\n        }\n      }\n    }\n  }\n  public static mouseLeftClick(scene: Scene, e: MouseEventData, type: GType) {\n    if (ANGonWrapper.isDone) {\n      ANGonWrapper.isDone = false;\n      return;\n    }\n    if (scene.annotationInstance.scene.capture !== undefined) {\n      return;\n    }\n    if (ANGonWrapper.construction === undefined) {\n      ANGonWrapper.getLine(scene, e, type);\n    }\n  }\n  public static mouseMove(e: MouseEventData) {\n    if (ANGonWrapper.construction !== undefined) {\n      ANGonWrapper.drawShadow(e);\n    }\n  }\n\n  constructor(\n    scene: Scene,\n    x: number,\n    y: number,\n    style = 0,\n    type: GType = GType.CN_GON,\n    nNumber: number = ANGonWrapper.nNumber\n  ) {\n    super(scene);\n    this.pts = [];\n    this.vec = new NVector3(x, y);\n    this.type = type;\n    this.n = nNumber;\n    this.initComponent();\n    this.init();\n  }\n  private initComponent() {\n    this.styleComponent = new StyleComponent(this);\n  }\n  public init() {\n    this.r1 = 10;\n    this.lineWidth = 8;\n    // this.style = 0;\n    this.numClick = 0;\n    this.vecs = [];\n    ANGonWrapper.add(this);\n  }\n  public updateVecs() {\n    this.vecs = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.vecs.push(this.pts[i].vec);\n    }\n    return this.vecs;\n  }\n  public getLog(): string {\n    // this.UpdateGoeVec();\n    let theN = 0;\n    if (this.type === GType.CN_GON) {\n      theN = this.n;\n    } else if (this.type === GType.CN_STAR) {\n      theN = Math.trunc(this.n * 0.5);\n    }\n    const text =\n      'GUID : ' +\n      this.id +\n      '/' +\n      'TYPE : ' +\n      this.type.toString() +\n      '/' +\n      // 'PARENT : ' + this.edges[0].GetParentType()+\"<br>\"+\n      // 'Geo : ' + 'lat:' + this.geoVec.x.toFixed(5).toString() + ', Log:' + this.geoVec.y.toFixed(5).toString() + '/' +\n      'N num : ' +\n      theN +\n      '/' +\n      'Screen : ' +\n      // this.vec.ToString() +\n      '/' +\n      // 'R1 : ' + this.r0.toFixed(3).toString() + ' pixel' + '/' +\n      // 'R2 : ' + this.r1.toFixed(3).toString() + ' pixel' + '/' +\n      // 'Area : ' + this.GetArea().toFixed(3).toString() + ' m2' + '/' +\n      // 'STYLE : ' + this.style.toString() + '/' +\n      // 'CONNE :' + this.edges.length.toString() + '/' +\n      'IsSEL : ' +\n      this.isSelectedValue +\n      '/' +\n      'isSelable : ' +\n      this.isSelectable;\n    return text;\n  }\n  public translate(x: number, y: number): void {\n    // throw new Error(\"Method not implemented.\");\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    const xo = e.x - e.preX;\n    const yo = e.y - e.preY;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].vec.x += xo;\n      this.pts[i].vec.y += yo;\n      // this.pts[i].UpdateGoeVec();\n    }\n    // this.UpdateGoeVec();\n  }\n  public remove(): void {\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].remove();\n    }\n    this.isSelectable = false;\n    this.isRenderable = false;\n    ANGonWrapper.remove(this.scene, this);\n    // CGeometry.Remove(this);\n  }\n  public hide(): void {\n    // throw new Error(\"Method not implemented.\");\n  }\n  public set Scale(v: number) {\n    this.updateNGonByScale(v);\n  }\n  public get v(): NVector3 {\n    return this.vec;\n  }\n  public set v(v: NVector3) {\n    this.vec = v;\n  }\n  public get R() {\n    return this.r;\n  }\n  public set R(v: number) {\n    this.r = v;\n  }\n  public set IsSelectable(v: boolean) {\n    this.isSelectable = v;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].isSelectable = v;\n    }\n  }\n  public get IsSelectable() {\n    return this.isSelectable;\n  }\n  public isMouseInside(x: number, y: number): boolean {\n    if (this.isUnderConstruction === true || this.isUnderConstruction === undefined) {\n      return false;\n    }\n    if (this.checkDistance(x, y)) {\n      this.isHover = true;\n      return true;\n    }\n    this.isHover = false;\n    return false;\n  }\n  public checkDistance(x: number, y: number) {\n    if (isInsideOfVecs(new NVector3(x, y), this.getVecs())) {\n      return true;\n    }\n    for (let i = 0; i < this.pts.length - 1; ++i) {\n      if (\n        distanceMouseWithTwoVecs(new NVector3(x, y), this.pts[i].vec, this.pts[i + 1].vec) <\n        this.lineWidth\n      ) {\n        return true;\n      }\n    }\n    return false;\n  }\n  public getVecs() {\n    const v: NVector3[] = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      v.push(this.pts[i].vec);\n    }\n    return v;\n  }\n  public computeCenterVec() {\n    const vs: NVector3[] = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      vs.push(this.pts[i].vec);\n    }\n    this.vec = getCenterVecFromVecs(vs);\n  }\n  public distance(x: number, y: number) {\n    return Math.sqrt((this.vec.x - x) * (this.vec.x - x) + (this.vec.y - y) * (this.vec.y - y));\n  }\n  // public deepCopy(x: number, y: number, z = 0) {\n  //   return undefined;\n  // }\n  // ................................................................. update geo while drawing\n  public updateNGonByScale(s: number) {\n    this.updateNGon(this.vec.x + s, this.vec.y);\n  }\n  public updateNGon(x: number, y: number) {\n    this.r1 = this.distance(x, y);\n    const mouVec = new NVector3(this.vec.x - x, this.vec.y - y).normalize();\n    const cVec = deepCopy(this.vec).normalize();\n    let angle = getAngleByTwoVectors(cVec, mouVec) * (Math.PI / 180.0);\n    const dir = sub(mouVec, cVec);\n    if (dir.x < 0.0) {\n      angle *= -1;\n    }\n    const angleIncrement = (Math.PI * 2) / this.n;\n    let i = this.n;\n    while (i--) {\n      const xx = this.vec.x + this.r1 * Math.cos(angle);\n      const yy = this.vec.y + this.r1 * Math.sin(angle);\n      angle += angleIncrement;\n      this.pts[i].vec.x = xx;\n      this.pts[i].vec.y = yy;\n    }\n    return;\n  }\n  public updateNStar(x: number, y: number) {\n    if (this.numClick === 0) {\n      this.r1 = this.distance(x, y);\n    } else if (this.numClick === 1) {\n      this.r2 = this.distance(x, y);\n    }\n    const mouVec = new NVector3(this.vec.x - x, this.vec.y - y).normalize();\n    const cVec = deepCopy(this.vec).normalize();\n    let angle = getAngleByTwoVectors(cVec, mouVec) * (Math.PI / 180.0);\n    const dir = sub(mouVec, cVec);\n    if (dir.x < 0.0) {\n      angle *= -1;\n    }\n    const angleIncrement = (Math.PI * 2) / this.n;\n    let i = this.n;\n    while (i--) {\n      if (this.numClick === 0) {\n        let xx: number;\n        let yy: number;\n        if (i % 2 === 0) {\n          xx = this.vec.x + this.r1 * Math.cos(angle);\n          yy = this.vec.y + this.r1 * Math.sin(angle);\n        } else {\n          xx = this.vec.x + (this.r1 - 5) * Math.cos(angle);\n          yy = this.vec.y + (this.r1 - 5) * Math.sin(angle);\n        }\n        angle += angleIncrement;\n        this.pts[i].vec.x = xx;\n        this.pts[i].vec.y = yy;\n      } else {\n        let xx: number;\n        let yy: number;\n        if (i % 2 === 0) {\n          xx = this.vec.x + this.r1 * Math.cos(angle);\n          yy = this.vec.y + this.r1 * Math.sin(angle);\n        } else {\n          xx = this.vec.x + this.r2 * Math.cos(angle);\n          yy = this.vec.y + this.r2 * Math.sin(angle);\n        }\n        angle += angleIncrement;\n        this.pts[i].vec.x = xx;\n        this.pts[i].vec.y = yy;\n      }\n    }\n    return;\n  }\n  public updateGeo(x: number, y: number) {\n    if (this.type === GType.CN_GON) {\n      this.updateNGon(x, y);\n    } else if (this.type === GType.CN_STAR) {\n      this.updateNStar(x, y);\n    }\n  }\n  // ................................................................. init geo\n  public computeNGon(nSides: number = this.n) {\n    if (this.pts.length > 0) {\n      let l = this.pts.length;\n      while (l--) {\n        this.pts[l].remove();\n      }\n      this.pts = [];\n    }\n\n    if (this.type === GType.CN_STAR) {\n      this.n = nSides * 2;\n    }\n    let angle = 0.0;\n    const angleIncrement = (Math.PI * 2) / this.n;\n    let i = this.n;\n    while (i--) {\n      const x = this.vec.x + this.r1 * Math.cos(angle);\n      const y = this.vec.y + this.r1 * Math.sin(angle);\n      angle += angleIncrement;\n      const p = new APoint(this.scene, x, y);\n      p.addEdge(this);\n      p.type = GType.CNODE;\n      p.isSelectable = false;\n      this.pts.push(p);\n    }\n  }\n  public shiftNGon() {\n    if (!this.isUnderConstruction) {\n      this.computeCenterVec();\n    }\n    this.computeNGon();\n    // this.UpdateVecs();\n  }\n  // .......................................................................... implementation\n  public get isSelected() {\n    return this.isSelectedValue;\n  }\n  public set isSelected(v: boolean) {\n    this.isSelectedValue = v;\n    this.scene.annotationInstance.io.eventListenerAnnotation.selectionStack(this.toJSON());\n  }\n  public get isHover() {\n    return this.isHoverValue;\n  }\n  public set isHover(v: boolean) {\n    if (this.isUnderConstruction) {\n      return;\n    }\n\n    this.isHoverValue = v;\n    if (this.isUnderConstruction) {\n      return;\n    }\n    for (const p of this.pts) {\n      p.isRenderable = v;\n    }\n\n    if (this.isHoverValue && !this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    } else if (!this.isHoverValue && this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    }\n    this.isHoverPre = this.isHoverValue;\n  }\n  public getNode() {\n    const v: NVector3[] = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      v.push(this.pts[i].vec);\n    }\n    return v;\n  }\n  public toJSON(): IOGeometry | undefined {\n    const p = new IOGeometry(\n      this.id,\n      this.type,\n      this.isSelectedValue,\n      this.isHoverValue,\n      this.isHiddenValue\n    );\n    p.pushNode(this.getNode());\n    return p;\n  }\n  // ...................................................................\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    if (this.pts.length < 3) {\n      return;\n    }\n\n    const vs = [];\n    for (let i = 0 ; i < this.pts.length; ++i) {\n      vs.push(new NVector3(this.pts[i].vec.x - this.scene.annotationInstance.scene.paramsEditing.croppingMaskParams.x,this.pts[i].vec.y - this.scene.annotationInstance.scene.paramsEditing.croppingMaskParams.y))\n    }\n\n    if (this.type === GType.CN_GON) {\n      this.scene.annotationInstance.renderer.draw.shape.ngon.nGon(\n        ctx,\n        vs,\n        this.isHoverValue,\n        this.isSelectedValue\n      );\n    } else if (this.type === GType.CN_STAR) {\n      this.scene.annotationInstance.renderer.draw.shape.ngon.nStar(\n        ctx,\n        this.pts,\n        this.isHoverValue,\n        this.isSelectedValue\n      );\n    }\n  }\n}\n// reference : https://stackoverflow.com/questions/7198144/how-to-draw-a-n-sided-regular-polygon-in-cartesian-coordinates\n// http://jsfiddle.net/BSnTV/\n","import {\n  getCenterVecFromVecs,\n  getDistance,\n  midVec,\n  NVector3,\n} from '../../../../../../../lib';\nimport { APolygonGraphWrapper } from '..';\nexport class GraphCore {\n  public host: APolygonGraphWrapper;\n  public selVec: NVector3 | undefined = undefined;\n  public selMidVec: NVector3 | undefined = undefined;\n  public selectedVec: NVector3 | undefined = undefined;\n  public selVecForTextLeaderline: NVector3 | undefined = undefined;\n  public vs: NVector3[] = [];\n  public cVec: NVector3;\n  private mouseV: NVector3 = new NVector3(0, 0, 0);\n  private mouseR = 10;\n  protected index = -1;\n  constructor(host: APolygonGraphWrapper) {\n    this.host = host;\n    this.index = -1;\n  }\n  public initByVec(vs: NVector3[]) {\n    this.vs = vs;\n    // console.log(vs);\n  }\n  public getVecs() {\n    return this.vs;\n  }\n  public removeSelVec() {\n    this.selVec = undefined;\n    this.selMidVec = undefined;\n    this.selectedVec = undefined;\n    if (this.vs.length < 4) {\n      this.host.remove();\n      return;\n    }\n\n    this.vs.splice(this.vs.indexOf(this.vs[this.index]), 1);\n\n    // this.vs.splice(this.index, 0, mv);\n  }\n  public getCenVec() {\n    this.cVec = getCenterVecFromVecs(this.vs);\n    // const v = this.host.scene.annotationInstance.geometryCommon.gcmdSupporting.toMap(\n    //   this.cVec.x,\n    //   this.cVec.y\n    // );\n    return this.cVec;\n  }\n  public getclosestVec(mv: NVector3, tor: number) {\n    let theIndex = -1;\n    let distance = Number.MAX_SAFE_INTEGER;\n    for (let i = 0; i < this.vs.length; ++i) {\n      const thedis = getDistance(mv, this.vs[i]);\n      if (thedis < tor && thedis < distance) {\n        distance = thedis;\n        theIndex = i;\n      }\n    }\n\n    if (theIndex > -1) {\n      this.selVec = this.vs[theIndex];\n      this.selVecForTextLeaderline = this.vs[theIndex];\n      return this.vs[theIndex];\n    }\n    // for (let i = 0; i < this.vs.length; ++i ) {\n    //     let midV: NVector3 | undefined = undefined;\n    //     if (i < this.vs.length - 1) {\n    //         midV = MidVec(this.vs[i], this.vs[i + 1]);\n    //     } else {\n    //         midV = MidVec(this.vs[i], this.vs[0]);\n    //     }\n    //     if (midV !== undefined) {\n    //         const dis =  Distance(mv, midV);\n    //         console.log(dis);\n    //         if (dis < tor ) {\n    //             this.selVec = midV;\n    //             this.selVecForTextLeaderline = midV;\n    //             return midV;\n    //         }\n    //     }\n    // }\n    this.selVec = undefined;\n    this.selVecForTextLeaderline = undefined;\n    return undefined;\n  }\n  // public GetclosestVecIncludeMidVec(mv: NVector3, tor: number) {\n  //     for (let i = 0; i < this.vs.length; ++i ) {\n  //         if ( Distance(mv, this.vs[i]) < tor ) {\n  //             this.selVec = this.vs[i];\n  //             this.selVecForTextLeaderline = this.vs[i];\n  //             return this.vs[i];\n  //         }\n  //     }\n  //     for (let i = 0; i < this.vs.length - 1; ++i ) {\n  //         const midV = MidVec(this.vs[i], this.vs[i + 1]);\n  //         if ( Distance(mv, midV) < tor ) {\n  //             this.selVec = midV;\n  //             this.selVecForTextLeaderline = midV;\n  //             return midV;\n  //         }\n  //     }\n  //     this.selVec = undefined;\n  //     this.selVecForTextLeaderline = undefined;\n  //     return undefined;\n  // }\n  public isMouseInside(x: number, y: number): number {\n    this.mouseV.x = x;\n    this.mouseV.y = y;\n\n    // // ....................... for the ghost duplicated shape\n    // if (this.host.wrapping.isIntersectLeft || this.host.wrapping.isIntersectRight) {\n    //   for (let i = 0; i < this.host.wrapping.vsOther.length - 1; ++i) {\n    //     if (Distance(this.mouseV, this.host.wrapping.vsOther[i]) < this.mouseR * this.host.scaleForRender) {\n    //       this.selVec = this.vs[i];\n    //       this.selMidVec = undefined;\n    //       this.index = i;\n    //       return i;\n    //     }\n    //     let mx = this.host.wrapping.vsOther[i].x + (this.host.wrapping.vsOther[i + 1].x - this.host.wrapping.vsOther[i].x) * 0.5;\n    //     let my = this.host.wrapping.vsOther[i].y + (this.host.wrapping.vsOther[i + 1].y - this.host.wrapping.vsOther[i].y) * 0.5;\n    //     this.selMidVec = new NVector3(mx, my, 0);\n    //     if (Distance(this.mouseV, this.selMidVec) < this.mouseR * this.host.scaleForRender) {\n    //       this.selVec = undefined;\n    //       this.selMidVec.x = this.vs[i].x + (this.vs[i + 1].x - this.vs[i].x) * 0.5;\n    //       this.selMidVec.y = this.vs[i].y + (this.vs[i + 1].y - this.vs[i].y) * 0.5;\n    //       this.UpdateGeoVec(this.selMidVec);\n    //       this.index = i;\n    //       return i;\n    //     }\n    //     this.selMidVec = undefined;\n    //   }\n    //   if (Distance(this.mouseV, this.host.wrapping.vsOther[this.host.wrapping.vsOther.length - 1] ) < this.mouseR * this.host.scaleForRender) {\n    //     this.selVec = this.vs[this.vs.length - 1];\n    //     this.selMidVec = undefined;\n    //     this.index = this.vs.length - 1;\n    //     return this.vs.length - 1;\n    //   }\n    //   let mx = this.host.wrapping.vsOther[this.host.wrapping.vsOther.length - 1].x + (this.host.wrapping.vsOther[0].x - this.host.wrapping.vsOther[this.host.wrapping.vsOther.length - 1].x) * 0.5;\n    //   let my = this.host.wrapping.vsOther[this.host.wrapping.vsOther.length - 1].y + (this.host.wrapping.vsOther[0].y - this.host.wrapping.vsOther[this.host.wrapping.vsOther.length - 1].y) * 0.5;\n    //   this.selMidVec = new NVector3(mx, my, 0);\n    //   if (Distance(this.mouseV, this.selMidVec) < this.mouseR * this.host.scaleForRender) {\n    //     this.selVec = undefined;\n    //     this.index = this.vs.length - 1;\n    //     this.selMidVec.x = this.vs[this.host.wrapping.vsOther.length - 1].x + (this.vs[0].x - this.vs[this.host.wrapping.vsOther.length - 1].x) * 0.5;\n    //     this.selMidVec.y = this.vs[this.host.wrapping.vsOther.length - 1].y + (this.vs[0].y - this.vs[this.host.wrapping.vsOther.length - 1].y) * 0.5;\n    //     this.UpdateGeoVec(this.selMidVec);\n    //     this.index = this.host.wrapping.vsOther.length - 1;\n    //     return this.host.wrapping.vsOther.length - 1;\n    //   }\n    // }\n    // ....................... end for the ghost duplicated shape\n\n    for (let i = 0; i < this.vs.length - 1; ++i) {\n      if (getDistance(this.mouseV, this.vs[i]) < this.mouseR * this.host.scaleForRender * this.host.scene.annotationInstance.activeCommandController.scaleGlobal) {\n        this.selVec = this.vs[i];\n        this.selMidVec = undefined;\n        this.index = i;\n        return i;\n      }\n\n      const mx = this.vs[i].x + (this.vs[i + 1].x - this.vs[i].x) * 0.5;\n      const my = this.vs[i].y + (this.vs[i + 1].y - this.vs[i].y) * 0.5;\n      this.selMidVec = new NVector3(mx, my, 0);\n      if (getDistance(this.mouseV, this.selMidVec) < this.mouseR * this.host.scaleForRender * this.host.scene.annotationInstance.activeCommandController.scaleGlobal) {\n        this.selVec = undefined;\n        this.index = i;\n        return i;\n      }\n      this.selMidVec = undefined;\n    }\n    if (getDistance(this.mouseV, this.vs[this.vs.length - 1]) < this.mouseR * this.host.scaleForRender * this.host.scene.annotationInstance.activeCommandController.scaleGlobal) {\n      this.selVec = this.vs[this.vs.length - 1];\n      this.selMidVec = undefined;\n      this.index = this.vs.length - 1;\n      return this.vs.length - 1;\n    }\n    const mx = this.vs[this.vs.length - 1].x + (this.vs[0].x - this.vs[this.vs.length - 1].x) * 0.5;\n    const my = this.vs[this.vs.length - 1].y + (this.vs[0].y - this.vs[this.vs.length - 1].y) * 0.5;\n    this.selMidVec = new NVector3(mx, my, 0);\n    if (getDistance(this.mouseV, this.selMidVec) < this.mouseR * this.host.scaleForRender * this.host.scene.annotationInstance.activeCommandController.scaleGlobal) {\n      this.selVec = undefined;\n      this.index = this.vs.length - 1;\n      return this.vs.length - 1;\n    }\n\n    this.selVec = undefined;\n    this.selMidVec = undefined;\n    this.index = -1;\n    return -1;\n  }\n  public insertMidVec() {\n    if (this.selMidVec) {\n      this.vs.splice(this.index + 1, 0, this.selMidVec);\n      this.selVec = this.selMidVec;\n      this.selMidVec = undefined;\n    }\n  }\n  public splitNodeVec() {\n    const theIndex = this.vs[this.index];\n    let targetIndexA = this.vs[this.index + 1];\n    let targetIndexB = this.vs[this.index - 1];\n    if (this.index > 0 && this.index < this.vs.length - 1) {\n      targetIndexA = this.vs[this.index + 1];\n      targetIndexB = this.vs[this.index - 1];\n    } else if (this.index === this.vs.length - 1) {\n      targetIndexA = this.vs[0];\n      targetIndexB = this.vs[this.index - 1];\n    } else if (this.index === 0) {\n      targetIndexB = this.vs[this.vs.length - 1];\n    }\n\n    let mv = midVec(theIndex, targetIndexA);\n    // let tempProjection = this.host.scene.annotationInstance.geometryCommon.gcmdSupporting.toMap(\n    //   mv.x,\n    //   mv.y\n    // );\n    this.vs.splice(this.index + 1, 0, mv);\n\n    mv = midVec(theIndex, targetIndexB);\n    // tempProjection = this.host.scene.annotationInstance.geometryCommon.gcmdSupporting.toMap(\n    //   mv.x,\n    //   mv.y\n    // );\n    this.vs.splice(this.index, 0, mv);\n  }\n}\n","import { getDistance, getDistanceByNum, NVector3 } from '../../../../../../../lib';\nimport { APolygonGraphWrapper } from '..';\nexport class InteractionComponent {\n  public geo: APolygonGraphWrapper;\n  public xOff = 5;\n  public yOff = 5;\n  private showPopupStackTimer: NodeJS.Timer | number;\n  constructor(geo: APolygonGraphWrapper) {\n    this.geo = geo;\n  }\n  public isMouseInside(x: number, y: number): boolean {\n    if (this.geo.graphCore.isMouseInside(x, y) !== -1) {\n      return true;\n    }\n\n    if (\n      this.geo.scene.annotationInstance.geometryCommon.gcmdProcessing.isMouseInsideByOffScreen(\n        x  - this.geo.scene.paramsEditing.croppingMaskParams.x,\n        y  - this.geo.scene.paramsEditing.croppingMaskParams.y,\n        this.geo.hashColor\n      )\n    ) {\n      return true;\n    }\n    return false;\n  }\n  public GetLog() {\n    if (this.geo.isRemove || !this.geo.isRenderable || this.geo.isHiddenValue) {\n      return '';\n    }\n    const text =\n      'GUID : ' +\n      this.geo.id +\n      '/' +\n      'TYPE : ' +\n      this.geo.type.toString() +\n      '/' +\n      // 'PARENT : ' + this.geo.edges[0].GetParentType()+'<br>'+\n      // 'Geo : ' + 'lat:' + this.geo.geoVec.x.toFixed(5).toString() + ', Log:' + this.geo.geoVec.y.toFixed(5).toString() + '/' +\n      'Screen : ' +\n      // this.geo.vec.ToString() +\n      '/' +\n      'pos : ' +\n      this.geo.graphCore.vs.length +\n      '/' +\n      'Area : ' +\n      this.geo.getArea().toFixed(3).toString() +\n      ' m2' +\n      '/' +\n      // 'STYLE : ' + this.geo.style.toString() + '/' +\n      // 'CONNE :' + this.geo.edges.length.toString() + '/' +\n      'IsSEL : ' +\n      this.geo.isSelectedValue +\n      '/' +\n      'isSelable : ' +\n      this.geo.isSelectable;\n    return text;\n  }\n  public hide(): void {\n    //\n  }\n  public showPopupSummary() {\n    if (!this.geo.scene.annotationInstance.activeCommandController.needPopup()) {\n      return\n    }\n    // console.trace();\n    // console.log('pop');\n    if (this.geo.hasPopup || this.geo.isGhost) {\n      return;\n    }\n    // if (this.geo.isGhost) { return; }\n    this.geo.hasPopup = true;\n\n    this.geo.popup = document.createElement('div') as HTMLDivElement;\n    this.geo.popup.id = 'pa-' + this.geo.id;\n    this.geo.popup.style.position = 'absolute';\n    this.geo.popup.style.zIndex = '1000';\n    this.geo.popup.style.height = '0px';\n    this.geo.popup.style.width = '0px';\n    this.geo.popup.style.backgroundColor = 'red';\n    this.geo.scene.annotationInstance.implementations.app.model.modelViewWrapper.div.appendChild(\n      this.geo.popup\n    );\n    this.geo.popup.style.top = this.geo.vec.y + 'px';\n    this.geo.popup.style.left = this.geo.vec.x + 'px';\n\n    if (this.showPopupStackTimer) {\n      clearTimeout(this.showPopupStackTimer as NodeJS.Timer);\n    }\n    this.showPopupStackTimer = setTimeout(() => {\n      if (this.geo.popup) {\n        this.geo.scene.annotationInstance.io.eventListenerAnnotation.showPopupStack(\n          this.geo.toJSON()\n        );\n      }\n    }, this.geo.timePopupDelay);\n  }\n  public needSnapping(v: NVector3) {\n    let dis = 15;\n    let theDis = dis;\n    let temp: NVector3 = new NVector3(-100, -100);\n\n    for (let i = 0; i < this.geo.graphCore.vs.length - 1; ++i) {\n      theDis = getDistance(this.geo.graphCore.vs[i], v);\n      if (theDis < dis) {\n        dis = theDis;\n        temp = this.geo.graphCore.vs[i];\n      }\n\n      theDis = getDistanceByNum(\n        v.x,\n        v.y,\n        this.geo.graphCore.vs[i + 1].x - this.geo.graphCore.vs[i].x,\n        this.geo.graphCore.vs[i + 1].y - this.geo.graphCore.vs[i].y\n      );\n      if (theDis < dis) {\n        dis = theDis;\n        temp.x = this.geo.graphCore.vs[i + 1].x - this.geo.graphCore.vs[i].x;\n        temp.y = this.geo.graphCore.vs[i + 1].y - this.geo.graphCore.vs[i].y;\n      }\n    }\n    theDis = getDistance(this.geo.graphCore.vs[this.geo.graphCore.vs.length - 1], v);\n    if (theDis < dis) {\n      dis = theDis;\n      temp = this.geo.graphCore.vs[this.geo.graphCore.vs.length - 1];\n    }\n    theDis = getDistanceByNum(\n      v.x,\n      v.y,\n      this.geo.graphCore.vs[this.geo.graphCore.vs.length - 1].x - this.geo.graphCore.vs[0].x,\n      this.geo.graphCore.vs[this.geo.graphCore.vs.length - 1].y - this.geo.graphCore.vs[0].y\n    );\n    if (theDis < dis) {\n      dis = theDis;\n      temp.x =\n        this.geo.graphCore.vs[this.geo.graphCore.vs.length - 1].x - this.geo.graphCore.vs[0].x;\n      temp.y =\n        this.geo.graphCore.vs[this.geo.graphCore.vs.length - 1].y - this.geo.graphCore.vs[0].y;\n    }\n\n    return [dis, temp];\n  }\n}\n","import { GType } from '../../../../../../../lib';\nimport { IOGeometry } from '../../../../../../../lib/Extended/GeometryUtility';\nimport { APolygonGraphWrapper } from '..';\nexport class IOComponent {\n  public geo: APolygonGraphWrapper;\n  constructor(geo: APolygonGraphWrapper) {\n    this.geo = geo;\n  }\n  public ToJSON(): IOGeometry | undefined {\n    const p = new IOGeometry(\n      this.geo.id,\n      GType.POLYGON_GRAPH,\n      this.geo.isSelectedValue,\n      this.geo.isHoverValue,\n      this.geo.isHiddenValue\n    );\n    p.pushNode(this.getNode());\n\n    const styles = this.geo.styleComponent.toJson();\n    if (styles) {\n      p.styles = styles;\n    }\n\n    return p;\n  }\n  private getNode() {\n    const vs = [];\n    for (let i = 0; i < this.geo.graphCore.vs.length; ++i) {\n      vs.push(this.geo.graphCore.vs[i]);\n    }\n    return vs;\n  }\n  public remove(needEmit = true): void {\n    if (needEmit) {\n      const ioGeo = this.ToJSON();\n      if (ioGeo) {\n        this.geo.scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack([ioGeo]);\n      }\n    }\n    this.geo.deepRemove();\n  }\n}\n","import { MouseEventData } from '../../../../../../../lib';\nimport { APolygonGraphWrapper } from '..';\nexport class MouseEventComponent {\n  public geo: APolygonGraphWrapper;\n  constructor(geo: APolygonGraphWrapper) {\n    this.geo = geo;\n  }\n  public mouseLeftClick(): void {\n    // if (this.graphCore.selMidVec) {\n    //   console.log('this.graphCore.selMidVec', this.graphCore.selMidVec );\n    // }\n    if (this.geo.graphCore.selVec) {\n      // console.log('this.graphCore.selVec', this.geo.graphCore.selVec );\n      this.geo.graphCore.selectedVec = this.geo.graphCore.selVec;\n      return;\n    }\n    this.geo.graphCore.selectedVec = undefined;\n\n    // console.log('polygon');\n    this.geo.scene.annotationInstance.geometryCommon.gcmdProcessing.removeAllPopup();\n    this.geo.showPopupSummary();\n    // if (this.isConstraint) {\n    // console.log('left');\n    // }\n    // this.dimension.RenderTotalLengthInput();\n  }\n  public mouseRightClick(): void {\n    //\n  }\n  public mouseMiddleClick(e: MouseEventData): void {\n    //\n  }\n  public mouseMoveClick(e: MouseEventData): void {\n    //\n  }\n}\n","import { InteractionMode, NVector3 } from '../../../../../../../lib';\nimport { RendererComponent as _RendererComponent } from '../../../../Common/Base/ComponentTemplate/RendererComponent';\nimport { APolygonGraphWrapper } from '..';\nexport class RendererComponent extends _RendererComponent {\n  public geo: APolygonGraphWrapper;\n  constructor(geo: APolygonGraphWrapper) {\n    super(geo);\n    this.geo = geo;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.interpolateColor.update();\n    this.timer.update();\n    this.geo.inspector.update(ctx);\n    this.geo.updateCenVec();\n    // if ( this.geo.scene.annotationInstance.activeCommandController.acProperties.isPanning || this.geo.scene.annotationInstance.activeCommandController.acProperties.isZooming) {\n    //   this.geo.wrapping.UpdateProjectionShapes(this.geo.graphCore.GetVecs());\n    //   this.UpdateProjectionDuplication();\n    //   this.geo.UpdateScaleByZoomLevel();\n    // }\n    const vs = []\n    for (let i = 0 ; i < this.geo.graphCore.vs.length; ++i) {\n      vs.push(\n        new NVector3(\n          this.geo.graphCore.vs[i].x - this.geo.scene.paramsEditing.croppingMaskParams.x,\n          this.geo.graphCore.vs[i].y - this.geo.scene.paramsEditing.croppingMaskParams.y\n          )\n      );\n    }\n\n    this.renderPolygon(ctx, vs);\n    // this.RenderPolygonDuplication(ctx);\n  }\n  public renderPostNodes(ctx: CanvasRenderingContext2D) {\n    if (this.geo.scene.annotationInstance.interactionMode !== InteractionMode.Drawing) {\n      return;\n    }\n    if (this.geo.isHoverValue || this.geo.isSelectedValue) {\n      this.renderNodes(\n        ctx, this.geo.graphCore.vs, this.geo.scaleForRender *\n        this.geo.scene.annotationInstance.graphicsCoreWrapper.scaleScreenByRatioImageSize,\n        // this.geo.scene.annotationInstance.activeCommandController.scaleGlobal\n        );\n    }\n    // if (this.geo.wrapping.isIntersectLeft || this.geo.wrapping.isIntersectRight) {\n    //   if (this.geo.wrapping.vsOther[0]) {\n    //     if (this.geo.isHover || this.geo.isSelected) {\n    //       this.RenderNodes(ctx, this.geo.wrapping.vsOther, this.geo.scaleForRender);\n    //     }\n    //   }\n    // }\n\n    // ..............node selected\n    this.renderSelectedVec(ctx);\n  }\n  // private RenderPolygonDuplication(ctx: CanvasRenderingContext2D) {\n  //   if (this.geo.wrapping.isIntersectLeft || this.geo.wrapping.isIntersectRight) {\n  //     // console.log(this.geo.wrapping.vsOther);\n  //     if (this.geo.wrapping.vsOther[0]) {\n  //       this.RenderPolygon(ctx, this.geo.wrapping.vsOther);\n  //     }\n  //   }\n  // }\n  private renderPolygon(ctx: CanvasRenderingContext2D, vs: NVector3[]) {\n    this.offscreenRenderPolygon(vs);\n\n    if (this.geo.isHoverValue || this.geo.isSelectedValue) {\n      this.geo.scene.annotationInstance.renderer.draw.shape.area.polygonHover(\n        ctx,\n        this.geo.styleComponent.renderStyle,\n        vs,\n        this.geo.isGrayColor,\n        this.geo.visibilityValue,\n        this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n        this.geo.isHoverValue,\n        this.geo.isSelectedValue\n      );\n      this.tOver += 0.01;\n      this.tDown1 = 0;\n      this.geo.isLeave = true;\n      this.geo.scene.annotationInstance.renderer.draw.shape.area.polygon(\n        ctx,\n        this.geo.styleComponent.renderStyle,\n        vs,\n        this.geo.isUnderConstruction,\n        this.geo.isGrayColor,\n        this.geo.visibilityValue,\n        this.geo.isFill,\n        this.geo.isHover,\n        this.geo.isSelectedValue\n      );\n    } else {\n      this.tOver = 0;\n      this.geo.scene.annotationInstance.renderer.draw.shape.area.polygon(\n        ctx,\n        this.geo.styleComponent.renderStyle,\n        vs,\n        this.geo.isUnderConstruction,\n        this.geo.isGrayColor,\n        this.geo.visibilityValue,\n        this.geo.isFill,\n        this.geo.isHover,\n        this.geo.isSelectedValue\n      );\n    }\n  }\n  private renderSelectedVec(ctx: CanvasRenderingContext2D) {\n    if (this.geo.graphCore.selectedVec) {\n      // ctx.beginPath();\n      // ctx.arc(this.geo.graphCore.selectedVec.x, this.geo.graphCore.selectedVec.y, 15, 0, Math.PI * 2);\n      // ctx.closePath();\n      // ctx.fill();\n      this.geo.scene.annotationInstance.renderer.draw.shape.node.nodeSelected(\n        ctx,\n        this.geo.styleComponent.renderStyleNodeSelected,\n        this.geo.graphCore.selectedVec.x - this.geo.scene.paramsEditing.croppingMaskParams.x,\n        this.geo.graphCore.selectedVec.y - this.geo.scene.paramsEditing.croppingMaskParams.y,\n        this.geo.scene.annotationInstance.graphicsCoreWrapper.scaleScreenByRatioImageSize,\n        // this.geo.styleComponent.renderStyle.scaleLocal * this.geo.scene.annotationInstance.activeCommandController.scaleGlobal\n      );\n    }\n  }\n  private renderNodes(ctx: CanvasRenderingContext2D, vs: NVector3[], scale: number) {\n    const xOff = this.geo.scene.paramsEditing.croppingMaskParams.x;\n    const yOff = this.geo.scene.paramsEditing.croppingMaskParams.y;\n    for (let i = 0; i < vs.length - 1; ++i) {\n      this.geo.scene.annotationInstance.renderer.draw.shape.node.nodeMidHover(\n        ctx,\n        this.geo.styleComponent.renderStyleNode,\n        vs[i].x + (vs[i + 1].x - vs[i].x) * 0.5 - xOff,\n        vs[i].y + (vs[i + 1].y - vs[i].y) * 0.5 - yOff,\n        scale,\n        this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n        false\n      );\n      this.geo.scene.annotationInstance.renderer.draw.shape.node.nodeStart(\n        ctx,\n        this.geo.styleComponent.renderStyleNode,\n        vs[i].x - xOff,\n        vs[i].y - yOff,\n        scale,\n        this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver)\n      );\n    }\n    this.geo.scene.annotationInstance.renderer.draw.shape.node.nodeMidHover(\n      ctx,\n      this.geo.styleComponent.renderStyleNode,\n      vs[vs.length - 1].x + (vs[0].x - vs[vs.length - 1].x) * 0.5  - xOff,\n      vs[vs.length - 1].y + (vs[0].y - vs[vs.length - 1].y) * 0.5  - yOff,\n      scale,\n      this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n      false\n    );\n    this.geo.scene.annotationInstance.renderer.draw.shape.node.nodeStart(\n      ctx,\n      this.geo.styleComponent.renderStyleNode,\n      vs[vs.length - 1].x - xOff,\n      vs[vs.length - 1].y - yOff,\n      scale,\n      this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver)\n    );\n  }\n  private offscreenRenderPolygon(vs: NVector3[]) {\n    this.geo.scene.annotationInstance.renderer.offscreen.polygonOffScreen(\n      this.geo.scene.annotationInstance.renderer.ctxOffscreen,\n      this.geo.hashColor,\n      vs\n    );\n  }\n}\n","import { ThemeColorId } from '../../../../../Customization/ThemeRenderStyle/Utility';\nimport { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { APolygonGraphWrapper } from '..';\nexport class StyleComponent extends _StyleComponent {\n  public geo: APolygonGraphWrapper;\n  public renderStyleNodeSelected: RenderStyle;\n  constructor(geo: APolygonGraphWrapper) {\n    super(geo);\n    this.renderStyleNodeSelected = new RenderStyle();\n    this.updateStyle();\n    this.updateColor();\n  }\n  public updateStyle() {\n    if (!this.isCustom) {\n      this.state.themeColorId = ThemeColorId.AccentColor1;\n      this.isCustom = true;\n      RenderStyle.updateRenderStylePolygon(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n      RenderStyle.updateRenderStylePolygonNode(\n        this.renderStyleNode,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n      RenderStyle.shiftNodeStyle(this.renderStyleNode, this.renderStyleNodeSelected);\n    }\n  }\n  public updateColor(color: number[] | undefined = undefined) {\n    // console.log(color)\n    this.isCustom = true;\n    if (color === undefined) {\n      color = this.geo.scene.annotationInstance.activeCommandController.activeColorController.activeColor;\n    }\n    RenderStyle.updateRenderColorPolygon(\n      this.renderStyle,\n      this.geo.scene.annotationInstance.customization.themeCurrent,\n      color,\n      color\n      // [0,0,0,0]\n    );\n    RenderStyle.updateRenderColorPolygonNode(\n      this.renderStyleNode,\n      this.geo.scene.annotationInstance.customization.themeCurrent,\n      color,\n      // [0,0,0,0]\n    );\n    RenderStyle.shiftNodeStyle(this.renderStyleNode, this.renderStyleNodeSelected);\n    this.tempColorRgba = color;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public updateStyleCustom(style: any): boolean {\n    // if (this.isSameStyle(style)) {\n    //   return false;\n    // }\n    const needEmit = false;\n\n    if (style.width) {\n      this.state.width = style.width;\n    }\n    if (style.color !== undefined) {\n      this.state.themeColorId = style.color as ThemeColorId;\n    }\n\n    if (style.colorRgba.length > 0 && style.fill.length > 0) {\n      this.tempColorRgba = style.colorRgba;\n      this.tempFillRgba = style.fill;\n      RenderStyle.updateRenderStylePolygonCustom(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent,\n        style.colorRgba,\n        style.fill\n      );\n      RenderStyle.updateRenderStylePolygonNodeCustom(\n        this.renderStyleNode,\n        this.geo.scene.annotationInstance.customization.themeCurrent,\n        style.colorRgba,\n        style.fill\n      );\n      RenderStyle.shiftNodeStyleCustom(this.renderStyleNode, this.renderStyleNodeSelected);\n\n      // console.log(style.colorRgba)\n      this.updateColor(style.colorRgba);\n    }\n    if (style.scale) {\n      this.renderStyle.scaleLocal = style.scale;\n      this.state.scale = style.scale;\n    }\n    this.isCustom = true;\n    if (needEmit && !this.geo.isUnderConstruction) {\n      this.geo.isTransform = true;\n    }\n\n    return true;\n  }\n  public setDash(v: number[]) {\n    this.renderStyle.dash = v;\n    this.geo.scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n      this.geo.toJSON()\n    );\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public toJson(): any | undefined {\n    if (!this.isCustom) {\n      return undefined;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const output: any = {\n      width: this.state.width,\n      scale: this.renderStyle.scaleLocal,\n      // this is necessary for updating state on React side\n      colorRgba: this.tempColorRgba,\n      fill: this.tempFillRgba,\n    };\n\n    // box: {\n    //   dash: this.styleBox.dash,\n    //   fill: this.styleBox.fillStyle,\n    //   width: this.styleBox.lineWidth,\n    //   strokeStyle: this.styleBox.strokeStyle\n    // },\n    // anchorNode: {\n    //   dash: this.styleAnchorNode.dash,\n    //   fill: this.styleAnchorNode.fillStyle,\n    //   width: this.styleAnchorNode.lineWidth,\n    //   strokeStyle: this.styleAnchorNode.strokeStyle\n    // },\n    // handleNode: {\n    //   dash: this.styleHandleNode.dash,\n    //   fill: this.styleHandleNode.fillStyle,\n    //   width: this.styleHandleNode.lineWidth,\n    //   strokeStyle: this.styleHandleNode.strokeStyle\n    // },\n    // leaderline: {\n    //   dash: this.styleLeaderline.dash,\n    //   width: this.styleLeaderline.lineWidth,\n    //   strokeStyle: this.styleLeaderline.strokeStyle,\n    // },\n    // width: this.state.width,\n    // scale: this.state.scale,\n    // colorRgba: this.tempColorRgba,\n    // };\n\n    // if (this.state.backgroundColor !== ThemeColorId.TitleColor) {\n    //   output.backgroundColor = this.state.backgroundColor;\n    // }\n    if (this.state.themeColorId !== ThemeColorId.AccentColor1) {\n      output.color = this.state.themeColorId;\n    }\n\n    // if (this.state.lineTypeId !== LineTypeId.Continuous) {\n    //   output.lineDash = this.state.lineTypeId;\n    // }\n    // console.log(output);\n    return output;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  protected isSameStyle(style: any) {\n    if (\n      style.colorRgba.length === this.tempColorRgba.length ||\n      style.fill.length === this.tempFillRgba\n    ) {\n      for (let i = 0; i < style.colorRgba.length; i++) {\n        if (style.colorRgba[i] !== this.tempColorRgba[i]) {\n          return false;\n        }\n      }\n      for (let i = 0; i < style.fill.length; i++) {\n        if (style.fill[i] !== this.tempFillRgba[i]) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n}\n","import { MouseEventData, NVector3 } from '../../../../../../../lib';\nimport { APolygonGraphWrapper } from '..';\nexport class TransformationComponent {\n  public geo: APolygonGraphWrapper;\n  public v: NVector3;\n  // private _tempProjection: number[] = [];\n  private _needCtrlKey = true;\n  constructor(geo: APolygonGraphWrapper) {\n    this.geo = geo;\n  }\n  public polygonGraphResetForSplit() {\n    this._needCtrlKey = true;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    if (this.geo.isRemove || !this.geo.isRenderable || this.geo.isHiddenValue) {\n      return;\n    }\n    const xo = e.x - e.preX;\n    const yo = e.y - e.preY;\n\n    if (this.geo.graphCore.selVec) {\n      // when node is selected\n\n      if (this.geo.scene.annotationInstance.activeCommandController.acProperties.pressCtrlKey) {\n        if (this._needCtrlKey) {\n          this.geo.graphCore.splitNodeVec();\n          this._needCtrlKey = false;\n        }\n      }\n\n      this.geo.graphCore.selVec.x += xo;\n      this.geo.graphCore.selVec.y += yo;\n      // this._tempProjection = this.geo.scene.annotationInstance.geometryCommon.gcmdSupporting.toMap(\n      //   this.geo.graphCore.selVec.x,\n      //   this.geo.graphCore.selVec.y\n      // );\n\n      // this.geo.wrapping.UpdateProjectionShapes(this.geo.graphCore.GetVecs());\n      // this.geo.wrapping.UpdateProjection(this.geo.graphCore.GetVecs());\n      // this.geo.UpdateProjectionDuplication();\n\n      if (this.geo.skipTranslationForLeaderline) {\n        return;\n      }\n\n      if (this.geo.textLeaderline) {\n        this.geo.textLeaderline.translateByMouseEventData(e);\n        if (this.geo.textLeaderline && this.geo.textLeaderline.leaderline) {\n          this.geo.textLeaderline.leaderline.v2.x += xo;\n          this.geo.textLeaderline.leaderline.v2.y += yo;\n          // const v = this.geo.scene.annotationInstance.geometryCommon.gcmdSupporting.toMap(\n          //   this.geo.textLeaderline.leaderline.v2.x,\n          //   this.geo.textLeaderline.leaderline.v2.y\n          // );\n\n          //   if (this.geo.textLeaderline.leaderline && this.geo.graphCore.selVecForTextLeaderline) {\n          //     this.geo.textLeaderline.leaderline.v2.x = this.geo.graphCore.selVecForTextLeaderline.x;\n          //     this.geo.textLeaderline.leaderline.v2.y = this.geo.graphCore.selVecForTextLeaderline.y;\n          //   }\n        }\n      }\n      this.geo.isSelectedNode = true;\n      return;\n    }\n\n    if (this.geo.graphCore.selMidVec) {\n      // when mid node is selected\n      this.geo.graphCore.insertMidVec();\n      // this.geo.wrapping.UpdateProjectionShapes(this.geo.graphCore.GetVecs());\n      // this.geo.wrapping.UpdateProjection(this.geo.graphCore.GetVecs());\n      // this.geo.UpdateProjectionDuplication();\n      this.geo.isSelectedNode = true;\n      return;\n    }\n\n    // now you select the shape itself.\n    this.geo.isSelectedNode = false;\n    for (let i = 0; i < this.geo.graphCore.vs.length; ++i) {\n      this.geo.graphCore.vs[i].x += xo;\n      this.geo.graphCore.vs[i].y += yo;\n\n      // this._tempProjection = this.geo.scene.annotationInstance.geometryCommon.gcmdSupporting.toMap(\n      //   this.geo.graphCore.vs[i].x,\n      //   this.geo.graphCore.vs[i].y\n      // );\n\n      // this.geo.wrapping.UpdateProjectionShapes(this.geo.graphCore.GetVecs());\n      // this.geo.wrapping.UpdateProjection(this.geo.graphCore.GetVecs());\n      // this.geo.UpdateProjectionDuplication();\n      // if (this.geo.graphCore.vs[i].HasPopup) { this.geo.graphCore.vs[i].UpdateDivPos; }\n      // this.pts[i].UpdateGoeVec();\n\n      // if (this.pts[i].textLeaderline) {\n      //     const p = this.pts[i] as APoint;\n      //     this.TranslateForTextLeaderline(e, p);\n      // }\n    }\n\n    if (this.geo.textLeaderline) {\n      this.geo.textLeaderline.translateByMouseEventData(e);\n      if (this.geo.textLeaderline.leaderline) {\n        this.geo.textLeaderline.leaderline.v2.x += xo;\n        this.geo.textLeaderline.leaderline.v2.y += yo;\n        // const v = this.geo.scene.annotationInstance.geometryCommon.gcmdSupporting.toMap(\n        //   this.geo.textLeaderline.leaderline.v2.x,\n        //   this.geo.textLeaderline.leaderline.v2.y\n        // );\n\n        // if (this.geo.textLeaderline.leaderline) {\n        //   this.geo.textLeaderline.leaderline.v2.x = this.geo.graphCore.selVecForTextLeaderline.x;\n        //   this.geo.textLeaderline.leaderline.v2.y = this.geo.graphCore.selVecForTextLeaderline.y;\n        // }\n      }\n    }\n  }\n  public translate(x: number, y: number): void {\n    //\n  }\n}\n","import { IOGeometry } from '../../../../../../lib/Extended/GeometryUtility';\nimport {\n  GType,\n  MouseEventData,\n  getDistance, NVector3\n} from '../../../../../../lib';\nimport { Scene } from '../../../../Scene';\nimport { AGeometryBase } from '../../../Common/Base/AGeometryBase';\nimport { APolylineGraphShadow } from '../../FamilyLine/APolylineGraphWrapper/Base/APolylineGraphShadow';\nimport { Dimension } from '../../Helper/Dimension';\nimport { GraphCore } from './Base/GraphCore';\nimport { InteractionComponent } from './Component/InteractionComponent';\nimport { IOComponent } from './Component/IOComponent';\nimport { MouseEventComponent } from './Component/MouseEventComponent';\nimport { RendererComponent } from './Component/RendererComponent';\nimport { StyleComponent } from './Component/StyleComponent';\nimport { TransformationComponent } from './Component/TransformationComponent';\nexport class APolygonGraphWrapper extends AGeometryBase {\n  public static construction: APolygonGraphWrapper;\n  public static isDone: boolean;\n  public static isSplit = true;\n\n  public renderer: RendererComponent;\n  public styleComponent: StyleComponent;\n  private ioComponent: IOComponent;\n  private mouseEventComponent: MouseEventComponent;\n  private interactionComponent: InteractionComponent;\n  private transformationComponent: TransformationComponent;\n\n  tVec: NVector3;\n  isSelectedNode = false;\n  isHoverValue: boolean;\n  isClosed: boolean;\n  isPath: boolean;\n\n  dimension: Dimension;\n  torVisMidPt = 10;\n  skipTranslationForLeaderline = true;\n\n  // ........................... for wrapping\n  // private vecOthers: NVector3[] | undefined;\n\n  // private vecOthersCustom: NVector3[][] | undefined;\n  // private vecSelected: number = -1;\n  // private vecsBound: NVector3[];\n\n  public graphCore: GraphCore;\n\n  public static cancel(scene: Scene) {\n    if (scene.listAPolylineGraphShadow !== undefined) {\n      scene.listAPolylineGraphShadow = undefined;\n    }\n  }\n  public static doneByKeyboard(scene: Scene) {\n    if (scene.listAPolylineGraphShadow !== undefined) {\n      const vs = scene.listAPolylineGraphShadow.getVecs();\n      if (vs) {\n        APolygonGraphWrapper.getPolygon(scene, vs);\n        scene.listAPolylineGraphShadow = undefined;\n        scene.annotationInstance.activeCommandController.goToACMode();\n      } else {\n        scene.listAPolylineGraphShadow = undefined;\n        scene.annotationInstance.activeCommandController.goToACMode();\n      }\n    }\n  }\n  public static undo(scene: Scene, e: MouseEventData) {\n    if (scene.listAPolylineGraphShadow !== undefined) {\n      scene.listAPolylineGraphShadow.undo();\n    }\n  }\n  public static mouseDown(scene: Scene, e: MouseEventData) {\n    if (scene.listAPolylineGraphShadow === undefined) {\n      return;\n    }\n    if (scene.listAPolylineGraphShadow.ps.length > 0) {\n      scene.listAPolylineGraphShadow.add(new NVector3(e.x, e.y));\n    }\n  }\n  public static mouseLeftClick(\n    scene: Scene,\n    e: MouseEventData,\n    isConstraint = false,\n    type: GType = GType.POLYGON_GRAPH\n  ) {\n    if (scene.capture !== undefined) {\n      return;\n    }\n    if (scene.listAPolylineGraphShadow === undefined) {\n      scene.listAPolylineGraphShadow = new APolylineGraphShadow(scene, type);\n      scene.listAPolylineGraphShadow.add(new NVector3(e.x, e.y));\n      scene.listAPolylineGraphShadow.add(new NVector3(e.x, e.y));\n    }\n    scene.annotationInstance.implementations.app.model.ioWrapper.eventInteraction.isEnableZoomByDoubleClick = false;\n  }\n  public static mouseMove(scene: Scene, e: MouseEventData) {\n    if (scene.listAPolylineGraphShadow === undefined) {\n      return;\n    }\n    if (scene.annotationInstance.activeCommandController.acProperties.pressShift) {\n      const p0 = scene.listAPolylineGraphShadow.ps[scene.listAPolylineGraphShadow.ps.length - 1];\n      if (getDistance(p0.v, new NVector3(e.x, e.y)) > 20) {\n        scene.listAPolylineGraphShadow.add(new NVector3(e.x, e.y));\n      }\n    }\n    if (scene.listAPolylineGraphShadow.ps.length > 1) {\n      scene.listAPolylineGraphShadow.mouseMove(e.x, e.y);\n      // scene.listAPolylineGraphShadow.ps[scene.listAPolylineGraphShadow.ps.length - 1].Move(e.x, e.y);\n    }\n  }\n  public static mouseDoubleClick(scene: Scene, e: MouseEventData) {\n    if (scene.listAPolylineGraphShadow === undefined) {\n      return;\n    }\n\n    // console.log(scene.annotationInstance.activeCommandController.IsTouchEvent);\n    if (scene.annotationInstance.activeCommandController.IsTouchEvent) {\n      if (scene.listAPolylineGraphShadow.ps.length > 1) {\n        let vs = scene.listAPolylineGraphShadow.getVecs();\n        if (vs) {\n          vs = vs.slice(0, vs.length - 1);\n          if (vs) {\n            APolygonGraphWrapper.getPolygon(scene, vs);\n            scene.listAPolylineGraphShadow = undefined;\n            scene.annotationInstance.activeCommandController.goToACMode();\n          } else {\n            scene.listAPolylineGraphShadow = undefined;\n            scene.annotationInstance.activeCommandController.goToACMode();\n          }\n        }\n      }\n    } else {\n      if (scene.listAPolylineGraphShadow.ps.length > 1) {\n        const vs = scene.listAPolylineGraphShadow.getVecs();\n        if (vs) {\n          APolygonGraphWrapper.getPolygon(scene, vs);\n          scene.listAPolylineGraphShadow = undefined;\n          scene.annotationInstance.activeCommandController.goToACMode();\n        } else {\n          scene.listAPolylineGraphShadow = undefined;\n          scene.annotationInstance.activeCommandController.goToACMode();\n        }\n      }\n    }\n\n    scene.annotationInstance.implementations.app.model.ioWrapper.eventInteraction.isEnableZoomByDoubleClick = true;\n  }\n  public static getPolygonbyVecs(scene: Scene, vs: NVector3[]) {\n    return this.getPolygon(scene, vs);\n    // let geo = new APolygon(scene, new APoint(scene, vs[0].x, vs[0].y));\n    // for (let i = 1; i < vs.length - 1; ++i) { geo.AddPT(new APoint(scene, vs[i].x, vs[i].y)); }\n    // geo.type = GTYPE.POLYGON_DEPRECATED;\n    // geo.ComputeCenterVec();\n    // geo.InitVecsHistory();\n    // scene.annotationInstance.io.eventListenerAnnotation.AddGeometryStack(geo.ToJSON());\n    // geo.IsSelectable = true;\n    // geo.isUnderConstruction = false;\n    // geo.IsHover = false;\n    // geo.visibility = 1.0;\n    // geo.isRenderable = true;\n    // return geo;\n  }\n  public static getPolygon(scene: Scene, vs: NVector3[], autoClosing = false) {\n    // for (let i = 0; i < vs.length; ++i) {\n    //   // const n = scene.annotationInstance.geometryCommon.gcmdSupporting.ToMap(vs[i].x, vs[i].y);\n    //   // vs[i].long = n[0];\n    //   // vs[i].lat = n[1];\n    //   // vs[i].proX = n[2];\n    //   // vs[i].proY = n[3];\n    // }\n    // console.log(vs);\n    scene.listAPolylineGraphShadow = undefined;\n    return new APolygonGraphWrapper(scene, vs, GType.POLYGON_GRAPH, false, true);\n  }\n  public static fromJSON(scene: Scene, g: IOGeometry, isUndo = false, isDeepCopy = false) {\n    const vs: NVector3[] = [];\n    for (let i = 0; i < g.nodes.length; ++i) {\n      // let sp = scene.annotationInstance.geometryCommon.gcmdSupporting.ToScreenFromProjectedPos(g.nodes[i].proX, g.nodes[i].proY);\n      const p = new NVector3(g.nodes[i].sx, g.nodes[i].sy);\n      // p.proX = g.nodes[i].proX;\n      // p.proY = g.nodes[i].proY;\n      // p.proZ = g.nodes[i].proZ;\n      // p.lat = g.nodes[i].lat;\n      // p.long = g.nodes[i].long;\n      // p.ele = g.nodes[i].ele;\n      vs.push(p);\n    }\n    const geo = new APolygonGraphWrapper(scene, vs, GType.POLYGON_GRAPH, true);\n\n    geo.type = GType[g.type];\n    // geo.style = g.style;\n    if (isDeepCopy) {\n      geo.id = scene.getUUID();\n    } else {\n      geo.id = g.id;\n    }\n    // geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n    geo.isHover = false;\n    geo.isHiddenValue = g.isHidden;\n    if (g.isHidden) {\n      geo.visibilityValue = 0;\n    } else {\n      geo.visibilityValue = 1.0;\n    }\n\n    if (g.styles && g.styles.dash) {\n      geo.styleComponent.renderStyle.dash = g.styles.dash;\n    }\n    if (g.styles) {\n      geo.updateStyleCustom(g.styles);\n    }\n\n    // geo.wrapping.InitProjectionShapesFromJSON(geo.GetVecs());\n    // geo.wrapping.UpdateProjection(geo.vecs);\n    // geo.ComputeCenterVec();\n    if (g.data.scale) {\n      geo.initScale(g.data.scale);\n    }\n    geo.initVecsHistory();\n    if (!isUndo) {\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n    }\n    return geo;\n  }\n\n  // ......................................................................................\n  constructor(\n    scene: Scene,\n    vs: NVector3[],\n    type: GType = GType.POLYGON_GRAPH,\n    isUndo = false,\n    isScreen = true\n  ) {\n    super(scene);\n    this.type = type;\n    this.isUnderConstruction = false;\n    this.isSelectable = true;\n    this.isRenderable = true;\n    this.isFill = true;\n    this.isUndo = isUndo;\n    this.initGraph(vs);\n    this.updateCenVec();\n    this.initVecsHistory();\n    this.initComponent();\n    this.scene.addAPolygonGraphWrapper(this);\n    if (!this.isUndo) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(this.toJSON());\n    }\n  }\n  private initComponent() {\n    this.styleComponent = new StyleComponent(this);\n    this.mouseEventComponent = new MouseEventComponent(this);\n    this.ioComponent = new IOComponent(this);\n    this.interactionComponent = new InteractionComponent(this);\n    this.transformationComponent = new TransformationComponent(this);\n    this.renderer = new RendererComponent(this);\n  }\n  private initGraph(vs: NVector3[]) {\n    this.graphCore = new GraphCore(this);\n    this.graphCore.initByVec(vs);\n  }\n  public updateCenVec() {\n    this.vec = this.graphCore.getCenVec();\n  }\n  public polygonGraphResetForSplit() {\n    this.transformationComponent.polygonGraphResetForSplit();\n  }\n  public needSnapping(v: NVector3) {\n    return this.interactionComponent.needSnapping(v);\n  }\n  public getVecForSnapping(): NVector3 | undefined {\n    // console.log(this.graphCore, this.graphCore.selVec);\n    return this.graphCore.selVec;\n  }\n  public getVecs() {\n    return this.graphCore.vs;\n  }\n  public goToBlackhole() {\n    this.needBlackhole = true;\n    this.tVec = this.scene.annotationInstance.renderer.blackhole.v as NVector3;\n    this.isAniAccel = true;\n  }\n  public isMoveUpdate() {\n    if (this.vecsHistory.length < 1) {\n      return;\n    }\n    // if ( CompareTwoVectorsByGeoPos( this.vecsHistory[this.vecsHistory.length - 1], this.vec, this.scene.annotationInstance.activeCommandController.zoomLevelForMoving)) {\n    //   this.IsMove = false;\n    //   this.IsTransform = false;\n    // } else {\n    this.isMove = true;\n    this.isTransform = true;\n    // }\n  }\n  // .................................................................. IO Component\n  public remove(needEmit = true): void {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    if (this.graphCore.selectedVec) {\n      this.graphCore.removeSelVec();\n      const data = this.toJSON();\n      if (data) {\n        this.scene.annotationInstance.io.eventListenerAnnotation.transformStack([data]);\n        return;\n      }\n    }\n    this.ioComponent.remove(needEmit);\n  }\n  public deepRemove() {\n    this.isSelectable = false;\n    this.isRenderable = false;\n    this.hidePopUpSummary();\n    this.scene.removeAPolygonGraphWrapper(this);\n    this.scene.removeGeometry(this);\n  }\n  // .................................................................. InteractionComponent\n  public isMouseInside(x: number, y: number): boolean {\n    return this.interactionComponent.isMouseInside(x, y);\n  }\n  public getLog(): string {\n    return this.interactionComponent.GetLog();\n  }\n  public hide(): void {\n    this.interactionComponent.hide();\n  }\n\n  // .................................................................. TransformationComponent\n  public translateByMouseEventData(e: MouseEventData): void {\n    this.transformationComponent.translateByMouseEventData(e);\n  }\n  public translate(x: number, y: number): void {\n    this.transformationComponent.translate(x, y);\n  }\n\n  public toJSON(): IOGeometry | undefined {\n    return this.ioComponent.ToJSON();\n  }\n\n  public mouseLeftClick() {\n    this.mouseEventComponent.mouseLeftClick();\n  }\n  public mouseRightClick() {\n    this.mouseEventComponent.mouseRightClick();\n  }\n  // .................................................................. RendererComponent\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.renderer.renderPost(ctx);\n  }\n  public renderPostNodes(ctx: CanvasRenderingContext2D) {\n    this.renderer.renderPostNodes(ctx);\n  }\n  public get isHidden() {\n    return this.isHiddenValue;\n  }\n  public set isHidden(v: boolean) {\n    this.isHiddenPre = this.isHiddenValue;\n    this.isHiddenValue = v;\n    this.scene.annotationInstance.io.eventListenerAnnotation.hideStack(this.toJSON());\n  }\n  public get isSelected() {\n    return this.isSelectedValue;\n  }\n  public set isSelected(v: boolean) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    if (this.graphCore.selVec) {\n      return;\n    }\n\n    this.isSelectedValue = v;\n    if (!v) {\n      this.graphCore.selectedVec = undefined;\n    }\n    this.scene.annotationInstance.io.eventListenerAnnotation.selectionStack(this.toJSON());\n  }\n  public get isHover() {\n    return this.isHoverValue;\n  }\n  public set isHover(v: boolean) {\n    if (this.isUnderConstruction) {\n      return;\n    }\n    this.isHoverValue = v;\n    if (this.isHoverValue && !this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    } else if (!this.isHoverValue && this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    }\n    this.isHoverPre = this.isHoverValue;\n    if (!v) {\n      this.needEmitHoverPost = true;\n      this.hidePopUpSummary();\n    }\n  }\n  public getBoundary(): NVector3[] {\n    return [this.vec];\n  }\n  public showPopupSummary() {\n    this.interactionComponent.showPopupSummary();\n  }\n  public getclosestNode(mv: NVector3, tor: number) {\n    if (this.graphCore.getclosestVec(mv, tor)) {\n      return this;\n    }\n    return undefined;\n  }\n  public findClosestVec(mv: NVector3) {\n    return this.graphCore.getclosestVec(mv, 20);\n  }\n  public updatePopup() {\n    if (this.hasPopupValue && this.popup !== undefined) {\n      if (this.hasGhostPopup) {\n        this.popup.style.top =\n          this.vec.y -\n          this.scene.annotationInstance.customization.themeCurrent.nPoint.height -\n          this.ghostPopupOffset +\n          'px';\n        this.popup.style.left = this.vec.x + 'px';\n      } else {\n        this.popup.style.top = this.vec.y + 'px';\n        this.popup.style.left = this.vec.x + 'px';\n      }\n    }\n  }\n  public checkAttachedTextleaderline(): boolean {\n    if (!this.textLeaderline || !this.textLeaderline.leaderline) {\n      return false;\n    }\n    this.skipTranslationForLeaderline = true; // \"true\" for prevent from moving Textleaderline by translating a nearby midpoint of polygon\n\n    // console.log(this.graphCore.selVec, this.skipTranslationForLeaderline);\n\n    // for the other rest node with no leaderline attached.\n    if (this.graphCore.selVec) {\n      if (this.textLeaderline && this.textLeaderline.leaderline) {\n        if (getDistance(this.graphCore.selVec, this.textLeaderline.leaderline.v2) > 5) {\n          this.skipTranslationForLeaderline = true;\n          return false; // we donot need to check others, thus just return\n        }\n        this.skipTranslationForLeaderline = false;\n      }\n    }\n    // end for the other rest node with no leaderline attached.\n\n    // find node having leaderline\n    let hasLeaderline = false;\n    for (let i = 0; i < this.graphCore.vs.length; ++i) {\n      if (getDistance(this.graphCore.vs[i], this.textLeaderline.leaderline.v2) < 5) {\n        hasLeaderline = true;\n      }\n    }\n    if (hasLeaderline) {\n      return true;\n    }\n    this.textLeaderline.attachedShape = undefined;\n    this.textLeaderline = undefined;\n    return false;\n  }\n}\n","import { GType, InteractionMode } from '../../../../../../../lib';\nimport { RendererComponent as _RendererComponent } from '../../../../Common/Base/ComponentTemplate/RendererComponent';\nimport { ACurve } from '../ACurve';\nexport class RendererComponent extends _RendererComponent {\n  public host: ACurve;\n  constructor(host: ACurve) {\n    super(host);\n    this.host = host;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.timer.update();\n    this.host.computeBoundingVecsAndCenterVec();\n\n    if (this.host.scene.annotationInstance.activeCommandController.acProperties.showUnit) {\n      if (this.host.type === GType.CURVE_CLOSE) {\n        if (this.host.isHoverValue || this.host.isUnderConstruction) {\n          // this.host.dimension.RenderLengthCurve(ctx, this.host.vecs);\n          this.host.dimension.renderTotalAreaCurve(ctx, this.host.vecs, this.host.isClosed);\n        }\n      } else {\n        if (this.host.isHoverValue || this.host.isUnderConstruction) {\n          // this.host.dimension.RenderLengthCurve(ctx, this.host.vecs);\n          this.host.dimension.renderTotalLengthCurve(ctx, this.host.vecs, this.host.isClosed);\n        }\n      }\n    }\n    this.host.computeCurve();\n    this.renderPostGeometry(ctx);\n  }\n  private renderPostGeometry(ctx: CanvasRenderingContext2D) {\n    this.renderSpline(\n      ctx,\n      this.host.arrayVertexs,\n      this.host.arrayControlPoint,\n      this.host.arrayWeight,\n      this.host.isHoverValue,\n      this.host.isSelectedValue,\n      this.host.isClosed\n    );\n\n    if (this.host.isHoverValue || this.host.isSelectedValue) {\n      if (\n        this.host.scene.annotationInstance.implementations.app.model.appCoreWrapper.appControllerStatus\n          .mode === InteractionMode.Drawing\n      ) {\n        this.drawControlLine(ctx, this.host.arrayControlPoint, this.host.arrayVertexs);\n        this.drawControPoint(ctx, this.host.arrayControlPoint);\n      }\n    }\n  }\n  // ............................................................................ render\n  private renderSpline(\n    ctx: CanvasRenderingContext2D,\n    APoints: number[],\n    cps: number[],\n    weights: number[],\n    isHover: boolean,\n    isSelected: boolean,\n    isClosed: boolean\n  ) {\n    const pts = APoints,\n      cp = cps,\n      n = pts.length;\n\n    if (isClosed) {\n      if (this.host.isHoverValue || this.host.isSelectedValue) {\n        for (let i = 2; i < n + 2; i += 2) {\n          this.host.scene.annotationInstance.renderer.draw.shape.curve.curveBezierClosedHoverPolygon(\n            ctx,\n            this.host.styleComponent.renderStyle,\n            pts[i],\n            pts[i + 1],\n            cp[2 * i - 2],\n            cp[2 * i - 1],\n            cp[2 * i],\n            cp[2 * i + 1],\n            pts[i + 2],\n            pts[i + 3],\n            this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(\n              this.host.renderer.tOver\n            )\n          );\n        }\n      }\n      for (let i = 2; i < n + 2; i += 2) {\n        this.host.scene.annotationInstance.renderer.draw.shape.curve.curveBezierClosed(\n          ctx,\n          this.host.styleComponent.renderStyle,\n          pts[i],\n          pts[i + 1],\n          cp[2 * i - 2],\n          cp[2 * i - 1],\n          cp[2 * i],\n          cp[2 * i + 1],\n          pts[i + 2],\n          pts[i + 3],\n          this.host.isHoverValue,\n          this.host.isSelectedValue\n        );\n      }\n      if (this.host.isFill) {\n        this.renderCurveInfill(ctx, APoints, cps);\n      }\n    } else {\n      if (this.host.isHoverValue || this.host.isSelectedValue) {\n        for (let i = 2; i < pts.length - 5; i += 2) {\n          this.host.scene.annotationInstance.renderer.draw.shape.curve.curveBezierHoverPolyline(\n            ctx,\n            this.host.styleComponent.renderStyle,\n            pts[i],\n            pts[i + 1],\n            cp[2 * i - 2],\n            cp[2 * i - 1],\n            cp[2 * i],\n            cp[2 * i + 1],\n            pts[i + 2],\n            pts[i + 3],\n            this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(\n              this.host.renderer.tOver\n            )\n          );\n        }\n        this.host.scene.annotationInstance.renderer.draw.shape.curve.curveQuadraticHoverPolyline(\n          ctx,\n          this.host.styleComponent.renderStyle,\n          pts[0],\n          pts[1],\n          cp[0],\n          cp[1],\n          pts[2],\n          pts[3],\n          this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(\n            this.host.renderer.tOver\n          )\n        );\n        this.host.scene.annotationInstance.renderer.draw.shape.curve.curveQuadraticHoverPolyline(\n          ctx,\n          this.host.styleComponent.renderStyle,\n          pts[n - 2],\n          pts[n - 1],\n          cp[2 * n - 10],\n          cp[2 * n - 9],\n          pts[n - 4],\n          pts[n - 3],\n          this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(\n            this.host.renderer.tOver\n          )\n        );\n      }\n\n      for (let i = 2; i < pts.length - 5; i += 2) {\n        this.host.scene.annotationInstance.renderer.draw.shape.curve.curveBezier(\n          ctx,\n          this.host.styleComponent.renderStyle,\n          pts[i],\n          pts[i + 1],\n          cp[2 * i - 2],\n          cp[2 * i - 1],\n          cp[2 * i],\n          cp[2 * i + 1],\n          pts[i + 2],\n          pts[i + 3],\n          this.host.isHoverValue,\n          this.host.isSelectedValue\n        );\n      }\n      this.host.scene.annotationInstance.renderer.draw.shape.curve.curveQuadratic(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        pts[0],\n        pts[1],\n        cp[0],\n        cp[1],\n        pts[2],\n        pts[3],\n        this.host.isHoverValue,\n        this.host.isSelectedValue\n      );\n      this.host.scene.annotationInstance.renderer.draw.shape.curve.curveQuadratic(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        pts[n - 2],\n        pts[n - 1],\n        cp[2 * n - 10],\n        cp[2 * n - 9],\n        pts[n - 4],\n        pts[n - 3],\n        this.host.isHoverValue,\n        this.host.isSelectedValue\n      );\n    }\n    // ctx.restore();\n    // if (isHover || isSelected) {\n\n    //     let vs = APoint.GetVecs(this.host.pts);\n    //     vs = NVector3.GetMinMaxVecFromVecs(vs);\n    //     let cv = NVector3.GetCenterVecFromVecs(vs);\n    //     this.host.scene.annotationInstance.renderer.draw.shape.curve.CenterPoint(ctx, cv.x, cv.y);\n    //     // CBoundingBox.RenderBoundingBoxForTwoVecs(ctx, vs[0], vs[1], this.geo.scene.annotationInstance.renderer.numericalMotion.Scale(10), 5 + this.geo.scene.annotationInstance.renderer.numericalMotion.Scale(9));\n    // }\n    this.offscreenRender(pts, cp, n, isClosed);\n  }\n  private drawControPoint(ctx: CanvasRenderingContext2D, arrayControlPoint: number[]) {\n    // console.log(this.host.styleComponent.renderStyleNode);\n    ctx.lineWidth = this.host.styleComponent.renderStyleNode.lineWidth * 0.5;\n    ctx.fillStyle = this.host.styleComponent.renderStyleNode.colorFill;\n    ctx.strokeStyle = this.host.styleComponent.renderStyleNode.colorStroke;\n    for (let i = 0; i < arrayControlPoint.length - 1; i += 2) {\n      ctx.beginPath();\n      ctx.arc(\n        arrayControlPoint[i],\n        arrayControlPoint[i + 1],\n        3 * this.host.scaleForRender,\n        0,\n        2 * Math.PI,\n        false\n      );\n      ctx.fill();\n      ctx.stroke();\n    }\n  }\n  private drawControlLine(\n    ctx: CanvasRenderingContext2D,\n    arrayControlPoint: number[],\n    arrayVertexs: number[]\n  ) {\n    for (let i = 2; i < arrayVertexs.length - 5; i += 2) {\n      this.host.scene.annotationInstance.renderer.draw.shape.curve.drawControlLine(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        arrayVertexs[i],\n        arrayVertexs[i + 1],\n        arrayControlPoint[2 * i - 2],\n        arrayControlPoint[2 * i - 1]\n      );\n      this.host.scene.annotationInstance.renderer.draw.shape.curve.drawControlLine(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        arrayVertexs[i + 2],\n        arrayVertexs[i + 3],\n        arrayControlPoint[2 * i],\n        arrayControlPoint[2 * i + 1]\n      );\n    }\n    this.host.scene.annotationInstance.renderer.draw.shape.curve.drawControlLine(\n      ctx,\n      this.host.styleComponent.renderStyle,\n      arrayVertexs[2],\n      arrayVertexs[3],\n      arrayControlPoint[0],\n      arrayControlPoint[1]\n    );\n    this.host.scene.annotationInstance.renderer.draw.shape.curve.drawControlLine(\n      ctx,\n      this.host.styleComponent.renderStyle,\n      arrayVertexs[arrayVertexs.length - 4],\n      arrayVertexs[arrayVertexs.length - 3],\n      arrayControlPoint[2 * arrayVertexs.length - 10],\n      arrayControlPoint[2 * arrayVertexs.length - 9]\n    );\n  }\n  private renderCurveInfill(\n    ctx: CanvasRenderingContext2D,\n    APoints: number[],\n    cps: number[],\n    opacity = 0.3\n  ) {\n    // let scale = style.strokeSize;\n\n    const pts = APoints,\n      cp = cps,\n      n = pts.length;\n\n    // let c =\n    // let cc = c[0] + ',' + c[1] + ',' + c[2] + ',' + opacity + ')';\n    // console.log(cc);\n    // console.log(this.host.scene.annotationInstance.renderer.preset.polygonColorFill);\n    // ctx.fillStyle = 'rgba(255,0,0, 0.1)' ; // this.host.scene.annotationInstance.renderer.preset.polygonColorFill;\n    if (this.host.scene.annotationInstance.renderer.needFocus && !this.host.isHoverValue) {\n      ctx.strokeStyle = this.host.styleComponent.renderStyle.colorStrokeHover;\n      ctx.fillStyle = this.host.styleComponent.renderStyle.colorFillHover;\n    } else {\n      ctx.strokeStyle = this.host.styleComponent.renderStyle.colorStroke;\n      ctx.fillStyle = this.host.styleComponent.renderStyle.colorFill;\n    }\n\n    if (this.host.isSelectedValue) {\n      ctx.strokeStyle = this.host.styleComponent.renderStyle.colorStroke;\n      ctx.fillStyle = this.host.styleComponent.renderStyle.colorFill;\n    }\n\n    const ii = 2;\n    // ctx.save();\n    ctx.beginPath();\n    ctx.moveTo(pts[ii], pts[ii + 1]);\n    for (let i = 2; i < n + 2; i += 2) {\n      this.host.scene.annotationInstance.renderer.draw.shape.curve.curveBezierClosedFill(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        pts[i],\n        pts[i + 1],\n        cp[2 * i - 2],\n        cp[2 * i - 1],\n        cp[2 * i],\n        cp[2 * i + 1],\n        pts[i + 2],\n        pts[i + 3]\n      );\n    }\n    ctx.closePath();\n    ctx.fill();\n    // ctx.fill();\n    // ctx.restore();\n  }\n  private renderCurveInfillOffscreen(\n    ctx: CanvasRenderingContext2D,\n    col: string,\n    APoints: number[],\n    cps: number[]\n  ) {\n    // let scale = style.strokeSize;\n\n    const pts = APoints;\n    const cp = cps;\n    // let weight:number[] = weights;\n    // ctx.save();\n    const n = pts.length;\n    ctx.save();\n    ctx.beginPath();\n    ctx.fillStyle = col;\n    const ii = 2;\n    ctx.moveTo(pts[ii], pts[ii + 1]);\n    for (let i = 2; i < n + 2; i += 2) {\n      this.host.scene.annotationInstance.renderer.draw.shape.curve.curveBezierClosedFill(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        pts[i],\n        pts[i + 1],\n        cp[2 * i - 2],\n        cp[2 * i - 1],\n        cp[2 * i],\n        cp[2 * i + 1],\n        pts[i + 2],\n        pts[i + 3]\n      );\n    }\n    ctx.closePath();\n    ctx.fill();\n    ctx.restore();\n  }\n  // ........................................................................................................................... Off Screen\n  private offscreenRender(pts: number[], cp: number[], n: number, isClosed: boolean) {\n    if (isClosed) {\n      for (let i = 2; i < n + 2; i += 2) {\n        this.host.scene.annotationInstance.renderer.offscreen.curveBezierOffScreen(\n          this.host.scene.annotationInstance.renderer.ctxOffscreen,\n          this.host.styleComponent.renderStyle,\n          this.host.hashColor,\n          pts[i],\n          pts[i + 1],\n          cp[2 * i - 2],\n          cp[2 * i - 1],\n          cp[2 * i],\n          cp[2 * i + 1],\n          pts[i + 2],\n          pts[i + 3]\n        );\n      }\n      this.renderCurveInfillOffscreen(\n        this.host.scene.annotationInstance.renderer.ctxOffscreen,\n        this.host.hashColor,\n        pts,\n        cp\n      ); // offscreen rendering\n    } else {\n      for (let i = 2; i < pts.length - 5; i += 2) {\n        this.host.scene.annotationInstance.renderer.offscreen.curveBezierOffScreen(\n          this.host.scene.annotationInstance.renderer.ctxOffscreen,\n          this.host.styleComponent.renderStyle,\n          this.host.hashColor,\n          pts[i],\n          pts[i + 1],\n          cp[2 * i - 2],\n          cp[2 * i - 1],\n          cp[2 * i],\n          cp[2 * i + 1],\n          pts[i + 2],\n          pts[i + 3]\n        );\n      }\n      this.host.scene.annotationInstance.renderer.offscreen.curveQuadraticArrowOffScreen(\n        this.host.scene.annotationInstance.renderer.ctxOffscreen,\n        this.host.styleComponent.renderStyle,\n        this.host.hashColor,\n        pts[0],\n        pts[1],\n        cp[0],\n        cp[1],\n        pts[2],\n        pts[3]\n      );\n      this.host.scene.annotationInstance.renderer.offscreen.curveQuadraticArrowOffScreen(\n        this.host.scene.annotationInstance.renderer.ctxOffscreen,\n        this.host.styleComponent.renderStyle,\n        this.host.hashColor,\n        pts[n - 2],\n        pts[n - 1],\n        cp[2 * n - 10],\n        cp[2 * n - 9],\n        pts[n - 4],\n        pts[n - 3]\n      );\n    }\n  }\n}\n","import { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { ACurve } from '../ACurve';\nexport class StyleComponent extends _StyleComponent {\n  public geo: ACurve;\n  constructor(geo: ACurve) {\n    super(geo);\n    this.updateStyle();\n  }\n  public updateStyle() {\n    RenderStyle.updateRenderStylePolygon(\n      this.renderStyle,\n      this.geo.scene.annotationInstance.customization.themeCurrent\n    );\n    RenderStyle.updateRenderStylePolygonNode(\n      this.renderStyleNode,\n      this.geo.scene.annotationInstance.customization.themeCurrent\n    );\n  }\n}\n","import { IOGeometry } from '../../../../../../lib/Extended/GeometryUtility';\nimport {\n  GType,\n  MouseEventData,\n  getCenterVecFromVecs, NVector3 \n} from '../../../../../../lib';\nimport { Scene } from '../../../../Scene';\nimport { AGeometryBase } from '../../../Common/Base/AGeometryBase';\nimport { APoint } from '../../FamilyPoint/Base/APoint';\n// import { AGeometryRender } from './AGeometryRenderer';\n// import { CActiveCommandCommon } from '../CActiveCommands';\n// import { CLine } from './CLine';\n// import { IcDrawingTheme } from '../../Theme/ThemeController';\n// import { MercatorDrawingTheme } from '../../Theme/MercatorDrawingTheme';\nimport { Dimension } from '../../Helper/Dimension';\n// import { Timer } from '../../Helper/Timer';\nimport { RendererComponent } from './Component/RendererComponent';\nimport { StyleComponent } from './Component/StyleComponent';\n// reference\n// https://en.wikipedia.org/wiki/B%C3%A9zier_curve#Quadratic_curves\n// http://scaledinnovation.com/analytics/splines/aboutSplines.html\nexport class ACurve extends AGeometryBase {\n  public static construction: ACurve | undefined = undefined;\n  public styleComponent: StyleComponent;\n  public vec: NVector3;\n  public vecs: NVector3[];\n  public pts: APoint[];\n  public isClosed: boolean;\n  public showDetails: boolean;\n  public arrayVertexs: number[];\n  public arrayWeight: number[];\n  public arrayControlPoint: number[];\n\n  // ........................... for wrapping\n  // vecOthers: NVector3[];\n\n  // vecOthersCustom: NVector3[][] | undefined;\n  public vecSelected = -1;\n  // vecsBound: NVector3[];\n  public dimension: Dimension;\n  // timer: Timer;\n  // reference http://scaledinnovation.com/analytics/splines/aboutSplines.html\n  public static getControlPoints(\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    t: number\n  ) {\n    const d01 = Math.sqrt(Math.pow(x1 - x0, 2) + Math.pow(y1 - y0, 2));\n    const d12 = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n    const fa = (t * d01) / (d01 + d12);\n    const fb = t - fa;\n    const p1x = x1 + fa * (x0 - x2);\n    const p1y = y1 + fa * (y0 - y2);\n    const p2x = x1 - fb * (x0 - x2);\n    const p2y = y1 - fb * (y0 - y2);\n    return [p1x, p1y, p2x, p2y];\n  }\n  public static computeControlPoints(pts: number[], t: number, isClosed = false) {\n    let cps: number[] = [];\n    if (isClosed) {\n      pts.push(pts[0], pts[1], pts[2], pts[3]);\n      pts.unshift(pts[pts.length - 1]);\n      pts.unshift(pts[pts.length - 1]);\n      for (let i = 0; i < pts.length; i += 2) {\n        cps = cps.concat(\n          ACurve.getControlPoints(\n            pts[i],\n            pts[i + 1],\n            pts[i + 2],\n            pts[i + 3],\n            pts[i + 4],\n            pts[i + 5],\n            t\n          )\n        );\n      }\n      cps = cps.concat(cps[0], cps[1]);\n    } else {\n      for (let i = 0; i < pts.length - 4; i += 2) {\n        cps = cps.concat(\n          ACurve.getControlPoints(\n            pts[i],\n            pts[i + 1],\n            pts[i + 2],\n            pts[i + 3],\n            pts[i + 4],\n            pts[i + 5],\n            t\n          )\n        );\n      }\n    }\n\n    return cps;\n  }\n\n  public static getLength(scene: Scene, type: GType) {\n    let i = scene.listACurve.length;\n    let count = 0;\n    while (i--) {\n      if (type === scene.listACurve[i].type) {\n        count += 1;\n      }\n    }\n    return count;\n  }\n  public static getLengthSelection(scene: Scene, type: GType) {\n    let i = scene.listACurve.length;\n    let count = 0;\n    while (i--) {\n      if (scene.listACurve[i].isSelected && type === scene.listACurve[i].type) {\n        count += 1;\n      }\n    }\n    return count;\n  }\n  // ...................................................................... construction\n  public static fromJSON(\n    scene: Scene,\n    g: IOGeometry,\n    isUndo = false,\n    isDeepCopy = false,\n    isClosed = false\n  ) {\n    // eslint:disable-next-line:no-string-literal\n\n    const geo = new ACurve(scene, isClosed, isUndo);\n    if (isUndo) {\n      for (let i = 0; i < g.nodes.length; ++i) {\n        geo.addPT(APoint.getNodeFromJSON(scene, g.nodes[i], isUndo));\n      }\n    } else {\n      for (let i = 0; i < g.nodes.length; ++i) {\n        geo.addPT(APoint.getNodeFromJSON(scene, g.nodes[i]));\n      }\n    }\n\n    geo.type = GType[g.type];\n    geo.IsSelectable = true;\n    geo.isUnderConstruction = false;\n    geo.isHover = false;\n    geo.isHidden = g.isHidden;\n\n    if (isDeepCopy) {\n      geo.id = scene.getUUID();\n    } else {\n      geo.id = g.id;\n    }\n    if (g.isHidden) {\n      geo.visibilityValue = 0;\n    } else {\n      geo.visibilityValue = 1;\n    }\n\n    geo.initVecsHistory();\n    ACurve.construction = undefined;\n    return geo;\n  }\n  public static getCurveByVecs(scene: Scene, v: NVector3[], isClosed = false) {\n    const c = new ACurve(scene, isClosed);\n    for (let i = 0; i < v.length; ++i) {\n      c.addPT(new APoint(scene, v[i].x, v[i].y, 0));\n    }\n    c.IsSelectable = true;\n    c.isUnderConstruction = false;\n    scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(c.toJSON());\n    return c;\n  }\n  public static drawShadow(e: MouseEventData) {\n    if (ACurve.construction !== undefined) {\n      if (ACurve.construction.pts.length < 3) {\n        if (ACurve.construction.isRemove) {\n          return;\n        }\n        ACurve.construction.pts[ACurve.construction.pts.length - 1].move(e.x, e.y);\n        const sp = ACurve.construction.pts[0];\n        const mp = ACurve.construction.pts[1];\n        const ep = ACurve.construction.pts[2];\n\n        mp.vec.x = (sp.vec.x + ep.vec.x) * 0.5;\n        mp.vec.y = (sp.vec.y + ep.vec.y) * 0.5;\n      } else {\n        ACurve.construction.pts[ACurve.construction.pts.length - 1].move(e.x, e.y);\n      }\n    }\n  }\n  public static getCurveByPt(scene: Scene, p: APoint) {\n    ACurve.construction = new ACurve(scene);\n    ACurve.construction.addPT(new APoint(scene, p.vec.x, p.vec.y));\n    ACurve.construction.addPT(new APoint(scene, p.vec.x, p.vec.y));\n    ACurve.construction.addPT(new APoint(scene, p.vec.x, p.vec.y));\n    // ACurve.construction.AddPT(new APoint(scene, p.vec.x, p.vec.y));\n    p.remove();\n  }\n  public static getCurve(scene: Scene, e: MouseEventData, isClosed = false) {\n    if (ACurve.construction !== undefined) {\n      if (ACurve.construction.pts[0].distance(e.x, e.y) < 5) {\n        ACurve.construction.isClosed = isClosed;\n        if (ACurve.construction.isClosed) {\n          ACurve.construction.removePT(ACurve.construction.pts[0]);\n          ACurve.construction.removePT(ACurve.construction.pts[0]);\n          ACurve.construction.removePT(ACurve.construction.pts[ACurve.construction.pts.length - 1]);\n          ACurve.construction.removePT(ACurve.construction.pts[ACurve.construction.pts.length - 1]);\n        } else {\n          ACurve.construction.removePT(ACurve.construction.pts[0]);\n          ACurve.construction.removePT(ACurve.construction.pts[ACurve.construction.pts.length - 1]);\n          ACurve.construction.removePT(ACurve.construction.pts[ACurve.construction.pts.length - 1]);\n        }\n        ACurve.construction.IsCapture = false;\n        ACurve.construction = undefined;\n      } else {\n        ACurve.construction.addPT(new APoint(scene, e.x, e.y));\n      }\n    } else {\n      ACurve.construction = new ACurve(scene, isClosed);\n      ACurve.construction.addPT(new APoint(scene, e.x, e.y));\n      ACurve.construction.addPT(new APoint(scene, e.x, e.y));\n      ACurve.construction.addPT(new APoint(scene, e.x, e.y));\n      // ACurve.construction.AddPT(new APoint(scene, e.x, e.y));\n    }\n  }\n  // ....................................................\n  public static done(scene: Scene, isClosed = false) {\n    if (ACurve.construction !== undefined) {\n      if (ACurve.construction.pts.length < 5) {\n        const g = new APoint(\n          scene,\n          ACurve.construction.pts[0].vec.x,\n          ACurve.construction.pts[0].vec.y,\n          ACurve.construction.pts[0].vec.z\n        );\n        g.dummy();\n        ACurve.construction.remove();\n        ACurve.construction = undefined; // it need to be remove all\n        scene.annotationInstance.activeCommandController.goToACMode();\n      } else {\n        if (ACurve.construction.isClosed) {\n          ACurve.construction.removePT(ACurve.construction.pts[0]);\n          ACurve.construction.removePT(ACurve.construction.pts[0]);\n          ACurve.construction.removePT(ACurve.construction.pts[ACurve.construction.pts.length - 1]);\n          ACurve.construction.removePT(ACurve.construction.pts[ACurve.construction.pts.length - 1]);\n        } else {\n          ACurve.construction.removePT(ACurve.construction.pts[0]);\n          ACurve.construction.removePT(ACurve.construction.pts[ACurve.construction.pts.length - 1]);\n          ACurve.construction.removePT(ACurve.construction.pts[ACurve.construction.pts.length - 1]);\n        }\n        // ACurve.construction.isClosed = ACurve.isClose;\n        ACurve.construction.IsSelectable = true;\n        ACurve.construction.isUnderConstruction = false;\n        scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n          ACurve.construction.toJSON()\n        );\n        ACurve.construction = undefined; // this is not remove but just done!!!!\n        scene.annotationInstance.activeCommandController.goToACMode();\n      }\n    }\n  }\n  public static doneByKeyboard(scene: Scene) {\n    if (ACurve.construction !== undefined) {\n      if (ACurve.construction.pts.length < 5) {\n        const g = new APoint(\n          scene,\n          ACurve.construction.pts[0].vec.x,\n          ACurve.construction.pts[0].vec.y,\n          ACurve.construction.pts[0].vec.z\n        );\n        g.dummy();\n        ACurve.construction.remove();\n        ACurve.construction = undefined; // it need to be remove all\n        scene.annotationInstance.activeCommandController.goToACMode();\n      } else {\n        ACurve.construction.removePT(ACurve.construction.pts[0]);\n        ACurve.construction.removePT(ACurve.construction.pts[1]);\n        ACurve.construction.removePT(ACurve.construction.pts[ACurve.construction.pts.length - 1]);\n        // ACurve.construction.isClosed = ACurve.isClose;\n        ACurve.construction.IsSelectable = true;\n        ACurve.construction.isUnderConstruction = false;\n        scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n          ACurve.construction.toJSON()\n        );\n        ACurve.construction = undefined; // this is not remove but just done!!!!\n        scene.annotationInstance.activeCommandController.goToACMode();\n      }\n    }\n  }\n  public static undo(e: MouseEventData) {\n    if (!ACurve.construction) {\n      return;\n    }\n    let i = ACurve.construction.pts.length - 1;\n    if (i < 4) {\n      ACurve.cancel();\n      return;\n    }\n    ACurve.construction.removePT(ACurve.construction.pts[--i]);\n    ACurve.construction.pts[i].vec.x = e.x;\n    ACurve.construction.pts[i].vec.y = e.y;\n  }\n  public static cancel() {\n    if (ACurve.construction !== undefined) {\n      ACurve.construction.isRemove = true;\n      ACurve.construction.remove();\n      ACurve.construction = undefined; // it need to be remove all\n    }\n  }\n  // .................................................................... end implementation\n  public static mouseDown(scene: Scene, e: MouseEventData, isClosed = false) {\n    if (scene.annotationInstance.activeCommandController.acProperties.isSmartSelectionWhenDrawing) {\n      const cGeo = scene.annotationInstance.geometryCommon.gcmdProcessing.findAtPoint(e);\n      if (ACurve.construction) {\n        if (cGeo === ACurve.construction.pts[ACurve.construction.pts.length - 1]) {\n          if (\n            cGeo !== undefined &&\n            cGeo.type === GType.ANODE &&\n            ACurve.construction !== undefined\n          ) {\n            if (ACurve.construction) {\n              ACurve.construction.addPT(new APoint(scene, cGeo.v.x, cGeo.v.y, cGeo.v.z));\n            }\n            cGeo.remove();\n          } else if (\n            cGeo !== undefined &&\n            cGeo.type === GType.ANODE &&\n            ACurve.construction === undefined\n          ) {\n            ACurve.getCurveByPt(scene, cGeo as APoint);\n          }\n        } else {\n          ACurve.getCurve(scene, e, isClosed);\n        }\n      }\n    } else {\n      ACurve.getCurve(scene, e, isClosed);\n    }\n  }\n  public static mouseDoubleClick(scene: Scene, e: MouseEventData, isClosed = false) {\n    if (ACurve.construction !== undefined) {\n      ACurve.done(scene, isClosed);\n    }\n  }\n  public static mouseLeftClick(scene: Scene, e: MouseEventData, isClosed = false) {\n    if (scene.capture !== undefined) {\n      return;\n    }\n    if (ACurve.construction === undefined) {\n      ACurve.getCurve(scene, e, isClosed);\n    }\n  }\n  public static mouseMove(e: MouseEventData) {\n    ACurve.drawShadow(e);\n  }\n\n  // ...................................................................... end render\n\n  constructor(scene: Scene, isClosed = false, isUndo = false) {\n    super(scene);\n    this.vec = new NVector3(0, 0, 0);\n    this.pts = [];\n    this.initComponent();\n    this.isClosed = isClosed;\n    this.isUndo = isUndo;\n    this.isUnderConstruction = true;\n    this.showDetails = true;\n    if (this.isClosed) {\n      this.type = GType.CURVE_CLOSE;\n      this.isFill = true;\n    } else {\n      this.type = GType.CURVE_OPEN;\n      this.isFill = false;\n    }\n    this.dimension = new Dimension(this);\n    // this.renderer.timer = new Timer(this);\n    this.scene.addACurve(this);\n    this.init();\n  }\n  private initComponent() {\n    this.styleComponent = new StyleComponent(this);\n    this.renderer = new RendererComponent(this);\n  }\n  public init() {\n    /* */\n  }\n  public getLog(): string {\n    // this.UpdateGoeVec();\n    const text =\n      'GUID : ' +\n      this.id +\n      '/' +\n      'TYPE : ' +\n      this.type.toString() +\n      '/' +\n      // 'PARENT : ' + this.edges[0].GetParentType()+'<br>'+\n      // 'Geo : ' + 'lat:' + this.geoVec.x.toFixed(5).toString() + ', Log:' + this.geoVec.y.toFixed(5).toString() + '/' +\n      'Screen : ' +\n      // this.vec.ToString() +\n      '/' +\n      'Nodes : ' +\n      this.pts.length +\n      '/' +\n      // 'Area : ' + this.GetArea().toFixed(3).toString() + ' m2' + '/' +\n      // 'STYLE : ' + this.style.toString() + '/' +\n      // 'CONNE :' + this.edges.length.toString() + '/' +\n      'IsSEL : ' +\n      this.isSelectedValue +\n      '/' +\n      'isSelable : ' +\n      this.isSelectable;\n    return text;\n  }\n  public getLogDOM() {\n    const text =\n      'Geometry ID : ' +\n      this.id +\n      '<br>' +\n      'geometry Type : CCircle' +\n      '<br>' +\n      // 'parent : ' + this.parent.GetParentType() + '<br>' +\n      'position : ' +\n      // this.vec.ToString() + '<br>' +\n      'size : ' +\n      this.r +\n      ' pixel<br>';\n    // 'color :' + this.style.fillStyle + '<br>';\n    return text;\n  }\n  public getVecs() {\n    this.vecs = [];\n    for (const p of this.pts) {\n      this.vecs.push(p.vec);\n    }\n    return this.vecs;\n  }\n  public computeVertex() {\n    this.arrayVertexs = [];\n    for (const p of this.pts) {\n      this.arrayVertexs.push(p.vec.x, p.vec.y);\n    }\n  }\n  public computeWeight() {\n    this.arrayWeight = [];\n    for (const p of this.pts) {\n      this.arrayWeight.push(p.weightLeft, p.weightRight);\n    }\n  }\n  public computeControlPoint() {\n    const pts: number[] = [];\n    for (const ii of this.arrayVertexs) {\n      pts.push(ii);\n    }\n    let cps: number[] = [];\n    if (this.isClosed) {\n      pts.push(pts[0], pts[1], pts[2], pts[3]);\n      pts.unshift(pts[this.arrayVertexs.length - 1]);\n      pts.unshift(pts[this.arrayVertexs.length - 1]);\n      for (let i = 0; i < this.arrayVertexs.length; i += 2) {\n        cps = cps.concat(\n          ACurve.getControlPoints(\n            pts[i],\n            pts[i + 1],\n            pts[i + 2],\n            pts[i + 3],\n            pts[i + 4],\n            pts[i + 5],\n            this.arrayWeight[i]\n          )\n        );\n      }\n      cps = cps.concat(cps[0], cps[1]);\n      this.arrayControlPoint = cps;\n      this.arrayVertexs = pts;\n      return;\n    }\n    for (let i = 0; i < pts.length - 4; i += 2) {\n      cps = cps.concat(\n        ACurve.getControlPoints(\n          pts[i],\n          pts[i + 1],\n          pts[i + 2],\n          pts[i + 3],\n          pts[i + 4],\n          pts[i + 5],\n          this.arrayWeight[i]\n        )\n      );\n    }\n    this.arrayControlPoint = cps;\n    return;\n  }\n  public goToBlackhole() {\n    this.isSelectable = false;\n    this.needBlackhole = true;\n    this.pts.forEach((p) => {\n      p.goToBlackhole();\n    });\n  }\n  public computeVertexDuplication(vecOthers: NVector3[]) {\n    this.arrayVertexs = [];\n    for (const p of vecOthers) {\n      this.arrayVertexs.push(p.x, p.y);\n    }\n\n    const pts: number[] = [];\n    for (const ii of this.arrayVertexs) {\n      pts.push(ii);\n    }\n    let cps: number[] = [];\n    if (this.isClosed) {\n      pts.push(pts[0], pts[1], pts[2], pts[3]);\n      pts.unshift(pts[this.arrayVertexs.length - 1]);\n      pts.unshift(pts[this.arrayVertexs.length - 1]);\n      for (let i = 0; i < this.arrayVertexs.length; i += 2) {\n        cps = cps.concat(\n          ACurve.getControlPoints(\n            pts[i],\n            pts[i + 1],\n            pts[i + 2],\n            pts[i + 3],\n            pts[i + 4],\n            pts[i + 5],\n            this.arrayWeight[i]\n          )\n        );\n      }\n      cps = cps.concat(cps[0], cps[1]);\n      this.arrayControlPoint = cps;\n      this.arrayVertexs = pts;\n      return;\n    }\n    for (let i = 0; i < pts.length - 4; i += 2) {\n      cps = cps.concat(\n        ACurve.getControlPoints(\n          pts[i],\n          pts[i + 1],\n          pts[i + 2],\n          pts[i + 3],\n          pts[i + 4],\n          pts[i + 5],\n          this.arrayWeight[i]\n        )\n      );\n    }\n    this.arrayControlPoint = cps;\n    return;\n  }\n  public computeCurve() {\n    this.computeVertex();\n    this.computeWeight();\n    this.computeControlPoint();\n  }\n  // ...................................................................... geomety common\n  public remove(needEmit = true): void {\n    let i = this.pts.length;\n    while (i--) {\n      this.pts[i].remove();\n    }\n\n    if (needEmit) {\n      const ioGeo = this.toJSON();\n      if (ioGeo) {\n        this.scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack([ioGeo]);\n      }\n    }\n\n    this.scene.removeACurve(this);\n    this.scene.removeGeometry(this);\n  }\n  public hide() {\n    /* */\n  }\n  public addPT(p: APoint) {\n    p.type = GType.ANODE;\n    p.vec.w = 0.5;\n    p.weightLeft = p.vec.w;\n    p.weightRight = 0.0;\n    p.isSelectable = false;\n    p.styleComponent.renderStyle = this.styleComponent.renderStyleNode;\n    p.styleComponent.renderStyleNode = this.styleComponent.renderStyleNode;\n    p.styleComponent.updateStyleForNode(this.styleComponent.renderStyleNode); // = this.styleComponent.renderStyleNode;\n    p.edges.push(this);\n    this.pts.push(p);\n    if (this.pts.length > 2) {\n      this.computeCurve();\n    }\n  }\n  public removePT(p: APoint) {\n    this.pts.splice(this.pts.indexOf(p), 1);\n    p.remove();\n  }\n  public deepCopy(x: number, y: number, z = 0) {\n    const g = this.toJSON();\n    if (g) {\n      let ng;\n      if (g.type === GType.CURVE_CLOSE) {\n        ng = ACurve.fromJSON(this.scene, g, true, true, true);\n      } else {\n        ng = ACurve.fromJSON(this.scene, g, true, true);\n      }\n      ng.move(x, y);\n      // console.log(ng);\n      ng.isHover = true;\n      ng.emitAddStack();\n      return ng;\n    }\n    return undefined;\n  }\n  public move(x: number, y: number) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    this.computeBoundingVecsAndCenterVec();\n    const xo = x - this.vec.x;\n    const yo = y - this.vec.y;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].vec.x += xo;\n      this.pts[i].vec.y += yo;\n    }\n  }\n  public isMouseInside(x: number, y: number) {\n    if (this.isUnderConstruction === true || this.isUnderConstruction === undefined) {\n      return false;\n    }\n    // if (this.wrapping.needWrappingDuplicate) {\n    if (this.checkDistance(x, y)) {\n      return true;\n    }\n    if (this.isMouseInsideByOffScreen(x, y)) {\n      return true;\n    }\n    return false;\n\n    // }\n    // if (this.IsMouseInsideByOffScreen(x, y)) { return true; }\n    // return false;\n    // // }\n  }\n  public checkDistance(x: number, y: number) {\n    // ....................................... duplicated polyline or gon\n    // let vecOtherSelected = this.wrapping.vecSelected;\n    // if (vecOtherSelected) {\n    //   let len = vecOtherSelected.length;\n    //   if (len > 2) {\n    //     for (let i = 0; i < vecOtherSelected.length; ++i) {\n    //       if (Distance(new NVector3(x, y), vecOtherSelected[i]) < 9) {\n    //         this.vecSelected = i;\n    //         return true;\n    //       } else {\n    //         this.vecSelected = -1;\n    //       }\n    //     }\n    //   }\n    // }\n    // ....................................... end duplicated polyline or gon\n    // if (AGeometry.IsMouseInsideByOffScreen(x, y, this.hashColor)) { return true; }\n    return false;\n  }\n  public isMouseInsideByOffScreen(x: number, y: number) {\n    const c = this.scene.annotationInstance.geometryCommon.gcmdProcessing.isMouseInsideByOffScreen(\n      x,\n      y,\n      this.hashColor\n    );\n    if (c) {\n      this.isHover = true;\n      return true;\n    }\n    this.isHover = false;\n    return false;\n  }\n  public set IsSelectable(v: boolean) {\n    this.isSelectable = v;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].isSelectable = v;\n    }\n  }\n  public get IsSelectable() {\n    return this.isSelectable;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    // if (this.vecSelected !== -1) {\n    //   this.pts[this.vecSelected].TranslateByMouseEventData(e);\n    //   this.wrapping.UpdateProjection(this.GetVecs());\n    //   return;\n    // }\n    const xo = e.x - e.preX;\n    const yo = e.y - e.preY;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].vec.x += xo;\n      this.pts[i].vec.y += yo;\n    }\n    // this.wrapping.UpdateProjection(this.GetVecs());\n  }\n  public translate(x: number, y: number): void {\n    // if (this.vecSelected !== -1) {\n    //     this.pts[this.vecSelected].Translate(e);\n    //     return;\n    // }\n    // let xo = e.x - e.preX;\n    // let yo = e.y - e.preY;\n    // for (let i = 0; i < this.pts.length; ++i) {\n    //     this.pts[i].vec.x += xo; this.pts[i].vec.y += yo;\n    //     this.pts[i].UpdateGoeVec();\n    // }\n  }\n  public get isSelected() {\n    return this.isSelectedValue;\n  }\n  public set isSelected(v: boolean) {\n    this.isSelectedValue = v;\n    for (const p of this.pts) {\n      p.isRenderable = v;\n    }\n    this.scene.annotationInstance.io.eventListenerAnnotation.selectionStack(this.toJSON());\n  }\n  public get isHover() {\n    return this.isHoverValue;\n  }\n  public set isHover(v: boolean) {\n    if (this.isUnderConstruction) {\n      return;\n    }\n    if (this.isSelectedValue) {\n      return;\n    }\n    for (const p of this.pts) {\n      p.isRenderable = v;\n    }\n    this.isHoverValue = v;\n    if (this.isHoverValue && !this.isHoverPre) {\n      for (let i = 0; i < this.pts.length; ++i) {\n        this.pts[i].renderer.t = 0.0;\n      }\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    } else if (!this.isHoverValue && this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    }\n    this.isHoverPre = this.isHoverValue;\n    if (!v) {\n      this.needEmitHoverPost = true;\n      this.hidePopUpSummary();\n    }\n  }\n  public get IsCapture() {\n    return this.isCapturedValue;\n  }\n  public set IsCapture(v: boolean) {\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].isCapturedValue = v;\n    }\n  }\n  // GetRGeometry(): RGeometry | undefined {\n  //     let temp: RGeometry = new RGeometry();\n  //     temp.id = this.id;\n  //     temp.type = this.type;\n  //     temp.isSel = this.isSelected;\n  //     temp.isHide = this.isRenderable;\n  //     temp.isHover = this.isHover;\n  //     temp.x = this.V.x;\n  //     temp.y = this.V.y;\n  //     temp.style = this.style;\n  //     return temp;\n  // }\n  public getNode() {\n    const v: NVector3[] = [];\n    for (let ii = 0; ii < this.pts.length; ++ii) {\n      v.push(this.pts[ii].vec);\n    }\n    return v;\n  }\n  public mouseRightClick() {\n    if (this.isClosed) {\n      this.isFill = !this.isFill;\n    }\n  }\n  public toJSON(): IOGeometry | undefined {\n    const p = new IOGeometry(\n      this.id,\n      this.type,\n      this.isSelectedValue,\n      this.isHoverValue,\n      this.isHiddenValue\n    );\n    p.pushNode(this.getNode());\n    return p;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D): void {\n    this.renderer.renderPost(ctx);\n  }\n  public computeBoundingVecsAndCenterVec() {\n    this.vecs = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.vecs.push(this.pts[i].vec);\n    }\n    this.vec = getCenterVecFromVecs(this.vecs);\n    // this.vecsBound = NVector3.GetMinMaxVecFromVecs(this.vecs);\n  }\n}\n","import { NVector3, MouseEventData } from '../../../../../lib';\nimport { Scene } from '../../../Scene';\nimport { APoint } from '../../GeometryAnnotation/FamilyPoint/Base/APoint';\nimport { AGeometryBase } from './AGeometryBase';\nexport class ALineBase extends AGeometryBase {\n  public p0: APoint;\n  public p1: APoint;\n  public pm: APoint;\n  public edges: ALineBase;\n  constructor(scene: Scene) {\n    super(scene);\n    this.vec = new NVector3(0, 0, 0);\n  }\n  public get v(): NVector3 {\n    const x = (this.p0.vec.x + this.p1.vec.y + this.pm.vec.x) / 3.0;\n    const y = (this.p0.vec.x + this.p1.vec.y + this.pm.vec.x) / 3.0;\n    const z = (this.p0.vec.z + this.p1.vec.z + this.pm.vec.z) / 3.0;\n    this.vec = new NVector3(x, y, z);\n    return this.vec;\n  }\n  public set v(v: NVector3) {\n    this.vec = v;\n  }\n  public getLog(): string {\n    // throw new Error(\"Method not implemented.\");\n    return '';\n  }\n  public renderPost(ctx: CanvasRenderingContext2D): void {\n    // throw new Error(\"Method not implemented.\");\n  }\n  public isMouseInside(x: number, y: number): boolean {\n    // throw new Error(\"Method not implemented.\");\n    return false;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    // throw new Error(\"Method not implemented.\");\n  }\n  public translate(x: number, y: number): void {\n    // throw new Error(\"Method not implemented.\");\n  }\n  public remove(): void {\n    // throw new Error(\"Method not implemented.\");\n  }\n  public hide(): void {\n    // throw new Error(\"Method not implemented.\");\n  }\n}\n","import { AGeometryBase } from '../AGeometryBase';\nexport class InteractionComponent {\n  public geo: AGeometryBase;\n  constructor(geo: AGeometryBase) {\n    this.geo = geo;\n  }\n  public isMouseInside(x: number, y: number) {\n    return false;\n  }\n  public getLog() {\n    return '';\n  }\n  public hide(): void {\n    /* */\n  }\n}\n","import { getDistance2, NVector3, InteractionMode, MouseEventData } from '../../../../../../../lib';\nimport { InteractionComponent as _InteractionComponent } from '../../../../Common/Base/ComponentTemplate/InteractionComponent';\nimport { AArrow } from '../AArrow';\nexport class InteractionComponent extends _InteractionComponent {\n  public host: AArrow;\n  constructor(host: AArrow) {\n    super(host);\n    this.host = host;\n  }\n  public isMouseInside(x: number, y: number) {\n    if (this.host.isUnderConstruction === true || this.host.isUnderConstruction === undefined) {\n      return false;\n    }\n    if (\n      this.host.scene.annotationInstance.implementations.app.model.appCoreWrapper.appControllerStatus\n        .mode !== InteractionMode.Drawing\n    ) {\n      return false;\n    }\n    if (this.isMouseInsideByMath(x, y)) {\n      // if (this.IsMouseInsideByMath(x, y) || this.IsMouseInsideByMathDuplication(x, y) ) {\n      return true;\n    }\n    if (this.isMouseInsideByOffScreen(x, y)) {\n      return true;\n    }\n    return false;\n  }\n  private isMouseInsideByOffScreen(x: number, y: number) {\n    const c = this.host.scene.annotationInstance.geometryCommon.gcmdProcessing.isMouseInsideByOffScreen(\n      x - this.host.scene.annotationInstance.scene.paramsEditing.croppingMaskParams.x,\n      y - this.host.scene.annotationInstance.scene.paramsEditing.croppingMaskParams.y,\n      this.host.hashColor\n    );\n    if (c) {\n      this.host.isHover = true;\n      return true;\n    }\n    this.host.isHover = false;\n    return false;\n  }\n  private isMouseInsideByMath(x: number, y: number) {\n    // we need to apply offset value for projection.\n    x -= this.host.scene.annotationInstance.scene.paramsEditing.croppingMaskParams.x\n    y -= this.host.scene.annotationInstance.scene.paramsEditing.croppingMaskParams.y\n\n    this.host.computeCurve(0.3);\n\n    if (this.isInsideFirstAndLastCurves(x, y)) {\n      this.host.isHover = true;\n      return true;\n    }\n    this.host.isHover = false;\n    return false;\n  }\n  // IsMouseInsideByMathDuplication(x: number, y: number) {\n  //     this.ComputeCurve(0.3);\n  //     if (this.IsInsideFirstAndLastCurvesDupliation(x, y)) {\n  //         this.IsHover = true; return true;\n  //     } else { this.IsHover = false; return false; }\n  // }\n  private isInsideFirstAndLastCurves(x: number, y: number, r = 100) {\n    const pts = this.host.arrayVertexs;\n    const cp = this.host.arrayControlPoint;\n    for (let t = 0.0; t < 1.0; t += 0.001) {\n      // https://stackoverflow.com/questions/7801628/finding-a-point-on-a-b%C3%A9zier-curve-when-given-the-distance-from-the-start-point\n      const x0 =\n        Math.abs(Math.pow(1 - t, 3)) * pts[0] +\n        3 * Math.pow(1 - t, 2) * t * cp[0] +\n        3 * Math.abs(1 - t) * Math.pow(t, 2) * cp[0] +\n        Math.abs(Math.pow(t, 3)) * pts[2];\n      const y0 =\n        Math.abs(Math.pow(1 - t, 3)) * pts[1] +\n        3 * Math.pow(1 - t, 2) * t * cp[1] +\n        3 * Math.abs(1 - t) * Math.pow(t, 2) * cp[1] +\n        Math.abs(Math.pow(t, 3)) * pts[3];\n      const x1 =\n        Math.abs(Math.pow(1 - t, 3)) * pts[2] +\n        3 * Math.pow(1 - t, 2) * t * cp[2] +\n        3 * Math.abs(1 - t) * Math.pow(t, 2) * cp[2] +\n        Math.abs(Math.pow(t, 3)) * pts[4];\n      const y1 =\n        Math.abs(Math.pow(1 - t, 3)) * pts[3] +\n        3 * Math.pow(1 - t, 2) * t * cp[3] +\n        3 * Math.abs(1 - t) * Math.pow(t, 2) * cp[3] +\n        Math.abs(Math.pow(t, 3)) * pts[5];\n      const dis1 = getDistance2(new NVector3(x0, y0), new NVector3(x, y));\n      if (dis1 < r * this.host.scene.annotationInstance.activeCommandController.scaleGlobal) {\n        return true;\n      }\n      const dis = getDistance2(new NVector3(x1, y1), new NVector3(x, y));\n      if (dis < r * this.host.scene.annotationInstance.activeCommandController.scaleGlobal) {\n        return true;\n      }\n    }\n    return false;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    if (this.host.isRemove || !this.host.isRenderable || this.host.isHiddenValue) {\n      return;\n    }\n    const xo = e.x - e.preX;\n    const yo = e.y - e.preY;\n    this.host.p0.vec.x += xo;\n    this.host.p0.vec.y += yo;\n    this.host.p1.vec.x += xo;\n    this.host.p1.vec.y += yo;\n    this.host.pm.vec.x += xo;\n    this.host.pm.vec.y += yo;\n    // this.host.UpdateGeoVec();\n    // this.host.wrapping.UpdateProjection(this.host.vecs);\n  }\n  // private IsSelectedByWindow(vs: NVector3[]) {\n  //     if (IsInsideOfVecs(this.host.p0.vec, vs)) {\n  //         if (IsInsideOfVecs(this.host.pm.vec, vs)) {\n  //             if (IsInsideOfVecs(this.host.p1.vec, vs)) {\n  //                 return true;\n  //             }\n  //         }\n  //     }\n  //     return false;\n  // }\n  public getLog(): string {\n    const text =\n      'GUID : ' +\n      this.host.id +\n      '/' +\n      'TYPE : ' +\n      this.host.type.toString() +\n      '/' +\n      // 'PARENT : ' + this.host.edges[0].GetParentType()+\"<br>\"+\n      'POS : ' +\n      // this.host.p1.vec.ToString() +\n      '/' +\n      'SIZE : ' +\n      this.host.r +\n      ' pixel' +\n      '/' +\n      // 'STYLE : ' + this.host.style.toString() + '/' +\n      'IsSEL : ' +\n      this.host.isSelectedValue +\n      '/' +\n      'isSelable : ' +\n      this.host.isSelectable;\n    return text;\n  }\n  public hide(): void {\n    /* */\n  }\n}\n","import { GType, NVector3 } from '../../../../../../../lib';\nimport { RendererComponent as _RendererComponent } from '../../../../Common/Base/ComponentTemplate/RendererComponent';\nimport { AArrow } from '../AArrow';\nexport class RendererComponent extends _RendererComponent {\n  public host: AArrow;\n  private _isDash = false;\n  constructor(host: AArrow) {\n    super(host);\n    this.host = host;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D): void {\n    if (this.host.arrowScale !== this.host.scene.annotationInstance.customization.themeCurrent.arrow.scale) {\n      this.host.arrowScale = this.host.scene.annotationInstance.customization.themeCurrent.arrow.scale;\n    }\n    // this.interpolateColor.Update(); // we do not want to dim the color of the arrow\n    this.host.computeCurve();\n    if (\n      this.host.scene.annotationInstance.activeCommandController.acProperties.isPanning ||\n      this.host.scene.annotationInstance.activeCommandController.acProperties.isViewChanging\n    ) {\n      // this.host.wrapping.UpdateProjection(this.host.vecs);\n      // this.host.wrapping.UpdateProjectionShapes(this.host.vecs);\n      this.host.updateScaleByZoomLevel();\n    }\n    if (this.host.isUnderConstruction) {\n      this.host.computeMidPoint();\n    }\n    this.renderPostGeometry(ctx);\n  }\n  private renderPostGeometry(ctx: CanvasRenderingContext2D) {\n    this.drawSpline(ctx, this.host.arrayVertexs, this.host.arrayControlPoint);\n  }\n  private drawSpline(ctx: CanvasRenderingContext2D, APoints: number[], cps: number[]) {\n    const pts = APoints;\n    const cp = cps;\n    const n = pts.length;\n    const lineDashOffset = 3;\n    // let vecs = this.ComputeVecForArrow(new NVector3(pts[4], pts[5]), new NVector3(cp[2], cp[3]));\n    // let vecsOpposite = this.ComputeVecForArrow(new NVector3(pts[0], pts[1]), new NVector3(cp[0], cp[1]));\n    const ptVec = [this.host.p0.vec, this.host.p1.vec, this.host.pm.vec];\n\n    this.offscreenRender(pts, cp, n);\n    const preset = this.host.scene.annotationInstance.renderer.draw.shape.curve;\n    if (this.host.isHoverValue || this.host.isSelectedValue) {\n      // this.host.scene.annotationInstance.renderer.preset.drawingPreset.CenterPoint(ctx, this.host.vec.x, this.host.vec.y);\n      preset.curveQuadraticArrow(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        pts[0],\n        pts[1],\n        cp[0],\n        cp[1],\n        pts[2],\n        pts[3],\n        this.host.isHoverValue,\n        ptVec,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n        this.host.isSelectedValue,\n        this.host.styleComponent.state.themeColorId,\n        this._isDash,\n        lineDashOffset\n      );\n      preset.curveQuadraticArrow(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        pts[n - 2],\n        pts[n - 1],\n        cp[2 * n - 10],\n        cp[2 * n - 9],\n        pts[n - 4],\n        pts[n - 3],\n        this.host.isHoverValue,\n        ptVec,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n        this.host.isSelectedValue,\n        this.host.styleComponent.state.themeColorId,\n        this._isDash\n      );\n      preset.cArrowByTranslation(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        new NVector3(pts[4], pts[5]),\n        new NVector3(cp[2], cp[3]),\n        pts[4],\n        pts[5],\n        this.host.arrowScale,\n        this.host.styleComponent.renderStyle.scaleLocal * this.host.scene.annotationInstance.activeCommandController.scaleGlobal,\n        this.host.isHoverValue,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n        this.host.isSelectedValue,\n        this.host.styleComponent.state.themeColorId\n      );\n      if (this.host.type === GType.ARROW_DOUBLE) {\n        preset.cArrowByTranslation(\n          ctx,\n          this.host.styleComponent.renderStyle,\n          new NVector3(pts[0], pts[1]),\n          new NVector3(cp[0], cp[1]),\n          pts[0],\n          pts[1],\n          this.host.arrowScale,\n          this.host.styleComponent.renderStyle.scaleLocal * this.host.scene.annotationInstance.activeCommandController.scaleGlobal,\n          true,\n          this.host.isGrayColor,\n          this.host.visibilityValue,\n          this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n          this.host.isSelectedValue,\n          this.host.styleComponent.state.themeColorId\n        );\n      }\n      this.tOver += this.host.scene.annotationInstance.renderer.dt;\n      this.tDown1 = 0;\n      this.host.isLeave = true;\n    } else {\n      preset.curveQuadraticArrow(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        pts[0],\n        pts[1],\n        cp[0],\n        cp[1],\n        pts[2],\n        pts[3],\n        this.host.isHoverValue,\n        ptVec,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        1.0,\n        this.host.isSelectedValue,\n        this.host.styleComponent.state.themeColorId,\n        this._isDash,\n        lineDashOffset\n      );\n      preset.curveQuadraticArrow(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        pts[n - 2],\n        pts[n - 1],\n        cp[2 * n - 10],\n        cp[2 * n - 9],\n        pts[n - 4],\n        pts[n - 3],\n        this.host.isHoverValue,\n        ptVec,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        1.0,\n        this.host.isSelectedValue,\n        this.host.styleComponent.state.themeColorId,\n        this._isDash\n      );\n      preset.cArrowByTranslation(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        new NVector3(pts[4], pts[5]),\n        new NVector3(cp[2], cp[3]),\n        pts[4],\n        pts[5],\n        this.host.arrowScale,\n        this.host.styleComponent.renderStyle.scaleLocal * this.host.scene.annotationInstance.activeCommandController.scaleGlobal,\n        this.host.isHoverValue,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        1.0,\n        this.host.isSelectedValue,\n        this.host.styleComponent.state.themeColorId\n      );\n      if (this.host.type === GType.ARROW_DOUBLE) {\n        preset.cArrowByTranslation(\n          ctx,\n          this.host.styleComponent.renderStyle,\n          new NVector3(pts[0], pts[1]),\n          new NVector3(cp[0], cp[1]),\n          pts[0],\n          pts[1],\n          this.host.arrowScale,\n          this.host.styleComponent.renderStyle.scaleLocal * this.host.scene.annotationInstance.activeCommandController.scaleGlobal,\n          false,\n          this.host.isGrayColor,\n          this.host.visibilityValue,\n          1.0,\n          this.host.isSelectedValue,\n          this.host.styleComponent.state.themeColorId\n        );\n      }\n      this.tOver = 0;\n    }\n  }\n  private offscreenRender(pts: number[], cp: number[], n: number) {\n    this.host.scene.annotationInstance.renderer.offscreen.curveQuadraticArrowOffScreen(\n      this.host.scene.annotationInstance.renderer.ctxOffscreen,\n      this.host.styleComponent.renderStyle,\n      this.host.hashColor,\n      pts[0],\n      pts[1],\n      cp[0],\n      cp[1],\n      pts[2],\n      pts[3]\n    );\n    this.host.scene.annotationInstance.renderer.offscreen.curveQuadraticArrowOffScreen(\n      this.host.scene.annotationInstance.renderer.ctxOffscreen,\n      this.host.styleComponent.renderStyle,\n      this.host.hashColor,\n      pts[n - 2],\n      pts[n - 1],\n      cp[2 * n - 10],\n      cp[2 * n - 9],\n      pts[n - 4],\n      pts[n - 3]\n    );\n    // if (this.host.vecOthers && this.host.vecOthers.length > 0) { this.host.scene.annotationInstance.renderer.preset.drawingPresetOffscreen.PolygonOffScreenByVecs(this.host.hashColor, this.host.vecOthers); }\n  }\n  // private ComputeVecForArrow(v: NVector3, rv: NVector3) {\n  //   let cen = new NVector3(v.x, v.y, 0);\n  //   let vecs: NVector3[] = [];\n  //   let height = 7.5 * this.host.scene.annotationInstance.themeRenderStyle.themeCurrent.arrow.scale; // 7.5;\n  //   let depth = -12 * this.host.scene.annotationInstance.themeRenderStyle.themeCurrent.arrow.scale; // 12;\n  //   vecs.push(new NVector3(cen.x - (height * this.host.arrowScale), cen.y - (height * this.host.arrowScale), 0));\n  //   vecs.push(new NVector3(cen.x - (height * this.host.arrowScale), cen.y + (height * this.host.arrowScale), 0));\n  //   vecs.push(new NVector3(cen.x + (depth * this.host.arrowScale), cen.y, 0));\n  //   let degree = NVector3.GetRotationByWorldCoodinateByTwo(NVector3.DeepCopy(v), NVector3.DeepCopy(rv));\n  //   console.log(degree);\n  //   return NVector3.RotateVecsLoal(vecs, -(degree - 180));\n  // }\n  public get isDash() {\n    return this._isDash;\n  }\n  public set isDash(v: boolean) {\n    this._isDash = v;\n  }\n}\n","import {\n  convertDashEnumToArray,\n  LineTypeId,\n  ThemeColorId,\n} from '../../../../../Customization/ThemeRenderStyle/Utility';\nimport { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { AArrow } from '../AArrow';\nexport class StyleComponent extends _StyleComponent {\n  public geo: AArrow;\n  constructor(geo: AArrow) {\n    super(geo);\n    this.updateStyle();\n    this.updateColor();\n  }\n  public updateStyle() {\n    if (!this.isCustom) {\n      this.state.themeColorId = ThemeColorId.TitleColor;\n      this.tempColorRgba = [0, 0, 0, 1];\n      this.isCustom = true;\n      RenderStyle.updateRenderStyleArrow(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n      RenderStyle.updateRenderStyleArrowNode(\n        this.renderStyleNode,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n      this.updateStyleNode();\n    }\n    // if(this.geo.scene.annotationInstance.activeCommandController.acProperties.accentColor) {\n    //   this.UpdateAccentColor();\n    // }\n  }\n  public updateColor(color: number[] | undefined = undefined) {\n    this.isCustom = true;\n    if (color === undefined) {\n      color = this.geo.scene.annotationInstance.activeCommandController.activeColorController.activeColor;\n    }\n    // RenderStyle.updateRenderColorRPointCustom(\n    //   this.renderStyle,\n    //   this.geo.scene.annotationInstance.customization.themeCurrent,\n    //   color\n    // );\n\n    RenderStyle.updateRenderColorArrowCustom(\n      this.renderStyle,\n      this.geo.scene.annotationInstance.customization.themeCurrent,\n      color\n    );\n    RenderStyle.updateRenderColorArrowNodeCustom(\n      this.renderStyleNode,\n      this.geo.scene.annotationInstance.customization.themeCurrent,\n      color\n    );\n    this.updateStyleNode();\n    this.tempColorRgba = color;\n  }\n  public updateAccentColor() {\n    // console.log('update color');\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public updateStyleCustom(style: any): boolean {\n    if (style.colorRgba) {\n      this.tempColorRgba = style.colorRgba;\n    }\n    if (style.scale) {\n      this.renderStyle.scaleLocal = style.scale;\n      this.state.scale = style.scale;\n    }\n    if (style.width) {\n      this.state.width = style.width;\n    }\n    if (style.color !== undefined) {\n      this.state.themeColorId = style.color as ThemeColorId;\n    }\n    if (style.lineDash !== undefined) {\n      this.state.lineTypeId = style.lineDash as LineTypeId;\n      this.renderStyle.dash = convertDashEnumToArray(style.lineDash);\n      // this.isCustom = true;\n      // return\n    }\n\n    if (style.colorRgba.length > 0) {\n      RenderStyle.updateRenderStyleArrowCustom(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent,\n        style\n      );\n      RenderStyle.updateRenderStyleArrowNodeCustom(\n        this.renderStyleNode,\n        this.geo.scene.annotationInstance.customization.themeCurrent,\n        style\n      );\n      this.updateStyleNode();\n    }\n    this.isCustom = true;\n    return true;\n  }\n  private updateStyleNode() {\n    if (this.geo.pts) {\n      for (let i = 0; i < this.geo.pts.length; ++i) {\n        this.geo.pts[i].styleComponent.updateStyleForNode(this.renderStyleNode);\n      }\n    }\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public toJson(): any | undefined {\n    if (!this.isCustom) {\n      return undefined;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const output: any = {\n      width: this.state.width,\n      scale: this.renderStyle.scaleLocal,\n      colorRgba: this.tempColorRgba, // this is necessary for updating state on React side\n    };\n    // if (this.tempBackgroundColor.length > 0) {\n    //   output.backgroundColor = this.tempBackgroundColor;\n    // }\n    // if (this.tempTextColor.length > 0) {\n    //   output.textColor = this.tempTextColor;\n    // }\n    if (this.state.lineTypeId !== LineTypeId.Continuous) {\n      output.lineDash = this.state.lineTypeId;\n    }\n    if (this.state.themeColorId !== ThemeColorId.TitleColor) {\n      output.color = this.state.themeColorId;\n    }\n    // console.log(output);\n    return output;\n  }\n}\n","import { MouseEventData } from '../../../../../../../lib';\nimport { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { APoint } from '../../../FamilyPoint/Base/APoint';\nimport { AArrow } from '../AArrow';\nexport class TransformationComponent extends _StyleComponent {\n  public host: AArrow;\n  constructor(host: AArrow) {\n    super(host);\n    this.host = host;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    // console.log(e);\n    if (this.host.isRemove || !this.host.isRenderable || this.host.isHiddenValue) {\n      return;\n    }\n    // if (this.translateForOther(e)) {\n    //   // this.host.wrapping.UpdateProjection(this.host.vecs);\n    //   return;\n    // }\n\n    if (this.host.pm.isHoverValue) {\n      // translate mid point when the arrow is selected.\n      this.host.pm.translateByMouseEventData(e);\n      return;\n    }\n\n    const xo = e.x - e.preX;\n    const yo = e.y - e.preY;\n    this.host.p0.vec.x += xo;\n    this.host.p0.vec.y += yo;\n\n    this.translateForTextLeaderline(e, this.host.p0);\n\n    this.host.p1.vec.x += xo;\n    this.host.p1.vec.y += yo;\n\n    this.translateForTextLeaderline(e, this.host.p1);\n\n    this.host.pm.vec.x += xo;\n    this.host.pm.vec.y += yo;\n\n    this.translateForTextLeaderline(e, this.host.pm);\n\n    // this.host.p0.TranslateByMouseEventData(e);\n    // this.host.pm.TranslateByMouseEventData(e);\n    // this.host.p1.TranslateByMouseEventData(e);\n\n    // this.host.UpdateGeoVec();\n    // this.host.wrapping.UpdateProjection(this.host.vecs);\n  }\n  private translateForTextLeaderline(e: MouseEventData, p: APoint) {\n    if (p.textLeaderline) {\n      p.textLeaderline.translateByMouseEventData(e);\n      if (p.textLeaderline.leaderline) {\n        // if (this.wrapping.needWrappingToLeft || this.wrapping.needWrappingToRight) {\n        p.textLeaderline.leaderline.v2.x = p.vec.x;\n        p.textLeaderline.leaderline.v2.y = p.vec.y;\n        // }\n        return true;\n      }\n    }\n    return false;\n  }\n  // private translateForOther(e: MouseEventData) {\n  /*\n    // console.log('proj for dupl');\n    const theMisDis = Number.MAX_SAFE_INTEGER;\n    const theMinIndex = -1;\n    // const m = new NVector3(e.x, e.y);\n    // for (let i = 0; i < this.host.wrapping.vsOther.length; ++i) {\n    //   let dis = Distance(this.host.wrapping.vsOther[i], m);\n    //   if (dis < theMisDis) {\n    //     theMisDis = dis;\n    //     if (theMisDis < 10) {\n    //       theMinIndex = i;\n    //     }\n    //   }\n    // }\n    // console.log(theMinIndex);\n    if (theMinIndex > 0) {\n      const xo = e.x - e.preX;\n      const yo = e.y - e.preY;\n      if (theMinIndex === 0) {\n        this.host.p0.vec.x += xo;\n        this.host.p0.vec.y += yo;\n      } else if (theMinIndex === 1) {\n        this.host.pm.vec.x += xo;\n        this.host.pm.vec.y += yo;\n      } else if (theMinIndex === 2) {\n        this.host.p1.vec.x += xo;\n        this.host.p1.vec.y += yo;\n      }\n      // // console.log(theMinIndex);\n      // this.host.UpdateGeoVec();\n      // this.host.wrapping.UpdateProjection(this.vecs);\n      return true;\n    }\n    return false;\n    */\n  // }\n  public translate(x: number, y: number): void {\n    /* */\n  }\n  public move(x: number, y: number) {\n    if (this.host.isRemove || !this.host.isRenderable || this.host.isHiddenValue) {\n      return;\n    }\n    this.host.computeCenterVec();\n    const xo = x - this.host.vec.x;\n    const yo = y - this.host.vec.y;\n    for (let i = 0; i < this.host.pts.length; ++i) {\n      this.host.pts[i].vec.x += xo;\n      this.host.pts[i].vec.y += yo;\n      // this.host.pts[i].UpdateGoeVec();\n    }\n  }\n}\n","import { IOGeometry } from '../../../../../../lib/Extended/GeometryUtility';\nimport {\n  MouseEventData,\n  getCenterVecFromVecs,\n  isInsideOfVecs,\n  midVec,\n  NVector3,\n  GType,\n} from '../../../../../../lib';\nimport { Scene } from '../../../../Scene';\nimport { ALineBase } from '../../../Common/Base/ALineBase';\nimport { ACurve } from '../../FamilyCurve/ACurveWrapper/ACurve';\nimport { APoint } from '../../FamilyPoint/Base/APoint';\nimport { InteractionComponent } from './Component/InteractionComponent';\nimport { RendererComponent } from './Component/RendererComponent';\nimport { StyleComponent } from './Component/StyleComponent';\nimport { TransformationComponent } from './Component/TransformationComponent';\nexport class LineConstruction {\n  public v0: APoint | undefined;\n  public v1: APoint | undefined;\n  public geo: AArrow | undefined;\n  constructor() {\n    /* */\n  }\n}\nexport class AArrow extends ALineBase {\n  public static isDone = false;\n  public static split = false;\n  public static condition: LineConstruction = new LineConstruction();\n  public renderer: RendererComponent;\n  public tVec: NVector3;\n  public p0: APoint;\n  public p1: APoint;\n  public pm: APoint;\n  public vecs: NVector3[];\n  public lineWidth: number;\n  public curveWeight: number;\n  public pts: APoint[];\n  public arrayVertexs: number[];\n  public arrayWeight: number[];\n  public arrayControlPoint: number[];\n  public arrowScale: number;\n  // ..................................... projection\n  public vecSelected = -1;\n  private numSelectionWhenConstruction = 0;\n  static findAtPoint(scene: Scene, e: MouseEventData) {\n    for (let i = scene.listAArrow.length - 1; i >= 0; --i) {\n      if (scene.listAArrow[i].isSelectable && scene.listAArrow[i].isMouseInside(e.x, e.y)) {\n        return scene.listAArrow[i];\n      }\n    }\n    return undefined;\n  }\n  static computeOver(scene: Scene, e: MouseEventData) {\n    const cl = AArrow.findAtPoint(scene, e);\n    if (cl !== undefined) {\n      cl.isHoverValue = true;\n    }\n  }\n  static getLength(scene: Scene, type: GType) {\n    let i = scene.listAArrow.length;\n    let count = 0;\n    while (i--) {\n      if (scene.listAArrow[i].type === type) {\n        count += 1;\n      }\n    }\n    return count;\n  }\n  static getLengthSelection(scene: Scene, type: GType) {\n    let i = scene.listAArrow.length;\n    let count = 0;\n    while (i--) {\n      if (scene.listAArrow[i].isSelected && scene.listAArrow[i].type === type) {\n        count += 1;\n      }\n    }\n    return count;\n  }\n  // ............................................................... construction\n  static fromJSON(scene: Scene, g: IOGeometry, isUndo = false, isDeepCopy = false, single = false) {\n    const p0 = APoint.getNodeFromJSON(scene, g.nodes[0], isUndo);\n    const pm = APoint.getNodeFromJSON(scene, g.nodes[1], isUndo);\n    const p1 = APoint.getNodeFromJSON(scene, g.nodes[2], isUndo);\n    p0.type = GType.ANODE;\n    pm.type = GType.AMIDPOINT;\n    p1.type = GType.ANODE;\n    let geo: AArrow;\n    if (single) {\n      if (isUndo) {\n        geo = new AArrow(scene, p0, p1, isUndo, GType.ARROW_SINGLE);\n      } else {\n        geo = new AArrow(scene, p0, p1, false, GType.ARROW_SINGLE);\n      }\n    } else {\n      if (isUndo) {\n        geo = new AArrow(scene, p0, p1, isUndo, GType.ARROW_DOUBLE);\n      } else {\n        geo = new AArrow(scene, p0, p1, false, GType.ARROW_DOUBLE);\n      }\n    }\n\n    geo.pm.vec.x = pm.vec.x;\n    geo.pm.vec.y = pm.vec.y;\n    pm.remove();\n    if (isDeepCopy) {\n      geo.id = scene.getUUID();\n    } else {\n      geo.id = g.id;\n    }\n\n    geo.isUnderConstruction = false;\n    geo.numSelectionWhenConstruction = 2; // make sure for open the modification panel\n\n    geo.isHover = false;\n    geo.pm.type = GType.AMIDPOINT;\n\n    // eslint:disable-next-line:no-string-literal\n    if (g.data['isDash']) {\n      geo.renderer.isDash = g.data['isDash'] as boolean;\n    }\n    if (g.styles) {\n      geo.updateStyleCustom(g.styles);\n    }\n\n    geo.computeCenterVec();\n    geo.initVecsHistory();\n    if (!isUndo) {\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n    }\n    AArrow.condition.v0 = undefined;\n    AArrow.condition.v1 = undefined;\n    AArrow.condition.geo = undefined;\n  }\n  static fromSmartDrawing(scene: Scene, vs: NVector3[], type: GType = GType.ARROW_SINGLE) {\n    AArrow.getRectByVecs(scene, vs, type);\n  }\n  static getRectByVecs(scene: Scene, vs: NVector3[], type: GType = GType.ARROW_SINGLE) {\n    const isUndo = false;\n    const v0 = vs[0];\n    const v1 = vs[vs.length - 1];\n\n    const p0 = new APoint(scene, v0.x, v0.y, 0, isUndo, GType.ANODE);\n    const p1 = new APoint(scene, v1.x, v1.y, 0, isUndo, GType.ANODE);\n\n    const geo = new AArrow(scene, p0, p1, isUndo, type);\n    geo.isSelected = geo.isHover = geo.isUnderConstruction = false;\n\n    scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(geo.toJSON());\n  }\n  static drawShadow(scene: Scene, e: MouseEventData, consType: GType) {\n    if (AArrow.condition.geo === undefined) {\n      const p2 = new APoint(scene, e.x, e.y, 0);\n      p2.isSelectable = false;\n      if (consType === GType.ARROW_SINGLE && AArrow.condition.v0 !== undefined) {\n        AArrow.condition.geo = new AArrow(\n          scene,\n          AArrow.condition.v0,\n          p2,\n          false,\n          GType.ARROW_SINGLE\n        );\n      }\n      if (consType === GType.ARROW_DOUBLE && AArrow.condition.v0 !== undefined) {\n        AArrow.condition.geo = new AArrow(\n          scene,\n          AArrow.condition.v0,\n          p2,\n          false,\n          GType.ARROW_DOUBLE\n        );\n      }\n      if (AArrow.condition.geo !== undefined) {\n        AArrow.condition.geo.isSelectable = false;\n      }\n    } else {\n      if (AArrow.condition.geo.p1 !== undefined) {\n        AArrow.condition.geo.p1.move(e.x, e.y);\n      }\n    }\n  }\n  static getLine(scene: Scene, e: MouseEventData, consType: GType = GType.ARROW_SINGLE) {\n    if (AArrow.condition.v0 === undefined) {\n      AArrow.condition.v0 = new APoint(scene, e.x, e.y);\n      return;\n    } else if (AArrow.condition.v0 !== undefined) {\n      if (AArrow.condition.geo === undefined) {\n        return;\n      }\n      AArrow.condition.geo.p1.move(e.x, e.y);\n      AArrow.condition.geo.computeMidPoint();\n\n      AArrow.condition.geo.isSelectable = true;\n      AArrow.condition.geo.isUnderConstruction = false;\n      AArrow.condition.geo.isSelected = false;\n      AArrow.condition.geo.isCaptured = false;\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(\n        AArrow.condition.geo.toJSON()\n      );\n      // AArrow.condition.v0 = undefined; AArrow.condition.v1 = undefined; AArrow.condition.geo = undefined;\n      return;\n    }\n  }\n\n  static getLineByPt(scene: Scene, p: APoint) {\n    if (AArrow.condition.v0 === undefined && AArrow.condition.v1 === undefined) {\n      AArrow.condition.v0 = new APoint(scene, p.vec.x, p.vec.y, p.vec.z);\n      if (AArrow.split) {\n        AArrow.condition.v0.vec = p.vec;\n      } else {\n        p.remove();\n      }\n      return;\n    }\n    // if(AArrow.condition.v0!==null && AArrow.condition.v1===null) {\n    if (AArrow.condition.geo !== undefined && AArrow.condition.geo.p1 !== undefined) {\n      AArrow.condition.geo.p1.move(p.vec.x, p.vec.y);\n    }\n    if (AArrow.condition.geo !== undefined) {\n      AArrow.condition.geo.isSelectable = true;\n      AArrow.condition.geo.isUnderConstruction = false;\n    }\n    if (p.type === GType.CNODE) {\n      if (AArrow.split && AArrow.condition.geo !== undefined) {\n        AArrow.condition.geo.p1.vec = p.vec;\n      }\n    } else if (p.type === GType.APOINT) {\n      p.remove();\n    }\n    // AArrow.condition.v0 = undefined; AArrow.condition.geo = undefined;\n    return;\n  }\n  static cancel() {\n    if (AArrow.condition.geo !== undefined) {\n      AArrow.condition.geo.remove();\n    }\n    AArrow.condition.v0 = undefined;\n    AArrow.condition.v1 = undefined;\n    AArrow.condition.geo = undefined;\n  }\n\n  // .................................................................... end implementation\n  static mouseDown(scene: Scene, e: MouseEventData, gType: GType) {\n    // console.log(AArrow.isDone);\n    // console.log(';;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;');\n    // console.log(e);\n    if (AArrow.condition.geo !== undefined) {\n      if (scene.capture !== undefined && scene.capture.type === GType.APOINT) {\n        AArrow.getLineByPt(scene, scene.capture as APoint);\n      } else {\n        AArrow.getLine(scene, e, gType);\n      }\n      // AArrow.condition.geo.IsSelected = false;\n      AArrow.condition.geo.computeCenterVec();\n      AArrow.condition.geo.isUnderConstruction = false;\n\n      // AArrow.condition.geo.IsHover = true;\n      scene.Capture = AArrow.condition.geo;\n      AArrow.condition.geo.isSelected = true;\n\n      AArrow.condition.v0 = undefined;\n      AArrow.condition.v1 = undefined;\n      AArrow.condition.geo = undefined;\n\n      // AArrow.isDone = true; // with keeping making the arrow\n      AArrow.isDone = false; // this is return to ac None Mode, otherwise db click needed\n      scene.annotationInstance.activeCommandController.acProperties.deselectNeeded = false;\n      scene.annotationInstance.activeCommandController.goToACMode();\n    }\n    if (AArrow.condition.geo) {\n      this.drawShadow(scene, e, gType);\n    }\n  }\n  static mouseLeftClick(scene: Scene, e: MouseEventData, gType: GType) {\n    // console.log(AGeometryCommon.capture);\n    if (AArrow.isDone) {\n      AArrow.isDone = false;\n      return;\n    }\n    if (scene.capture !== undefined) {\n      if (scene.capture.type === GType.APOINT && scene.capture !== undefined) {\n        AArrow.getLineByPt(scene, scene.capture as APoint);\n        AArrow.isDone = false;\n      }\n    }\n\n    if (AArrow.condition.geo === undefined) {\n      AArrow.getLine(scene, e, gType);\n      AArrow.isDone = false;\n    }\n    AArrow.drawShadow(scene, e, gType);\n\n    // console.log(scene.annotationInstance.activeCommandController.type);\n    // scene.annotationInstance.scene.Capture = undefined;\n    // scene.annotationInstance.geometryCommon.DeSelecteAllObjects();\n  }\n  static mouseMove(scene: Scene, e: MouseEventData, gType: GType) {\n    if (AArrow.condition.v0 !== undefined) {\n      AArrow.drawShadow(scene, e, gType);\n    }\n  }\n  static mouseUp(e: MouseEventData) {\n    // if (AArrow.condition.v0 && AArrow.condition.v1) { AArrow.isDone = true; }\n  }\n  constructor(\n    scene: Scene,\n    p0: APoint,\n    p1: APoint,\n    isUndo = false,\n    type: GType = GType.ARROW_SINGLE\n  ) {\n    super(scene);\n    this.isUndo = isUndo;\n    this.type = type;\n    this.p0 = p0;\n    this.p1 = p1;\n    const mv = midVec(this.p0.vec, this.p1.vec);\n    this.pm = new APoint(scene, mv.x, mv.y, mv.z);\n    this.p0.type = GType.ANODE;\n    this.pm.type = GType.ANODE;\n    this.p1.type = GType.ANODE;\n    this.vecs = [this.p0.vec, this.pm.vec, this.p1.vec];\n    this.isMove = true;\n    this.tVec = new NVector3(0, 0, 0);\n\n    this.initComponent();\n    this.initAArow();\n  }\n  private initComponent() {\n    this.transformation = new TransformationComponent(this);\n    this.interaction = new InteractionComponent(this);\n    this.styleComponent = new StyleComponent(this);\n    this.renderer = new RendererComponent(this);\n  }\n  private initAArow(): void {\n    this.computeCenterVec();\n    this.p0.addEdge(this);\n    this.pm.addEdge(this);\n    this.p1.addEdge(this);\n    this.pts = [this.p0, this.pm, this.p1];\n    this.arrowScale = 1;\n    this.lineWidth = 5;\n    this.curveWeight = 0.5;\n    // this.geoVec.w = 0.5;\n\n    this.scene.addAArrow(this);\n  }\n  public computeMidPoint() {\n    const mv = midVec(this.p0.vec, this.p1.vec);\n    this.pm.vec.x = mv.x; // + 5;\n    this.pm.vec.y = mv.y; // + 5;\n    // this.pm.UpdateGoeVec();\n    // console.log(this.pm.vec);\n    this.pm.isPointMid = true;\n    this.pm.type = GType.AMIDPOINT;\n  }\n  // private ComputeVecForArrow(v: NVector3, rv: NVector3) {\n  //     let cen = new NVector3(v.x, v.y, 0);\n  //     let vecs: NVector3[] = [];\n  //     let ss = 7.5; // 7.5;\n  //     let cs =  12; // 12;\n  //     vecs.push(new NVector3(cen.x - (ss * this.arrowScale), cen.y - (ss * this.arrowScale), 0));\n  //     vecs.push(new NVector3(cen.x - (ss * this.arrowScale), cen.y + (ss * this.arrowScale), 0));\n  //     vecs.push(new NVector3(cen.x + (cs * this.arrowScale), cen.y, 0));\n  //     let degree = GetRotationByWorldCoodinateByTwo(DeepCopy(v), DeepCopy(rv));\n  //     return RotateVecsLoal(vecs, -(degree - 180));\n  // }\n  public computeVertex(vs: NVector3[]) {\n    const vertexs: number[] = [];\n\n    // we need to apply offset value for picking projected shapes.\n    const xOff = this.scene.paramsEditing.croppingMaskParams.x;\n    const yOff = this.scene.paramsEditing.croppingMaskParams.y;\n\n    for (const p of vs) {\n      vertexs.push(p.x - xOff, p.y - yOff);\n    }\n    return vertexs;\n  }\n  private computeWeight(w = 1) {\n    const weight: number[] = [];\n    for (let i = 0; i < this.pts.length; ++i) {\n      weight.push(w);\n    }\n    this.arrayWeight = weight;\n  }\n  public computeControlPoint(vert: number[]) {\n    const pts: number[] = [];\n    for (const ii of vert) {\n      pts.push(ii);\n    }\n    let arrayControlPoint: number[] = [];\n    for (let i = 0; i < pts.length - 4; i += 2) {\n      arrayControlPoint = arrayControlPoint.concat(\n        ACurve.getControlPoints(\n          pts[i],\n          pts[i + 1],\n          pts[i + 2],\n          pts[i + 3],\n          pts[i + 4],\n          pts[i + 5],\n          this.arrayWeight[i]\n        )\n      );\n    }\n    return arrayControlPoint;\n  }\n  public findClosestNode(x: number, y: number) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return undefined;\n    }\n    if (this.p0.isMouseInside(x, y)) {\n      return this.p0;\n    } else if (this.p1.isMouseInside(x, y)) {\n      return this.p1;\n    }\n    return undefined;\n  }\n  public computeCurve(weight = 0.5) {\n    this.arrayVertexs = this.computeVertex(this.getVecs());\n    this.computeWeight(weight);\n    this.arrayControlPoint = this.computeControlPoint(this.arrayVertexs);\n    this.computeCenterVec();\n  }\n  public computeCenterVec() {\n    const vs: NVector3[] = [this.p0.vec, this.p1.vec, this.pm.vec];\n    this.vec = getCenterVecFromVecs(vs);\n    return this.vec;\n  }\n  // ................................................... end compute curve\n  public getLog(): string {\n    return this.interaction.getLog();\n  }\n  // ................................................... compute curve\n  // https://stackoverflow.com/questions/2742610/closest-point-on-a-cubic-bezier-curve\n  //     public double getClosestPointToCubicBezier(double fx, double fy, int slices, int iterations, double x0, double y0, double x1, double y1, double x2, double y2, double x3, double y3) {\n  //     return getClosestPointToCubicBezier(iterations, fx, fy, 0, 1d, slices, x0, y0, x1, y1, x2, y2, x3, y3);\n  // }\n  public deepCopy(x: number, y: number) {\n    this.isSelected = false;\n    const p0 = this.p0.deepCopy() as APoint;\n    const p1 = this.p1.deepCopy() as APoint;\n    if (p0 && p1) {\n      const out = new AArrow(this.scene, p0, p1, false, this.type);\n      out.pm.vec.x = this.pm.vec.x;\n      out.pm.vec.y = this.pm.vec.y;\n      out.isUnderConstruction = false;\n      out.move(x, y);\n      out.emitAddStack();\n      return out;\n    }\n    return undefined;\n  }\n  public goToBlackhole() {\n    this.isSelectable = false;\n    this.needBlackhole = true;\n    this.p0.goToBlackhole();\n    this.pm.goToBlackhole();\n    this.p1.goToBlackhole();\n    // this.tVec = this.scene.paramsEditing.blackhole.v as NVector3;\n    // this.isAniAccel = true;\n  }\n  public move(x: number, y: number) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    this.computeCenterVec();\n    const xo = x - this.vec.x;\n    const yo = y - this.vec.y;\n    for (let i = 0; i < this.pts.length; ++i) {\n      this.pts[i].vec.x += xo;\n      this.pts[i].vec.y += yo;\n      // this.pts[i].UpdateGoeVec();\n    }\n  }\n  // private GetClosestPointToCubicBezier(iterations: number, fx: number, fy: number, start: number, end: number, slices: number, x0: number, y0: number, x1: number, y1: number, x2: number, y2: number, x3: number, y3: number): number {\n  //     if (iterations <= 0) { return (start + end) / 2; }\n  //     let tick: number = (end - start) / slices;\n  //     let x: number = 0, y: number = 0, dx: number = 0, dy: number = 0;\n  //     let best = 0;\n  //     let bestDistance = Number.MAX_VALUE; // Double.POSITIVE_INFINITY;\n  //     let currentDistance;\n  //     let t = start;\n  //     while (t <= end) {\n  //         x = (1 - t) * (1 - t) * x0 + 2 * (1 - t) * t * x1 + t * t * x2; // quad.\n  //         y = (1 - t) * (1 - t) * y0 + 2 * (1 - t) * t * y1 + t * t * y2; // quad.\n  //         dx = x - fx;\n  //         dy = y - fy;\n  //         dx *= dx;\n  //         dy *= dy;\n  //         currentDistance = dx + dy;\n  //         if (currentDistance < bestDistance) {\n  //             bestDistance = currentDistance;\n  //             best = t;\n  //         }\n  //         t += tick;\n  //     }\n  //     return this.GetClosestPointToCubicBezier(iterations - 1, fx, fy, Math.max(best - tick, start), Math.min(best + tick, end), slices, x0, y0, x1, y1, x2, y2, x3, y3);\n  // }\n  // private GetClosestPointToQuadBezier(iterations: number, fx: number, fy: number, start: number, end: number, slices: number, x0: number, y0: number, x1: number, y1: number, x2: number, y2: number): number {\n  //     if (iterations <= 0) { return (start + end) / 2; }\n  //     let tick: number = (end - start) / slices;\n  //     let x: number = 0, y: number = 0, dx: number = 0, dy: number = 0;\n  //     let best = 0;\n  //     let bestDistance = Number.MAX_VALUE; // Double.POSITIVE_INFINITY;\n  //     let currentDistance;\n  //     let t = start;\n  //     while (t <= end) {\n  //         x = (1 - t) * (1 - t) * x0 + 2 * (1 - t) * t * x1 + t * t * x2; // quad.\n  //         y = (1 - t) * (1 - t) * y0 + 2 * (1 - t) * t * y1 + t * t * y2; // quad.\n\n  //         dx = x - fx;\n  //         dy = y - fy;\n  //         dx *= dx;\n  //         dy *= dy;\n  //         currentDistance = dx + dy;\n  //         if (currentDistance < bestDistance) {\n  //             bestDistance = currentDistance;\n  //             best = t;\n  //         }\n  //         t += tick;\n  //     }\n  //     return this.GetClosestPointToQuadBezier(iterations - 1, fx, fy, Math.max(best - tick, end), Math.min(best + tick, start), slices, x0, y0, x1, y1, x2, y2);\n  // }\n  public getVecs() {\n    // let pv = this.pm.vec.Clone();\n    // pv.long = this.pm.vec.long + 0.1;\n    // pv.lat = this.pm.vec.lat + 0.1;\n    // pv.proX = this.pm.vec.proX;\n    // pv.proY = this.pm.vec.proY;\n\n    return [this.p0.vec, this.pm.vec, this.p1.vec];\n  }\n  public isSelectedByWindow(vs: NVector3[]) {\n    if (isInsideOfVecs(this.p0.vec, vs)) {\n      if (isInsideOfVecs(this.pm.vec, vs)) {\n        if (isInsideOfVecs(this.p1.vec, vs)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n  public isSelectedByCrossing(vs: NVector3[]) {\n    if (isInsideOfVecs(this.p0.vec, vs)) {\n      return true;\n    }\n    if (isInsideOfVecs(this.pm.vec, vs)) {\n      return true;\n    }\n    if (isInsideOfVecs(this.p1.vec, vs)) {\n      return true;\n    }\n    return false;\n  }\n  public isMouseInside(x: number, y: number) {\n    return this.interaction.isMouseInside(x, y);\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    this.transformation.translateByMouseEventData(e);\n  }\n  public remove(needEmit = true): void {\n    this.isSelectable = false;\n    this.isRenderable = false;\n    this.isRemove = true;\n    this.p0.deepRemove();\n    this.p1.deepRemove();\n    this.pm.deepRemove();\n\n    this.scene.removeAArrow(this);\n    this.scene.removeGeometry(this);\n\n    if (needEmit) {\n      const ioGeo = this.toJSON();\n      if (ioGeo) {\n        this.scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack([ioGeo]);\n      }\n    }\n  }\n  public hide(): void {\n    this.interaction.hide();\n  }\n  // .............................................................. io\n  public getNode() {\n    const v: NVector3[] = [];\n    v.push(this.p0.vec);\n    v.push(this.pm.vec);\n    v.push(this.p1.vec);\n    return v;\n  }\n  // .......................................................................... implementation\n  public get isSelected() {\n    return this.isSelectedValue;\n  }\n  public set isSelected(v: boolean) {\n    if (this.numSelectionWhenConstruction++ === 1) {\n      return;\n    } // SafeGuard for selecting allow after construction\n\n    if (\n      this.scene.capture === this &&\n      this.isMouseInside(\n        this.scene.annotationInstance.activeCommandController.m.x,\n        this.scene.annotationInstance.activeCommandController.m.y\n      )\n    ) {\n      this.isSelectedValue = true;\n      this.p0.isRenderable = true;\n      this.p1.isRenderable = true;\n      this.pm.isRenderable = true;\n    } else {\n      this.isSelectedValue = v;\n      this.p0.isRenderable = v;\n      this.p1.isRenderable = v;\n      this.pm.isRenderable = v;\n    }\n    this.scene.annotationInstance.io.eventListenerAnnotation.selectionStack(this.toJSON());\n  }\n  public get isHover() {\n    return this.isHoverValue;\n  }\n  public set isHover(v: boolean) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    if (this.isUnderConstruction) {\n      return;\n    }\n    this.isHoverValue = v;\n    if (this.isHoverValue && !this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    } else if (!this.isHoverValue && this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    }\n    this.isHoverPre = this.isHoverValue;\n    if (!this.isSelectedValue) {\n      this.p0.isRenderable = v;\n      this.p1.isRenderable = v;\n      this.pm.isRenderable = v;\n    }\n    if (!v) {\n      this.needEmitHoverPost = true;\n      this.hidePopUpSummary();\n    }\n  }\n  public get isHidden() {\n    return this.isHiddenValue;\n  }\n  public set isHidden(v: boolean) {\n    this.isHiddenValue = v;\n    this.p0.isHiddenValue = v;\n    this.p0.visibility = 0;\n    this.pm.isHiddenValue = v;\n    this.pm.visibility = 0;\n    this.p1.isHiddenValue = v;\n    this.p1.visibility = 0;\n    this.scene.annotationInstance.io.eventListenerAnnotation.hideStack(this.toJSON());\n  }\n  public get isCaptured() {\n    return this.isCapturedValue;\n  }\n  public set isCaptured(v: boolean) {\n    this.isCapturedValue = this.p0.isCapturedValue = this.pm.isCapturedValue = this.p1.isCapturedValue = v;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D): void {\n    this.renderer.renderPost(ctx);\n  }\n  // private GetVecsGeoAOA(vs: NVector3[]): number[][] { // array of array\n  //     let out: number[][] = [];\n  //     for (let i = 0; i < vs.length; ++i) {\n  //         let v: number[] = [vs[i].long, vs[i].lat];\n  //         out.push(v);\n  //     }\n  //     // console.log(out);\n  //     return out;\n  // }\n  // private DrawOthersCP(ctx: CanvasRenderingContext2D, vs: NVector3[]) {\n  //     this.scene.paramsEditing.draw.shape.curve.ArrowByVecNode(ctx, this.styleComponent.renderStyleNode, vs, this.isGrayColor, this.visibility, NumericalMotion.easeOutElastic2(this.renderer.tOver), this.isHover);\n  // }\n  public mouseRightClick() {\n    if (!this.scene.annotationInstance.implementations.app.CONFIG.LAB) {\n      return;\n    }\n    this.renderer.isDash = !this.renderer.isDash;\n    const json = this.toJSON();\n    if (json) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.transformStack([json]);\n    }\n  }\n  public mouseUp() {\n    // console.log('arrow up');\n    /* */\n  }\n  public toJSON(): IOGeometry | undefined {\n    const p = new IOGeometry(\n      this.id,\n      this.type,\n      this.isSelectedValue,\n      this.isHoverValue,\n      this.isHiddenValue\n    );\n    p.pushNode(this.getNode());\n\n    const style = this.styleComponent.toJson();\n    if (style) {\n      p.styles = style;\n    }\n    // {\n    //   scale: 1,\n    //   width: 2,\n    //   color: 'arrlow color id : themecolor1',\n    //   colorRgba: [1, 0, 0, 1],\n    //   lineDash: 'small',\n    //   dash: this.styleComponent.renderStyle.dash\n    // };\n    // console.log('pppppppppp');\n    // console.log(p);\n    return p;\n  }\n}\n","import { NVector3, InteractionMode } from '../../../../../../../lib';\nimport { ATextleaderlineWrapper } from '..';\nexport class TextLeaderlineDiv {\n  public offsetForTextDiv = 10;\n  public wrapper: ATextleaderlineWrapper;\n  public divTextAnchor: HTMLDivElement | undefined;\n  public divText: HTMLDivElement | undefined;\n  public vec: NVector3;\n  constructor(wrapper: ATextleaderlineWrapper) {\n    this.wrapper = wrapper;\n    this.showTextDiv();\n    const col = [255, 0, 0, 1]; // this.wrapper.styleComponent.renderStyle.colorA;\n    this.textCol = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n  }\n  public set textCol(v: string) {\n    // this._textCol = v;\n    if (this.divText) {\n      this.divText.style.color = 'black'; // this._textCol;\n    }\n  }\n  public updateDiv() {\n    if (this.divText) {\n      const scale = this.wrapper.scene.annotationInstance.customization.themeCurrent.textleaderline\n        .scale;\n      const width = (this.wrapper.v1.x - this.wrapper.v0.x) * scale;\n      const widthOffset = width * 0.5;\n\n      // left\n      if (scale === 1) {\n        this.divText.style.left =\n          this.wrapper.vecOffset.x + this.offsetForTextDiv * scale - widthOffset + 'px';\n      } else {\n        this.divText.style.left = this.wrapper.vecOffset.x - widthOffset + 'px';\n      }\n\n      // top\n      // this.wrapper.vUp.vec.y + Math.abs(this.wrapper.v1.y - this.wrapper.v0.y)  - this.heightRuntime;\n      this.divText.style.top =\n        this.wrapper.vUp.vec.y +\n        Math.abs(this.wrapper.v1.y - this.wrapper.v0.y) -\n        Math.abs(this.wrapper.v1.y - this.wrapper.v0.y) * 0.5 +\n        'px';\n\n      // const height = Math.abs(this.wrapper.v1.y - this.wrapper.v0.y);\n      // if (scale === 1 ) {\n      this.divText.style.top = this.wrapper.v0.y + this.offsetForTextDiv + 'px';\n      // } else {\n      //   const height = Math.abs(this.wrapper.v1.y - this.wrapper.v0.y) * scale;\n      //   const yy  = this.wrapper.vUp.vec.y + Math.abs(this.wrapper.v1.y - this.wrapper.v0.y)  - height;\n      //   this.divText.style.top = yy + 'px';\n      // }\n\n      this.divText.style.width = (this.wrapper.width - this.offsetForTextDiv * 2) * scale + 'px';\n    }\n    if (this.divTextAnchor) {\n      this.divTextAnchor.style.top = this.wrapper.v0.y - this.wrapper.offsetForTextEditor + 'px';\n      this.divTextAnchor.style.left = this.wrapper.v0.x + 'px';\n    }\n  }\n  public hideTextDiv() {\n    if (this.divText) {\n      this.wrapper.scene.annotationInstance.implementations.app.model.modelViewWrapper.div.removeChild(\n        this.divText\n      );\n    }\n    if (this.divTextAnchor) {\n      this.wrapper.scene.annotationInstance.implementations.app.model.modelViewWrapper.div.removeChild(\n        this.divTextAnchor\n      );\n    }\n    this.divText = undefined;\n    this.divTextAnchor = undefined;\n    this.wrapper.scene.annotationInstance.io.eventListenerAnnotation.hideTextStack(\n      this.wrapper.toJSON()\n    );\n  }\n  public showTextDiv() {\n    this.getDivBaseContainer();\n    this.getDivAnchor();\n    if (!this.wrapper.isUnderConstruction) {\n      this.wrapper.scene.annotationInstance.io.eventListenerAnnotation.showTextStack(\n        this.wrapper.toJSON()\n      );\n    }\n  }\n  public focusOnTextDiv() {\n    const divText = document.getElementById(`text-editor-` + this.wrapper.id);\n    if (divText) {\n      // console.log(divText);\n      // divText.focus();\n      this.wrapper.scene.annotationInstance.io.eventListenerAnnotation.startEditingText(\n        this.wrapper.toJSON()\n      );\n      this.wrapper.scene.annotationInstance.activeCommandController.IsTextEditing = true;\n    }\n  }\n  private getDivAnchor() {\n    const divTextAnchor = document.createElement('div') as HTMLDivElement;\n    divTextAnchor.id = 'text-toolbar-' + this.wrapper.id;\n    divTextAnchor.style.position = 'absolute';\n    divTextAnchor.style.height = '0px';\n    divTextAnchor.style.width = '0px';\n    divTextAnchor.style.backgroundColor = '#00ff00';\n    divTextAnchor.style.top = this.wrapper.v0.y - this.wrapper.offsetForTextEditor + 'px';\n    divTextAnchor.style.left = this.wrapper.v0.x + 'px';\n    this.divTextAnchor = divTextAnchor;\n    this.wrapper.scene.annotationInstance.implementations.app.model.modelViewWrapper.div.insertBefore(\n      this.divTextAnchor,\n      this.wrapper.scene.annotationInstance.graphicsCoreWrapper.canvasWrapper.aCanvasMask.canvas\n    );\n    return divTextAnchor;\n  }\n  private getDivBaseContainer() {\n    const divText = document.createElement('div');\n    divText.id = `text-editor-` + this.wrapper.id;\n    divText.style.position = 'absolute';\n    divText.style.textOverflow = 'false';\n    divText.style.minWidth = this.wrapper.widthMin - this.offsetForTextDiv * 2 + 'px';\n    divText.style.width = this.wrapper.width - this.offsetForTextDiv * 2 + 'px';\n    divText.style.left = this.wrapper.v0.x + this.offsetForTextDiv + 'px';\n    divText.style.top = this.wrapper.v0.y + this.offsetForTextDiv + 'px';\n    divText.onmousedown = () => {\n      if (\n        this.wrapper.scene.annotationInstance.implementations.app.model.appCoreWrapper\n          .appControllerStatus.mode !== InteractionMode.Drawing\n      ) {\n        return;\n      }\n      this.wrapper.scene.annotationInstance.activeCommandController.IsTextEditing = true;\n    };\n    divText.addEventListener('keydown', (e: KeyboardEvent) => {\n      if (this.wrapper && divText.clientHeight) {\n        this.wrapper.height = divText.clientHeight;\n        this.wrapper.updateBoundingBox();\n      }\n      if (divText.textContent) {\n        // this.textContent = divText.textContent;\n      }\n      this.wrapper.scene.annotationInstance.graphicsCoreWrapper.renderForce();\n    });\n    this.wrapper.scene.annotationInstance.implementations.app.model.modelViewWrapper.div.insertBefore(\n      divText,\n      this.wrapper.scene.annotationInstance.graphicsCoreWrapper.canvasWrapper.aCanvasMask.canvas\n    );\n    this.divText = divText;\n    return divText;\n  }\n}\n","import { getDistance, NVector3 } from '../../../../../../../lib';\nimport { ATextleaderlineWrapper } from '..';\nexport enum CATEXT_NODE_RENDER_TYPE {\n  CIRCLE = 'CIRCLE',\n  DIAMOND = 'DIAMOND',\n  LEFT = 'LEFT',\n  RIGHT = 'RIGHT',\n}\nexport class ATextLeaderlineNode {\n  public vec: NVector3;\n  public r: number = 12 * 0.5;\n  public diaHeight: number = 13 * 0.5;\n  public diaWidth: number = 13 * 0.5;\n  public type: CATEXT_NODE_RENDER_TYPE;\n  public caText: ATextleaderlineWrapper;\n  public isConnected = true;\n  constructor(\n    caText: ATextleaderlineWrapper,\n    x: number,\n    y: number,\n    type: CATEXT_NODE_RENDER_TYPE = CATEXT_NODE_RENDER_TYPE.CIRCLE\n  ) {\n    this.caText = caText;\n    this.type = type;\n    this.vec = new NVector3(x, y);\n  }\n  public isMouseInside(x: number, y: number): boolean {\n    if (getDistance(new NVector3(x, y), this.vec) < this.r + 5) {\n      return true;\n    }\n    return false;\n  }\n  public updatePos(x: number, y: number) {\n    this.vec.x = x;\n    this.vec.y = y;\n  }\n  public render(ctx: CanvasRenderingContext2D) {\n    this.caText.scene.annotationInstance.renderer.draw.shape.text.renderNodeDia(\n      ctx,\n      this.caText.styleComponent,\n      this.vec.x,\n      this.vec.y,\n      this.diaWidth,\n      this.diaHeight\n    );\n  }\n}\nexport class ATextLeaderlineNodeCircle extends ATextLeaderlineNode {\n  constructor(\n    caText: ATextleaderlineWrapper,\n    x: number,\n    y: number,\n    type: CATEXT_NODE_RENDER_TYPE = CATEXT_NODE_RENDER_TYPE.CIRCLE\n  ) {\n    super(caText, x, y, type);\n  }\n}\nexport class ATextLeaderlineNodeDia extends ATextLeaderlineNode {\n  constructor(\n    caText: ATextleaderlineWrapper,\n    x: number,\n    y: number,\n    type: CATEXT_NODE_RENDER_TYPE = CATEXT_NODE_RENDER_TYPE.DIAMOND\n  ) {\n    super(caText, x, y, type);\n  }\n}\n","import {\n  deepCopy,\n  distanceMouseWithTwoVecs,\n  getDistance,\n  NVector3,\n} from '../../../../../../../lib';\nimport { ATextleaderlineWrapper } from '..';\nimport { ATextLeaderlineNode } from './ATextLeaderlineNode';\nexport class ATextLeaderlineLine {\n  public caText: ATextleaderlineWrapper;\n  public isHover = true;\n  public v0: NVector3;\n  public v1: NVector3;\n  public vecOffset: NVector3;\n  public v1Render: NVector3;\n  // v1Addition0: NVector3 = new NVector3(0,0);\n  // v1Addition1: NVector3 = new NVector3(0,0);\n  public vecsHistory: NVector3[];\n  public t = 0.0;\n  public r = 2.5;\n  public isDrag = false;\n  public isMouseClick = false;\n  public isUpperDia = false;\n  private _v2: NVector3;\n  constructor(caText: ATextleaderlineWrapper, caTextNodeDia: ATextLeaderlineNode) {\n    this.caText = caText;\n    this.v0 = caTextNodeDia.vec;\n    this.vecOffset = new NVector3(0, 0);\n    this.v1 = new NVector3(this.v0.x, this.v0.y);\n    this.v1Render = new NVector3(this.v0.x, this.v0.y);\n    this.v2 = new NVector3(this.v0.x, this.v0.y);\n    this.vecsHistory = [this.v2];\n  }\n  public isMouseInside(x: number, y: number) {\n    const tor = 10;\n    const mv = new NVector3(x, y);\n\n    if (distanceMouseWithTwoVecs(mv, this.v0, this.v1) < tor) {\n      // console.log('true');\n      return true;\n    }\n    if (distanceMouseWithTwoVecs(mv, this.v1, this.v2) < tor) {\n      // console.log('true');\n      return true;\n    }\n    return false;\n    // if (IsInsideOfVecsByArray([x, y], [ [this.v0.x, this.v0.y], [this.v1.x, this.v1.y], [this.v2.x, this.v2.y]])) {\n    //     console.log('true');\n    //     return true;\n    // } else {\n    //     console.log('false');\n    //     return false;\n    // }\n\n    // if (Distance(new NVector3(x, y), this.v2) < 9) { return true; } else { return false; }\n  }\n  public updateMidV() {\n    this.v1.x = this.v0.x;\n    this.v1.y = this.v2.y;\n    // this.v1Addition0.x = this.v0.x;\n    // this.v1Addition0.y = this.v2.y;\n    // this.v1Addition1.x = this.v0.x;\n    // this.v1Addition1.y = this.v2.y;\n\n    this.v1Render.x = this.caText.vecOffset.x;\n    this.v1Render.y = this.caText.vec.y;\n  }\n  public updateTransformationStack() {\n    // if (this.type === CATEXT_NODE_RENDER_TYPE.RIGHT) {\n    if (getDistance(this.v2, new NVector3(this.caText.mouseX, this.caText.mouseY)) < this.r) {\n      if (\n        !this.caText.scene.annotationInstance.activeCommandController.acProperties.isDown &&\n        !this.isMouseClick\n      ) {\n        this.caText.scene.annotationInstance.io.eventListenerAnnotation.transformStack([\n          this.caText.toJSON(),\n        ]);\n        this.isMouseClick = true;\n      }\n      if (this.caText.scene.annotationInstance.activeCommandController.acProperties.isDown) {\n        this.isMouseClick = false;\n      }\n    }\n    // }\n  }\n  public get v2() {\n    return this._v2;\n  }\n  public set v2(v: NVector3) {\n    this._v2 = v;\n  }\n  // public UpdateTargetV(x: number, y: number) {\n  //   this.v2.x = x;\n  //   this.v2.y = y;\n\n  //   this.caText.vec.x = this.v2.x;\n  //   this.caText.vec.y = this.v2.y;\n\n  //   this.vecOffset.x = this.caText.vecOffset.x - this.caText.vec.x;\n  //   this.vecOffset.y = this.caText.vecOffset.y - this.caText.vec.y;\n  //   console.log(this.vecOffset.x, this.vecOffset.y)\n  // }\n  public renderLeaderLine(ctx: CanvasRenderingContext2D) {\n    this.v0 = this.caText.vecOffset;\n    this.v2 = this.caText.vec;\n    if (this.isDrag) {\n      this.isDrag = false;\n      this.v2 = deepCopy(this.vecsHistory[this.vecsHistory.length - 1]);\n    }\n    this.updateMidV();\n    // console.log('dd');\n\n    // safeguard, if the distance is bigger, it never render, prevent from the leader line crossing the screen\n    // if (this.caText.wrapping.IsOutOfExtent(this.caText.GetVecs())) { return; }\n    this.caText.scene.annotationInstance.renderer.draw.shape.text.renderLeaderLine(\n      ctx,\n      this.caText.styleComponent,\n      this.caText.vecOffset,\n      this.v1Render,\n      this.v2,\n      this.t,\n      this.isUpperDia,\n      this.caText.isHoverValue,\n      this.caText.isSelectedValue\n    );\n\n    this.t += 0.1;\n  }\n}\n","import {\n  MouseEventData,\n  getDistance,\n  isInsideOfTwoVecs,\n  isInsideOfVecs,\n  NVector3,\n  InteractionMode,\n} from '../../../../../../../lib';\nimport { InteractionComponent as _InteractionComponent } from '../../../../Common/Base/ComponentTemplate/InteractionComponent';\nimport { ATextLeaderlineLine } from '../Base/ATextLeaderlineLine';\nimport { CATEXT_NODE_RENDER_TYPE } from '../Base/ATextLeaderlineNode';\nimport { ATextleaderlineWrapper } from '..';\n\nexport class InteractionComponent extends _InteractionComponent {\n  public wrapper: ATextleaderlineWrapper;\n  private _isSelectedReaderline = false;\n  constructor(cAText: ATextleaderlineWrapper) {\n    super(cAText);\n    this.wrapper = cAText;\n  }\n  public get IsSelected() {\n    return this.wrapper.isSelectedValue;\n  }\n  public set IsSelected(v: boolean) {\n    // if (this.wrapper.isRenderCollapse) { return; }\n    this.wrapper.isSelectedValue = v;\n    this.wrapper.scene.annotationInstance.io.eventListenerAnnotation.selectionStack(\n      this.wrapper.toJSON()\n    );\n  }\n  public get IsSelectedReaderline() {\n    return this._isSelectedReaderline;\n  }\n  public set IsSelectedReaderline(v: boolean) {\n    this._isSelectedReaderline = v;\n  }\n  public get IsHover() {\n    return this.wrapper.isHoverValue;\n  }\n  public set IsHover(v: boolean) {\n    if (this.wrapper.isRemove || !this.wrapper.isRenderable || this.wrapper.isHiddenValue) {\n      return;\n    }\n    // if (this.wrapper.isRenderCollapse) { return; }\n\n    this.wrapper.isHoverValue = v;\n\n    if (this.wrapper.leaderline) {\n      this.wrapper.leaderline.isHover = v;\n    }\n\n    // for (let p of this.wrapper.pts) p.isRenderable = v;\n    if (this.wrapper.isHoverValue && !this.wrapper.isHoverPre) {\n      this.wrapper.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(\n        this.wrapper.toJSON()\n      );\n    } else if (!this.wrapper.isHoverValue && this.wrapper.isHoverPre) {\n      this.wrapper.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(\n        this.wrapper.toJSON()\n      );\n    }\n    this.wrapper.isHoverPre = this.wrapper.isHoverValue;\n    // if (!this.wrapper.isSelected) {\n    //     this.wrapper.p0.isRenderable = v; this.wrapper.p1.isRenderable = v;\n    // }\n\n    if (!v) {\n      this.wrapper.needEmitHoverPost = true;\n      this.wrapper.hidePopUpSummary();\n    }\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    this.wrapper.mouseX = e.x;\n    this.wrapper.mouseY = e.y;\n\n    if (!this.wrapper.isRenderable || this.wrapper.isHiddenValue) {\n      return;\n    }\n    if (this.wrapper.enableEditValue) {\n      return;\n    }\n    if (!this.wrapper.enableDrag) {\n      return;\n    }\n    if (this.wrapper.isRenderCollapse) {\n      this.translateByMouseEventDataCollapse(e);\n      return;\n    }\n    // if (!this.wrapper.CheckDistance(e.x, e.y)) { return; }\n    // console.log('tran text');\n    const xOff = e.x - e.preX,\n      yOff = e.y - e.preY;\n\n    let isSideNode = false;\n    if (this.wrapper.nodeSelected) {\n      // ................. with a selected node\n      this.wrapper.width = this.wrapper.v1.x - this.wrapper.v0.x;\n\n      // ............ interaction node left and right\n      if (this.wrapper.nodeSelected.type === CATEXT_NODE_RENDER_TYPE.LEFT) {\n        if (this.wrapper.width - xOff > this.wrapper.widthMin + 2) {\n          this.wrapper.v0.x += xOff;\n        } else {\n          this.wrapper.v0.x -= 2;\n        }\n        isSideNode = true;\n      } else if (this.wrapper.nodeSelected.type === CATEXT_NODE_RENDER_TYPE.RIGHT) {\n        if (this.wrapper.width + xOff > this.wrapper.widthMin + 2) {\n          this.wrapper.v1.x += xOff;\n        } else {\n          this.wrapper.v1.x += 2;\n        }\n        isSideNode = true;\n      }\n      // ............ end interaction node left and right\n\n      // ............ interaction node for leaderline\n      if (this.wrapper.nodeSelected.type === CATEXT_NODE_RENDER_TYPE.DIAMOND) {\n        // ............ when down on diamonds, we reset the leaderline\n        if (this.wrapper.attachedShape) {\n          if (this.wrapper.attachedShape.textLeaderline) {\n            this.wrapper.attachedShape.textLeaderline = undefined;\n          }\n          this.wrapper.attachedShape = undefined;\n        }\n        // ............ end when down on diamonds, we reset the leaderline\n\n        this.wrapper.leadlineInteraction(e.x, e.y);\n        if (this.wrapper.leaderline) {\n          // const v = this.wrapper.scene.annotationInstance.geometryCommon.gcmdSupporting.toMap(\n          //   this.wrapper.vec.x,\n          //   this.wrapper.vec.y\n          // );\n\n          if (this.wrapper.vUp.isConnected) {\n            this.wrapper.vecOffset.x =\n              this.wrapper.v0.x + (this.wrapper.v1.x - this.wrapper.v0.x) * 0.5;\n            this.wrapper.vecOffset.y = this.wrapper.v1.y;\n            this.wrapper.widthOffset = this.wrapper.vecOffset.x - this.wrapper.vec.x;\n            this.wrapper.heightOffset = this.wrapper.vecOffset.y - this.wrapper.vec.y;\n          }\n          // this.wrapper.scene.imageAnnoApp.implementations.app.model.appCoreWrapper.ioWrapper.eventListener.TransformStack(this.wrapper.ToJSON());\n        }\n\n        // this.wrapper is for 'Smart Mouse Hovering' while dragging the node of a leaderline of Textleaderline, for snapping\n        // this.wrapper.scene.imageAnnoApp.renderer.UpdateMouseHover(this.wrapper.scene.imageAnnoApp.activeCommandController.m);\n\n        this.wrapper.computeCenterVec(); // before update UpdateVecsHistory, we need to keep tracking vecs for transformation stack\n        // this.geo.UpdateVecsHistory();\n        // this.wrapper.wrapping.UpdateProjectionShapes(this.wrapper.GetVecs());\n        this.wrapper.updateBoundingBox();\n        return;\n      }\n      // ............ end interaction node for leaderline\n    } else if (this.wrapper.nodeTargetLeaderLine) {\n      /// ................. with no node selected\n      this.updateLeaderlineTarget(e.x, e.y);\n      this.wrapper.vecOffset.x = this.wrapper.v0.x + (this.wrapper.v1.x - this.wrapper.v0.x) * 0.5;\n      this.wrapper.vecOffset.y = this.wrapper.v0.y + (this.wrapper.v1.y - this.wrapper.v0.y) * 0.5;\n\n      this.wrapper.widthOffset = this.wrapper.vecOffset.x - this.wrapper.vec.x;\n      this.wrapper.heightOffset =\n        this.wrapper.vecOffset.y - this.wrapper.vec.y + this.wrapper.height * 0.5;\n      this.wrapper.computeCenterVec(); // before update UpdateVecsHistory, we need to keep tracking vecs for transformation stack\n\n      // this.wrapper is for 'Smart Mouse Hovering' while dragging the node of a leaderline of Textleaderline, for snapping\n      // this.wrapper.scene.imageAnnoApp.renderer.UpdateMouseHover(this.wrapper.scene.imageAnnoApp.activeCommandController.m);\n      this.wrapper.updateVecsBox();\n      this.wrapper.updateBoundingBox();\n      return;\n    } else {\n      this.wrapper.v0.x += xOff;\n      this.wrapper.v0.y += yOff;\n      this.wrapper.v1.x += xOff;\n      this.wrapper.v1.y += yOff;\n    }\n\n    if (isSideNode) {\n      if (this.wrapper.leaderline) {\n        // this.wrapper.vec.x = this.wrapper.v0.x + (this.wrapper.v1.x - this.wrapper.v0.x) * 0.5 ;\n        this.wrapper.vecOffset.x =\n          this.wrapper.v0.x + (this.wrapper.v1.x - this.wrapper.v0.x) * 0.5;\n        this.wrapper.widthOffset = this.wrapper.vecOffset.x - this.wrapper.vec.x;\n      } else {\n        this.wrapper.vec.x = this.wrapper.v0.x + (this.wrapper.v1.x - this.wrapper.v0.x) * 0.5;\n        this.wrapper.vecOffset.x =\n          this.wrapper.v0.x + (this.wrapper.v1.x - this.wrapper.v0.x) * 0.5;\n        // this.wrapper.widthOffset = this.wrapper.vecOffset.x  - this.wrapper.vec.x;\n        // this.wrapper.vec.y = this.wrapper.v0.y + (this.wrapper.v1.y - this.wrapper.v0.y) * 0.5 ;\n        this.wrapper.widthOffset = 0;\n        this.wrapper.heightOffset = 0;\n      }\n    } else {\n      if (this.wrapper.leaderline) {\n        this.wrapper.vecOffset.x =\n          this.wrapper.v0.x + (this.wrapper.v1.x - this.wrapper.v0.x) * 0.5;\n        this.wrapper.vecOffset.y =\n          this.wrapper.v0.y + (this.wrapper.v1.y - this.wrapper.v0.y) * 0.5;\n\n        this.wrapper.widthOffset = this.wrapper.vecOffset.x - this.wrapper.vec.x;\n        this.wrapper.heightOffset =\n          this.wrapper.vecOffset.y - this.wrapper.vec.y + this.wrapper.height * 0.5;\n        // console.log('width off', this.wrapper.widthOffset, 'height off', this.wrapper.heightOffset);\n\n        this.wrapper.updateVecsBox();\n      } else {\n        this.wrapper.vec.x += xOff;\n        this.wrapper.vec.y += yOff;\n        this.wrapper.vecOffset.x += this.wrapper.vec.x;\n        this.wrapper.vecOffset.y += this.wrapper.vec.y;\n        this.wrapper.widthOffset = 0;\n        this.wrapper.heightOffset = 0;\n        this.wrapper.updateVecsBox();\n      }\n    }\n\n    // console.log('dd');\n\n    this.wrapper.computeCenterVec(); // it could be optional but to make sure update cen vecs when you are translating the Textleaderline in real time\n    // this.wrapper.projection.UpdateGoeVec();\n    this.wrapper.txtDiv.updateDiv();\n    this.updateSideNodes();\n    this.updateConectNodes();\n    this.wrapper.updateBoundingBox();\n  }\n  private translateByMouseEventDataCollapse(e: MouseEventData) {\n    const xOff = e.x - e.preX;\n    const yOff = e.y - e.preY;\n    if (this.wrapper.leaderline) {\n      // if(this.wrapper.vUp.isConnected) {\n      //   // console.log(xOff, yOff);\n      //   // this.wrapper.vecOffset.x += xOff;\n      //   // this.wrapper.vecOffset.y += yOff - this.wrapper.height;\n\n      //   this.wrapper.widthOffset += xOff;\n      //   this.wrapper.heightOffset = this.wrapper.heightOffset + yOff - this.wrapper.height;\n      // } else {\n      this.wrapper.vecOffset.x += xOff;\n      this.wrapper.vecOffset.y += yOff;\n      this.wrapper.widthOffset += xOff;\n      this.wrapper.heightOffset += yOff;\n      // }\n      this.updateSideNodes();\n    } else {\n      this.wrapper.widthOffset = 0;\n      this.wrapper.heightOffset = 0;\n      this.wrapper.vecOffset.x += xOff;\n      this.wrapper.vecOffset.y += yOff;\n      this.wrapper.vec.x += xOff;\n      this.wrapper.vec.y += yOff;\n    }\n\n    this.wrapper.updateVecsBox();\n    this.wrapper.updateBoundingBox();\n    // this.wrapper.scene.imageAnnoApp.activeCommandController.acProperties.needExecuteOptimizer = true;\n    // this.wrapper.scene.imageAnnoApp.activeCommandController.acProperties.isPanning = true;\n  }\n  public mouseLeftClick(x: number, y: number) {\n    this.wrapper.scene.captureText = this.wrapper;\n    if (this.wrapper.isCollapse) {\n      this.wrapper.collision.isCollided = false;\n      this.wrapper.isCollapse = false;\n      this.wrapper.txtDiv.focusOnTextDiv();\n      return;\n    }\n\n    if (this.wrapper.IsSelectedReaderline) {\n      this.wrapper.isSelectedReaderlineByClick = true;\n    } else {\n      this.wrapper.isSelectedReaderlineByClick = false;\n    }\n\n    if (!this.wrapper.isSelectedReaderlineByClick) {\n      if (this.wrapper.isMouseInsideDiv(x, y)) {\n        // console.log(x,y);\n        this.wrapper.txtDiv.focusOnTextDiv();\n      }\n    }\n\n    // this.wrapper.txtDiv.divText.onfocus;\n    // this.wrapper.txtDiv.divText.onblur = () => { console.log('blur'); };\n  }\n  public mouseUp() {\n    // if (this.wrapper.leaderline) {\n    //   this.wrapper.leaderline.vecOffset.x = this.wrapper.vecOffset.x - this.wrapper.vec.x;\n    //   this.wrapper.leaderline.vecOffset.y = this.wrapper.vecOffset.y - this.wrapper.vec.y + 20;\n    // }\n\n    // console.log(t);\n    // if ( this.wrapper.leaderline && this.wrapper.IsMouseInsideDiv(this.wrapper.leaderline.v2.x, this.wrapper.leaderline.v2.y)) {\n    //   this.wrapper.RemoveLeaderline();\n    // }\n    // console.log('SnapForPoint');\n    this.wrapper.snapForPoint(); // ......................\n  }\n  public mouseDoubleClick() {\n    this.wrapper.isEditiable = !this.wrapper.isEditiable;\n    // this.txtDiv.ShowTextDiv();\n  }\n  public isMouseInside(x: number, y: number): boolean {\n    // if (this.wrapper.IsSelected) { return true; }\n    if (this.wrapper.isRenderCollapse) {\n      if (getDistance(new NVector3(x, y), this.geo.vec) < 15) {\n        this.wrapper.isHover = true;\n        return true;\n      }\n      this.wrapper.isHover = false;\n      return false;\n    }\n\n    if (\n      this.wrapper.scene.annotationInstance.implementations.app.model.appCoreWrapper\n        .appControllerStatus.mode !== InteractionMode.Drawing\n    ) {\n      return false;\n    }\n\n    if (this.isMouseInsideLeaderline(x, y)) {\n      this.wrapper.IsSelectedReaderline = true;\n      this.wrapper.isHover = true;\n      return true;\n    }\n    if (this.isMouseInsideNodes(x, y)) {\n      // console.log(this.wrapper.IsHover);\n      this.wrapper.IsSelectedReaderline = true;\n      this.wrapper.isHover = true;\n      return true;\n    }\n    this.wrapper.IsSelectedReaderline = false;\n\n    if (isInsideOfTwoVecs(new NVector3(x, y), this.wrapper.v0, this.wrapper.v1)) {\n      this.wrapper.isHover = true;\n      return true;\n    }\n    this.wrapper.isHover = false;\n    return false;\n  }\n  public isMouseInsideDiv(x: number, y: number) {\n    // const offset = 20;\n    if (this.wrapper.isRenderCollapse) {\n      return false;\n    }\n\n    const vs = [\n      new NVector3(\n        this.wrapper.v0.x + this.wrapper.offDiv,\n        this.wrapper.v0.y + this.wrapper.offDiv\n      ),\n      new NVector3(\n        this.wrapper.v0.x + this.wrapper.width - this.wrapper.offDiv,\n        this.wrapper.v0.y + this.wrapper.offDiv\n      ),\n      new NVector3(\n        this.wrapper.v0.x + this.wrapper.width - this.wrapper.offDiv,\n        this.wrapper.v0.y + this.wrapper.height - this.wrapper.offDiv\n      ),\n      new NVector3(\n        this.wrapper.v0.x + this.wrapper.offDiv,\n        this.wrapper.v0.y + this.wrapper.height - this.wrapper.offDiv\n      ),\n    ];\n\n    if (isInsideOfVecs(new NVector3(x, y, 0), vs)) {\n      return true;\n    }\n    return false;\n  }\n  private updateLeaderlineTarget(x: number, y: number) {\n    if (this.wrapper.nodeTargetLeaderLine === undefined) {\n      return;\n    }\n    this.wrapper.nodeTargetLeaderLine.x = x;\n    this.wrapper.nodeTargetLeaderLine.y = y;\n\n    this.wrapper.nodeTargetLeaderLine.x = x;\n    this.wrapper.nodeTargetLeaderLine.y = y;\n  }\n  public isMouseInsideLeaderline(x: number, y: number): boolean {\n    if (this.wrapper.leaderline) {\n      if (this.wrapper.leaderline.isMouseInside(x, y)) {\n        this.wrapper.nodeTargetLeaderLine = this.wrapper.leaderline.v2;\n        this.wrapper.leaderline.isHover = true;\n        return true;\n      }\n      this.wrapper.leaderline.isHover = false;\n    }\n    this.wrapper.nodeTargetLeaderLine = undefined;\n    return false;\n  }\n  public updateSideNodes() {\n    this.wrapper.vLeft.updatePos(this.wrapper.v0.x, this.wrapper.v0.y + this.wrapper.height * 0.5);\n    this.wrapper.vRight.updatePos(this.wrapper.v1.x, this.wrapper.v0.y + this.wrapper.height * 0.5);\n  }\n  public updateConectNodes() {\n    this.wrapper.vUp.updatePos(this.wrapper.v0.x + this.wrapper.width * 0.5, this.wrapper.v0.y);\n    this.wrapper.vDown.updatePos(this.wrapper.v0.x + this.wrapper.width * 0.5, this.wrapper.v1.y);\n  }\n  private isMouseInsideNodes(x: number, y: number): boolean {\n    this.wrapper.nodeSelected = undefined;\n    for (let i = 0; i < this.wrapper.nodes.length; ++i) {\n      if (this.wrapper.nodes[i].isMouseInside(x, y)) {\n        this.wrapper.nodeSelected = this.wrapper.nodes[i];\n        return true;\n      }\n    }\n    return false;\n  }\n  public leadlineInteraction(x: number, y: number) {\n    if (this.wrapper.leaderline) {\n      // console.log('leaderline inter', x, y);\n      // the enable us to reset the taget of the leaderline, resulting in detache the tip from the snapped shapes\n      // if (this.wrapper.isAttached) {\n      // this.wrapper.leaderline.v2 = new NVector3(x, y);\n      // }\n      // console.log('d');\n      // if (this.wrapper.attachedShape) { this.wrapper.attachedShape.textLeaderline = undefined; }\n\n      this.wrapper.vec.x = x;\n      this.wrapper.vec.y = y;\n      this.wrapper.widthOffset = this.wrapper.vecOffset.x - this.wrapper.vec.x;\n      this.wrapper.heightOffset = this.wrapper.vecOffset.y - this.wrapper.vec.y;\n      // console.log('width off', this.wrapper.widthOffset, 'height off', this.wrapper.heightOffset);\n\n      // this.wrapper.leaderline.UpdateTargetV(x, y);\n    } else {\n      // console.log('no leaderline inter', x, y);\n      // console.trace();\n      this.wrapper.leaderline = new ATextLeaderlineLine(\n        this.wrapper,\n        this.wrapper.getClosestNodeDia(x, y)\n      );\n    }\n  }\n}\n","import { IOGeometry } from '../../../../../../../lib/Extended/GeometryUtility';\nimport { NVector3, GType } from '../../../../../../../lib';\nimport { ATextleaderlineWrapper } from '..';\nexport class IOComponent {\n  public wrapper: ATextleaderlineWrapper;\n  constructor(cAText: ATextleaderlineWrapper) {\n    this.wrapper = cAText;\n  }\n  public toJSON(): IOGeometry {\n    const p = new IOGeometry(\n      this.wrapper.id,\n      GType.TEXT_LEADERLINE,\n      this.wrapper.isSelectedValue,\n      this.wrapper.isHoverValue,\n      this.wrapper.isHiddenValue\n    );\n    if (this.wrapper.widthOffset !== 0 || this.wrapper.heightOffset !== 0) {\n      p.pushNode([\n        this.wrapper.vec,\n        new NVector3(this.wrapper.widthOffset, this.wrapper.heightOffset),\n      ]);\n    } else {\n      p.pushNode([this.wrapper.vec]);\n    }\n\n    p.data = {\n      // textContent: this.wrapper.txtDiv.textContent,\n      // renderType: this.wrapper.renderType.toString(),\n      // style: this.wrapper.renderType,\n      content: this.wrapper.contentHtmltemp,\n      width: this.wrapper.width,\n      height: this.wrapper.height,\n      version: 2,\n      zoom: this.wrapper.renderer.zoomLevel,\n    };\n    const styles = this.wrapper.styleComponent.toJson();\n    if (styles) {\n      p.styles = styles;\n    }\n    // console.log('to json', p.nodes);\n    return p;\n  }\n  public getLog(): string {\n    const text =\n      'GUID : ' +\n      this.wrapper.id +\n      '/' +\n      'TYPE : ' +\n      this.wrapper.type.toString() +\n      '/' +\n      'Screen : ' +\n      // this.wrapper.vec.ToString() + '/' +\n      'SIZE : ' +\n      this.wrapper.r +\n      ' pixel' +\n      '/' +\n      // 'STYLE : ' + this.wrapper.style.toString() + '/' +\n      // 'CONNE :' + this.wrapper.edges.length.toString() + '/' +\n      'IsCap :' +\n      this.wrapper.isCapturedValue +\n      '/' +\n      'IsSEL : ' +\n      this.wrapper.isSelectedValue +\n      '/' +\n      'IsHid : ' +\n      this.wrapper.isHiddenValue +\n      '/' +\n      'IsDeg : ' +\n      this.wrapper.isDrag +\n      '/' +\n      'isSelable : ' +\n      this.wrapper.isSelectable +\n      '/' +\n      'hasLeaderline : ' +\n      this.wrapper.leaderline;\n    return text;\n  }\n  public processingUpdate(data: string) {\n    const d = JSON.parse(data);\n    if (d.content) {\n      this.wrapper.contentHtmltemp = d.content;\n    }\n    this.wrapper.scene.annotationInstance.io.eventListenerAnnotation.updateStack(this.toJSON());\n  }\n  public deepCopy(x: number, y: number, z = 0) {\n    const g = this.toJSON();\n    if (g) {\n      const ng = this.wrapper.fromJSON(g, true, true);\n      ng.move(x, y);\n      ng.isHover = false;\n      ng.emitAddStack();\n      return ng;\n    }\n    return undefined;\n  }\n  public remove(needEmit = true): void {\n    if (\n      !this.wrapper.scene.annotationInstance.implementations.app.model.appCoreWrapper\n        .appControllerStatus.drawing\n    ) {\n      return;\n    }\n    if (this.wrapper.attachedShape) {\n      this.wrapper.attachedShape.textLeaderline = undefined;\n    }\n    if (this.wrapper.isSelectedReaderlineByClick) {\n      this.wrapper.leaderline = undefined;\n      this.wrapper.isSelected = false;\n      this.wrapper.scene.annotationInstance.io.eventListenerAnnotation.transformStack([\n        this.toJSON(),\n      ]);\n      return;\n    }\n\n    if (this.wrapper.scene.annotationInstance.activeCommandController.acProperties.isTextEditing) {\n      return;\n    }\n\n    this.wrapper.removeDiv();\n\n    if (needEmit) {\n      const ioGeo = this.toJSON();\n      if (ioGeo) {\n        this.wrapper.scene.annotationInstance.io.eventListenerAnnotation.hideTextStack(ioGeo);\n        this.wrapper.scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack([\n          ioGeo,\n        ]);\n      }\n    }\n    this.wrapper.scene.removeATextleaderlineWrapper(this.wrapper);\n    this.wrapper.scene.removeGeometry(this.wrapper);\n  }\n  public removeByAttachedShape() {\n    this.wrapper.leaderline = undefined;\n    if (this.wrapper.attachedShape) {\n      this.wrapper.attachedShape.textLeaderline = undefined;\n      this.wrapper.attachedShape = undefined;\n    }\n\n    this.resetAnchorVec();\n    this.wrapper.scene.annotationInstance.io.eventListenerAnnotation.transformStack([\n      this.toJSON(),\n    ]);\n  }\n  public RemoveLeaderline() {\n    this.wrapper.leaderline = undefined;\n    if (this.wrapper.attachedShape) {\n      this.wrapper.attachedShape.textLeaderline = undefined;\n      this.wrapper.attachedShape = undefined;\n    }\n\n    this.resetAnchorVec();\n    this.wrapper.scene.annotationInstance.io.eventListenerAnnotation.transformStack([\n      this.toJSON(),\n    ]);\n  }\n  public removeDiv() {\n    try {\n      if ( this.wrapper.scene.annotationInstance.implementations.app.model.modelViewWrapper.div) {\n        if (this.wrapper.txtDiv.divText) {\n          this.wrapper.scene.annotationInstance.implementations.app.model.modelViewWrapper.div.removeChild(\n            this.wrapper.txtDiv.divText\n          );\n        }\n        if (this.wrapper.txtDiv.divTextAnchor) {\n          this.wrapper.scene.annotationInstance.implementations.app.model.modelViewWrapper.div.removeChild(\n            this.wrapper.txtDiv.divTextAnchor\n          );\n        }\n      }\n    } catch (error) {\n      // console.error(error);\n    }\n  }\n  private resetAnchorVec() {\n    this.wrapper.widthOffset = 0;\n    this.wrapper.heightOffset = 0;\n\n    if (this.wrapper.vUp.isConnected) {\n      this.wrapper.vecOffset.y += this.wrapper.height;\n    }\n\n    this.wrapper.vec.x = this.wrapper.vecOffset.x;\n    this.wrapper.vec.y = this.wrapper.vecOffset.y;\n\n    this.wrapper.updateVecs();\n  }\n}\n","import { ATextleaderlineWrapper } from '..';\nexport class ProjectionComponent {\n  public wrapper: ATextleaderlineWrapper;\n  constructor(cAText: ATextleaderlineWrapper) {\n    this.wrapper = cAText;\n  }\n  public outExtent() {\n    this.wrapper.updateScreenVecForPan();\n    if (this.wrapper.isInsideExtent) {\n      this.wrapper.txtDiv.hideTextDiv();\n      this.wrapper.isInsideExtent = false;\n    }\n  }\n  public inExtent() {\n    if (!this.wrapper.isInsideExtent) {\n      this.wrapper.txtDiv.showTextDiv();\n      this.wrapper.isInsideExtent = true;\n    }\n  }\n}\n","import { NVector3, InteractionMode } from '../../../../../../../lib';\nimport { RendererComponent as _RendererComponent } from '../../../../Common/Base/ComponentTemplate/RendererComponent';\nimport { ATextleaderlineWrapper } from '..';\nexport class RendererComponent extends _RendererComponent {\n  public wrapper: ATextleaderlineWrapper;\n  public zoomLevel = 0;\n  public zoomDifference = 0;\n  public contentHtmltempForHide: string;\n  public hasSnippet = false;\n\n  private scaleRuntime = 0;\n  private widthRuntime = 0;\n  private heightRuntime = 0;\n  private v0Runtime: NVector3 = new NVector3(0, 0, 0);\n\n  constructor(cAText: ATextleaderlineWrapper) {\n    super(cAText);\n    this.wrapper = cAText;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.scaleRuntime = 1;\n    this.widthRuntime = (this.wrapper.v1.x - this.wrapper.v0.x) * this.scaleRuntime;\n    this.heightRuntime = Math.abs(this.wrapper.v1.y - this.wrapper.v0.y);\n\n    this.v0Runtime.x = this.wrapper.vecOffset.x - this.widthRuntime * 0.5;\n    this.v0Runtime.y = this.wrapper.vUp.vec.y;\n\n    /*\n    this.wrapper.interaction.UpdateConectNodes(); // for update the position for top and bottom nodes, after removing node and undo can cuase a problem for rendering\n\n    // minimum width\n    // this.widthRuntime = this.widthRuntime > this.wrapper.widthMin ? this.widthRuntime : this.wrapper.widthMin;\n\n    this.heightRuntime = Math.abs(this.wrapper.v1.y - this.wrapper.v0.y) * this.scaleRuntime;\n\n    this.v0Runtime.x = this.wrapper.vecOffset.x - this.widthRuntime * 0.5;\n    this.v0Runtime.y = this.wrapper.vUp.vec.y + Math.abs(this.wrapper.v1.y - this.wrapper.v0.y)  - this.heightRuntime;\n    */\n\n    if (this.wrapper.isRenderCollapse) {\n      this.renderSnippet(ctx, this.widthRuntime, this.heightRuntime);\n      return;\n    }\n\n    // const height = 10;\n    // console.log('real width', width, 'real height', height)\n    // const width =  (this.wrapper.leaderline.v0Render.x - this.wrapper.v0.x) * 2;\n\n    // const scale = this.wrapper.scene.imageAnnoApp.customization.themeCurrent.textleaderline.scale;\n\n    // const height = (this.v1.y - this.v0.y) * scale;\n    // const offsetX = 5; // when you scale down, we need to apply the offset along x\n\n    this.wrapper.scene.annotationInstance.renderer.draw.shape.text.roundedRectACTextStoryMapByWidth(\n      ctx,\n      this.wrapper.styleComponent,\n      this.v0Runtime,\n      this.widthRuntime,\n      this.heightRuntime,\n      3,\n      0,\n      0,\n      this.wrapper.isHoverValue,\n      this.wrapper.isSelectedValue\n    );\n\n    if (this.wrapper.scene.annotationInstance.interactionMode === InteractionMode.Drawing) {\n      if (this.wrapper.isHover || this.wrapper.isSelected) {\n        this.renderNodes(ctx);\n      }\n    }\n  }\n  public renderSnippet(ctx: CanvasRenderingContext2D, width: number, height: number) {\n    if (this.wrapper.isHover) {\n      if (this.wrapper.txtDiv.divText && this.wrapper.txtDiv.divText.hidden) {\n        this.wrapper.txtDiv.divText.hidden = false;\n      }\n      this.hasSnippet = true;\n      if (this.wrapper.leaderline) {\n        this.wrapper.findClosestNodeDia();\n        this.wrapper.leaderline.renderLeaderLine(ctx);\n      }\n\n      this.wrapper.scene.annotationInstance.renderer.draw.shape.text.roundedRectACTextStoryMapByWidth(\n        ctx,\n        this.wrapper.styleComponent,\n        this.v0Runtime,\n        width,\n        height,\n        3,\n        0,\n        0,\n        this.wrapper.isHoverValue,\n        this.wrapper.isSelectedValue\n      );\n    } else {\n      if (this.wrapper.txtDiv.divText && !this.wrapper.txtDiv.divText.hidden) {\n        this.wrapper.txtDiv.divText.hidden = true;\n      }\n      this.hasSnippet = false;\n    }\n  }\n  public renderLeadline(ctx: CanvasRenderingContext2D) {\n    if (this.wrapper.isRenderCollapse) {\n      this.renderMarker(ctx);\n      return;\n    }\n\n    if (this.wrapper.leaderline) {\n      this.wrapper.findClosestNodeDia();\n      this.wrapper.leaderline.renderLeaderLine(ctx);\n    }\n  }\n  private renderNodes(ctx: CanvasRenderingContext2D) {\n    this.wrapper.vLeft.render(ctx);\n    this.wrapper.vRight.render(ctx);\n    this.wrapper.vUp.render(ctx);\n    this.wrapper.vDown.render(ctx);\n  }\n  private renderMarker(ctx: CanvasRenderingContext2D) {\n    if (this.hasSnippet) {\n      return;\n    }\n    const v = this.wrapper.vec;\n    // const xOff = 4, yOff = 5;\n\n    ctx.beginPath();\n    ctx.arc(v.x, v.y, 7, 0, 3.14 * 2);\n    ctx.closePath();\n\n    let col = this.wrapper.styleComponent.styleAnchorNode.fillStyle;\n    ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`; // this.wrapper.styleComponent.renderStyle.colorFillHover; // 'rgba(10, 10, 10, 1)'\n    ctx.fill();\n\n    ctx.lineWidth = this.wrapper.styleComponent.styleAnchorNode.lineWidth;\n    col = this.wrapper.styleComponent.styleAnchorNode.strokeStyle;\n    ctx.strokeStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    ctx.stroke();\n\n    // ctx.beginPath();\n    // ctx.moveTo(v.x - 3 - xOff, v.y - yOff);\n    // ctx.lineTo(v.x - 3 + xOff, v.y - yOff);\n    // ctx.lineTo(v.x - 3, v.y - yOff);\n\n    // ctx.lineTo(v.x - 3, v.y + yOff);\n    // // ctx.closePath();\n\n    // ctx.lineWidth = 3;\n    // ctx.strokeStyle = '#ffffff';\n    // ctx.stroke();\n    // ctx.lineWidth = 0;\n\n    // ctx.fillStyle = '#ffffff';\n    // let text = `${this.geo.collision.numOrder}`;\n    // ctx.fillText(text, v.x + 3, v.y + 2);\n  }\n}\n","import {\n  Linecap,\n  DownloadJSON,\n  ISVGForCanvas,\n} from '../../../../lib';\n// export type number[] = [number, number, number, number];\n// ................................................ shapes\nclass ThemeRegularPoint {\n  public URL: string;\n  public SVG: ISVGForCanvas;\n  public width = 36;\n  public height = 28;\n  public scale = 1;\n  public fillStyleFirstArray: number[] = [0, 0, 0, 0];\n  public fillStyleSecondArray: number[] = [0, 0, 0, 0];\n  public lineWidth = 1;\n\n  public shadowColor = 'rgba(0 ,0 ,0 , 0.5)';\n  public shadowColorHover = 'rgba(0 ,0 ,0 , 1.0)';\n  public shadowBlur = 5;\n}\nclass ThemeNumberedPoint {\n  public width = 36;\n  public height = 28;\n  public fontFamily: string;\n  public fontSize = 9;\n  public fontColorArray: number[] = [0, 0, 0, 0];\n  public URL: string;\n  public SVG: ISVGForCanvas;\n  public scale = 1;\n  public fillStyleFirstArray: number[] = [0, 0, 0, 0];\n  public fillStyleSecondArray: number[] = [0, 0, 0, 0];\n  public strokeStyleFirstArray: number[] = [0, 0, 0, 0];\n  public lineWidth = 1;\n\n  public shadowColor = 'rgba(0 ,0 ,0 , 0.5)';\n  public shadowColorHover = 'rgba(0 ,0 ,0 , 1.0)';\n  public shadowBlur = 5;\n}\nclass ThemeIconPoint {\n  public URL: string;\n  public SVG: ISVGForCanvas;\n  public scale = 1;\n  public fillStyleFirstArray: number[] = [0, 0, 0, 0];\n  public fillStyleSecondArray: number[] = [0, 0, 0, 0];\n  public strokeStyleFirstArray: number[] = [0, 0, 0, 0];\n  public lineWidth = 1;\n}\nclass ThemeArrow {\n  public fillStyleFirstArray: number[] = [0, 0, 0, 0];\n  public fillStyleSecondArray: number[] = [0, 0, 0, 0];\n  public strokeStyleFirstArray: number[] = [0, 0, 0, 0];\n  public strokeStyleSecondArray: number[] = [0, 0, 0, 0];\n  public lineWidth = 1;\n  public lineDash: number[] = [0, 0];\n  public scale = 1;\n}\nclass ThemePolyline {\n  public strokeStyleFirstArray: number[] = [0, 0, 0, 0];\n  public strokeStyleSecondArray: number[] = [0, 0, 0, 0];\n  public lineWidth = 1;\n}\nclass ThemePolygon {\n  public fillStyleFirstArray: number[] = [0, 0, 0, 0];\n  public fillStyleSecondArray: number[] = [0, 0, 0, 0];\n  public strokeStyleFirstArray: number[] = [0, 0, 0, 0];\n  public strokeStyleSecondArray: number[] = [0, 0, 0, 0];\n  public lineWidth = 1;\n}\n// .................................................. Textleaderline\n// class ThemeHandleNode {\n//   width: number = 2;\n//   color: number[] = [0, 0, 0, 0];\n//   fill: number[] = [8, 127, 155, 0.6];\n//   dash: number[] = [0, 0];\n//   radius: number = 5;\n// }\n// class ThemeLeaderline {\n//   width: number = 2;\n//   color: number[] = [0, 0, 0, 0];\n//   dash: number[] = [0, 0];\n// }\n// class ThemeAnchorNode {\n//   width: number = 2;\n//   color: number[] = [8, 127, 155, 0.9];\n//   fill: number[] = [8, 127, 155, 0.6];\n//   radius: number = 5;\n// }\n// ......................................... textleaderline\nexport class ThemeLeaderline {\n  public strokeStyle: number[] = [0, 0, 0, 1.0];\n  public lineWidth = 2;\n  private _dash: number[] = [0, 0];\n\n  get dash() {\n    return this._dash;\n  }\n  set dash(v: number[]) {\n    this._dash = v;\n  }\n}\n\nexport class ThemeAnchorNode {\n  public fillStyle: number[] = [0, 0, 0, 1.0];\n  public strokeStyle: number[] = [0, 0, 0, 1.0];\n  public lineWidth = 2;\n  public radius = 5;\n  public dash: number[] = [0, 0];\n}\nexport class ThemeHandleNode {\n  public fillStyle: number[] = [0, 0, 0, 1.0];\n  public strokeStyle: number[] = [100, 100, 100, 1.0];\n  public lineWidth = 2;\n  public dash: number[] = [0, 0];\n}\nexport class ThemeBox {\n  public fillStyle: number[] = [20, 20, 20, 1.0];\n  public strokeStyle: number[] = [0, 0, 0, 1.0];\n  public lineWidth = 2;\n  public dash: number[] = [0, 0];\n}\nclass ThemeTextLeaderline {\n  public fillStyleFirstArray: number[] = [0, 0, 0, 0];\n  public fillStyleSecondArray: number[] = [0, 0, 0, 0];\n  public strokeStyleFirstArray: number[] = [0, 0, 0, 0];\n  public handleNode: ThemeHandleNode = new ThemeHandleNode();\n  public box: ThemeBox = new ThemeBox();\n  public anchorNode: ThemeAnchorNode = new ThemeAnchorNode();\n  public leaderline: ThemeLeaderline = new ThemeLeaderline();\n  public scale = 1;\n}\n// ......................................... end textleaderline\n// ................................................ internal\nclass ThemeNode {\n  public size = 8;\n  public lineWidth = 6;\n  public sizeMid = 2;\n  public lineWidthMid = 2;\n}\nclass ThemeInternalProperties {\n  public elasticScale = 3.5; // 2.25; // 2\n  public pointBoundOffset = 8;\n  public outlineHoverColorArray: number[] = [0, 0, 0, 0];\n  public outlineHoverColorRGBAString = 'rgba(255,255,255,1.0)';\n  public maskColor = '#000000';\n  public isDarkBG = false;\n  public lineCap: Linecap.Round;\n  public opacity = 0.6;\n  public opacityHover = 0.7;\n  // ................................ color interpolation\n  public desaturationValue = -0.3;\n  public timeTransitionA = 0.015;\n  public timeTransitionB = 0.015;\n}\nclass ThemeSelection {\n  public fillStyleFirstArray: number[] = [0, 0, 0, 0];\n  public strokeStyleFirstArray: number[] = [0, 0, 0, 0];\n}\nclass ThemeFreehand {\n  public fillStyleFirstArray: number[] = [0, 0, 0, 0];\n  public strokeStyleFirstArray: number[] = [0, 0, 0, 0];\n  public lineWidth = 1;\n}\nexport class ThemeObjectForStorymaps {\n  // ................................................ point family\n  public rPoint: ThemeRegularPoint;\n  public nPoint: ThemeNumberedPoint;\n  public iPoint: ThemeIconPoint;\n  // ................................................ line family\n  public arrow: ThemeArrow;\n  public polyline: ThemePolyline;\n  // ................................................ area family\n  public polygon: ThemePolygon;\n  // ................................................ text\n  public textleaderline: ThemeTextLeaderline;\n  // ................................................ internal properties\n  public properties: ThemeInternalProperties;\n  public selection: ThemeSelection;\n  public freehand: ThemeFreehand;\n  public node: ThemeNode;\n  constructor() {\n    this.rPoint = new ThemeRegularPoint();\n    this.nPoint = new ThemeNumberedPoint();\n    this.iPoint = new ThemeIconPoint();\n    this.arrow = new ThemeArrow();\n    this.polyline = new ThemePolyline();\n    this.polygon = new ThemePolygon();\n    this.properties = new ThemeInternalProperties();\n    this.selection = new ThemeSelection();\n    this.freehand = new ThemeFreehand();\n    this.node = new ThemeNode();\n    this.textleaderline = new ThemeTextLeaderline();\n    // console.log(this.ToJson());\n    // this.DownloadJson();\n  }\n  public toJson() {\n    return JSON.parse(JSON.stringify(this));\n  }\n  public downloadJson(name = 'AnnotationTheme.json') {\n    const data = new DownloadJSON(this.toJson(), name);\n    data.dummy();\n  }\n}\n","import {\n  ThemeAnchorNode,\n  ThemeBox,\n  ThemeHandleNode,\n  ThemeLeaderline,\n} from '../../../../../Customization/ThemeRenderStyle/StorymapsThemeStructure';\nimport { LineTypeId, ThemeColorId } from '../../../../../Customization/ThemeRenderStyle/Utility';\nimport {\n  State as _State,\n  StyleComponent as _StyleComponent,\n} from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { ATextleaderlineWrapper } from '..';\nexport interface StyleFont {\n  fontStyle: string;\n  fontVariant: string;\n  fontWeight: number;\n  fontSize: number;\n  fontFamily: string;\n  color: string;\n}\nexport interface StyleRenderer {\n  fillColorBG: string;\n  strokeColorBG: string;\n  dashBG: number[];\n  strokeColorLeaderline: string;\n  dashLeaderline: number[];\n}\nexport class State extends _State {\n  public textColor: ThemeColorId = ThemeColorId.BackgroundColor;\n  public backgroundColor: ThemeColorId = ThemeColorId.TitleColor;\n}\nexport class StyleComponent extends _StyleComponent {\n  public state: State;\n  public geo: ATextleaderlineWrapper;\n  public styleLeaderline: ThemeLeaderline;\n  public styleHandleNode: ThemeHandleNode;\n  public styleAnchorNode: ThemeAnchorNode;\n  public styleBox: ThemeBox;\n  constructor(geo: ATextleaderlineWrapper) {\n    super(geo);\n    this.state = new State();\n    this.updateStyle();\n  }\n  public updateStyle() {\n    const theme = this.geo.scene.annotationInstance.customization.themeCurrent.textleaderline;\n    if (!this.styleBox) {\n      this.styleBox = new ThemeBox();\n      this.styleBox.dash = [0, 0];\n      this.styleBox.fillStyle = theme.box.fillStyle;\n      this.styleBox.lineWidth = theme.box.lineWidth;\n      this.styleBox.strokeStyle = theme.box.strokeStyle;\n    }\n    if (!this.styleAnchorNode) {\n      this.styleAnchorNode = new ThemeAnchorNode();\n      this.styleAnchorNode.dash = [0, 0];\n      this.styleAnchorNode.fillStyle = theme.anchorNode.fillStyle;\n      this.styleAnchorNode.lineWidth = theme.anchorNode.lineWidth;\n      this.styleAnchorNode.strokeStyle = theme.anchorNode.strokeStyle;\n    }\n    if (!this.styleHandleNode) {\n      this.styleHandleNode = new ThemeHandleNode();\n      this.styleHandleNode.dash = [0, 0];\n      this.styleHandleNode.fillStyle = theme.handleNode.fillStyle;\n      this.styleHandleNode.lineWidth = theme.handleNode.lineWidth;\n      this.styleHandleNode.strokeStyle = theme.handleNode.strokeStyle;\n    }\n    if (!this.styleLeaderline) {\n      this.styleLeaderline = new ThemeLeaderline();\n      this.styleLeaderline.dash = [0, 0];\n      this.styleLeaderline.lineWidth = theme.leaderline.lineWidth;\n      this.styleLeaderline.strokeStyle = theme.leaderline.strokeStyle;\n    }\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public updateStyleCustom(style: any): boolean {\n    let needEmit = false;\n    if (style.box !== undefined) {\n      this.styleBox.dash = style.box.dash ? style.box.dash : this.styleBox.dash;\n      this.styleBox.fillStyle = style.box.fill ? style.box.fill : this.styleBox.fillStyle;\n      this.styleBox.lineWidth = style.box.width ? style.box.width : this.styleBox.lineWidth;\n      this.styleBox.strokeStyle = style.box.strokeStyle\n        ? style.box.strokeStyle\n        : this.styleBox.strokeStyle;\n      needEmit = true;\n    }\n    if (style.anchorNode !== undefined) {\n      this.styleAnchorNode.dash = style.anchorNode.dash\n        ? style.anchorNode.dash\n        : this.styleAnchorNode.dash;\n      this.styleAnchorNode.fillStyle = style.anchorNode.fill\n        ? style.anchorNode.fill\n        : this.styleAnchorNode.fillStyle;\n      this.styleAnchorNode.lineWidth = style.anchorNode.width\n        ? style.anchorNode.width\n        : this.styleAnchorNode.lineWidth;\n      this.styleAnchorNode.strokeStyle = style.anchorNode.strokeStyle\n        ? style.anchorNode.strokeStyle\n        : this.styleAnchorNode.strokeStyle;\n      needEmit = true;\n    }\n    if (style.handleNode !== undefined) {\n      this.styleHandleNode.dash = style.handleNode.dash\n        ? style.handleNode.dash\n        : this.styleHandleNode.dash;\n      this.styleHandleNode.fillStyle = style.handleNode.fill\n        ? style.handleNode.fill\n        : this.styleHandleNode.fillStyle;\n      this.styleHandleNode.lineWidth = style.handleNode.width\n        ? style.handleNode.width\n        : this.styleHandleNode.lineWidth;\n      this.styleHandleNode.strokeStyle = style.handleNode.strokeStyle\n        ? style.handleNode.strokeStyle\n        : this.styleHandleNode.strokeStyle;\n      needEmit = true;\n    }\n    if (style.leaderline !== undefined) {\n      this.styleLeaderline.dash = style.leaderline.dash\n        ? style.leaderline.dash\n        : this.styleLeaderline.dash;\n      this.styleLeaderline.lineWidth = style.leaderline.width\n        ? style.leaderline.width\n        : this.styleLeaderline.lineWidth;\n      this.styleLeaderline.strokeStyle = style.leaderline.strokeStyle\n        ? style.leaderline.strokeStyle\n        : this.styleLeaderline.strokeStyle;\n      needEmit = true;\n    }\n\n    this.state.width = style.width || this.state.width;\n    this.tempColorRgba = style.colorRgba || this.tempColorRgba;\n    this.state.scale = style.scale || this.state.scale;\n\n    if (style.textColor !== undefined) {\n      this.state.textColor = style.textColor;\n    }\n    if (style.backgroundColor !== undefined) {\n      this.state.backgroundColor = style.backgroundColor;\n    }\n    if (style.lineDash) {\n      this.state.lineTypeId = style.lineDash;\n    }\n\n    this.isCustom = true;\n    if (needEmit && !this.geo.isUnderConstruction) {\n      this.geo.isTransform = true;\n      // this.geoHost.scene.imageAnnoApp.io.eventListenerAnnotation.TransformStack([this.geoHost.ToJSON()]);\n    }\n    return true;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public toJson(): any | undefined {\n    if (!this.isCustom) {\n      return undefined;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const output: any = {\n      box: {\n        dash: this.styleBox.dash,\n        fill: this.styleBox.fillStyle,\n        width: this.styleBox.lineWidth,\n        strokeStyle: this.styleBox.strokeStyle,\n      },\n      anchorNode: {\n        dash: this.styleAnchorNode.dash,\n        fill: this.styleAnchorNode.fillStyle,\n        width: this.styleAnchorNode.lineWidth,\n        strokeStyle: this.styleAnchorNode.strokeStyle,\n      },\n      handleNode: {\n        dash: this.styleHandleNode.dash,\n        fill: this.styleHandleNode.fillStyle,\n        width: this.styleHandleNode.lineWidth,\n        strokeStyle: this.styleHandleNode.strokeStyle,\n      },\n      leaderline: {\n        dash: this.styleLeaderline.dash,\n        width: this.styleLeaderline.lineWidth,\n        strokeStyle: this.styleLeaderline.strokeStyle,\n      },\n      width: this.state.width,\n      scale: this.state.scale,\n      colorRgba: this.tempColorRgba,\n    };\n\n    if (this.state.backgroundColor !== ThemeColorId.TitleColor) {\n      output.backgroundColor = this.state.backgroundColor;\n    }\n    if (this.state.textColor !== ThemeColorId.BackgroundColor) {\n      output.textColor = this.state.textColor;\n    }\n\n    if (this.state.lineTypeId !== LineTypeId.Continuous) {\n      output.lineDash = this.state.lineTypeId;\n    }\n    return output;\n  }\n}\n","import { ATextleaderlineWrapper } from '..';\nexport class Inspector {\n  public host: ATextleaderlineWrapper;\n  constructor(host: ATextleaderlineWrapper) {\n    this.host = host;\n  }\n  public update(ctx: CanvasRenderingContext2D) {\n    if (!this.host.scene.annotationInstance.implementations.app.INSPECTION) {\n      return;\n    }\n    ctx.font = `10px Arial`;\n    this.host.collision.isRenderable = true;\n\n    // if (!this.host.isRenderCollapse) {return;}\n    // this.Show(ctx);\n    this.showStatus(ctx);\n    // this.ShowVecCenter(ctx);\n\n    // this.ShowVecAnchor(ctx);\n    // this.ShowVecCenter(ctx);\n    this.showVecOffset(ctx);\n    this.showVecBound(ctx);\n\n    this.showLeaderlineInfo(ctx);\n    this.showLeaderlinePos(ctx);\n    this.host.collision.render(ctx);\n  }\n  public showLeaderlinePos(ctx: CanvasRenderingContext2D) {\n    if (this.host.vec) {\n      ctx.beginPath();\n      ctx.arc(this.host.vec.x, this.host.vec.y, 6.5, 0, 3.14 * 2);\n      ctx.closePath();\n      ctx.fillStyle = '#ff0000';\n      ctx.fill();\n    }\n  }\n  public showStatus(ctx: CanvasRenderingContext2D) {\n    const pos = this.host.v1;\n    ctx.beginPath();\n    ctx.arc(pos.x, pos.y, 5, 0, 3.14 * 2);\n    ctx.closePath();\n    ctx.fillStyle = '#ff0000';\n    ctx.fill();\n    let text = `IsTransform: ${this.host.isTransform}`;\n    ctx.fillText(text, pos.x + 10, pos.y - 10);\n\n    text = `, Zoom: ${this.host.renderer.zoomLevel}`;\n    ctx.fillText(text, pos.x + 100, pos.y - 10);\n  }\n  public ShowVecCenter(ctx: CanvasRenderingContext2D) {\n    const pos = this.host.vecCenter;\n    ctx.beginPath();\n    ctx.arc(pos.x, pos.y, 5, 0, 3.14 * 2);\n    ctx.closePath();\n    ctx.fillStyle = '#fff000';\n    ctx.fill();\n    const textX = `${pos.x}`;\n    const textY = `${pos.y}`;\n    ctx.fillText(textX, pos.x, pos.y + 10);\n    ctx.fillText(textY, pos.x, pos.y + 24);\n  }\n  public showVecBound(ctx: CanvasRenderingContext2D) {\n    const pos0 = this.host.v0;\n    ctx.beginPath();\n    ctx.arc(pos0.x, pos0.y, 5, 0, 3.14 * 2);\n    ctx.closePath();\n    ctx.fillStyle = '#00ff00';\n    ctx.fill();\n    let textX = `${pos0.x}`;\n    let textY = `${pos0.y}`;\n    ctx.fillText(textX, pos0.x, pos0.y + 10);\n    ctx.fillText(textY, pos0.x, pos0.y + 24);\n\n    const pos1 = this.host.v1;\n    ctx.beginPath();\n    ctx.arc(pos1.x, pos1.y, 5, 0, 3.14 * 2);\n    ctx.closePath();\n    ctx.fillStyle = '#00ff00';\n    ctx.fill();\n    textX = `${pos1.x}`;\n    textY = `${pos1.y}`;\n    ctx.fillText(textX, pos1.x, pos1.y + 10);\n    ctx.fillText(textY, pos1.x, pos1.y + 24);\n  }\n  public showVecAnchor(ctx: CanvasRenderingContext2D) {\n    const pos = this.host.vec;\n    ctx.beginPath();\n    ctx.arc(pos.x, pos.y, 2.5, 0, 3.14 * 2);\n    ctx.closePath();\n    ctx.fillStyle = '#ff0000';\n    ctx.fill();\n    const textX = `${pos.x}`;\n    const textY = `${pos.y}`;\n    ctx.fillText(textX, pos.x, pos.y + 10);\n    ctx.fillText(textY, pos.x, pos.y + 24);\n  }\n  public showVecOffset(ctx: CanvasRenderingContext2D) {\n    const pos = this.host.vecOffset;\n    ctx.beginPath();\n    ctx.arc(pos.x, pos.y, 2.5, 0, 3.14 * 2);\n    ctx.closePath();\n    ctx.fillStyle = '#0000ff';\n    ctx.fill();\n    const textX = `${pos.x}`;\n    const textY = `${pos.y}`;\n    ctx.fillText(textX, pos.x, pos.y + 10);\n    ctx.fillText(textY, pos.x, pos.y + 24);\n  }\n  public showLeaderlineInfo(ctx: CanvasRenderingContext2D) {\n    const pos = this.host.v1;\n    ctx.beginPath();\n    ctx.arc(pos.x, pos.y, 2.5, 0, 3.14 * 2);\n    ctx.closePath();\n    ctx.fillStyle = '#ff0000';\n    ctx.fill();\n    const leaderline = `${this.host.leaderline}`;\n\n    ctx.fillText(leaderline, pos.x, pos.y - 60);\n\n    if (this.host.attachedShape) {\n      ctx.fillText(this.host.attachedShape.type, pos.x, pos.y - 50);\n    } else {\n      ctx.fillText('None', pos.x, pos.y - 50);\n    }\n  }\n}\n","import { IOGeometry } from '../../../../../../lib/Extended/GeometryUtility';\nimport {\n  GType,\n  MouseEventData,\n  deepCopy,\n  getCenterVecFromVecs,\n  getDistance,\n  NVector3,\n} from '../../../../../../lib';\nimport { Scene } from '../../../../Scene';\nimport { AGeometryBase } from '../../../Common/Base/AGeometryBase';\nimport { TextLeaderlineDiv } from './Base/ATextLeaderlineDiv';\nimport { ATextLeaderlineLine } from './Base/ATextLeaderlineLine';\nimport {\n  ATextLeaderlineNode,\n  ATextLeaderlineNodeCircle,\n  ATextLeaderlineNodeDia,\n  CATEXT_NODE_RENDER_TYPE,\n} from './Base/ATextLeaderlineNode';\nimport { InteractionComponent } from './Component/InteractionComponent';\nimport { IOComponent } from './Component/IOComponent';\nimport { ProjectionComponent } from './Component/ProjectionComponent';\nimport { RendererComponent } from './Component/RendererComponent';\nimport { StyleComponent } from './Component/StyleComponent';\nimport { Inspector } from './Inspector';\nexport class ATextleaderlineWrapper extends AGeometryBase {\n  // ............................... component\n  public styleComponent: StyleComponent;\n  public renderer: RendererComponent;\n  public interaction: InteractionComponent;\n  public io: IOComponent;\n  public projection: ProjectionComponent;\n  // ............................... end component\n  public widthOffset = 0;\n  public heightOffset = 0;\n  public width: number;\n  public widthMin = 80;\n  public offDiv = 10;\n  public vec: NVector3;\n  public vecOffset: NVector3;\n  public vecCenter: NVector3;\n  public v0: NVector3;\n  public v1: NVector3;\n\n  public nodes: ATextLeaderlineNode[];\n  public vLeft: ATextLeaderlineNode;\n  public vRight: ATextLeaderlineNode;\n  public vUp: ATextLeaderlineNode;\n  public vDown: ATextLeaderlineNode;\n\n  public isSelectedReaderlineByClick = false;\n  // _isHover: boolean = false;\n  public enableDrag = true;\n\n  public nodeSelected: ATextLeaderlineNode | undefined = undefined;\n  public leaderline: ATextLeaderlineLine | undefined = undefined;\n  public nodeTargetLeaderLine: NVector3 | undefined = undefined;\n  // renderType: TEXT_RENDER_TYPE;\n  public offsetForTextEditor = 20;\n  public lineWidthForCheck = 5;\n\n  public mouseX = 0;\n  public mouseY = 0;\n\n  public txtDiv: TextLeaderlineDiv;\n  public contentHtmltemp: string;\n\n  public numToggleTheme = 0;\n\n  public attachedShape: AGeometryBase | undefined = undefined;\n\n  public inspector: Inspector;\n\n  public isRenderCollapse = false;\n  private _height: number;\n  private _heightPre: number;\n  static fromSmartDrawing(scene: Scene, vs: NVector3[]) {\n    const isUndo = false;\n    const v0 = vs[vs.length - 1];\n    const v1 = vs[0];\n    const txt = new ATextleaderlineWrapper(scene, v0.x, v0.y, 170, 40, isUndo);\n    txt.leadlineInteraction(v1.x, v1.y); // for init class\n    txt.leadlineInteraction(v1.x, v1.y); // for traslation\n    // txt.LeadlineInteraction(v1[0], v1[1]); // for traslation\n    if (txt.leaderline) {\n      // let v = scene.imageAnnoApp.geometryCommon.gcmdSupporting.ToMap(txt.leaderline.v2.x, txt.leaderline.v2.y);\n      // txt.leaderline.v2.long = v[0]; txt.leaderline.v2.lat = v[1];\n      // txt.leaderline.v2.sx = v[2]; txt.leaderline.v2.sy = v[3];\n    }\n    txt.isHover = false;\n    // txt.projection.UpdateGoeVec();\n    txt.interaction.updateSideNodes();\n    txt.interaction.updateConectNodes();\n    txt.txtDiv.updateDiv();\n\n    if (isUndo) {\n      scene.annotationInstance.io.eventListenerAnnotation.showTextStack(txt.toJSON());\n    }\n  }\n  static fromJSON(scene: Scene, g: IOGeometry, isUndo = false, isDeepCopy = false) {\n    // console.log('V2', g);\n    const p0 = [g.nodes[0].sx, g.nodes[0].sy]; // .toScreen(mp);\n    // console.log('before projection: the projected',g.nodes[0].sx, g.nodes[0].sy);\n    // console.log('after projection',p0);\n\n    const textContent = g.data['content'] as string;\n    const width = g.data['width'] ? g.data['width'] : 170;\n    const height = g.data['height'] ? g.data['height'] : 40;\n    const x = p0[0]; // + g.nodes[0].sx;\n    const y = p0[1]; // + g.nodes[0].sy; // - height * 0.5;\n    // console.log('x', x, 'y', y, 'width', width, 'height', height);\n    const txt = new ATextleaderlineWrapper(scene, x, y, width, height, isUndo, textContent);\n\n    if (g.nodes[1]) {\n      txt.initLeaderlineOffset(g.nodes[1].sx, g.nodes[1].sy);\n    }\n\n    txt.contentHtmltemp = textContent;\n\n    if (g.data['zoom']) {\n      txt.initZoomLevel(g.data['zoom'] as number);\n    }\n\n    // const xOff = g.nodes[1].sx - x;\n    // const yOff = g.nodes[1].sy - y;\n    // if (xOff !== 0 || yOff !== 0) {\n    //   txt.InitLeaderlineOffset(xOff, yOff)\n    // }\n\n    txt.isUnderConstruction = true;\n    if (g.styles) {\n      txt.updateStyleCustom(g.styles);\n    }\n    txt.isUnderConstruction = false;\n\n    // if (g.nodes[2]) {\n    //   // console.log(g.nodes[2].sx, g.nodes[2].sy);\n    //   let v2 = scene.imageAnnoApp.geometryCommon.gcmdSupporting.ToScreenFromProjectedPos(\n    //     g.nodes[2].sx,\n    //     g.nodes[2].sy\n    //   ); // .toScreen(mp);\n    //   // console.log(v2);\n    //   txt.LeadlineInteraction(v2[0], v2[1]); // for init class\n    //   txt.LeadlineInteraction(v2[0], v2[1]); // for traslation\n    //   if (txt.leaderline) {\n    //     let v = scene.imageAnnoApp.geometryCommon.gcmdSupporting.ToMap(\n    //       txt.leaderline.v2.x,\n    //       txt.leaderline.v2.y\n    //     );\n    //     // console.log('ddd', txt.leaderline.v2.x, txt.leaderline.v2.y);\n    //     txt.leaderline.v2.long = v[0];\n    //     txt.leaderline.v2.lat = v[1];\n    //     txt.leaderline.v2.sx = v[2];\n    //     txt.leaderline.v2.sy = v[3];\n    //   }\n    // }\n    if (isDeepCopy) {\n      txt.id = scene.getUUID();\n    } else {\n      txt.id = g.id;\n    }\n    if (txt.txtDiv.divText) {\n      txt.txtDiv.divText.id = `text-editor-${txt.id}`;\n    }\n\n    txt.isHiddenValue = g.isHidden;\n    if (g.isHidden) {\n      txt.visibilityValue = 0;\n    } else {\n      txt.visibilityValue = 1;\n    }\n\n    // txt.projection.UpdateGoeVec();\n    txt.computeCenterVec(); // we need to do this update cen vec after populating leader line\n    txt.txtDiv.updateDiv();\n    txt.updateVecs();\n\n    if (isUndo) {\n      scene.annotationInstance.io.eventListenerAnnotation.showTextStack(txt.toJSON());\n    }\n    txt.isSelected = false;\n    txt.isHover = false;\n    txt.isTransform = false;\n    txt.initVecsHistory(); // reset vec history for the tranformation stack\n    txt.initHeightFromJSON(height);\n    return txt;\n  }\n  // ............................................................\n  static mouseLeftClick(scene: Scene, e: MouseEventData) {\n    if (scene.capture !== undefined) {\n      return;\n    }\n    scene.annotationInstance.activeCommandController.goToACMode();\n    const t = new ATextleaderlineWrapper(scene, e.x, e.y);\n    t.isSelected = true;\n    scene.Capture = t;\n    t.dummy();\n  }\n  static mouseMove(e: MouseEventData) {\n    //\n  }\n  static ESC() {\n    // for (let i = 0; i < AText.list.length; ++i) { AText.list[i].IsEditiable = false; }\n  }\n  constructor(\n    scene: Scene,\n    x: number,\n    y: number,\n    width = 170,\n    height = 40,\n    isUndo = false,\n    textContent = 'Start typing here.'\n  ) {\n    super(scene);\n    this.inspector = new Inspector(this);\n\n    this.isUndo = isUndo;\n    this.type = GType.TEXT_LEADERLINE;\n\n    this.vec = new NVector3(x, y);\n    this.vecOffset = new NVector3(this.vec.x, this.vec.y);\n    // this.vecLeaderline\n    this.v0 = new NVector3(this.vec.x - this.width * 0.5, this.vec.y - this.height);\n    this.v1 = new NVector3(this.vec.x + this.width * 0.5, this.vec.y);\n\n    // this.vec = new NVector3(x, y + this.height * 0.5 );\n    // this.vecOffset = new NVector3(this.vec.x, this.vec.y);\n    // // this.vecLeaderline\n    // this.v0 = new NVector3(this.vec.x - this.width * 0.5, this.vec.y - this.height);\n    // this.v1 = new NVector3(this.vec.x + this.width * 0.5, this.vec.y);\n\n    this.initComponent();\n    this.initZoomLevel();\n    // this.projection.UpdateGoeVec();\n    this.computeCenterVec();\n\n    this.txtDiv = new TextLeaderlineDiv(this);\n    if (this.txtDiv.divText) {\n      this._heightPre = this.txtDiv.divText.clientHeight as number;\n    }\n    this.width = width;\n    this.height = height; // 40; // - 5;\n\n    this.vLeft = new ATextLeaderlineNodeCircle(\n      this,\n      this.v0.x,\n      this.v0.y + this.height * 0.5,\n      CATEXT_NODE_RENDER_TYPE.LEFT\n    );\n    this.vRight = new ATextLeaderlineNodeCircle(\n      this,\n      this.v1.x,\n      this.v0.y + this.height * 0.5,\n      CATEXT_NODE_RENDER_TYPE.RIGHT\n    );\n    this.vUp = new ATextLeaderlineNodeDia(\n      this,\n      this.v0.x + this.width * 0.5,\n      this.v0.y,\n      CATEXT_NODE_RENDER_TYPE.DIAMOND\n    );\n    this.vDown = new ATextLeaderlineNodeDia(\n      this,\n      this.v0.x + this.width * 0.5,\n      this.v0.y + this.height,\n      CATEXT_NODE_RENDER_TYPE.DIAMOND\n    );\n    this.nodes = [this.vLeft, this.vRight, this.vUp, this.vDown];\n\n    this.trajectoryVecs = [];\n    this.initVecsHistory();\n    this.visTrajector = true;\n    this.isDrop = false;\n    this.isDrag = false;\n    this.isSelectedValue = false;\n    this.isLeave = true;\n    this.isHoverValue = false;\n    this.isGeoPos = true;\n\n    this.isUnderConstruction = false;\n    this.collision.offset = 1;\n    // this.t = 0.0;\n    // this.tDown1 = 0.0, this.tDown2 = 0.0;\n    // this.tOver = 0.0, this.tUp = 0.0;\n\n    this.updateVecs();\n    this.updateBoundingBox();\n\n    // this.wrapping = new Wrapping(this);\n    // this.wrapping.InitProjectionShapesFromJSON(this.GetVecs());\n    // this.wrapping.needWrappingToLeft = true;\n    // this.wrapping.needWrappingToRight = true;\n    // this.wrapping.isIntersectLeft = true;\n    // console.log(this.wrapping);\n    // this.wrapping.UpdateProjection(this.GetVecs());\n\n    this.scene.addATextleaderlineWrapper(this);\n    if (!this.isUndo) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(this.toJSON());\n      this.txtDiv.hideTextDiv();\n      this.txtDiv.showTextDiv();\n      this.txtDiv.focusOnTextDiv();\n      return;\n    }\n  }\n  public emitTransformationStackRightNode() {\n    for (let i = 0; i < this.nodes.length; ++i) {\n      if (this.nodes[i].type === CATEXT_NODE_RENDER_TYPE.RIGHT) {\n        // this.nodes[i].EmitTransformationStackRightNode();\n      }\n    }\n    // this.SnapForPoint();\n  }\n  public updateVecsBox() {\n    if (this.leaderline) {\n      if (this.renderer.zoomDifference > 0) {\n        this.vecOffset.x = this.vec.x + this.widthOffset; // * 0.3;\n        this.vecOffset.y = this.vec.y + this.heightOffset; // * 0.3;\n      } else {\n        this.vecOffset.x = this.vec.x + this.widthOffset;\n        this.vecOffset.y = this.vec.y + this.heightOffset;\n      }\n    } else {\n      this.vecOffset.x = this.vec.x;\n      this.vecOffset.y = this.vec.y;\n    }\n\n    this.v0.x = this.vecOffset.x - this.width * 0.5;\n    this.v0.y = this.vecOffset.y - this.height;\n    this.v1.x = this.vecOffset.x + this.width * 0.5;\n    this.v1.y = this.vecOffset.y;\n    this.interaction.updateSideNodes();\n    this.interaction.updateConectNodes();\n  }\n  private initComponent() {\n    this.io = new IOComponent(this);\n    this.projection = new ProjectionComponent(this);\n    this.interaction = new InteractionComponent(this);\n    this.styleComponent = new StyleComponent(this);\n    this.renderer = new RendererComponent(this);\n  }\n  public initZoomLevel(level = 1) {\n    this.renderer.zoomLevel = level;\n  }\n\n  public remove(needEmit = true): void {\n    // console.trace();\n    this.io.remove(needEmit);\n  }\n  public initVecsHistory() {\n    this.vecsHistory = [];\n    this.vecsHistory.push(\n      deepCopy(this.vecCenter),\n      deepCopy(this.vecCenter),\n      deepCopy(this.vecCenter)\n    );\n  }\n  public removeByAttachedShape() {\n    this.io.removeByAttachedShape();\n  }\n  public removeLeaderline() {\n    this.io.RemoveLeaderline();\n  }\n  public removeDiv() {\n    this.io.removeDiv();\n  }\n  public hide(): void {\n    return;\n  }\n  public deepCopy(x: number, y: number, z = 0) {\n    return this.io.deepCopy(x, y, z);\n  }\n  // ................................................................................. projection\n  public updateScreenVecForPan() {\n    // this.projection.UpdateScreenVecByProjectedPos();\n  }\n  public outExtent() {\n    this.projection.outExtent();\n  }\n  public inExtent() {\n    this.projection.inExtent();\n  }\n  public updateScreenVec() {\n    // this.projection.UpdateScreenVecByProjectedPos();\n    // this.projection.UpdateGoeVec();\n  }\n  // ................................................................................. interaction\n  public initLeaderlineOffset(x: number, y: number) {\n    // console.log('from class', x, y);\n    // if (x === 0 && y === 0 ) { return; }\n    // this.leaderline = new ATextLeaderlineLine(this, this.GetClosestNodeDia(x, y));\n    this.widthOffset = x;\n    this.heightOffset = y;\n    // this.vecOffset.x += x;\n    // this.vecOffset.y += y;\n    this.interaction.leadlineInteraction(x, y);\n    this.updateVecs();\n  }\n  public mouseLeftClick(x: number, y: number) {\n    this.interaction.mouseLeftClick(x, y);\n  }\n  public mouseDoubleClick() {\n    this.interaction.mouseDoubleClick();\n  }\n  public mouseUp() {\n    // console.log('mouse up from class');\n    this.interaction.mouseUp();\n  }\n  public isMouseInside(x: number, y: number): boolean {\n    return this.interaction.isMouseInside(x, y);\n  }\n  public isMouseInsideDiv(x: number, y: number) {\n    return this.interaction.isMouseInsideDiv(x, y);\n  }\n  public translate(x: number, y: number) {\n    /* */\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    this.interaction.translateByMouseEventData(e);\n  }\n  public leadlineInteraction(x: number, y: number) {\n    this.interaction.leadlineInteraction(x, y);\n  }\n  // ................................................................................. IO projection\n  public toJSON(): IOGeometry {\n    return this.io.toJSON();\n  }\n  public getLog(): string {\n    return this.io.getLog();\n  }\n  public processingUpdate(data: string) {\n    this.io.processingUpdate(data);\n  }\n  // ................................................................................. translate stack\n  public updateVecsHistory() {\n    this.vecCenter = this.computeCenterVec();\n    this.vecsHistory.push(deepCopy(this.vecCenter));\n    while (this.vecsHistory.length > 3) {\n      this.vecsHistory.shift();\n    }\n  }\n  // ................................................................................. render\n  public updateOptimizer() {\n    //\n  }\n  public update() {\n    // this.projection.UpdateGoeVec(); // in order to update vec for isMove\n  }\n  public renderLeadline(ctx: CanvasRenderingContext2D) {\n    this.update(); // we need to do the update because this renderleadeline function is executed before renderPost!!!\n    this.renderer.renderLeadline(ctx);\n  }\n  // public Render(ctx: CanvasRenderingContext2D) {\n  //   this.RenderPre(ctx);\n  //   if (Number.isNaN(this.vec.x)) { this.OutExtent(); } else { this.InExtent(); }\n  //   // if (this.isRemove || !this.isRenderable) { return; }\n  //   // if (this.isHidden && this.visibility < 0.01) { return; }\n  //   if (this.isAniEasing) { this.Easing(); }\n  //   if (this.isAniAccel) { this.Accelerating(); }\n  //   if (this.isUndo && this.renderer) {\n  //     this.renderer.t = 1;\n  //     this.renderer.tDown1 = 1;\n  //     this.renderer.tDown2 = 1;\n  //   }\n  //   if (this.needBlackhole) { this.RemoveByBlackhole(); }\n  //   this.IsMoveUpdate();\n  //   this.UpdatePopup();\n  //   this.UpdateHoverPost();\n  //   if (this.scene.imageAnnoApp.activeCommandController.acProperties.needCollisionDetection) {\n  //     this.collision.Render(ctx);\n  //   }\n  //   this.RenderPost(ctx);\n  // }\n  public renderPost(ctx: CanvasRenderingContext2D): void {\n    this.renderer.renderPost(ctx);\n    this.inspector.update(ctx);\n  }\n  // .................................................................................\n  public getNode() {\n    return [this.vec, this.vecOffset];\n  }\n  public updateVecs() {\n    this.updateScreenVecForPan();\n    this.updateVecsBox();\n    this.interaction.updateSideNodes();\n    this.interaction.updateConectNodes();\n    this.txtDiv.updateDiv();\n    this.updateBoundingBox();\n  }\n  public getClosestNodeDia(x: number, y: number) {\n    const d0 = getDistance(new NVector3(x, y), this.vUp.vec);\n    const d1 = getDistance(new NVector3(x, y), this.vDown.vec);\n    if (d0 < d1) {\n      this.vUp.isConnected = true;\n      this.vDown.isConnected = false;\n      return this.vUp;\n    }\n    this.vUp.isConnected = false;\n    this.vDown.isConnected = true;\n    return this.vDown;\n  }\n  public findClosestNodeDia() {\n    if (this.leaderline) {\n      const d0 = getDistance(this.leaderline.v1, this.vUp.vec);\n      const d1 = getDistance(this.leaderline.v1, this.vDown.vec);\n      if (d0 < d1) {\n        this.vUp.isConnected = true;\n        this.vDown.isConnected = false;\n\n        // this.leaderline.v0 = this.vUp.vec;\n\n        this.leaderline.v0.x = this.vUp.vec.x;\n        this.leaderline.v0.y = this.vUp.vec.y;\n        this.leaderline.v0.z = this.vUp.vec.z;\n      } else {\n        this.vUp.isConnected = false;\n        this.vDown.isConnected = true;\n\n        // this.leaderline.v0 = this.vDown.vec;\n\n        this.leaderline.v0.x = this.vDown.vec.x;\n        this.leaderline.v0.y = this.vDown.vec.y;\n        this.leaderline.v0.z = this.vDown.vec.z;\n      }\n    }\n  }\n  public computeCenterVec() {\n    this.vecCenter = getCenterVecFromVecs(this.getVecs());\n    return this.vecCenter;\n  }\n  public getVecs() {\n    return [this.v0, this.v1, this.vec];\n  }\n  public isMoveUpdate() {\n    if (this.vecsHistory.length < 1) {\n      return;\n    }\n\n    if (\n      (this.vecCenter, this.scene.annotationInstance.activeCommandController.zoomLevelForMoving)\n    ) {\n      this.isMove = false;\n      // console.log('static');\n    } else {\n      // console.log('moving....');\n      this.isMove = true;\n      this.isTransform = true;\n    }\n  }\n  // .................................................................................\n  public snapForPoint() {\n    // console.log(this);\n    // const m = this.scene.imageAnnoApp.activeCommandController.m\n    const n = this.scene.annotationInstance.geometryCommon.gcmdProcessing.getClosestNodeForSnapping(\n      this.vec.x,\n      this.vec.y,\n      25\n    );\n    //\n    // console.log('SnapForPoint', n)\n    if (n) {\n      if (this.leaderline) {\n        if (this.attachedShape) {\n          this.attachedShape.textLeaderline = undefined;\n          this.attachedShape = undefined;\n          // console.log('select a shape', n, this.attachedShape);\n        }\n        n.textLeaderline = this;\n        // console.log('n', n);\n        const v = n.getVecForSnapping();\n        if (v) {\n          this.vec.x = this.leaderline.v2.x = v.x;\n          this.vec.y = this.leaderline.v2.y = v.y;\n          this.vec.z = this.leaderline.v2.z = v.z;\n          this.attachedShape = n;\n\n          // this.widthOffset = this.vecOffset.x - this.vec.x;\n          // if(this.vUp.isConnected) {\n          //   this.heightOffset = this.vecOffset.y - this.vec.y + this.height;\n          // }else {\n          //   this.heightOffset = this.vecOffset.y - this.vec.y;\n          // }\n\n          // this.leaderline.v2.x - this.leaderline.\n          // this.scene.imageAnnoApp.io.eventListenerAnnotation.TransformStack([this.ToJSON()]);\n        }\n      }\n    } else {\n      // const n = this.scene.imageAnnoApp.geometryCommon.gcmdProcessing.GetclosestNode(this.leaderline.v2.x, this.leaderline.v2.y, 25);\n      if (this.attachedShape) {\n        this.attachedShape.textLeaderline = undefined;\n        this.attachedShape = undefined;\n        // console.log('select on map', n, this.attachedShape);\n      }\n    }\n  }\n  public initSnapForPointForUndo() {\n    // if (this.leaderline && this.leaderline.v2) {\n    const n:\n      | AGeometryBase\n      | undefined = this.scene.annotationInstance.geometryCommon.gcmdProcessing.getClosestNodeForSnapping(\n      this.vec.x,\n      this.vec.y,\n      25\n    );\n    // console.log('InitSnapForPointForUndo', n)\n    if (n !== undefined) {\n      n.textLeaderline = this;\n      // this.leaderline.v2 = n.vec;\n      const v = n.getVecForSnapping();\n\n      if (v) {\n        this.vec.x = v.x;\n        this.vec.y = v.y;\n        this.vec.z = v.z;\n        this.attachedShape = n;\n        this.isTransform = true;\n      }\n      // this.scene.imageAnnoApp.io.eventListenerAnnotation.TransformStack( [this.ToJSON()]);\n      //    console.log(this.attachedShape);\n      // }\n    }\n    // }\n  }\n  // public MouseRightClick() {\n  //   if (!this.scene.imageAnnoApp.implementations.app.CONFIG.LAB) { return; }\n  //   this.renderer.isTransparentBG = !this.renderer.isTransparentBG;\n\n  //   const json = this.ToJSON();\n  //   if (json) { this.scene.imageAnnoApp.io.eventListenerAnnotation.TransformStack([json]);}\n  // }\n  // ................................................................................. io\n  public get isSelected() {\n    return this.interaction.IsSelected;\n  }\n  public set isSelected(v: boolean) {\n    this.interaction.IsSelected = v;\n  }\n  public get IsSelectedReaderline() {\n    return this.interaction.IsSelectedReaderline;\n  }\n  public set IsSelectedReaderline(v: boolean) {\n    this.interaction.IsSelectedReaderline = v;\n  }\n  public get isHover() {\n    return this.interaction.IsHover;\n  }\n  public set isHover(v: boolean) {\n    this.interaction.IsHover = v;\n  }\n  public get height() {\n    return this._height;\n  }\n  public set height(v: number) {\n    if (v === 0) {\n      return;\n    }\n    if (!this.renderer.hasSnippet && this.isCollapse) {\n      v += 20; // offset value for height\n    }\n    this._height = v;\n    const val = v + this.txtDiv.offsetForTextDiv * 2;\n    this._height = val;\n    this.v0.y = this.v1.y - val; // the box increase in size upwards\n  }\n  public initHeightFromJSON(v: number) {\n    v -= 20; // offset value for height\n    const val = v + this.txtDiv.offsetForTextDiv * 2;\n    this._height = val;\n    this.v0.y = this.v1.y - val; // the box increase in\n    this.update();\n    this.scene.annotationInstance.activeCommandController.acProperties.needExecuteOptimizer = true;\n  }\n  public updateDivHeight() {\n    if (this.txtDiv.divText && this._heightPre !== this.txtDiv.divText.clientHeight) {\n      this._heightPre = this.txtDiv.divText.clientHeight;\n      this.height = this.txtDiv.divText.clientHeight;\n\n      this.interaction.updateSideNodes();\n      this.interaction.updateConectNodes();\n      this.txtDiv.updateDiv();\n    }\n  }\n  // public get IsTransform() {\n  //   return this._isTransform;\n  // }\n  // public set IsTransform(v: boolean) {\n  //   // console.log(v);\n  //   // console.trace();\n  //   this._isTransform = v;\n  // }\n  public updateBoundingBox() {\n    const scale = 1; // this.scene.imageAnnoApp.customization.themeCurrent.textleaderline.scale;\n    const width = (this.v1.x - this.v0.x) * scale;\n    const height = Math.abs(this.v1.y - this.v0.y); // * scale;\n    this.collision.minVec = new NVector3(this.vecOffset.x - width * 0.5, this.vecOffset.y - height);\n    this.collision.maxVec = new NVector3(this.vecOffset.x + width * 0.5, this.vecOffset.y);\n    // this.scene.imageAnnoApp.renderer.agentBaseOptimizer.needUpdateComputeCollision = true;\n  }\n  public set isCollapse(v: boolean) {\n    if (v) {\n      this.isRenderCollapse = true;\n      if (this.txtDiv.divText && !this.txtDiv.divText.hidden) {\n        this.txtDiv.divText.hidden = true;\n      }\n    } else {\n      this.isRenderCollapse = false;\n      if (this.txtDiv.divText && this.txtDiv.divText.hidden) {\n        this.txtDiv.divText.hidden = false;\n      }\n    }\n  }\n  public get isCollapse() {\n    return this.isRenderCollapse;\n  }\n  public fromJSON(g: IOGeometry, isUndo: boolean = false, isDeepCopy: boolean = false) {\n    // console.log('V2', g);\n    const p0 = [g.nodes[0].sx, g.nodes[0].sy]; // .toScreen(mp);\n    // console.log('before projection: the projected',g.nodes[0].sx, g.nodes[0].sy);\n    // console.log('after projection',p0);\n\n    const textContent = g.data['content'] as string;\n    const width = g.data['width'] ? g.data['width'] : 170;\n    const height = g.data['height'] ? g.data['height'] : 40;\n    const x = p0[0]; // + g.nodes[0].sx;\n    const y = p0[1]; // + g.nodes[0].sy; // - height * 0.5;\n    // console.log('x', x, 'y', y, 'width', width, 'height', height);\n    const txt = new ATextleaderlineWrapper(this.scene, x, y, width, height, isUndo, textContent);\n\n    if (g.nodes[1]) {\n      txt.initLeaderlineOffset(g.nodes[1].sx, g.nodes[1].sy);\n    }\n\n    txt.contentHtmltemp = textContent;\n\n    if (g.data['zoom']) {\n      txt.initZoomLevel(g.data['zoom'] as number);\n    }\n\n    // const xOff = g.nodes[1].sx - x;\n    // const yOff = g.nodes[1].sy - y;\n    // if (xOff !== 0 || yOff !== 0) {\n    //   txt.InitLeaderlineOffset(xOff, yOff)\n    // }\n\n    txt.isUnderConstruction = true;\n    if (g.styles) {\n      txt.updateStyleCustom(g.styles);\n    }\n    txt.isUnderConstruction = false;\n\n    // if (g.nodes[2]) {\n    //   // console.log(g.nodes[2].sx, g.nodes[2].sy);\n    //   let v2 = scene.imageAnnoApp.geometryCommon.gcmdSupporting.ToScreenFromProjectedPos(\n    //     g.nodes[2].sx,\n    //     g.nodes[2].sy\n    //   ); // .toScreen(mp);\n    //   // console.log(v2);\n    //   txt.LeadlineInteraction(v2[0], v2[1]); // for init class\n    //   txt.LeadlineInteraction(v2[0], v2[1]); // for traslation\n    //   if (txt.leaderline) {\n    //     let v = scene.imageAnnoApp.geometryCommon.gcmdSupporting.ToMap(\n    //       txt.leaderline.v2.x,\n    //       txt.leaderline.v2.y\n    //     );\n    //     // console.log('ddd', txt.leaderline.v2.x, txt.leaderline.v2.y);\n    //     txt.leaderline.v2.long = v[0];\n    //     txt.leaderline.v2.lat = v[1];\n    //     txt.leaderline.v2.sx = v[2];\n    //     txt.leaderline.v2.sy = v[3];\n    //   }\n    // }\n    if (isDeepCopy) {\n      txt.id = this.scene.getUUID();\n    } else {\n      txt.id = g.id;\n    }\n    if (txt.txtDiv.divText) {\n      txt.txtDiv.divText.id = `text-editor-${txt.id}`;\n    }\n\n    txt.isHiddenValue = g.isHidden;\n    if (g.isHidden) {\n      txt.visibilityValue = 0;\n    } else {\n      txt.visibilityValue = 1;\n    }\n\n    // txt.projection.UpdateGoeVec();\n    txt.computeCenterVec(); // we need to do this update cen vec after populating leader line\n    txt.txtDiv.updateDiv();\n    txt.updateVecs();\n\n    if (isUndo) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.showTextStack(txt.toJSON());\n    }\n    txt.isSelected = false;\n    txt.isHover = false;\n    txt.isTransform = false;\n    txt.initVecsHistory(); // reset vec history for the tranformation stack\n    txt.initHeightFromJSON(height);\n    return txt;\n  }\n}\n","import { RendererComponent as _RendererComponent } from '../../../../Common/Base/ComponentTemplate/RendererComponent';\nimport { AFreehandSmartDrawing } from '../AFreehandSmartDrawing';\nexport class RendererComponent extends _RendererComponent {\n  public host: AFreehandSmartDrawing;\n  constructor(host: AFreehandSmartDrawing) {\n    super(host);\n    this.host = host;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.timer.update();\n\n    if (this.host.vecs.length < 2) {\n      return;\n    } else if (this.host.isFreehandDrawing) {\n      this.host.scene.annotationInstance.renderer.draw.shape.freeHand.freeHandbyVecs(\n        ctx,\n        this.host.vecs,\n        this.host.scene.annotationInstance.activeCommandController.activeColorController.activeColor,\n        this.host.scene.annotationInstance.renderer.imageAnnoApp.customization.themeCurrent.freehand.lineWidth * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal,\n        this.host.isClosed\n      );\n    } else {\n      this.host.remove();\n    }\n  }\n}\n","import { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { AFreehandSmartDrawing } from '../AFreehandSmartDrawing';\nexport class StyleComponent extends _StyleComponent {\n  public geo: AFreehandSmartDrawing;\n  constructor(geo: AFreehandSmartDrawing) {\n    super(geo);\n    this.updateStyle();\n    this.geo.styleComponent.updateColor();\n  }\n  public updateStyle() {\n    RenderStyle.updateRenderStyleFH(\n      this.renderStyle,\n      this.geo.scene.annotationInstance.customization.themeCurrent\n    );\n    RenderStyle.updateRenderStyleFH(\n      this.renderStyleNode,\n      this.geo.scene.annotationInstance.customization.themeCurrent\n    );\n  }\n}\n","import {\n  FHType, GType, MLModelType,\n  Optimizer,\n  MouseEventData,\n  getInterpolatedArray,\n  isContainNagativeNumber,\n  computeDotProducts,\n  computeDotProductsWithCenter,\n  getDistance,\n  getDotProduct,\n  normalize,\n  NVector3,\n  sub,\n  // DouglasPeucker,\n} from '../../../../../../lib';\nimport { Scene } from '../../../../Scene';\nimport { AGeometryBase } from '../../../Common/Base/AGeometryBase';\nimport { ACircle } from '../../FamilyArea/ACircle/ACircle';\nimport { APolygonWrapper } from '../../FamilyArea/APolygonWrapper/APolygonWrapper';\nimport { ARectangleWrapper } from '../../FamilyArea/ARectangleWrapper/ARectangleWrapper';\nimport { ACurve } from '../../FamilyCurve/ACurveWrapper/ACurve';\nimport { AArrow } from '../../FamilyLine/AArrowWrapper/AArrow';\nimport { APoint } from '../../FamilyPoint/Base/APoint';\nimport { ATextleaderlineWrapper } from '../../FamilyText/ATextleaderline';\nimport { RendererComponent } from './Component/RendererComponent';\nimport { StyleComponent } from './Component/StyleComponent';\nexport class AFreehandSmartDrawing extends AGeometryBase {\n  // public static list: AFreehandSmartDrawing[] = [];\n  public static isClose = false;\n  public static construction: AFreehandSmartDrawing | undefined;\n  public static dotArrayForTrainOrigin: number[][] = [];\n  public static dotVecArrayForTrainOrigin: number[][] = [];\n  public static dotArrayForTrainSimplify: number[][] = [];\n  public static dotVecArrayForTrainSimplify: number[][] = [];\n  // public static dotVecArrayForTrainOrigin150: number[][] = [];\n  // public static dotVecArrayForTrainOrigin300: number[][] = [];\n  // public static dotVecArrayForTrainOrigin500: number[][] = [];\n  // public static dotVecArrayForTrainSimplify150: number[][] = [];\n  // public static dotVecArrayForTrainSimplify300: number[][] = [];\n  // public static dotVecArrayForTrainSimplify500: number[][] = [];\n  public static isTooltipRenderable = false;\n  public static vecTooltip: number[] = [0, 0];\n\n  public vecs: NVector3[] = [];\n  public modelType: MLModelType;\n  public type: GType;\n  public optimizer: Optimizer;\n  public typeFreehand: FHType;\n  public direction: number;\n  public isFreehandDrawing: boolean;\n  public isClosed: boolean;\n  public col: string;\n\n  // canvasTooltip: CanvasTooltip;\n\n  // ............................................................... static\n  // public static Add(g: AFreehandSmartDrawing) { AFreehandSmartDrawing.list.push(g); }\n  // public static Remove(g: AFreehandSmartDrawing) { AFreehandSmartDrawing.list.splice(AFreehandSmartDrawing.list.indexOf(g), 1); }\n\n  // ............................................................... construction\n  public static cancel() {\n    if (AFreehandSmartDrawing.construction !== undefined) {\n      AFreehandSmartDrawing.construction.remove();\n    }\n    AFreehandSmartDrawing.construction = undefined;\n  }\n  // ............................................................... mouse event\n  public static mouseDown(scene: Scene, e: MouseEventData) {\n    scene.annotationInstance.geometryCommon.gcmdSelecting.deSelectAllObjects();\n    AFreehandSmartDrawing.isTooltipRenderable = false;\n  }\n  public static mouseDrag(e: MouseEventData) {\n    AFreehandSmartDrawing.isTooltipRenderable = false;\n    if (AFreehandSmartDrawing.construction) {\n      AFreehandSmartDrawing.construction.addVecs(e.x, e.y);\n    }\n  }\n  public static mouseUp(scene: Scene, e: MouseEventData) {\n    if (AFreehandSmartDrawing.construction !== undefined) {\n      if (AFreehandSmartDrawing.construction.vecs.length < 2) {\n        return;\n      }\n\n      AFreehandSmartDrawing.construction.computeVector();\n      AFreehandSmartDrawing.construction.isFreehandDrawing = false;\n      AFreehandSmartDrawing.construction = undefined;\n      scene.annotationInstance.activeCommandController.goToACMode();\n    }\n  }\n  public static mouseMove(\n    scene: Scene,\n    e: MouseEventData,\n    type: FHType,\n    modelType: MLModelType = MLModelType.None\n  ) {\n    if (AFreehandSmartDrawing.construction === undefined) {\n      const cGeo = scene.annotationInstance.geometryCommon.gcmdProcessing.findAtPoint(e);\n      if (cGeo === undefined) {\n        AFreehandSmartDrawing.construction = new AFreehandSmartDrawing(scene, type, modelType);\n      }\n    }\n    AFreehandSmartDrawing.vecTooltip[0] = e.x;\n    AFreehandSmartDrawing.vecTooltip[1] = e.y;\n  }\n  constructor(scene: Scene, type: FHType, modelType: MLModelType = MLModelType.None) {\n    super(scene);\n    this.modelType = modelType;\n    this.typeFreehand = type;\n    this.direction = 0;\n    this.isFreehandDrawing = true;\n    this.isClosed = AFreehandSmartDrawing.isClose;\n    this.optimizer = Optimizer.DouglasPeucker;\n    const col = this.scene.annotationInstance.customization.themeCurrent.freehand\n      .strokeStyleFirstArray;\n    this.col = `rgba(${col[0]}, ${col[1]}, ${col[2]}, 0.5}`;\n    this.initComponent();\n    AFreehandSmartDrawing.construction = this;\n    // this.canvasTooltip = new CanvasTooltip(this);\n    this.init();\n  }\n  private initComponent() {\n    this.styleComponent = new StyleComponent(this);\n    this.renderer = new RendererComponent(this);\n  }\n  private init() {\n    this.scene.addAFreehandSmartDrawing(this);\n  }\n  public addVecs(x: number, y: number) {\n    this.vecs.push(new NVector3(x, y));\n  }\n  private checkDotProduct(vs: NVector3[]): NVector3[] {\n    const vecs: NVector3[] = [];\n    const step = 5;\n    vecs.push(vs[0]);\n    for (let i = 0; i < vs.length - step; ++i) {\n      let v = sub(vs[i], vs[i + 1]);\n      v = normalize(v);\n      let vv = sub(vs[i], vs[i + 2]);\n      vv = normalize(vv);\n      const vvv = sub(vs[i], vs[i + 3]);\n      vv = normalize(vvv);\n      let vvvv = sub(vs[i], vs[i + 4]);\n      vvvv = normalize(vvvv);\n      let vvvvv = sub(vs[i], vs[i + 5]);\n      vvvvv = normalize(vvvvv);\n\n      const d0 = getDotProduct(v, vv);\n      const d1 = getDotProduct(v, vvv);\n      const d2 = getDotProduct(v, vvv);\n      // console.log(d0, d1, d2);\n      // let d3 = DotProduct(v, vvvv);\n      if (isNaN(d0) || isNaN(d1) || isNaN(d2)) {\n        // || isNaN(d3)) {// if (v3 < 0.3) {\n        vecs.push(vs[i]);\n      }\n    }\n    vecs.push(vs[vs.length - 1]);\n    return vecs;\n  }\n  private divVecs(vs: NVector3[]): NVector3[] {\n    let vecs: NVector3[] = [];\n    vecs = vs;\n    return vecs;\n  }\n  private getPtByVs(v: NVector3[]): void {\n    let i = v.length;\n    while (i--) {\n      const g = new APoint(this.scene, v[i].x, v[i].y);\n      g.dummy();\n    }\n  }\n  async computeVector() {\n    let vs = this.vecs;\n\n    this.dotProductProcess(vs);\n    // console.log(AFreehandSmartDrawing.dotVecArrayForTrain);\n    if (this.modelType === MLModelType.DeepLearning) {\n      if (\n        false\n        // this.scene.annotationInstance.implementations.app.addon &&\n        // this.scene.annotationInstance.implementations.app.addon.smartDrawing\n      ) {\n        const dotPrediction = computeDotProducts(vs);\n        const prediction = this.predictDrawingShape(dotPrediction)[0];\n        // console.log(prediction);\n        this.getShapeFromPrediction(prediction, vs);\n        return;\n      }\n      // console.debug('a implementation of Smart Drawing is needed!' );\n    }\n\n    if (this.typeFreehand === FHType.SmartDrawing) {\n      vs = this.checkDotProduct(vs);\n      // vs = this.RemoveVecsWithinDis(vs, 1000);\n      vs = this.divVecs(vs);\n      this.getPtByVs(vs);\n    } else {\n      if (this.optimizer === Optimizer.DouglasPeucker) {\n        // vs = DouglasPeucker.simplifyPath(vs, 10);\n      }\n      // vs = RemoveVecsWithinDis(vs, 30);\n      const dotPros = computeDotProductsWithCenter(vs);\n\n      // // console.log('smart drawing');\n      // console.log(vs.length);\n      // console.log(vs);\n      // console.log(dotPros);\n      if (getDistance(vs[0], vs[vs.length - 1]) < 10) {\n        vs.pop();\n        dotPros.pop();\n      } // for tri ??\n      if (vs.length < 2) {\n        return;\n      }\n\n      if (4 < vs.length && vs.length < 15 && !isContainNagativeNumber(dotPros)) {\n        ACircle.getCircleByVecs(this.scene, vs);\n        return;\n      }\n      if (3 < vs.length && vs.length < 8) {\n        ARectangleWrapper.getRectByVecs(this.scene, vs);\n        return;\n      }\n      // if (vs.length > 2) {\n      APolygonWrapper.getPolygonbyVecs(this.scene, vs);\n      // }\n      // if (this.typeFreehand === FHTYPE.CURVE) { ACurve.GetCurveByVecs(vs); }\n      // if (this.typeFreehand === FHTYPE.LINE) { CLine.GetLinesByVecs(vs); }\n      this.remove();\n      // let v = [new NVector3(1, 1), new NVector3(1, -1), new NVector3(-1, -1), new NVector3(-1, 1)];\n      // console.log(ComputeDotProducts(v));\n      // v = [new NVector3(1, 1), new NVector3(1, 1.5), new NVector3(-1, -1), new NVector3(-1, 1)];\n      // console.log(ComputeDotProducts(v));\n    }\n  }\n  private dotProductProcess(vs: NVector3[]) {\n    const length = 500;\n    const vsBySimplifyPath = vs ;// DouglasPeucker.simplifyPath(vs, 5);\n    // console.log('vec len:', vsBySimplifyPath.length * 0.1);\n    let dotValue = computeDotProducts(vsBySimplifyPath);\n    dotValue = getInterpolatedArray(dotValue, length);\n    dotValue.push(vsBySimplifyPath.length * 0.1);\n    AFreehandSmartDrawing.dotArrayForTrainSimplify.push(dotValue);\n\n    let vArray = [];\n    for (let i = 0; i < vsBySimplifyPath.length; ++i) {\n      vArray.push(vsBySimplifyPath[i].x, vsBySimplifyPath[i].y);\n    }\n    AFreehandSmartDrawing.dotVecArrayForTrainSimplify.push(vArray);\n\n    dotValue = computeDotProducts(vs);\n    dotValue = getInterpolatedArray(dotValue, length);\n    dotValue.push(vsBySimplifyPath.length * 0.1);\n    AFreehandSmartDrawing.dotArrayForTrainOrigin.push(dotValue);\n\n    vArray = [];\n    for (let i = 0; i < vs.length; ++i) {\n      vArray.push(vs[i].x, vs[i].y);\n    }\n    AFreehandSmartDrawing.dotVecArrayForTrainOrigin.push(vArray);\n\n    // const resizeData = GetInterpolatedArray(dotValue, 500);\n    // console.log(resizeData);\n    // AFreehandSmartDrawing.dotVecArrayForTrain.push(resizeData);\n  }\n  private predictDrawingShape(dotValue: number[]) {\n    const dotValueInterpolated = getInterpolatedArray(dotValue, 501);\n    // console.log(dotValueInterpolated);\n    // console.log(this.scene.annotationInstance.implementations.app.model.appAnnotation.addon.smartDrawing);\n    // console.log('*** FROM DEEP LEARNING MODELS ***');\n    const predictionLosisticR = this.scene.annotationInstance.implementations.app.addon.smartDrawing.PredictByLogisticRegression(\n      dotValueInterpolated\n    );\n    // console.debug(`pridiction:%c ${predictionLosisticR} from LR Model`, 'background: #ddb137; color: black');\n    const predictionMultiC = this.scene.annotationInstance.implementations.app.addon.smartDrawing.PredictByMultiClassification(\n      dotValueInterpolated\n    );\n    // console.debug(`pridiction:%c ${predictionMultiC} from MC model`, 'background: #4e2c7e; color: white');\n    return [predictionMultiC, predictionLosisticR];\n  }\n  private getShapeFromPrediction(predictionMultiC: string, vs: NVector3[]) {\n    switch (predictionMultiC) {\n      case 'CIRCLE':\n        ACircle.getCircleByVecs(this.scene, vs);\n        break;\n      case 'TRI-GON':\n        // vs = vs; // DouglasPeucker.simplifyPath(vs, 50);\n        APolygonWrapper.getPolygonbyVecs(this.scene, vs);\n        break;\n      case 'ARROW_SINGLE':\n        AArrow.fromSmartDrawing(this.scene, vs, GType.ARROW_SINGLE);\n        break;\n      case 'ARROW_DOUBLE':\n        AArrow.fromSmartDrawing(this.scene, vs, GType.ARROW_DOUBLE);\n        break;\n      case 'RECTANGLE':\n        ARectangleWrapper.getRectByVecs(this.scene, vs);\n        break;\n      case 'TEXT_LEADERLINE':\n        ATextleaderlineWrapper.fromSmartDrawing(this.scene, vs);\n        break;\n      case 'CURVE':\n        // vs = vs; //DouglasPeucker.simplifyPath(vs, 10);\n        ACurve.getCurveByVecs(this.scene, vs);\n        break;\n      case 'HEART':\n        // AMapticonCommanders.GetHeart(vs);\n        break;\n      case 'CLOUD':\n        // AMapticonCommanders.GetCloud(vs);\n        break;\n      default:\n        break;\n    }\n  }\n  // ............................................................... implementation\n  public getLog(): string {\n    return '';\n  }\n  public isMouseInside(x: number, y: number): boolean {\n    return false;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    /**/\n  }\n  public translate(x: number, y: number): void {\n    /**/\n  }\n  public hide(): void {\n    /**/\n  }\n  public remove(): void {\n    this.scene.removeGeometry(this);\n    this.scene.removeAFreehandSmartDrawing(this);\n  }\n  public toJSON(): undefined {\n    return undefined;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    if (AFreehandSmartDrawing.isTooltipRenderable) {\n      // this.canvasTooltip.StaticRenderClickAndDrag(\n      //   ctx,\n      //   new NVector3(AFreehandSmartDrawing.vecTooltip[0], AFreehandSmartDrawing.vecTooltip[1])\n      // );\n    }\n\n    if (this.vecs.length < 2) {\n      return;\n    } else if (this.isFreehandDrawing) {\n      this.scene.annotationInstance.renderer.draw.shape.freeHand.freeHandbyVecs(\n        ctx,\n        this.vecs,\n        this.scene.annotationInstance.activeCommandController.activeColorController.activeColor,\n        this.scene.annotationInstance.renderer.imageAnnoApp.customization.themeCurrent.freehand.lineWidth * this.styleComponent.renderStyle.scaleGlobal * this.styleComponent.renderStyle.scaleLocal,\n        this.isClosed\n      );\n    } else {\n      this.remove();\n    }\n  }\n}\n","import { NVector3 } from '../../../../../../../lib';\nimport { RendererComponent as _RendererComponent } from '../../../../Common/Base/ComponentTemplate/RendererComponent';\nimport { AFreehand } from '../AFreehand';\nexport class RendererComponent extends _RendererComponent {\n  public host: AFreehand;\n  constructor(host: AFreehand) {\n    super(host);\n    this.host = host;\n    this.host.styleComponent.updateColor();\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.timer.update();\n\n    if (this.host.vecs.length < 2) {\n      return;\n    } else if (this.host.isFreehandDrawing) {\n      const vsRendering = [];\n\n      for (let i = 0; i < this.host.vecs.length; ++i ) {\n        vsRendering.push(new NVector3(\n          this.host.vecs[i].x - this.host.scene.annotationInstance.scene.paramsEditing.croppingMaskParams.x,\n          this.host.vecs[i].y - this.host.scene.annotationInstance.scene.paramsEditing.croppingMaskParams.y\n          ));\n      }\n\n      this.host.scene.annotationInstance.renderer.draw.shape.freeHand.freeHandbyVecs(\n        ctx,\n        vsRendering,\n        this.host.scene.annotationInstance.activeCommandController.activeColorController.activeColor,\n        this.host.scene.annotationInstance.renderer.imageAnnoApp.customization.themeCurrent.freehand.lineWidth * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal,\n        this.host.isClosed\n      );\n    } else {\n      this.host.remove();\n    }\n  }\n}\n","import { FHType } from '../../../../../../../lib';\nimport { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { AFreehand } from '../AFreehand';\nexport class StyleComponent extends _StyleComponent {\n  public geo: AFreehand;\n  public renderStyle: RenderStyle;\n  public renderStyleNode: RenderStyle;\n  constructor(geo: AFreehand) {\n    super(geo);\n    this.renderStyle = new RenderStyle();\n    this.renderStyleNode = new RenderStyle();\n    this.updateStyle();\n  }\n  public updateStyle() {\n    RenderStyle.updateRenderStyleFH(\n      this.renderStyle,\n      this.geo.scene.annotationInstance.customization.themeCurrent\n    );\n    RenderStyle.updateRenderStyleFH(\n      this.renderStyleNode,\n      this.geo.scene.annotationInstance.customization.themeCurrent\n    );\n  }\n  public updateStyleByFHType(type: FHType) {\n    if (type === FHType.Polygon) {\n      RenderStyle.updateRenderStyleFHPolygon(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n      RenderStyle.updateRenderStyleFHPolygonNode(\n        this.renderStyleNode,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n    } else if (type === FHType.PolylineBending) {\n      RenderStyle.updateRenderStyleFHPolyline(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n      RenderStyle.updateRenderStyleFHPolylineNode(\n        this.renderStyleNode,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n    }\n  }\n}\n","import {\n  MouseEventData,\n  DouglasPeucker,\n  FHType, GType, Optimizer,\n  getDotProduct,\n  normalize,\n  NVector3,\n  removeVecsWithinDis,\n  sub,\n} from '../../../../../../lib';\nimport { Scene } from '../../../../Scene';\n// import { CanvasTooltip } from '../../../../UIWrapper/CanvasTooltip/CanvasTooltip';\nimport { AGeometryBase } from '../../../Common/Base/AGeometryBase';\nimport { APolygonGraphWrapper } from '../../FamilyArea/APolygonGraphWrapper';\nimport { APolygonWrapper } from '../../FamilyArea/APolygonWrapper/APolygonWrapper';\nimport { ACurve } from '../../FamilyCurve/ACurveWrapper/ACurve';\nimport { APolylineGraphWrapper } from '../../FamilyLine/APolylineGraphWrapper/APolylineGraphWrapper';\nimport { APolylineWrapper } from '../../FamilyLine/APolylineWrapper/APolylineWrapper';\nimport { APoint } from '../../FamilyPoint/Base/APoint';\nimport { RendererComponent } from './Component/RendererComponent';\nimport { StyleComponent } from './Component/StyleComponent';\nexport class AFreehand extends AGeometryBase {\n  public static geo: AFreehand | undefined;\n  public static isClose = false;\n  public static construction: AFreehand | undefined;\n  public static isTooltipRenderable = false;\n  public static vecTooltip: number[] = [0, 0];\n  public styleComponent: StyleComponent;\n  public renderer: RendererComponent;\n  public vecs: NVector3[] = [];\n  public type: GType;\n  public optimizer: Optimizer = Optimizer.Regular;\n  public typeFreehand: FHType;\n  public direction: number;\n  public isFreehandDrawing: boolean;\n  public isClosed: boolean;\n  // canvasTooltip: CanvasTooltip;\n  // ............................................................... construction\n  public static cancel() {\n    if (AFreehand.construction !== undefined) {\n      AFreehand.construction.remove();\n    }\n    AFreehand.construction = undefined;\n  }\n  // ............................................................... mouse event\n  public static mouseDown(scene: Scene, e: MouseEventData, type: FHType) {\n    // console.log('mouse down ---------------------------------------------------');\n    scene.annotationInstance.geometryCommon.gcmdSelecting.deSelectAllObjects();\n    AFreehand.isTooltipRenderable = false;\n  }\n  public static mouseDrag(scene: Scene, e: MouseEventData, type: FHType) {\n    // console.log('mouse drag ---------------------------------------------------');\n    if (AFreehand.construction === undefined) {\n      this.mouseMove(scene, e, type);\n    }\n    AFreehand.isTooltipRenderable = false;\n    if (AFreehand.construction) {\n      AFreehand.construction.addVecs(e.x, e.y);\n    }\n  }\n  public static mouseUp(scene: Scene, e: MouseEventData) {\n    if (AFreehand.construction !== undefined) {\n      if (AFreehand.construction.vecs.length < 2) {\n        return;\n      }\n      AFreehand.construction.computeVector();\n      AFreehand.construction.isFreehandDrawing = false;\n      scene.annotationInstance.activeCommandController.goToACMode();\n      AFreehand.construction = undefined;\n    }\n  }\n  public static mouseMove(scene: Scene, e: MouseEventData, type: FHType) {\n    if (AFreehand.geo === undefined) {\n      const cGeo = scene.annotationInstance.geometryCommon.gcmdProcessing.findAtPoint(e);\n      if (cGeo === undefined) {\n        AFreehand.construction = new AFreehand(scene, type);\n        AFreehand.construction.styleComponent.updateStyleByFHType(type);\n      }\n    }\n    AFreehand.vecTooltip[0] = e.x;\n    AFreehand.vecTooltip[1] = e.y;\n  }\n  constructor(scene: Scene, type: FHType) {\n    super(scene);\n    this.typeFreehand = type;\n    if (\n      this.typeFreehand === FHType.PolylineGon ||\n      this.typeFreehand === FHType.Polygon ||\n      this.typeFreehand === FHType.PolygonGraph\n    ) {\n      this.isClosed = true;\n    } else {\n      this.isClosed = false;\n    }\n    this.direction = 0;\n    this.isFreehandDrawing = true;\n    // this.isClosed = AFreehand.isClose;\n    this.optimizer = Optimizer.DouglasPeucker;\n    this.initComponent();\n    // this.col = ColorUtility.HexToCanvasColor(ADrawingPreset.polygonColorOutlineColor, 0.5);\n    // this.col = ADrawingPreset.RGB_by_A(ADrawingPreset.polylineColor, 0.5);\n    AFreehand.geo = this;\n    // this.canvasTooltip = new CanvasTooltip(this as AGeometryBase);\n    this.init();\n  }\n  private initComponent() {\n    this.styleComponent = new StyleComponent(this);\n    this.renderer = new RendererComponent(this);\n  }\n  private init() {\n    this.scene.addAFreehand(this);\n  }\n  public addVecs(x: number, y: number) {\n    this.vecs.push(new NVector3(x, y));\n  }\n  private checkDotProduct(vs: NVector3[]): NVector3[] {\n    const vecs: NVector3[] = [];\n    const step = 5;\n    vecs.push(vs[0]);\n    for (let i = 0; i < vs.length - step; ++i) {\n      let v = sub(vs[i], vs[i + 1]);\n      v = normalize(v);\n      let vv = sub(vs[i], vs[i + 2]);\n      vv = normalize(vv);\n      const vvv = sub(vs[i], vs[i + 3]);\n      vv = normalize(vvv);\n      let vvvv = sub(vs[i], vs[i + 4]);\n      vvvv = normalize(vvvv);\n      let vvvvv = sub(vs[i], vs[i + 5]);\n      vvvvv = normalize(vvvvv);\n\n      const d0 = getDotProduct(v, vv);\n      const d1 = getDotProduct(v, vvv);\n      const d2 = getDotProduct(v, vvv);\n      // console.log(d0, d1, d2);\n      // let d3 = DotProduct(v, vvvv);\n      if (isNaN(d0) || isNaN(d1) || isNaN(d2)) {\n        // || isNaN(d3)) {// if (v3 < 0.3) {\n        vecs.push(vs[i]);\n      }\n    }\n    vecs.push(vs[vs.length - 1]);\n    return vecs;\n  }\n  private divVecs(vs: NVector3[]): NVector3[] {\n    let vecs: NVector3[] = [];\n    vecs = vs;\n    return vecs;\n  }\n  private getPtByVs(v: NVector3[]): void {\n    let i = v.length;\n    while (i--) {\n      const g = new APoint(this.scene, v[i].x, v[i].y);\n      g.dummy();\n    }\n  }\n  private computeVector() {\n    let vs = this.vecs;\n    if (this.typeFreehand === FHType.SmartDrawing) {\n      vs = this.checkDotProduct(vs);\n      // vs = this.RemoveVecsWithinDis(vs, 1000);\n      vs = this.divVecs(vs);\n      this.getPtByVs(vs);\n    } else {\n      if (this.optimizer === Optimizer.DouglasPeucker) {\n        vs = DouglasPeucker.simplifyPath(vs, 2); // 10);\n      } else if (this.optimizer === Optimizer.Regular) {\n        vs = removeVecsWithinDis(vs, 30);\n      }\n\n      if (vs.length < 2) {\n        return;\n      }\n      if (this.typeFreehand === FHType.CurveClosed) {\n        ACurve.getCurveByVecs(this.scene, vs, true);\n      }\n      if (this.typeFreehand === FHType.Curve) {\n        ACurve.getCurveByVecs(this.scene, vs);\n      }\n      if (this.typeFreehand === FHType.PolylineBending) {\n        APolylineGraphWrapper.getPolyline(this.scene, vs);\n      }\n      if (this.typeFreehand === FHType.Polyline) {\n        APolylineWrapper.getPolylineByVecs(this.scene, vs);\n      }\n      if (this.typeFreehand === FHType.PolylineGon) {\n        APolygonWrapper.getPolygonbyVecs(this.scene, vs);\n      }\n      if (this.typeFreehand === FHType.PolygonGraph) {\n        APolygonGraphWrapper.getPolygonbyVecs(this.scene, vs);\n      }\n\n      // if (this.typeFreehand === FHTYPE.LINE) { CLine.GetLinesByVecs(vs); }\n      this.remove();\n    }\n  }\n  // ............................................................... implementation\n  public getLog(): string {\n    return '';\n  }\n  public isMouseInside(x: number, y: number): boolean {\n    return false;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    /* */\n  }\n  public translate(x: number, y: number): void {\n    /**/\n  }\n  public hide(): void {\n    /**/\n  }\n  public remove(): void {\n    AFreehand.geo = undefined;\n    this.scene.removeGeometry(this);\n    this.scene.removeAFreehand(this);\n  }\n  public toJSON(): undefined {\n    return undefined;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.renderer.renderPost(ctx);\n  }\n}\n","import { NVector3, GType, getRatioByNewHeight } from '../../../../../../../lib';\nimport { Scene } from '../../../../../Scene';\nimport { RendererComponent as _RendererComponent } from '../../../../Common/Base/ComponentTemplate/RendererComponent';\nimport { APointIconWrapper } from '../APointIconWrapper';\nexport class RendererComponent extends _RendererComponent {\n  public host: APointIconWrapper;\n  constructor(host: APointIconWrapper) {\n    super(host);\n    this.host = host;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    if (!this.host.isRenderable || !this.host.img) {\n      return;\n    }\n    // if (this.scene.annotationInstance.activeCommandController.pressESC && this.isDrag) { this.isDrag = false; this.vec = NVector3.DeepCopy(this.vecsHistory[this.vecsHistory.length - 1]); }\n    // if (this.host.scene.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.isViewChanging) {\n    //   this.host.UpdteControlPoints();\n    // }\n\n    this.timer.update();\n\n    // this.timer.UpdatePopupSummery(); for popup summary\n    ctx.save();\n    ctx.translate(this.host.vec.x, this.host.vec.y);\n    ctx.rotate(this.host.angle / 180);\n\n    //   ctx.beginPath();\n    //   ctx.arc(0, 0, 100, 0, 3.14 * 2);\n    //   ctx.closePath();\n    //   ctx.fill();\n    //  // console.log(this.host.img);\n\n    if (this.t > 0.6) {\n      if (this.host.isHoverValue || (this.host.isSelected && this.host.type === GType.POINT_ICON)) {\n        this.host.scene.annotationInstance.renderer.draw.shape.point.pointIcon(\n          ctx,\n          this.host.styleComponent.renderStyle,\n          0,\n          0,\n          this.host.widthRender,\n          this.host.heightRender,\n          this.host.img,\n          true,\n          this.host.isGrayColor,\n          this.host.visibilityValue,\n          true,\n          this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver)\n        );\n        this.tOver += this.host.scene.annotationInstance.renderer.dt;\n        this.tDown1 = 0;\n        this.host.isLeave = true;\n        this.renderBoundary(ctx);\n        this.renderControlPoint(ctx);\n        this.renderCP(ctx);\n        if (this.host.needShadowBound) {\n          this.renderShadow(ctx);\n        }\n        // this.div.style.visibility = 'visible';\n      } else {\n        this.host.scene.annotationInstance.renderer.draw.shape.point.pointIcon(\n          ctx,\n          this.host.styleComponent.renderStyle,\n          0,\n          0,\n          this.host.widthRender,\n          this.host.heightRender,\n          this.host.img,\n          false,\n          this.host.isGrayColor,\n          this.host.visibilityValue,\n          false\n        );\n        // this.div.style.visibility = 'hidden';\n        this.tOver = 0;\n      }\n    } else {\n      this.host.scene.annotationInstance.renderer.draw.shape.point.pointIcon(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        0,\n        0,\n        this.host.widthRender,\n        this.host.heightRender,\n        this.host.img,\n        true,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        true,\n        this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.t)\n      );\n    }\n\n    ctx.restore();\n    // this.host.renderer.t += this.host.scene.annotationInstance.renderer.dt;\n    // this.needShadowBound = false;\n  }\n  public renderIcon(ctx: CanvasRenderingContext2D) {\n    // ctx.globalAlpha = visibility;\n    // ctx.fillStyle = 'white';\n    // // let style = AGeometryRender.themeDrawing.pointIcon.normal;\n    // let scale = 0.5;\n    // let easingScale = easing * 10;\n    // let width = (img.width * scale) + easingScale;\n    // let height = (img.height * scale) + easingScale;\n    // let xOffset = width * 0.5;\n    // let yOffset = height * 0.5;\n    // ctx.drawImage(img, x - xOffset, y - yOffset, width, height);\n  }\n  private renderBoundary(ctx: CanvasRenderingContext2D) {\n    const boundaryVecs: NVector3[] = [];\n    for (let i = 0; i < this.host.arrayCP.length; ++i) {\n      boundaryVecs.push(this.host.arrayCP[i].vec);\n    }\n    ctx.beginPath();\n    const col = this.host.scene.annotationInstance.customization.themeCurrent.nPoint\n      .fillStyleFirstArray;\n    ctx.strokeStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    ctx.lineWidth = 2;\n    this.host.scene.annotationInstance.renderer.draw.shape.area.roundedRect(\n      ctx,\n      this.host.styleComponent.renderStyle,\n      boundaryVecs,\n      0,\n      0\n    );\n    ctx.closePath();\n    ctx.stroke();\n  }\n  private renderCP(ctx: CanvasRenderingContext2D) {\n    ctx.fillStyle = '#ffffff';\n    const col = this.host.scene.annotationInstance.customization.themeCurrent.nPoint\n      .fillStyleFirstArray;\n    ctx.strokeStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    ctx.beginPath();\n    ctx.arc(0, 0, 2.5, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n  }\n  private renderControlPoint(ctx: CanvasRenderingContext2D) {\n    for (let i = 0; i < this.host.arrayCP.length; ++i) {\n      this.host.arrayCP[i].renderPost(this.host.scene, ctx);\n    }\n  }\n  private renderShadow(ctx: CanvasRenderingContext2D) {\n    for (let i = 0; i < this.host.sizes.length; ++i) {\n      const newSize = getRatioByNewHeight(\n        this.host.img.width,\n        this.host.img.height,\n        this.host.sizes[i]\n      );\n      const xMin = 0 - newSize[0] * 0.5;\n      const yMin = 0 - newSize[1] * 0.5;\n\n      ctx.globalAlpha = 1;\n      ctx.lineDashOffset = -this.t;\n      ctx.beginPath();\n      ctx.lineWidth = 0.5;\n      ctx.strokeStyle = '#ffffff';\n      ctx.setLineDash([2, 2]);\n      ctx.rect(xMin, yMin, newSize[0], newSize[1]);\n      ctx.closePath();\n      ctx.stroke();\n\n      ctx.globalAlpha = 1;\n      ctx.lineDashOffset = -this.t - 4;\n      ctx.beginPath();\n      ctx.lineWidth = 0.5;\n      ctx.strokeStyle = '#000000';\n      ctx.setLineDash([2, 2]);\n      ctx.rect(xMin, yMin, newSize[0], newSize[1]);\n      ctx.closePath();\n      ctx.stroke();\n\n      ctx.setLineDash([0, 0]);\n    }\n  }\n}\nexport class ControPoint {\n  index: number;\n  vec: NVector3;\n  r = 4;\n  strokeWith = 2;\n  constructor(index: number, x: number, y: number, z: number) {\n    this.vec = new NVector3(x, y, z);\n    this.index = index;\n  }\n  public renderPost(scene: Scene, ctx: CanvasRenderingContext2D) {\n    ctx.lineWidth = this.strokeWith;\n    ctx.fillStyle = '#ffffff';\n    const col = scene.annotationInstance.customization.themeCurrent.nPoint.fillStyleFirstArray;\n    ctx.strokeStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    ctx.beginPath();\n    ctx.arc(this.vec.x, this.vec.y, this.r, 0, Math.PI * 2);\n    // ctx.arc(0, 0, this.r, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n  }\n}\n","import { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { APointIconWrapper } from '../APointIconWrapper';\nexport class StyleComponent extends _StyleComponent {\n  public geoHost: APointIconWrapper;\n  constructor(geo: APointIconWrapper) {\n    super(geo);\n    this.updateStyle();\n  }\n  public updateStyle() {\n    RenderStyle.updateRenderStyleRPoint(\n      this.renderStyle,\n      this.geo.scene.annotationInstance.customization.themeCurrent\n    );\n  }\n}\n","import { IOGeometry } from '../../../../../../lib/Extended/GeometryUtility';\nimport {\n  GType, \n  Linecap,\n  MouseEventData,\n  getRatioByWidthHidthByHeight,\n  getDistance, \n  isInsideOfVecs, \n  NVector3 \n} from '../../../../../../lib';\nimport { Scene } from '../../../../Scene';\n// import { AGeometryBase } from '../../Base/AGeometryBase';\nimport { APointBase } from '../../../Common/Base/APointBase';\nimport { ControPoint, RendererComponent } from './Component/RendererComponent';\nimport { StyleComponent } from './Component/StyleComponent';\nexport class APointIconWrapper extends APointBase {\n  public r: number;\n  public vec: NVector3;\n  public tVec: NVector3;\n  public rOrigin: number;\n  public rTarget: number;\n  public type: GType;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public graph: any;\n  public isPointMid: boolean;\n  public weightLeft: number;\n  public weightRight: number;\n  public path: string;\n  public img: HTMLImageElement;\n  public div: HTMLElement;\n  public divHeight: number;\n  public divWidth: number;\n  public imgString: string;\n  public idBase64: string;\n\n  public midHeightImg: number;\n  public midWidthImg: number;\n  public widthRender = 0;\n  public heightRender = 0;\n\n  // boundaryVecs: NVector3[];\n  public indexControPointSelected = -1;\n  public xOffset = -3;\n  public yOffset = -3;\n  public centerCP: ControPoint;\n  public arrayCP: ControPoint[] = [];\n  public needRotation = false;\n  public angle = 0;\n  public needShadowBound = false;\n  public needEmitResizeTransform = false;\n  public sizes: number[] = [];\n  public sizesDis: number[] = [];\n  // public static AddBase64(scene: Scene, id: string, value: string) {\n  //   console.log('jkjkjkjddddddd');\n  //     if (!scene.annotationInstance.renderer.draw.image.listBase64.has(id)) {\n  //       scene.annotationInstance.renderer.draw.image.listBase64.set(id, value);\n  //         scene.annotationInstance.io.eventListenerAnnotation.AddBase64Stack(id, value);\n  //     }\n\n  //     // console.log(this.listBase64)\n  //     // this.listBase64.forEach((d) => (\n  //     //     console.log(d)\n  //     // ));\n  //     // this.listBase64\n  // }\n  // public static RemoveBase64(id: string) {\n  //     /* */\n  // }\n  // public static ActiveBase64(scene: Scene, id: string) {\n  //     if (scene.annotationInstance.renderer.draw.image.listBase64.has(id)) {\n  //         scene.annotationInstance.renderer.draw.image.activeBase64ID = id;\n\n  //         scene.annotationInstance.activeCommandController.activeBase64img = scene.annotationInstance.renderer.draw.image.listBase64.get(id) as string;\n  //         scene.annotationInstance.io.eventListenerAnnotation.SelectBase64(id);\n  //     }\n  // }\n  // public static FindAtPoint(scene: Scene, x: number, y: number): undefined | AGeometryBase {\n  //   for (var i = scene.listIPoint.length - 1; i >= 0; --i) {\n  //     if (scene.listIPoint[i].isSelectable && scene.listIPoint[i].IsMouseInside(x, y)) {\n  //       return scene.listIPoint[i] as AGeometryBase;\n  //     }\n  //   }\n  //   return undefined;\n  // }\n  // public static GetLengthSelection() {\n  //     let i = this.list.length; let count = 0;\n  //     while (i--) { if (this.list[i].IsSelected) { count += 1; } }\n  //     return count;\n  // }\n  // public static RemoveAllCapturedGeo() {\n  //     let temp = APointIconWrapper.list;\n  //     for (let i = 0; i < temp.length; ++i) {\n  //         if (APointIconWrapper.list[i].isSelected === true) {\n  //             APointIconWrapper.list[i].Remove();\n  //         }\n  //     }\n  // }\n  // public static DeSelecteCaptureObjects() {\n  //     for (let i = 0; i < APointIconWrapper.list.length; ++i) {\n  //         APointIconWrapper.list[i].isSelected = false;\n  //     }\n  // }\n  // public static MoveSelectedGeo(e: MouseEventData) {\n  //     for (let i = 0; i < APointIconWrapper.list.length; ++i) {\n  //         if (APointIconWrapper.list[i].isSelected === true && !APointIconWrapper.list[i].isHover) {\n  //             APointIconWrapper.list[i].TranslateByMouseEventData(e);\n  //         }\n  //         if (APointIconWrapper.list[i].isHover === true) {\n  //             APointIconWrapper.list[i].TranslateByMouseEventData(e);\n  //         }\n  //     }\n  // }\n  public static fromJSON(scene: Scene, g: IOGeometry, isUndo = false, isDeepCopy = false) {\n    // if (true) { return; }\n    const mp = [g.nodes[0].sx, g.nodes[0].sy];\n    const cp = new APointIconWrapper(scene, mp[0], mp[1], 0, isUndo, g.data.idBase64);\n    cp.type = GType[g.type];\n    // cp.style = g.style;\n    // cp.id = g.id;\n    cp.isHiddenValue = g.isHidden;\n    if (g.isHidden) {\n      cp.visibilityValue = 0;\n    } else {\n      cp.visibilityValue = 1;\n    }\n    if (isDeepCopy) {\n      cp.id = scene.getUUID();\n    } else {\n      cp.id = g.id;\n    }\n\n    cp.heightRender = g.data.height;\n    cp.widthRender = g.data.width;\n\n    cp.img.src = scene.annotationInstance.renderer.draw.image.listBase64.get(\n      g.data.idBase64\n    ) as string;\n\n    cp.isRenderable = true;\n    cp.initVecsHistory();\n    return cp;\n  }\n\n  // ......................................................................... mouse interaction\n  public static MouseRightClick(e: MouseEventData) {\n    /* */\n  }\n  public static mouseMiddleClick(e: MouseEventData) {\n    /* */\n  }\n  public static mouseLeftClick(scene: Scene, e: MouseEventData) {\n    // console.log(scene.annotationInstance.renderer.draw.image.activeBase64ID);\n    if (\n      scene.capture !== undefined ||\n      !scene.annotationInstance.renderer.draw.image.activeBase64ID\n    ) {\n      return;\n    }\n    const g = new APointIconWrapper(scene, e.x, e.y, 0);\n    g.dummy();\n    if (scene.annotationInstance.activeCommandController.acProperties.pressShift) {\n      return;\n    }\n    scene.annotationInstance.activeCommandController.goToACMode();\n  }\n  public static mouseDrag(e: MouseEventData) {\n    /* */\n  }\n  // ..................... members\n  constructor(\n    scene: Scene,\n    x = 0,\n    y = 0,\n    z = 0,\n    isUndo = false,\n    idBase64 = '',\n    path = '',\n    type: GType = GType.POINT_ICON,\n    radius = 5,\n    lineCap: Linecap = Linecap.Round\n  ) {\n    super(scene, x, y, z, type);\n    this.path = path;\n    this.isUndo = isUndo;\n    this.isPointMid = false;\n    this.hasPopupValue = false;\n    this.isRenderable = false;\n    this.idBase64 = idBase64;\n    this.initComponent();\n    // this.timer = new Timer(this);\n    if (this.InitIcon()) {\n      scene.addIPoint(this);\n      if (this.isUndo) {\n        return;\n      }\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(this.toJSON());\n    }\n  }\n  private initComponent() {\n    this.styleComponent = new StyleComponent(this);\n    this.renderer = new RendererComponent(this);\n  }\n  private InitIcon() {\n    if (this.hasPopupValue) {\n      this.appendDiv();\n    }\n\n    if (this.idBase64.length < 1) {\n      this.idBase64 = this.scene.annotationInstance.renderer.draw.image.activeBase64ID;\n\n      // console.log(this.scene.annotationInstance.renderer.draw.image.listBase64.get(this.idBase64));\n      // console.log(this.idBase64);\n\n      this.img = new Image();\n\n      // this.img.src = this.scene.annotationInstance.renderer.draw.image.listBase64.get(this.idBase64) as string;\n      this.img.src = this.scene.annotationInstance.renderer.draw.image.activeBase64ID;\n\n      this.isRenderable = true;\n      this.isUnderConstruction = false;\n    } else {\n      return false;\n    }\n    // let thePath = this.img.src.split('/');\n    // console.log(thePath);\n    // if (thePath[thePath.length - 1] === 'undefined') {\n    //     this.Remove();\n    //     return;\n    // }\n    const sizes = getRatioByWidthHidthByHeight(this.img.width, this.img.height, 72);\n    this.widthRender = sizes[0];\n    this.heightRender = sizes[1];\n\n    this.midHeightImg = this.widthRender[0]; // this.img.height * 0.5;\n    this.midWidthImg = this.widthRender[1]; // this.img.width * 0.5;\n    this.xOffset = 0;\n    this.yOffset = 0;\n    // this.GetBoundaryVecs();\n    this.arrayCP = [];\n    this.arrayCP.push(\n      new ControPoint(\n        0,\n        0 - this.midWidthImg - this.xOffset,\n        0 - this.midHeightImg - this.yOffset,\n        0\n      )\n    );\n    this.arrayCP.push(\n      new ControPoint(\n        1,\n        0 + this.midWidthImg + this.xOffset,\n        0 - this.midHeightImg - this.yOffset,\n        0\n      )\n    );\n    this.arrayCP.push(\n      new ControPoint(\n        2,\n        0 + this.midWidthImg + this.xOffset,\n        0 + this.midHeightImg + this.yOffset,\n        0\n      )\n    );\n    this.arrayCP.push(\n      new ControPoint(\n        3,\n        0 - this.midWidthImg - this.xOffset,\n        0 + this.midHeightImg + this.yOffset,\n        0\n      )\n    );\n\n    this.sizes = [16, 32, 48, 72];\n    this.computeDistanceForSnap();\n    return true;\n  }\n  public computeDistanceForSnap() {\n    this.sizesDis = [];\n    for (let i = 0; i < this.sizes.length; ++i) {\n      const newSize = getRatioByWidthHidthByHeight(this.img.width, this.img.height, this.sizes[i]);\n      const xMin = 0 - newSize[0] * 0.5;\n      const yMin = 0 - newSize[1] * 0.5;\n      const dis = getDistance(new NVector3(0, 0), new NVector3(xMin, yMin));\n      this.sizesDis.push(dis);\n    }\n  }\n  public getParentType() {\n    return 'APointIconWrapper';\n  }\n  // GetBoundaryVecs() {\n  // console.log(this);\n  // let v0 = new NVector3(this.vec.x - this.midWidthImg - this.xOffset, this.vec.y - this.midHeightImg - this.yOffset);\n  // let v1 = new NVector3(this.vec.x + this.midWidthImg + this.xOffset, this.vec.y + this.midHeightImg + this.yOffset);\n  // this.arrayCP = [];\n  // this.boundaryVecs = GetBoundingVecs(v0, v1);\n  // console.log(this.boundaryVecs);\n  // for (let i = 0; i < this.boundaryVecs.length; ++i) {\n  //     this.arrayCP.push(new CP(this.boundaryVecs[i].x, this.boundaryVecs[i].y, this.boundaryVecs[i].z));\n  // }\n  // }\n  public appendDiv() {\n    this.divHeight = 150;\n    this.divWidth = 100;\n    this.div = document.createElement('div');\n    this.div.id = `dt_icon_${this.id.toString()}`;\n    this.div.style.height = this.divHeight + 'px';\n    this.div.style.width = this.divWidth + 'px';\n    this.div.style.top = (this.vec.y - this.divHeight * 0.5).toString() + 'px';\n    this.div.style.left = (this.vec.x + 50).toString() + 'px';\n    this.div.style.position = 'absolute';\n    this.div.style.background = 'red';\n    this.div.style.zIndex = '999';\n    this.div.style.visibility = 'hidden';\n\n    // AGeometryCommon.annotationStatic.implementation.app.model.screen.div3d.insertBefore(this.div, AGeometryCommon.annotationStatic.implementation.app.model.screen.div3d.childNodes[0]);\n  }\n  public translateDiv() {\n    this.div.style.top = (this.vec.y - this.divHeight * 0.5).toString() + 'px';\n    this.div.style.left = (this.vec.x + 50).toString() + 'px';\n  }\n  public isMouseInside(x: number, y: number) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return false;\n    }\n    const m = new NVector3(x, y);\n\n    this.needRotation = false;\n\n    for (let i = 0; i < this.arrayCP.length; ++i) {\n      const dis = getDistance(\n        m,\n        new NVector3(this.arrayCP[i].vec.x + this.vec.x, this.arrayCP[i].vec.y + this.vec.y)\n      );\n      if (dis < this.arrayCP[i].r + 3) {\n        this.indexControPointSelected = this.arrayCP[i].index;\n        this.needRotation = false;\n        return true;\n      } else if (this.arrayCP[0].r + 3 < dis && dis < this.arrayCP[0].r + 13) {\n        this.needRotation = true;\n      }\n    }\n\n    this.indexControPointSelected = -1;\n    if (\n      isInsideOfVecs(m, [\n        new NVector3(this.arrayCP[0].vec.x + this.vec.x, this.arrayCP[0].vec.y + this.vec.y),\n        new NVector3(this.arrayCP[1].vec.x + this.vec.x, this.arrayCP[1].vec.y + this.vec.y),\n        new NVector3(this.arrayCP[2].vec.x + this.vec.x, this.arrayCP[2].vec.y + this.vec.y),\n        new NVector3(this.arrayCP[3].vec.x + this.vec.x, this.arrayCP[3].vec.y + this.vec.y),\n      ])\n    ) {\n      return true;\n    }\n    if (this.needRotation) {\n      return true;\n    }\n    return false;\n  }\n  public deepCopy(x: number, y: number) {\n    const geo = new APointIconWrapper(\n      this.scene,\n      x,\n      y,\n      this.vec.z,\n      true,\n      this.idBase64,\n      this.path,\n      this.type,\n      this.r\n    );\n    geo.type = this.type;\n    // geo.id = g.id;\n    geo.isHiddenValue = this.isHiddenValue;\n    geo.id = this.scene.getUUID();\n    // geo.idBase64 = g.data.content;\n    // eslint:disable-next-line:no-string-literal\n    geo.widthRender = this.widthRender;\n    geo.heightRender = this.heightRender;\n    // geo.updateScreenVecByProjectedPos();\n    geo.emitAddStack();\n    return geo;\n  }\n  public translate(x: number, y: number) {\n    //\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    if (this.scene.annotationInstance.activeCommandController.acProperties.pressESC) {\n      return;\n    }\n    const xOff = e.x - e.preX;\n    const yOff = e.y - e.preY;\n\n    if (\n      this.needRotation &&\n      this.scene.annotationInstance.activeCommandController.acProperties.pressShift\n    ) {\n      this.angle += xOff + yOff;\n    } else {\n      if (this.indexControPointSelected > -1) {\n        this.needEmitResizeTransform = true;\n        if (this.scene.annotationInstance.activeCommandController.acProperties.pressShift) {\n          this.translateControlPointForFreeform(xOff, yOff);\n        } else {\n          this.translateControlPointSnap(e);\n          this.needShadowBound = true;\n        }\n        return;\n      }\n      this.needShadowBound = false;\n\n      this.vec.x += xOff;\n      this.vec.y += yOff;\n\n      this.isDrag = true;\n\n      if (this.textLeaderline) {\n        this.textLeaderline.translateByMouseEventData(e);\n        if (this.textLeaderline.leaderline) {\n          // if (this.wrapping.needWrappingToLeft || this.wrapping.needWrappingToRight) {\n          this.textLeaderline.leaderline.v2.x = this.vec.x;\n          this.textLeaderline.leaderline.v2.y = this.vec.y;\n          // }\n        }\n      }\n    }\n  }\n  // .......................................................................... implementation\n  public get isSelected() {\n    return this.isSelectedValue;\n  }\n  public set isSelected(v: boolean) {\n    this.isSelectedValue = v;\n    this.scene.annotationInstance.io.eventListenerAnnotation.selectionStack(this.toJSON());\n  }\n  public get isHover() {\n    return this.isHoverValue;\n  }\n  public set isHover(v: boolean) {\n    this.isHoverValue = v;\n    if (this.isHoverValue && !this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    } else if (!this.isHoverValue && this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    }\n    this.isHoverPre = this.isHoverValue;\n    if (!v) {\n      this.needEmitHoverPost = true;\n      this.hidePopUpSummary();\n    }\n  }\n  // ................................... implementation for Control point\n  public translateControlPointSnap(e: MouseEventData) {\n    const dis = getDistance(this.vec, new NVector3(e.x, e.y));\n    for (let i = 0; i < this.sizesDis.length; ++i) {\n      if (dis < this.sizesDis[i]) {\n        const sizes = getRatioByWidthHidthByHeight(this.img.width, this.img.height, this.sizes[i]);\n        this.widthRender = sizes[0];\n        this.heightRender = sizes[1];\n        this.arrayCP[0].vec.x = -sizes[0] * 0.5;\n        this.arrayCP[0].vec.y = -sizes[1] * 0.5;\n        this.arrayCP[1].vec.x = +sizes[0] * 0.5;\n        this.arrayCP[1].vec.y = -sizes[1] * 0.5;\n        this.arrayCP[2].vec.x = +sizes[0] * 0.5;\n        this.arrayCP[2].vec.y = +sizes[1] * 0.5;\n        this.arrayCP[3].vec.x = -sizes[0] * 0.5;\n        this.arrayCP[3].vec.y = +sizes[1] * 0.5;\n        break;\n      }\n    }\n  }\n  private translateControlPointForFreeform(xOff: number, yOff: number) {\n    if (this.indexControPointSelected === 0) {\n      this.arrayCP[0].vec.x += xOff;\n      this.arrayCP[0].vec.y += yOff;\n      this.arrayCP[1].vec.x -= xOff;\n      this.arrayCP[1].vec.y += yOff;\n      this.arrayCP[2].vec.x -= xOff;\n      this.arrayCP[2].vec.y -= yOff;\n      this.arrayCP[3].vec.x += xOff;\n      this.arrayCP[3].vec.y -= yOff;\n    } else if (this.indexControPointSelected === 1) {\n      this.arrayCP[0].vec.x -= xOff;\n      this.arrayCP[0].vec.y += yOff;\n      this.arrayCP[1].vec.x += xOff;\n      this.arrayCP[1].vec.y += yOff;\n      this.arrayCP[2].vec.x += xOff;\n      this.arrayCP[2].vec.y -= yOff;\n      this.arrayCP[3].vec.x -= xOff;\n      this.arrayCP[3].vec.y -= yOff;\n    } else if (this.indexControPointSelected === 2) {\n      this.arrayCP[0].vec.x -= xOff;\n      this.arrayCP[0].vec.y -= yOff;\n      this.arrayCP[1].vec.x += xOff;\n      this.arrayCP[1].vec.y -= yOff;\n      this.arrayCP[2].vec.x += xOff;\n      this.arrayCP[2].vec.y += yOff;\n      this.arrayCP[3].vec.x -= xOff;\n      this.arrayCP[3].vec.y += yOff;\n    } else if (this.indexControPointSelected === 3) {\n      this.arrayCP[0].vec.x += xOff;\n      this.arrayCP[0].vec.y -= yOff;\n      this.arrayCP[1].vec.x -= xOff;\n      this.arrayCP[1].vec.y -= yOff;\n      this.arrayCP[2].vec.x -= xOff;\n      this.arrayCP[2].vec.y += yOff;\n      this.arrayCP[3].vec.x += xOff;\n      this.arrayCP[3].vec.y += yOff;\n    }\n    this.widthRender = this.arrayCP[1].vec.x - this.arrayCP[0].vec.x;\n    this.heightRender = this.arrayCP[3].vec.y - this.arrayCP[0].vec.y;\n  }\n  // ................................... implementation\n  public remove(needEmit = true) {\n    this.isSelectable = false;\n    this.isRenderable = false;\n    if (this.hasPopupValue) {\n      this.hidePopUpSummary();\n    }\n\n    if (this.textLeaderline) {\n      this.textLeaderline.removeByAttachedShape();\n      this.textLeaderline = undefined;\n    }\n\n    this.isSelectable = false;\n    this.isRenderable = false;\n    this.isRemove = true;\n    if (needEmit) {\n      const ioGeo = this.toJSON();\n      if (ioGeo) {\n        this.scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack([ioGeo]);\n      }\n    }\n    this.scene.removeBasePoint(this);\n    this.scene.removeIPoint(this);\n    this.scene.removeGeometry(this);\n  }\n  public toJSON(): IOGeometry | undefined {\n    // let p = new IOGeometry(this.id, this.type, this.isSelected, this.isHover, this.isHidden);\n    // p.PushNode(this.GetNode());\n\n    // let d = {\n    //   idBase64: this.idBase64,\n    //   height: this.heightRender,\n    //   width: this.widthRender,\n    // };\n    // p.data = d;\n    // return p;\n    return undefined;\n  }\n  public mouseUp() {\n    if (this.needEmitResizeTransform) {\n      const data = this.toJSON();\n      if (data) {\n        this.scene.annotationInstance.io.eventListenerAnnotation.transformStack([data]);\n      }\n    }\n    this.needEmitResizeTransform = false;\n  }\n  // ................................... end implementation\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.renderer.renderPost(ctx);\n  }\n}\n","import { AGeometryBase } from '../../../../Common/Base/AGeometryBase';\nexport class InteractionComponent {\n  public geo: AGeometryBase;\n  constructor(geo: AGeometryBase) {\n    this.geo = geo;\n  }\n  public isMouseInside(x: number, y: number) {\n    return false;\n  }\n  public getLog() {\n    return '';\n  }\n  public hide(): void {\n    //\n  }\n}\n","import { RendererComponent as _RendererComponent } from '../../../../Common/Base/ComponentTemplate/RendererComponent';\nimport { APointNumberedWrapper } from '..';\nimport { Environment, getNumberedPointSMX } from '../../../../../../../lib';\nexport class RendererComponent extends _RendererComponent {\n  public host: APointNumberedWrapper;\n  constructor(host: APointNumberedWrapper) {\n    super(host);\n    this.host = host;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.host.inspector.update(ctx);\n    this.interpolateColor.update();\n\n\n    if (this.host.isCollapse) { return; }\n    if (this.host.scaleForRender < 0.01) { return; }\n    if (this.host.scene.annotationInstance.customization.themeCurrent.nPoint.SVG === undefined) { return; }\n    // if (this.host.scene.annotationInstance.activeCommandController.pressESC && this.isDrag) { this.isDrag = false; this.host.vec = NVector3.DeepCopy(this.host.vecsHistory[this.host.vecsHistory.length - 1]); }\n\n    const drawingPresetPointSVG = this.host.scene.annotationInstance.renderer.draw.shape.pointSVG;\n    const drawingPresetPoint = this.host.scene.annotationInstance.renderer.draw.shape.point;\n\n    const vecRendering = this.host.scene.annotationInstance.geometryCommon.gcmdSupporting.toScreenVecOnCropping(this.host.vec);\n    if (this.host.isDrag) {\n      drawingPresetPoint.shadowNPoint(ctx, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal, this.host.isSelected, this.host.isHover);\n\n      if (this.host.scene.annotationInstance.implementations.app.param.environment === Environment.AGSM) {\n        drawingPresetPoint.pointNumberedOverBoundingByCircle(\n          ctx, this.host.styleComponent.renderStyle,\n          vecRendering.x, vecRendering.y,\n          this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal,\n          this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n          true, true,\n          this.host.isGrayColor,\n          this.host.visibility\n        );\n        drawingPresetPoint.pointNumberedDragByCircle(ctx, this.host.styleComponent.renderStyle,\n          vecRendering.x, vecRendering.y,\n          this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal, // this.host.scaleForRender,\n          this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown2),\n          false, false, this.host.isGrayColor, this.host.visibility, this.host.isHover, this.host.isSelected\n        );\n\n      } else {\n        // drawingPresetPoint.PointNumberedDragByImg(ctx, this.host.styleComponent.renderStyle, this.host.vec.x, this.host.vec.y, NumericalMotion.easeOutElastic2(this.tUp), true, true, this.host.isGrayColor, this.host.visibility, this.GetIndex());\n        drawingPresetPointSVG.pointSVGNormalFill(\n          ctx, this.host.scene.annotationInstance.customization.themeCurrent.nPoint.SVG.path2D, this.host.styleComponent.renderStyle,\n          vecRendering.x, vecRendering.y,\n          this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal,\n          this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown2), false, false, this.host.isGrayColor, this.host.visibilityValue, this.host.isPinValue, this.host.isHoverValue, this.host.isSelectedValue, true);\n      }\n\n      this.tUp += 0.015; // this.host.scene.annotationInstance.renderer.dt * 0.5;\n      this.tDown2 = 0;\n    } else {\n\n      if (this.host.isSelectedValue) {\n        drawingPresetPoint.shadowNPoint(ctx, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal, this.host.isSelected, this.host.isHover);\n\n        // drawingPresetPoint.PointNumberedOverBoundingByImg(ctx, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver), true, true, this.host.isGrayColor, this.host.visibility);\n        if (this.host.scene.annotationInstance.implementations.app.param.environment === Environment.AGSM) {\n          // console.log(this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal)\n          drawingPresetPoint.pointNumberedOverBoundingByCircleSelected(\n            ctx, this.host.styleComponent.renderStyle,\n            vecRendering.x, vecRendering.y,\n            this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal,\n            this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n            true, true,\n            this.host.isGrayColor, this.host.visibilityValue\n          );\n        } else {\n          drawingPresetPointSVG.pointSVGNormalFill(\n            ctx, this.host.scene.annotationInstance.customization.themeCurrent.nPoint.SVG.path2D, this.host.styleComponent.renderStyle,\n            vecRendering.x, vecRendering.y,\n            this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal,\n            this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown2),\n            false, false, this.host.isGrayColor, this.host.visibilityValue,\n            this.host.isPinValue, this.host.isHoverValue, this.host.isSelectedValue, true);\n        }\n\n        this.tOver += 0.015; // this.host.scene.annotationInstance.renderer.dt;\n        this.tDown1 = 0;\n        if (this.host.isHoverValue) {\n          this.tOverPopupSummary += this.host.scene.annotationInstance.renderer.dt;\n        } else {\n          this.tOverPopupSummary = 0;\n        }\n        this.host.isLeave = true;\n      } else if (this.host.isHoverValue) {\n        drawingPresetPoint.shadowNPointLight(\n          ctx, this.host.styleComponent.renderStyle,\n          vecRendering.x, vecRendering.y,\n          this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal,\n          this.host.isSelected,\n          this.host.isHover\n        );\n\n        if (this.host.scene.annotationInstance.implementations.app.param.environment === Environment.AGSM) {\n          drawingPresetPoint.pointNumberedOverBoundingByCircle(\n            ctx, this.host.styleComponent.renderStyle,\n            vecRendering.x, vecRendering.y,\n            this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal,\n            this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n            true, true,\n            this.host.isGrayColor,\n            this.host.visibility\n          );\n        } else {\n          drawingPresetPointSVG.pointSVGNormalFill(\n            ctx, this.host.scene.annotationInstance.customization.themeCurrent.nPoint.SVG.path2D, this.host.styleComponent.renderStyle,\n            vecRendering.x, vecRendering.y,\n            this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal,\n            this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown2),\n            false, false,\n            this.host.isGrayColor,\n            this.host.visibilityValue,\n            this.host.isPinValue,\n            this.host.isHoverValue,\n            this.host.isSelectedValue,\n            true\n          );\n        }\n\n        // bouncing effect init\n        // drawingPresetPoint.PointNumberedOverBoundingByImg(ctx, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver), true, true, this.host.isGrayColor, this.host.visibility);\n        // drawingPresetPointSVG.pointNumberedOverBoundingByCircle(\n        //   ctx,\n        //   this.host.scene.annotationInstance.customization.themeCurrent.nPoint.SVG.path2D,\n        //   this.host.styleComponent.renderStyle,\n        //   vecRendering.x,\n        //   vecRendering.y,\n        //   this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal,\n        //   this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n        //   true,\n        //   true,\n        //   this.host.isGrayColor,\n        //   this.host.visibilityValue\n        // );\n\n        this.tOver += 0.015; // this.host.scene.annotationInstance.renderer.dt * 0.5;\n        this.tOverPopupSummary += this.host.scene.annotationInstance.renderer.dt;\n        this.tDown1 = 0;\n        this.host.isLeave = true;\n      } else {\n        if (this.host.isLeave && !this.host.isDrag) {\n          // drawingPresetPoint.PointNumberedOverBoundingByImg(ctx, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown1), false, true, this.host.isGrayColor, this.host.visibility);\n\n          if (this.host.scene.annotationInstance.implementations.app.param.environment === Environment.AGSM) {\n            // drawingPresetPoint.PointNumberedOverBoundingByCircle(ctx, this.host.styleComponent.renderStyle, this.host.vec.x, this.host.vec.y, this.host.scaleForRender, this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown1), false, true, this.host.isGrayColor, this.host.visibility);\n            // TODO:\n          } else {\n            // TODO:\n          }\n          // bouncing effect ends\n          // drawingPresetPoint.pointNumberedOverBoundingByCircle(\n          //   ctx,\n          //   this.host.styleComponent.renderStyle,\n          //   vecRendering.x,\n          //   vecRendering.y,\n          //   this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal,\n          //   this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown1),\n          //   false,\n          //   true,\n          //   this.host.isGrayColor,\n          //   this.host.visibilityValue\n          // );\n\n          this.tDown1 += 0.015; // this.host.scene.annotationInstance.renderer.dt;\n          this.tOver = this.tOverPopupSummary = 0.0;\n\n          if (this.tDown1 > 0.15) {\n            this.host.isLeave = false;\n          }\n        } else if (!this.host.isDrag) {\n          // drawingPresetPoint.pointNumberedOverBoundingByImg(ctx, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown1), false, false, this.host.isGrayColor, this.host.visibility);\n\n          if (this.host.scene.annotationInstance.implementations.app.param.environment === Environment.AGSM) {\n            // TODO:\n          } else {\n            // TODO:\n          }\n\n          drawingPresetPoint.pointNumberedOverBoundingByCircle(\n            ctx, this.host.styleComponent.renderStyle,\n            vecRendering.x, vecRendering.y,\n            this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal,\n            this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown1),\n            false, false,\n            this.host.isGrayColor, this.host.visibilityValue\n          );\n          this.tDown1 += this.host.scene.annotationInstance.renderer.dt;\n          this.tOver = this.tOverPopupSummary = 0.0;\n        }\n      }\n      // drawingPresetPoint.PointNumberedDragByImg(ctx, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown2), false, false, this.host.isGrayColor, this.host.visibility, this.GetIndex()); // normal status\n      // drawingPresetPoint.pointNumberedDragByCircle(\n      //   ctx,\n      //   this.host.styleComponent.renderStyle,\n      //   vecRendering.x,\n      //   vecRendering.y,\n      //   this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal,\n      //   this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown2),\n      //   false,\n      //   false,\n      //   this.host.isGrayColor,\n      //   this.host.visibilityValue,\n      //   this.host.GetIndex(),\n      //   this.host.isHoverValue,\n      //   this.host.isSelectedValue\n      // ); // normal status\n\n      // normal status\n      if (this.host.scene.annotationInstance.implementations.app.param.environment === Environment.AGSM) {\n        drawingPresetPoint.pointNumberedDragByCircle(ctx, this.host.styleComponent.renderStyle,\n          vecRendering.x, vecRendering.y,\n          this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal, // this.host.scaleForRender,\n          this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown2),\n          false, false, this.host.isGrayColor, this.host.visibility, this.host.isHover, this.host.isSelected\n        );\n      } else {\n        drawingPresetPointSVG.pointSVGNormalFill(ctx, this.host.scene.annotationInstance.customization.themeCurrent.nPoint.SVG.path2D, this.host.styleComponent.renderStyle,\n          vecRendering.x, vecRendering.y,\n          this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal,\n          this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown2),\n          false, false, this.host.isGrayColor, this.host.visibilityValue, this.host.isPinValue, this.host.isHoverValue, this.host.isSelectedValue);\n      }\n\n\n\n      this.tUp = 0;\n      this.tDown2 += this.host.scene.annotationInstance.renderer.dt * 0.5;\n\n      if (this.tDown2 > 0.15) {\n        this.host.isDrop = false;\n      }\n\n      // debug\n      // ctx.strokeStyle = '#000';\n      // ctx.lineWidth = 1;\n      // ctx.beginPath();\n      // ctx.arc(vecRendering.x, vecRendering.y, 5, 0, 3.14 * 2)\n      // ctx.closePath();\n      // ctx.stroke();\n    }\n\n    this.DrawingText(ctx, vecRendering.x, vecRendering.y);\n\n    if (this.host.hasPopup && this.host.isMove) {\n      this.host.updateDivPos();\n    }\n    this.host.t += this.host.scene.annotationInstance.renderer.dt;\n\n    if (this.host.scene.annotationInstance.implementations.app.param.environment === Environment.AGSM) {\n      this.renderNPointCircleOffScreen(this.host.scene.annotationInstance.renderer.ctxOffscreen, vecRendering.x, vecRendering.y, this.host.scaleForRender * this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal);\n    } else {\n      this.offScreenRender(vecRendering.x, vecRendering.y)\n    }\n  }\n  public DrawingText(ctx: CanvasRenderingContext2D, x: number, y: number) {\n    const scale = this.geo.styleComponent.renderStyle.scaleLocal * this.geo.styleComponent.renderStyle.scaleGlobal ;\n    const theFont = `${this.geo.scene.annotationInstance.renderer.imageAnnoApp.customization.themeCurrent.nPoint.fontSize * scale }px ${this.geo.scene.annotationInstance.renderer.imageAnnoApp.customization.themeCurrent.nPoint.fontFamily}`;\n    ctx.font = theFont; // '10px Arial';\n    // if (this.shape.preset.regularPointColorHover === '#ffffff') { ctx.fillStyle = ColorHex.Black; } else { ctx.fillStyle = '#ffffff'; }\n    // const col = this.geo.scene.annotationInstance.renderer.imageAnnoApp.customization.themeCurrent.nPoint.fontColorArray;\n    // if (this.host.isHoverValue || this.host.isSelectedValue) {\n    //   ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    // } else {\n    //   ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3] - 0.3})`;\n    // }\n    ctx.textAlign = 'center'; // 'start', 'end', 'left', 'center', 'right';\n    // ctx.fillText(this.host.GetIndex().toString(), x - 1.5, y - (32 * scale  * 0.5) + 1);\n    ctx.fillStyle = this.host.styleComponent.textColor;\n    if (this.host.scene.annotationInstance.implementations.app.param.environment === Environment.AGSM) {\n      ctx.fillText(this.host.getIndex().toString(), x, y - (20 * scale  * 0.5));\n    } else {\n      ctx.fillText(this.host.getIndex().toString(), x, y - (28 * scale  * 0.5));\n    }\n  }\n  protected offScreenRender(x: number, y: number) {\n    const svgNpoint = getNumberedPointSMX();\n    renderNPointOffScreen(\n      this.host.scene.annotationInstance.renderer.ctxOffscreen,\n      [x, y], svgNpoint.path2D,\n      this.geo.hashColor,\n      this.geo.scene.annotationInstance.activeCommandController.scaleGlobal * this.geo.styleComponent.renderStyle.scaleLocal, -36 * 0.365, -28\n      );\n  }\n  protected renderNPointCircleOffScreen(ctx: CanvasRenderingContext2D, x: number, y: number, scale: number) {\n    const height = this.host.scene.annotationInstance.customization.themeCurrent.nPoint.height * scale;\n    ctx.fillStyle = this.geo.hashColor\n    ctx.beginPath();\n    ctx.arc(x, y - height * 0.5, height * 0.5, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n  }\n}\n\nexport const renderNPointOffScreen = (ctx: CanvasRenderingContext2D, pos: number[], path: Path2D, color: string, scale: number = 1, xOff: number = -32 * 0.25, yOff: number = -32) => {\n  ctx.fillStyle = color\n  ctx.save();\n  ctx.translate(pos[0] + xOff * scale, pos[1] + yOff * scale);\n  ctx.scale(scale, scale)\n  ctx.fill(path);\n  ctx.restore();\n};\n","import { IOGeometry } from '../../../../../../lib/Extended/GeometryUtility';\nimport {\n  MouseEventData,\n  GType,\n  Linecap,\n  PointRenderType,\n  Size,\n  NVector3,\n  getRatioByNewHeight,\n  getRatioByNewWidth\n} from '../../../../../../lib';\n// import { APoint } from '../../FamilyPoint/Base/APoint';\nimport { Scene } from '../../../../Scene';\nimport { AGeometryBase } from '../../../Common/Base/AGeometryBase';\nimport { APointBase } from '../../../Common/Base/APointBase';\nimport { InteractionComponent } from './Component/InteractionComponent';\nimport { RendererComponentGeneric } from './Component/RendererComponentGeneric';\n// import { CanvasTooltip } from '../../../../UIWrapper/CanvasTooltip/CanvasTooltip';\nimport { StyleComponent } from './Component/StyleComponent';\nimport { TransformationComponent } from './Component/TransformationComponent';\n\nenum ICON_SIZE {\n  LARGE = 1.2,\n  MEDIUM = 1,\n  SMALL = 0.832,\n}\nexport class APointRegularWrapper extends APointBase {\n  // public static toolTip: CanvasTooltip;\n  public styleComponent: StyleComponent;\n  public renderer: RendererComponentGeneric;\n  public interaction: InteractionComponent;\n  public r: number;\n  public vec: NVector3;\n  public tVec: NVector3;\n  public rOrigin: number;\n  public rTarget: number;\n  public type: GType;\n  public isPointMid: boolean;\n  public weightLeft: number;\n  public weightRight: number;\n  public popup: HTMLDivElement | undefined;\n  public imgData: ImageData;\n  public iconSize = 1;\n  public static findAtPoint(scene: Scene, x: number, y: number): undefined | AGeometryBase {\n    for (let i = scene.listRPoint.length - 1; i >= 0; --i) {\n      if (scene.listRPoint[i].isSelectable && scene.listRPoint[i].isMouseInside(x, y)) {\n        return scene.listRPoint[i];\n      }\n    }\n    return undefined;\n  }\n  public static getLengthSelection(scene: Scene) {\n    let i = scene.listRPoint.length;\n    let count = 0;\n    while (i--) {\n      if (scene.listRPoint[i].isSelected) {\n        count += 1;\n      }\n    }\n    return count;\n  }\n  public static removeAllCapturedGeo(scene: Scene) {\n    const temp = scene.listRPoint;\n    for (let i = 0; i < temp.length; ++i) {\n      if (scene.listRPoint[i].isSelectedValue === true) {\n        scene.listRPoint[i].remove();\n      }\n    }\n  }\n  public static deSelecteCaptureObjects(scene: Scene) {\n    for (let i = 0; i < scene.listRPoint.length; ++i) {\n      scene.listRPoint[i].isSelectedValue = false;\n    }\n  }\n  public static moveSelectedGeo(scene: Scene, e: MouseEventData) {\n    for (let i = 0; i < scene.listRPoint.length; ++i) {\n      if (scene.listRPoint[i].isSelectedValue === true && !scene.listRPoint[i].isHoverValue) {\n        scene.listRPoint[i].translateByMouseEventData(e);\n      }\n      if (scene.listRPoint[i].isHoverValue === true) {\n        scene.listRPoint[i].translateByMouseEventData(e);\n      }\n    }\n  }\n  public static fromJSON(scene: Scene, g: IOGeometry, isUndo = false, isDeepCopy = false) {\n    const p = [g.nodes[0].sx, g.nodes[0].sy]; // .toScreen(mp);\n    const cp = new APointRegularWrapper(scene, p[0], p[1], 0, isUndo);\n    if (g.styles) {\n      cp.updateStyleCustom(g.styles);\n    }\n    cp.type = GType[g.type];\n    // cp.style = g.style;\n    cp.isHiddenValue = g.isHidden;\n    if (isDeepCopy) {\n      cp.id = scene.getUUID();\n    } else {\n      cp.id = g.id;\n    }\n    if (g.isHidden) {\n      cp.visibilityValue = 0;\n    } else {\n      cp.visibilityValue = 1;\n    }\n\n    if (g.data.scale) {\n      cp.initScale(g.data.scale);\n    }\n    if (g.data.url) {\n      cp.updateIcon(g.data.url);\n    }\n\n    cp.initVecsHistory();\n    return cp;\n  }\n  public static mouseRightClick(e: MouseEventData) {\n    /* */\n  }\n  public static mouseMiddleClick(e: MouseEventData) {\n    /* */\n  }\n  public static mouseLeftClick(scene: Scene, e: MouseEventData) {\n    if (scene.capture !== undefined) {\n      return;\n    }\n    const p = new APointRegularWrapper(scene, e.x, e.y, 0);\n    p.dummy();\n    if (scene.annotationInstance.activeCommandController.acProperties.pressShift) {\n      return;\n    }\n    scene.annotationInstance.activeCommandController.goToACMode();\n  }\n  public static onMouseMove(e: MouseEventData) {\n    // APointRegular.toolTip = new CanvasTooltip()\n  }\n  public static mouseDrag(e: MouseEventData) {\n    /* */\n  }\n  public static mouseUp(e: MouseEventData) {\n    /* */\n  }\n  constructor(\n    scene: Scene,\n    x = 0,\n    y = 0,\n    z = 0,\n    isUndo = false,\n    type: GType = GType.POINT_REGULAR,\n    radius = 5,\n    colorCircle = 'white',\n    colorBorder = 'black',\n    lineCap: Linecap = Linecap.Round\n  ) {\n    super(scene, x, y, z, type);\n    this.isUndo = isUndo;\n    this.scaleForRender = 1.0;\n    this.initComponent();\n    this.updateBoundingBox();\n    scene.addRPoint(this);\n    if (!this.isUndo) {\n      scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(this.toJSON());\n    }\n  }\n  private initComponent() {\n    this.styleComponent = new StyleComponent(this);\n    this.renderer = new RendererComponentGeneric(this);\n    this.transformation = new TransformationComponent(this);\n    this.interaction = new InteractionComponent(this);\n  }\n  public init() {\n    this.isGeoPos = true;\n    this.edges = [];\n    this.isPointMid = false;\n  }\n  public getParentType() {\n    return 'ANNOTATION_POINT_REGULAR';\n  }\n  // .......................................................................... Renderer\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    if (isNaN(this.vec.x)) {\n      return;\n    }\n    this.renderer.renderPost(ctx);\n    if (this.scene.annotationInstance.implementations.app.INSPECTION) {\n      this.collision.render(ctx);\n    }\n  }\n  // .................................................................. InteractionComponent\n  public isMouseInside(x: number, y: number): boolean {\n    return this.interaction.isMouseInside(x, y);\n  }\n  public isMouseInsideWithTolerance(x: number, y: number, tolerance: number) {\n    // console.log(x, y);\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return false;\n    }\n    if (this.isCollapse) {\n      return false;\n    }\n    // return this.Distance(x, y + 11) <= this.r + 12; // Offset value(11) for the mouse detection of the numbered point\n    const dis = this.distance(x, y + 11 * this.scaleForRender);\n    // console.log(dis);\n    return dis <= this.r * this.scaleForRender + 12 * this.scaleForRender + tolerance; // Offset value(11) for the mouse detection of the numbered point;\n  }\n  public getLog(): string {\n    return this.interaction.getLog();\n  }\n  public hide(): void {\n    this.interaction.hide();\n  }\n  public get isSelected() {\n    return this.isSelectedValue;\n  }\n  public set isSelected(v: boolean) {\n    this.isSelectedValue = v;\n    this.scene.annotationInstance.io.eventListenerAnnotation.selectionStack(this.toJSON());\n  }\n  public get isHover() {\n    return this.isHoverValue;\n  }\n  public set isHover(v: boolean) {\n    // console.trace();\n    this.isHoverValue = v;\n    if (this.isHoverValue && !this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    } else if (!this.isHoverValue && this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    }\n    this.isHoverPre = this.isHoverValue;\n    if (!v) {\n      this.needEmitHoverPost = true;\n      this.hidePopUpSummary();\n    }\n  }\n  public get isPin() {\n    return this.isPinValue;\n  }\n  public set isPin(v: boolean) {\n    this.isPinValue = v;\n  }\n  // .................................................................. TransformationComponent\n  public translateByMouseEventData(e: MouseEventData): void {\n    if (!this.isMovableValue) {\n      return;\n    }\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    this.transformation.translateByMouseEventData(e);\n    if (this.textLeaderline) {\n      this.textLeaderline.translateByMouseEventData(e);\n      if (this.textLeaderline && this.textLeaderline.leaderline) {\n        // if (this.wrapping.needWrappingToLeft || this.wrapping.needWrappingToRight) {\n        this.textLeaderline.leaderline.v2.x = this.vec.x;\n        this.textLeaderline.leaderline.v2.y = this.vec.y;\n        // }\n      }\n    }\n  }\n  public translate(x: number, y: number) {\n    this.transformation.translate(x, y);\n  }\n  public updateDivPos() {\n    this.interaction.updateDivPos();\n  }\n  public showPopupSummary() {\n    this.interaction.showPopupSummary();\n  }\n  public updatePopup() {\n    this.interaction.updatePopup();\n  }\n  // ...................................................................\n  public updateIcon(v: string) {\n    this.renderer.pointRenderType = PointRenderType.Image;\n    this.styleComponent.renderStyle.url = v;\n  }\n  public removeIcon() {\n    this.renderer.pointRenderType = PointRenderType.RpointA;\n  }\n  // .................................................................. implementation\n  public remove(needEmit = true) {\n    if (!this.isRenderable || this.isHiddenValue) {\n      return;\n    }\n    this.isRemove = true;\n    this.isSelectable = false;\n    this.isRenderable = false;\n\n    if (this.hasPopupValue) {\n      this.hidePopUpSummary();\n    }\n\n    if (!this.isGhost && needEmit) {\n      const ioGeo = this.toJSON();\n      if (ioGeo) {\n        this.scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack([ioGeo]);\n      }\n    }\n\n    if (this.textLeaderline) {\n      this.textLeaderline.removeByAttachedShape();\n      this.textLeaderline = undefined;\n    }\n\n    this.scene.removeBasePoint(this);\n    this.scene.removeRPoint(this);\n    this.scene.removeGeometry(this);\n  }\n  public deepCopy(x: number, y: number) {\n    return new APointRegularWrapper(this.scene, x, y, this.vec.z, false, this.type, this.r);\n  }\n  // .......................................................................... implementation\n  public mouseLeftClick() {\n    if (this.isGhost) {\n      return;\n    }\n    // if (this.scene.imageAnnoApp.implementation.app.model.appCoreWrapper.appAccessibility.mode === INTERACTION_MODE.INTERACTIVE_VIEWER) {\n    this.scene.annotationInstance.geometryCommon.gcmdProcessing.removeAllPopup();\n    this.showPopupSummary();\n    // }\n  }\n  public updateBoundingBox() {\n    this.scaleForRender =\n      this.iconSize * this.scene.annotationInstance.customization.themeCurrent.rPoint.scale;\n    const scale = this.scaleForRender;\n    const height = 32 * scale;\n\n    const widthHalf = 23 * scale * 0.65;\n    const xOff = -4 ;\n    // if (this.renderer && this.renderer.pointRenderType === POINT_RENDER_TYPE.IMAGE) {\n    //   widthHalf = 32 * scale * 0.5;\n    // }\n\n    this.collision.minVec = new NVector3(this.vec.x - widthHalf + xOff, this.vec.y - height - 2);\n    this.collision.maxVec = new NVector3(this.vec.x + widthHalf + xOff, this.vec.y + 1);\n    // this.scene.imageAnnoApp.renderer.agentBaseOptimizer.needUpdateComputeCollision = true;\n  }\n  public get size() {\n    return this.sizeValue;\n  }\n  // RPoint size: 28 / 32 / 40\n\n  public set size(v: Size) {\n    // original size : 32px * 32px\n    // 1.25  : 40px\n    // 1.0   : 32px\n    // 0.725 : 24px\n    // 0.5   : 16px\n    this.sizeValue = v;\n\n    if (this.styleComponent.img) {\n      // console.debug('from size, actual', this.styleComponent.img.width, this.styleComponent.img.height);\n      let sizeRattho: number[] = [];\n      switch (v) {\n        case Size.LARGE:\n          this.iconSize = ICON_SIZE.LARGE;\n          this.styleComponent.renderStyle.size = Size.LARGE;\n\n          if (this.styleComponent.img.width > this.styleComponent.img.height) {\n            sizeRattho = getRatioByNewWidth(\n              this.styleComponent.img.width,\n              this.styleComponent.img.height,\n              40\n            );\n          } else {\n            sizeRattho = getRatioByNewHeight(\n              this.styleComponent.img.width,\n              this.styleComponent.img.height,\n              40\n            );\n          }\n          this.styleComponent.img.width = sizeRattho[0];\n          this.styleComponent.img.height = sizeRattho[1];\n          break;\n        case Size.MEDIUM:\n          this.iconSize = ICON_SIZE.MEDIUM;\n          this.styleComponent.renderStyle.size = Size.MEDIUM;\n\n          if (this.styleComponent.img.width > this.styleComponent.img.height) {\n            sizeRattho = getRatioByNewWidth(\n              this.styleComponent.img.width,\n              this.styleComponent.img.height,\n              32\n            );\n          } else {\n            sizeRattho = getRatioByNewHeight(\n              this.styleComponent.img.width,\n              this.styleComponent.img.height,\n              32\n            );\n          }\n          this.styleComponent.img.width = sizeRattho[0];\n          this.styleComponent.img.height = sizeRattho[1];\n          break;\n        case Size.SMALL:\n          this.iconSize = ICON_SIZE.SMALL;\n          this.styleComponent.renderStyle.size = Size.SMALL;\n          // console.log(this.styleComponent.img.width, this.styleComponent.img.height)\n          if (this.styleComponent.img.width > this.styleComponent.img.height) {\n            sizeRattho = getRatioByNewWidth(\n              this.styleComponent.img.width,\n              this.styleComponent.img.height,\n              28\n            );\n          } else {\n            sizeRattho = getRatioByNewHeight(\n              this.styleComponent.img.width,\n              this.styleComponent.img.height,\n              28\n            );\n          }\n          // console.log(sizeRattho);\n          this.styleComponent.img.width = sizeRattho[0];\n          this.styleComponent.img.height = sizeRattho[1];\n          break;\n        default:\n          break;\n      }\n    }\n\n    if (this.renderType !== PointRenderType.Image) {\n      switch (v) {\n        case Size.LARGE:\n          this.iconSize = ICON_SIZE.LARGE;\n          this.styleComponent.renderStyle.size = Size.LARGE;\n          break;\n        case Size.MEDIUM:\n          this.iconSize = ICON_SIZE.MEDIUM;\n          this.styleComponent.renderStyle.size = Size.MEDIUM;\n          break;\n        case Size.SMALL:\n          this.iconSize = ICON_SIZE.SMALL;\n          this.styleComponent.renderStyle.size = Size.SMALL;\n          break;\n        default:\n          break;\n      }\n    }\n\n    this.updateBoundingBox();\n    // console.debug('from size, after', this.styleComponent.img.width, this.styleComponent.img.height);\n  }\n  public get renderType(): PointRenderType {\n    return this.renderer.pointRenderType;\n  }\n  public set renderType(v: PointRenderType) {\n    this.renderer.pointRenderType = v;\n  }\n}\n","import { Size } from '../../../../../../../lib';\nimport { ThemeColorId } from '../../../../../Customization/ThemeRenderStyle/Utility';\nimport { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { APointNumberedWrapper } from '..';\nimport { readableColor } from 'polished';\nexport class StyleComponent extends _StyleComponent {\n  public geo: APointNumberedWrapper;\n  public textColor: string = '#000';\n  constructor(geo: APointNumberedWrapper) {\n    super(geo);\n    this.updateStyle();\n    this.updateColor();\n  }\n  public updateStyle() {\n    if (!this.isCustom) {\n      this.state.themeColorId = ThemeColorId.AccentColor1;\n      this.isCustom = true;\n      RenderStyle.updateRenderStyleNPoint(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n    }\n    this.updateTextColor()\n  }\n  public updateColor(color: number[] | undefined = undefined) {\n    this.isCustom = true;\n    if (color === undefined) {\n      color = this.geo.scene.annotationInstance.activeCommandController.activeColorController.activeColor;\n    }\n    RenderStyle.updateRenderColorNPoint(\n      this.renderStyle,\n      this.geo.scene.annotationInstance.customization.themeCurrent,\n      color\n    );\n    this.tempColorRgba = color;\n    this.updateTextColor()\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public updateStyleCustom(style: any): boolean {\n    // if (this.isSameStyle(style)) {\n    //   return false;\n    // }\n    let needEmit = false;\n\n    if (style.size) {\n      this.geo.size = style.size.toUpperCase() as Size;\n      needEmit = true;\n    }\n    if (style.width) {\n      this.state.width = style.width;\n    }\n    if (style.color !== undefined) {\n      this.state.themeColorId = style.color as ThemeColorId;\n    }\n\n    if (style.colorRgba.length > 0) {\n      this.tempColorRgba = style.colorRgba;\n      RenderStyle.updateRenderColorRPointCustom(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent,\n        style.colorRgba\n      );\n    }\n    if (style.scale) {\n      this.renderStyle.scaleLocal = style.scale;\n      this.state.scale = style.scale;\n    }\n    this.isCustom = true;\n    if (needEmit && !this.geo.isUnderConstruction) {\n      this.geo.isTransform = true;\n      // this.geoHost.scene.annotationInstance.io.eventListenerAnnotation.TransformStack([this.geoHost.ToJSON()]);\n    }\n    this.updateTextColor()\n    return true;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public toJson(): any | undefined {\n    if (!this.isCustom) {\n      return undefined;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const output: any = {\n      width: this.state.width,\n      scale: this.renderStyle.scaleLocal,\n      colorRgba: this.tempColorRgba, // this is necessary for updating state on React side\n      number: this.geo.getIndex()\n    };\n    if (this.renderStyle.size !== Size.MEDIUM) {\n      output.size = this.renderStyle.size.toLowerCase();\n    }\n\n    if (this.state.themeColorId !== ThemeColorId.AccentColor1) {\n      output.color = this.state.themeColorId;\n    }\n\n    // if (this.state.lineTypeId !== LineTypeId.Continuous) {\n    //   output.lineDash = this.state.lineTypeId;\n    // }\n    return output;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  protected isSameStyle(style: any) {\n    if (style.colorRgba.length === this.tempColorRgba.length) {\n      for (let i = 0; i < style.colorRgba.length; i++) {\n        if (style.colorRgba[i] !== this.tempColorRgba[i]) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n  private updateTextColor() {\n    this.textColor = readableColor(this.renderStyle.colorFill);\n  }\n}\n","import { MouseEventData, NVector3 } from '../../../../../../../lib';\nimport { AGeometryBase } from '../../../../Common/Base/AGeometryBase';\nimport { TransformationComponent as _TransformationComponent } from '../../../../Common/Base/ComponentTemplate/TransformationComponent';\nexport class TransformationComponent extends _TransformationComponent {\n  public geo: AGeometryBase;\n  public v: NVector3;\n  constructor(geo: AGeometryBase) {\n    super(geo);\n    this.geo = geo;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    //\n  }\n  public translate(x: number, y: number): void {\n    //\n  }\n}\n","import { IOGeometry } from '../../../../../../lib/Extended/GeometryUtility';\nimport {\n  GType,\n  MouseEventData,\n  Linecap,\n  NVector3,\n} from '../../../../../../lib';\nimport { Scene } from '../../../../Scene';\nimport { AGeometryBase } from '../../../Common/Base/AGeometryBase';\nimport { APointBase } from '../../../Common/Base/APointBase';\nimport { InteractionComponent } from './Component/InteractionComponent';\nimport { RendererComponent } from './Component/RendererComponent';\nimport { StyleComponent } from './Component/StyleComponent';\nimport { TransformationComponent } from './Component/TransformationComponent';\nexport class APointNumberedWrapper extends APointBase {\n  public styleComponent: StyleComponent;\n  // ..................... members\n  public renderer: RendererComponent;\n  public r: number;\n  public vec: NVector3;\n  public tVec: NVector3;\n  public rOrigin: number;\n  public rTarget: number;\n  public type: GType;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public graph: any;\n  public isPointMid: boolean;\n  public weightLeft: number;\n  public weightRight: number;\n  public t: number;\n  public img: HTMLImageElement;\n  public numberIndexNeeded = true;\n  public svgPath = new Path2D('M26 2a2 2 0 00-2-2H2a2 2 0 00-2 2v17a2 2 0 002 2h6.757l4.276 6.33L17.31 21H24a2 2 0 002-2V2z');\n  private _numberIndex = -1;\n  private _hashColorRGB = [0, 0, 0, 0];\n  // ................................... end implementation\n  public static FindAtPoint(scene: Scene, x: number, y: number): undefined | AGeometryBase {\n    for (let i = scene.listNPoint.length - 1; i >= 0; --i) {\n      if (\n        scene.listNPoint.length[i].isSelectable &&\n        scene.listNPoint.length[i].IsMouseInside(x, y)\n      ) {\n        return scene.listNPoint.length[i];\n      }\n    }\n    return undefined;\n  }\n  public static GetLengthSelection(scene: Scene) {\n    let i = scene.listNPoint.length;\n    let count = 0;\n    while (i--) {\n      if (scene.listNPoint[i].isSelected) {\n        count += 1;\n      }\n    }\n    return count;\n  }\n  public static RemoveAllCapturedGeo(scene: Scene) {\n    const temp = scene.listNPoint;\n    for (let i = 0; i < temp.length; ++i) {\n      if (scene.listNPoint[i].isSelectedValue === true) {\n        scene.listNPoint[i].remove();\n      }\n    }\n  }\n  public static DeSelecteCaptureObjects(scene: Scene) {\n    for (let i = 0; i < scene.listNPoint.length; ++i) {\n      scene.listNPoint[i].isSelectedValue = false;\n    }\n  }\n  public static MoveSelectedGeo(scene: Scene, e: MouseEventData) {\n    for (let i = 0; i < scene.listNPoint.length; ++i) {\n      if (scene.listNPoint[i].isSelectedValue === true && !scene.listNPoint[i].isHoverValue) {\n        scene.listNPoint[i].translateByMouseEventData(e);\n      }\n      if (scene.listNPoint[i].isHoverValue === true) {\n        scene.listNPoint[i].translateByMouseEventData(e);\n      }\n    }\n  }\n  public static FromJSON(scene: Scene, g: IOGeometry, isUndo = false, isDeepCopy = false) {\n    const mp = [g.nodes[0].sx, g.nodes[0].sy];\n    const cp = new APointNumberedWrapper(scene, mp[0], mp[1], 0, isUndo);\n    cp.type = GType[g.type];\n    // cp.style = g.style;\n    if (isDeepCopy) {\n      cp.id = scene.getUUID();\n    } else {\n      cp.id = g.id;\n    }\n    cp.isHiddenValue = g.isHidden;\n    if (g.isHidden) {\n      cp.visibilityValue = 0;\n    } else {\n      cp.visibilityValue = 1;\n    }\n    if (g.styles) {\n      cp.updateStyleCustom(g.styles);\n    }\n\n    cp.initVecsHistory();\n    return cp;\n  }\n  // ......................................................................... mouse interaction\n  public static MouseRightClick(e: MouseEventData) {\n    /* */\n  }\n  public static MouseMiddleClick(e: MouseEventData) {\n    /* */\n  }\n  public static mouseLeftClick(scene: Scene, e: MouseEventData) {\n    if (scene.capture !== undefined) {\n      return;\n    }\n    const g = new APointNumberedWrapper(scene, e.x, e.y, 0);\n    g.dummy();\n    if (scene.annotationInstance.activeCommandController.acProperties.pressShift) {\n      return;\n    }\n    scene.annotationInstance.activeCommandController.goToACMode();\n  }\n  constructor(scene: Scene, x = 0, y = 0, z = 0, isUndo = false, type: GType = GType.POINT_NUMBERED, radius = 5, colorCircle = 'white', colorBorder = 'black', lineCap: Linecap = Linecap.Round) {\n    super(scene, x, y, z, type);\n    this.type = type;\n    this.isUndo = isUndo;\n    this.numberIndex = this.scene.listNPoint.length + 1;\n\n    const colString = this.hashColor.split('(')[1].split(')')[0].split(',');\n    this._hashColorRGB = [+colString[0], +colString[1], +colString[2]];\n\n    // this.isRenderable = needInitAni;\n    this.InitComponent();\n    scene.addNPoint(this);\n\n    if (this.isUndo) {\n      return;\n    }\n    scene.annotationInstance.io.eventListenerAnnotation.addGeometryStack(this.toJSON());\n  }\n  public InitComponent() {\n    this.styleComponent = new StyleComponent(this);\n    this.renderer = new RendererComponent(this);\n    this.transformation = new TransformationComponent(this);\n    this.interaction = new InteractionComponent(this);\n  }\n  public init() {\n    this.isGeoPos = true;\n    // this.hasPopup = true;\n    this.edges = [];\n    this.isPointMid = false;\n    // if (this.hasSound) { this.sound.PlayClickPoint(); }\n    this.t = 0.0;\n  }\n  public isMouseInside(x: number, y: number) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return false;\n    }\n    if (this.isCollapse) {\n      return false;\n    }\n\n    /* by Math distance\n    // return this.Distance(x, y + 11) <= this.r + 12; // Offset value(11) for the mouse detection of the numbered point\n    const dis = this.distance(x, y + 11 * this.scaleForRender);\n    // console.log(dis);\n    return dis <= this.r * this.scaleForRender + 12 * this.scaleForRender; // Offset value(11) for the mouse detection of the numbered point;\n    */\n\n    // if (this.scene.annotationInstance.implementations.app.param.environment === Environment.AGSM) {\n    //   return this.isMouseInsideWithTolerance(x, y, 1);\n    // } else {\n      const result =  this.scene.annotationInstance.geometryCommon.gcmdProcessing.isMouseInsideByOffScreenNumberPoint(\n        x - this.scene.annotationInstance.renderer.imageAnnoApp.scene.paramsEditing.croppingMaskParams.x,\n        y - this.scene.annotationInstance.renderer.imageAnnoApp.scene.paramsEditing.croppingMaskParams.y,\n        this._hashColorRGB\n      );\n      return result;\n    // }\n  }\n  public isMouseInsideWithTolerance(x: number, y: number, tolerance: number) {\n    if (this.isRemove || !this.isRenderable || this.isHiddenValue) {\n      return false;\n    }\n    if (this.isCollapse) {\n      return false;\n    }\n    // return this.Distance(x, y + 11) <= this.r + 12; // Offset value(11) for the mouse detection of the numbered point\n    const dis = this.distance(x, y + 11 * this.scaleForRender);\n    return dis <= this.r * this.scaleForRender + 12 * this.scaleForRender + tolerance; // Offset value(11) for the mouse detection of the numbered point;\n  }\n  public getParentType() {\n    return 'ANNOTATION.POINT_NUMBERED';\n  }\n  // ................................... implementation\n  public remove(needEmit = true) {\n    // console.trace();\n    // if (this.hasSound) { this.sound.PlayBlackhole(); }\n    this.isSelectable = false;\n    this.isRenderable = false;\n    if (this.hasPopupValue) {\n      this.hidePopUpSummary();\n    }\n\n    if (needEmit) {\n      const ioGeo = this.toJSON();\n      if (ioGeo) {\n        this.scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack([ioGeo]);\n      }\n    }\n    if (this.textLeaderline) {\n      this.textLeaderline.removeByAttachedShape();\n      this.textLeaderline = undefined;\n    }\n\n    this.scene.removeBasePoint(this);\n    this.scene.removeNPoint(this);\n    this.scene.removeGeometry(this);\n  }\n  public getIndex() {\n    return this.scene.listNPoint.indexOf(this) + 1;\n  }\n  public deepCopy(x: number, y: number) {\n    return new APointNumberedWrapper(this.scene, x, y, this.vec.z, false, this.type, this.r);\n  }\n  // .......................................................................... implementation\n  public get isSelected() {\n    return this.isSelectedValue;\n  }\n  public set isSelected(v: boolean) {\n    this.isSelectedValue = v;\n    this.scene.annotationInstance.io.eventListenerAnnotation.selectionStack(this.toJSON());\n  }\n  public get isHover() {\n    return this.isHoverValue;\n  }\n  public set isHover(v: boolean) {\n    // console.log('hhhooovveer');\n    this.isHoverValue = v;\n    if (this.isHoverValue && !this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    } else if (!this.isHoverValue && this.isHoverPre) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.hoverStack(this.toJSON());\n    }\n    this.isHoverPre = this.isHoverValue;\n    if (!v) {\n      this.needEmitHoverPost = true;\n      this.hidePopUpSummary();\n    }\n  }\n\n  public mouseLeftClick() {\n    // if (this.scene.imageAnnoApp.implementation.app.model.appCoreWrapper.appAccessibility.mode === INTERACTION_MODE.INTERACTIVE_VIEWER) {\n\n    this.scene.annotationInstance.geometryCommon.gcmdProcessing.removeAllPopup();\n    this.showPopupSummary();\n  }\n  public updateDivPos() {\n    if (this.popup) {\n      this.popup.style.top =\n        this.vec.y -\n        31 * this.scene.annotationInstance.customization.themeCurrent.nPoint.scale +\n        'px';\n      this.popup.style.left =\n        this.vec.x -\n        17 * this.scene.annotationInstance.customization.themeCurrent.nPoint.scale +\n        'px';\n    }\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.renderer.renderPost(ctx);\n    if (this.scene.annotationInstance.implementations.app.INSPECTION) {\n      this.collision.render(ctx);\n    }\n  }\n  public toJSON(): IOGeometry | undefined {\n    if (\n      this.type === GType.ANODE ||\n      this.type === GType.ANODE_CIRCLE ||\n      this.type === GType.AMIDPOINT ||\n      this.type === GType.AN_GON ||\n      this.type === GType.ANODE_RECT\n    ) {\n      return undefined;\n    }\n    const p = new IOGeometry(\n      this.id,\n      this.type,\n      this.isSelectedValue,\n      this.isHoverValue,\n      this.isHiddenValue\n    );\n    p.pushNode(this.getNode());\n    // let d = { numIndex: this.numberIndex };\n    // p.data = d;\n    // console.log(p);\n\n    const styles = this.styleComponent.toJson();\n    if (styles) {\n      p.styles = styles;\n    }\n\n    return p;\n  }\n  public get numberIndex() {\n    return this._numberIndex;\n  }\n  public set numberIndex(v: number) {\n    this._numberIndex = v;\n    // this.scene.imageAnnoApp.io.eventListenerAnnotation.tra(this.ToJSON());\n  }\n  public updateBoundingBox() {\n    // console.log(this.vec);\n    this.collision.minVec = new NVector3(this.vec.x - 16, this.vec.y - 30);\n    this.collision.maxVec = new NVector3(this.vec.x + 16, this.vec.y + 2);\n    // this.scene.imageAnnoApp.renderer.agentBaseOptimizer.needUpdateComputeCollision = true;\n  }\n  public showPopupSummary() {\n    if (!this.scene.annotationInstance.activeCommandController.needPopup()) {\n      return\n    }\n    // console.trace();\n    // console.log('pop', this.GetIndex());\n    if (this.hasPopupValue || this.popup || this.isGhost) {\n      return;\n    }\n    // if (this.isGhost) { return; }\n    // console.trace();\n    this.hasPopupValue = true;\n    this.popup = document.createElement('div') as HTMLDivElement;\n    this.popup.id = 'pa-' + this.id;\n    this.popup.style.position = 'absolute';\n    this.popup.style.pointerEvents = 'none';\n    // this.popup.style.zIndex = '1000';\n\n    // console.log('pop', this.GetIndex(), this.popup.id);\n\n    // this.popup.style.backgroundColor = 'red';\n    this.scene.annotationInstance.implementations.app.model.modelViewWrapper.div.appendChild(\n      this.popup\n    );\n\n    this.popup.style.height =\n      this.scene.annotationInstance.customization.themeCurrent.nPoint.scale * 34 + 'px';\n    this.popup.style.width =\n      this.scene.annotationInstance.customization.themeCurrent.nPoint.scale * 34 + 'px';\n\n    this.popup.style.top =\n      this.vec.y -\n      31 * this.scene.annotationInstance.customization.themeCurrent.nPoint.scale +\n      'px';\n    this.popup.style.left =\n      this.vec.x -\n      17 * this.scene.annotationInstance.customization.themeCurrent.nPoint.scale +\n      'px';\n\n    if (this.showPopupStackTimer) {\n      clearTimeout(this.showPopupStackTimer);\n    }\n    this.showPopupStackTimer = setTimeout(() => {\n      if (this.popup) {\n        this.scene.annotationInstance.io.eventListenerAnnotation.showPopupStack(this.toJSON());\n      }\n    }, this.timePopupDelay);\n  }\n  public updatePopup() {\n    if (this.hasPopupValue && this.popup !== undefined) {\n      if (this.hasGhostPopup) {\n        this.popup.style.top =\n          this.vec.y -\n          this.scene.annotationInstance.customization.themeCurrent.nPoint.height -\n          this.ghostPopupOffset +\n          'px';\n        this.popup.style.left = this.vec.x + 'px';\n      } else {\n        this.popup.style.top =\n          this.vec.y -\n          31 * this.scene.annotationInstance.customization.themeCurrent.nPoint.scale +\n          'px';\n        this.popup.style.left =\n          this.vec.x -\n          17 * this.scene.annotationInstance.customization.themeCurrent.nPoint.scale +\n          'px';\n      }\n    }\n  }\n  public hidePopUpSummary() {\n    // console.log(this.popup, this.GetIndex());\n    // setTimeout(() => {\n    //   console.log(this.scene.imageAnnoApp.activeCommandController.acProperties.insideMap);\n    if (\n      this.popup &&\n      this.popup.parentNode &&\n      this.scene.annotationInstance.activeCommandController.acProperties.insideMap\n      // && this.isHover\n    ) {\n      // console.log('removing');\n      // console.trace();\n      this.renderer.tOverPopupSummary = 0;\n      this.popup.parentNode.removeChild(this.popup);\n      if (this.type === GType.CNODE) {\n        const p = new IOGeometry(\n          this.id,\n          this.type,\n          this.isSelectedValue,\n          this.isHoverValue,\n          this.isHiddenValue\n        );\n        p.pushNode(this.getNode());\n        this.scene.annotationInstance.io.eventListenerAnnotation.hidePopupStack(p);\n      } else {\n        this.scene.annotationInstance.io.eventListenerAnnotation.hidePopupStack(this.toJSON());\n      }\n      this.hasPopupPre = false;\n      this.popup = undefined;\n      this.hasPopupValue = false;\n    }\n    // }, 500);\n  }\n}\n","import { getDistance, isInsideOfTwoVecs, NVector3, PointRenderType } from '../../../../../../../lib';\nimport { APointRegularWrapper } from '..';\nexport class InteractionComponent {\n  public geo: APointRegularWrapper;\n  private showPopupStackTimer: any;\n  constructor(geo: APointRegularWrapper) {\n    this.geo = geo;\n  }\n  public isMouseInside(x: number, y: number) {\n    if (this.geo.isRemove || !this.geo.isRenderable || this.geo.isHiddenValue) {\n      return false;\n    }\n    if (this.geo.isCollapse) {\n      return false;\n    }\n    // this.geo.scene.imageAnnoApp.implementations\n\n    // return this.geo.scene.imageAnnoApp.geometryCommon.gcmdProcessing.IsMouseInsideByOffScreen(x, y + 0, this.geo.hashColor);\n    // return  IsInsideOfVecs(new NVector3(x,y), [])\n\n    // Touch a R Point on mobile is not working correctly, so we apply simple circle detection.\n    if (\n      this.geo.scene.annotationInstance.implementations.app.model.appCoreWrapper.browserUtility\n        .isMobile\n    ) {\n      const dis = getDistance(\n        new NVector3(x, y),\n        new NVector3(\n          this.geo.vec.x,\n          this.geo.vec.y - (this.geo.collision.maxVec.y - this.geo.collision.minVec.y) * 0.5\n        )\n      );\n      if (dis < 15) {\n        return true;\n      }\n      return false;\n    }\n    // this.geo.scene.imageAnnoApp.renderer.debugText += 100;\n    const rere = isInsideOfTwoVecs(\n      new NVector3(x, y),\n      this.geo.collision.minVec,\n      this.geo.collision.maxVec\n    );\n    return rere;\n  }\n  public getLog() {\n    return '';\n  }\n  public hide(): void {\n    //\n  }\n  public updateDivPos() {\n    if (this.geo.popup) {\n      switch (this.geo.renderer.pointRenderType) {\n        case PointRenderType.RpointA:\n          this.geo.popup.style.top = this.geo.vec.y - 32 + 'px';\n          this.geo.popup.style.left = this.geo.vec.x - 10 + 'px';\n          break;\n        case PointRenderType.Image:\n          this.geo.popup.style.top = this.geo.vec.y + 'px';\n          this.geo.popup.style.left =\n            this.geo.vec.x + this.geo.styleComponent.img.width * 0.5 + 1 + 'px';\n          break;\n        default:\n          break;\n      }\n    }\n  }\n  public showPopupSummary() {\n    if (!this.geo.scene.annotationInstance.activeCommandController.needPopup()) {\n      return\n    }\n    // console.trace();\n    // console.log('pop');\n    if (this.geo.hasPopup || this.geo.isGhost) {\n      return;\n    }\n    // if (this.geo.isGhost) { return; }\n    // console.trace();\n    this.geo.hasPopup = true;\n    this.geo.popup = document.createElement('div') as HTMLDivElement;\n    this.geo.popup.id = 'pa-' + this.geo.id;\n    this.geo.popup.style.position = 'absolute';\n    this.geo.popup.style.pointerEvents = 'none';\n    // this.geo.popup.style.zIndex = '1000';\n    // this.geo.popup.style.backgroundColor = 'red';\n    this.geo.scene.annotationInstance.implementations.app.model.modelViewWrapper.div.appendChild(\n      this.geo.popup\n    );\n\n    switch (this.geo.renderer.pointRenderType) {\n      case PointRenderType.RpointA:\n        if (this.geo.scene.annotationInstance.customization.themeCurrent.nPoint.scale === 1) {\n          this.geo.popup.style.height = '33px';\n          this.geo.popup.style.width = '18px';\n          this.geo.popup.style.top = this.geo.vec.y - 32 + 'px';\n          this.geo.popup.style.left = this.geo.vec.x - 10 + 'px';\n        } else {\n          this.geo.popup.style.height =\n            32 * this.geo.scene.annotationInstance.customization.themeCurrent.nPoint.scale + 'px';\n          this.geo.popup.style.width =\n            18 * this.geo.scene.annotationInstance.customization.themeCurrent.nPoint.scale + 'px';\n          this.geo.popup.style.top =\n            this.geo.vec.y -\n            32 * this.geo.scene.annotationInstance.customization.themeCurrent.nPoint.scale +\n            'px';\n          this.geo.popup.style.left =\n            this.geo.vec.x -\n            10 * this.geo.scene.annotationInstance.customization.themeCurrent.nPoint.scale +\n            1 +\n            'px';\n        }\n        break;\n      case PointRenderType.Image:\n        this.geo.popup.style.top = this.geo.vec.y + 'px';\n        this.geo.popup.style.left =\n          this.geo.vec.x + this.geo.styleComponent.img.width * 0.5 + 1 + 'px';\n        break;\n      default:\n        break;\n    }\n    if (this.showPopupStackTimer) {\n      clearTimeout(this.showPopupStackTimer);\n    }\n    this.showPopupStackTimer = setTimeout(() => {\n      if (this.geo.popup) {\n        this.geo.scene.annotationInstance.io.eventListenerAnnotation.showPopupStack(\n          this.geo.toJSON()\n        );\n      }\n    }, 100);\n  }\n  public updatePopup() {\n    if (this.geo.hasPopup && this.geo.popup !== undefined) {\n      switch (this.geo.renderer.pointRenderType) {\n        case PointRenderType.RpointA:\n          if (this.geo.hasGhostPopup) {\n            this.geo.popup.style.top =\n              this.geo.vec.y -\n              this.geo.scene.annotationInstance.customization.themeCurrent.nPoint.height -\n              this.geo.ghostPopupOffset +\n              'px';\n            this.geo.popup.style.left = this.geo.vec.x + 'px';\n          } else {\n            if (this.geo.scene.annotationInstance.customization.themeCurrent.nPoint.scale === 1) {\n              this.geo.popup.style.top = this.geo.vec.y - 32 + 'px';\n              this.geo.popup.style.left = this.geo.vec.x - 10 + 'px';\n            } else {\n              this.geo.popup.style.top =\n                this.geo.vec.y -\n                32 * this.geo.scene.annotationInstance.customization.themeCurrent.nPoint.scale +\n                'px';\n              this.geo.popup.style.left =\n                this.geo.vec.x -\n                10 * this.geo.scene.annotationInstance.customization.themeCurrent.nPoint.scale +\n                1 +\n                'px';\n            }\n          }\n          break;\n        case PointRenderType.Image:\n          this.geo.popup.style.top = this.geo.vec.y + 'px';\n          this.geo.popup.style.left =\n            this.geo.vec.x + this.geo.styleComponent.img.width * 0.5 + 1 + 'px';\n          break;\n        default:\n          break;\n      }\n    }\n  }\n}\n","import { RendererComponent as _RendererComponent } from '../../../../Common/Base/ComponentTemplate/RendererComponent';\nimport { APointRegularWrapper } from '..';\nexport class RendererComponent extends _RendererComponent {\n  public host: APointRegularWrapper;\n  constructor(host: APointRegularWrapper) {\n    super(host);\n    this.host = host;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.host.inspector.update(ctx);\n    this.interpolateColor.update();\n\n    this.host.scaleForRender = 1;\n\n    if (this.host.isCollapse) {\n      return;\n    }\n    if (this.host.scaleForRender < 0.01) {\n      return;\n    }\n    // console.log(this.host.vec.x);\n\n    // const pos = this.host.scene.imageAnnoApp.geometryCommon.gcmdSupporting.ToScreenWrapVec(this.host.vec.proX, this.host.vec.proY);\n    // console.log(pos[0]);\n    // this.host.vec.x = pos[0];\n    // this.host.vec.y = pos[1];\n    // this.host.UpdateScreenVecForPan();\n    const drawingPresetPoint = this.host.scene.annotationInstance.renderer.draw.shape.point;\n\n    // if (this.host.scene.imageAnnoApp.activeCommandController.pressESC && this.host.isDrag) { this.host.isDrag = false; this.host.vec = NVector3.DeepCopy(this.host.vecsHistory[this.host.vecsHistory.length - 1]); }\n    if (this.host.isDrag) {\n      // drawingPresetPoint.PointRegularDragByImg(ctx,this.host.styleComponent.renderStyle, this.host.vec.x, this.host.vec.y, NumericalMotion.easeOutElastic2(this.tUp), true, true, this.host.isGrayColor, this.host.visibility, this.host.isPin);\n      drawingPresetPoint.pointRegularDragBySVGPath(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        this.host.vec.x,\n        this.host.vec.y,\n        this.host.scaleForRender * this.host.scene.annotationInstance.activeCommandController.scaleGlobal,\n        this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tUp),\n        true,\n        true,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.host.isPinValue,\n        this.host.isHoverValue,\n        this.host.isSelectedValue\n      ); // normal status\n      this.tUp += 0.015; // this.host.scene.imageAnnoApp.renderer.dt * 0.5;\n      this.tDown2 = 0.0;\n    } else {\n      if (this.host.isSelectedValue) {\n        drawingPresetPoint.shadowRPoint(\n          ctx,\n          this.host.styleComponent.renderStyle,\n          this.host.vec.x,\n          this.host.vec.y,\n          this.host.isSelected,\n          this.host.isHover\n        );\n        // drawingPresetPoint.PointRegularOverBoundingByImg(ctx,this.host.styleComponent.renderStyle, this.host.vec.x, this.host.vec.y, NumericalMotion.easeOutElastic2(this.tOver), true, true, this.host.isGrayColor, this.host.visibility, this.host.isPin);\n        drawingPresetPoint.pointRegularOverBoundingBySVGPathSelected(\n          ctx,\n          this.host.styleComponent.renderStyle,\n          this.host.vec.x,\n          this.host.vec.y,\n          this.host.scaleForRender * this.host.scene.annotationInstance.activeCommandController.scaleGlobal,\n          this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n          true,\n          true,\n          this.host.isGrayColor,\n          this.host.visibilityValue,\n          this.host.isPinValue\n        );\n        this.tOver += 0.015; // this.host.scene.imageAnnoApp.renderer.dt;\n        this.tDown1 = 0;\n        if (this.host.isHoverValue) {\n          this.tOverPopupSummary += this.host.scene.annotationInstance.renderer.dt;\n        } else {\n          this.tOverPopupSummary = 0;\n        }\n        this.host.isLeave = true;\n      } else if (this.host.isHoverValue) {\n        drawingPresetPoint.shadowRPointLight(\n          ctx,\n          this.host.styleComponent.renderStyle,\n          this.host.vec.x,\n          this.host.vec.y,\n          this.host.scaleForRender * this.host.scene.annotationInstance.activeCommandController.scaleGlobal,\n          this.host.isSelected,\n          this.host.isHover\n        );\n\n        // drawingPresetPoint.PointRegularOverBoundingByImg(ctx,this.host.styleComponent.renderStyle, this.host.vec.x, this.host.vec.y, NumericalMotion.easeOutElastic2(this.tOver), true, true, this.host.isGrayColor, this.host.visibility, this.host.isPin);\n        drawingPresetPoint.pointRegularOverBoundingBySVGPath(\n          ctx,\n          this.host.styleComponent.renderStyle,\n          this.host.vec.x,\n          this.host.vec.y,\n          this.host.scaleForRender * this.host.scene.annotationInstance.activeCommandController.scaleGlobal,\n          this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver),\n          true,\n          true,\n          this.host.isGrayColor,\n          this.host.visibilityValue,\n          this.host.isPinValue\n        );\n        this.tOver += 0.015; // this.host.scene.imageAnnoApp.renderer.dt * 0.5; // circle bouncing\n        this.tOverPopupSummary += this.host.scene.annotationInstance.renderer.dt;\n        this.tDown1 = 0.0;\n        this.host.isLeave = true;\n      } else {\n        if (this.host.isLeave && !this.host.isDrag) {\n          // drawingPresetPoint.PointRegularOverBoundingByImg(ctx,this.host.styleComponent.renderStyle, this.host.vec.x, this.host.vec.y, NumericalMotion.easeOutElastic2(this.tDown1), false, true, this.host.isGrayColor, this.host.visibility, this.host.isPin);\n          drawingPresetPoint.pointRegularOverBoundingBySVGPath(\n            ctx,\n            this.host.styleComponent.renderStyle,\n            this.host.vec.x,\n            this.host.vec.y,\n            this.host.scaleForRender * this.host.scene.annotationInstance.activeCommandController.scaleGlobal,\n            this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown1),\n            false,\n            true,\n            this.host.isGrayColor,\n            this.host.visibilityValue,\n            this.host.isPinValue\n          );\n          this.tDown1 += this.host.scene.annotationInstance.renderer.dt;\n          this.tOver = this.tOverPopupSummary = 0.0;\n\n          if (this.tDown1 > 0.15) {\n            this.host.isLeave = false;\n          }\n        } else if (!this.host.isDrag) {\n          // drawingPresetPoint.PointRegularOverBoundingByImg(ctx,this.host.styleComponent.renderStyle, this.host.vec.x, this.host.vec.y, NumericalMotion.easeOutElastic2(this.tDown1), false, false, this.host.isGrayColor, this.host.visibility, this.host.isPin);\n          drawingPresetPoint.pointRegularOverBoundingBySVGPath(\n            ctx,\n            this.host.styleComponent.renderStyle,\n            this.host.vec.x,\n            this.host.vec.y,\n            this.host.scaleForRender * this.host.scene.annotationInstance.activeCommandController.scaleGlobal,\n            this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown1),\n            false,\n            false,\n            this.host.isGrayColor,\n            this.host.visibilityValue,\n            this.host.isPinValue\n          );\n          this.tDown1 += this.host.scene.annotationInstance.renderer.dt;\n          this.tOver = this.tOverPopupSummary = 0.0;\n        }\n      }\n      // drawingPresetPoint.PointRegularDragByImg(ctx,this.host.styleComponent.renderStyle, this.host.vec.x, this.host.vec.y, NumericalMotion.easeOutElastic2(this.tDown2), false, false, this.host.isGrayColor, this.host.visibility, this.host.isPin); // normal status\n      drawingPresetPoint.pointRegularDragBySVGPath(\n        ctx,\n        this.host.styleComponent.renderStyle,\n        this.host.vec.x,\n        this.host.vec.y,\n        this.host.scaleForRender * this.host.scene.annotationInstance.activeCommandController.scaleGlobal,\n        this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown2),\n        false,\n        false,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.host.isPinValue,\n        this.host.isHoverValue,\n        this.host.isSelectedValue\n      ); // normal status\n      this.tUp = 0.0;\n      this.tDown2 += this.host.scene.annotationInstance.renderer.dt * 0.5;\n      // if (this.tDown2 > 0.15) { this.host.isDrop = false; }\n    }\n    // console.log(this.tDown1, this.tDown2);\n    // console.log(this.host.isDrag);\n\n    if (this.host.hasPopup && this.host.isMove) {\n      this.host.updateDivPos();\n    }\n    this.t += this.host.scene.annotationInstance.renderer.dt;\n\n    // console.log(this.host.hashColor);\n\n    // drawingPresetPoint\n    // drawingPresetPoint.PointRegularDragOffscreen(this.host.hashColor, this.host.vec.x, this.host.vec.y, NumericalMotion.easeOutElastic2(this.tUp), true, true, this.host.isGrayColor, this.host.visibility, this.host.isPin);\n    // console.log(this.host.vec.x, this.host.vec.y);\n    // console.log(this.host.scene.imageAnnoApp.implementation.app.model.isViewChanging);\n\n    // ........... render offscreen\n    // this.host.scene.imageAnnoApp.renderer.offscreen.RPointOffscreen(ctx, this.host.hashColor, this.host.vec);\n    this.offScreenRender();\n  }\n  protected offScreenRender() {\n    // console.log(this.host.hashColor);\n    // this.host.scene.imageAnnoApp.renderer.preset.drawingPresetOffscreen.RPointOffscreen(this.host.scene.imageAnnoApp.renderer.ctxOffscreen, this.host.hashColor, this.host.vec);\n    this.host.scene.annotationInstance.renderer.offscreen.rPointOffscreen(\n      this.host.scene.annotationInstance.renderer.ctxOffscreen,\n      this.host.hashColor,\n      this.host.vec,\n      this.host.scaleForRender\n    );\n  }\n}\n","import { PointRenderType } from '../../../../../../../lib';\nimport { APointRegularWrapper } from '..';\nimport { RendererComponent as _RendererComponent } from './RendererComponent';\nexport class RendererComponentGeneric extends _RendererComponent {\n  public host: APointRegularWrapper;\n  public pointRenderType: PointRenderType;\n\n  constructor(host: APointRegularWrapper) {\n    super(host);\n    this.host = host;\n    this.pointRenderType = PointRenderType.RpointA;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    this.host.inspector.update(ctx);\n    this.interpolateColor.update();\n\n    if (this.host.isCollapse) {\n      return;\n    }\n    if (this.host.scaleForRender < 0.01) {\n      return;\n    }\n\n    // visualization for debugging, detection area for touch events\n    // ctx.strokeStyle = 'rgba(0,255, 0, 0.7)';\n    // ctx.beginPath();\n    // ctx.arc(this.geo.vec.x, this.geo.vec.y - (this.host.collision.maxVec.y - this.host.collision.minVec.y) * 0.5, 15, 0.0, 3.14 * 2);\n    // ctx.stroke();\n    // ctx.beginPath();\n    // ctx.rect(this.host.collision.minVec.x, this.host.collision.minVec.y,\n    //           this.host.collision.maxVec.x - this.host.collision.minVec.x,\n    //           this.host.collision.maxVec.y - this.host.collision.minVec.y);\n    // ctx.stroke();\n\n    if (this.host.hasPopup && this.host.isMove) {\n      this.host.updateDivPos();\n    }\n    switch (this.pointRenderType) {\n      case PointRenderType.RpointA:\n        this.renderPointA(ctx);\n        break;\n      case PointRenderType.Image:\n        this.renderPointIcon(ctx);\n        break;\n      default:\n        break;\n    }\n\n    // debug for the original vec\n    // ctx.fillStyle = '#0ff000';\n    // ctx.beginPath();\n    // ctx.arc(this.host.vec.x, this.host.vec.y, 3, 0, 3.14 * 2);\n    // ctx.closePath();\n    // ctx.fill();\n\n    this.t += this.host.scene.annotationInstance.renderer.dt;\n    this.offScreenRender();\n  }\n\n  private renderPointA(ctx: CanvasRenderingContext2D) {\n    const drawingPresetPointGeneric = this.host.scene.annotationInstance.renderer.draw.shape.pointGeneric;\n    const drawingPresetPoint = this.host.scene.annotationInstance.renderer.draw.shape.point;\n\n    const vecRendering = this.host.scene.annotationInstance.geometryCommon.gcmdSupporting.toScreenVecOnCropping(this.host.vec);\n\n    const scaleForRender = this.host.styleComponent.renderStyle.scaleGlobal * this.host.styleComponent.renderStyle.scaleLocal;\n\n    this.geo.collision.updateByScale(scaleForRender);\n\n    if (this.host.isDrag) {\n      // drawingPresetPoint.PointRegularDragByImg(ctx,this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, NumericalMotion.easeOutElastic2(this.tUp), true, true, this.host.isGrayColor, this.host.visibility, this.host.isPin);\n      drawingPresetPoint.shadowRPoint( ctx, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, this.host.isSelected, this.host.isHover);\n      drawingPresetPointGeneric.pointGenericOverBoundingSelected(ctx, this.pointRenderType, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, scaleForRender, this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver), true, true, this.host.isGrayColor, this.host.visibilityValue, this.host.isPinValue);\n      drawingPresetPointGeneric.pointGenericDrag(ctx, this.pointRenderType, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, scaleForRender, this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tUp), true, true, this.host.isGrayColor, this.host.visibilityValue, this.host.isPinValue, this.host.isHoverValue, this.host.isSelectedValue); // normal status\n      this.tUp += 0.015; // this.host.scene.imageAnnoApp.renderer.dt * 0.5;\n      this.tDown2 = 0.0;\n    } else {\n      if (this.host.isSelectedValue) {\n        drawingPresetPoint.shadowRPoint( ctx, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, this.host.isSelected, this.host.isHover);\n        // drawingPresetPoint.PointRegularOverBoundingByImg(ctx,this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, NumericalMotion.easeOutElastic2(this.tOver), true, true, this.host.isGrayColor, this.host.visibility, this.host.isPin);\n        drawingPresetPointGeneric.pointGenericOverBoundingSelected(ctx, this.pointRenderType, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, scaleForRender, this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver), true, true, this.host.isGrayColor, this.host.visibilityValue, this.host.isPinValue);\n        this.tOver += 0.015; // this.host.scene.imageAnnoApp.renderer.dt;\n        this.tDown1 = 0;\n        if (this.host.isHoverValue) {\n          this.tOverPopupSummary += this.host.scene.annotationInstance.renderer.dt;\n        } else {\n          this.tOverPopupSummary = 0;\n        }\n        this.host.isLeave = true;\n      } else if (this.host.isHoverValue) {\n        drawingPresetPoint.shadowRPointLight(ctx, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, scaleForRender, this.host.isSelected, this.host.isHover);\n\n        drawingPresetPointGeneric.pointGenericOverBounding(ctx, this.pointRenderType, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, scaleForRender, this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tOver), true, true, this.host.isGrayColor, this.host.visibilityValue, this.host.isPinValue);\n\n        this.tOver += 0.015; // this.host.scene.imageAnnoApp.renderer.dt * 0.5; // circle bouncing\n        this.tOverPopupSummary += this.host.scene.annotationInstance.renderer.dt;\n        this.tDown1 = 0.0;\n        this.host.isLeave = true;\n      } else {\n        if (this.host.isLeave && !this.host.isDrag) {\n          drawingPresetPointGeneric.pointGenericOverBounding(ctx, this.pointRenderType, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, scaleForRender, this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown1), false, true, this.host.isGrayColor, this.host.visibilityValue, this.host.isPinValue);\n\n          this.tDown1 += this.host.scene.annotationInstance.renderer.dt;\n          this.tOver = this.tOverPopupSummary = 0.0;\n\n          if (this.tDown1 > 0.15) {\n            this.host.isLeave = false;\n          }\n        } else if (!this.host.isDrag) {\n          drawingPresetPointGeneric.pointGenericOverBounding(ctx, this.pointRenderType, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, scaleForRender, this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown1), false, false, this.host.isGrayColor, this.host.visibilityValue, this.host.isPinValue);\n\n          this.tDown1 += this.host.scene.annotationInstance.renderer.dt;\n          this.tOver = this.tOverPopupSummary = 0.0;\n        }\n      }\n      // drawingPresetPointGeneric.PointRegularDragByImg(ctx,this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, NumericalMotion.easeOutElastic2(this.tDown2), false, false, this.host.isGrayColor, this.host.visibility, this.host.isPin); // normal status\n      drawingPresetPointGeneric.pointGenericDrag(\n        ctx, this.pointRenderType, this.host.styleComponent.renderStyle, vecRendering.x, vecRendering.y, scaleForRender, this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown2), false, false, this.host.isGrayColor, this.host.visibilityValue, this.host.isPinValue, this.host.isHoverValue, this.host.isSelectedValue\n      ); // normal status\n      this.tUp = 0.0;\n      this.tDown2 += this.host.scene.annotationInstance.renderer.dt * 0.5;\n      // if (this.tDown2 > 0.15) { this.host.isDrop = false; }\n    }\n  }\n  private renderPointIcon(ctx: CanvasRenderingContext2D) {\n    const drawingPresetPointGeneric = this.host.scene.annotationInstance.renderer.draw.shape.pointGeneric;\n    const drawingPresetPoint = this.host.scene.annotationInstance.renderer.draw.shape.point;\n\n    const width = this.host.styleComponent.img.width * this.host.scene.annotationInstance.customization.themeCurrent.rPoint.scale;\n    const height = this.host.styleComponent.img.height * this.host.scene.annotationInstance.customization.themeCurrent.rPoint.scale;\n\n    this.renderImg( ctx, this.host.styleComponent.img, this.host.vec.x - width * 0.5, this.host.vec.y - height, width, height, this.host.isHover, this.host.isSelectedValue);\n\n    if (this.host.isDrag) {\n      drawingPresetPointGeneric.pointGenericDrag(\n        ctx,\n        this.pointRenderType,\n        this.host.styleComponent.renderStyle,\n        this.host.vec.x,\n        this.host.vec.y,\n        this.host.scaleForRender,\n        this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tUp),\n        true,\n        true,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.host.isPinValue,\n        this.host.isHoverValue,\n        this.host.isSelectedValue\n      ); // normal status\n      this.tUp += 0.015; // this.host.scene.imageAnnoApp.renderer.dt * 0.5;\n      this.tDown2 = 0.0;\n    } else {\n      if (this.host.isSelectedValue) {\n        drawingPresetPoint.shadowRPoint(\n          ctx,\n          this.host.styleComponent.renderStyle,\n          this.host.vec.x,\n          this.host.vec.y,\n          this.host.isSelected,\n          this.host.isHover\n        );\n        // drawingPresetPointGeneric.PointGenericOverBoundingSelected( ctx, this.pointRenderType, this.host.styleComponent.renderStyle, this.host.vec.x, this.host.vec.y, this.host.scaleForRender, this.geo.scene.imageAnnoApp.renderer.numericalMotion.easeOutElastic2(this.tOver), true, true, this.host.isGrayColor, this.host.visibility, this.host.isPin);\n        this.tOver += 0.015; // this.host.scene.imageAnnoApp.renderer.dt;\n        this.tDown1 = 0;\n        if (this.host.isHoverValue) {\n          this.tOverPopupSummary += this.host.scene.annotationInstance.renderer.dt;\n        } else {\n          this.tOverPopupSummary = 0;\n        }\n        this.host.isLeave = true;\n      } else if (this.host.isHoverValue) {\n        drawingPresetPoint.shadowRPointLight(\n          ctx,\n          this.host.styleComponent.renderStyle,\n          this.host.vec.x,\n          this.host.vec.y,\n          this.host.scaleForRender,\n          this.host.isSelected,\n          this.host.isHover\n        );\n        // drawingPresetPointGeneric.PointGenericOverBounding(ctx, this.pointRenderType, this.host.styleComponent.renderStyle, this.host.vec.x, this.host.vec.y, this.host.scaleForRender, this.geo.scene.imageAnnoApp.renderer.numericalMotion.easeOutElastic2(this.tOver), true, true, this.host.isGrayColor, this.host.visibility, this.host.isPin);\n\n        this.tOver += 0.015; // this.host.scene.imageAnnoApp.renderer.dt * 0.5; // circle bouncing\n        this.tOverPopupSummary += this.host.scene.annotationInstance.renderer.dt;\n        this.tDown1 = 0.0;\n        this.host.isLeave = true;\n      } else {\n        if (this.host.isLeave && !this.host.isDrag) {\n          // drawingPresetPointGeneric.PointGenericOverBounding(ctx, this.pointRenderType, this.host.styleComponent.renderStyle, this.host.vec.x, this.host.vec.y, this.host.scaleForRender, this.geo.scene.imageAnnoApp.renderer.numericalMotion.easeOutElastic2(this.tDown1), false, true, this.host.isGrayColor, this.host.visibility, this.host.isPin);\n\n          this.tDown1 += this.host.scene.annotationInstance.renderer.dt;\n          this.tOver = this.tOverPopupSummary = 0.0;\n\n          if (this.tDown1 > 0.15) {\n            this.host.isLeave = false;\n          }\n        } else if (!this.host.isDrag) {\n          // drawingPresetPointGeneric.PointGenericOverBounding(ctx, this.pointRenderType, this.host.styleComponent.renderStyle, this.host.vec.x, this.host.vec.y, this.host.scaleForRender, this.geo.scene.imageAnnoApp.renderer.numericalMotion.easeOutElastic2(this.tDown1), false, false, this.host.isGrayColor, this.host.visibility, this.host.isPin);\n\n          this.tDown1 += this.host.scene.annotationInstance.renderer.dt;\n          this.tOver = this.tOverPopupSummary = 0.0;\n        }\n      }\n      drawingPresetPointGeneric.pointGenericDrag(\n        ctx,\n        this.pointRenderType,\n        this.host.styleComponent.renderStyle,\n        this.host.vec.x,\n        this.host.vec.y,\n        this.host.scaleForRender,\n        this.geo.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(this.tDown2),\n        false,\n        false,\n        this.host.isGrayColor,\n        this.host.visibilityValue,\n        this.host.isPinValue,\n        this.host.isHoverValue,\n        this.host.isSelectedValue\n      ); // normal status\n      this.tUp = 0.0;\n      this.tDown2 += this.host.scene.annotationInstance.renderer.dt * 0.5;\n      // if (this.tDown2 > 0.15) { this.host.isDrop = false; }\n    }\n  }\n  private renderImg(\n    ctx: CanvasRenderingContext2D,\n    img: HTMLImageElement,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    isHover: boolean,\n    isSelected: boolean\n  ) {\n    if (!isHover && !isSelected) {\n      ctx.globalAlpha = this.interpolateColor.opacity;\n    }\n    ctx.drawImage(img, x, y, width, height);\n    ctx.globalAlpha = 1;\n  }\n\n  protected offScreenRender() {\n    switch (this.pointRenderType) {\n      case PointRenderType.RpointA:\n        this.host.scene.annotationInstance.renderer.offscreen.rPointOffscreen(\n          this.host.scene.annotationInstance.renderer.ctxOffscreen,\n          this.host.hashColor,\n          this.host.vec,\n          this.host.scaleForRender\n        );\n        break;\n      case PointRenderType.Image:\n        // const width = this.host.styleComponent.img.width;\n        // const height = this.host.styleComponent.img.height;\n        this.host.scene.annotationInstance.renderer.ctxOffscreen.fillStyle = this.host.hashColor;\n        this.host.scene.annotationInstance.renderer.ctxOffscreen.beginPath();\n\n        this.host.scene.annotationInstance.renderer.ctxOffscreen.rect(\n          this.host.collision.minVec.x,\n          this.host.collision.minVec.y,\n          this.host.collision.maxVec.x - this.host.collision.minVec.x,\n          this.host.collision.maxVec.y - this.host.collision.minVec.y\n        );\n\n        // this.host.scene.imageAnnoApp.renderer.ctxOffscreen.rect(this.geo.vec.x - width * 0.5, this.geo.vec.y, width, -height);\n        this.host.scene.annotationInstance.renderer.ctxOffscreen.closePath();\n        this.host.scene.annotationInstance.renderer.ctxOffscreen.fill();\n        break;\n      default:\n        break;\n    }\n  }\n}\n","import { PointRenderType, Size } from '../../../../../../../lib';\nimport { ThemeColorId } from '../../../../../Customization/ThemeRenderStyle/Utility';\nimport { StyleComponent as _StyleComponent } from '../../../../Common/Base/ComponentTemplate/StyleComponent';\nimport { RenderStyle } from '../../../Helper/RenderStyle';\nimport { APointRegularWrapper } from '..';\nexport class StyleComponent extends _StyleComponent {\n  public geo: APointRegularWrapper;\n  public url: string;\n  public img = new Image();\n  private symbol: string;\n  private defaultURL: string;\n  constructor(geo: APointRegularWrapper) {\n    super(geo);\n    this.defaultURL = `${this.geo.scene.annotationInstance.implementations.app.CONFIG.config.BASE_URL}/static/storymaps-xgraphics/images/theme-assets/common/unnumbered-pin.svg`;\n    this.updateStyle();\n    this.updateColor();\n  }\n  public updateStyle() {\n    if (!this.isCustom) {\n      this.state.themeColorId = ThemeColorId.AccentColor1;\n      this.isCustom = true;\n      this.url = this.geo.scene.annotationInstance.customization.themeCurrent.rPoint.URL;\n      RenderStyle.updateRenderStyleRPoint(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent\n      );\n    }\n  }\n  public updateColor(color: number[] | undefined = undefined) {\n    this.isCustom = true;\n    if (color === undefined) {\n      color = this.geo.scene.annotationInstance.activeCommandController.activeColorController.activeColor;\n    }\n    RenderStyle.updateRenderColorRPointCustom(\n      this.renderStyle,\n      this.geo.scene.annotationInstance.customization.themeCurrent,\n      color\n    );\n    this.tempColorRgba = color;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public updateStyleCustom(style: any): boolean {\n    // console.log('updateStyleCustom', style);\n    // if (this.isSameStyle(style)) {\n    //   return false;\n    // }\n    let needEmit = false;\n    if (style.size) {\n      this.geo.size = style.size.toUpperCase() as Size;\n      this.renderStyle.size = this.geo.size;\n      needEmit = true;\n    }\n    if (style.url && this.url !== style.url) {\n      this.url = style.url;\n      this.img = new Image();\n      this.img.src = this.url;\n      this.img.onload = () => {\n        if (style.size) {\n          this.geo.size = style.size.toUpperCase() as Size;\n          this.renderStyle.size = this.geo.size;\n        } else {\n          this.geo.size = Size.MEDIUM;\n        }\n        if (style.url !== this.defaultURL) {\n          this.geo.renderer.pointRenderType = PointRenderType.Image;\n        } else {\n          this.geo.renderer.pointRenderType = PointRenderType.RpointA;\n        }\n        needEmit = true;\n      };\n    }\n    if (style.width) {\n      this.state.width = style.width;\n    }\n    if (style.color !== undefined) {\n      this.state.themeColorId = style.color as ThemeColorId;\n    }\n    if (style.colorRgba.length > 0) {\n      this.tempColorRgba = style.colorRgba;\n      RenderStyle.updateRenderColorRPointCustom(\n        this.renderStyle,\n        this.geo.scene.annotationInstance.customization.themeCurrent,\n        style.colorRgba\n      );\n      this.updateColor(style.colorRgba)\n    }\n    // ................... update local scale\n    if (style.scale) {\n      this.renderStyle.scaleLocal = style.scale;\n      this.state.scale = style.scale;\n    }\n    if (typeof style.symbol === 'string') {\n      this.symbol = style.symbol;\n    }\n    this.isCustom = true;\n    if (needEmit && !this.geo.isUnderConstruction) {\n      this.geo.isTransform = true;\n      // this.geoHost.scene.imageAnnoApp.io.eventListenerAnnotation.TransformStack([this.geoHost.ToJSON()]);\n    }\n    // console.log(this);\n    return true;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public toJson(): any | undefined {\n    if (!this.isCustom) {\n      return undefined;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const output: any = {\n      width: this.state.width,\n      scale: this.renderStyle.scaleLocal,\n      colorRgba: this.tempColorRgba, // this is necessary for updating state on React side\n      url: this.url,\n    };\n    if (this.renderStyle.size !== Size.MEDIUM) {\n      output.size = this.renderStyle.size.toLowerCase();\n    }\n    // if (this.url)\n    if (this.url !== this.defaultURL) {\n      output.symbolType = 'image';\n    }\n    if (this.symbol) {\n      output.symbol = this.symbol;\n    }\n    if (this.state.themeColorId !== ThemeColorId.AccentColor1) {\n      output.color = this.state.themeColorId;\n    }\n    return output;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  protected isSameStyle(style: any) {\n    // First look at size, which is only included with style when its been selected\n    if (style.size && style.size !== this.renderStyle.size.toLowerCase()) {\n      return false;\n    }\n    if (style.colorRgba.length === this.tempColorRgba.length) {\n      for (let i = 0; i < style.colorRgba.length; i++) {\n        if (style.colorRgba[i] !== this.tempColorRgba[i]) {\n          return false;\n        }\n      }\n    }\n    if (this.url !== style.url) {\n      return false;\n    }\n    return true;\n    // RenderStyle.updateRenderStyleRPoint(this.renderStyle, this.geo.scene.imageAnnoApp.customization.themeCurrent);\n  }\n}\n","import { NVector3, MouseEventData } from '../../../../../../../lib';\nimport { AGeometryBase } from '../../../../Common/Base/AGeometryBase';\nimport { TransformationComponent as _TransformationComponent } from '../../../../Common/Base/ComponentTemplate/TransformationComponent';\nexport class TransformationComponent extends _TransformationComponent {\n  public geo: AGeometryBase;\n  public v: NVector3;\n  constructor(geo: AGeometryBase) {\n    super(geo);\n    this.geo = geo;\n  }\n  public translateByMouseEventData(e: MouseEventData): void {\n    this.geo.isDrag = true;\n\n    // This lines of code below enable us restrict the movement of the geometry in horizontal and vertical way with `Shift` key.\n    // if (this.geo.scene.annotationInstance.activeCommandController.acProperties.pressShift) {\n    //   const pv = this.geo.vec; // this.geo.vecsHistory[this.geo.vecsHistory.length - 1];\n    //   const deg = getAngleByTwoVectorsRadian(\n    //     new NVector3(e.x - pv.x, e.y - pv.y).normalize(),\n    //     new NVector3(1, 0, 0)\n    //   );\n\n    //   if ((0 < deg && deg < 0.8) || (2.45 < deg && deg < 3.15)) {\n    //     this.geo.vec.x += e.x - e.preX;\n    //     this.geo.vec.y = pv.y;\n    //   } else {\n    //     this.geo.vec.x = pv.x;\n    //     this.geo.vec.y += e.y - e.preY;\n    //   }\n    // } else {\n      this.geo.vec.x += e.x - e.preX;\n      this.geo.vec.y += e.y - e.preY;\n    // }\n    this.geo.updatePostTransformation();\n  }\n  public translate(x: number, y: number): void {\n    //\n  }\n}\n","import { FHType, GType, MLModelType } from '../../../../lib';\nimport { KeyboardEventData } from '../../../../../../lib/EventData/KeyboardEventData';\nimport { MouseEventData } from '../../../../../../lib/EventData/MouseEventData';\nimport { ACircle } from '../../Geometry/GeometryAnnotation/FamilyArea/ACircle/ACircle';\nimport { ACircleWrapper } from '../../Geometry/GeometryAnnotation/FamilyArea/ACircleWrapper/ACircleWrapper';\nimport { ANGonWrapper } from '../../Geometry/GeometryAnnotation/FamilyArea/ANGonWrapper';\nimport { APolygonGraphWrapper } from '../../Geometry/GeometryAnnotation/FamilyArea/APolygonGraphWrapper';\nimport { APolygonWrapper } from '../../Geometry/GeometryAnnotation/FamilyArea/APolygonWrapper/APolygonWrapper';\nimport { ARectangleWrapper } from '../../Geometry/GeometryAnnotation/FamilyArea/ARectangleWrapper/ARectangleWrapper';\nimport { ACurve } from '../../Geometry/GeometryAnnotation/FamilyCurve/ACurveWrapper/ACurve';\nimport { AFreehandSmartDrawing } from '../../Geometry/GeometryAnnotation/FamilyFreehand/AFreehandSmartDrawingWrapper/AFreehandSmartDrawing';\nimport { AFreehand } from '../../Geometry/GeometryAnnotation/FamilyFreehand/AFreehandWrapper/AFreehand';\nimport { AArrow } from '../../Geometry/GeometryAnnotation/FamilyLine/AArrowWrapper/AArrow';\nimport { APolylineGraphWrapper } from '../../Geometry/GeometryAnnotation/FamilyLine/APolylineGraphWrapper/APolylineGraphWrapper';\nimport { APolylineWrapper } from '../../Geometry/GeometryAnnotation/FamilyLine/APolylineWrapper/APolylineWrapper';\nimport { APointIconWrapper } from '../../Geometry/GeometryAnnotation/FamilyPoint/APointIconWrapper/APointIconWrapper';\nimport { APointNumberedWrapper } from '../../Geometry/GeometryAnnotation/FamilyPoint/APointNumberedWrapper';\nimport { APointRegularWrapper } from '../../Geometry/GeometryAnnotation/FamilyPoint/APointRegularWrapper';\nimport { APoint } from '../../Geometry/GeometryAnnotation/FamilyPoint/Base/APoint';\nimport { ATextleaderlineWrapper } from '../../Geometry/GeometryAnnotation/FamilyText/ATextleaderline';\nimport { ActiveCommandController } from '../ActiveCommandController';\nimport { ActiveCommandCommonWrapper } from './Base/ActiveCommandCommonWrapper';\nexport class CActiveCommandPoint extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    APoint.mouseLeftClick(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseMiddleClick(e: MouseEventData) {\n    APoint.mouseMiddleClick(e);\n  }\n  public mouseRightClick(e: MouseEventData) {\n    APoint.mouseRightClick(e);\n  }\n  // ..........................................\n  public mouseMove(e: MouseEventData) {\n    /* */\n    // e = this.acs.CommonEvent(e);\n  }\n  public mouseDrag(e: MouseEventData) {\n    /* */\n    // if (AGeometry.capture !== undefined)\n    // if (ac === ACTIVECOMMAND_MODE.NONE)\n    // else this.model.mouseInteraction.DisablelMapView();\n  }\n}\nexport class CActiveCommandANPointRegular extends CActiveCommandPoint {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    APointRegularWrapper.mouseLeftClick(this.acs.imageAnnoApp.scene, e);\n  }\n}\nexport class CActiveCommandANPointNumbered extends CActiveCommandPoint {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    APointNumberedWrapper.mouseLeftClick(this.acs.imageAnnoApp.scene, e);\n  }\n}\nexport class CActiveCommandIcon extends CActiveCommandPoint {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    APointIconWrapper.mouseLeftClick(this.acs.imageAnnoApp.scene, e);\n  }\n}\nexport class CActiveCommandArrow extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    AArrow.mouseDown(this.acs.imageAnnoApp.scene, e, GType.ARROW_SINGLE);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    AArrow.mouseLeftClick(this.acs.imageAnnoApp.scene, e, GType.ARROW_SINGLE);\n  }\n  public mouseMove(e: MouseEventData) {\n    AArrow.mouseMove(this.acs.imageAnnoApp.scene, e, GType.ARROW_SINGLE);\n  }\n  public mouseUp(e: MouseEventData) {\n    AArrow.mouseUp(e);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.key === 'Escape' || k.keyCode === 81 || k.keyCode === 13) {\n      AArrow.cancel();\n    }\n  }\n}\nexport class CActiveCommandArrowDouble extends CActiveCommandArrow {\n  //\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    AArrow.mouseDown(this.acs.imageAnnoApp.scene, e, GType.ARROW_DOUBLE);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    AArrow.mouseLeftClick(this.acs.imageAnnoApp.scene, e, GType.ARROW_DOUBLE);\n  }\n  public mouseMove(e: MouseEventData) {\n    if (AArrow.condition.v0 !== undefined) {\n      AArrow.drawShadow(this.acs.imageAnnoApp.scene, e, GType.ARROW_DOUBLE);\n    }\n  }\n}\nexport class CActiveCommandANCurve extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    ACurve.mouseDown(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    ACurve.mouseLeftClick(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseDoubleClick(e: MouseEventData) {\n    ACurve.mouseDoubleClick(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseMove(e: MouseEventData) {\n    ACurve.mouseMove(e);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      ACurve.cancel();\n    }\n    if (k.keyCode === 81 || k.keyCode === 13) {\n      ACurve.doneByKeyboard(this.acs.imageAnnoApp.scene);\n    }\n  }\n  public undo() {\n    ACurve.undo(this.acs.m);\n  }\n}\nexport class CActiveCommandANCurveClosed extends CActiveCommandANCurve {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    ACurve.mouseLeftClick(this.acs.imageAnnoApp.scene, e, true);\n  }\n  public mouseDoubleClick(e: MouseEventData) {\n    ACurve.mouseDoubleClick(this.acs.imageAnnoApp.scene, e, true);\n  }\n  public mouseDown(e: MouseEventData) {\n    ACurve.mouseDown(this.acs.imageAnnoApp.scene, e, true);\n  }\n  public mouseMove(e: MouseEventData) {\n    ACurve.mouseMove(e);\n  }\n}\nexport class CActiveCommandANFHPolyline extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    AFreehand.mouseDown(this.acs.imageAnnoApp.scene, e, FHType.Polyline);\n  }\n  public mouseDrag(e: MouseEventData) {\n    AFreehand.mouseDrag(this.acs.imageAnnoApp.scene, e, FHType.Polyline);\n  }\n  public mouseUp(e: MouseEventData) {\n    AFreehand.mouseUp(this.acs.imageAnnoApp.scene, e);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      AFreehand.cancel();\n    }\n  }\n  public mouseMove(e: MouseEventData) {\n    AFreehand.mouseMove(this.acs.imageAnnoApp.scene, e, FHType.Polyline);\n  }\n}\nexport class CActiveCommandANFHPolylineBending extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    AFreehand.mouseDown(this.acs.imageAnnoApp.scene, e, FHType.PolylineBending);\n  }\n  public mouseDrag(e: MouseEventData) {\n    AFreehand.mouseDrag(this.acs.imageAnnoApp.scene, e, FHType.PolylineBending);\n  }\n  public mouseUp(e: MouseEventData) {\n    AFreehand.mouseUp(this.acs.imageAnnoApp.scene, e);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      AFreehand.cancel();\n    }\n  }\n  public mouseMove(e: MouseEventData) {\n    AFreehand.mouseMove(this.acs.imageAnnoApp.scene, e, FHType.PolylineBending);\n  }\n  public cancel() {\n    AFreehand.cancel();\n  }\n}\nexport class CActiveCommandANFHPolygon extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    AFreehand.mouseDown(this.acs.imageAnnoApp.scene, e, FHType.Polygon);\n  }\n  public mouseDrag(e: MouseEventData) {\n    AFreehand.mouseDrag(this.acs.imageAnnoApp.scene, e, FHType.Polygon);\n  }\n  public mouseUp(e: MouseEventData) {\n    AFreehand.mouseUp(this.acs.imageAnnoApp.scene, e);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      AFreehand.cancel();\n    }\n  }\n  public mouseMove(e: MouseEventData) {\n    AFreehand.mouseMove(this.acs.imageAnnoApp.scene, e, FHType.Polygon);\n  }\n}\nexport class CActiveCommandANFHPolygonGraph extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    AFreehand.mouseDown(this.acs.imageAnnoApp.scene, e, FHType.PolygonGraph);\n  }\n  public mouseDrag(e: MouseEventData) {\n    AFreehand.mouseDrag(this.acs.imageAnnoApp.scene, e, FHType.PolygonGraph);\n  }\n  public mouseUp(e: MouseEventData) {\n    AFreehand.mouseUp(this.acs.imageAnnoApp.scene, e);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      AFreehand.cancel();\n    }\n  }\n  public mouseMove(e: MouseEventData) {\n    AFreehand.mouseMove(this.acs.imageAnnoApp.scene, e, FHType.PolygonGraph);\n  }\n  public cancel() {\n    AFreehand.cancel();\n  }\n}\nexport class CActiveCommandANFHCurve extends CActiveCommandANFHPolyline {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    AFreehand.mouseDown(this.acs.imageAnnoApp.scene, e, FHType.Curve);\n  }\n  public mouseMove(e: MouseEventData) {\n    AFreehand.mouseMove(this.acs.imageAnnoApp.scene, e, FHType.Curve);\n  }\n}\nexport class CActiveCommandANFHCurveClosed extends CActiveCommandANFHPolyline {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    AFreehand.mouseDown(this.acs.imageAnnoApp.scene, e, FHType.CurveClosed);\n  }\n  public mouseMove(e: MouseEventData) {\n    AFreehand.mouseMove(this.acs.imageAnnoApp.scene, e, FHType.CurveClosed);\n  }\n}\nexport class CActiveANCommandRect extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    ARectangleWrapper.mouseDown(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    const size = 128 * this.acs.scaleGlobal\n    ARectangleWrapper.onMouseLeftClick(this.acs.imageAnnoApp.scene, e, size, size);\n  }\n  public mouseMiddleClick(e: MouseEventData) {\n    /* */\n  }\n  public mouseRightClick(e: MouseEventData) {\n    ARectangleWrapper.onMouseRightClick(e);\n  }\n  public mouseMove(e: MouseEventData) {\n    ARectangleWrapper.onMouseMove(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseDrag(e: MouseEventData) {\n    ARectangleWrapper.onMouseDrag(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseUp(e: MouseEventData) {\n    ARectangleWrapper.onMouseUp(this.acs.imageAnnoApp.scene, e);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.key === 'Escape' || k.keyCode === 81 || k.keyCode === 13) {\n      ARectangleWrapper.cancel();\n    }\n  }\n  public cancel() {\n    ARectangleWrapper.cancel();\n  }\n}\nexport class CActiveANCommandCircle extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    ACircleWrapper.mouseDown(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    const size = 128 * this.acs.scaleGlobal\n    ACircleWrapper.onMouseLeftClick(this.acs.imageAnnoApp.scene, e, size, size);\n  }\n  public mouseMiddleClick(e: MouseEventData) {\n    /* */\n  }\n  public mouseRightClick(e: MouseEventData) {\n    ACircleWrapper.onMouseRightClick(e);\n  }\n  //   mouseDoubleClick(e) {}\n  //   // ..........................................\n  public mouseMove(e: MouseEventData) {\n    // ACircleWrapper.OnMouseMove(e);\n  }\n  public mouseDrag(e: MouseEventData) {\n    ACircleWrapper.onMouseDrag(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseUp(e: MouseEventData) {\n    ACircleWrapper.onMouseUp(this.acs.imageAnnoApp.scene, e);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      ACircleWrapper.cancel();\n    }\n  }\n  public cancel() {\n    ACircleWrapper.cancel();\n  }\n}\nexport class CActiveANCommandCircleConstraintArea extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    ACircle.getCircleByArea(this.acs.imageAnnoApp.scene, 500000, e.x, e.y);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    if (ACircle.construction) {\n      ACircle.construction.isSelected = false;\n      ACircle.construction = undefined;\n    }\n    this.acs.imageAnnoApp.activeCommandController.goToACMode();\n  }\n  public mouseMiddleClick(e: MouseEventData) {\n    /* */\n  }\n  public mouseRightClick(e: MouseEventData) {\n    ACircle.onMouseRightClick(e);\n  }\n  //   mouseDoubleClick(e) {}\n  //   // ..........................................\n  public mouseMove(e: MouseEventData) {\n    ACircle.onMouseMove(e);\n  }\n  public mouseDrag(e: MouseEventData) {\n    /* */\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      ACircle.cancel();\n    }\n  }\n}\nexport class CActiveANCommandCircleConstraintCircumference extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    ACircle.getCircleByCircumference(this.acs.imageAnnoApp.scene, 500, e.x, e.y);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    if (ACircle.construction) {\n      ACircle.construction.isSelected = false;\n      ACircle.construction = undefined;\n    }\n    this.acs.imageAnnoApp.activeCommandController.goToACMode();\n  }\n  public mouseMiddleClick(e: MouseEventData) {\n    /* */\n  }\n  public mouseRightClick(e: MouseEventData) {\n    ACircle.onMouseRightClick(e);\n  }\n  //   mouseDoubleClick(e) {}\n  //   // ..........................................\n  public mouseMove(e: MouseEventData) {\n    ACircle.onMouseMove(e);\n  }\n  public mouseDrag(e: MouseEventData) {\n    /* */\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      ACircle.cancel();\n    }\n  }\n}\nexport class CActiveANCommandPolyline extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    APolylineWrapper.mouseLeftClick(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseMove(e: MouseEventData) {\n    APolylineWrapper.mouseMove(e);\n  }\n  public mouseDoubleClick(e: MouseEventData) {\n    APolylineWrapper.mouseDoubleClick(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseDown(e: MouseEventData) {\n    APolylineWrapper.mouseDown(this.acs.imageAnnoApp.scene, e);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      APolylineWrapper.cancel(this.acs.imageAnnoApp.scene);\n    }\n    if (k.keyCode === 81 || k.keyCode === 13) {\n      APolylineWrapper.doneByKeyboard(this.acs.imageAnnoApp.scene);\n    }\n  }\n  public undo() {\n    APolylineWrapper.undo(this.acs.imageAnnoApp.scene, this.acs.m);\n  }\n}\nexport class CActiveANCommandBendingPolylineGraph extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    APolylineGraphWrapper.mouseLeftClick(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseMove(e: MouseEventData) {\n    APolylineGraphWrapper.mouseMove(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseDoubleClick(e: MouseEventData) {\n    APolylineGraphWrapper.mouseDoubleClick(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseDown(e: MouseEventData) {\n    APolylineGraphWrapper.mouseDown(this.acs.imageAnnoApp.scene, e);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      APolylineGraphWrapper.cancel(this.acs.imageAnnoApp.scene);\n    }\n    if (k.keyCode === 81 || k.keyCode === 13) {\n      APolylineGraphWrapper.doneByKeyboard(this.acs.imageAnnoApp.scene);\n    }\n  }\n  public undo() {\n    APolylineGraphWrapper.undo(this.acs.imageAnnoApp.scene, this.acs.m);\n  }\n}\nexport class CActiveANCommandPolylineConstraint extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    APolylineWrapper.mouseLeftClick(this.acs.imageAnnoApp.scene, e, true);\n  }\n  public mouseMove(e: MouseEventData) {\n    APolylineWrapper.mouseMove(e);\n  }\n  public mouseDoubleClick(e: MouseEventData) {\n    APolylineWrapper.mouseDoubleClick(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseDown(e: MouseEventData) {\n    APolylineWrapper.mouseDown(this.acs.imageAnnoApp.scene, e, true);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      APolylineWrapper.cancel(this.acs.imageAnnoApp.scene);\n    }\n    if (k.keyCode === 81 || k.keyCode === 13) {\n      APolylineWrapper.doneByKeyboard(this.acs.imageAnnoApp.scene);\n    }\n  }\n  public undo() {\n    APolylineWrapper.undo(this.acs.imageAnnoApp.scene, this.acs.m);\n  }\n}\nexport class CActiveANCommandPolygon extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    APolygonWrapper.mouseLeftClick(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseMove(e: MouseEventData) {\n    APolygonWrapper.mouseMove(e);\n  }\n  public mouseDoubleClick(e: MouseEventData) {\n    APolygonWrapper.mouseDoubleClick(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseDown(e: MouseEventData) {\n    APolygonWrapper.mouseDown(this.acs.imageAnnoApp.scene, e);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      APolygonWrapper.cancel(this.acs.imageAnnoApp.scene);\n    }\n    if (k.keyCode === 81 || k.keyCode === 13) {\n      APolygonWrapper.doneByKeyboard(this.acs.imageAnnoApp.scene);\n    }\n  }\n  public undo() {\n    APolygonWrapper.undo(this.acs.imageAnnoApp.scene, this.acs.m);\n  }\n}\nexport class CActiveANCommandPolygonGraph extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    APolygonGraphWrapper.mouseLeftClick(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseMove(e: MouseEventData) {\n    APolygonGraphWrapper.mouseMove(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseDoubleClick(e: MouseEventData) {\n    APolygonGraphWrapper.mouseDoubleClick(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseDown(e: MouseEventData) {\n    APolygonGraphWrapper.mouseDown(this.acs.imageAnnoApp.scene, e);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      APolygonGraphWrapper.cancel(this.acs.imageAnnoApp.scene);\n    }\n    if (k.keyCode === 81 || k.keyCode === 13) {\n      APolygonGraphWrapper.doneByKeyboard(this.acs.imageAnnoApp.scene);\n    }\n  }\n  public undo() {\n    APolygonGraphWrapper.undo(this.acs.imageAnnoApp.scene, this.acs.m);\n  }\n}\nexport class CActiveANCommandPolygonMultiple extends ActiveCommandCommonWrapper {\n  // constructor(acs: ActiveCommandController) { super(acs); }\n  // MouseLeftClick(e: MouseEventData) { APolygonMultple.MouseLeftClick(e); }\n  // MouseMove(e: MouseEventData) { APolygonMultple.MouseMove(e); }\n  // MouseDoubleClick(e: MouseEventData) { APolygonMultple.MouseDoubleClick(e); }\n  // MouseDown(e: MouseEventData) { APolygonMultple.MouseDown(e); }\n  // keydown(k: KeyboardEventData) { if (k.keyCode === 27) { APolygonMultple.Cancel(); } if (k.keyCode === 81 || k.keyCode === 13) { APolygonMultple.DoneByKeyboard(); } }\n  // // Undo() { APolygonMultple.Undo(this.acs.m); }\n}\nexport class CActiveANCommandPolygonConstraint extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    APolygonWrapper.mouseLeftClick(this.acs.imageAnnoApp.scene, e, true);\n  }\n  public mouseMove(e: MouseEventData) {\n    APolygonWrapper.mouseMove(e);\n  }\n  public mouseDoubleClick(e: MouseEventData) {\n    APolygonWrapper.mouseDoubleClick(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseDown(e: MouseEventData) {\n    APolygonWrapper.mouseDown(this.acs.imageAnnoApp.scene, e);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      APolygonWrapper.cancel(this.acs.imageAnnoApp.scene);\n    }\n    if (k.keyCode === 81 || k.keyCode === 13) {\n      APolygonWrapper.doneByKeyboard(this.acs.imageAnnoApp.scene);\n    }\n  }\n  public undo() {\n    APolygonWrapper.undo(this.acs.imageAnnoApp.scene, this.acs.m);\n  }\n}\n// export class CActiveCommandText extends ActiveCommandCommonWrapper {\n//   constructor(acs: ActiveCommandController) {\n//     super(acs);\n//   }\n//   public MouseLeftClick(e: MouseEventData) {\n//     AText.MouseLeftClick(this.acs.annotationInstance.scene, e);\n//   }\n//   public MouseMove(e: MouseEventData) {\n//     AText.MouseMove(e);\n//   }\n// }\nexport class CActiveCommandTextLederline extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseLeftClick(e: MouseEventData) {\n    this.acs.imageAnnoApp.activeCommandController.IsTextEditing = true;\n    ATextleaderlineWrapper.mouseLeftClick(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseMove(e: MouseEventData) {\n    ATextleaderlineWrapper.mouseMove(e);\n  }\n}\nexport class CActiveCommandANSmartDrawing extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    AFreehandSmartDrawing.mouseDown(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseDrag(e: MouseEventData) {\n    AFreehandSmartDrawing.mouseDrag(e);\n  }\n  public mouseUp(e: MouseEventData) {\n    AFreehandSmartDrawing.mouseUp(this.acs.imageAnnoApp.scene, e);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      AFreehandSmartDrawing.cancel();\n    }\n  }\n  public mouseMove(e: MouseEventData) {\n    AFreehandSmartDrawing.mouseMove(this.acs.imageAnnoApp.scene, e, FHType.Polyline);\n  }\n  // MouseMove(e: MouseEventData) { AFreehandSmartDrawing.MouseMove(e, FHType.PLINE, MLModelType.DEEP_LEARNING); }\n}\nexport class CActiveCommandANSmartDrawingDeepLearning extends CActiveCommandANSmartDrawing {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  public mouseDown(e: MouseEventData) {\n    AFreehandSmartDrawing.mouseDown(this.acs.imageAnnoApp.scene, e);\n  }\n  public mouseDrag(e: MouseEventData) {\n    AFreehandSmartDrawing.mouseDrag(e);\n  }\n  public mouseUp(e: MouseEventData) {\n    AFreehandSmartDrawing.mouseUp(this.acs.imageAnnoApp.scene, e);\n  }\n  public keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      AFreehandSmartDrawing.cancel();\n    }\n  }\n  public mouseMove(e: MouseEventData) {\n    AFreehandSmartDrawing.mouseMove(\n      this.acs.imageAnnoApp.scene,\n      e,\n      FHType.Polyline,\n      MLModelType.DeepLearning\n    );\n  }\n}\n// .............................................................. Lab\nexport class CActiveCommandNGon extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  mouseDown(e: MouseEventData) {\n    ANGonWrapper.mouseDown(this.acs.imageAnnoApp.scene, e, GType.CN_GON);\n  }\n  mouseLeftClick(e: MouseEventData) {\n    ANGonWrapper.mouseLeftClick(this.acs.imageAnnoApp.scene, e, GType.CN_GON);\n  }\n  mouseMove(e: MouseEventData) {\n    ANGonWrapper.mouseMove(e);\n  }\n  keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      ANGonWrapper.cancel();\n    }\n  }\n}\nexport class CActiveCommandStar extends ActiveCommandCommonWrapper {\n  constructor(acs: ActiveCommandController) {\n    super(acs);\n  }\n  mouseDown(e: MouseEventData) {\n    ANGonWrapper.mouseDown(this.acs.imageAnnoApp.scene, e, GType.CN_STAR);\n  }\n  mouseLeftClick(e: MouseEventData) {\n    ANGonWrapper.mouseLeftClick(this.acs.imageAnnoApp.scene, e, GType.CN_STAR);\n  }\n  mouseMove(e: MouseEventData) {\n    ANGonWrapper.mouseMove(e);\n  }\n  keydown(k: KeyboardEventData) {\n    if (k.keyCode === 27) {\n      ANGonWrapper.cancel();\n    }\n  }\n}\n","import {\n  Unit,\n  OptimizerPoint,\n  OptimizerTextleaderline,\n} from '../../../lib';\nimport { ActiveCommandController } from './ActiveCommandController';\nexport class ActiveCommandProperties {\n  activeCommandController: ActiveCommandController;\n  unit: Unit = Unit.Kilometer;\n  unitEnumInt = 0;\n  shiftDTMode = 0;\n\n  isHiddenLog = true;\n  isTextEditing = false;\n  insideMap = false;\n\n  needPostACMode = true;\n  isMarkupEnv = true;\n  isReturn = false;\n  isShortCutActive = true;\n  showUnit = false;\n  showTooltip = true;\n  showActiveCommandChain = true;\n  isDrawing = false;\n  isSmartSelectionWhenDrawing = false;\n  snap = false;\n  hasMultiSel = false;\n  activateCollsion = false;\n  activateMapScale = false;\n  isDragging = false;\n  isUp = false;\n  isViewChanging = false;\n  isDown = false;\n  isClick = false;\n  clickMenu = false;\n\n  showTooltipPoint = false;\n  hasHovering = false;\n\n  isActivateSnapping = false;\n  needDuplicateByAlt = false;\n  deselectNeeded = true;\n\n  // ........................................... textleader line\n  needrePositionTextLeaderLine = true;\n  needHideTextLeaderLine = true;\n  needCollisionDetection = true;\n  pressKey = false;\n  pressShift = false;\n  pressESC = false;\n  pressAltKey = false;\n  accentColor = false;\n  isScaleDynamicRender = true;\n  isActiveCluster = false;\n  private _needExecuteOptimizer = false;\n  private _optimizerTextleaderline: OptimizerTextleaderline = OptimizerTextleaderline.None;\n  private _optimizerPoint: OptimizerPoint = OptimizerPoint.None;\n  private _pressCtrlKey = false;\n  private _isPanning = false;\n  private _isZooming = false;\n  private _extentChanging = false;\n  constructor(activeCommandController: ActiveCommandController) {\n    this.activeCommandController = activeCommandController;\n  }\n\n  public set optimizerPoint(v: OptimizerPoint) {\n    this._optimizerPoint = v;\n    // if (this.activeCommandController.annotationInstance.renderer.optimizer.) {\n    this.activeCommandController.imageAnnoApp.renderer.optimizer.typePoint = v;\n    // }\n  }\n  public get optimizerPoint() {\n    return this._optimizerPoint;\n  }\n  public set optimizerTextleaderline(v: OptimizerTextleaderline) {\n    this._optimizerTextleaderline = v;\n    // if (this.activeCommandController.annotationInstance.renderer.optimizer.typeTextleaderline) {\n    this.activeCommandController.imageAnnoApp.renderer.optimizer.typeTextleaderline = v;\n    // }\n  }\n  public get optimizerTextleaderline() {\n    return this._optimizerTextleaderline;\n  }\n  public set pressCtrlKey(v: boolean) {\n    this._pressCtrlKey = v;\n\n    if (v === false) {\n      this.activeCommandController.imageAnnoApp.geometryCommon.gcmdProcessing.polygonGraphResetForSplit();\n    }\n  }\n  public get toleranceSnapping(): number {\n    return this.activeCommandController.imageAnnoApp.renderer.objectSnapping.toleranceSnapping;\n  }\n  // eslint-disable-next-line @typescript-eslint/adjacent-overload-signatures\n  public get pressCtrlKey(): boolean {\n    return this._pressCtrlKey;\n  }\n  public set isPanning(v: boolean) {\n    this._isPanning = v;\n  }\n  public get isPanning() {\n    return this._isPanning;\n  }\n  public set isZooming(v: boolean) {\n    this._isZooming = v;\n    if (!v) {\n      this.needExecuteOptimizer = true;\n    }\n  }\n  public get isZooming() {\n    return this._isZooming;\n  }\n  public get mapScale() {\n    // return this.activeCommandController.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.mapView.scale;\n    return 1;\n  }\n  public set needExecuteOptimizer(v: boolean) {\n    this._needExecuteOptimizer = v;\n  }\n  public get needExecuteOptimizer() {\n    return this._needExecuteOptimizer;\n  }\n  public set extentChanging(v: boolean) {\n    this.activeCommandController.shiftRenderLoop(!v);\n    this._extentChanging = v;\n  }\n  public get extentChanging() {\n    return this._extentChanging;\n  }\n  public get zoom(): undefined {\n    return undefined;\n  }\n}\n","import { ActiveCursor, ActiveCommandMode, Cursor, GType, InteractionMode } from '../../../lib';\nimport { AGeometryBase } from '../Geometry/Common/Base/AGeometryBase';\nimport { ActiveCommandController } from './ActiveCommandController';\nexport class ActiveMouseCursor {\n  public ac: ActiveCommandController;\n  private activeCursor: ActiveCursor;\n  constructor(ac: ActiveCommandController) {\n    this.ac = ac;\n    this.initActiveCursor();\n  }\n  public reset() {\n    // this.activeCURSOR.Default();\n  }\n  public updateActiveCursorByUp(acType: ActiveCommandMode) {\n    this.activeCursor.default();\n  }\n  public updateActiveCursorByMove(acType: ActiveCommandMode) {\n    this.updateActiveCursor(acType);\n  }\n  public updateActiveCursorByDrag(geo: AGeometryBase) {\n    if (this.ac.imageAnnoApp.scene.capture) {\n      // select node of rect anc circle\n      if (\n        this.ac.imageAnnoApp.scene.capture.type === GType.ANODE_RECT ||\n        this.ac.imageAnnoApp.scene.capture.type === GType.ANODE_CIRCLE ||\n        this.ac.imageAnnoApp.scene.capture.type === GType.RECTANGLE ||\n        this.ac.imageAnnoApp.scene.capture.type === GType.CIRCLE\n      ) {\n        geo.updateActiveCursor();\n        return;\n      }\n    }\n\n    this.setActiveCursorDrag();\n  }\n  public setActiveCursorDrag() {\n    this.activeCursor.dragging();\n  }\n  public setActiveCursorHovering() {\n    this.activeCursor.hovering();\n  }\n  private updateActiveCursor(acType: ActiveCommandMode) {\n    // console.trace();\n    if (acType === ActiveCommandMode.TEXT) {\n      this.activeCursor.texting();\n      return;\n    }\n\n    if (\n      acType === ActiveCommandMode.SELECT ||\n      acType === ActiveCommandMode.NONE ||\n      acType === ActiveCommandMode.SELECT_LASSO ||\n      acType === ActiveCommandMode.SELECT_RECT\n    ) {\n      if (\n        this.ac.acProperties.hasHovering &&\n        this.ac.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus.mode ===\n          InteractionMode.Drawing\n      ) {\n        // TODO\n      } else {\n        this.activeCursor.default();\n      }\n      if (\n        this.ac.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus.mode ===\n        InteractionMode.Drawing\n      ) {\n        this.activeCursorForText();\n      }\n    } else {\n      this.activeCursor.creating();\n    }\n  }\n  private activeCursorForText() {\n    for (let i = 0; i < this.ac.imageAnnoApp.scene.listATextleaderlineWrapper.length; ++i) {\n      if (\n        this.ac.imageAnnoApp.scene.listATextleaderlineWrapper[i].isMouseInsideDiv(\n          this.ac.m.x,\n          this.ac.m.y\n        )\n      ) {\n        this.activeCursor.texting();\n      }\n    }\n  }\n  private initActiveCursor() {\n    this.activeCursor = new ActiveCursor(\n      this.ac.imageAnnoApp.implementations.app.model.modelViewWrapper.div as HTMLElement\n    );\n  }\n  public setActiveCursor(CursorType: Cursor) {\n    switch (CursorType) {\n      case Cursor.EWresize:\n        this.activeCursor.set_ew_resize();\n        break;\n      case Cursor.NSresize:\n        this.activeCursor.set_ns_resize();\n        break;\n      case Cursor.NESWresize:\n        this.activeCursor.set_nesw_resize();\n        break;\n      case Cursor.NWSEresize:\n        this.activeCursor.set_nwse_resize();\n        break;\n      case Cursor.Pointer:\n        this.activeCursor.hovering();\n        break;\n      default:\n        break;\n    }\n  }\n}\n","// import { ActiveCursor, ActiveCommandMode, Cursor, GType, InteractionMode } from '../../../lib';\n// import { AGeometryBase } from '../Geometry/Common/Base/AGeometryBase';\nimport { hex2rgba, debounce, rgb2Hex } from '../../../lib';\nimport { ActiveCommandController } from './ActiveCommandController';\nexport class ActiveColor {\n  public ac: ActiveCommandController;\n  public activeColor: number[] = [41, 78, 241, 1];\n\n  constructor(ac: ActiveCommandController) {\n    this.ac = ac;\n  }\n  public setActiveColor(color: string, undoNeeded: boolean = true) {\n    // console.debug('from active color', color);\n    this.activeColor = hex2rgba(color);\n    if (this.activeColor.length < 3) {\n      this.activeColor.push(1.0);\n    }\n    this.updateColorSelGeometries(this.activeColor);\n\n    if (this.ac.imageAnnoApp.scene.capture && undoNeeded) {\n      this.checkChanges();\n    }\n    // console.log('trigger');\n\n  }\n  public getActiveColor() {\n    return rgb2Hex(this.activeColor[0], this.activeColor[1], this.activeColor[2]);\n  }\n  public updateColorSelGeometries(color: number[]) {\n    this.ac.imageAnnoApp.geometryCommon.gcmdProcessing.updateColorStyle(color);\n  }\n  private checkChanges = debounce(() => {\n    // console.debug('emitting for Saving data on server');\n    this.ac.imageAnnoApp.scene.captureScene();\n    // console.log('update needed');\n})\n}\n","import { TextAlign } from '../../../lib';\nimport { ActiveCommandController } from './ActiveCommandController';\n\nexport class ScreenLog {\n  public ac: ActiveCommandController;\n  public numLins = 10;\n  private list: string[] = [];\n\n  constructor(ac: ActiveCommandController) {\n    this.ac = ac;\n  }\n  public push(s: string) {\n    this.list.push(s);\n    if (this.list.length > this.numLins) {\n      this.list.shift();\n    }\n  }\n  public render(ctx: CanvasRenderingContext2D) {\n    ctx.textAlign = TextAlign.Left;\n    ctx.fillStyle = '#000000';\n    ctx.font = `10px Arial`;\n\n    const Y = 100;\n    const HEIGHT = 30;\n    let i = this.list.length;\n    while (i--) {\n      ctx.fillText(\n        `log: ${this.list[i]}`,\n        ctx.canvas.width * 0.2,\n        Y + HEIGHT * (this.list.length - i)\n      );\n    }\n  }\n}\n","import { ActionType, ActiveCommandMode, InteractionMode } from '../../../lib';\nimport { MouseEventData } from '../../../lib/Extended/EventData';\nimport { IOGeometry } from '../../../lib/Extended/GeometryUtility';\nimport { ThemeColorId } from '../Customization/ThemeRenderStyle/Utility';\nimport { APolygonWrapper } from '../Geometry/GeometryAnnotation/FamilyArea/APolygonWrapper/APolygonWrapper';\nimport { ARectangleWrapper } from '../Geometry/GeometryAnnotation/FamilyArea/ARectangleWrapper/ARectangleWrapper';\nimport { APolylineGraphWrapper } from '../Geometry/GeometryAnnotation/FamilyLine/APolylineGraphWrapper/APolylineGraphWrapper';\nimport { APolylineWrapper } from '../Geometry/GeometryAnnotation/FamilyLine/APolylineWrapper/APolylineWrapper';\nimport { ImageAnnoApp } from '..';\nimport {\n  CActiveCommandNone,\n  CActiveCommandRemove,\n  CActiveCommandSelection,\n  CActiveCommandSelectionLasso,\n  CActiveCommandSelectionRect,\n  // CActiveCommandCommon,\n} from './ActiveCommandImplementation/ActiveCommandImplementationsCommon';\nimport {\n  CActiveANCommandBendingPolylineGraph,\n  CActiveANCommandCircle,\n  CActiveANCommandCircleConstraintArea,\n  CActiveANCommandCircleConstraintCircumference,\n  CActiveANCommandPolygon,\n  CActiveANCommandPolygonConstraint,\n  CActiveANCommandPolygonGraph,\n  CActiveANCommandPolygonMultiple,\n  CActiveANCommandPolyline,\n  CActiveANCommandPolylineConstraint,\n  CActiveANCommandRect,\n  CActiveCommandANCurve,\n  CActiveCommandANCurveClosed,\n  CActiveCommandANFHCurve,\n  CActiveCommandANFHCurveClosed,\n  CActiveCommandANFHPolygon,\n  CActiveCommandANFHPolygonGraph,\n  CActiveCommandANFHPolyline,\n  CActiveCommandANFHPolylineBending,\n  CActiveCommandANPointNumbered,\n  CActiveCommandANPointRegular,\n  CActiveCommandANSmartDrawing,\n  CActiveCommandANSmartDrawingDeepLearning,\n  CActiveCommandArrow,\n  CActiveCommandArrowDouble,\n  CActiveCommandIcon,\n  CActiveCommandStar,\n  CActiveCommandTextLederline,\n  // CActiveCommandText,\n  // CActiveCommandNGon\n} from './ActiveCommandImplementation/ActiveCommandImplementationsShapes';\nimport { ActiveCommandCommonWrapper } from './ActiveCommandImplementation/Base/ActiveCommandCommonWrapper';\nimport { ActiveCommandProperties } from './ActiveCommandProperties';\nimport { ActiveMouseCursor } from './ActiveMouseCursor';\nimport { ActiveColor } from './ActiveColor';\nimport { ScreenLog } from './ScreenLog';\n\nexport class ActiveCommandController {\n  public imageAnnoApp: ImageAnnoApp;\n  public acProperties: ActiveCommandProperties;\n  public screenLog: ScreenLog;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public commands: any;\n  public activeCommand: ActiveCommandCommonWrapper;\n  public sanpValue = 10;\n  public type: ActiveCommandMode = ActiveCommandMode.NONE;\n  public m: MouseEventData;\n  public mNoSnap: MouseEventData;\n  public activeBase64img = '';\n  public activeMouseCursor: ActiveMouseCursor;\n  public activeColorController: ActiveColor;\n  public PostACMode: ActiveCommandMode;\n  public scaleGlobal = 1;\n  private _postACMode: ActiveCommandMode;\n  private _isTouchEvent = false;\n  private _zoomLevelForMoving = 2;\n  constructor(imageAnnoApp: ImageAnnoApp) {\n    this.acProperties = new ActiveCommandProperties(this);\n    this.imageAnnoApp = imageAnnoApp;\n    this.commands = {\n      // ........................................................................................................................ drawing annotation\n      [ActiveCommandMode.POINT_REGULAR]: new CActiveCommandANPointRegular(this),\n      [ActiveCommandMode.POINT_NUMBERED]: new CActiveCommandANPointNumbered(this),\n      [ActiveCommandMode.POINT_ICON]: new CActiveCommandIcon(this),\n\n      [ActiveCommandMode.ARROW_SINGLE]: new CActiveCommandArrow(this),\n      [ActiveCommandMode.ARROW_DOUBLE]: new CActiveCommandArrowDouble(this),\n      [ActiveCommandMode.CURVE_OPEN]: new CActiveCommandANCurve(this),\n      [ActiveCommandMode.CURVE_CLOSE]: new CActiveCommandANCurveClosed(this),\n\n      [ActiveCommandMode.POLYLINE]: new CActiveANCommandPolyline(this),\n      [ActiveCommandMode.POLYLINE_CONSTRAINT]: new CActiveANCommandPolylineConstraint(this),\n      [ActiveCommandMode.POLYLINE_BENDING]: new CActiveANCommandBendingPolylineGraph(this),\n\n      [ActiveCommandMode.POLYGON]: new CActiveANCommandPolygon(this),\n      [ActiveCommandMode.POLYGON_GRAPH]: new CActiveANCommandPolygonGraph(this),\n      [ActiveCommandMode.POLYGON_CONSTRAINT]: new CActiveANCommandPolygonConstraint(this),\n      [ActiveCommandMode.POLYGON_MULTIPLE]: new CActiveANCommandPolygonMultiple(this),\n\n      // [ActiveCommandMode.TEXT] : new CActiveCommandText(this),\n      [ActiveCommandMode.TEXT_LEADERLINE]: new CActiveCommandTextLederline(this),\n\n      [ActiveCommandMode.FREEHAND_POLYLINE]: new CActiveCommandANFHPolyline(this),\n      [ActiveCommandMode.FREEHAND_POLYLINE_BENDING]: new CActiveCommandANFHPolylineBending(this),\n      [ActiveCommandMode.FREEHAND_POLYGON]: new CActiveCommandANFHPolygon(this),\n      [ActiveCommandMode.FREEHAND_POLYGON_GRAPH]: new CActiveCommandANFHPolygonGraph(this),\n      [ActiveCommandMode.FREEHAND_CURVE]: new CActiveCommandANFHCurve(this),\n      [ActiveCommandMode.FREEHAND_CURVE_CLOSED]: new CActiveCommandANFHCurveClosed(this),\n\n      [ActiveCommandMode.SMARTDRAWING]: new CActiveCommandANSmartDrawing(this),\n      [ActiveCommandMode.SMARTDRAWING_DEEPLEARNING]: new CActiveCommandANSmartDrawingDeepLearning(this),\n\n      // ........................................................................................................................ Guided Tour\n      // ........................................................................................................................ drawing graphic\n\n      [ActiveCommandMode.NONE]: new CActiveCommandNone(this),\n      [ActiveCommandMode.SELECT]: new CActiveCommandSelection(this),\n      [ActiveCommandMode.REMOVE]: new CActiveCommandRemove(this),\n      [ActiveCommandMode.SELECT_RECT]: new CActiveCommandSelectionRect(this),\n      [ActiveCommandMode.SELECT_LASSO]: new CActiveCommandSelectionLasso(this),\n\n      // ........................................................................................................................ lab env\n      [ActiveCommandMode.RECTANGLE]: new CActiveANCommandRect(this),\n      [ActiveCommandMode.STAR]: new CActiveCommandStar(this), // CActiveCommandNGon\n      [ActiveCommandMode.CIRCLE]: new CActiveANCommandCircle(this),\n      [ActiveCommandMode.CIRCLE_CONSTRAINT_AREA]: new CActiveANCommandCircleConstraintArea(this),\n      [ActiveCommandMode.CIRCLE_CONSTRAINT_CIRCUMFERENCE]: new CActiveANCommandCircleConstraintCircumference(this),\n    };\n\n    this.m = new MouseEventData();\n    this.mNoSnap = this.m.deepCopy();\n    this.activeCommand = new CActiveCommandNone(this);\n    this.screenLog = new ScreenLog(this);\n    this.postACMode = ActiveCommandMode.SELECT;\n    this.activeMouseCursor = new ActiveMouseCursor(this);\n    this.activeColorController = new ActiveColor(this);\n    // this.annotationInstance.mapView\n    // this.annotationInstance.map.disableRubberBandZoom();\n    // Print.log('ac done');\n\n    // set default value for the active command\n    this.setActiveCommand(ActiveCommandMode.SELECT);\n  }\n\n  public setActiveColor(id: ThemeColorId) {\n    // console.log(id);\n  }\n  public setScaleGlobal(v: number) {\n    if (v > 0.5) {\n      this.scaleGlobal = v;\n      this.imageAnnoApp.graphicsCoreWrapper.renderForce();\n    }\n  }\n  public setActiveCommand(theAC: ActiveCommandMode) {\n    theAC = this.remapActiveCommandVersion(theAC);\n    if (theAC === ActiveCommandMode.SMARTDRAWING_DEEPLEARNING) {\n      // if (!this.imageAnnoApp.implementations.app.addon.smartDrawing) {\n      //   this.imageAnnoApp.implementations.app.addon.initSmartDrawing();\n      // }\n    }\n    this.acProperties.pressShift = false;\n    // this.pressCtrlKey = false;\n    // this.pressAltKey = false;\n\n    // let dd = true;\n    // if (dd) { return; }\n\n    // this.annotationInstance.nGraphics.divNGraphics.focus();\n    // AGeometryCommon.captureForEasing = undefined;\n    if (\n      this.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus.mode !==\n      InteractionMode.Drawing\n    ) {\n      this.activeCommand = this.commands[theAC];\n      return;\n    }\n\n    if (theAC === ActiveCommandMode.SELECT || theAC === ActiveCommandMode.NONE) {\n      this.acProperties.isDrawing = false;\n    } else {\n      this.acProperties.isDrawing = true;\n    }\n\n    this.cancelAC();\n    // AText.ESC();\n    this.activeCommand = this.commands[theAC];\n    this.type = theAC;\n\n    this.activeMouseCursor.updateActiveCursorByUp(this.type);\n\n    // if (this.type === ActiveCommandMode.SELECT_LASSO || this.type === ActiveCommandMode.SELECT_RECT) { ASelection.isTooltipRenderable = true; }\n    // if (this.type === ActiveCommandMode.FREEHAND_CURVE || this.type === ActiveCommandMode.FREEHAND_POLYLINE) { AFreehand.isTooltipRenderable = true; }\n    // if (this.type === ActiveCommandMode.SMARTDRAWING) { AFreehandSmartDrawing.isTooltipRenderable = true; }\n\n    if (\n      this.type === ActiveCommandMode.POINT_REGULAR ||\n      this.type === ActiveCommandMode.POINT_ICON ||\n      this.type === ActiveCommandMode.POINT_NUMBERED ||\n      this.type === ActiveCommandMode.LINE\n    ) {\n      this.acProperties.showTooltipPoint = true;\n    } else {\n      this.acProperties.showTooltipPoint = false;\n    }\n  }\n  public goToACMode(postAC: ActiveCommandMode = this.postACMode) {\n    if (!this.acProperties.needPostACMode) {\n      return;\n    }\n\n    // Unlike express map, we want to keep the same command after clicking\n    // we will revisit here\n    this.setActiveCommand(postAC);\n    this.imageAnnoApp.io.eventListenerAnnotation.shiftCAMode(postAC);\n  }\n  public set zoomLevelForMoving(v: number) {\n    this._zoomLevelForMoving = 2 + Math.floor(v / 4);\n  }\n  public get zoomLevelForMoving() {\n    return this._zoomLevelForMoving;\n  }\n  public get postACMode(): ActiveCommandMode {\n    return this._postACMode;\n  }\n  public set postACMode(v: ActiveCommandMode) {\n    // console.trace();\n    // console.log(AGeometry.annotationInstance);\n    // if (AGeometry.annotationInstance.eventListenerAnnotation) { AGeometry.annotationInstance.eventListenerAnnotation.ShiftCAMode(v); }\n    this._postACMode = v;\n  }\n  public get IsTouchEvent(): boolean {\n    return this._isTouchEvent;\n  }\n  public set IsTouchEvent(v: boolean) {\n    this._isTouchEvent = v;\n  }\n  public set IsTextEditing(v: boolean) {\n    this.acProperties.isTextEditing = v;\n    // this.annotationInstance.nGraphics.ACController.IsTextEditing = v;\n  }\n  public get IsTextEditing() {\n    return this.acProperties.isTextEditing;\n  }\n  public resizeCanvas(width: number, height: number) {\n    // this.annotationInstance.nGraphics.annotationInstance.screen.canvas.width = width;\n    // this.annotationInstance.nGraphics.annotationInstance.screen.canvas.height = height;\n    // this.annotationInstance.nGraphics.annotationInstance.screen.aGeometryRender.blackhole.UpdateCanvasSize(width, height);\n    // this.annotationInstance.nGraphics.UpdateCanvasSize(width, height);\n  }\n  public cancelAC() {\n    this.acProperties.pressShift = false;\n    if (\n      this.imageAnnoApp.implementations.app.model.appCoreWrapper.appControllerStatus.mode ===\n      InteractionMode.ObserveViewer\n    ) {\n      return;\n    }\n    APolylineGraphWrapper.cancel(this.imageAnnoApp.scene);\n    APolygonWrapper.cancel(this.imageAnnoApp.scene);\n    APolylineWrapper.cancel(this.imageAnnoApp.scene);\n    // ACircle.Cancel(); ARectangle.Cancel();\n    // CPolyline.Cancel(); CPolygon.Cancel(); CCircle.Cancel(); CNGon.Cancel(); CCurve.Cancel();\n  }\n  // ................................................................. voice controller binding\n  public getCircleFromVoice() {\n    // ACircleWrapper.GetCircleFromVoice(this.annotationInstance.scene);\n  }\n  public getRectangleFromVoice() {\n    ARectangleWrapper.getRectangleFromVoice(this.imageAnnoApp.scene);\n  }\n  // ................................................................. end voice controller binding\n  public reUndoProcessing(states: IOGeometry[]) {\n    this.imageAnnoApp.geometryCommon.gcmdProcessing.reUndoProcessing(states);\n  }\n  public reUndoProcessingStorymaps(states: Map<string, IOGeometry>) {\n    this.imageAnnoApp.geometryCommon.gcmdProcessing.reUndoProcessingStorymaps(states);\n  }\n  public repopulateGeometries(d: IOGeometry[]) {\n    this.imageAnnoApp.geometryCommon.gcmdProcessing.repopulateGeometries(d);\n  }\n  // UpdateVecByViewChanging() {\n  //     // APolygonMultple.UpdateVecByViewChanging();\n  // }\n  public base64DumpIcon(action: string, id: string, base64: string) {\n    this.base64Processing(action, id, base64);\n  }\n  public removeSelShape() {\n    this.imageAnnoApp.geometryCommon.gcmdProcessing.removeAllCapturedGeoGroup();\n  }\n  public base64Processing(action: string, id: string, base64?: string) {\n    if (action === ActionType.AddIconBase64 && base64 !== undefined) {\n      this.imageAnnoApp.renderer.draw.image.addBase64(id, base64);\n    }\n    if (action === ActionType.SelectIconBase64) {\n      this.imageAnnoApp.renderer.draw.image.activeBase64(id);\n    }\n  }\n  public mousePostProcess(e: MouseEventData, sValue: number = this.sanpValue) {\n    if (this.acProperties.snap) {\n      e.x = Math.floor(e.x / sValue) * sValue;\n      e.y = Math.floor(e.y / sValue) * sValue;\n      return e;\n    }\n    return e;\n  }\n  public processingUpdate(id: string, data: string) {\n    this.imageAnnoApp.geometryCommon.gcmdProcessing.processingUpdate(id, data);\n  }\n  public removeByIDs(ids: string) {\n    this.imageAnnoApp.geometryCommon.gcmdProcessing.removeByIDs(ids);\n  }\n  public removeAllShapes() {\n    this.imageAnnoApp.geometryCommon.gcmdSelecting.selectAllObjects();\n    this.imageAnnoApp.geometryCommon.gcmdProcessing.removeAllGeo();\n    this.imageAnnoApp.geometryCommon.gcmdProcessing.removeAll();\n  }\n  public updateProjection(e: MouseEventData) {\n    if (this.imageAnnoApp.implementations.app.model.imageWrapper.img) {\n      const pos = this.imageAnnoApp.implementations.app.model.imageWrapper.projectionToImageSpace(e.x, e.y)\n      e.x = pos[0];\n      e.y = pos[1];\n\n      // These are needed with image cropped by CSS.\n      // e.x *= this.imageAnnoApp.scene.paramsEditing.croppingMaskParams.width / bounding.width;\n      // e.y *= this.imageAnnoApp.scene.paramsEditing.croppingMaskParams.height / bounding.height;\n\n      e.x += this.imageAnnoApp.scene.paramsEditing.croppingMaskParams.x;\n      e.y += this.imageAnnoApp.scene.paramsEditing.croppingMaskParams.y;\n\n      // this.scaleByRatio = 1\n      // = ((this.imageAnnoApp.implementations.app.model.modelViewWrapper.imgOrigin.width / bounding.width) +\n      //       (this.imageAnnoApp.implementations.app.model.modelViewWrapper.imgOrigin.height / bounding.height)) * 0.5;\n\n      // console.log('x ratio',this.imageAnnoApp.implementations.app.model.modelViewWrapper.imgOrigin.width / bounding.width,\n      //    'y ratio', this.imageAnnoApp.implementations.app.model.modelViewWrapper.imgOrigin.height / bounding.height);\n    }\n\n  }\n  public commonEvent(e: MouseEventData) {\n    this.updateProjection(e);\n    this.mNoSnap = e.deepCopy();\n    e = this.mousePostProcess(e);\n    this.imageAnnoApp.apiWrapper.environment.logCommon(e.x, e.y);\n    this.m = e;\n    return e;\n  }\n  public hide(ids: string[]) {\n    this.imageAnnoApp.geometryCommon.gcmdProcessing.hide(ids);\n  }\n  public unhide(ids: string[]) {\n    this.imageAnnoApp.geometryCommon.gcmdProcessing.unhide(ids);\n  }\n  public setupPolylineConstraintLength(v: number) {\n    this.imageAnnoApp.geometryCommon.gcmdProcessing.setupPolylineConstraintLength(v);\n  }\n  public setupPolylineConstraintLengthPercentage(v: number) {\n    this.imageAnnoApp.geometryCommon.gcmdProcessing.setupPolylineConstraintLengthPercentage(v);\n  }\n\n  public disableExcept(ids: string[]) {\n    this.imageAnnoApp.geometryCommon.gcmdProcessing.disableExcept(ids);\n  }\n  public highlight(id: string) {\n    this.imageAnnoApp.geometryCommon.gcmdProcessing.highlight(id);\n  }\n  public downloadShapes() {\n    this.imageAnnoApp.implementations.app.model.ioWrapper.download();\n  }\n  public downloadTheme() {\n    this.imageAnnoApp.customization.downloadTheme();\n  }\n  public pause() {\n    this.imageAnnoApp.implementations.app.pause();\n  }\n  public resume() {\n    this.imageAnnoApp.implementations.app.resume();\n  }\n  public needPopup() {\n    if (this.acProperties.isMarkupEnv) {\n      return false;\n    }\n    return true;\n  }\n  private remapActiveCommandVersion(theAC: ActiveCommandMode) {\n    // if (theAC === ActiveCommandMode.TEXT_LEADERLINE) {\n    //   theAC = ActiveCommandMode.TEXT_LEADERLINE_V2;\n    // }\n    return theAC;\n  }\n  public shiftRenderLoop(v: boolean) {\n    // console.log(v);\n    // this is because skipping render loop can cause the Leaderlines stutter when extent changing... in this case, we need to force render fully\n    // console.log(this.apiWrapper.annotationInstance.scene.listATextleaderlineWrapper.length);\n    if (!v && this.imageAnnoApp.scene.listATextleaderlineWrapper.length > 0) {\n      this.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.IsRenderSkip = false;\n      return;\n    }\n    this.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.IsRenderSkip = true;\n  }\n  public activecommandIconPoint() {\n    // console.log('icon point');\n    this.setActiveCommand(ActiveCommandMode.POINT_ICON);\n  }\n  public setScaleGraphics(value: number, absolute: boolean = true, undoNeeded: boolean = true) {\n    const geo = this.imageAnnoApp.geometryCommon.gcmdProcessing.hasMultiSel();;\n    if(geo && geo.length > 0) {\n      for (let i = 0; i < geo.length; ++i ) {\n        if (absolute) {\n          geo[i].setScaleLocal(value);\n        } else {\n          if (value + geo[i].styleComponent.renderStyle.scaleLocal > 0.5) {\n            geo[i].setScaleLocal(value + geo[i].styleComponent.renderStyle.scaleLocal);\n          }\n        }\n      }\n    } else {\n      if (absolute) {\n        this.imageAnnoApp.activeCommandController.setScaleGlobal(value);\n      } else {\n        this.imageAnnoApp.activeCommandController.setScaleGlobal(value + this.imageAnnoApp.activeCommandController.scaleGlobal);\n      }\n    }\n    if (undoNeeded) {\n      this.imageAnnoApp.scene.captureScene();\n    }\n    this.activeCommand.acs.imageAnnoApp.graphicsCoreWrapper.renderForce();\n  }\n}\n","import {\n  ActiveCommandMode,\n  getBoundingByVecs,\n  NVector3, origin\n} from '../../../../lib';\nimport { AGeometryBase } from './Base/AGeometryBase';\nimport { GeometryCommon } from '.';\n\nexport class GeometryAdvancedProcessing {\n  public gcmd: GeometryCommon;\n  constructor(gcmd: GeometryCommon) {\n    this.gcmd = gcmd;\n  }\n  public downloadImag() {\n    // console.log('get download');\n    // const imgData = this.gcmd.annotationInstance.graphicsCoreWrapper.canvasWrapper.aCanvas.getImageData();\n\n    // console.trace();\n\n    const link = document.createElement('a');\n    link.download = 'filename.png';\n    link.href = this.gcmd.annotationInstance.graphicsCoreWrapper.canvasWrapper.aCanvas.canvas.toDataURL('image/jpeg');\n    link.click();\n  }\n  public computeBoundaryFromGeos(geo: AGeometryBase[]) {\n    const vs = [];\n    for (let i = 0; i < geo.length; ++i) {\n      const v = geo[i].getBoundary();\n      for (let j = 0; j < v.length; ++j) {\n        vs.push(v[j]);\n      }\n    }\n    return getBoundingByVecs(vs);\n  }\n  public pasteSelGeoInPlace(x: number, y: number) {\n    let i = this.gcmd.annotationInstance.scene.copyPasteGeo.length;\n    if (i === 0) {\n      return;\n    }\n    if (i === 1) {\n      this.gcmd.annotationInstance.scene.copyPasteGeo[0].deepCopy(\n        this.gcmd.annotationInstance.scene.copyPasteGeo[0].vec.x + x,\n        this.gcmd.annotationInstance.scene.copyPasteGeo[0].vec.y + y\n      );\n      return;\n    }\n\n    while (i--) {\n      if (this.gcmd.annotationInstance.scene.copyPasteGeo[i]) {\n        const p = this.gcmd.annotationInstance.scene.copyPasteGeo[i];\n        p.isSelectedValue = false;\n        const dp = this.gcmd.annotationInstance.scene.copyPasteGeo[i].deepCopy(\n          p.v.x + x,\n          p.v.y + y\n        );\n        if (dp) {\n          const np = dp as AGeometryBase;\n          np.isSelected = true;\n          np.isHover = true;\n\n          // console.log(np.IsSelected);\n        }\n      }\n    }\n    this.gcmd.annotationInstance.activeCommandController.setActiveCommand(ActiveCommandMode.NONE);\n  }\n  public pasteSelGeo(x: number, y: number) {\n    let i = this.gcmd.annotationInstance.scene.copyPasteGeo.length;\n    if (i === 0) {\n      return;\n    }\n    if (i === 1) {\n      this.gcmd.annotationInstance.scene.copyPasteGeo[0].deepCopy(x, y);\n      return;\n    }\n    const vc: NVector3 = origin();\n    while (i--) {\n      vc.Add(this.gcmd.annotationInstance.scene.copyPasteGeo[i].v);\n    }\n    i = this.gcmd.annotationInstance.scene.copyPasteGeo.length;\n    vc.x = x - vc.x / i;\n    vc.y = y - vc.y / i;\n    while (i--) {\n      if (this.gcmd.annotationInstance.scene.copyPasteGeo[i]) {\n        const p = this.gcmd.annotationInstance.scene.copyPasteGeo[i];\n        p.isSelectedValue = false;\n        const dp = this.gcmd.annotationInstance.scene.copyPasteGeo[i].deepCopy(\n          p.v.x + vc.x,\n          p.v.y + vc.y\n        );\n        if (dp) {\n          const np = dp as AGeometryBase;\n          np.isSelected = true;\n\n          // console.log(np.IsSelected);\n        }\n      }\n    }\n    this.gcmd.gcmdSelecting.deSelectCaptureObjects();\n  }\n  public getCanvas() {\n    return this.gcmd.annotationInstance.graphicsCoreWrapper.canvasWrapper.aCanvas.ctx.canvas;\n  }\n}\n","\nimport { IOGeometry } from '../../../../lib/Extended/GeometryUtility';\nimport {\n  ActiveCommandMode,\n  GType,\n  InteractionMode,\n  PointRenderType,\n  Size,\n  MouseEventData,\n  findIndexOfMin,\n  getRandomRGB,\n  getDistance,\n  NVector3,\n  getColorDistance\n} from '../../../../lib';\nimport { GeometryCommon } from '.';\nimport { AGeometryBase } from './Base/AGeometryBase';\nimport { APointBase } from './Base/APointBase';\nimport { ACircleWrapper } from '../GeometryAnnotation/FamilyArea/ACircleWrapper/ACircleWrapper';\nimport { APolygonGraphWrapper } from '../GeometryAnnotation/FamilyArea/APolygonGraphWrapper';\nimport { APolygonWrapper } from '../GeometryAnnotation/FamilyArea/APolygonWrapper/APolygonWrapper';\nimport { ARectangleWrapper } from '../GeometryAnnotation/FamilyArea/ARectangleWrapper/ARectangleWrapper';\nimport { ACurve } from '../GeometryAnnotation/FamilyCurve/ACurveWrapper/ACurve';\nimport { AArrow } from '../GeometryAnnotation/FamilyLine/AArrowWrapper/AArrow';\nimport { APolylineGraphWrapper } from '../GeometryAnnotation/FamilyLine/APolylineGraphWrapper/APolylineGraphWrapper';\nimport { APolylineWrapper } from '../GeometryAnnotation/FamilyLine/APolylineWrapper/APolylineWrapper';\nimport { APointIconWrapper } from '../GeometryAnnotation/FamilyPoint/APointIconWrapper/APointIconWrapper';\nimport { APointNumberedWrapper } from '../GeometryAnnotation/FamilyPoint/APointNumberedWrapper';\nimport { APointRegularWrapper } from '../GeometryAnnotation/FamilyPoint/APointRegularWrapper';\nimport { APoint } from '../GeometryAnnotation/FamilyPoint/Base/APoint';\nimport { ATextleaderlineWrapper } from '../GeometryAnnotation/FamilyText/ATextleaderline';\nexport interface HashColorInterface {\n  [col: string]: AGeometryBase;\n}\nexport class GeometryCommonProcessing {\n  // static dt: number = 0;\n  // static sound: SoundTemplate;\n  public static capture: AGeometryBase | undefined = undefined;\n  public static captureMultiple: AGeometryBase[] | undefined = undefined;\n\n  public static captureHovered: AGeometryBase | undefined = undefined;\n  // static captureHoveredPre: AGeometryBase | undefined = undefined;\n  public static captureForEasing: AGeometryBase | undefined = undefined;\n  public static list: AGeometryBase[] = [];\n  // static listBaseGrid: AGrid;\n  public static copyPasteGeo: AGeometryBase[] = [];\n  public static listHashColor: HashColorInterface = {};\n\n  // private static ID: number = 0;\n  public gcmd: GeometryCommon;\n  constructor(gcmd: GeometryCommon) {\n    this.gcmd = gcmd;\n  }\n  public get width() {\n    return +this.gcmd.annotationInstance.implementations.app.model.modelViewWrapper.divHost.style.width.split(\n      'px'\n    )[0] as number;\n  }\n  public get height() {\n    return + this.gcmd.annotationInstance.implementations.app.model.modelViewWrapper.divHost.style.height.split(\n      'px'\n    )[0] as number;\n  }\n  public rightClickOnHoverGeo(e: MouseEventData) {\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    while (i--) {\n      if (this.gcmd.annotationInstance.scene.geometryList[i].isHover) {\n        this.gcmd.annotationInstance.scene.geometryList[i].mouseRightClick(e);\n        return true;\n      }\n    }\n    return false;\n  }\n  public updatePopup() {\n    // let i = this.gcmd.annotationInstance.scene.listBasePoint.length;\n    // while (i--) {\n    //   if (this.gcmd.annotationInstance.scene.listBasePoint[i].isCaptured === true) { this.gcmd.annotationInstance.scene.listBasePoint[i].ShowPopup(); } else { this.gcmd.annotationInstance.scene.listBasePoint[i].HidePopUp(); }\n    // }\n    // i = this.gcmd.annotationInstance.scene.listAPolyline.length;\n    // while (i--) {\n    //   if (CPolyline.list[i].isCaptured === true) { CPolyline.list[i].pts[CPolyline.list[i].pts.length - 1].ShowPopup(); } else { CPolyline.list[i].HidePopUp(); }\n    // }\n  }\n\n  // ....................................................................................................... geometry translation\n  public moveSelectedGeoPreSmartVersionBetweenGeometryAndNodes(e: MouseEventData) {\n    // let cp: AGeometryBase | undefined = undefined;\n    // if (!AGeometryCommon.Capture || AGeometryCommon.Capture.type === GType.POLYGON || AGeometryCommon.Capture.type === GType.POLYLINE ||\n    //   AGeometryCommon.Capture.type === GType.ARROW_SINGLE || AGeometryCommon.Capture.type === GType.ARROW_DOUBLE || AGeometryCommon.Capture.type === GType.LINE) {\n    //   for (let i = 0; i < APoint.list.length; ++i) {\n    //     if (APoint.list[i].isHover && APoint.list[i].type === GType.NODE) {\n    //       cp = APoint.list[i];\n    //     }\n    //   }\n    // }\n    // if (cp !== undefined) {\n    //   cp.Translate(e);\n    // } else {\n    //   for (let i = 0; i < this.gcmd.annotationInstance.scene.geometryList .length; ++i) {\n    //     if (this.gcmd.annotationInstance.scene.geometryList [i].isCaptured || this.gcmd.annotationInstance.scene.geometryList [i].IsSelected && this.gcmd.annotationInstance.scene.geometryList [i].type !== GType.NODE && this.gcmd.annotationInstance.scene.geometryList [i].type !== GType.NODE_CIRCLE) {\n    //       this.gcmd.annotationInstance.scene.geometryList [i].Translate(e);\n    //     }\n    //   }\n    // }\n  }\n  public moveSelectedGeo(e: MouseEventData) {\n    for (let i = 0; i < this.gcmd.annotationInstance.scene.geometryList.length; ++i) {\n      if (\n        this.gcmd.annotationInstance.scene.geometryList[i].isCapturedValue ||\n        (this.gcmd.annotationInstance.scene.geometryList[i].isSelected &&\n          this.gcmd.annotationInstance.scene.geometryList[i].type !== GType.CNODE &&\n          this.gcmd.annotationInstance.scene.geometryList[i].type !== GType.CNODE_CIRCLE)\n      ) {\n        // if (this.gcmd.annotationInstance.scene.geometryList [i].type === GType.POLYLINE) {\n        //   let geo = this.gcmd.annotationInstance.scene.geometryList [i] as CPolyline;\n\n        // }\n        const cp = this.gcmd.annotationInstance.scene.geometryList[i].findClosestNode(e.x, e.y);\n        if (cp !== undefined && cp !== null) {\n          cp.translateByMouseEventData(e);\n          this.gcmd.annotationInstance.scene.Capture = cp as AGeometryBase;\n        } else {\n          this.gcmd.annotationInstance.scene.geometryList[i].translateByMouseEventData(e);\n        }\n      }\n    }\n  }\n  /*\n    public MoveSelectedGeoByDragging(e: MouseEventData) {\n        let cp: AGeometryBase | undefined = undefined;\n\n        if (cp !== undefined) {\n            // cp.TranslateByMouseEventData(e);\n        } else {\n\n            for (let i = 0; i < this.gcmd.annotationInstance.scene.geometryList.length; ++i) {\n\n                if (this.gcmd.annotationInstance.scene.geometryList[i].IsSelected && !this.gcmd.annotationInstance.scene.geometryList[i].isCaptured &&\n                    this.gcmd.annotationInstance.scene.geometryList[i].type !== GType.CNODE && this.gcmd.annotationInstance.scene.geometryList[i].type !== GType.CNODE_CIRCLE) {\n                    // this.gcmd.annotationInstance.scene.geometryList [i].Translate(e);\n                }\n            }\n        }\n    }\n    */\n  // public MoveCaptureGeometry(e: MouseEventData) {\n  //   let cp: AGeometryBase | undefined = undefined;\n  //   for (let i = 0; i < APoint.list.length; ++i) { if (APoint.list[i].isHover && APoint.list[i].type === GType.CNODE) { cp = APoint.list[i]; } }\n  //   if (cp === undefined) {\n  //     if (AGeometryCommon.capture) {\n  //       AGeometryCommon.capture.Translate(e);\n\n  //     }\n  //   }\n  // }\n\n  // ....................................................................................................... end geometry translation\n  public moveMidPoint(e: MouseEventData) {\n    // const i = this.gcmd.annotationInstance.scene.listAPoint.length;\n    // while (i--) {\n    //   if (this.gcmd.annotationInstance.scene.listAPoint[i]._isHover && this.gcmd.annotationInstance.scene.listAPoint[i].type === GType.CMIDPOINT) {\n    //     let p = this.gcmd.annotationInstance.scene.listAPoint[i] as APoint;\n    //     // let ln = p.edges[0] as ALine;\n    //     // let np = ln.splitLineByPoint(new NVector3(p.vec.x, p.vec.y, p.vec.z), true);\n    //     // this.gcmd.annotationInstance.scene.Capture = np;\n    //   }\n    // }\n    // i = this.gcmd.annotationInstance.scene.listAPoint.length;\n    // while (i--) {\n    //   if (this.gcmd.annotationInstance.scene.listAPoint[i].isHover && this.gcmd.annotationInstance.scene.listAPoint[i].type === GType.AMIDPOINT_ALINE) {\n    //     let p = this.gcmd.annotationInstance.scene.listAPoint[i] as APoint;\n    //     console.log(p);\n    //     let ln = p.aEdges[0] as ALine;\n    //     let np = ln.SplitLineByPoint(new NVector3(p.vec.x, p.vec.y, p.vec.z), true);\n    //     AGeometryCommon.Capture = np;\n    //   }\n    // }\n  }\n\n  public removeAllGeo() {\n    let c = APointBase.list.length;\n    if (c === 0) {\n      return;\n    }\n    while (c--) {\n      APointBase.list[c].remove();\n    }\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    if (i === 0) {\n      return;\n    }\n    while (i--) {\n      // console.log(i);\n      // console.log(this.gcmd.annotationInstance.scene.geometryList);\n      this.gcmd.annotationInstance.scene.geometryList[i].remove();\n    }\n  }\n  public resetTranformation() {\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    if (i === 0) {\n      return;\n    }\n    while (i--) {\n      this.gcmd.annotationInstance.scene.geometryList[i].isTransform = false;\n    }\n  }\n  public checkAttachedTextleaderline(g: AGeometryBase) {\n    if (g.type === GType.POLYGON_GRAPH) {\n      const pGraph = g as APolygonGraphWrapper;\n      return pGraph.checkAttachedTextleaderline();\n    } else if (g.type === GType.POLYLINE_BENDING) {\n      const pLineGraph = g as APolylineGraphWrapper;\n      return pLineGraph.checkAttachedTextleaderline();\n    } else if (g.type === GType.RECTANGLE) {\n      const rect = g as ARectangleWrapper;\n      return rect.checkAttachedTextleaderline();\n    } else if (g.type === GType.CIRCLE) {\n      const cir = g as ACircleWrapper;\n      return cir.CheckAttachedTextleaderline();\n    }\n\n    //  for RPoint NPoint Nodes\n    if (g.textLeaderline && g.textLeaderline.leaderline) {\n      if (getDistance(g.textLeaderline.leaderline.v2, g.vec) > 5) {\n        g.textLeaderline.attachedShape = undefined;\n        g.textLeaderline = undefined;\n        return false;\n      }\n    }\n    return true;\n  }\n\n  public processSelectionViewerMode() {\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    if (this.gcmd.annotationInstance.scene.capture) {\n      while (i--) {\n        if (\n          this.gcmd.annotationInstance.scene.capture ===\n          this.gcmd.annotationInstance.scene.geometryList[i]\n        ) {\n          this.gcmd.annotationInstance.scene.geometryList[i].isSelectedValue = true;\n        } else {\n          this.gcmd.annotationInstance.scene.geometryList[i].isSelectedValue = false;\n        }\n      }\n    } else {\n      while (i--) {\n        this.gcmd.annotationInstance.scene.geometryList[i].isSelectedValue = false;\n      }\n    }\n  }\n  public polygonGraphResetForSplit() {\n    let i = this.gcmd.annotationInstance.scene.listAPolygonGraphWrapper.length;\n    while (i--) {\n      this.gcmd.annotationInstance.scene.listAPolygonGraphWrapper[i].polygonGraphResetForSplit();\n    }\n  }\n  public copySelGeo() {\n    this.gcmd.annotationInstance.scene.copyPasteGeo = [];\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    while (i--) {\n      if (\n        this.gcmd.annotationInstance.scene.geometryList[i].isSelected ||\n        this.gcmd.annotationInstance.scene.geometryList[i].isHoverValue\n      ) {\n        this.gcmd.annotationInstance.scene.copyPasteGeo.push(\n          this.gcmd.annotationInstance.scene.geometryList[i]\n        );\n      }\n    }\n    this.gcmd.annotationInstance.activeCommandController.setActiveCommand(ActiveCommandMode.NONE);\n  }\n  public toMapConvertGeoDis(x: number, y: number, dis: number) {\n    // const geoV = this.gcmd.gcmdSupporting.toMap(x, y);\n    // const onePixel = this.gcmd.gcmdSupporting.toMap(x + 1, y);\n    // let onePixelDis = onePixel[0] - geoV[0];\n    // let onePixelGeoDis = KMeterByTwoGeoPos(geoV[0], geoV[1], onePixel[0], onePixel[1]);\n\n    const mult = dis / 1; //onePixelGeoDis;\n    // console.log('input distance', dis);\n    // console.log('one pixel geo dis', onePixelGeoDis);\n    // console.log('result pixel nums', mult);\n\n    const geoVSecond = this.gcmd.gcmdSupporting.toMap(x + mult, y);\n    const resultScreen = [geoVSecond[0], geoVSecond[1]];\n    // AGeometryCommon.ToScreenFromGeoPos(geoVSecond[0],geoVSecond[1]);\n    return resultScreen[0] - x;\n  }\n  // public GetMapPoint(x: number, y: number) {\n  //   return this.gcmd.annotationInstance.nGraphics.GetMapPoint(x, y);\n  // }\n  // .............................................. geometry mananging common\n  public setCaptureHovered(geo: AGeometryBase | undefined) {\n    // if (AGeometryCommon.Model.nGraphics.nGraphicsMode !== INTERACTIONMODE.DRAWING) { return; }\n    if (geo !== this.gcmd.annotationInstance.scene.captureHovered) {\n      this.gcmd.annotationInstance.scene.captureHovered = geo;\n      // CanvasTooltip.GetToolTip(this.gcmd.annotationInstance.scene.captureHovered);\n    }\n  }\n  public getHashColor(geo: AGeometryBase) {\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      const col = getRandomRGB();\n      if (!this.gcmd.annotationInstance.scene.listHashColor[col]) {\n        this.gcmd.annotationInstance.scene.listHashColor[col] = geo;\n        return col;\n      }\n    }\n  }\n  public getShapeByHashCol(c: string) {\n    return this.gcmd.annotationInstance.scene.listHashColor[c];\n  }\n  public isMouseInsideByOffScreenNumberPoint(x: number, y: number, colTarget: number[]) {\n    // const col = this.gcmd.annotationInstance.implementations.app.model.graphicsCoreWrapper.canvasWrapper.aCanvasOffScreen.GetColorByPos(x, y);\n    const col = this.pickColorsOffscreen(x, y, 3 , 3);\n    const tolerance = 30\n    if (\n      getColorDistance(col[0], col[1], col[2], colTarget[0], colTarget[1], colTarget[2]) < tolerance ||\n      getColorDistance(col[0+4], col[1+4], col[2+4], colTarget[0], colTarget[1], colTarget[2]) < tolerance ||\n      getColorDistance(col[0+(4*2)], col[1+(4*2)], col[2+(4*2)], colTarget[0], colTarget[1], colTarget[2]) < tolerance ||\n      getColorDistance(col[0+(4*3)], col[1+(4*3)], col[2+(4*3)], colTarget[0], colTarget[1], colTarget[2]) < tolerance ||\n      getColorDistance(col[0+(4*4)], col[1+(4*4)], col[2+(4*4)], colTarget[0], colTarget[1], colTarget[2]) < tolerance ||\n      getColorDistance(col[0+(4*5)], col[1+(4*5)], col[2+(4*5)], colTarget[0], colTarget[1], colTarget[2]) < tolerance ||\n      getColorDistance(col[0+(4*6)], col[1+(4*6)], col[2+(4*6)], colTarget[0], colTarget[1], colTarget[2]) < tolerance ||\n      getColorDistance(col[0+(4*7)], col[1+(4*7)], col[2+(4*7)], colTarget[0], colTarget[1], colTarget[2]) < tolerance ||\n      getColorDistance(col[0+(4*8)], col[1+(4*8)], col[2+(4*8)], colTarget[0], colTarget[1], colTarget[2]) < tolerance\n    ) {\n      return true;\n    }\n    return false;\n  }\n  public isMouseInsideByOffScreen(x: number, y: number, c: string) {\n    // const col = this.gcmd.annotationInstance.implementations.app.model.graphicsCoreWrapper.canvasWrapper.aCanvasOffScreen.GetColorByPos(x, y);\n    const col = this.pickColorOffscreen(x, y);\n    const shape = this.getShapeByHashCol(col);\n    if (shape && col === c) {\n      return true;\n    }\n    return false;\n  }\n\n  public getClosestNodeForSnapping(x: number, y: number, tor: number): AGeometryBase | undefined {\n    const mv = new NVector3(x, y);\n    let i = this.gcmd.annotationInstance.scene.listBasePoint.length;\n    let theIndex = -1;\n    while (i--) {\n      if (this.gcmd.annotationInstance.scene.listBasePoint[i].isCollapse) {\n        continue;\n      }\n\n      // only allow to snap for the mid point of arrow, not the polyline bending\n      if (this.gcmd.annotationInstance.scene.listBasePoint[i].type === GType.AMIDPOINT) {\n        const point = this.gcmd.annotationInstance.scene.listBasePoint[i] as APoint;\n        if (point.aEdges[0] && point.aEdges[0].pGraph.type === GType.POLYLINE_BENDING) {\n          continue;\n        }\n      }\n\n      const dis = getDistance(this.gcmd.annotationInstance.scene.listBasePoint[i].vec, mv);\n      if (dis < tor) {\n        tor = dis;\n        theIndex = i;\n      }\n    }\n\n    // ...... snap to rectangle and circle\n    i = this.gcmd.annotationInstance.scene.listARectangleWrapper.length;\n    while (i--) {\n      const shape = this.gcmd.annotationInstance.scene.listARectangleWrapper[i];\n      shape.updateLeaderlineSnap(mv, tor);\n      if (shape.vecSelectedSnapping) {\n        if (getDistance(shape.vecSelectedSnapping, mv) < 5) {\n          return shape;\n        }\n        shape.vecSelectedSnapping = undefined;\n      }\n    }\n    i = this.gcmd.annotationInstance.scene.listACircleWrapperr.length;\n    while (i--) {\n      const shape = this.gcmd.annotationInstance.scene.listACircleWrapperr[i];\n      shape.updateLeaderlineSnap(mv, tor);\n      if (shape.vecSelectedSnapping) {\n        if (getDistance(shape.vecSelectedSnapping, mv) < 5) {\n          return shape;\n        }\n        shape.vecSelectedSnapping = undefined;\n      }\n    }\n    // ...... end snap to rectangle and circle\n\n    if (theIndex > -1) {\n      return this.gcmd.annotationInstance.scene.listBasePoint[theIndex] as AGeometryBase;\n    }\n    i = this.gcmd.annotationInstance.scene.listAPolygonGraphWrapper.length;\n    while (i--) {\n      const pg = this.gcmd.annotationInstance.scene.listAPolygonGraphWrapper[i].getclosestNode(\n        mv,\n        tor\n      );\n      if (pg) {\n        return pg as AGeometryBase;\n      }\n    }\n    return undefined;\n  }\n  public pickColorsOffscreen(x: number, y: number, xRes: number = 1, yRes: number = 1) {\n    return this.gcmd.annotationInstance.renderer.ctxOffscreen.getImageData(x, y, xRes, yRes).data;\n  }\n  public pickColorOffscreen(x: number, y: number) {\n    const pixel = this.pickColorsOffscreen(x, y);\n    const col = `rgb(${pixel[0]},${pixel[1]},${pixel[2]})`;\n    return col;\n  }\n  public getSelGeo() {\n    const out = [];\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    while (i--) {\n      if (this.gcmd.annotationInstance.scene.geometryList[i].isSelected) {\n        out.push(this.gcmd.annotationInstance.scene.geometryList[i]);\n      }\n    }\n    return out;\n  }\n\n  public getGeoById(id: string) {\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    while (i--) {\n      if (this.gcmd.annotationInstance.scene.geometryList[i].id === id) {\n        return this.gcmd.annotationInstance.scene.geometryList[i];\n      }\n    }\n    return undefined;\n  }\n  public getRPointtById(id: string) {\n    let i = this.gcmd.annotationInstance.scene.listRPoint.length;\n    while (i--) {\n      if (this.gcmd.annotationInstance.scene.listRPoint[i].id === id) {\n        return this.gcmd.annotationInstance.scene.listRPoint[i];\n      }\n    }\n    return undefined;\n  }\n  public updateIconPoint(id: string, url: string) {\n    const p = this.getRPointtById(id);\n    if (p) {\n      p.updateIcon(url);\n      this.gcmd.gcmdSupporting.renderForce();\n    }\n  }\n  public duplicateByDragging() {\n    // console.log('copy needed');\n    if (this.gcmd.annotationInstance.scene.Capture) {\n      const geo = this.gcmd.annotationInstance.scene.Capture.deepCopy(\n        this.gcmd.annotationInstance.scene.Capture.vec.x,\n        this.gcmd.annotationInstance.scene.Capture.vec.y\n      );\n      this.gcmd.annotationInstance.scene.Capture.isHover = false;\n      this.gcmd.annotationInstance.scene.Capture.isSelected = false;\n      if (geo) {\n        geo.isHover = true;\n        this.gcmd.annotationInstance.scene.Capture = geo;\n      }\n    }\n    const geos = this.hasMultiSel();\n    if (geos !== undefined) {\n      for (const theGeo of geos) {\n        // if (theGeo.IsCaptured) { continue; }\n        theGeo.isSelected = false;\n        theGeo.isHover = false;\n        const g = theGeo.deepCopy(theGeo.vec.x, theGeo.vec.y);\n        if (g) {\n          g.isSelected = true;\n          g.isHover = true;\n        }\n      }\n    }\n  }\n  public getSelectedGeoIDs() {\n    const geo = [];\n    for (let i = 0; i < this.gcmd.annotationInstance.scene.geometryList.length; ++i) {\n      if (\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.ANODE_RECT ||\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.ANODE_CIRCLE\n      ) {\n        continue;\n      }\n      if (this.gcmd.annotationInstance.scene.geometryList[i].isSelectedValue) {\n        geo.push(this.gcmd.annotationInstance.scene.geometryList[i].id);\n      }\n    }\n    return geo;\n  }\n  public processingUpdate(id: string, data: string) {\n    const geo = this.getGeoById(id);\n    if (geo && geo.type === GType.TEXT_LEADERLINE) {\n      const txt = geo as ATextleaderlineWrapper;\n      txt.processingUpdate(data);\n    }\n  }\n  public removeByIDs(ids: string) {\n    const ioGeos: IOGeometry[] = [];\n    JSON.parse(ids).forEach((id: string) => {\n      const shape = this.getGeoById(id);\n      if (shape) {\n        const ioGeo = shape.toJSON();\n        if (ioGeo) {\n          ioGeos.push(ioGeo);\n          shape.remove(false); // we are going to emit them at once below!!\n        }\n      }\n    });\n    this.gcmd.annotationInstance.io.eventListenerAnnotation.removeGeometryStack(ioGeos);\n    this.gcmd.gcmdSupporting.renderForce();\n  }\n  public removeBeforeDump() {\n    this.gcmd.gcmdSelecting.deSelectAllObjects();\n    this.removeAllCapturedGeo();\n    let i = this.gcmd.annotationInstance.scene.listATextleaderlineWrapper.length;\n    while (i--) {\n      if (this.gcmd.annotationInstance.scene.listATextleaderlineWrapper[i]) {\n        this.gcmd.annotationInstance.scene.listATextleaderlineWrapper[i].removeDiv();\n      }\n    }\n\n    this.removeAllDiv();\n    this.resetGeometryList();\n  }\n  public reUndoProcessing(states: IOGeometry[]) {\n    this.removeBeforeDump();\n\n    states.forEach((geo: IOGeometry) => {\n      this.getGeoByIOGeometry(geo, true);\n    });\n\n    this.initConnectionTextleaderlines();\n    this.gcmd.annotationInstance.activeCommandController.acProperties.needExecuteOptimizer = true;\n    this.gcmd.gcmdSupporting.renderForce();\n  }\n  public reUndoProcessingStorymaps(states: Map<string, IOGeometry>) {\n    /* this is worng to remove the shapes, resulting in side effects(removing polyline by node), keep the comment!!!\n        let i = this.gcmd.annotationInstance.scene.geometryList.length;\n        while (i--) {\n          if (this.gcmd.annotationInstance.scene.geometryList[i]) {\n            this.gcmd.annotationInstance.scene.geometryList[i].Remove(false);\n          }\n        }\n        */\n    this.removeBeforeDump();\n\n    states.forEach((geo: IOGeometry) => {\n      this.getGeoByIOGeometry(geo, true);\n    });\n\n    this.initConnectionTextleaderlines();\n    this.gcmd.annotationInstance.activeCommandController.acProperties.needExecuteOptimizer = true;\n    this.gcmd.gcmdSupporting.renderForce();\n  }\n  public hide(ids: string[]) {\n    let l = ids.length;\n    while (l--) {\n      for (let i = 0; i < this.gcmd.annotationInstance.scene.geometryList.length; ++i) {\n        if (this.gcmd.annotationInstance.scene.geometryList[i].id === ids[l]) {\n          this.gcmd.annotationInstance.scene.geometryList[i].isRenderable = false;\n          this.gcmd.annotationInstance.scene.geometryList[i].isHidden = true;\n          this.gcmd.annotationInstance.scene.geometryList[i].visibility = 0;\n        }\n      }\n    }\n  }\n  public unhide(ids: string[]) {\n    let l = ids.length;\n    while (l--) {\n      for (let i = 0; i < this.gcmd.annotationInstance.scene.geometryList.length; ++i) {\n        if (this.gcmd.annotationInstance.scene.geometryList[i].id === ids[l]) {\n          this.gcmd.annotationInstance.scene.geometryList[i].isRenderable = true;\n          this.gcmd.annotationInstance.scene.geometryList[i].isHidden = false;\n          this.gcmd.annotationInstance.scene.geometryList[i].visibility = 1;\n        }\n      }\n    }\n  }\n  public setupPolylineConstraintLength(v: number) {\n    if (\n      this.gcmd.annotationInstance.scene.capture &&\n      this.gcmd.annotationInstance.scene.capture.type === GType.POLYLINE\n    ) {\n      const dis = (v + 1) * 50;\n      const pl = this.gcmd.annotationInstance.scene.capture as APolylineWrapper;\n      pl.constraintTargetDistance = dis;\n    }\n  }\n  public setupPolylineConstraintLengthPercentage(v: number) {\n    if (\n      this.gcmd.annotationInstance.scene.capture &&\n      this.gcmd.annotationInstance.scene.capture.type === GType.POLYLINE\n    ) {\n      const pl = this.gcmd.annotationInstance.scene.capture as APolylineWrapper;\n      pl.constraintTargetDistancePercentage = v;\n    }\n  }\n  public disableExcept(ids: string[]) {\n    const geometries = [];\n    for (let i = 0; i < ids.length; ++i) {\n      geometries.push(this.getGeoById(ids[i]));\n    }\n    for (let j = 0; j < geometries.length; ++j) {\n      for (let i = 0; i < this.gcmd.annotationInstance.scene.geometryList.length; ++i) {\n        if (this.gcmd.annotationInstance.scene.geometryList[i] === geometries[j]) {\n          this.gcmd.annotationInstance.scene.geometryList[i].disable = false;\n        } else {\n          this.gcmd.annotationInstance.scene.geometryList[i].disable = true;\n        }\n      }\n    }\n  }\n  public highlight(id: string) {\n    this.gcmd.annotationInstance.renderer.needFocus = true;\n    for (let i = 0; i < this.gcmd.annotationInstance.scene.geometryList.length; ++i) {\n      if (this.gcmd.annotationInstance.scene.geometryList[i].id === id) {\n        this.gcmd.annotationInstance.scene.geometryList[i].isSelected = true;\n        this.gcmd.annotationInstance.scene.geometryList[i].isHover = true;\n      } else {\n        this.gcmd.annotationInstance.scene.geometryList[i].isSelected = false;\n        this.gcmd.annotationInstance.scene.geometryList[i].isHover = false;\n      }\n    }\n  }\n  // ................................................... Object Snapping\n  public autoSnappingTracker(v: NVector3): boolean {\n    return this.gcmd.annotationInstance.renderer.objectSnapping.autoSnappingTracker(v, false);\n  }\n  public autoSnapping(v: NVector3): boolean {\n    return this.gcmd.annotationInstance.renderer.objectSnapping.autoSnappingTracker(v, true);\n  }\n  // ................................................... Object Snapping\n  public getPosBySnapping(x: number, y: number, tolerance: number) {\n    let dis = 15; // Number.MAX_SAFE_INTEGER;\n    let tempTarget = new NVector3(x, y);\n    const temp = new NVector3(x, y);\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    while (i--) {\n      const theDis = this.gcmd.annotationInstance.scene.geometryList[i].needSnapping(temp);\n      if (theDis[0] && theDis[1] && theDis[0] > 0 && theDis[0] < dis) {\n        dis = theDis[0] as number;\n        tempTarget = theDis[1] as NVector3;\n      }\n    }\n    if (dis < tolerance) {\n      x = tempTarget.x;\n      y = tempTarget.y;\n    }\n    return [x, y];\n  }\n  public repopulateGeometries(d: IOGeometry[]) {\n    this.removeAll();\n    for (const i in d) {\n      if (d[i]) {\n        const geo = d[i];\n        this.getGeoByIOGeometry(geo, false, true);\n      }\n    }\n    this.initConnectionTextleaderlines();\n    this.gcmd.gcmdSupporting.renderForce();\n  }\n  public removeAll(needEmit?: boolean) {\n    let i = this.gcmd.annotationInstance.scene.listATextleaderlineWrapper.length;\n    while (i--) {\n      if (this.gcmd.annotationInstance.scene.listATextleaderlineWrapper[i]) {\n        this.gcmd.annotationInstance.scene.listATextleaderlineWrapper[i].removeDiv();\n      }\n    }\n    i = this.gcmd.annotationInstance.scene.geometryList.length;\n    while (i--) {\n      if (this.gcmd.annotationInstance.scene.geometryList[i]) {\n        this.gcmd.annotationInstance.scene.geometryList[i].remove(needEmit);\n      }\n    }\n\n    this.removeAllDiv();\n    this.resetGeometryList();\n\n    this.gcmd.gcmdSupporting.renderForce();\n  }\n  public removeAllDiv() {\n    for (\n      let i = 0;\n      i <\n      this.gcmd.annotationInstance.implementations.app.model.modelViewWrapper.div\n        .childElementCount;\n      ++i\n    ) {\n      // console.log(i);\n      if (\n        this.gcmd.annotationInstance.implementations.app.model.modelViewWrapper.div\n          .lastChild &&\n        this.gcmd.annotationInstance.implementations.app.model.modelViewWrapper.div\n          .lastChild instanceof HTMLDivElement\n      ) {\n        this.gcmd.annotationInstance.implementations.app.model.modelViewWrapper.div.lastChild.remove();\n      }\n    }\n  }\n  public removeAllPopup() {\n    for (\n      let i = 0;\n      i <\n      this.gcmd.annotationInstance.implementations.app.model.modelViewWrapper.div\n        .childElementCount;\n      ++i\n    ) {\n      if (\n        this.gcmd.annotationInstance.implementations.app.model.modelViewWrapper.div\n          .lastChild &&\n        this.gcmd.annotationInstance.implementations.app.model.modelViewWrapper.div\n          .lastChild instanceof HTMLDivElement\n      ) {\n        //\n        const id = this.gcmd.annotationInstance.implementations.app.model.modelViewWrapper.div.lastChild.id;\n        if (id.includes('pa')) {\n          this.gcmd.annotationInstance.implementations.app.model.modelViewWrapper.div.lastChild.remove();\n        }\n      }\n    }\n    // console.log('...............RemoveAllPopup');\n    for (let i = 0; i < this.gcmd.annotationInstance.scene.geometryList.length; ++i) {\n      if (this.gcmd.annotationInstance.scene.geometryList[i].hasPopup) {\n        this.gcmd.annotationInstance.scene.geometryList[i].hidePopUpSummary();\n      }\n    }\n  }\n  public initConnectionTextleaderlines() {\n    let i = this.gcmd.annotationInstance.scene.listATextleaderlineWrapper.length;\n    while (i--) {\n      if (\n        this.gcmd.annotationInstance.scene.listATextleaderlineWrapper[i].leaderline !== undefined\n      ) {\n        // let j = this.gcmd.annotationInstance.scene.listAPoint.length;\n        // while (--j) {\n        //     if (this.gcmd.annotationInstance.scene.listATextLeaderlineWrapper[i].leaderline.v2.Distance(this.gcmd.annotationInstance.scene.listAPoint[j].vec)) {\n        this.gcmd.annotationInstance.scene.listATextleaderlineWrapper[i].initSnapForPointForUndo();\n        //     }\n        // }\n      }\n    }\n  }\n  public resetGeometryList() {\n    // CUIRenderer.list = [];\n    this.gcmd.annotationInstance.scene.geometryList = [];\n\n    // ........................... annotation\n    this.gcmd.annotationInstance.scene.listATextleaderlineWrapper = [];\n\n    // this.gcmd.annotationInstance.scene.listAText = [];\n    this.gcmd.annotationInstance.scene.listBasePoint = [];\n    this.gcmd.annotationInstance.scene.listAPoint = [];\n    this.gcmd.annotationInstance.scene.listAArrow = [];\n    this.gcmd.annotationInstance.scene.listIPoint = [];\n    this.gcmd.annotationInstance.scene.listRPoint = [];\n    this.gcmd.annotationInstance.scene.listNPoint = [];\n    this.gcmd.annotationInstance.scene.listACircleWrapperr = [];\n    this.gcmd.annotationInstance.scene.listARectangleWrapper = [];\n    this.gcmd.annotationInstance.scene.listAPolylineWrapper = [];\n    this.gcmd.annotationInstance.scene.listAPolygonGraphWrapper = [];\n    this.gcmd.annotationInstance.scene.listAPolygonWrapper = [];\n    this.gcmd.annotationInstance.scene.listAPolylineGraphWrapper = [];\n\n    this.gcmd.annotationInstance.scene.listACurve = [];\n\n    // ........................... Guided Tour\n\n    this.gcmd.annotationInstance.scene.listALog = [];\n    // APolygonMultple.list = [];\n  }\n  public removeCapturedTextLeaderline() {\n    let i = this.gcmd.annotationInstance.scene.listATextleaderlineWrapper.length;\n    while (i--) {\n      if (this.gcmd.annotationInstance.scene.listATextleaderlineWrapper[i].isSelected) {\n        this.gcmd.annotationInstance.scene.listATextleaderlineWrapper[i].remove();\n      }\n    }\n    this.gcmd.gcmdSupporting.renderForce();\n  }\n  public DumpByIGeometriesFromImageDataModel(geometries: any) {\n    // console.log(geometries)\n    for (let i = 0 ; i < geometries.length; ++i) {\n      this.getGeoByIOGeometry(geometries[i] as IOGeometry, true);\n    }\n\n  }\n  public DumpByIGeometries(geometries: IOGeometry[]) {\n\n    for (let i = 0 ; i < geometries.length; ++i) {\n      this.getGeoByIOGeometry(geometries[i], true);\n    }\n\n  }\n  public getGeoByIOGeometry(geo: IOGeometry, isUndo = false, isDeepCopy = false) {\n    if (geo === undefined) {\n      return;\n    }\n    // console.log(geo, isUndo)\n    if (geo.type === GType.POINT_REGULAR) {\n      APointRegularWrapper.fromJSON(this.gcmd.annotationInstance.scene, geo, isUndo, isDeepCopy);\n    } else if (geo.type === GType.POINT_NUMBERED) {\n      APointNumberedWrapper.FromJSON(this.gcmd.annotationInstance.scene, geo, isUndo, isDeepCopy);\n    } else if (geo.type === GType.CIRCLE) {\n      ACircleWrapper.fromJSON(this.gcmd.annotationInstance.scene, geo, isUndo, isDeepCopy);\n    } else if (geo.type === GType.RECTANGLE) {\n      ARectangleWrapper.fromJSON(this.gcmd.annotationInstance.scene, geo, isUndo, isDeepCopy);\n    } else if (geo.type === GType.POLYLINE) {\n      APolylineWrapper.fromJSON(this.gcmd.annotationInstance.scene, geo, isUndo, isDeepCopy);\n    } else if (geo.type === GType.POLYLINE_BENDING) {\n      APolylineGraphWrapper.fromJSON(this.gcmd.annotationInstance.scene, geo, isUndo, isDeepCopy);\n    } else if (geo.type === GType.POLYGON) {\n      APolygonWrapper.fromJSON(this.gcmd.annotationInstance.scene, geo, isUndo, isDeepCopy);\n    } else if (geo.type === GType.POLYGON_GRAPH) {\n      APolygonGraphWrapper.fromJSON(this.gcmd.annotationInstance.scene, geo, isUndo, isDeepCopy);\n    } else if (geo.type === GType.POINT_ICON) {\n      APointIconWrapper.fromJSON(this.gcmd.annotationInstance.scene, geo, isUndo, isDeepCopy);\n    } else if (geo.type === GType.ARROW_SINGLE) {\n      AArrow.fromJSON(this.gcmd.annotationInstance.scene, geo, isUndo, isDeepCopy, true);\n    } else if (geo.type === GType.ARROW_DOUBLE) {\n      AArrow.fromJSON(this.gcmd.annotationInstance.scene, geo, isUndo, isDeepCopy, false);\n    } else if (geo.type === GType.CURVE_OPEN) {\n      ACurve.fromJSON(this.gcmd.annotationInstance.scene, geo, isUndo, isDeepCopy);\n    } else if (geo.type === GType.CURVE_CLOSE) {\n      ACurve.fromJSON(this.gcmd.annotationInstance.scene, geo, isUndo, isDeepCopy, true);\n      // } else if (geo.type === GType.TEXT) {\n      //   AText.FromJSON(this.gcmd.annotationInstance.scene, geo, isUndo, isDeepCopy);\n    } else if (geo.type === GType.TEXT_LEADERLINE) {\n      ATextleaderlineWrapper.fromJSON(this.gcmd.annotationInstance.scene, geo, isUndo, isDeepCopy);\n    }\n  }\n  public hasMultiSel() {\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    const out = [];\n    while (i--) {\n      if (!this.gcmd.annotationInstance.scene.geometryList[i].isUnderConstruction) {\n        if (this.gcmd.annotationInstance.scene.geometryList[i].isSelectedValue) {\n          out.push(this.gcmd.annotationInstance.scene.geometryList[i]);\n          //   this.gcmd.annotationInstance.renderer.needFocus = true;\n        }\n      }\n    }\n    if (out) {\n      this.gcmd.annotationInstance.scene.captureMultiple = out;\n      return out;\n    }\n    this.gcmd.annotationInstance.scene.captureMultiple = undefined;\n    return undefined;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public updateStyleCustom(styles: any): void {\n    const ioGeometries: IOGeometry[] = [];\n    for (let j = 0; j < styles.length; ++j) {\n      for (let i = 0; i < this.gcmd.annotationInstance.scene.geometryList.length; ++i) {\n        const geo = this.gcmd.annotationInstance.scene.geometryList[i];\n        if (geo.id === styles[j].id) {\n          // console.log(styles[j]);\n          if (geo.updateStyleCustom(styles[j].style)) {\n            const jsonData = geo.toJSON();\n            if (jsonData) {\n              ioGeometries.push(jsonData);\n            }\n          }\n        }\n      }\n    }\n    if (ioGeometries.length > 0) {\n      // console.log(ioGeometries)\n      this.gcmd.annotationInstance.io.eventListenerAnnotation.transformStack(ioGeometries);\n    }\n    this.gcmd.gcmdSupporting.renderForce();\n  }\n  public setSizeRPoint(size: Size) {\n    for (let i = 0; i < this.gcmd.annotationInstance.scene.listRPoint.length; ++i) {\n      this.gcmd.annotationInstance.scene.listRPoint[i].size = size;\n    }\n    this.gcmd.annotationInstance.geometryCommon.gcmdSupporting.renderForce();\n  }\n  public setRenderTypePoint(renderType: PointRenderType | string) {\n    // console.log(PointRenderType.hasOwnProperty(renderType));\n    // console.log(renderType);\n\n    // eslint-disable-next-line no-prototype-builtins\n    if (PointRenderType.hasOwnProperty(renderType)) {\n      for (let i = 0; i < this.gcmd.annotationInstance.scene.listRPoint.length; ++i) {\n        this.gcmd.annotationInstance.scene.listRPoint[\n          i\n        ].renderer.pointRenderType = renderType as PointRenderType;\n        this.gcmd.annotationInstance.scene.listRPoint[i].styleComponent.renderStyle.url = '';\n      }\n    } else if (typeof renderType === 'string') {\n      for (let i = 0; i < this.gcmd.annotationInstance.scene.listRPoint.length; ++i) {\n        this.gcmd.annotationInstance.scene.listRPoint[i].renderer.pointRenderType =\n          PointRenderType.Image;\n        this.gcmd.annotationInstance.scene.listRPoint[\n          i\n        ].styleComponent.renderStyle.url = renderType;\n      }\n    }\n    this.gcmd.annotationInstance.geometryCommon.gcmdSupporting.renderForce();\n  }\n  public findAtPointFromAPoint(e: MouseEventData): APointBase | undefined {\n    for (let i = this.gcmd.annotationInstance.scene.listBasePoint.length - 1; i >= 0; --i) {\n      // find overlapping shapes such as a point inside of circle\n      if (\n        this.gcmd.annotationInstance.scene.listBasePoint[i].isSelectable &&\n        this.gcmd.annotationInstance.scene.listBasePoint[i].isMouseInside(e.x, e.y)\n      ) {\n        return this.gcmd.annotationInstance.scene.listBasePoint[i];\n      }\n    }\n    return undefined;\n  }\n  public findAtPointFromPolygonGraph(e: MouseEventData): AGeometryBase | undefined {\n    // const mv = new NVector3(e.x, e.y);\n    for (\n      let i = this.gcmd.annotationInstance.scene.listAPolygonGraphWrapper.length - 1;\n      i >= 0;\n      --i\n    ) {\n      // find overlapping shapes such as a point inside of circle\n      if (this.gcmd.annotationInstance.scene.listAPolygonGraphWrapper[i].isSelectable) {\n        const v = this.gcmd.annotationInstance.scene.listAPolygonGraphWrapper[i].getVecForSnapping();\n        if (v !== undefined) {\n          return this.gcmd.annotationInstance.scene.listAPolygonGraphWrapper[i] as AGeometryBase;\n        }\n        this.gcmd.annotationInstance.scene.listAPolygonGraphWrapper[i].graphCore.selVec = undefined;\n        this.gcmd.annotationInstance.scene.listAPolygonGraphWrapper[i].graphCore.selectedVec = undefined;\n        this.gcmd.annotationInstance.scene.listAPolygonGraphWrapper[i].graphCore.selVecForTextLeaderline = undefined;\n      }\n    }\n    return undefined;\n  }\n  public findAtPointByTouch(e: MouseEventData) {\n    // console.log('FindAtPointByTouch');\n    // console.trace();\n    let closestGeo: AGeometryBase[] = [];\n    for (let i = this.gcmd.annotationInstance.scene.geometryList.length - 1; i >= 0; --i) {\n      // find overlapping shapes such as a point inside of circle\n      // console.log(this.gcmd.annotationInstance.scene.geometryList[i])\n      // ......... to select RPoint by clicking bottom area of the icon\n      if (this.gcmd.annotationInstance.scene.geometryList[i].type === GType.POINT_REGULAR) {\n        if (\n          (this.gcmd.annotationInstance.scene.geometryList[i].isSelectable &&\n            this.gcmd.annotationInstance.scene.geometryList[i].isHoverValue) ||\n          this.gcmd.annotationInstance.scene.geometryList[i].isMouseInside(e.x, e.y)\n        ) {\n          closestGeo.push(this.gcmd.annotationInstance.scene.geometryList[i]);\n        }\n      } else {\n        // ......... to select other shapes,except RPoint\n        if (\n          this.gcmd.annotationInstance.scene.geometryList[i].isSelectable &&\n          // this.gcmd.annotationInstance.scene.geometryList[i].isHover && // this is for R Point as a safe guard\n          this.gcmd.annotationInstance.scene.geometryList[i].isMouseInside(e.x, e.y)\n        ) {\n          // if (\n          //   this.gcmd.annotationInstance.scene.geometryList[i].type === GType.POLYGON || this.gcmd.annotationInstance.scene.geometryList[i].type === GType.POLYGON_GRAPH ||\n          //   this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CIRCLE || this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CCURVE_CLOSED ||\n          //   this.gcmd.annotationInstance.scene.geometryList[i].type === GType.RECTANGLE ||\n          //   this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CN_GON || this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CN_STAR ||\n          //   this.gcmd.annotationInstance.scene.geometryList[i].type === GType.POLYGON_MULTIPLE\n          // ) {\n          closestGeo.push(this.gcmd.annotationInstance.scene.geometryList[i]);\n          // } else {\n          //   closedGeo.push(this.gcmd.annotationInstance.scene.geometryList[i]);\n          //   // return this.gcmd.annotationInstance.scene.geometryList[i];\n          // }\n        }\n      }\n    }\n\n    // additional operation for checking and collecting the selected points based on tolerance.\n    const tolerance = 50;\n    const pointList = [];\n    for (let i = 0; i < this.gcmd.annotationInstance.scene.listNPoint.length; ++i) {\n      const dis = this.gcmd.annotationInstance.scene.listNPoint[i].isMouseInsideWithTolerance(\n        e.x,\n        e.y,\n        tolerance\n      );\n      if (dis) {\n        pointList.push(this.gcmd.annotationInstance.scene.listNPoint[i]);\n      }\n    }\n    for (let i = 0; i < this.gcmd.annotationInstance.scene.listRPoint.length; ++i) {\n      const dis = this.gcmd.annotationInstance.scene.listRPoint[i].isMouseInsideWithTolerance(\n        e.x,\n        e.y,\n        tolerance\n      );\n      if (dis) {\n        pointList.push(this.gcmd.annotationInstance.scene.listRPoint[i]);\n      }\n    }\n    // find the point with in the shortest distances and push it to the closedGeo list.\n    // console.log('pointList', pointList);\n    if (pointList.length > 0) {\n      let id = -1;\n      let dis = Number.MAX_SAFE_INTEGER;\n      for (let i = 0; i < pointList.length; ++i) {\n        const theDis = pointList[i].distance(e.x, e.y + 11 * pointList[i].scaleForRender);\n        if (theDis < dis) {\n          dis = theDis;\n          id = i;\n        }\n        closestGeo = [pointList[id]];\n      }\n    }\n    // console.log('the closest one', closestGeo);\n    // additional operation ends\n\n    // console.log(closedGeo);\n    // check overlapping solid shapes\n    let needOnlyArea = false;\n    if (closestGeo.length > 1) {\n      for (let i = 0; i < closestGeo.length; ++i) {\n        if (\n          closestGeo[i].type === GType.CIRCLE ||\n          closestGeo[i].type === GType.RECTANGLE ||\n          closestGeo[i].type === GType.POLYLINE ||\n          closestGeo[i].type === GType.POLYGON ||\n          closestGeo[i].type === GType.POLYGON_GRAPH ||\n          closestGeo[i].type === GType.CN_GON ||\n          closestGeo[i].type === GType.CN_STAR\n        ) {\n          needOnlyArea = true;\n        }\n      }\n    }\n    // console.log(closedGeo);\n    const areas: number[] = [];\n    if (needOnlyArea) {\n      // circle / rectangle based on area\n      for (let i = 0; i < closestGeo.length; ++i) {\n        areas.push(Math.abs(closestGeo[i].getArea()));\n      }\n      return closestGeo[findIndexOfMin(areas)];\n    }\n    // check overlapping solid shapes\n\n    // ............ for distance driven for points .......... not implement yet\n    for (let i = 0; i < closestGeo.length; ++i) {\n      if (closestGeo[i].isSelectable && closestGeo[i].isMouseInside(e.x, e.y)) {\n        return closestGeo[i];\n      }\n    }\n    // ............ for distance driven for points end\n\n    return undefined;\n  }\n  public findAtPoint(e: MouseEventData): AGeometryBase | undefined {\n    // console.log('FindAtPoint');\n    // console.trace();\n    const closestGeo: AGeometryBase[] = [];\n    for (let i = this.gcmd.annotationInstance.scene.geometryList.length - 1; i >= 0; --i) {\n      // find overlapping shapes such as a point inside of circle\n      // console.log(this.gcmd.annotationInstance.scene.geometryList[i])\n      // ......... to select RPoint by clikcing bottom area of the icon\n      if (this.gcmd.annotationInstance.scene.geometryList[i].type === GType.POINT_REGULAR) {\n        if (\n          (this.gcmd.annotationInstance.scene.geometryList[i].isSelectable &&\n            this.gcmd.annotationInstance.scene.geometryList[i].isHoverValue) ||\n          this.gcmd.annotationInstance.scene.geometryList[i].isMouseInside(e.x, e.y)\n        ) {\n          if (\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.POLYGON ||\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.POLYGON_GRAPH ||\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CIRCLE ||\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CCURVE_CLOSED ||\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.RECTANGLE ||\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CN_GON ||\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CN_STAR ||\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.POLYGON_MULTIPLE\n          ) {\n            closestGeo.push(this.gcmd.annotationInstance.scene.geometryList[i]);\n          } else {\n            return this.gcmd.annotationInstance.scene.geometryList[i];\n          }\n        }\n      } else {\n        // ......... to select other shapes,except RPoint\n        if (\n          this.gcmd.annotationInstance.scene.geometryList[i].isSelectable &&\n          // this.gcmd.annotationInstance.scene.geometryList[i].isHover && // this is for R Point as a safe guard\n          this.gcmd.annotationInstance.scene.geometryList[i].isMouseInside(e.x, e.y)\n        ) {\n          if (\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.POLYGON ||\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.POLYGON_GRAPH ||\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CIRCLE ||\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CCURVE_CLOSED ||\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.RECTANGLE ||\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CN_GON ||\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CN_STAR ||\n            this.gcmd.annotationInstance.scene.geometryList[i].type === GType.POLYGON_MULTIPLE\n          ) {\n            closestGeo.push(this.gcmd.annotationInstance.scene.geometryList[i]);\n          } else {\n            return this.gcmd.annotationInstance.scene.geometryList[i];\n          }\n        }\n      }\n    }\n    // console.log(closedGeo);\n    // check overlapping solid shapes\n    let needOnlyArea = false;\n    if (closestGeo.length > 1) {\n      for (let i = 0; i < closestGeo.length; ++i) {\n        if (\n          closestGeo[i].type === GType.CIRCLE ||\n          closestGeo[i].type === GType.RECTANGLE ||\n          closestGeo[i].type === GType.POLYLINE ||\n          closestGeo[i].type === GType.POLYGON ||\n          closestGeo[i].type === GType.POLYGON_GRAPH ||\n          closestGeo[i].type === GType.CN_GON ||\n          closestGeo[i].type === GType.CN_STAR\n        ) {\n          needOnlyArea = true;\n        }\n      }\n    }\n    // console.log(closedGeo);\n    const areas: number[] = [];\n    if (needOnlyArea) {\n      // circle / rectangle based on area\n      for (let i = 0; i < closestGeo.length; ++i) {\n        areas.push(Math.abs(closestGeo[i].getArea()));\n      }\n      return closestGeo[findIndexOfMin(areas)];\n    }\n    // check overlapping solid shapes\n\n    // ............ for distance driven for points .......... not implement yet\n    for (let i = 0; i < closestGeo.length; ++i) {\n      if (closestGeo[i].isSelectable && closestGeo[i].isMouseInside(e.x, e.y)) {\n        return closestGeo[i];\n      }\n    }\n    // ............ for distance driven for points end\n\n    return undefined;\n  }\n  public hasSelectedOvered() {\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    while (i--) {\n      if (\n        this.gcmd.annotationInstance.scene.geometryList[i].isSelected ||\n        this.gcmd.annotationInstance.scene.geometryList[i].isHoverValue\n      ) {\n        return true;\n      }\n    }\n    return false;\n  }\n  public doneDragging() {\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    while (i--) {\n      if (this.gcmd.annotationInstance.scene.geometryList[i].isDrag === true) {\n        this.gcmd.annotationInstance.scene.geometryList[i].isDrag = false;\n      }\n    }\n  }\n  public removeAllCapturedGeo() {\n    this.gcmd.gcmdSupporting.renderForce();\n    let c = this.gcmd.annotationInstance.scene.listBasePoint.length;\n    while (c--) {\n      if (\n        this.gcmd.annotationInstance.scene.listBasePoint[c] &&\n        this.gcmd.annotationInstance.scene.listBasePoint[c].isSelected === true\n      ) {\n        this.gcmd.annotationInstance.scene.listBasePoint[c].remove();\n      }\n    }\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    if (i === 0) {\n      return;\n    }\n    while (i--) {\n      if (\n        this.gcmd.annotationInstance.scene.geometryList[i] === undefined ||\n        this.gcmd.annotationInstance.scene.geometryList[i] === null\n      ) {\n        continue;\n      }\n      if (this.gcmd.annotationInstance.scene.geometryList[i].isSelected === true) {\n        // || this.gcmd.annotationInstance.scene.geometryList [i].isHover) {\n        if (this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CLINE) {\n          // this.gcmd.annotationInstance.scene.geometryList [i].p0 =null;\n          // this.gcmd.annotationInstance.scene.geometryList [i].p1 =null;\n          this.gcmd.annotationInstance.scene.geometryList[i].remove();\n          // this.gcmd.annotationInstance.scene.geometryList [i].GoToBlackhole()\n        } else {\n          this.gcmd.annotationInstance.scene.geometryList[i].remove();\n          // this.gcmd.annotationInstance.scene.geometryList [i].GoToBlackhole()\n        }\n      }\n    }\n    for (const g of this.gcmd.annotationInstance.scene.geometryList) {\n      if (g.isSelected === true) {\n        g.isSelected = false;\n      }\n    }\n  }\n  public reorderNumberedPoints(ids: string[]) {\n    // console.log(ids);\n    for (let j = 0; j < this.gcmd.annotationInstance.scene.listNPoint.length; ++j) {\n      this.gcmd.annotationInstance.scene.listNPoint[j].numberIndexNeeded = true;\n    }\n    // for (let i = 0 ; i < ids.length; ++i) {\n    //   for (let j = 0; j < this.gcmd.annotationInstance.scene.listNPoint.length; ++j) {\n    //     if(this.gcmd.annotationInstance.scene.listNPoint[j].numberIndexNeeded) {\n    //       if(ids[i] === this.gcmd.annotationInstance.scene.listNPoint[j].id) {\n    //         this.gcmd.annotationInstance.scene.listNPoint[j].numberIndexNeeded = false;\n    //         this.gcmd.annotationInstance.scene.listNPoint[j].numberIndex = i + 1;\n    //       }\n    //     }\n    //   }\n    // }\n\n    // let listIGeo: IOGeometry[] = [];\n    // let idnew = [];\n    const list = [];\n    let num = 1;\n    while (ids.length) {\n      const id = ids[0];\n      ids.shift();\n      for (let j = 0; j < this.gcmd.annotationInstance.scene.listNPoint.length; ++j) {\n        if (this.gcmd.annotationInstance.scene.listNPoint[j].numberIndexNeeded) {\n          if (this.gcmd.annotationInstance.scene.listNPoint[j].id === id) {\n            this.gcmd.annotationInstance.scene.listNPoint[j].numberIndexNeeded = false;\n            this.gcmd.annotationInstance.scene.listNPoint[j].numberIndex = num++;\n            list.push(this.gcmd.annotationInstance.scene.listNPoint[j]);\n            // idnew.push(id);\n            // const igeo = this.gcmd.annotationInstance.scene.listNPoint[j].ToJSON();\n            // if (igeo) { listIGeo.push(); }\n          }\n        }\n      }\n    }\n    // console.log(idnew);\n    // console.log(list);\n    this.gcmd.annotationInstance.scene.listNPoint = list;\n    // this.gcmd.annotationInstance.io.eventListenerAnnotation.TransformStack(listIGeo);\n  }\n  public removeAllCapturedGeoGroup() {\n    if (this.gcmd.annotationInstance.scene.capture) {\n      if (this.gcmd.annotationInstance.scene.capture.type && this.gcmd.annotationInstance.scene.capture.type === GType.POLYGON_GRAPH) {\n        const polygon = this.gcmd.annotationInstance.scene.capture as APolygonGraphWrapper;\n        if (polygon.graphCore.selVec) {\n          // it only happens after selecting a node, to remove a node of polygon\n          this.gcmd.annotationInstance.scene.capture.remove(false);\n          return;\n        }\n      }\n      if (this.gcmd.annotationInstance.scene.capture.type && this.gcmd.annotationInstance.scene.capture.type === GType.ANODE) {\n        this.gcmd.annotationInstance.scene.capture.remove();\n        return;\n      }\n    }\n\n    const hasMultisel = this.hasMultiSel();\n\n    if (\n      this.gcmd.annotationInstance.scene.capture &&\n      this.gcmd.annotationInstance.scene.capture.type === GType.TEXT_LEADERLINE\n    ) {\n      const txt = this.gcmd.annotationInstance.scene.capture as ATextleaderlineWrapper;\n      if (txt.isSelectedReaderlineByClick && txt.leaderline) {\n        if (txt.IsSelectedReaderline) {\n          txt.removeLeaderline();\n        }\n        return;\n      }\n    }\n\n    const ioGeos: IOGeometry[] = [];\n    if (hasMultisel) {\n      hasMultisel.forEach((g: AGeometryBase) => {\n        // Polygon Graph need different pipeline\n        if (g.type === GType.POLYGON_GRAPH) {\n          const pg = g as APolygonGraphWrapper;\n\n          if (pg.graphCore.selVec) {\n            pg.remove(false);\n          } else {\n            const ioGeo = g.toJSON();\n            if (ioGeo) {\n              ioGeos.push(ioGeo);\n              g.remove(false);\n            }\n          }\n        } else {\n          const ioGeo = g.toJSON();\n          if (ioGeo) {\n            ioGeos.push(ioGeo);\n            g.remove(false);\n          }\n        }\n      });\n    }\n    this.gcmd.annotationInstance.io.eventListenerAnnotation.removeGeometryStack(ioGeos);\n    this.gcmd.gcmdSupporting.renderForce();\n  }\n  public transformStack() {\n    if (\n      this.gcmd.annotationInstance.implementations.app.model.appCoreWrapper.appControllerStatus\n        .mode !== InteractionMode.Drawing ||\n      this.gcmd.annotationInstance.activeCommandController.acProperties.isPanning\n    ) {\n      return;\n    }\n\n    const shapesRemove: IOGeometry[] = [];\n    const shapesTransformation: IOGeometry[] = [];\n\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    while (i--) {\n      const g = this.gcmd.annotationInstance.scene.geometryList[i];\n      // console.log(' tt',g.isMoved);\n      // debugger;\n      if (g.isSelected || g.isCapturedValue || g.isTransform) {\n        if (g.isUnderConstruction) {\n          continue;\n        }\n        if (g.isTransform) {\n          if (g.type === GType.TEXT_LEADERLINE) {\n            const textleaderline = g as ATextleaderlineWrapper;\n            // console.log(textleaderline.attachedShape);\n            if (!textleaderline.attachedShape) {\n              const ioGeo = g.toJSON();\n              if (ioGeo) {\n                shapesRemove.push(ioGeo);\n                shapesTransformation.push(ioGeo);\n                g.isTransform = false;\n              }\n            } else {\n              const ioGeo = g.toJSON();\n              if (ioGeo) {\n                // shapesRemove.push(ioGeo); no needed for transformation\n                shapesTransformation.push(ioGeo);\n                g.isTransform = false;\n              }\n            }\n          } else {\n            const ioGeo = g.toJSON();\n            if (ioGeo) {\n              // console.log(ioGeo)\n              shapesRemove.push(ioGeo);\n              shapesTransformation.push(ioGeo);\n            }\n            g.isTransform = false;\n          }\n\n          // this.gcmd.annotationInstance.implementations.app.model.ioWrapper.eventListener.TransformStack(g.ToJSON());\n        }\n\n        // const d = this.scene.gcmd.annotationInstance.geometryCommon.ToMap(this.vec.x, this.vec.y);\n        // this.vec.long = d[0]; this.vec.lat = d[1];\n        // this.vecsHistory.push(this.vec);\n        // if (g.type === GType.POINT_REGULAR || g.type === GType.POINT_ICON || g.type === GType.POINT_NUMBERED) {\n        //     g.vecsHistory.push(g.vec.Clone());\n        // } else if (g.type === GType.POLYGON || g.type === GType.POLYLINE || g.type === GType.POLYLINE_BENDING) {\n        g.updateVecsHistory();\n        // }\n\n        // ........................... start // this is only for ALine\n        if (g.type === GType.ALINE) {\n          const ioGeo = g.toJSON();\n          if (ioGeo) {\n            shapesRemove.push(ioGeo);\n          }\n          // this.annotationInstance.implementations.app.model.ioWrapper.eventListener.TransformStack(g.ToJSON());\n        }\n        // ........................... end // this is only for ALine\n      }\n    }\n\n    if (this.gcmd.annotationInstance.renderer.blackhole && this.gcmd.annotationInstance.renderer.blackhole.isActive) {\n      const dis = getDistance(\n        this.gcmd.annotationInstance.renderer.blackhole.v,\n        new NVector3(\n          this.gcmd.annotationInstance.activeCommandController.m.x,\n          this.gcmd.annotationInstance.activeCommandController.m.y,\n          0\n        )\n      );\n      if (dis < this.gcmd.annotationInstance.renderer.blackhole.radius) {\n        this.gcmd.annotationInstance.renderer.blackhole.removeSelectedShapesByBlackhole(\n          shapesRemove\n        );\n        return;\n      }\n    }\n    // console.log(shapesTransformation);\n    if (shapesTransformation.length > 0) {\n      this.gcmd.annotationInstance.io.eventListenerAnnotation.transformStack(shapesTransformation);\n    }\n    i = this.gcmd.annotationInstance.scene.geometryList.length;\n    while (i--) {\n      this.gcmd.annotationInstance.scene.geometryList[i].isTransform = false;\n    }\n  }\n  public undo() {\n    this.gcmd.annotationInstance.scene.undo();\n  }\n  public redo() {\n    this.gcmd.annotationInstance.scene.redo();\n  }\n  public emitSelections() {\n    const data = this.gcmd.gcmdSelecting.getCapturedGeometries()\n    // this.gcmd.gcmdSelecting.deSelectCaptureObjects\n    // console.log(data);\n    this.gcmd.annotationInstance.io.emitAction(`select-shapes@${JSON.stringify(data)}`)\n  }\n  public updateColorStyle(color: number[]) {\n    for (let i = 0 ; i < this.gcmd.annotationInstance.scene.geometryList.length; ++i) {\n      if (this.gcmd.annotationInstance.scene.geometryList[i].isSelected) {\n        this.gcmd.annotationInstance.scene.geometryList[i].updateColor(color);\n      }\n    }\n    this.gcmd.annotationInstance.graphicsCoreWrapper.renderForce();\n  }\n}\n","import { IOGeometry } from '../../../../lib/Extended/GeometryUtility';\nimport {\n  ActiveCommandMode,\n  GType,\n  NVector3\n} from '../../../../lib';\nimport { GeometryCommon } from '.';\nexport class GeometryCommonSelecting {\n\n  public gcmd: GeometryCommon;\n\n  constructor(gcmd: GeometryCommon) {\n    this.gcmd = gcmd;\n  }\n  public selecteObjectsByVecs(vs: NVector3[], isWindow = false) {\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    const ids = [];\n    while (i--) {\n      // if (this.gcmd.annotationInstance.scene.geometryList [i].type !== GType.NODE) continue;A\n      if (this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CBLACKHOLE) {\n        continue;\n      }\n      if (this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CNODE) {\n        continue;\n      }\n      if (\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.ANODE ||\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.ANODE_CIRCLE ||\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.AMIDPOINT ||\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.ANODE_RECT ||\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.AN_GON ||\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.ANODE_TEXT\n      ) {\n        continue;\n      }\n\n      if (this.gcmd.annotationInstance.scene.geometryList[i].isSelectedByWindow(vs)) {\n        this.gcmd.annotationInstance.scene.geometryList[i].isSelectedValue = true;\n        ids.push(this.gcmd.annotationInstance.scene.geometryList[i].id);\n      }\n      // this.gcmd.annotationInstance.scene.geometryList [i].IsSelected = true;\n    }\n    this.gcmd.annotationInstance.io.eventListenerAnnotation.selectionsStackByID(ids);\n  }\n  public deSelectCaptureObjects() {\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    while (i--) {\n      if (this.gcmd.annotationInstance.scene.geometryList[i].isCapturedValue) {\n        continue;\n      }\n      if (this.gcmd.annotationInstance.scene.geometryList[i].type === GType.TEXT) {\n        this.gcmd.annotationInstance.scene.geometryList[i].isEditiable = false;\n      } else {\n        if (this.gcmd.annotationInstance.scene.geometryList[i].isSelected) {\n          this.gcmd.annotationInstance.scene.geometryList[i].isSelected = false;\n          this.gcmd.annotationInstance.scene.geometryList[i].isHover = false;\n        }\n      }\n    }\n    this.gcmd.annotationInstance.scene.Capture = undefined;\n    // CanvasCommandChain.app = undefined;\n  }\n  public deSelectAllObjects() {\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    while (i--) {\n      this.gcmd.annotationInstance.scene.geometryList[i].isCaptured = false;\n      this.gcmd.annotationInstance.scene.geometryList[i].isSelected = false;\n      this.gcmd.annotationInstance.scene.geometryList[i].isHover = false;\n    }\n    this.gcmd.annotationInstance.scene.Capture = undefined;\n    // CanvasCommandChain.app = undefined;\n  }\n  public selectAllObjects() {\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    while (i--) {\n      // if (this.gcmd.annotationInstance.scene.geometryList [i].type !== GType.NODE) continue;A\n      if (\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.APOINT ||\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.AMIDPOINT ||\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.ANODE ||\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.ANODE_CIRCLE ||\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.ANODE_NGON ||\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.ANODE_RECT ||\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.ANODE_TEXT\n      ) {\n        continue;\n      }\n      if (this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CBLACKHOLE) {\n        continue;\n      }\n      if (\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CNODE ||\n        this.gcmd.annotationInstance.scene.geometryList[i].type === GType.CNODE_RECT\n      ) {\n        continue;\n      }\n      if (!this.gcmd.annotationInstance.scene.geometryList[i].isSelected) {\n        this.gcmd.annotationInstance.scene.geometryList[i].isSelected = true;\n      }\n    }\n  }\n  public getAllGeometries() {\n    const data = [];\n    let geometry: undefined | IOGeometry;\n    for (let i = 0 ; i < this.gcmd.annotationInstance.scene.geometryList.length; ++i) {\n      geometry = this.gcmd.annotationInstance.scene.geometryList[i].toJSON();\n      if (geometry) {\n        data.push(geometry);\n      }\n\n    }\n    return data;\n  }\n  public getCapturedGeometries() {\n    const data = [];\n    let geometry: undefined | IOGeometry;\n    for (let i = 0 ; i < this.gcmd.annotationInstance.scene.geometryList.length; ++i) {\n      if (this.gcmd.annotationInstance.scene.geometryList[i].isSelected) {\n        geometry = this.gcmd.annotationInstance.scene.geometryList[i].toJSON();\n        if (geometry) {\n          data.push(geometry);\n        }\n      }\n    }\n    return data;\n  }\n  public cancelActiveCommand() {\n    if(\n      this.gcmd.annotationInstance.activeCommandController.type === ActiveCommandMode.RECTANGLE ||\n      this.gcmd.annotationInstance.activeCommandController.type === ActiveCommandMode.CIRCLE ||\n      this.gcmd.annotationInstance.activeCommandController.type === ActiveCommandMode.FREEHAND_POLYLINE_BENDING ||\n      this.gcmd.annotationInstance.activeCommandController.type === ActiveCommandMode.FREEHAND_POLYGON_GRAPH\n      ) {\n        this.gcmd.annotationInstance.activeCommandController.activeCommand.cancel();\n      }\n  }\n}\n","import { checkBoundIntersection, NVector3 } from '../../../../lib';\nimport { GeometryCommon } from './index';\nexport class GeometryCommonSupporting {\n  public gcmd: GeometryCommon;\n  constructor(gcmd: GeometryCommon) {\n    this.gcmd = gcmd;\n  }\n  public updateStyle() {\n    let i = this.gcmd.annotationInstance.scene.geometryList.length;\n    while (i--) {\n      this.gcmd.annotationInstance.scene.geometryList[i].styleComponent.updateStyle();\n    }\n    this.renderForce();\n  }\n  public renderForce() {\n    this.gcmd.annotationInstance.graphicsCoreWrapper.renderForce();\n\n    /* This liines cause the leaderline problem\n    this.ViewChangingForce();\n    */\n\n    this.gcmd.annotationInstance.activeCommandController.acProperties.needExecuteOptimizer = true;\n  }\n  public checkBoundIntersection(vs: NVector3[], p0: NVector3, p1: NVector3) {\n    if (checkBoundIntersection(vs, p0, p1)) {\n      return true;\n    }\n    return false;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public pushThemeJSON(v: any) {\n    this.gcmd.annotationInstance.customization.themeRenderStyle.pushThemeJSON(v);\n    //    this.UpdateStyle();\n    //    this.RenderForce();\n  }\n  // .............................................................. projection wrapper\n  public toScreen(x: number, y: number) {\n    return [x, y];\n  }\n  public toMap(x: number, y: number): number[] {\n    return [x, y];\n  }\n  public updateCanvasSize(d: any) {\n    // d = JSON.parse(d);\n    // console.log(d);\n    // (window as any).d = d;\n    const width = 300;\n    const height =  500;\n    // console.log(width, height);\n\n    this.gcmd.annotationInstance.graphicsCoreWrapper.canvasWrapper.aCanvas.canvasView.style.background = 'rgba(255, 0, 0, 0.2)';\n    this.gcmd.annotationInstance.graphicsCoreWrapper.canvasWrapper.aCanvas.resizeCanvas(width, height)\n\n    this.gcmd.annotationInstance.graphicsCoreWrapper.canvasWrapper.aCanvas.divHost.style.width = width + 'px';\n    this.gcmd.annotationInstance.graphicsCoreWrapper.canvasWrapper.aCanvas.divHost.style.height = height + 'px';\n\n  }\n  public toScreenVecOnCropping(vec: NVector3 ) {\n    return {\n      x: vec.x - this.gcmd.annotationInstance.scene.paramsEditing.croppingMaskParams.x,\n      y: vec.y - this.gcmd.annotationInstance.scene.paramsEditing.croppingMaskParams.y\n    };\n\n  }\n  public toScreenVecsOnCropping(vs: NVector3 [] ) {\n    const outVecs = [];\n    for (let i = 0 ; i < vs.length; ++i) {\n      const nv = this.toScreenVecOnCropping(vs[i]);\n      outVecs.push(new NVector3(nv.x, nv.y));\n    }\n    return outVecs;\n  }\n}\n","import { ImageAnnoApp } from '../..';\nimport { GeometryAdvancedProcessing } from './GeometryAdvancedProcessing';\nimport { GeometryCommonProcessing } from './GeometryCommonProcessing';\nimport { GeometryCommonSelecting } from './GeometryCommonSelecting';\nimport { GeometryCommonSupporting } from './GeometryCommonSupporting';\nexport class GeometryCommon {\n  public annotationInstance: ImageAnnoApp;\n  public gcmdSupporting: GeometryCommonSupporting;\n  public gcmdProcessing: GeometryCommonProcessing;\n  public gcmdSelecting: GeometryCommonSelecting;\n  public gcmdAProcessing: GeometryAdvancedProcessing;\n  constructor(annotationInstance: ImageAnnoApp) {\n    this.annotationInstance = annotationInstance;\n    this.gcmdSupporting = new GeometryCommonSupporting(this);\n    this.gcmdProcessing = new GeometryCommonProcessing(this);\n    this.gcmdSelecting = new GeometryCommonSelecting(this);\n    this.gcmdAProcessing = new GeometryAdvancedProcessing(this);\n  }\n}\n","import { APIWrapper } from '..';\nexport class Addon {\n  public apiWrapper: APIWrapper;\n  constructor(apiWrapper: APIWrapper) {\n    this.apiWrapper = apiWrapper;\n  }\n  public initAddon(v: string) {\n    if (v === 'drawingBlock') {\n      // this.apiWrapper.annotationInstance.implementations.app.addon.initDrawingBlock();\n    }\n    if (v === 'mapticon') {\n      // this.apiWrapper.annotationInstance.implementations.app.addon.initMapticon();\n    }\n    if (v === 'mapfilter') {\n      // this.apiWrapper.annotationInstance.implementations.app.addon.initMapfilter();\n    }\n    if (v === 'quickCommander') {\n      // this.apiWrapper.annotationInstance.implementations.app.addon.initQuickCommander();\n    }\n    if (v === 'smartCommander') {\n      // this.apiWrapper.annotationInstance.implementations.app.addon.initSmartCommander();\n    }\n    if (v === 'smartDrawing') {\n      // this.apiWrapper.annotationInstance.implementations.app.addon.initSmartDrawing();\n    }\n    if (v === 'voiceController') {\n      // this.apiWrapper.annotationInstance.implementations.app.addon.initVoiceController();\n    }\n  }\n}\n","import {\n  OptimizerPoint,\n  OptimizerTextleaderline,\n  PointRenderType,\n  Size,\n  Unit,\n} from '../../../../lib';\nimport { APIWrapper } from '..';\nexport class Environment {\n  public apiWrapper: APIWrapper;\n  private _optimizerTextleaderline = 0;\n  private _optimizerPoint = 0;\n  private _scalePoint = 0;\n  private _renderTypePoint = 0;\n  private _iconPoint = 0;\n  constructor(apiWrapper: APIWrapper) {\n    this.apiWrapper = apiWrapper;\n  }\n  public logCommon(x: number, y: number) {\n    //\n  }\n  public toggleClusteringPoint(v: boolean): void {\n    if (v) {\n      this.setOptimizerClusteringPoint(OptimizerPoint.Collision);\n    } else {\n      this.setOptimizerClusteringPoint(OptimizerPoint.None);\n    }\n  }\n  public setOptimizerClusteringPoint(optimizer: OptimizerPoint = OptimizerPoint.None) {\n    this.apiWrapper.annotationInstance.activeCommandController.acProperties.optimizerPoint = optimizer;\n    this.apiWrapper.annotationInstance.activeCommandController.acProperties.needExecuteOptimizer = true;\n    this.apiWrapper.annotationInstance.geometryCommon.gcmdSupporting.renderForce();\n  }\n  // ......................................................................... debugger\n  public toggleDebuggerMode() {\n    this.toggleInspector();\n  }\n  public shiftDash() {\n    if (this.apiWrapper.annotationInstance.scene.capture) {\n      if (\n        this.apiWrapper.annotationInstance.scene.capture.styleComponent.renderStyle.dash.length ===\n        0\n      ) {\n        this.apiWrapper.annotationInstance.scene.capture.setDash([4, 4]);\n      } else {\n        this.apiWrapper.annotationInstance.scene.capture.setDash([]);\n      }\n    }\n  }\n  public toggleInspector() {\n    // console.log('ToggleInspector');\n    this.apiWrapper.annotationInstance.implementations.app.INSPECTION = !this.apiWrapper\n      .annotationInstance.implementations.app.INSPECTION;\n    this.apiWrapper.annotationInstance.activeCommandController.acProperties.isHiddenLog = !this\n      .apiWrapper.annotationInstance.implementations.app.INSPECTION;\n  }\n  public shiftOptimizerTextleaderline() {\n    if (this.apiWrapper.annotationInstance.implementations.imageAnnoApp === undefined) {\n      return;\n    }\n\n    this._optimizerTextleaderline++;\n    if (this._optimizerTextleaderline % 3 === 0) {\n      this.apiWrapper.annotationInstance.implementations.imageAnnoApp.activeCommandController.acProperties.optimizerTextleaderline =\n        OptimizerTextleaderline.None;\n    } else if (this._optimizerTextleaderline % 3 === 1) {\n      this.apiWrapper.annotationInstance.implementations.imageAnnoApp.activeCommandController.acProperties.optimizerTextleaderline =\n        OptimizerTextleaderline.Zoom;\n    } else if (this._optimizerTextleaderline % 3 === 2) {\n      this.apiWrapper.annotationInstance.implementations.imageAnnoApp.activeCommandController.acProperties.optimizerTextleaderline =\n        OptimizerTextleaderline.Collision;\n    }\n    // console.debug(this.apiWrapper.annotationInstance.implementations.imageAnnoApp.activeCommandController.acProperties.optimizerTextleaderline);\n  }\n  public shiftActiveCluster() {\n    if (this.apiWrapper.annotationInstance.implementations.imageAnnoApp === undefined) {\n      return;\n    }\n\n    this._optimizerPoint++;\n    if (this._optimizerPoint % 2 === 0) {\n      this.apiWrapper.annotationInstance.implementations.imageAnnoApp.activeCommandController.acProperties.optimizerPoint =\n        OptimizerPoint.None;\n    } else {\n      this.apiWrapper.annotationInstance.implementations.imageAnnoApp.activeCommandController.acProperties.optimizerPoint =\n        OptimizerPoint.Collision;\n    }\n  }\n  public shiftScaleForRPoint() {\n    this._scalePoint++;\n    if (this._scalePoint % 3 === 0) {\n      this.apiWrapper.annotationInstance.geometryCommon.gcmdProcessing.setSizeRPoint(Size.SMALL);\n    } else if (this._scalePoint % 3 === 1) {\n      this.apiWrapper.annotationInstance.geometryCommon.gcmdProcessing.setSizeRPoint(Size.MEDIUM);\n    } else if (this._scalePoint % 3 === 2) {\n      this.apiWrapper.annotationInstance.geometryCommon.gcmdProcessing.setSizeRPoint(Size.LARGE);\n    }\n  }\n  public shiftRenderShapeForRPoint() {\n    this._renderTypePoint++;\n    if (this._renderTypePoint % 3 === 0) {\n      this.apiWrapper.annotationInstance.geometryCommon.gcmdProcessing.setRenderTypePoint(\n        PointRenderType.RpointA\n      );\n    } else if (this._renderTypePoint % 3 === 1) {\n      this.apiWrapper.annotationInstance.geometryCommon.gcmdProcessing.setRenderTypePoint(\n        PointRenderType.RpointB\n      );\n    } else if (this._renderTypePoint % 3 === 2) {\n      this.shiftIcon();\n    }\n  }\n  public shiftIcon() {\n    this._iconPoint++;\n    if (this._iconPoint % 5 === 0) {\n      this.apiWrapper.annotationInstance.geometryCommon.gcmdProcessing.setRenderTypePoint(\n        '/static/storymaps-website-common/images/browsers/chrome.png'\n      );\n    } else if (this._iconPoint % 5 === 1) {\n      this.apiWrapper.annotationInstance.geometryCommon.gcmdProcessing.setRenderTypePoint(\n        '/static/images/story-maps-logo.png'\n      );\n    } else if (this._iconPoint % 5 === 2) {\n      this.apiWrapper.annotationInstance.geometryCommon.gcmdProcessing.setRenderTypePoint(\n        '/static/storymaps-xgraphics/images/item-browser'\n      );\n    } else if (this._iconPoint % 5 === 3) {\n      this.apiWrapper.annotationInstance.geometryCommon.gcmdProcessing.setRenderTypePoint(\n        '/static/storymaps-xgraphics/images/item-browser'\n      );\n    } else if (this._iconPoint % 5 === 4) {\n      this.apiWrapper.annotationInstance.geometryCommon.gcmdProcessing.setRenderTypePoint(\n        '/static/storymaps-website-common/images/browsers/safari.png'\n      );\n    }\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public updateIconPoint(payload: any) {\n    this.apiWrapper.annotationInstance.geometryCommon.gcmdProcessing.updateIconPoint(\n      payload['id'],\n      payload['url']\n    );\n  }\n  public shiftScaleDynamicRender() {\n    if (this.apiWrapper.annotationInstance.implementations.imageAnnoApp === undefined) {\n      return;\n    }\n\n    this.apiWrapper.annotationInstance.implementations.imageAnnoApp.activeCommandController.acProperties.isScaleDynamicRender = !this\n      .apiWrapper.annotationInstance.implementations.imageAnnoApp.activeCommandController\n      .acProperties.isScaleDynamicRender;\n  }\n  public shiftLog() {\n    // console.log('ShiftLog');\n    // if (!CONFIG.config.ENABLE_LOG) { return; }\n    // if (this.apiWrapper.annotationInstance.uiWrapper) {\n    //   this.apiWrapper.annotationInstance.uiWrapper.log.IsHiddenToggle();\n    // }\n    this.apiWrapper.annotationInstance.activeCommandController.acProperties.isHiddenLog = !this\n      .apiWrapper.annotationInstance.activeCommandController.acProperties.isHiddenLog;\n    // this.apiWrapper.annotationInstance.panel.IsHiddenToggle();\n  }\n  public bindFromDisplay() {\n    // console.log(this.Reactdisplay);\n    // if (this.Reactdisplay) { this.Reactdisplay.updateStateFromNG(this.apiWrapper.annotationInstance.scene.geometryList.length); }\n  }\n  public shiftMapfilter() {\n    // if (AppMapFilter.app) {\n    //     AppMapFilter.app.isOn = !AppMapFilter.app.isOn;\n    //     AppMapFilter.app.activeCommand.ToggleFilterByBool(AppMapFilter.app.isOn);\n    //     this.apiWrapper.annotationInstance.implementations.app.model.ioWrapper.eventListener.ShiftOptionStack('toggleMapfilter', AppMapFilter.app.isOn);\n    // }\n  }\n  public toggleMapfilter(stateBool: string) {\n    //\n  }\n  public toggleActiveCommandChain(stateBool: string) {\n    if (stateBool === 'true') {\n      this.apiWrapper.annotationInstance.activeCommandController.acProperties.showActiveCommandChain = true;\n    } else if (stateBool === 'false') {\n      this.apiWrapper.annotationInstance.activeCommandController.acProperties.showActiveCommandChain = false;\n    }\n  }\n  public toggleDrawingTooltips(stateBool: string) {\n    if (stateBool === 'true') {\n      this.apiWrapper.annotationInstance.activeCommandController.acProperties.showTooltip = true;\n    } else if (stateBool === 'false') {\n      this.apiWrapper.annotationInstance.activeCommandController.acProperties.showTooltip = false;\n    }\n  }\n  public toggleGrid(stateBool: string) {\n    // if (AGeometry.annotationInstance.nGraphics.appMapFilter) {\n    //     if (stateBool === 'true') {\n    //         this.apiWrapper.annotationInstance.aGeometryRender.grid.isRenderable = true; this.snap = true;\n    //         this.apiWrapper.annotationInstance.implementations.app.model.ioWrapper.eventListener.ShiftOptionStack('toggleGrid', this.snap);\n    //     } else if (stateBool === 'false') {\n    //         this.apiWrapper.annotationInstance.aGeometryRender.grid.isRenderable = false; this.snap = false;\n    //         this.apiWrapper.annotationInstance.implementations.app.model.ioWrapper.eventListener.ShiftOptionStack('toggleGrid', this.snap);\n    //     }\n    // }\n  }\n  public toggleBorderFeaturePolygon() {\n    // this.apiWrapper.annotationInstance.graphicsCoreWrapper.canvasWrapper.aCanvasFeature.ToggleRenderMode();\n  }\n  public shiftGrid() {\n    // this.apiWrapper.annotationInstance.renderer.grid.isRenderable = !this.apiWrapper.annotationInstance.renderer.grid.isRenderable;\n    // this.snap = this.apiWrapper.annotationInstance.renderer.grid.isRenderable;\n    // this.apiWrapper.annotationInstance.implementations.app.model.ioWrapper.eventListener.ShiftOptionStack('toggleGrid', this.snap);\n  }\n  public shiftMeasure() {\n    // if (AGeometry.annotationInstance.nGraphics.appMapFilter) {\n    //     if (ALog.alog) {\n    //         this.showUnit = !this.showUnit;\n    //         ALog.alog.isShow = this.showUnit;\n    //         this.apiWrapper.annotationInstance.implementations.app.model.ioWrapper.eventListener.ShiftOptionStack('toggleMeasure', ALog.alog.isShow);\n    //     }\n    // }\n  }\n  public toggleMeasure(stateBool: string) {\n    // if (AGeometry.annotationInstance.nGraphics.appMapFilter) {\n    //     if (stateBool === 'true') {\n    //         this.showUnit = true;\n    //         if (ALog.alog) { ALog.alog.isShow = true; this.apiWrapper.annotationInstance.implementations.app.model.ioWrapper.eventListener.ShiftOptionStack('toggleMeasure', ALog.alog.isShow); }\n    //     } else if (stateBool === 'false') {\n    //         this.showUnit = false;\n    //         if (ALog.alog) { ALog.alog.isShow = false; this.apiWrapper.annotationInstance.implementations.app.model.ioWrapper.eventListener.ShiftOptionStack('toggleMeasure', ALog.alog.isShow); }\n    //     }\n    // }\n  }\n  public togglTooltip(stateBool: string) {\n    // if (AGeometry.annotationInstance.nGraphics.appMapFilter) {\n    //     if (stateBool === 'true') {\n    //         this.showTooltip = true;\n    //     } else if (stateBool === 'false') {\n    //         this.showTooltip = false;\n    //     }\n    // }\n  }\n  public togglActiveCommandChain(stateBool: string) {\n    // if (AGeometry.annotationInstance.nGraphics.appMapFilter) {\n    //     if (stateBool === 'true') {\n    //         this.showActiveCommandChain = true;\n    //     } else if (stateBool === 'false') {\n    //         this.showActiveCommandChain = false;\n    //     }\n    // }\n  }\n  public shiftSnapping() {\n    this.apiWrapper.annotationInstance.activeCommandController.acProperties.isActivateSnapping = !this\n      .apiWrapper.annotationInstance.activeCommandController.acProperties.isActivateSnapping;\n  }\n  public shiftUnitDisplay() {\n    this.apiWrapper.annotationInstance.activeCommandController.acProperties.showUnit = !this\n      .apiWrapper.annotationInstance.activeCommandController.acProperties.showUnit;\n    for (const alog of this.apiWrapper.annotationInstance.scene.listALog) {\n      alog.isShow = this.apiWrapper.annotationInstance.activeCommandController.acProperties.showUnit;\n    }\n    // console.log(this.apiWrapper.annotationInstance.activeCommandController.acProperties.showUnit);\n    // if (ALog.alog) { ALog.alog.isShow = this.apiWrapper.annotationInstance.activeCommandController.acProperties.showUnit; }\n  }\n  public shiftUnit() {\n    this.apiWrapper.annotationInstance.activeCommandController.acProperties.unitEnumInt++;\n    if (this.apiWrapper.annotationInstance.activeCommandController.acProperties.unitEnumInt === 0) {\n      this.apiWrapper.annotationInstance.activeCommandController.acProperties.unit = Unit.Kilometer;\n    } else if (\n      this.apiWrapper.annotationInstance.activeCommandController.acProperties.unitEnumInt === 1\n    ) {\n      this.apiWrapper.annotationInstance.activeCommandController.acProperties.unit = Unit.Meter;\n    } else if (\n      this.apiWrapper.annotationInstance.activeCommandController.acProperties.unitEnumInt === 2\n    ) {\n      this.apiWrapper.annotationInstance.activeCommandController.acProperties.unit = Unit.Mile;\n    }\n    if (this.apiWrapper.annotationInstance.activeCommandController.acProperties.unitEnumInt > 2) {\n      this.apiWrapper.annotationInstance.activeCommandController.acProperties.unitEnumInt = 0;\n    }\n  }\n  public toggleCollisionDetection() {\n    this.apiWrapper.annotationInstance.activeCommandController.acProperties.needCollisionDetection = !this\n      .apiWrapper.annotationInstance.activeCommandController.acProperties.needCollisionDetection;\n  }\n  public activateOffScreen() {\n    this.apiWrapper.annotationInstance.graphicsCoreWrapper.canvasWrapper.aCanvasOffScreen.appendDiv();\n  }\n  public deactivateOffScreen() {\n    try {\n      this.apiWrapper.annotationInstance.graphicsCoreWrapper.canvasWrapper.aCanvasOffScreen.removeDiv();\n    } catch (error) {\n      // console.error('no offscreen div appended');\n    }\n  }\n  public shiftBlackholeRender() {\n    // this.apiWrapper.annotationInstance.AGeometryCommonRender.needBlackhole = !this.apiWrapper.annotationInstance.AGeometryCommonRender.needBlackhole;\n  }\n  public shiftBlackholePos() {\n    this.apiWrapper.annotationInstance.renderer.blackhole.smartEvasion = !this.apiWrapper.annotationInstance.renderer.blackhole.smartEvasion;\n   \n  }\n  // .................................................................................... theme\n  // public ShiftTheme() {\n  //     this.annotationInstance.themeRenderStyle.ShiftTheme();\n  // }\n  // public ShiftThemeOrder() {\n  //     this.annotationInstance.themeRenderStyle.ShiftThemeinOrder();\n  // }\n  // public ShiftThemeByID(v: string) {\n  //     this.annotationInstance.implementations.app.shiftThemeByID(v);\n  // }\n  // public ShiftAccentColor() {\n  //     this.annotationInstance.implementations.app.pushAccentColor([255, 0, 0, 1.]);\n  // }\n  // public ChangeTheme(id: string) {\n  //     // this.annotationInstance.themeAnnotation.typeTheme = id as MERCATOR_THEME;\n  //     // console.log(this.annotationInstance.typeTheme);\n  // }\n  // .................................................................................... theme\n}\n","import { ImageAnnoApp } from '..';\nimport { Addon } from './Addon';\nimport { Environment } from './Environment';\nexport class APIWrapper {\n  public annotationInstance: ImageAnnoApp;\n  public environment: Environment;\n  public addon: Addon;\n  constructor(annotationInstance: ImageAnnoApp) {\n    this.annotationInstance = annotationInstance;\n    this.addon = new Addon(this);\n    this.environment = new Environment(this);\n  }\n}\n","import { Customization } from '..';\nexport class IconAsset {\n  public icons = {};\n  public customization: Customization;\n  public tempImageID: string | undefined = undefined;\n  constructor(customization: Customization, theme?: unknown) {\n    this.customization = customization;\n\n    this.initIcon(theme);\n    // // this.AddIconAsset('https://dash.umn.edu/wp-content/uploads/2019/08/StoryMaps.png');\n    // // image.src = 'https://toppng.com/uploads/preview/twitter-icon-black-1154999496507pavdk1xp.png';\n    // // image.src = 'https://cdn4.iconfinder.com/data/icons/flat-brand-logo-2/512/starbucks-512.png';\n\n    // this.AddIconAsset('/static/storymaps-website-common/images/browsers/chrome.png');\n    // this.AddIconAsset('/static/images/story-maps-logo.png');\n    // this.AddIconAsset('/static/storymaps-xgraphics/images/item-browser');\n    // this.AddIconAsset('/static/storymaps-website-common/images/browsers/safari.png');\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private initIcon(theme?: any) {\n    for (const property in theme.iconBase64) {\n      const image = new Image();\n      image.src = theme.iconBase64[property];\n      // image.style.opacity = '0.1';\n      this.icons[property] = image;\n    }\n  }\n  public addIcon(url: string) {\n    if (!this.icons[url]) {\n      this.icons[url] = this.addIconAsset(url);\n    }\n  }\n  public getIconByURL(url: string) {\n    return this.icons[url];\n  }\n  public removeIconAsset(id: string): void {\n    delete this.icons[id];\n  }\n  private addIconAsset(url: string) {\n    const img = new Image();\n    img.crossOrigin = 'Anonymous';\n    img.onload = () => {\n      // need to change\n      // this.tempImageID = url;\n    };\n    img.src = url;\n    return img;\n  }\n}\n","import {\n  ISVGForCanvas,\n  ISvgPin,\n  Environment,\n  getNumberedPointSMX, getRegularPointAGSM, getRegularPointSMX,\n } from '../../../../lib';\nimport { Customization } from '..';\nimport { ThemeObjectForStorymaps } from './StorymapsThemeStructure';\n\nexport class ThemeRenderStyle {\n  public customization: Customization;\n  public col: string;\n  public shiftStyle: number;\n  public shiftTheme = 1;\n  public shiftThemeNumberLayerOrdering = 0;\n  public numLayer = -1;\n  public isDone = false;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public queueTheme: any | undefined = undefined;\n  private defaultRPoint: ISvgPin;\n  private defaultNPoint: ISvgPin;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  constructor(customization: Customization, theme: any) {\n    this.customization = customization;\n    if (this.customization.annotationInstance.implementations.app.param.environment === Environment.AGSM) {\n      this.defaultRPoint = getRegularPointAGSM();\n      this.defaultNPoint = getNumberedPointSMX();\n    } else {\n      this.defaultRPoint = getRegularPointSMX();\n      this.defaultNPoint = getNumberedPointSMX();\n    }\n    this.computeTheme(theme);\n  }\n  public shiftEnvironment(v: Environment) {\n    if (v === Environment.AGSM) {\n      this.updateRPointPath(getRegularPointAGSM());\n    } else {\n      this.updateRPointPath(getRegularPointSMX());\n    }\n  }\n  public updateRPointPath(path: ISvgPin) {\n      this.customization.themeCurrent.rPoint.SVG.path2D = path.path2D as Path2D;\n\n      // we need to update width and height based on the rendered SVG.\n      let widthNew = 36; //  18\n      let heightNew = 28; // 29\n      if (this.customization.annotationInstance.implementations.app.param.environment === Environment.AGSM) {\n        widthNew = 32; // 16\n        heightNew = 30; // 32\n      }\n\n      this.customization.themeCurrent.rPoint.width = widthNew;\n      this.customization.themeCurrent.rPoint.height = heightNew;\n      for (let i = 0; i < this.customization.annotationInstance.scene.listRPoint.length; ++i) {\n        this.customization.annotationInstance.scene.listRPoint[i].styleComponent.renderStyle.width = widthNew;\n        this.customization.annotationInstance.scene.listRPoint[i].styleComponent.renderStyle.height = heightNew;\n      }\n\n  }\n  public updateNPointPath(path: Path2D) {\n    this.customization.themeCurrent.nPoint.SVG.path2D = path;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public async pushThemeJSON(themes: any) {\n    if (!this.isDone) {\n      this.queueTheme = themes;\n      return;\n    }\n    await this.computeTheme(themes);\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private async computeTheme(themes: any) {\n    this.isDone = false;\n    this.customization.themeCurrent = new ThemeObjectForStorymaps();\n    this.updateThemeBGType(themes.mode);\n    this.updateThemeInteraction(themes);\n    this.updateMaskColor(themes.properties.maskColor);\n    this.updateSelection(themes.graphics.line.colorRgba, themes.graphics.polygon.fill);\n    this.buildPropertiesData(themes);\n    this.customization.themeCurrent = this.buildThemeDataShape(themes.graphics);\n    await this.buildThemeDataAsync(themes.graphics);\n    this.isDone = true;\n    if (this.queueTheme) {\n      const theTheme = this.queueTheme;\n      this.queueTheme = undefined;\n      this.computeTheme(theTheme);\n    }\n    // console.log('Updating theme done');\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private buildPropertiesData(theme: any) {\n    this.customization.themeCurrent.properties.elasticScale = theme.properties.elasticScale;\n    this.customization.themeCurrent.properties.desaturationValue =\n      theme.properties.desaturationValue;\n    this.customization.themeCurrent.properties.timeTransitionA = theme.properties.timeTransitionA;\n    this.customization.themeCurrent.properties.timeTransitionB = theme.properties.timeTransitionB;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private buildThemeDataShape(theme: any) {\n    // console.log('BuildThemeDataShape, ' , theme.polygon.fill)\n    const theTheme = this.customization.themeCurrent;\n    // ................................................................. Node\n    theTheme.node.size = theme.node.sizeNode * 0.5;\n    theTheme.node.lineWidth = 2;\n    theTheme.node.sizeMid = theme.node.sizeNodeMid * 0.5;\n    theTheme.node.lineWidthMid = 2;\n    // ................................................................. polyline\n    theTheme.polyline.strokeStyleFirstArray = [\n      theme.line.colorRgba[0],\n      theme.line.colorRgba[1],\n      theme.line.colorRgba[2],\n      theme.line.colorRgba[3],\n    ];\n    theTheme.polyline.strokeStyleSecondArray = [\n      theme.line.colorRgba[0],\n      theme.line.colorRgba[1],\n      theme.line.colorRgba[2],\n      theTheme.properties.opacity,\n    ]; // [theme.line.color[0], theme.line.color[1], theme.line.color[2], opacity];\n    // theTheme.polyline.polylineStro\n    theTheme.polyline.lineWidth = theme.line.width;\n    // ................................................................. arrow\n    theTheme.arrow.fillStyleFirstArray = [\n      theme.arrow.colorRgba[0],\n      theme.arrow.colorRgba[1],\n      theme.arrow.colorRgba[2],\n      theme.arrow.colorRgba[3],\n    ];\n    theTheme.arrow.fillStyleSecondArray = [\n      theme.arrow.colorRgba[0],\n      theme.arrow.colorRgba[1],\n      theme.arrow.colorRgba[2],\n      theTheme.properties.opacity + 0.5,\n    ];\n    theTheme.arrow.strokeStyleFirstArray = [\n      theme.arrow.colorRgba[0],\n      theme.arrow.colorRgba[1],\n      theme.arrow.colorRgba[2],\n      theme.arrow.colorRgba[3],\n    ];\n    theTheme.arrow.strokeStyleSecondArray = [\n      theme.arrow.colorRgba[0],\n      theme.arrow.colorRgba[1],\n      theme.arrow.colorRgba[2],\n      theTheme.properties.opacity,\n    ];\n    theTheme.arrow.lineWidth = theme.arrow.width;\n    theTheme.arrow.scale = theme.arrow.scale;\n    // ................................................................. polygon\n    theTheme.polygon.fillStyleFirstArray = [\n      theme.polygon.fill[0],\n      theme.polygon.fill[1],\n      theme.polygon.fill[2],\n      theme.polygon.fill[3],\n    ];\n    theTheme.polygon.fillStyleSecondArray = [\n      theme.polygon.fill[0],\n      theme.polygon.fill[1],\n      theme.polygon.fill[2],\n      theTheme.properties.opacity - 0.2,\n    ];\n    theTheme.polygon.strokeStyleFirstArray = [\n      theme.polygon.colorRgba[0],\n      theme.polygon.colorRgba[1],\n      theme.polygon.colorRgba[2],\n      theme.polygon.colorRgba[3],\n    ];\n    theTheme.polygon.strokeStyleSecondArray = [\n      theme.polygon.colorRgba[0],\n      theme.polygon.colorRgba[1],\n      theme.polygon.colorRgba[2],\n      theTheme.properties.opacity - 0.2,\n    ];\n    theTheme.polygon.lineWidth = theme.polygon.width;\n    // console.log(theTheme.polygon.fillStyleFirstArray);\n    // ................................................................. freehand\n    theTheme.freehand.fillStyleFirstArray = [\n      theme.polygon.fill[0],\n      theme.polygon.fill[1],\n      theme.polygon.fill[2],\n      theTheme.properties.opacity,\n    ];\n    theTheme.freehand.strokeStyleFirstArray = [\n      theme.polygon.colorRgba[0],\n      theme.polygon.colorRgba[1],\n      theme.polygon.colorRgba[2],\n      theTheme.properties.opacity,\n    ];\n    theTheme.freehand.lineWidth = theme.polygon.width;\n    // ................................................................. TextLeaderLine\n    // console.log(theme.textLeaderline);\n\n    // theTheme.textleaderline.fillStyleFirstArray = [\n    //   theme.textLeaderline.color[0],\n    //   theme.textLeaderline.color[1],\n    //   theme.textLeaderline.color[2],\n    //   theme.textLeaderline.color[3],\n    // ];\n    // theTheme.textleaderline.fillStyleSecondArray = [\n    //   theme.textLeaderline.color[0],\n    //   theme.textLeaderline.color[1],\n    //   theme.textLeaderline.color[2],\n    //   theTheme.properties.opacity,\n    // ];\n    // if (theTheme.properties.isDarkBG) {\n    //   theTheme.textleaderline.strokeStyleFirstArray = [255, 255, 255, 1];\n    // } else {\n    //   theTheme.textleaderline.strokeStyleFirstArray = [0, 0, 0, 1];\n    // }\n    // theTheme.textleaderline.lineWidth = theme.textLeaderline.width;\n    theTheme.textleaderline.scale = theme.textLeaderline.scale;\n    theTheme.textleaderline.box.dash = theme.textLeaderline.box.dash;\n    theTheme.textleaderline.box.lineWidth = theme.textLeaderline.box.width;\n    theTheme.textleaderline.box.fillStyle = theme.textLeaderline.box.fill;\n    theTheme.textleaderline.box.strokeStyle = theme.textLeaderline.box.strokeStyle;\n\n    theTheme.textleaderline.handleNode.dash = theme.textLeaderline.handleNode.dash;\n    theTheme.textleaderline.handleNode.lineWidth = theme.textLeaderline.handleNode.width;\n    theTheme.textleaderline.handleNode.fillStyle = theme.textLeaderline.handleNode.fill;\n    theTheme.textleaderline.handleNode.strokeStyle = theme.textLeaderline.handleNode.strokeStyle;\n\n    theTheme.textleaderline.leaderline.dash = theme.textLeaderline.leaderline.dash;\n    theTheme.textleaderline.leaderline.lineWidth = theme.textLeaderline.leaderline.width;\n    theTheme.textleaderline.leaderline.strokeStyle = theme.textLeaderline.leaderline.strokeStyle;\n\n    theTheme.textleaderline.anchorNode.dash = theme.textLeaderline.anchorNode.dash;\n    theTheme.textleaderline.anchorNode.lineWidth = theme.textLeaderline.anchorNode.width;\n    theTheme.textleaderline.anchorNode.fillStyle = theme.textLeaderline.anchorNode.fill;\n    theTheme.textleaderline.anchorNode.strokeStyle = theme.textLeaderline.anchorNode.strokeStyle;\n\n    // ................................................................. IPoint\n    theTheme.iPoint.scale = theme.iconPoint.scale;\n    // ................................................................. RPoint\n    theTheme.rPoint.URL = theme.regularPoint.url;\n    theTheme.rPoint.fillStyleFirstArray = theme.regularPoint.colorRgba;\n    theTheme.rPoint.shadowBlur = theme.regularPoint.shadowBlur;\n    theTheme.rPoint.shadowColor = theme.regularPoint.shadowColor;\n    theTheme.rPoint.shadowColorHover = theme.regularPoint.shadowColorHover;\n\n    // const val = theme.regularPoint.scale + (theme.regularPoint.scale - 0.5 * 0.5 );\n    // theTheme.rPoint.scale = val; // theme.regularPoint.scale; // + (theme.regularPoint.scale * 0.5);\n    theTheme.rPoint.scale = theme.regularPoint.scale;\n\n    theTheme.rPoint.fillStyleSecondArray = [\n      theme.regularPoint.colorRgba[0],\n      theme.regularPoint.colorRgba[1],\n      theme.regularPoint.colorRgba[2],\n      theTheme.properties.opacity,\n    ]; // `rgba(0,0,0, ${opacity})`;\n    // ................................................................. NPoint\n    theTheme.nPoint.URL = theme.numberedPoint.url;\n    theTheme.nPoint.shadowBlur = theme.numberedPoint.shadowBlur;\n    theTheme.nPoint.shadowColor = theme.numberedPoint.shadowColor;\n    theTheme.nPoint.shadowColorHover = theme.numberedPoint.shadowColorHover;\n    theTheme.nPoint.fillStyleSecondArray = [\n      theme.numberedPoint.colorRgba[0],\n      theme.numberedPoint.colorRgba[1],\n      theme.numberedPoint.colorRgba[2],\n      theTheme.properties.opacity + 0.1,\n    ]; // `rgba(0,0,0, ${opacity})`;\n    // theTheme.nPoint.fillStyleSecondArray = [theme.numberedPoint.color[0], theme.numberedPoint.color[1], theme.numberedPoint.color[2], theTheme.properties.opacity]; // `rgba(0,0,0, ${opacity})`;\n    theTheme.nPoint.fillStyleFirstArray = [\n      theme.numberedPoint.colorRgba[0],\n      theme.numberedPoint.colorRgba[1],\n      theme.numberedPoint.colorRgba[2],\n      theme.numberedPoint.colorRgba[3],\n    ]; // this.ConvertRGBAfromArray(theme.node.color);\n    theTheme.nPoint.fontColorArray = [\n      theme.numberedPoint.fontColor[0],\n      theme.numberedPoint.fontColor[1],\n      theme.numberedPoint.fontColor[2],\n      theme.numberedPoint.fontColor[3],\n    ];\n    theTheme.nPoint.fontSize = theme.numberedPoint.fontSize;\n    theTheme.nPoint.fontFamily = theme.numberedPoint.fontFamily;\n    theTheme.nPoint.scale = theme.numberedPoint.scale;\n    return theTheme;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public async buildThemeDataAsync(theme: any) {\n    const theTheme = this.customization.themeCurrent;\n    /*\n    // ................................................................. RPoint\n    let svgXML = await loadSVGFromHTTP(getPointRegular(this.customization.annotationInstance.implementations.app.CONFIG.config.BASE_URL));\n    // console.log(pointRegular);\n    // console.log(theTheme.rPoint.URL);\n    // let svgXML = await LoadSVGFromHTTP(theTheme.rPoint.URL);\n    if (svgXML) {\n      const json = await getObjectFromSVGXML(svgXML);\n      const svg = JSON.parse(JSON.stringify(json));\n      if (svg.svg && svg.svg.path) {\n        // console.log(svg.svg.path);\n        const pathString = svg.svg.path['@attributes'].d;\n        theTheme.rPoint.SVG = getCanvaseShapePathFromString(json, 1);\n        // theTheme.rPoint.SVG.path2d = new Path2D(pathes);\n        if (\n          this.customization.annotationInstance.implementations.app.model.appCoreWrapper\n            .browserUtility.type !== BrowserType.Edge\n        ) {\n          // const pathesList = pathes.split(' ');\n          // theTheme.rPoint.SVG.path2d = getCanvaseShapePathFromStringWithScale(pathesList, theTheme.rPoint.scale);\n        }\n      }\n      const height = 28; // svg.svg['@attributes'].height ; //* theTheme.rPoint.scale;\n      theTheme.rPoint.SVG.height = height;\n      theTheme.rPoint.height = height;\n      const width = 36; // svg.svg['@attributes'].width; // * theTheme.rPoint.scale;\n      theTheme.rPoint.SVG.width = width;\n      theTheme.rPoint.width = width;\n      // theTheme.rPoint.SVG.path2D = new Path2D('M8 0C3.6 0 0 1.8 0 6.5v17L8 32l8-8.6V6.5C16 1.8 12.4 0 8 0zM4 11a4 4 0 118 0 4 4 0 01-8 0z');\n    }\n    */\n    // ................................................................. RPoint\n    theTheme.rPoint.SVG = {\n      type: 'path',\n      height: 28,\n      width: 36,\n      // path: ctxShape,\n      path2D: this.defaultRPoint.path2D as Path2D,\n    };\n\n    // theTheme.rPoint.SVG.path2D =  new Path2D('M8 0C3.6 0 0 1.8 0 6.5v17L8 32l8-8.6V6.5C16 1.8 12.4 0 8 0zM4 11a4 4 0 118 0 4 4 0 01-8 0z');\n    let height = 28; // svg.svg['@attributes'].height ; //* theTheme.rPoint.scale;\n    theTheme.rPoint.SVG.height = height;\n    theTheme.rPoint.height = height;\n    let width = 36; // svg.svg['@attributes'].width; // * theTheme.rPoint.scale;\n    theTheme.rPoint.SVG.width = width;\n    theTheme.rPoint.width = width;\n    // theTheme.rPoint.SVG.path2D = new Path2D('M8 0C3.6 0 0 1.8 0 6.5v17L8 32l8-8.6V6.5C16 1.8 12.4 0 8 0zM4 11a4 4 0 118 0 4 4 0 01-8 0z');\n\n    // ................................................................. NPoint\n    /*\n    let svgXML = await loadSVGFromHTTP(getPointNumber(this.customization.annotationInstance.implementations.app.CONFIG.config.BASE_URL));\n    // svgXML = await LoadSVGFromHTTP(theTheme.nPoint.URL);\n    // console.log(svgXML);\n    if (svgXML) {\n      const json = await getObjectFromSVGXML(svgXML);\n      // console.log(json);\n      const svg = JSON.parse(JSON.stringify(json));\n      // console.log(svg);\n      if (svg.svg && svg.svg.path) {\n        // let ctxShape: IctxShape[] = [];\n        // console.log(svg);\n        // const pathes = svg.svg.path['@attributes'].d;\n        // console.log(pathes);\n        theTheme.nPoint.SVG = getCanvaseShapePathFromSVGXML(svgXML);\n        // theTheme.nPoint.SVG.path2dA = new Path2D(pathes);\n        // theTheme.nPoint.SVG.path2d = new Path2D(pathes);\n      } else if (svg.svg.circle) {\n        // console.log('svg.circle', svg.svg.circle);\n        const pathes = svg.svg.circle['@attributes'];\n        // console.log(pathes);\n        // theTheme.nPoint.numberedPointSVG. = pathes.r;\n        // let height = svg.svg['@attributes'].height;\n        // console.log('height:', height);\n        // theTheme.nPoint.numberedPointSVG.height = pathes.r * 2;\n        theTheme.nPoint.height = pathes.r * 2 * theTheme.nPoint.scale;\n\n        // let width = svg.svg['@attributes'].width;\n        // console.log('width:', width);\n        // theTheme.nPoint.numberedPointSVG.width = pathes.r * 2;\n        theTheme.nPoint.width = pathes.r * 2 * theTheme.nPoint.scale;\n      }\n      // ctx.translate(100, 300);\n      // ctx.fillStyle = '#ff0000';\n      // ctx.fill(this.customization.annotationInstance.renderer.preset.pointNumberedPathSVG);\n      // ctx.stroke();\n    }\n    */\n    let svgForCanvas: ISVGForCanvas = {\n      type: 'path',\n      width: 36, //parseInt(svg.svg['@attributes'].width, 10),\n      height: 28, // parseInt(svg.svg['@attributes'].height, 10),\n      path: [],\n      path2D : this.defaultNPoint.path2D as Path2D,\n      // path2D : new Path2D('M8 0C3.6 0 0 1.8 0 6.5v17L8 32l8-8.6V6.5C16 1.8 12.4 0 8 0zM4 11a4 4 0 118 0 4 4 0 01-8 0z'),\n    };\n    theTheme.nPoint.SVG = svgForCanvas;\n    height = 28; // svg.svg['@attributes'].height ; //* theTheme.rPoint.scale;\n    theTheme.nPoint.SVG.height = height;\n    theTheme.nPoint.height = height;\n    width = 36; // svg.svg['@attributes'].width; // * theTheme.rPoint.scale;\n    theTheme.nPoint.SVG.width = width;\n    theTheme.nPoint.width = width;\n\n    this.customization.annotationInstance.geometryCommon.gcmdSupporting.updateStyle();\n\n    return theTheme;\n  }\n  // .......................................................................................................\n  private updateThemeBGType(v: string) {\n    if (v === 'dark') {\n      this.customization.themeCurrent.properties.isDarkBG = true;\n    } else {\n      this.customization.themeCurrent.properties.isDarkBG = false;\n    }\n  }\n  private updateMaskColor(v: number[]) {\n    this.customization.themeCurrent.properties.maskColor = `rgba(${v[0]}, ${v[1]}, ${v[2]}, ${v[3]})`;\n    this.customization.annotationInstance.graphicsCoreWrapper.canvasWrapper.aCanvasMask.maskColor = this.customization.themeCurrent.properties.maskColor;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private updateThemeInteraction(themes: any) {\n    this.customization.themeCurrent.properties.outlineHoverColorArray =\n      themes.properties.outlineHoverColor;\n    this.customization.themeCurrent.properties.outlineHoverColorRGBAString = `rgba(${themes.properties.outlineHoverColor[0]}, ${themes.properties.outlineHoverColor[1]}, ${themes.properties.outlineHoverColor[2]}, ${themes.properties.outlineHoverColor[3]})`;\n  }\n  private updateSelection(stroke: number[], fill: number[]) {\n    this.customization.themeCurrent.selection.strokeStyleFirstArray = stroke;\n    this.customization.themeCurrent.selection.fillStyleFirstArray = fill;\n  }\n}\n","import { ActiveCommandMode } from '../../../../lib';\nimport { Customization } from '..';\n\ninterface ShortcutProperties {\n  key: string;\n  shift: boolean;\n  control: boolean;\n}\nexport class ShortcutCommand {\n  public key = '';\n  public hasShift = false;\n  public hasControl = false;\n  public ac: ActiveCommandMode = ActiveCommandMode.NONE;\n  constructor(shortcutProperties: ShortcutProperties) {\n    this.key = shortcutProperties.key.toUpperCase();\n    this.hasShift = shortcutProperties.shift as boolean;\n    this.hasControl = shortcutProperties.control as boolean;\n  }\n}\nexport class Shortcut {\n  public customization: Customization;\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public shortcutCommands: any = {};\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  constructor(customization: Customization, theme?: any) {\n    this.customization = customization;\n    if (theme) {\n      this.pushThemeJSON(theme);\n    } else {\n      this.pushThemeJSON(\n        this.customization.annotationInstance.implementations.app.model.assets.theme\n      );\n    }\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public pushThemeJSON(themes: any) {\n    if (!themes.shortcut) {\n      return;\n    }\n    for (let i = 0; i < themes.shortcut.length; ++i) {\n      Object.keys(themes.shortcut[i]).forEach((key) => {\n        const value = themes.shortcut[i][key];\n        if (key === 'select' && value.key !== '') {\n          const sc = new ShortcutCommand(value as ShortcutProperties);\n          sc.ac = ActiveCommandMode.SELECT;\n          this.shortcutCommands[value.key.toUpperCase()] = sc;\n          return;\n        }\n        if (key === 'selectRect' && value.key !== '') {\n          const sc = new ShortcutCommand(value as ShortcutProperties);\n          sc.ac = ActiveCommandMode.SELECT_RECT;\n          this.shortcutCommands[value.key.toUpperCase()] = sc;\n          return;\n        }\n        if (key === 'undo' && value.key !== '') {\n          const sc = new ShortcutCommand(value as ShortcutProperties);\n          sc.ac = ActiveCommandMode.UNDO;\n          this.shortcutCommands[value.key.toUpperCase()] = sc;\n          return;\n        }\n        if (key === 'redo' && value.key !== '') {\n          const sc = new ShortcutCommand(value as ShortcutProperties);\n          sc.ac = ActiveCommandMode.REDO;\n          this.shortcutCommands[value.key.toUpperCase()] = sc;\n          return;\n        }\n        if (key === 'rPoint' && value.key !== '') {\n          const sc = new ShortcutCommand(value as ShortcutProperties);\n          sc.ac = ActiveCommandMode.POINT_REGULAR;\n          this.shortcutCommands[value.key.toUpperCase()] = sc;\n          return;\n        }\n        if (key === 'nPoint' && value.key !== '') {\n          const sc = new ShortcutCommand(value as ShortcutProperties);\n          sc.ac = ActiveCommandMode.POINT_NUMBERED;\n          this.shortcutCommands[value.key.toUpperCase()] = sc;\n          return;\n        }\n        if (key === 'polyline' && value.key !== '') {\n          const sc = new ShortcutCommand(value as ShortcutProperties);\n          sc.ac = ActiveCommandMode.POLYLINE_BENDING;\n          this.shortcutCommands[value.key.toUpperCase()] = sc;\n          return;\n        }\n        if (key === 'freehandPolyline' && value.key !== '') {\n          const sc = new ShortcutCommand(value as ShortcutProperties);\n          sc.ac = ActiveCommandMode.FREEHAND_POLYLINE_BENDING;\n          this.shortcutCommands[value.key.toUpperCase()] = sc;\n          return;\n        }\n        if (key === 'polygon' && value.key !== '') {\n          const sc = new ShortcutCommand(value as ShortcutProperties);\n          sc.ac = ActiveCommandMode.POLYGON_GRAPH;\n          this.shortcutCommands[value.key.toUpperCase()] = sc;\n          return;\n        }\n        if (key === 'freehandPolygon' && value.key !== '') {\n          const sc = new ShortcutCommand(value as ShortcutProperties);\n          sc.ac = ActiveCommandMode.FREEHAND_POLYGON_GRAPH;\n          this.shortcutCommands[value.key.toUpperCase()] = sc;\n          return;\n        }\n        if (key === 'textleaderline' && value.key !== '') {\n          const sc = new ShortcutCommand(value as ShortcutProperties);\n          sc.ac = ActiveCommandMode.TEXT_LEADERLINE;\n          this.shortcutCommands[value.key.toUpperCase()] = sc;\n          return;\n        }\n        if (key === 'singleArrow' && value.key !== '') {\n          const sc = new ShortcutCommand(value as ShortcutProperties);\n          sc.ac = ActiveCommandMode.ARROW_SINGLE;\n          this.shortcutCommands[value.key.toUpperCase()] = sc;\n          return;\n        }\n        if (key === 'doubleArrrow' && value.key !== '') {\n          const sc = new ShortcutCommand(value as ShortcutProperties);\n          sc.ac = ActiveCommandMode.ARROW_DOUBLE;\n          this.shortcutCommands[value.key.toUpperCase()] = sc;\n          return;\n        }\n      });\n    }\n  }\n}\n// { select:  { key: '', shfit: true, control: false } },\n// { selectRect: { key: '', shfit: true, control: false } },\n// { undo: { key: '', shfit: true, control: false } },\n// { redo: { key: '', shfit: true, control: false } },\n// { rPoint: { key: 'p', shfit: true, control: false } },\n// { nPoint: { key: '', shfit: true, control: false } },\n// { polyline: { key: 'l', shfit: true, control: false } },\n// { freehandPolyline: { key: '', shfit: true, control: false } },\n// { polygon: { key: 'g', shfit: true, control: false } },\n// { freehandPolygon: { key: '', shfit: true, control: false } },\n// { textleaderline: { key: '', shfit: true, control: false } },\n// { singleArrow: { key: '', shfit: true, control: false } },\n// { doubleArrrow: { key: '', shfit: true, control: false } },\n","import { ImageAnnoApp } from '..';\nimport { IconAsset } from './ThemeRenderStyle/IconAsset';\nimport { ThemeObjectForStorymaps } from './ThemeRenderStyle/StorymapsThemeStructure';\nimport { ThemeRenderStyle } from './ThemeRenderStyle/ThemeRenderStyle';\nimport { Shortcut } from './Shortcut';\nexport class Customization {\n  public annotationInstance: ImageAnnoApp;\n  public iconAsset: IconAsset;\n  public themeRenderStyle: ThemeRenderStyle;\n  public shortcut: Shortcut;\n  public themeCurrent: ThemeObjectForStorymaps;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  constructor(annotationInstance: ImageAnnoApp, theme?: any) {\n    this.annotationInstance = annotationInstance;\n\n    if (!theme) {\n      theme = this.annotationInstance.implementations.app.model.assets.theme;\n    }\n\n    this.iconAsset = new IconAsset(this, theme);\n    this.themeRenderStyle = new ThemeRenderStyle(this, theme);\n    this.shortcut = new Shortcut(this, theme);\n  }\n  public downloadTheme() {\n    return this.themeCurrent.downloadJson();\n  }\n}\n","export abstract class AbstractCanvasDynamic {\n  public divHost: HTMLElement;\n  public canvas: HTMLCanvasElement;\n  public ctx: CanvasRenderingContext2D;\n  public canvasView: HTMLCanvasElement;\n  public ctxView: CanvasRenderingContext2D;\n  public canvasLoopController: CanvasLoopController;\n  public canvasOffScreen: AbstractCanvasOffScreen;\n  public id = 'canvas';\n  public zIndex = '1';\n  public loopNum = 0;\n  public needRenderloop = true;\n  public pause = false;\n  public deltaTime: Deltatime;\n  public frameRate = 60;\n  public isLoop = true;\n  public isViewChanging = false;\n  public isActive = false;\n  private _log: string;\n  // eslint:disable-next-line:no-any\n  public requestAnimationFrameRender: (callback: FrameRequestCallback) => number;\n\n  constructor(divHost: HTMLElement, id = 'canvas') {\n    this.divHost = divHost;\n    this.id = id;\n    this.initPre();\n  }\n  public initPre() {\n    this.canvasView = document.createElement('canvas');\n    this.canvasView.id = this.id;\n    this.canvasView.style.width = '100%';\n    this.canvasView.style.height = '100%';\n    this.canvasView.style.zIndex = this.zIndex;\n    this.canvasView.style.position = 'absolute';\n    this.canvasView.style.pointerEvents = 'none';\n    this.ctxView = this.canvasView.getContext('2d') as CanvasRenderingContext2D;\n    this.ctxView.globalCompositeOperation = 'source-over';\n    this.divHost.appendChild(this.canvasView);\n\n    // console.log(this.divHost.style.height, this.divHost.style.width);\n\n\n    // if(this.canvasView && this.divHost && this.canvasView.width) {\n    //     this.canvasView.width = +this.divHost.style.width;\n    //     this.canvasView.height = +this.divHost.style.height;\n    // }\n\n    this.canvas = document.createElement('canvas');\n    // this.canvas = canvas;\n    // console.log(this.canvas)\n    // console.log(this)\n    this.canvas.id = this.id;\n    this.canvas.style.width = '100%';\n    this.canvas.style.height = '100%';\n    this.canvas.style.zIndex = this.zIndex;\n    this.canvas.style.position = 'absolute';\n    this.canvas.style.pointerEvents = 'none';\n\n\n    this.ctx = this.canvas.getContext('2d') as CanvasRenderingContext2D;\n    this.ctx.globalCompositeOperation = 'source-over';\n\n    // if(this.canvasView && this.divHost, this.canvas.width) {\n    //     this.canvas.width = +this.divHost.style.width;\n    //     this.canvas.height = +this.divHost.style.height;\n    // }\n\n    this.deltaTime = new Deltatime();\n    this.canvasLoopController = new CanvasLoopController(100);\n    this.canvasLoopController.level = 4;\n\n    // eslint:disable-next-line:no-any\n    // requestAnimationFrame = (window as any).requestAnimationFrame || (window as any).mozRequestAnimationFrame || (window as any).webkitRequestAnimationFrame || (window as any).msRequestAnimationFrame || setTimeout;\n    // console.log(this.requestAnimationFrameRender);\n    // console.log(this)\n    this.init();\n    this.loop();\n  }\n  public init() {\n    //\n  }\n  public loop() {\n    if (!this.isActive) {\n      return;\n    }\n    // this._frame++;\n\n    // if ((this._frame % this._frameSkip) === 0) {\n    //     requestAnimationFrame(() => { this.Loop(); });\n    //     return;\n    // }\n    const before = performance.now();\n    this.deltaTime.updateFPS();\n    // console.log('looping...');\n    if (this.canvasLoopController.level > 3) {\n      if (this.canvasLoopController.level === 6) {\n        // level 6\n        requestAnimationFrame(() => {\n          this.loop();\n        });\n        this.clear();\n        this.render();\n      } else if (this.canvasLoopController.level === 5) {\n        if (this.isViewChanging) {\n          requestAnimationFrame(() => {\n            this.loop();\n          });\n        } else {\n          // setTimeout(() => {\n          requestAnimationFrame(() => {\n            this.loop();\n          });\n          // }, 1000 / this.frameRate);\n        }\n        this.clear();\n        this.render();\n      } else if (this.canvasLoopController.level === 4) {\n        if (this.isViewChanging) {\n          requestAnimationFrame(() => {\n            this.loop();\n          });\n        } else {\n          // setTimeout(() => {\n          requestAnimationFrame(() => {\n            this.loop();\n          });\n          // }, 1000 / this.frameRate);\n        }\n        if (!this.canvasLoopController.stop) {\n          this.clear();\n          this.render();\n          this.canvasLoopController.timerForStop();\n        } else {\n          return;\n        }\n      }\n    } else if (this.canvasLoopController.level === 1) {\n      // level 1 - 3\n      if (this.isViewChanging) {\n        this.clear();\n      } else {\n        this.clear();\n        this.render();\n      }\n    } else {\n      this.clear();\n      this.render();\n    }\n    const after = performance.now();\n    this.log = `level:  ${this.canvasLoopController.level}, total frames: ${this\n      .loopNum++} (FPS: ${this.deltaTime.frameRate.toFixed(0)}), a loop took: ${(\n      after - before\n    ).toFixed(2)} ms to execute.`;\n    this.logOut();\n  }\n  public set log(s: string) {\n    this._log = s;\n  }\n  public get log() {\n    return this._log;\n  }\n  abstract logOut(): void;\n  abstract render(): void;\n  public initOffscreen(canvasOffScreen: AbstractCanvasOffScreen): void {\n    this.canvasOffScreen = canvasOffScreen;\n  }\n  public resize(width: number, height: number) {\n    this.canvas.width = width;\n    this.canvas.height = height;\n  }\n  public clear() {\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    this.ctxView.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    if (this.canvasOffScreen) {\n      this.canvasOffScreen.clear();\n    }\n  }\n  public setLevel1() {\n    this.canvasLoopController.level = 1;\n    this.loop();\n  }\n  public setLevel2() {\n    this.canvasLoopController.level = 2;\n    this.loop();\n  }\n  public setLevel3() {\n    this.canvasLoopController.level = 3;\n    this.loop();\n  }\n  public renderSetLevel4() {\n    this.canvasLoopController.stop = true;\n  }\n  public setLevel4() {\n    this.canvasLoopController.reset();\n    setTimeout(() => {\n      this.canvasLoopController.level = 4;\n      this.loop();\n    }, 500);\n  }\n  public setLevel5() {\n    this.canvasLoopController.reset();\n    setTimeout(() => {\n      this.canvasLoopController.level = 5;\n      this.loop();\n    }, 500);\n  }\n  public setLevel6() {\n    this.canvasLoopController.reset();\n    setTimeout(() => {\n      this.canvasLoopController.level = 6;\n      this.loop();\n    }, 500);\n  }\n}\nexport class Deltatime {\n  public now: number;\n  public delta: number;\n  public frameRate: number;\n\n  private last = 0;\n  private timeLastRender: number;\n  msLoop: number;\n  constructor() {\n    //\n  }\n  public updateFPS() {\n    this.now = window.performance.now();\n    this.msLoop = this.now - this.last;\n    this.last = this.now;\n\n    this.delta = this.delta + Math.min(1, this.msLoop / 1000);\n\n    if (this.delta > this.frameRate) {\n      this.delta = this.delta - this.frameRate;\n    }\n\n    this.delta = (Date.now() - this.timeLastRender) / 1000;\n    this.timeLastRender = Date.now();\n    this.frameRate = 1 / this.delta;\n  }\n  public get dt() {\n    return this.delta;\n  }\n}\n\nexport class CanvasLoopController {\n  numStopFrame: number;\n  private _level = -1;\n  private _stop = false;\n  private numRender = 0;\n  constructor(numStopFrame: number) {\n    this.numStopFrame = numStopFrame;\n  }\n  public get stop() {\n    return this._stop;\n  }\n  public set stop(v: boolean) {\n    this.numRender = 0;\n    this._stop = v;\n  }\n  public timerForStop() {\n    this.numRender++;\n    // console.log(this.numRender);\n    if (this.numRender > this.numStopFrame) {\n      this.numRender = 0;\n      this.stop = true;\n    }\n  }\n  public reset() {\n    this._level = -1;\n  }\n  public get level() {\n    return this._level;\n  }\n  public set level(v: number) {\n    this._level = v;\n  }\n}\nexport abstract class AbstractCanvasOffScreen {\n  static instance: AbstractCanvasOffScreen;\n  hostCanvas: HTMLCanvasElement;\n  canvas: HTMLCanvasElement;\n  offScreenCtx: CanvasRenderingContext2D;\n  constructor(hostCanvas: HTMLCanvasElement) {\n    AbstractCanvasOffScreen.instance = this;\n    // debugger\n    this.hostCanvas = hostCanvas;\n    this.init();\n  }\n  public init() {\n    this.canvas = document.createElement('canvas');\n    this.canvas.id = 'OffScreen';\n    this.canvas.style.zIndex = '90';\n    this.canvas.style.position = 'absolute';\n    this.offScreenCtx = this.canvas.getContext('2d') as CanvasRenderingContext2D;\n\n    // debugger\n    this.canvas.width = this.hostCanvas.width;\n    this.canvas.height = this.hostCanvas.height;\n\n    // this.PushRendererToPreset();\n  }\n  public resizeCanvas(width: number, height: number) {\n    this.offScreenCtx.canvas.width = width;\n    this.offScreenCtx.canvas.height = height;\n  }\n  public clear() {\n    this.offScreenCtx.clearRect(\n      0,\n      0,\n      this.offScreenCtx.canvas.width,\n      this.offScreenCtx.canvas.height\n    );\n  }\n  abstract getColorByPos(x: number, y: number, c: string): string;\n  // abstract PushRendererToPreset(): void;\n}\n","import { AbstractCanvasDynamic } from './Utility/AbstractCanvasDynamic';\nimport { NVector3, Linecap } from '../../../../../lib';\nimport { CanvasWrapper } from '..';\nexport class ACanvas extends AbstractCanvasDynamic {\n  public canvasWrapper: CanvasWrapper;\n  public frameRate: number;\n  public canvas: HTMLCanvasElement;\n  // public hostDiv: HTMLElement;\n  public id: string;\n  public ctx: CanvasRenderingContext2D;\n  public xOff: number;\n  public yOff: number;\n  public xOffCurrent: number;\n  public yOffCurrent: number;\n  public xOffPre: number;\n  public yOffPre: number;\n  public anchor: NVector3;\n  public zoomFactor: number;\n  public zoomFactorPre: number;\n  public zoomFactorCurrent: number;\n  public div3d: HTMLDivElement;\n  // smoothingEnabled: boolean = true;\n  // theContext: CanvasRenderingContext2D;\n  public dropRate: number;\n  public isLoop: boolean;\n  public timeLastRender: number;\n  public delta: number;\n  public now: number;\n  public then = 0;\n  public interval = 0;\n  public last = 0;\n  public frameVisTimer: number;\n  public theDate: Date;\n  public asyncSafeGuard = 0;\n  public time = 0;\n  private _isRenderSkip: boolean;\n  // private _frame: number = 0;\n  private _frameSkip = 3;\n  constructor(canvasWrapper: CanvasWrapper, frameRate = 60) {\n    super(\n      canvasWrapper.graphicsCoreWrapper.imageAnnoApp.implementations.app.model.modelViewWrapper.div,\n      'AnnotationImageTool'\n    );\n    this.canvasWrapper = canvasWrapper;\n\n    this.xOff = 0;\n    this.yOff = 0;\n    this.xOffCurrent = 0;\n    this.yOffCurrent = 0;\n    this.xOffPre = 0;\n    this.yOffPre = 0;\n    this.anchor = new NVector3(0, 0, 0);\n    this.timeLastRender = 0;\n    this.delta = 0;\n    this.frameVisTimer = 0.05; // sec\n    this.dropRate = 30;\n    this.IsRenderSkip = true;\n    this.isLoop = true;\n\n    this.frameRate = frameRate;\n    this.deltaTime.frameRate = frameRate;\n    this.setLevel6(); // as default\n    this.frameSkip = 3;\n\n    // this.canvasView.style.setProperty('mix-blend-mode', COLOR_BLENDING.COLOR_DODGE);\n    // canvasStatic.style.setProperty('mix-blend-mode', COLOR_BLENDING.COLOR_DODGE);\n\n    // console.log()\n  }\n  public get frameSkip() {\n    return this._frameSkip;\n  }\n  public set frameSkip(v: number) {\n    this._frameSkip = v;\n  }\n  public initPost(rendererActive: boolean) {\n    this.isActive = rendererActive;\n    this.ctx.lineCap = Linecap.Round;\n  }\n  set imageSmoothingEnabled(v: boolean) {\n    this.ctx.imageSmoothingEnabled = v;\n    this.ctxView.imageSmoothingEnabled = v;\n  }\n  public getImageData() {\n    return this.ctx.getImageData(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\n  }\n  public render() {\n    // if (this.IsRenderSkip) {\n    //     if ((this._frame++ % this._frameSkip) === 0) {\n    //         // console.log('skip');\n    //         return;\n    //     }\n    // }\n\n    this.clearPost();\n\n    this.time += 0.001;\n    // console.log(this.time);\n    if (!this.isActive) {\n      // ................... for clear all screen\n      this.canvasWrapper.aCanvasOffScreen.clear();\n      this.ctxView.clearRect(0, 0, this.ctxView.canvas.width, this.ctxView.canvas.height);\n      return;\n    }\n    // if ( this.canvasWrapper && this.canvasWrapper.aCanvasOffScreen ) {\n    this.canvasWrapper.aCanvasOffScreen.clear();\n    // }\n    // if (this.canvasWrapper && this.canvasWrapper.graphicsCoreWrapper.rendererWrapper) {\n    this.canvasWrapper.graphicsCoreWrapper.rendererWrapper.render(this.ctx);\n    // }\n\n    this.ctxView.clearRect(0, 0, this.ctxView.canvas.width, this.ctxView.canvas.height);\n\n    if (this.canvas.width !== 0 && this.canvas.height !== 0) {\n      this.ctxView.drawImage(this.canvas, 0, 0);\n    } else {\n      this.isLoop = false;\n      this.isActive = false;\n      this.canvasLoopController.stop = true;\n    }\n  }\n  public clear() {\n    // Overriding\n  }\n  public clearPost() {\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    this.ctxView.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    if (this.canvasOffScreen) {\n      this.canvasOffScreen.clear();\n    }\n  }\n  public resizeCanvas(width: number, height: number) {\n    this.ctx.canvas.width = width;\n    this.ctx.canvas.height = height;\n    this.ctxView.canvas.width = width;\n    this.ctxView.canvas.height = height;\n  }\n  public destroy() {\n    this.setLevel1();\n    this.isLoop = false;\n    this.isActive = false;\n    this.canvasLoopController.stop = true;\n    this.loop = () => {\n      return;\n    };\n    this.render = () => {\n      return;\n    };\n    if (this.canvas.parentNode) {\n      this.canvas.parentNode.removeChild(this.canvas);\n    }\n  }\n  public logOut(): void {\n    // try {\n    //   if (this.canvasWrapper.graphicsCoreWrapper.annotationInstance.uiWrapper) {\n    //     this.canvasWrapper.graphicsCoreWrapper.annotationInstance.uiWrapper.log.canvasLog.text = this.log;\n    //   }\n    // } catch (error) {\n    //   //\n    // }\n  }\n  public get IsRenderSkip() {\n    return this._isRenderSkip;\n  }\n  public set IsRenderSkip(v: boolean) {\n    this._isRenderSkip = v;\n    // this.appAnnotation.appCoreWrapper.appProperties.isRenderSkip = v;\n  }\n  public doPause(t = 0) {\n    this.isActive = false;\n    this.canvasWrapper.aCanvasOffScreen.clear();\n    this.ctxView.clearRect(0, 0, this.ctxView.canvas.width, this.ctxView.canvas.height);\n    if (t > 0) {\n      setTimeout(() => {\n        this.doResume();\n      }, t);\n    }\n  }\n  public doResume() {\n    this.isActive = true;\n    this.isLoop = true;\n    this.canvasWrapper.renderForce();\n    this.loop();\n  }\n}\n","import { CanvasWrapper } from '..';\nexport class ACanvasMask {\n  public canvasWrapper: CanvasWrapper;\n  public canvas: HTMLCanvasElement;\n  public ctx: CanvasRenderingContext2D;\n  public isActive = true;\n  private _maskColor: string;\n  private _width: number;\n  constructor(canvasWrapper: CanvasWrapper) {\n    this.canvasWrapper = canvasWrapper;\n    this._maskColor = '#000000';\n    if (\n      this.canvasWrapper.graphicsCoreWrapper.imageAnnoApp.implementations.app.model.appCoreWrapper\n        .appProperties.isStandalone\n    ) {\n      this._width = 0;\n    } else {\n      this._width = 0;\n    }\n    this.init();\n  }\n  public init() {\n    //  esri-view-surface\n    this.canvas = document.createElement('canvas');\n    this.canvas.id = 'AnnotationImageToolMask';\n    this.canvas.style.zIndex = '1'; // 5\n    this.canvas.style.position = 'absolute';\n    this.canvas.style.pointerEvents = 'none';\n    this.ctx = this.canvas.getContext('2d') as CanvasRenderingContext2D;\n\n    this.canvasWrapper.graphicsCoreWrapper.imageAnnoApp.implementations.app.model.modelViewWrapper.div.appendChild(\n      this.canvas\n    );\n    this.ctx.globalCompositeOperation = 'source-over';\n\n    // if (this.canvasWrapper.graphicsCoreWrapper.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.mapView) {\n    //   this.canvas.width = this.canvasWrapper.graphicsCoreWrapper.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.mapView.width;\n    //   this.canvas.height = this.canvasWrapper.graphicsCoreWrapper.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.mapView.height;\n    // } else {\n    this.canvas.width = 1;\n    this.canvas.height = 1;\n    // }\n    // console.log('mask init', this.canvas);\n    this.renderMask();\n  }\n  get maskColor() {\n    return this._maskColor;\n  }\n  set maskColor(c: string) {\n    this._maskColor = c;\n    this.renderMask();\n  }\n  get width() {\n    return this._width;\n  }\n  set width(n: number) {\n    this._width = n;\n    this.renderMask();\n  }\n  public resizeCanvas(width: number, height: number) {\n    this.canvas.width = width;\n    this.canvas.height = height;\n    this.renderMask();\n  }\n  public renderMask() {\n    if (!this.isActive) {\n      return;\n    }\n    // console.log('mask render');\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    this.ctx.lineWidth = 0;\n    this.ctx.strokeStyle = this._maskColor;\n    this.ctx.fillStyle = this._maskColor;\n    this.ctx.beginPath();\n    this.ctx.rect(0, 0, this._width, this.canvas.height);\n    this.ctx.rect(this.canvas.width - this._width, 0, this.canvas.width, this.canvas.height);\n    this.ctx.closePath();\n    this.ctx.fill();\n    // this.ctx.stroke();\n  }\n}\n","import { AbstractCanvasOffScreen } from './AbstractCanvasDynamic';\nimport { CanvasWrapper } from '../..';\nexport class ACanvasOffScreen extends AbstractCanvasOffScreen {\n  // static instance: ACanvasOffScreen;\n  public canvasWrapper: CanvasWrapper;\n  public canvas: HTMLCanvasElement;\n  public isActive = true;\n  public offScreenCtx: CanvasRenderingContext2D;\n  constructor(canvasWrapper: CanvasWrapper) {\n    super(canvasWrapper.aCanvas.canvas);\n    this.canvasWrapper = canvasWrapper;\n    // ACanvasOffScreen.instance = this;\n    this.canvas.id = 'AnnotationOffScreen';\n    this.offScreenCtx.imageSmoothingEnabled = false;\n    // this.init(); // it executes in abstract class\n    // this.appendDiv();\n  }\n  public appendDiv() {\n    this.canvasWrapper.graphicsCoreWrapper.imageAnnoApp.implementations.app.model.modelViewWrapper.div.appendChild(\n      this.canvas\n    );\n  }\n  public removeDiv() {\n    this.canvasWrapper.graphicsCoreWrapper.imageAnnoApp.implementations.app.model.modelViewWrapper.div.removeChild(\n      this.canvas\n    );\n  }\n  public getOffscreenRenderer() {\n    return this.offScreenCtx;\n  }\n  public clear() {\n    this.offScreenCtx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n  }\n  public getColorByPos(x: number, y: number) {\n    if (!this.isActive) {\n      return '';\n    }\n    const pixel = this.offScreenCtx.getImageData(x, y, 1, 1).data;\n    const col = `rgb(${pixel[0]},${pixel[1]},${pixel[2]})`;\n    return col;\n  }\n}\n","import { GraphicsCoreWrapper } from '..';\nimport { ACanvas } from './Canvas/ACanvas';\nimport { ACanvasMask } from './Canvas/ACanvasMask';\nimport { ACanvasOffScreen } from './Canvas/Utility/ACanvasOffScreen';\nexport class CanvasWrapper {\n  public graphicsCoreWrapper: GraphicsCoreWrapper;\n  public aCanvas: ACanvas;\n  public aCanvasMask: ACanvasMask;\n  public aCanvasOffScreen: ACanvasOffScreen;\n  constructor(graphicsCoreWrapper: GraphicsCoreWrapper, rendererActive: boolean) {\n    this.graphicsCoreWrapper = graphicsCoreWrapper;\n\n    this.aCanvas = new ACanvas(this);\n    // debugger\n    this.aCanvas.setLevel4();\n    this.aCanvasOffScreen = new ACanvasOffScreen(this);\n    this.aCanvasMask = new ACanvasMask(this);\n    this.aCanvas.initPost(rendererActive);\n  }\n  public pause(t = 0) {\n    this.aCanvas.doPause(t);\n  }\n  public resume() {\n    this.aCanvas.doResume();\n  }\n  public destroy() {\n    this.aCanvas.destroy();\n    this.isActive = false;\n  }\n  public renderForce() {\n    this.aCanvas.canvasLoopController.stop = false;\n  }\n  public resizeCanvas(width: number, height: number) {\n    this.aCanvas.resizeCanvas(width, height);\n    // if (!this.graphicsCoreWrapper.model.appCoreWrapper.arcGISWrapper.isCustomAPI) {return; }\n    // const w = this.graphicsCoreWrapper.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.GetMapMargin();\n    // if (w) {\n    //   // if (w > 0) {\n    //   this.aCanvasMask.width = w;\n    // }\n    if (this.aCanvasOffScreen) {\n      this.aCanvasOffScreen.canvas.width = width;\n      this.aCanvasOffScreen.canvas.height = height;\n\n      this.aCanvasOffScreen.canvas.style.width = this.aCanvas.canvas.style.width\n      this.aCanvasOffScreen.canvas.style.height = this.aCanvas.canvas.style.height\n    }\n  }\n  set isActive(v: boolean) {\n    this.aCanvas.isActive = v;\n    this.aCanvasOffScreen.isActive = v;\n    this.aCanvasMask.isActive = v;\n    if (v) {\n      this.aCanvas.loop();\n      // this.renderForce();\n    }\n  }\n}\n","import { GraphicsCoreWrapper } from '..';\n\nexport class RendererWrapper {\n  public graphicsCoreWrapper: GraphicsCoreWrapper;\n  constructor(graphicsCoreWrapper: GraphicsCoreWrapper) {\n    this.graphicsCoreWrapper = graphicsCoreWrapper;\n  }\n  public resizeCanvas(width: number, height: number) {\n    this.graphicsCoreWrapper.canvasWrapper.resizeCanvas(width, height);\n  }\n  public render(ctx: CanvasRenderingContext2D) {\n    // if (this.graphicsCoreWrapper.model.app.implementation) {\n    this.graphicsCoreWrapper.imageAnnoApp.implementations.render(ctx);\n    // }\n  }\n}\n","import { ImageAnnoApp } from '..';\nimport { CanvasWrapper } from './CanvasWrapper';\nimport { RendererWrapper } from './RendererWrapper';\n\nexport class GraphicsCoreWrapper {\n  public imageAnnoApp: ImageAnnoApp;\n\n  public canvasWrapper: CanvasWrapper;\n  public rendererWrapper: RendererWrapper;\n  public scaleScreenByRatioImageSize = 1;\n\n  constructor(annotationInstance: ImageAnnoApp, rendererActive: boolean) {\n    this.imageAnnoApp = annotationInstance;\n    this.canvasWrapper = new CanvasWrapper(this, rendererActive);\n  }\n  public initPost() {\n    this.rendererWrapper = new RendererWrapper(this);\n    // this.canvasWrapper.InitPost();\n  }\n  public pause(t = 0) {\n    this.canvasWrapper.pause(t);\n  }\n  public resume() {\n    this.canvasWrapper.resume();\n  }\n  public resizeCanvas(width: number, height: number) {\n    this.canvasWrapper.resizeCanvas(width, height);\n  }\n  public renderForce() {\n    this.canvasWrapper.renderForce();\n  }\n  public destroy() {\n    this.canvasWrapper.destroy();\n  }\n}\n","import {\n  ActionType, ActiveCommandMode, Apps, CompileMode\n} from '../../../../lib';\nimport { IOGeometry } from '../../../../lib/Extended/GeometryUtility';\nimport { IOAnnotationInstance } from '..';\nexport const delimiter = '@';\nexport class EventListenerAnnotation {\n  public io: IOAnnotationInstance;\n  public numOfCommand: number;\n  public log = false;\n  constructor(io: IOAnnotationInstance) {\n    this.io = io;\n    this.init();\n  }\n  public init() {\n    this.numOfCommand = 0;\n  }\n  public shiftCAMode(ac: ActiveCommandMode) {\n    if (this.log) {\n      // console.log('active command stack');\n    }\n    const d = 'set-drawing-mode' + delimiter + ac.toString();\n    this.io.emitAction(d);\n  }\n  public shiftOptionStack(command: string, v: boolean) {\n    const d = `${command}${delimiter}${v}`;\n    this.io.emitAction(d);\n  }\n  public modificationStack(d: IOGeometry | undefined) {\n    if (this.log) {\n      // console.log('modification stack');\n    }\n    if (!d) {\n      return;\n    }\n  }\n  public addGeometryStack(d: IOGeometry | undefined) {\n    if (this.log) {\n      // console.log('add stack');\n    }\n    // if ( this.io.annotationInstance.implementations.app.model.appCoreWrapper.appProperties.isStandalone) { return; }\n    if (!d) {\n      return;\n    }\n    const geoData = 'add' + delimiter + JSON.stringify(d);\n    this.numOfCommand++;\n\n    this.io.emitAction(geoData);\n    this.io.imageAnnoApp.scene.captureScene();\n  }\n  public selectionStack(d: IOGeometry | undefined): void {\n    if (this.log) {\n      // console.log('selection stack');\n    }\n    if (!d) {\n      return;\n    }\n    if (d.isSelected) {\n      const geoData = `select${delimiter}${JSON.stringify([d.id])}`;\n\n      if (this.io.imageAnnoApp.activeCommandController.acProperties.pressShift) {\n        if (this.io.imageAnnoApp.implementations.app.APP === Apps.AnnotationMap) {\n          const othersIDs = this.io.imageAnnoApp.geometryCommon.gcmdProcessing.getSelectedGeoIDs();\n          if (othersIDs.length) {\n            this.selectionsStackByID(othersIDs);\n            return;\n          }\n        }\n      }\n\n      if (\n        this.io.imageAnnoApp.implementations.app.model.appCoreWrapper.appProperties.compileMode !==\n        CompileMode.Production\n      ) {\n        this.numOfCommand++;\n        this.io.emitAction(geoData);\n      } else {\n        this.io.emitAction(geoData);\n      }\n    } else {\n      const geoData = `deselect${delimiter}${JSON.stringify([d.id])}`;\n      this.numOfCommand++;\n      this.io.emitAction(geoData);\n    }\n\n    // EventListenerML.app.Capture();\n  }\n  public selectionsStackByID(ids: string[]): void {\n    if (this.log) {\n      // console.log('selections stack');\n    }\n    const geoData = `select${delimiter}${JSON.stringify(ids)}`;\n    this.numOfCommand++;\n    this.io.emitAction(geoData);\n  }\n  public hideStack(d: IOGeometry | undefined) {\n    if (this.log) {\n      // console.log('hide stack');\n    }\n    if (!d) {\n      return;\n    }\n    if (d.isHidden) {\n      const geoData = 'hide' + delimiter + d.id;\n      this.numOfCommand++;\n      this.io.emitAction(geoData);\n    } else {\n      const geoData = 'show' + delimiter + d.id;\n      this.numOfCommand++;\n      this.io.emitAction(geoData);\n    }\n  }\n  public hoverStack(d: IOGeometry | undefined): void {\n    if (this.log) {\n      // console.log('hover stack');\n    }\n    if (!d) {\n      return;\n    }\n    if (d.isOver) {\n      const geoData = 'enter' + delimiter + d.id;\n      this.numOfCommand++;\n      this.io.emitAction(geoData);\n    } else {\n      const geoData = 'leave' + delimiter + d.id;\n      this.numOfCommand++;\n      // console.log(geoData);\n      this.io.emitAction(geoData);\n    }\n  }\n  public hoverPostStack(d: IOGeometry | undefined): void {\n    if (this.log) {\n      // console.log('hoverPost stack');\n    }\n    if (!d) {\n      return;\n    }\n    if (d.isOver) {\n      const geoData = 'enterPost' + delimiter + d.id;\n      this.numOfCommand++;\n      this.io.emitAction(geoData);\n    }\n  }\n  public updateStack(d: IOGeometry | undefined): void {\n    if (this.log) {\n      // console.log('update stack');\n    }\n    if (!d) {\n      return;\n    }\n    const geoData = 'update' + delimiter + JSON.stringify({ id: d.id, content: d.data.content }); // // only update text content\n    this.numOfCommand++;\n    // console.log(geoData);\n    this.io.emitAction(geoData);\n  }\n  public showPopupStack(d: IOGeometry | undefined) {\n    if (this.log) {\n      // console.log('show popup stack');\n    }\n    if (!d) {\n      return;\n    }\n    const geoData = 'showPopup' + delimiter + JSON.parse(JSON.stringify(d)).id;\n    this.numOfCommand++;\n    this.io.emitAction(geoData);\n  }\n  public hidePopupStack(d: IOGeometry | undefined) {\n    if (this.log) {\n      // console.log('hide popup stack');\n    }\n    if (!d) {\n      return;\n    }\n    const geoData = 'hidePopup' + delimiter + JSON.parse(JSON.stringify(d)).id;\n    this.numOfCommand++;\n    this.io.emitAction(geoData);\n  }\n  public showTextStack(d: IOGeometry | undefined) {\n    if (this.log) {\n      // console.log('show text stack');\n    }\n    if (!d) {\n      return;\n    }\n    const geoData = 'showText' + delimiter + JSON.parse(JSON.stringify(d)).id;\n    this.numOfCommand++;\n    this.io.emitAction(geoData);\n  }\n  public hideTextStack(d: IOGeometry | undefined) {\n    if (this.log) {\n      // console.log('hide text stack');\n    }\n    if (!d) {\n      return;\n    }\n    const geoData = 'hideText' + delimiter + JSON.parse(JSON.stringify(d)).id;\n    this.numOfCommand++;\n    this.io.emitAction(geoData);\n  }\n  public startEditingText(d: IOGeometry | undefined) {\n    if (this.log) {\n      // console.log('start editing stack');\n    }\n    if (!d) {\n      return;\n    }\n    const geoData = 'startEditingText' + delimiter + d.id;\n    this.numOfCommand++;\n    // console.log(geoData);\n    this.io.emitAction(geoData);\n  }\n  public endEditingText(d: IOGeometry | undefined) {\n    if (this.log) {\n      // console.log('end editing stack');\n    }\n    if (!d) {\n      return;\n    }\n    const geoData = 'endEditingText' + delimiter + d.id;\n    this.numOfCommand++;\n    // console.log(geoData);\n    this.io.emitAction(geoData);\n  }\n  public initGhostStack(d: IOGeometry | undefined) {\n    if (this.log) {\n      // console.log('init ghost stack');\n    }\n    if (!d) {\n      return;\n    }\n    const geoData = 'add' + delimiter + JSON.stringify(d);\n    this.numOfCommand++;\n    // console.log('init ghost stack');\n    // console.log(geoData);\n    this.io.emitAction(geoData);\n  }\n  public showGhostPopupStack(d: IOGeometry | undefined) {\n    if (this.log) {\n      // console.log('show ghost stack');\n    }\n    if (!d) {\n      return;\n    }\n    // const geoData = 'showGhostPopup' + delimiter + JSON.parse(JSON.stringify(d)).id;\n    const geoData =\n      'showGhostPopup' + delimiter + JSON.stringify({ id: 'ghost', mapping: d.data.content });\n    this.numOfCommand++;\n    // console.log(d);\n    // console.log(geoData);\n    this.io.emitAction(geoData);\n  }\n  public hideGhostPopupStack() {\n    if (this.log) {\n      // console.log('hide ghost stack');\n    }\n    const geoData = 'hideGhostPopup';\n    this.io.emitAction(geoData);\n  }\n  public removeGeometryStack(d: IOGeometry[] | undefined) {\n    if (this.log) {\n      // console.log('remove stack');\n    }\n    if (!d) {\n      return;\n    }\n    let geoData = 'remove' + delimiter;\n    const stringData: string[] = [];\n    d.forEach((g: IOGeometry) => {\n      stringData.push(g.id);\n    });\n    this.numOfCommand++;\n    geoData += JSON.stringify(stringData);\n\n    this.io.emitAction(geoData);\n    this.io.imageAnnoApp.scene.captureScene();\n  }\n  public transformStack(d: IOGeometry[]): void {\n    if (this.log) {\n      // console.log('transform stack');\n    }\n    if (!d) {\n      return;\n    }\n    const geoData = 'transform' + delimiter + JSON.stringify(d);\n    // let stringData: string[] = [];\n    // d.forEach( (g: IOGeometry) => {\n    //     stringData.push(g);\n    // });\n    // const geoData = 'transform' + delimiter + JSON.stringify(d);\n    // if (this.io.annotationInstance.uiWrapper) {\n    //   let text =\n    //     this.numOfCommand.toString() +\n    //     ' : --- ACTION NUMBER ---  /' +\n    //     geoData +\n    //     '/' +\n    //     this.io.annotationInstance.uiWrapper.log.actionHistory.text.toString();\n\n    //   this.io.annotationInstance.uiWrapper.log.actionHistory.text = text;\n    // }\n    this.numOfCommand++;\n\n\n    this.io.emitAction(geoData);\n    this.io.imageAnnoApp.scene.captureScene();\n  }\n  public pointerOutStack() {\n    if (this.log) {\n      // console.log('pointer out stack');\n    }\n    const geoData = ActionType.PointerOut;\n    this.io.emitAction(geoData);\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public getActionString(actionType: string, payload: string | any) {\n    return `${actionType}${delimiter}${\n      typeof payload === 'string' ? payload : JSON.stringify(payload)\n    }`;\n  }\n  public addBase64Stack(id: string, value: string) {\n    const action = `addBase64${delimiter + id + delimiter + value}`;\n    this.io.emitAction(action);\n  }\n  public base64Stack(id: string, value: string) {\n    const action = `addBase64${delimiter + id + delimiter + value}`;\n    this.io.emitAction(action);\n  }\n  public selectBase64(id: string) {\n    const action = `selectBase64${delimiter}${id}`;\n    this.io.emitAction(action);\n  }\n}\n","import { IOGeometry } from '../../../../lib/Extended/GeometryUtility';\nimport { Shape } from '../../../../lib/IOGeometry/ExpressImageDrawingType';\nimport {\n  getVecforGraphicApp,\n  ActionType,\n  ActiveCommandMode,\n  GType\n} from '../../../../lib';\nimport { delimiter } from '../../../../Model/IOWrapper/EmitAction/EmitAction';\nimport { ThemeColorId } from '../../Customization/ThemeRenderStyle/Utility';\nimport { IOAnnotationInstance } from '..';\nexport class StateProcessingAnnotation {\n  public io: IOAnnotationInstance;\n  constructor(io: IOAnnotationInstance) {\n    this.io = io;\n  }\n  public pushActionTyped(v: { type: ActionType | string; payload: unknown }) {\n    // console.log(v.payload)\n    switch (v.type) {\n      case ActionType.Style:\n        this.io.imageAnnoApp.geometryCommon.gcmdProcessing.updateStyleCustom(v.payload);\n        break;\n      case ActionType.ClusteringPoint:\n        this.io.imageAnnoApp.apiWrapper.environment.toggleClusteringPoint(v.payload as boolean);\n        break;\n      // case ActionType.TEMP_loadImage:\n      //   this.io.imageAnnoApp.apiWrapper.environment.updateIconPoint(v.payload);\n      // case ActionType.Unhighlight:\n      //   // this.io.annotationInstance.geometryCommon.gcmdProcessing.Unhighlight();\n      //   this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n      //   break;\n      case ActionType.Hover:\n        // this.io.annotationInstance.geometryCommon.gcmdProcessing.HoverTourPoints(v.payload as string);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.Unhover:\n        // this.io.annotationInstance.geometryCommon.gcmdProcessing.UnhoverTourPoints();\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      default:\n        break;\n    }\n  }\n  // dump@{ \"1db11475-8a3f-4820-a051-dde633adeb83 \" : { \"id\":\"1db11475-8a3f-4820-a051-dde633adeb83\",\"type\":\"POINT_REGULAR\",\"style\":0,\"vertices\":[{\"x\":31.10949933528072,\"y\":1.3895913449321995,\"z\":0,\"w\":0}],\"data\":{\"content\":\"\",\"font\":\"\"}}}\n  public pushAction(v: string | { type: ActionType | string; payload: unknown }) {\n    // console.log(v);\n    if (typeof v === 'string') {\n      this.doAction(v);\n    } else if (typeof v === 'object') {\n      this.pushActionTyped(v);\n    }\n  }\n  private doAction(actionIn: string) {\n    // console.log('d-------------'); // 'toggleMapfilter@true'\n    // console.log(actionIn);\n    // let skip = true; if (skip) { return; }\n\n    // Only one `delimiter` in the `a` string\n    const index = actionIn.indexOf(delimiter);\n    const action = index < 0 ? [actionIn] : [actionIn.substring(0, index), actionIn.substring(index + 1, actionIn.length)];\n    const id = action[1];\n    const geoList = this.io.imageAnnoApp.scene.geometryList;\n    let g = this.io.imageAnnoApp.scene.geometryList.length;\n    switch (action[0]) {\n      case 'style':\n        // eslint-disable-next-line no-case-declarations\n        const obj = JSON.parse(action[1]);\n        this.io.imageAnnoApp.geometryCommon.gcmdProcessing.updateStyleCustom(obj);\n        break;\n      case ActionType.SetDrawingMode:\n        // eslint-disable-next-line no-case-declarations\n        const acMode = action[1] as ActiveCommandMode;\n\n        // if (acMode === ActiveCommandMode.POLYLINE) {\n        //     acMode = ActiveCommandMode.POLYLINE_BENDING_GRAPH;\n        // }\n        // EventListenerML.app.Capture(acMode);\n        this.io.imageAnnoApp.activeCommandController.setActiveCommand(\n          this.io.mappingCommand(acMode) as ActiveCommandMode\n        );\n        // this.model.controllerWrapperShiftCAMode(acMode);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.ActiveColorId: // ActiveColorId@\n        this.io.imageAnnoApp.activeCommandController.setActiveColor(action[1] as ThemeColorId);\n        break;\n      case ActionType.ToggleMapfilter:\n        this.io.imageAnnoApp.apiWrapper.environment.toggleMapfilter(id);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case 'sliderValue':\n        // this.io.imageAnnoApp.mapticon.pathTvalue = +action[1];\n        // this.io.annotationInstance.apiWrapper.environment.toggleActiveCommandChain(id);\n        // this.io.annotationInstance.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case 'sizeBrush':\n        // this.io.imageAnnoApp.sketch.setSizeBrush(+action[1]);\n        break;\n      case 'setSketchColor':\n        // this.io.imageAnnoApp.sketch.setColor(action[1]);\n        break;\n      case 'sizeCanvas':\n        const datad = JSON.parse(JSON.stringify(action[1]));\n        // console.log('sizeCanvas', datad);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.updateCanvasSize(datad);\n        // this.io.imageAnnoApp.sketch.setColor(action[1]);\n        break;\n      case 'typeBrush':\n        // this.io.imageAnnoApp.sketch.setTypeBrush(+action[1]);\n        break;\n      case ActionType.ToggleQuickActions:\n        this.io.imageAnnoApp.apiWrapper.environment.toggleActiveCommandChain(id);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.Undo:\n        this.io.imageAnnoApp.geometryCommon.gcmdProcessing.undo();\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.Redo:\n        this.io.imageAnnoApp.geometryCommon.gcmdProcessing.redo();\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.ChangeTheme:\n        // this.io.annotationInstance.activeCommandController.ChangeTheme(id);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.ToggleDrawingTooltips:\n        this.io.imageAnnoApp.apiWrapper.environment.toggleDrawingTooltips(id);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.ToggleGrid:\n        this.io.imageAnnoApp.apiWrapper.environment.toggleGrid(id);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.ToggleMeasure:\n        this.io.imageAnnoApp.apiWrapper.environment.toggleMeasure(id);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.ShiftUnit:\n        this.io.imageAnnoApp.apiWrapper.environment.shiftUnit();\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.DumpIconsBase64s:\n        // ................................................................. update extent with mask\n        // this.io.annotationInstance.geometryCommon.gcmdSupporting.RenderForceMask();\n        // this.io.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.extent.Update();\n        // ................................................................. end update extent with mask\n        // eslint-disable-next-line no-case-declarations\n        const iconList = JSON.parse(action[1]);\n        Object.keys(iconList).forEach((key) => {\n          if (!this.io.imageAnnoApp) {\n            return;\n          }\n          this.io.imageAnnoApp.activeCommandController.base64Processing(\n            'addBase64',\n            key,\n            iconList[key]\n          );\n        });\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.AddIconBase64:\n        // eslint-disable-next-line no-case-declarations\n        const dataBase64 = JSON.parse(action[1]);\n        Object.keys(dataBase64).forEach((key) => {\n          this.io.imageAnnoApp.activeCommandController.base64Processing(\n            action[0],\n            key,\n            dataBase64[key]\n          );\n        });\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.SelectIconBase64:\n        this.io.imageAnnoApp.activeCommandController.base64Processing(action[0], action[1]);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.InclusiveSelect:\n        while (g--) {\n          if (geoList[g].id === id) {\n            geoList[g].isSelected = true;\n            break;\n          }\n        }\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.InclusiveDeselect:\n        while (g--) {\n          if (geoList[g].id === id) {\n            geoList[g].isSelected = false;\n            break;\n          }\n        }\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.ExclusiveSelect:\n        while (g--) {\n          if (geoList[g].id === id) {\n            geoList[g].isSelected = true;\n          } else if (geoList[g].isSelected) {\n            geoList[g].isSelected = false;\n          }\n        }\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.ExclusiveDeselect:\n        while (g--) {\n          if (geoList[g].id !== id && geoList[g].isSelected) {\n            geoList[g].isSelected = false;\n          }\n        }\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.Remove:\n        this.io.imageAnnoApp.geometryCommon.gcmdProcessing.removeByIDs(action[1]);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.RemoveSelected:\n        this.io.imageAnnoApp.geometryCommon.gcmdProcessing.removeAllCapturedGeoGroup();\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.Update:\n        this.io.imageAnnoApp.activeCommandController.processingUpdate(\n          JSON.parse(action[1]).id,\n          action[1]\n        ); // only update text content\n        // console.log(JSON.parse(action[1]).id, action[1]);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.ReorderNumberedPoints:\n        this.io.imageAnnoApp.geometryCommon.gcmdProcessing.reorderNumberedPoints(JSON.parse(id));\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.ReorderNumberedTourPoints:\n        // this.io.annotationInstance.geometryCommon.gcmdProcessing.ReorderNumberedTourPoints(JSON.parse(id));\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.Unhighlight:\n        // this.io.annotationInstance.geometryCommon.gcmdProcessing.Unhighlight();\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.Hover:\n        // this.io.annotationInstance.geometryCommon.gcmdProcessing.HoverTourPoints(id);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.Unhover:\n        // this.io.annotationInstance.geometryCommon.gcmdProcessing.UnhoverTourPoints();\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.Enter:\n        while (g--) {\n          if (geoList[g].id === id) {\n            geoList[g].isHover = true;\n\n            if (geoList[g].isHiddenValue) {\n              geoList[g].renderer.tOver = 0.0;\n              geoList[g].visibility = 0.2;\n            } else {\n              geoList[g].visibility = 1;\n            }\n          } else if (geoList[g].isHover) {\n            geoList[g].isHover = false;\n\n            if (geoList[g].isHiddenValue) {\n              geoList[g].visibility = 0;\n            } else {\n              geoList[g].visibility = 1;\n            }\n          }\n        }\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.Leave:\n        while (g--) {\n          // if (geoList[g].IsHover) {\n          geoList[g].isHover = false;\n          // geoList[g].tOverPopupSummary = 0;\n          // geoList[g].HidePopUpSummary();\n          // }\n          if (geoList[g].isHiddenValue) {\n            geoList[g].visibility = 0;\n          }\n        }\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.Show:\n        this.io.imageAnnoApp.activeCommandController.unhide(JSON.parse(action[1]));\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.Hide:\n        this.io.imageAnnoApp.activeCommandController.hide(JSON.parse(action[1]));\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.HidePopup:\n        while (g--) {\n          if (geoList[g].id === id) {\n            geoList[g].hidePopUpSummary();\n          }\n        }\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.ShowPopup:\n        while (g--) {\n          if (geoList[g].id === id) {\n            geoList[g].showPopupSummary();\n          }\n        }\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.Dump:\n        // ................................................................. remove popup for undo / redo\n        // if (this.io.annotationInstance.implementations.app.APP === APPS.ANNOTATION_MAP) {\n        this.io.imageAnnoApp.geometryCommon.gcmdSelecting.deSelectAllObjects();\n        this.io.imageAnnoApp.geometryCommon.gcmdProcessing.removeAllCapturedGeo();\n        // }\n        // ................................................................. update extent with mask\n        // this.io.annotationInstance.geometryCommon.gcmdSupporting.RenderForceMask();\n        // this.io.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.extent.Update();\n        // ................................................................. end update extent with mask\n        // const shapes = new Map(JSON.parse(id));\n        // eslint-disable-next-line no-case-declarations\n        const geoms = new Map<string, IOGeometry>();\n        // shapes.forEach((shape: Shape, key: string) => { geoms.set(key, this.convertShapeToIOGeometry(shape)); });\n        // eslint-disable-next-line no-case-declarations\n        const shapes = JSON.parse(id);\n        // console.log(shapes)\n        // eslint-disable-next-line @typescript-eslint/ban-types\n        Object.keys(shapes as Object).forEach((key) => {\n          geoms.set(key, this.convertShapeToIOGeometry(shapes[key]));\n        });\n        this.io.imageAnnoApp.activeCommandController.reUndoProcessingStorymaps(geoms);\n        // this.io.annotationInstance.implementations.app.annotationInstance.geometryCommon.canvasWrapper.aCanvasFeature.RenderForce();\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        // this.io.annotationInstance.activeCommandController.SetActiveCommand(ActiveCommandMode.SELECT);\n        // this.io.annotationInstance.io.eventListenerAnnotation.PointerOutStack();\n        break;\n      case ActionType.InitGhost:\n        // eslint-disable-next-line no-case-declarations\n        const ghostShapes = JSON.parse(action[1]);\n        // console.log(ghostShapes);\n\n        // // eslint-disable-next-line no-case-declarations\n        // const pt = this.convertShapeToIOGeometry(\n        //   ghostShapes.POINT_REGULAR ||\n        //     ghostShapes.POINT_NUMBERED_TOUR ||\n        //     ghostShapes.POINT_REGULAR_TOUR\n        // );\n\n        // eslint-disable-next-line no-case-declarations\n        const arrayPolygonMultiple: IOGeometry[] = [];\n        // eslint-disable-next-line no-case-declarations\n        const pgs = ghostShapes.POLYGON_MULTIPLE;\n        if (pgs) {\n          for (let i = 0; i < pgs.length; ++i) {\n            const pg = this.convertShapeToIOGeometry(pgs[i]);\n            arrayPolygonMultiple.push(pg);\n          }\n        }\n        // this.io.annotationInstance.activeCommandController.InitGhost(pt, arrayPolygonMultiple);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.EnterGhost:\n        // this.io.annotationInstance.activeCommandController.EnterGhost(action);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.LeaveGhost:\n        // this.io.annotationInstance.activeCommandController.LeaveGhost(action);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.AddGhost:\n        // this.io.annotationInstance.activeCommandController.AddGhost(action);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.RemoveGhost:\n        // this.io.annotationInstance.activeCommandController.RemoveGhost();\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.PolylineConstraintLength:\n        this.io.imageAnnoApp.activeCommandController.setupPolylineConstraintLength(parseFloat(id));\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.PolylineConstraintLengthPercentage:\n        this.io.imageAnnoApp.activeCommandController.setupPolylineConstraintLengthPercentage(\n          parseFloat(id)\n        );\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      // ............................................................... Guided tour\n      case ActionType.DisableExcept:\n        // eslint-disable-next-line no-case-declarations\n        const idsDisableExcept = JSON.parse(action[1]); // = ['id-1', 'id-2']\n        this.io.imageAnnoApp.activeCommandController.disableExcept(idsDisableExcept);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      case ActionType.Highlight:\n        this.io.imageAnnoApp.activeCommandController.highlight(action[1]);\n        this.io.imageAnnoApp.geometryCommon.gcmdSupporting.renderForce();\n        break;\n      // ............................................................... end Guided tour\n      default:\n        break;\n    }\n  }\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  public getProjectedBoundingVec(shapes: Object) {\n    let projectedXMin = Number.MAX_SAFE_INTEGER;\n    let projectedYMin = Number.MAX_SAFE_INTEGER;\n    let projectedXMax = Number.MIN_SAFE_INTEGER;\n    let projectedYMax = Number.MIN_SAFE_INTEGER;\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    Object.keys(shapes as Object).forEach((key) => {\n      for (let i = 0; i < shapes[key]; ++i) {\n        if (projectedXMin > shapes[key][i].proX) {\n          projectedXMin = shapes[key][i].proX;\n        }\n        if (projectedYMin > shapes[key][i].proY) {\n          projectedYMin = shapes[key][i].proY;\n        }\n        if (projectedXMax < shapes[key][i].proX) {\n          projectedXMax = shapes[key][i].proX;\n        }\n        if (projectedYMax < shapes[key][i].proY) {\n          projectedYMax = shapes[key][i].proY;\n        }\n      }\n    });\n    return [projectedXMin, projectedYMin, projectedXMax, projectedYMax];\n  }\n  private convertShapeToIOGeometry(shape: Shape) {\n    // console.log(shape);\n    const gType = this.io.mappingCommand((shape.type as string) as ActiveCommandMode);\n    // console.log(GType);\n    // console.log(shape);\n    const geom = new IOGeometry(shape.id, GType[gType], false, false, shape.isHidden);\n    geom.pushNode(\n      shape.nodes.map((vertex) =>\n        getVecforGraphicApp(\n          vertex.sx,\n          vertex.sy,\n          vertex.long,\n          vertex.lat,\n          vertex.ele,\n          vertex.proX,\n          vertex.proY,\n          vertex.proZ\n        )\n      )\n    );\n    if (shape.data !== undefined) {\n      // if (shape.data.content) { geom.data.content = shape.data.content; }\n      // if (shape.data.font) { geom.data.font = shape.data.font; }\n      geom.data = shape.data;\n    }\n    if (shape.styles !== undefined) {\n      geom.styles = shape.styles;\n    }\n    // console.log(geom);\n    return geom;\n  }\n}\n","import { ActiveCommandMode } from '../../../lib';\nimport { ImageAnnoApp } from '..';\nimport { EventListenerAnnotation } from './EventListener/EventListenerAnnotation';\nimport { StateProcessingAnnotation } from './StateProcessing/StateProcessingAnnotation';\nexport class IOAnnotationInstance {\n  public imageAnnoApp: ImageAnnoApp;\n  public stateProcessingAnnotation: StateProcessingAnnotation;\n  public eventListenerAnnotation: EventListenerAnnotation;\n  constructor(imageAnnoApp: ImageAnnoApp) {\n    this.imageAnnoApp = imageAnnoApp;\n    this.stateProcessingAnnotation = new StateProcessingAnnotation(this);\n    this.eventListenerAnnotation = new EventListenerAnnotation(this);\n  }\n  // this is for mapping Geometry type used in Storymaps to Geometry type used in XGraphics\n  public mappingCommand(acMode: string) {\n    if (acMode === ActiveCommandMode.SMARTDRAWING) {\n      acMode = ActiveCommandMode.SMARTDRAWING_DEEPLEARNING;\n    } else if (acMode === ActiveCommandMode.POLYGON) {\n      acMode = ActiveCommandMode.POLYGON_GRAPH;\n    } else if (acMode === ActiveCommandMode.POLYGON_GRAPH) {\n      acMode = ActiveCommandMode.POLYGON;\n    } else if (acMode === ActiveCommandMode.FREEHAND_POLYGON) {\n      acMode = ActiveCommandMode.FREEHAND_POLYGON_GRAPH;\n    }\n    return acMode;\n  }\n  public emitAction(data: string) {\n    // console.log(data);\n    if (this.imageAnnoApp.implementations.app.INSPECTION) {\n      // console.log('to',data);\n      // console.trace();\n\n      if (data.split('@')[0] === 'transform') {\n        // console.log('transform');\n        // console.log(data);\n        // console.trace();\n      }\n\n      if (data.split('@')[0] === 'remove') {\n        // console.log('remove');\n        // console.log(data);\n        // console.trace();\n      }\n\n      if (data.split('@')[0] === 'select') {\n        // console.log('select');\n        // console.log(data);\n        // console.trace();\n      }\n    }\n    this.imageAnnoApp.implementations.app.model.ioWrapper.emitAction.emitAction(data);\n  }\n}\n","import { ColorHex } from '../../../../../lib';\nimport { Blackhole } from '..';\nexport class Renderer {\n  public host: Blackhole;\n  constructor(host: Blackhole) {\n    this.host = host;\n  }\n  public renderPost(ctx: CanvasRenderingContext2D) {\n    if (this.host.scene.capture && this.host.scene.capture.isGhost) {\n      return;\n    }\n    if (this.host.stopRender) {\n      this.host.tInit = 0;\n      this.host.tLeave = 0;\n      this.host.t = 0;\n      this.host.isActive = false;\n      return;\n    }\n\n    // for smart Evasion\n    this.host.v.x = ctx.canvas.width * 0.5;\n    if (this.host.smartEvasion) {\n      if (this.host.scene.annotationInstance.activeCommandController.m.y < ctx.canvas.height * 0.5) {\n        this.host.v.y = ctx.canvas.height - 50;\n      } else {\n        this.host.v.y =  50;\n      }\n    } else {\n      this.host.v.y = ctx.canvas.height - 50;\n    }\n\n    ctx.lineWidth = 2;\n    ctx.fillStyle = 'rgba(0,0,0,0.5)';\n    ctx.strokeStyle = ColorHex.White;\n\n    if (0 < this.host.tInit && this.host.tInit < 1) {\n      const val = this.host.scene.annotationInstance.renderer.numericalMotion.easeOutElastic2(\n        this.host.t\n      );\n      if (0 < this.host.t) {\n        ctx.beginPath();\n        ctx.arc(this.host.v.x, this.host.v.y, val * this.host.radius, 0, 6.28318 * 2);\n        ctx.closePath();\n        ctx.fill();\n        ctx.stroke();\n\n        const theSize = val * this.host.sizeTrash;\n        ctx.drawImage(\n          this.host.imgTrash,\n          this.host.v.x - theSize * 0.5,\n          this.host.v.y - theSize * 0.5,\n          theSize,\n          theSize\n        );\n        this.host.isShow = true;\n      } else {\n        this.host.isShow = false;\n      }\n      // ctx.drawImage(this.host.imgTrash, 150, 150 , 50, 50);\n      this.host.t += 0.005;\n    } else if (0 < this.host.tLeave && this.host.tLeave < 1) {\n      const val = this.host.scene.annotationInstance.renderer.numericalMotion.easeInElastic(\n        this.host.tLeave\n      );\n      // console.log(val);\n      const val0 = this.host.radius - val * this.host.radius;\n      if (0 < val0) {\n        if (this.host.isShow) {\n          // after showing the init, it gona be rendered!\n          // console.log('t:', this.host.t);\n          ctx.beginPath();\n          ctx.arc(this.host.v.x, this.host.v.y, val0, 0, 6.28318 * 2);\n          ctx.closePath();\n          ctx.fill();\n          ctx.stroke();\n\n          const theSize = this.host.sizeTrash - val * this.host.sizeTrash;\n          ctx.drawImage(\n            this.host.imgTrash,\n            this.host.v.x - theSize * 0.5,\n            this.host.v.y - theSize * 0.5,\n            theSize,\n            theSize\n          );\n          this.host.t = -0.2; // appear after 0,\n          if (val < 0.5) {\n            // this.host is because when mouse relases, Up event is already gone, and it catch the val beteen 0 and 0.5, otherwise above 0.5 is could keep exeute when mouse just moves\n            this.host.removeGeo();\n          }\n        }\n        if (0.2 < this.host.tLeave) {\n          this.host.isShow = false;\n          this.host.exceptionByLeaderline = false;\n        }\n      }\n    }\n  }\n}\n","import { GType } from '../../../../../lib';\nimport { APolygonGraphWrapper } from '../../GeometryAnnotation/FamilyArea/APolygonGraphWrapper';\nimport { Blackhole } from '..';\nexport class Timer {\n  public host: Blackhole;\n  constructor(host: Blackhole) {\n    this.host = host;\n  }\n  public updateTime() {\n    if (this.host.scene.annotationInstance.activeCommandController.acProperties.isDragging) {\n      if (this.host.scene.Capture === undefined) {\n        this.host.tInit = -1.01;\n      } else {\n        // console.log(this.host.scene.Capture.type);\n        if (\n          this.host.scene.Capture.type === GType.APOINT ||\n          this.host.scene.Capture.type === GType.AMIDPOINT ||\n          this.host.scene.Capture.type === GType.ANODE\n        ) {\n          // console.log('inactive');\n          this.host.isActive = false;\n          return;\n        }\n        if (this.host.scene.Capture.type === GType.POLYGON_GRAPH) {\n          const pGraph = this.host.scene.Capture as APolygonGraphWrapper;\n          if (pGraph.isSelectedNode) {\n            this.host.isActive = false;\n            // console.log('inactive');\n            return;\n          }\n        }\n        // console.log('active');\n        this.host.isActive = true;\n        this.host.tInit = 0.01;\n      }\n      if (this.host.exceptionByLeaderline) {\n        this.host.tLeave += 0.0025; // triggered by removing leaderline\n      } else {\n        this.host.tLeave = 0;\n      }\n    } else {\n      if (this.host.stopRender) {\n        this.host.tInit += 0.015;\n      } else {\n        this.host.tInit = 1.1;\n      }\n    }\n    if (this.host.scene.Capture) {\n      if (this.host.scene.annotationInstance.activeCommandController.acProperties.isUp) {\n        this.host.tLeave += 0.0025;\n      }\n    }\n  }\n}\n","import { IOGeometry } from '../../../../lib/Extended/GeometryUtility';\nimport { \n  GType,\n  getDistance, getDistanceByArray, NVector3 \n} from '../../../../lib';\nimport { Scene } from '../../Scene';\nimport { AGeometryBase } from '../Common/Base/AGeometryBase';\nimport { ATextleaderlineWrapper } from '../GeometryAnnotation/FamilyText/ATextleaderline';\nimport { Renderer } from './Component/Renderer';\nimport { Timer } from './Component/Timer';\nexport class Blackhole {\n  public renderer: Renderer;\n  public timer: Timer;\n  public scene: Scene;\n  public v: NVector3;\n  public isActive = false;\n  public radius = 24;\n  public t = 0.0;\n  public tInit = 0.0;\n  public tLeave = 0.0;\n  public needRender = false;\n  public hasCapture = false;\n  public isUp = false;\n  public isShow = false;\n  public hover = false;\n  public hoverPre = false;\n  public distanceForDetection = 120;\n  public imgTrash: HTMLImageElement;\n  public sizeTrash = 24;\n  public stopRender = false;\n  public exceptionByLeaderline = false;\n  public offX = -1;\n  public smartEvasion: boolean = true;\n  private removeForce = true;\n  constructor(scene: Scene) {\n    this.scene = scene;\n    this.removeForce = true;\n    this.renderer = new Renderer(this);\n    this.timer = new Timer(this);\n    this.v = new NVector3(0, 0);\n    this.imgTrash = new Image();\n    // img.onload = function() {\n    //     ctx.drawImage(img, 0, 0);\n    // }\n    this.imgTrash.src = `${this.scene.annotationInstance.implementations.app.CONFIG.config.BASE_URL}/static/storymaps-xgraphics/images/theme-assets/common/trash-24.svg`;\n    // console.log(svgTrash);\n    // console.log(this.imgTrash);\n  }\n  public updateTime() {\n    this.timer.updateTime();\n  }\n  public render(ctx: CanvasRenderingContext2D) {\n    this.updateTime();\n    this.isInside();\n\n    if (this.isActive) {\n      this.renderer.renderPost(ctx);\n    }\n  }\n  public isInside() {\n    if (!this.isActive) {\n      return;\n    }\n    if (\n      getDistanceByArray(\n        [this.v.x, this.v.y, this.v.z],\n        [\n          this.scene.annotationInstance.activeCommandController.m.x,\n          this.scene.annotationInstance.activeCommandController.m.y,\n          0,\n        ]\n      ) < this.distanceForDetection\n    ) {\n      this.radius = 48;\n      this.sizeTrash = 48;\n      this.hover = true;\n      if (this.hoverPre !== this.hover) {\n        this.hoverPre = this.hover;\n        this.t = 0.3;\n      }\n    } else {\n      this.radius = 24;\n      this.sizeTrash = 24;\n      this.hover = false;\n      if (this.hoverPre !== this.hover) {\n        this.hoverPre = this.hover;\n        this.t = 0.0; // -.2; // appear after 0,\n      }\n    }\n  }\n  // public RemoveSelectedShapesByBlackhole(shapes: IOGeometry[]) {\n  //   let i = this.scene.annotationInstance.scene.geometryList.length;\n  //   const listRemove = [];\n  //   while (i--) {\n  //     let g = this.scene.geometryList[i];\n  //     if (g.IsSelected || g.isHover || g.isCaptured) {\n  //       if (g.isUnderConstruction) { continue; }\n  //       listRemove.push(g);\n  //       // g.needEmitRemoveByBlackhole = false;\n  //     }\n  //   }\n  //   for (let i = 0; i < listRemove.length; ++i) { listRemove[i].Remove(false); }\n  //   this.scene.annotationInstance.io.eventListenerAnnotation.RemoveGeometryStack(shapes);\n  //   return;\n  // }\n  public removeSelectedShapesByBlackhole(shapes: IOGeometry[]) {\n    if (this.scene.capture && this.scene.capture.isGhost) {\n      return;\n    }\n    let i = this.scene.annotationInstance.scene.geometryList.length;\n    const listRemove: AGeometryBase[] = [];\n    while (i--) {\n      const g = this.scene.annotationInstance.scene.geometryList[i];\n      // console.log('remove?', g.isRemove)\n      // if(!g.isRemove) {\n      if (g.isSelected || g.isHoverValue || g.isCapturedValue) {\n        if (g.isUnderConstruction) {\n          continue;\n        }\n        if (g.type === GType.TEXT_LEADERLINE) {\n          const textLeaderline = g as ATextleaderlineWrapper;\n          if (textLeaderline.leaderline) {\n            if (getDistance(textLeaderline.leaderline.v2, this.v) < 42) {\n              textLeaderline.removeLeaderline();\n              // .............. check the textleaderline in shapes array to prevent from emitting remove stack after removing leaderline\n              const temp = [];\n              for (let i = 0; i < shapes.length; ++i) {\n                if (shapes[i].id !== textLeaderline.id) {\n                  temp.push(shapes[i]);\n                }\n              }\n              shapes = temp;\n              // .............. end check the textleaderline in shapes array to prevent from emitting remove stack after removing leaderline\n            } else {\n              // g.needEmitRemoveByBlackhole = false;\n              listRemove.push(g);\n            }\n          } else {\n            // g.needEmitRemoveByBlackhole = false;\n            listRemove.push(g);\n          }\n        } else {\n          listRemove.push(g);\n        }\n        // g.needEmitRemoveByBlackhole = false;\n      }\n      // }\n    }\n    for (let i = 0; i < listRemove.length; ++i) {\n      listRemove[i].remove(false);\n    }\n    if (shapes.length > 0) {\n      this.scene.annotationInstance.io.eventListenerAnnotation.removeGeometryStack(shapes);\n    }\n    return;\n  }\n  public removeGeo() {\n    if (this.scene.capture && this.scene.capture.isGhost) {\n      return;\n    }\n    if (\n      !this.hover ||\n      !this.scene.Capture ||\n      !this.scene.annotationInstance.activeCommandController.acProperties.isUp\n    ) {\n      return;\n    }\n\n    switch (this.scene.Capture.type) {\n      case GType.TEXT_LEADERLINE:\n        // ..................................................... removing for the leaderline of the captured textleaderline.\n        // eslint-disable-next-line no-case-declarations\n        const t = this.scene.Capture as ATextleaderlineWrapper;\n        if (\n          t.leaderline &&\n          t.leaderline.isMouseInside(\n            this.scene.annotationInstance.activeCommandController.m.x,\n            this.scene.annotationInstance.activeCommandController.m.y\n          )\n        ) {\n          if (getDistance(this.v, t.leaderline.v2) < 42) {\n            // safeguard when locating the leaderline around the trash bin but we dont want to remove\n            t.removeLeaderline();\n          }\n          this.scene.Capture = undefined;\n\n          // after removing the leaderline, we need to continue the animation of blackhole\n          // console.log(this.tInit);\n          this.tInit = -1.01;\n          this.tLeave = 0.01;\n\n          this.scene.annotationInstance.activeCommandController.acProperties.isDragging = true;\n          this.exceptionByLeaderline = true;\n          // this.tInit = 1.1;\n          // this.isUp = true;\n          return;\n        }\n        if (this.removeForce) {\n          // this.scene.Capture.Remove();\n          this.scene.Capture = undefined;\n          this.stopRender = true;\n        } else {\n          // this.scene.Capture.GoToBlackhole(); // if the box of leaderline is captured, remove it\n        }\n\n        break;\n      default:\n        if (this.removeForce) {\n          // this.scene.Capture.Remove();\n          this.scene.Capture = undefined;\n          this.stopRender = true;\n        } else {\n          // this.scene.Capture.GoToBlackhole();\n        }\n        break;\n    }\n    // this.scene.annotationInstance.geometryCommon.RemoveAllCapturedGeo();\n    let c = this.scene.geometryList.length;\n    if (c === 0) {\n      return;\n    }\n    while (c--) {\n      if (this.scene.geometryList[c] && this.scene.geometryList[c].isSelected === true) {\n        if (this.removeForce) {\n          // this.scene.geometryList[c].Remove();\n          this.scene.Capture = undefined;\n\n          this.stopRender = true;\n        } else {\n          // this.scene.geometryList[c].GoToBlackhole();\n        }\n      }\n    }\n  }\n}\n","import { GType, getDistance, NVector3 } from '../../../../../lib';\nimport { APolygonGraphWrapper } from '../../GeometryAnnotation/FamilyArea/APolygonGraphWrapper';\nimport { ACurve } from '../../GeometryAnnotation/FamilyCurve/ACurveWrapper/ACurve';\nimport { AArrow } from '../../GeometryAnnotation/FamilyLine/AArrowWrapper/AArrow';\nimport { APolylineGraphWrapper } from '../../GeometryAnnotation/FamilyLine/APolylineGraphWrapper/APolylineGraphWrapper';\n// import { APointNumberedWrapper } from '../../GeometryAnnotation/FamilyPoint/APointNumberedWrapper';\n// import { APointRegularWrapper } from '../../GeometryAnnotation/FamilyPoint/APointRegularWrapper';\nimport { APoint } from '../../GeometryAnnotation/FamilyPoint/Base/APoint';\nimport { ATextleaderlineWrapper } from '../../GeometryAnnotation/FamilyText/ATextleaderline';\nimport { ObjectSnapping } from '..';\nexport class AGhostObjectSnapping {\n  public objectSnapping: ObjectSnapping;\n  public t: number;\n  public tOver: number;\n  public tOverPopupSummary: number;\n  public tDown1: number;\n  public tDown2: number;\n  public tUp: number;\n  public isHover = false;\n  public vecGhostSnapping: NVector3 | undefined = undefined;\n  constructor(objectSnapping: ObjectSnapping) {\n    this.objectSnapping = objectSnapping;\n    this.t = 0.0;\n    this.tOver = 0.0;\n    this.tOverPopupSummary = 0.0;\n    this.tDown1 = 0.0;\n    this.tDown2 = 0.0;\n    this.tUp = 0.0;\n  }\n  public updateGhostSnappingVec(v: NVector3 | undefined) {\n    if (v) {\n      this.vecGhostSnapping = v;\n    } else {\n      this.vecGhostSnapping = undefined;\n    }\n  }\n  // ....................................................... render\n  public render(ctx: CanvasRenderingContext2D) {\n    if (this.vecGhostSnapping) {\n      const xOff = this.objectSnapping.renderer.imageAnnoApp.scene.paramsEditing.croppingMaskParams.x;\n      const yOff = this.objectSnapping.renderer.imageAnnoApp.scene.paramsEditing.croppingMaskParams.y;\n      this.tOver += 0.015;\n      this.objectSnapping.renderer.draw.shape.snapping.circleBG(ctx, this.vecGhostSnapping.x - xOff, this.vecGhostSnapping.y - yOff, this.objectSnapping.toleranceSnapping, this.objectSnapping.renderer.numericalMotion.easeOutElastic2(this.tOver));\n      this.renderGhostGeo(ctx, xOff, yOff);\n    } else {\n      this.tOver = 0.0;\n    }\n  }\n  public renderGhostGeo(ctx: CanvasRenderingContext2D, xOff: number, yOff: number) {\n\n    if (this.objectSnapping.renderer.imageAnnoApp.scene.capture && this.vecGhostSnapping) {\n      if (this.objectSnapping.renderer.imageAnnoApp.scene.capture.type === GType.POINT_REGULAR) {\n        // ........................................... POINT_REGULAR\n        // const rp = this.objectSnapping.renderer.imageAnnoApp.scene.capture as APointRegularWrapper;\n        // this.objectSnapping.renderer.draw.shape.point.pointRegularDragGhost(ctx, rp.styleComponent.renderStyle, this.vecGhostSnapping.x + 6 - xOff, this.vecGhostSnapping.y - yOff, 1, false, false, false, 0.5, false);\n        return;\n      } else if (\n        this.objectSnapping.renderer.imageAnnoApp.scene.capture.type === GType.POINT_NUMBERED\n      ) {\n        // ........................................... POINT_NUMBERED\n        // const rp = this.objectSnapping.renderer.imageAnnoApp.scene.capture as APointNumberedWrapper;\n        // this.objectSnapping.renderer.draw.shape.point.pointNumberedDragByCircleGhost(ctx, rp.styleComponent.renderStyle, this.vecGhostSnapping.x - xOff, this.vecGhostSnapping.y - yOff, 1, false, false, false, 0.5, 0, false, false);\n        return;\n      } else if (\n        this.objectSnapping.renderer.imageAnnoApp.scene.capture.type === GType.ANODE ||\n        this.objectSnapping.renderer.imageAnnoApp.scene.capture.type === GType.AMIDPOINT\n      ) {\n        const np = this.objectSnapping.renderer.imageAnnoApp.scene.capture as APoint;\n        // ........................................... POLYLINE_BENDING\n        if (np.aEdges[0] && np.aEdges[0].pGraph.type === GType.POLYLINE_BENDING) {\n          const rp = np.aEdges[0].pGraph as APolylineGraphWrapper;\n          const vs = this.getVecFromAPolylineGraph(rp);\n          this.objectSnapping.renderer.draw.shape.line.polylineByVecGhost(\n            ctx,\n            rp.styleComponent.renderStyle,\n            vs,\n            [xOff, yOff],\n            false,\n            false,\n            0.5\n          );\n          return;\n          // ........................................... ARROW_SINGLE\n        } else if (\n          (np.edges[0] && np.edges[0].type === GType.ARROW_DOUBLE) ||\n          np.edges[0].type === GType.ARROW_SINGLE\n        ) {\n          const rp = np.edges[0] as AArrow;\n          const vs = this.getVecFromArrow(rp);\n          // console.log(vs);\n\n          const arrayVertexs = this.computeVertex(vs, [xOff, yOff]);\n          const weight = this.computeWeight(rp.getVecs(), 0.5);\n          const arrayControlPoint = this.computeControlPoint(arrayVertexs, weight);\n          this.drawSpline(ctx, rp.getVecs(), arrayVertexs, arrayControlPoint, rp);\n          // this.objectSnapping.renderer.draw.shape.line.PolylineByVec(ctx, rp.styleComponent.renderStyle, vs, false, false, 0.5);\n          return;\n        }\n        // ........................................... POLYGON_GRAPH\n      } else if (\n        this.objectSnapping.renderer.imageAnnoApp.scene.capture.type === GType.POLYGON_GRAPH\n      ) {\n        const rp = this.objectSnapping.renderer.imageAnnoApp.scene.capture as APolygonGraphWrapper;\n        const vs = this.getVecFromAPolygonGraph(rp, [xOff, yOff]);\n        // this.objectSnapping.renderer.draw.shape.line.PolylineByVec(ctx, rp.styleComponent.renderStyle, vs, false, false, 0.5);\n        this.objectSnapping.renderer.draw.shape.area.polygonByVecGhost(\n          ctx,\n          rp.styleComponent.renderStyle,\n          vs,\n          false,\n          false,\n          0.1\n        );\n        return;\n      } else if (\n        this.objectSnapping.renderer.imageAnnoApp.scene.capture.type === GType.TEXT_LEADERLINE\n      ) {\n        const rp = this.objectSnapping.renderer.imageAnnoApp.scene\n          .capture as ATextleaderlineWrapper;\n        if (rp.leaderline) {\n          if (rp.IsSelectedReaderline) {\n            const tv1 = new NVector3(rp.leaderline.v1Render.x, this.vecGhostSnapping.y); // rp.leaderline.v1Render;\n            const tv2 = this.vecGhostSnapping; // new NVector3(100, 100); // rp.leaderline.v2;\n            this.objectSnapping.renderer.draw.shape.text.renderLeaderLine(\n              ctx,\n              rp.styleComponent,\n              rp.vecOffset,\n              tv1,\n              tv2,\n              rp.renderer.t,\n              rp.leaderline.isUpperDia,\n              rp.leaderline.isHover,\n              rp.isSelectedValue\n            );\n          }\n        }\n        return;\n      }\n    }\n  }\n  // ...................................................................... private functions for the render help\n  private getVecFromAPolylineGraph(pl: APolylineGraphWrapper): NVector3[] {\n    const vs = pl.getVecs();\n    const out: NVector3[] = [];\n    if (this.vecGhostSnapping) {\n      for (let i = 0; i < vs.length; ++i) {\n        if (getDistance(vs[i], this.vecGhostSnapping) < this.objectSnapping.toleranceSnapping) {\n          out.push(this.vecGhostSnapping);\n        } else {\n          out.push(vs[i]);\n        }\n      }\n    }\n    return out;\n  }\n  private getVecFromAPolygonGraph(pl: APolygonGraphWrapper, offset: number[]): NVector3[] {\n    const vs = pl.getVecs();\n    const out: NVector3[] = [];\n    if (this.vecGhostSnapping) {\n      for (let i = 0; i < vs.length; ++i) {\n        if (getDistance(vs[i], this.vecGhostSnapping) < this.objectSnapping.toleranceSnapping) {\n          out.push(new NVector3(this.vecGhostSnapping.x - offset[0], this.vecGhostSnapping.y - offset[1], 0));\n        } else {\n          out.push(new NVector3(vs[i].x - offset[0], vs[i].y - offset[1], 0));\n        }\n      }\n    }\n    return out;\n  }\n  private getVecFromArrow(pl: AArrow): NVector3[] {\n    const vs = pl.getVecs();\n    const out: NVector3[] = [];\n    if (this.vecGhostSnapping) {\n      for (let i = 0; i < vs.length; ++i) {\n        if (getDistance(vs[i], this.vecGhostSnapping) < this.objectSnapping.toleranceSnapping) {\n          out.push(this.vecGhostSnapping);\n        } else {\n          out.push(vs[i]);\n        }\n      }\n    }\n    return out;\n  }\n  private computeVertex(vs: NVector3[], offset: number[] ) {\n    const vertexs: number[] = [];\n    for (const p of vs) {\n      // p.weightLeft = this.curveWeight;\n      // p.weightRight = this.curveWeight;\n      vertexs.push(p.x - offset[0], p.y - offset[1]);\n    }\n    return vertexs;\n  }\n  private computeWeight(pts: NVector3[], w = 1) {\n    const weight: number[] = [];\n    for (let i = 0; i < pts.length; ++i) {\n      weight.push(w);\n    }\n    return weight;\n  }\n  private computeControlPoint(vert: number[], arrayWeight: number[]) {\n    const pts: number[] = [...vert];\n    // for (let ii of vert) { pts.push(ii); }\n    let arrayControlPoint: number[] = [];\n    for (let i = 0; i < pts.length - 4; i += 2) {\n      arrayControlPoint = arrayControlPoint.concat(\n        ACurve.getControlPoints(\n          pts[i],\n          pts[i + 1],\n          pts[i + 2],\n          pts[i + 3],\n          pts[i + 4],\n          pts[i + 5],\n          arrayWeight[i]\n        )\n      );\n    }\n    return arrayControlPoint;\n  }\n  private drawSpline(\n    ctx: CanvasRenderingContext2D,\n    nodePts: NVector3[],\n    APoints: number[],\n    cps: number[],\n    host: AArrow\n  ) {\n    const pts = APoints;\n    const cp = cps;\n    const n = pts.length;\n    // let vecs = this.ComputeVecForArrow(new NVector3(pts[4], pts[5]), new NVector3(cp[2], cp[3]), host);\n    // let vecsOpposite = this.ComputeVecForArrow(new NVector3(pts[0], pts[1]), new NVector3(cp[0], cp[1]), host);\n    const ptVec = nodePts;\n    // this.OffscreenRender(pts, cp, n);\n\n    const preset = this.objectSnapping.renderer.draw.shape.curve;\n    preset.curveQuadraticArrow(\n      ctx,\n      host.styleComponent.renderStyle,\n      pts[0],\n      pts[1],\n      cp[0],\n      cp[1],\n      pts[2],\n      pts[3],\n      true,\n      ptVec,\n      false,\n      0.5,\n      this.objectSnapping.renderer.numericalMotion.easeOutElastic2(this.tOver),\n      false,\n      host.styleComponent.state.themeColorId,\n      false\n    );\n    preset.curveQuadraticArrow(\n      ctx,\n      host.styleComponent.renderStyle,\n      pts[n - 2],\n      pts[n - 1],\n      cp[2 * n - 10],\n      cp[2 * n - 9],\n      pts[n - 4],\n      pts[n - 3],\n      true,\n      ptVec,\n      false,\n      0.5,\n      this.objectSnapping.renderer.numericalMotion.easeOutElastic2(this.tOver),\n      false,\n      host.styleComponent.state.themeColorId,\n      false\n    );\n    preset.cArrowByTranslation(\n      ctx,\n      host.styleComponent.renderStyle,\n      new NVector3(pts[4], pts[5]),\n      new NVector3(cp[2], cp[3]),\n      pts[4],\n      pts[5],\n      host.arrowScale,\n      host.scaleForRender,\n      host.isHoverValue,\n      host.isGrayColor,\n      host.visibilityValue,\n      1.0,\n      host.isSelectedValue,\n      host.styleComponent.state.themeColorId\n    );\n    if (host.type === GType.ARROW_DOUBLE) {\n      preset.cArrowByTranslation(\n        ctx,\n        host.styleComponent.renderStyle,\n        new NVector3(pts[0], pts[1]),\n        new NVector3(cp[0], cp[1]),\n        pts[0],\n        pts[1],\n        host.arrowScale,\n        host.scaleForRender,\n        false,\n        host.isGrayColor,\n        host.visibilityValue,\n        1.0,\n        host.isSelectedValue,\n        host.styleComponent.state.themeColorId\n      );\n    }\n  }\n  // private ComputeVecForArrow(v: NVector3, rv: NVector3, host: AArrow) {\n  //     let cen = new NVector3(v.x, v.y, 0);\n  //     let vecs: NVector3[] = [];\n  //     let height = 7.5 * host.scene.annotationInstance.themeRenderStyle.themeCurrent.arrow.scale; // 7.5;\n  //     let depth = 12 * host.scene.annotationInstance.themeRenderStyle.themeCurrent.arrow.scale; // 12;\n  //     vecs.push(new NVector3(cen.x - (height * host.arrowScale), cen.y - (height * host.arrowScale), 0));\n  //     vecs.push(new NVector3(cen.x - (height * host.arrowScale), cen.y + (height * host.arrowScale), 0));\n  //     vecs.push(new NVector3(cen.x + (depth * host.arrowScale), cen.y, 0));\n  //     let degree = NVector3.GetRotationByWorldCoodinateByTwo(NVector3.DeepCopy(v), NVector3.DeepCopy(rv));\n  //     return NVector3.RotateVecsLoal(vecs, -(degree - 180));\n  //   }\n  public checkMidPtPolylineBending() {\n    if (!this.objectSnapping.renderer.imageAnnoApp.scene.capture) { return; }\n    if (this.objectSnapping.renderer.imageAnnoApp.scene.capture.type === GType.ANODE) {\n      const point = this.objectSnapping.renderer.imageAnnoApp.scene.capture as APoint;\n      if (point.aEdges[0]) {\n        point.aEdges[0].pGraph.updateMidVec();\n      }\n    }\n  }\n  public checkLeaderlineOffset() {\n    if (\n      this.objectSnapping.renderer.imageAnnoApp.scene.capture &&\n      this.objectSnapping.renderer.imageAnnoApp.scene.capture.type === GType.TEXT_LEADERLINE\n    ) {\n      const txt = this.objectSnapping.renderer.imageAnnoApp.scene.capture as ATextleaderlineWrapper;\n      if (txt && txt.leaderline && this.objectSnapping.aGhostSnapping.vecGhostSnapping) {\n        const xOff = txt.leaderline.v2.x - this.objectSnapping.aGhostSnapping.vecGhostSnapping.x;\n        const yOff = txt.leaderline.v2.y - this.objectSnapping.aGhostSnapping.vecGhostSnapping.y;\n        txt.widthOffset += xOff;\n        txt.heightOffset += yOff;\n      }\n    }\n  }\n}\n","import { GType, NVector3 } from '../../../../lib';\nimport { APoint } from '../GeometryAnnotation/FamilyPoint/Base/APoint';\nimport { ObjectSnapping } from '.';\nexport class SnappingProcessor {\n  public objectSnapping: ObjectSnapping;\n  constructor(objectSnapping: ObjectSnapping) {\n    this.objectSnapping = objectSnapping;\n  }\n  public updateGhostSnappingVec(v: NVector3 | undefined): void {\n    this.objectSnapping.aGhostSnapping.updateGhostSnappingVec(v);\n  }\n  public isSnappingToCircle(v: NVector3): boolean {\n    if (!this.objectSnapping.renderer.imageAnnoApp.scene.capture) { return false; }\n    // safeguard: prevent a rect or a circle, that has textleaderline, from snapping  with other rect or circle #7478, first issue\n    if (this.objectSnapping.renderer.imageAnnoApp.scene.capture.textLeaderline) {\n      return false;\n    }\n    // end safeguard;\n    for (\n      let i = 0;\n      i < this.objectSnapping.renderer.imageAnnoApp.scene.listACircleWrapperr.length;\n      ++i\n    ) {\n      const selVecSnap = this.objectSnapping.renderer.imageAnnoApp.scene.listACircleWrapperr[\n        i\n      ].isMouseInsideSnapFrom(v);\n      if (selVecSnap && selVecSnap !== v) {\n        this.updateGhostSnappingVec(selVecSnap);\n        return true;\n      }\n    }\n    return false;\n  }\n  public isSnappingToRectangle(v: NVector3): boolean {\n    if (!this.objectSnapping.renderer.imageAnnoApp.scene.capture) { return false; }\n    // safeguard: prevent a rect or a circle, that has textleaderline, from snapping  with other rect or circle #7478, first issue\n    if (this.objectSnapping.renderer.imageAnnoApp.scene.capture.textLeaderline) {\n      return false;\n    }\n    // end safeguard;\n    for (\n      let i = 0;\n      i < this.objectSnapping.renderer.imageAnnoApp.scene.listARectangleWrapper.length;\n      ++i\n    ) {\n      const selVecSnap = this.objectSnapping.renderer.imageAnnoApp.scene.listARectangleWrapper[\n        i\n      ].isMouseInsideSnapFrom(v);\n      if (selVecSnap && selVecSnap !== v) {\n        this.updateGhostSnappingVec(selVecSnap);\n        return true;\n      }\n    }\n    return false;\n  }\n  public donotSnapForCircle(index: number): boolean {\n    if (!this.objectSnapping.renderer.imageAnnoApp.scene.capture) { return false; }\n    if (this.objectSnapping.renderer.imageAnnoApp.scene.capture.type === GType.CIRCLE) {\n      return true;\n    }\n    return false;\n  }\n  public donotSnapForCircleRect(index: number): boolean {\n    if (\n      this.objectSnapping.renderer.imageAnnoApp.scene.listBasePoint[index].type ===\n      GType.ANODE_CIRCLE\n    ) {\n      return true;\n    } else if (\n      this.objectSnapping.renderer.imageAnnoApp.scene.listBasePoint[index].type ===\n      GType.ANODE_RECT\n    ) {\n      return true;\n    }\n    return false;\n  }\n  // public CheckSnappingRectCircle(v: NVector3) {\n  //   for (let i  = 0 ; i < this.objectSnapping.renderer.annotationInstance.scene.listARectangleWrapper.length; ++i) {\n  //     const nv = new NVector3(0, 0);\n  //     const shape = this.objectSnapping.renderer.annotationInstance.scene.listARectangleWrapper[i];\n  //     if (v != shape.vec) {\n  //       if (Distance(shape.vec, v) < this.toleranceSnapping) {\n  //         nv.x = shape.vec.x;\n  //         nv.y = shape.vec.y;\n  //         this.UpdateGhostSnappingVec(nv);\n  //         shape.selVecSnapping = shape.vec;\n  //         return true;\n  //       }\n  //     }\n  //     for (let j  = 0 ; j < shape.vecsCP.length; ++j) {\n  //       const  cp = shape.vecsCP[j];\n  //       if (Distance(cp, v) < this.toleranceSnapping) {\n  //         nv.x = cp.x;\n  //         nv.y = cp.y;\n  //         this.UpdateGhostSnappingVec(nv);\n  //         shape.selVecSnapping = cp;\n  //         return true;\n  //       }\n  //     }\n\n  //     // prevent from self snapping of Rect\n  //     if(this.objectSnapping.renderer.annotationInstance.scene.capture && this.objectSnapping.renderer.annotationInstance.scene.capture.type !== GType.ANODE_RECT) {\n  //         for (let j  = 0 ; j < shape.vecs.length; ++j) {\n  //           const  cp = shape.vecs[j];\n  //           if (Distance(cp, v) < this.toleranceSnapping) {\n  //             nv.x = cp.x;\n  //             nv.y = cp.y;\n  //             this.UpdateGhostSnappingVec(nv);\n  //             shape.selVecSnapping = cp;\n  //             return true;\n  //           }\n  //         }\n  //     }\n\n  //     // This is a safeguard to prevent from losing the snapping vector while dragging the APoint node of Rect.\n  //     if(this.objectSnapping.renderer.annotationInstance.scene.capture.type === GType.ANODE_RECT) {\n  //       return true;\n  //     }\n  //     shape.selVecSnapping = undefined;\n  //   }\n  //   for (let i  = 0 ; i < this.objectSnapping.renderer.annotationInstance.scene.listACircle.length; ++i) {\n  //     const nv = new NVector3(0, 0);\n  //     const shape = this.objectSnapping.renderer.annotationInstance.scene.listACircle[i];\n  //     if (v != shape.vec) {\n  //       if (Distance(shape.vec, v) < this.toleranceSnapping) {\n  //         nv.x = shape.vec.x;\n  //         nv.y = shape.vec.y;\n  //         this.UpdateGhostSnappingVec(nv);\n  //         shape.selVecSnapping = shape.vec;\n  //         return true;\n  //       }\n  //     }\n  //     for (let j  = 0 ; j < shape.vecsCP.length; ++j) {\n  //       const  cp = shape.vecsCP[j];\n  //       if (Distance(cp, v) < this.toleranceSnapping) {\n  //         nv.x = cp.x;\n  //         nv.y = cp.y;\n  //         this.UpdateGhostSnappingVec(nv);\n  //         shape.selVecSnapping = cp;\n  //         return true;\n  //       }\n  //     }\n\n  //     // This is a safeguard to prevent from losing the snapping vector while dragging the APoint node of Circle.\n  //     // if(this.objectSnapping.renderer.annotationInstance.scene.capture.type === GType.ANODE_CIRCLE) {\n  //     //   return true;\n  //     // }\n\n  //     shape.selVecSnapping = undefined;\n  //   }\n  //   return false;\n  // }\n  public isSnappingItself(index: number): boolean {\n    const geo = this.objectSnapping.renderer.imageAnnoApp.scene.capture as APoint;\n    const geoOther = this.objectSnapping.renderer.imageAnnoApp.scene.listBasePoint[index] as APoint;\n    // console.log(geo, geoOther);\n    if (geo && geoOther) {\n      if (\n        (geo.type === GType.ANODE || geo.type === GType.AMIDPOINT) &&\n        (geoOther.type === GType.ANODE || geoOther.type === GType.AMIDPOINT)\n      ) {\n        // prevent arrow for self snapping\n        if (geo.edges.length > 0 && geoOther.edges.length > 0) {\n          if (geo.edges[0] === geoOther.edges[0]) {\n            // console.log('true');\n            return true;\n          }\n        }\n      }\n    }\n\n    // if(geo.type === GType.CIRCLE || geo.type === GType.RECTANGLE) {\n    //   return true;\n    // }\n\n    return false;\n  }\n  public isAllowSnappingPointToPoint(index: number): boolean {\n    const capturedGeo = this.objectSnapping.renderer.imageAnnoApp.scene.capture;\n    if (!capturedGeo) {\n      return true;\n    }\n\n    if (capturedGeo.type === GType.POINT_NUMBERED || capturedGeo.type === GType.POINT_REGULAR) {\n      if (\n        this.objectSnapping.renderer.imageAnnoApp.scene.listBasePoint[index] &&\n        this.objectSnapping.renderer.imageAnnoApp.scene.listBasePoint[index] !== capturedGeo\n      ) {\n        if (\n          this.objectSnapping.renderer.imageAnnoApp.scene.listBasePoint[index].type ===\n            GType.POINT_NUMBERED ||\n          this.objectSnapping.renderer.imageAnnoApp.scene.listBasePoint[index].type ===\n            GType.POINT_REGULAR\n        ) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n  public isAllowSnappingNodeToNodeInSameShape(index: number): boolean {\n    if (this.objectSnapping.renderer.imageAnnoApp.scene.capture) {\n      if (\n        this.objectSnapping.renderer.imageAnnoApp.scene.capture.type === GType.ANODE ||\n        this.objectSnapping.renderer.imageAnnoApp.scene.capture.type === GType.AMIDPOINT\n      ) {\n        const p = this.objectSnapping.renderer.imageAnnoApp.scene.capture as APoint;\n        if (p.edges[0]) {\n          const vs = p.edges[0].getVecs();\n          for (let i = 0; i < vs.length; ++i) {\n            if (\n              this.objectSnapping.renderer.imageAnnoApp.scene.listBasePoint[index] &&\n              this.objectSnapping.renderer.imageAnnoApp.scene.listBasePoint[index].vec === vs[i]\n            ) {\n              return false;\n            }\n          }\n        } else if (p.aEdges[0]) {\n          const vs = p.aEdges[0].pGraph.getVecs();\n          for (let i = 0; i < vs.length; ++i) {\n            if (\n              this.objectSnapping.renderer.imageAnnoApp.scene.listBasePoint[index] &&\n              this.objectSnapping.renderer.imageAnnoApp.scene.listBasePoint[index].vec === vs[i]\n            ) {\n              return false;\n            }\n          }\n        }\n      }\n    }\n    return true;\n  }\n  // public IsAllowSnappingNodeToNode(index: number) {\n  //     if (this.objectSnapping.renderer.annotationInstance.scene.capture) {\n  //         if (this.objectSnapping.renderer.annotationInstance.scene.capture.type === GType.ANODE ||\n  //             this.objectSnapping.renderer.annotationInstance.scene.capture.type === GType.AMIDPOINT ) {\n  //             if (this.objectSnapping.renderer.annotationInstance.scene.listBasePoint[index]) {\n  //                 if (this.objectSnapping.renderer.annotationInstance.scene.listBasePoint[index].type === GType.ANODE || this.objectSnapping.renderer.annotationInstance.scene.listBasePoint[index].type === GType.AMIDPOINT ) {\n  //                     return false;\n  //                 }\n  //             }\n  //         }\n  //     }\n  //     return true;\n  // }\n  public isAllowMidNodePolylineBending(i: number): boolean {\n    // const captureGeo = this.objectSnapping.renderer.annotationInstance.scene.capture;\n    // if (captureGeo.type === GType.TEXT_LEADERLINE) {\n    if (this.objectSnapping.renderer.imageAnnoApp.scene.listBasePoint[i].type === GType.AMIDPOINT) {\n      const point = this.objectSnapping.renderer.imageAnnoApp.scene.listBasePoint[i] as APoint;\n      if (point.aEdges[0] && point.aEdges[0].pGraph.type === GType.POLYLINE_BENDING) {\n        return true; // continue;\n      }\n    }\n    // } else {\n    //   if (this.objectSnapping.renderer.annotationInstance.scene.listBasePoint[i].type === GType.AMIDPOINT) {\n    //     return true; // continue;\n    //   }\n    // }\n    return false;\n  }\n}\n","import { \n  GType, InteractionMode,\n  getDistance, NVector3 \n} from '../../../../lib';\nimport { Renderer } from '../../Renderer';\nimport { APolygonGraphWrapper } from '../GeometryAnnotation/FamilyArea/APolygonGraphWrapper';\nimport { APoint } from '../GeometryAnnotation/FamilyPoint/Base/APoint';\nimport { ATextleaderlineWrapper } from '../GeometryAnnotation/FamilyText/ATextleaderline';\nimport { AGhostObjectSnapping } from './RenderGhost/AGhostObjectSnapping';\nimport { SnappingProcessor } from './SnappingProcessor';\nexport class ObjectSnapping {\n  public renderer: Renderer;\n  public aGhostSnapping: AGhostObjectSnapping;\n  public toleranceSnapping = 19;\n  public frameValue = 0;\n  private snappingProcessor: SnappingProcessor;\n  constructor(renderer: Renderer) {\n    this.renderer = renderer;\n    this.snappingProcessor = new SnappingProcessor(this);\n    this.aGhostSnapping = new AGhostObjectSnapping(this);\n  }\n  public updateGhostSnappingVec(v: NVector3 | undefined) {\n    this.aGhostSnapping.updateGhostSnappingVec(v);\n  }\n  public render(ctx: CanvasRenderingContext2D) {\n    this.aGhostSnapping.render(ctx);\n  }\n  public autoSnappingTracker(v: NVector3, isMouseUp: boolean): boolean {\n    if (this.renderer.imageAnnoApp.interactionMode !== InteractionMode.Drawing) {\n      return false;\n    }\n    if (!v || !this.renderer.imageAnnoApp.activeCommandController.acProperties.isActivateSnapping) {\n      return false;\n    }\n    if (this.frameValue++ % 10 === 0 || isMouseUp) {\n      this.updateSnapping(v, isMouseUp);\n    }\n    return false;\n  }\n  private updateSnapping(v: NVector3, isMouseUp: boolean) {\n    const captureGeo = this.renderer.imageAnnoApp.scene.capture;\n\n    // ......... safeguard, do not snap node of rect and circle to others\n    if (captureGeo) {\n      if (captureGeo.type === GType.ANODE_RECT || captureGeo.type === GType.ANODE_CIRCLE) {\n        return false;\n      }\n    }\n    // safeguard when you drag arrow, the mid point become active to snap, that we do not want\n    if (\n      captureGeo &&\n      (captureGeo.type === GType.ARROW_SINGLE || captureGeo.type === GType.ARROW_DOUBLE)\n    ) {\n      return false;\n    }\n\n    // ......... check the selected leaderline, only leaderline block need to be return.\n    if (captureGeo && captureGeo.type === GType.TEXT_LEADERLINE) {\n      const textleaderline = captureGeo as ATextleaderlineWrapper;\n      if (!textleaderline.IsSelectedReaderline) {\n        return false;\n      }\n      if (textleaderline.leaderline === undefined) {\n        return false;\n      }\n    }\n\n    // ......... polygon graph is exception because it does not use the generic node point.\n    if (\n      this.renderer.imageAnnoApp.scene.capture &&\n      this.renderer.imageAnnoApp.scene.capture.type === GType.POLYGON_GRAPH\n    ) {\n      const vv = this.renderer.imageAnnoApp.scene.capture.getVecForSnapping(); // this.AutoSnappingTrackerPolygonGraph();\n      if (vv) {\n        v = vv;\n      }\n    }\n\n    let dis = this.toleranceSnapping;\n    let index = -1;\n    let i = this.renderer.imageAnnoApp.scene.listBasePoint.length;\n    while (i--) {\n      const pointBase = this.renderer.imageAnnoApp.scene.listBasePoint[i];\n      if (pointBase.vec.x && captureGeo !== pointBase) {\n        if (pointBase.isCollapse) {\n          continue;\n        }\n\n        // ......... rect and circle will skip\n        // ......... if (pointBase.type === GType.ANODE_CIRCLE || pointBase.type === GType.ANODE_RECT ) { continue; }\n\n        // ......... safeguard for textleaderline to snap only the mid point of arrow\n        if (this.snappingProcessor.isAllowMidNodePolylineBending(i)) {\n          continue;\n        }\n\n        const theDis = getDistance(pointBase.vec, v);\n        if (theDis < dis) {\n          dis = theDis;\n          index = i;\n        }\n      }\n    }\n\n    if (this.snappingProcessor.donotSnapForCircle(index)) {\n      return false;\n    } // prevent from snapping a circle to others\n\n    // ......... check polygon graph\n    if (index === -1) {\n      if (isMouseUp) {\n        let needStop = false;\n        for (let i = 0; i < this.renderer.imageAnnoApp.scene.listAPolygonGraphWrapper.length; ++i) {\n          const pg = this.renderer.imageAnnoApp.scene.listAPolygonGraphWrapper[\n            i\n          ] as APolygonGraphWrapper;\n          if (pg !== captureGeo) {\n            const cv = pg.findClosestVec(v);\n            if (cv && getDistance(cv, v) < this.toleranceSnapping) {\n              v.x = cv.x;\n              v.y = cv.y;\n              // v.long = cv.long; v.lat = cv.lat;\n              // v.proX = cv.proX; v.proY = cv.proY;\n              needStop = true;\n              pg.updatePostTransformation();\n\n              const aPointByPolylineGraph = captureGeo as APoint;\n              if (\n                aPointByPolylineGraph &&\n                aPointByPolylineGraph.aEdges &&\n                aPointByPolylineGraph.aEdges[0]\n              ) {\n                aPointByPolylineGraph.aEdges[0].pGraph.updatePostTransformation();\n              }\n            }\n          }\n          pg.graphCore.selVec = undefined;\n          pg.graphCore.selectedVec = undefined;\n          pg.graphCore.selVecForTextLeaderline = undefined;\n          pg.graphCore.selMidVec = undefined;\n        }\n        if (needStop) {\n          return true;\n        }\n      } else {\n        for (let i = 0; i < this.renderer.imageAnnoApp.scene.listAPolygonGraphWrapper.length; ++i) {\n          const pg = this.renderer.imageAnnoApp.scene.listAPolygonGraphWrapper[\n            i\n          ] as APolygonGraphWrapper;\n          if (pg !== captureGeo) {\n            const cv = pg.findClosestVec(v);\n            if (cv && getDistance(cv, v) < this.toleranceSnapping) {\n              const nv = new NVector3(cv.x, cv.y);\n              this.updateGhostSnappingVec(nv);\n              return true;\n            }\n          }\n          this.updateGhostSnappingVec(undefined);\n        }\n      }\n    }\n\n    // ....... safe guard point to point\n    if (this.snappingProcessor.isSnappingItself(index)) {\n      return false;\n    }\n    if (!this.snappingProcessor.isAllowSnappingPointToPoint(index)) {\n      return false;\n    }\n    // if (!this.IsAllowSnappingNodeToNode(index)) {return; }\n    if (!this.snappingProcessor.isAllowSnappingNodeToNodeInSameShape(index)) {\n      return false;\n    }\n\n    // ................................................................ snapping the selected shape to circle / rectangle\n    // ................................................................ although the cir and rect use the generic point, we do not want to use it because we want to have the centralized controller of Cir and Rect\n\n    if (this.snappingProcessor.isSnappingToRectangle(v)) {\n      if (isMouseUp) {\n        this.aGhostSnapping.checkLeaderlineOffset();\n        if (this.aGhostSnapping.vecGhostSnapping) {\n          v.x = this.aGhostSnapping.vecGhostSnapping.x;\n          v.y = this.aGhostSnapping.vecGhostSnapping.y;\n          // v.long = this.aGhostSnapping.vecGhostSnapping.long;\n          // v.lat = this.aGhostSnapping.vecGhostSnapping.lat;\n          // v.proX = this.aGhostSnapping.vecGhostSnapping.proX;\n          // v.proY = this.aGhostSnapping.vecGhostSnapping.proY;\n          this.aGhostSnapping.checkMidPtPolylineBending();\n        }\n      }\n      return true;\n    }\n    if (this.snappingProcessor.isSnappingToCircle(v)) {\n      if (isMouseUp) {\n        this.aGhostSnapping.checkLeaderlineOffset();\n        if (this.aGhostSnapping.vecGhostSnapping) {\n          v.x = this.aGhostSnapping.vecGhostSnapping.x;\n          v.y = this.aGhostSnapping.vecGhostSnapping.y;\n          // v.long = this.aGhostSnapping.vecGhostSnapping.long;\n          // v.lat = this.aGhostSnapping.vecGhostSnapping.lat;\n          // v.proX = this.aGhostSnapping.vecGhostSnapping.proX;\n          // v.proY = this.aGhostSnapping.vecGhostSnapping.proY;\n          this.aGhostSnapping.checkMidPtPolylineBending();\n        }\n      }\n      return true;\n    }\n    // ................................................................ end snapping the selected shape to circle / rectangle\n\n    // ....... for generic shapes\n    if (\n      dis < this.toleranceSnapping &&\n      this.renderer.imageAnnoApp.scene.listBasePoint[index].vec.x\n    ) {\n      if (this.snappingProcessor.donotSnapForCircleRect(index)) {\n        return false;\n      }\n\n      if (isMouseUp) {\n        const xOff = this.renderer.imageAnnoApp.scene.listBasePoint[index].vec.x - v.x;\n        const yOff = this.renderer.imageAnnoApp.scene.listBasePoint[index].vec.y - v.y;\n\n        // we need to offset the height and width by the distance above.\n        if (captureGeo && captureGeo.type === GType.TEXT_LEADERLINE) {\n          const textleaderline = captureGeo as ATextleaderlineWrapper;\n          textleaderline.widthOffset -= xOff;\n          textleaderline.heightOffset -= yOff;\n        }\n\n        v.x = this.renderer.imageAnnoApp.scene.listBasePoint[index].vec.x;\n        v.y = this.renderer.imageAnnoApp.scene.listBasePoint[index].vec.y;\n        // v.long = this.renderer.annotationInstance.scene.listBasePoint[index].vec.long;\n        // v.lat = this.renderer.annotationInstance.scene.listBasePoint[index].vec.lat;\n        // v.proX = this.renderer.annotationInstance.scene.listBasePoint[index].vec.proX;\n        // v.proY = this.renderer.annotationInstance.scene.listBasePoint[index].vec.proY;\n        this.aGhostSnapping.checkMidPtPolylineBending();\n\n        // const aPointByPolylineGraph = captureGeo as APoint;\n        // if (aPointByPolylineGraph && aPointByPolylineGraph.aEdges && aPointByPolylineGraph.aEdges[0]) {\n        //   aPointByPolylineGraph.aEdges[0].pGraph.UpdatePostTransformation();\n        // }\n      } else {\n        const x = this.renderer.imageAnnoApp.scene.listBasePoint[index].vec.x;\n        const y = this.renderer.imageAnnoApp.scene.listBasePoint[index].vec.y;\n        const nv = new NVector3(x, y);\n        this.updateGhostSnappingVec(nv);\n      }\n    } else {\n      this.updateGhostSnappingVec(undefined);\n    }\n    return false;\n  }\n}\n","import { TextleaderlineOptimizer } from '..';\nexport class TextleaderlineOptimizerBase {\n  public optimizer: TextleaderlineOptimizer;\n  constructor(optimizer: TextleaderlineOptimizer) {\n    this.optimizer = optimizer;\n  }\n  public update(): void {\n    //\n  }\n}\n","import { AABBintersect2D } from '../../../../../../lib';\nimport { Renderer } from '../../../../Renderer';\nimport { ATextleaderlineWrapper } from '../../../GeometryAnnotation/FamilyText/ATextleaderline';\nimport { TextleaderlineOptimizerBase } from '../Base/TextleaderlineOptimizerBase';\nimport { TextleaderlineOptimizer } from '..';\n\nexport class AgentBaseRectOptimizer extends TextleaderlineOptimizerBase {\n  public renderer: Renderer;\n  public needUpdateComputeCollision = false;\n  public needOptimization = false;\n  public isDoneOptimization = true;\n  constructor(optimizer: TextleaderlineOptimizer) {\n    super(optimizer);\n    this.renderer = optimizer.optimizer.renderer;\n  }\n  // ..........................................................\n  public update() {\n    if (\n      this.renderer.imageAnnoApp.activeCommandController.acProperties.isZooming ||\n      this.needUpdateComputeCollision\n    ) {\n      this.collisionDetectionCompute();\n      this.needUpdateComputeCollision = false;\n    }\n    if (this.needOptimization || !this.isDoneOptimization) {\n      // console.log('update');\n      this.updatePos();\n    }\n  }\n  public updatePos() {\n    for (let i = 0; i < this.renderer.imageAnnoApp.scene.listATextleaderlineWrapper.length; ++i) {\n      this.renderer.imageAnnoApp.scene.listATextleaderlineWrapper[i].collision.update();\n    }\n  }\n\n  public collisionDetectionCompute() {\n    for (let i = 0; i < this.renderer.imageAnnoApp.scene.listATextleaderlineWrapper.length; ++i) {\n      this.renderer.imageAnnoApp.scene.listATextleaderlineWrapper[i].collision.neighborShapes = [];\n    }\n    if (this.renderer.imageAnnoApp.activeCommandController.acProperties.needHideTextLeaderLine) {\n      this.collisionDetection(this.renderer.imageAnnoApp.scene.listATextleaderlineWrapper);\n    }\n  }\n  public reposition() {\n    if (\n      this.renderer.imageAnnoApp.activeCommandController.acProperties.needrePositionTextLeaderLine\n    ) {\n      // AgentBaseRectOptimizer.RePosition(this.renderer.annotationInstance.scene.listATextleaderlineWrapper);\n    }\n  }\n  private collisionDetection(listLeaderline: ATextleaderlineWrapper[]) {\n    if (listLeaderline[0]) {\n      if (\n        !listLeaderline[0].scene.annotationInstance.activeCommandController.acProperties\n          .needCollisionDetection\n      ) {\n        return;\n      }\n    }\n    let isDoneOptimization = true;\n    for (let i = 0; i < listLeaderline.length - 1; ++i) {\n      const txt0 = [listLeaderline[i].collision.minVec, listLeaderline[i].collision.maxVec];\n      for (let j = i + 1; j < listLeaderline.length; ++j) {\n        const txt1 = [listLeaderline[j].collision.minVec, listLeaderline[j].collision.maxVec];\n        if (AABBintersect2D(txt0, txt1)) {\n          // listLeaderline[i].isCollide = true;\n          listLeaderline[i].collision.neighborShapes.push(listLeaderline[j]);\n          // listLeaderline[j].isCollide = true;\n          listLeaderline[j].collision.neighborShapes.push(listLeaderline[i]);\n          this.needOptimization = true;\n          isDoneOptimization = false;\n        } else {\n          // listLeaderline[i].isCollide = false;\n          // listLeaderline[j].isCollide = false;\n        }\n      }\n    }\n    this.isDoneOptimization = isDoneOptimization;\n    if (isDoneOptimization) {\n      this.needOptimization = false;\n    }\n  }\n}\n","import { AABBintersect2D } from '../../../../../../lib';\nimport { TextleaderlineOptimizerBase } from '../Base/TextleaderlineOptimizerBase';\nimport { TextleaderlineOptimizer } from '..';\nexport class CollisionBased extends TextleaderlineOptimizerBase {\n  constructor(optimizer: TextleaderlineOptimizer) {\n    super(optimizer);\n  }\n  public update() {\n    this.optimizerTextleaderlineByCollision();\n    // this.OptimizerTextleaderlineByCollisionCostBased();\n  }\n  public optimizerTextleaderlineByCollision() {\n    for (\n      let i = 0;\n      i < this.optimizer.optimizer.renderer.imageAnnoApp.scene.listATextleaderlineWrapper.length;\n      ++i\n    ) {\n      const textleaderline = this.optimizer.optimizer.renderer.imageAnnoApp.scene\n        .listATextleaderlineWrapper[i];\n      textleaderline.collision.isCollided = false;\n      textleaderline.collision.numOrder = -1;\n      textleaderline.isCollapse = false;\n    }\n    let numOrder = 0;\n    for (\n      let i = 0;\n      i < this.optimizer.optimizer.renderer.imageAnnoApp.scene.listATextleaderlineWrapper.length;\n      ++i\n    ) {\n      const textleaderline = this.optimizer.optimizer.renderer.imageAnnoApp.scene\n        .listATextleaderlineWrapper[i];\n      for (\n        let j = 0;\n        j < this.optimizer.optimizer.renderer.imageAnnoApp.scene.listATextleaderlineWrapper.length;\n        ++j\n      ) {\n        const other = this.optimizer.optimizer.renderer.imageAnnoApp.scene\n          .listATextleaderlineWrapper[j];\n        if (\n          other !== textleaderline &&\n          AABBintersect2D(\n            [textleaderline.collision.minVec, textleaderline.collision.maxVec],\n            [other.collision.minVec, other.collision.maxVec]\n          )\n        ) {\n          textleaderline.collision.isCollided = true;\n          textleaderline.collision.numOrder = numOrder++;\n          textleaderline.isCollapse = true;\n        }\n      }\n    }\n  }\n  public optimizerTextleaderlineByCollisionCostBased() {\n    for (\n      let i = 0;\n      i < this.optimizer.optimizer.renderer.imageAnnoApp.scene.listATextleaderlineWrapper.length;\n      ++i\n    ) {\n      const textleaderline = this.optimizer.optimizer.renderer.imageAnnoApp.scene\n        .listATextleaderlineWrapper[i];\n      textleaderline.collision.isCollided = false;\n      textleaderline.collision.numOrder = -1;\n      textleaderline.isCollapse = false;\n    }\n    let numOrder = 0;\n    for (\n      let i = 0;\n      i < this.optimizer.optimizer.renderer.imageAnnoApp.scene.listATextleaderlineWrapper.length;\n      ++i\n    ) {\n      const textleaderline = this.optimizer.optimizer.renderer.imageAnnoApp.scene\n        .listATextleaderlineWrapper[i];\n\n      if (textleaderline.isCapturedValue) {\n        continue;\n      }\n\n      for (\n        let j = 0;\n        j < this.optimizer.optimizer.renderer.imageAnnoApp.scene.listATextleaderlineWrapper.length;\n        ++j\n      ) {\n        const other = this.optimizer.optimizer.renderer.imageAnnoApp.scene\n          .listATextleaderlineWrapper[j];\n        if (\n          other !== textleaderline &&\n          AABBintersect2D(\n            [textleaderline.collision.minVec, textleaderline.collision.maxVec],\n            [other.collision.minVec, other.collision.maxVec]\n          )\n        ) {\n          textleaderline.collision.isCollided = true;\n          textleaderline.collision.numOrder = numOrder++;\n          textleaderline.isCollapse = true;\n          break;\n        }\n      }\n    }\n  }\n}\n","import { TextleaderlineOptimizerBase } from '../Base/TextleaderlineOptimizerBase';\nimport { TextleaderlineOptimizer } from '..';\nexport class NoneOptimizer extends TextleaderlineOptimizerBase {\n  constructor(optimizer: TextleaderlineOptimizer) {\n    super(optimizer);\n  }\n  public update() {\n    this.optimizerTextleaderlineByNone();\n  }\n  private optimizerTextleaderlineByNone() {\n    for (\n      let i = 0;\n      i < this.optimizer.optimizer.renderer.imageAnnoApp.scene.listATextleaderlineWrapper.length;\n      ++i\n    ) {\n      const textleaderline = this.optimizer.optimizer.renderer.imageAnnoApp.scene\n        .listATextleaderlineWrapper[i];\n      textleaderline.isRenderCollapse = false;\n      if (textleaderline.txtDiv.divText && textleaderline.txtDiv.divText.hidden) {\n        textleaderline.txtDiv.divText.hidden = false;\n      }\n    }\n  }\n}\n","import { TextleaderlineOptimizerBase } from '../Base/TextleaderlineOptimizerBase';\nimport { TextleaderlineOptimizer } from '..';\nexport class ZoomBased extends TextleaderlineOptimizerBase {\n  constructor(optimizer: TextleaderlineOptimizer) {\n    super(optimizer);\n  }\n  public update() {\n    this.optimizerTextleaderlineByZoom();\n  }\n  private optimizerTextleaderlineByZoom() {\n    // TODO:\n  }\n}\n","import { OptimizerTextleaderline } from '../../../../../lib';\nimport { Optimizer } from '..';\nimport { AgentBaseRectOptimizer } from './AgentBased/AgentBaseRectOptimizer';\nimport { TextleaderlineOptimizerBase } from './Base/TextleaderlineOptimizerBase';\nimport { CollisionBased } from './CollisionBased';\nimport { NoneOptimizer } from './NoneOptimizer';\nimport { ZoomBased } from './ZoomBased';\n\nexport class TextleaderlineOptimizer {\n  public optimizer: Optimizer;\n  public activeOptimizer: TextleaderlineOptimizerBase;\n  private _type: OptimizerTextleaderline;\n  constructor(optimizer: Optimizer, type: OptimizerTextleaderline) {\n    this.optimizer = optimizer;\n    this.type = type;\n  }\n  public get type() {\n    return this._type;\n  }\n  public set type(v: OptimizerTextleaderline) {\n    this._type = v;\n    if (!this.optimizer.renderer.imageAnnoApp.implementations.app.PRODUCTION) {\n      // console.debug(this._type);\n    }\n    switch (v) {\n      case OptimizerTextleaderline.Zoom:\n        this.activeOptimizer = new ZoomBased(this);\n        return;\n      case OptimizerTextleaderline.Collision:\n        this.activeOptimizer = new CollisionBased(this);\n        return;\n      case OptimizerTextleaderline.Agent:\n        this.activeOptimizer = new AgentBaseRectOptimizer(this);\n        return;\n      default:\n        this.activeOptimizer = new NoneOptimizer(this);\n        return;\n    }\n  }\n  public update() {\n    this.activeOptimizer.update();\n  }\n}\n","import { PointOptimizer } from '..';\nexport class PointOptimizerBase {\n  public optimizer: PointOptimizer;\n  constructor(optimizer: PointOptimizer) {\n    this.optimizer = optimizer;\n  }\n  public mouseClick(x: number, y: number) {\n    return false;\n  }\n  public mouseMove(x: number, y: number) {\n    //\n  }\n  public update(): void {\n    //\n  }\n  public render(ctx: CanvasRenderingContext2D): void {\n    //\n  }\n}\n","import { AABBintersect2D, getDistance, GType } from '../../../../../../../lib';\nimport { AGeometryBase } from '../../../../Common/Base/AGeometryBase';\nimport { PointCluster } from '../Geometry/PointCluster';\nimport { CollisionBased } from '..';\nexport class Graph {\n  public optimizer: CollisionBased;\n  public listRPoint: AGeometryBase[] = [];\n  public listNPoint: AGeometryBase[] = [];\n  constructor(optimizer: CollisionBased) {\n    this.optimizer = optimizer;\n  }\n  public update(): void {\n    this.updatePoints();\n    // 1: build connectivities based on collision\n    this.listNPoint = this.buildConnectivity(this.listNPoint);\n    this.listRPoint = this.buildConnectivity(this.listRPoint);\n\n    this.initGeometry();\n    // 2: construct clusters graph based on the connectivities\n\n    const listNPoint = this.buildGraph(this.listNPoint);\n    const listRPoint = this.buildGraph(this.listRPoint);\n\n    if (listNPoint && listRPoint) {\n      this.addClusterByGeometries(listNPoint, GType.POINT_NUMBERED);\n      this.addClusterByGeometries(listRPoint, GType.POINT_REGULAR);\n\n      // // 3: recursive checking for the collision while repositioning clusters\n      this.postUpdateCollisionBasedonGraph();\n\n      const graphcs = this.needDecompose();\n      if (graphcs.length > 0) {\n        // 4: tessellate big clusters based on a resolution\n        this.splitClusters(graphcs);\n        // 5: post-process for merging based on a tolerance\n        this.postMergeCluster();\n      }\n    }\n  }\n  public initGeometry() {\n    this.optimizer.renderer.initGeometry();\n  }\n  public addClusterByGeometries(outGraphList: AGeometryBase[][], type: GType) {\n    this.optimizer.renderer.addClusterByGeometries(outGraphList, type);\n  }\n  private updatePoints() {\n    this.listNPoint = [];\n    this.listRPoint = [];\n    for (\n      let i = 0;\n      i < this.optimizer.optimizer.optimizer.renderer.imageAnnoApp.scene.listNPoint.length;\n      ++i\n    ) {\n      if (\n        this.optimizer.optimizer.optimizer.renderer.imageAnnoApp.scene.listNPoint[i].isHidden ||\n        !this.optimizer.optimizer.optimizer.renderer.imageAnnoApp.scene.listNPoint[i].isRenderable\n      ) {\n        continue;\n      } else {\n        const pt = this.optimizer.optimizer.optimizer.renderer.imageAnnoApp.scene.listNPoint[i];\n        pt.collision.reset();\n        this.listNPoint.push(pt);\n      }\n    }\n    for (\n      let i = 0;\n      i < this.optimizer.optimizer.optimizer.renderer.imageAnnoApp.scene.listRPoint.length;\n      ++i\n    ) {\n      if (\n        this.optimizer.optimizer.optimizer.renderer.imageAnnoApp.scene.listRPoint[i].isHidden ||\n        !this.optimizer.optimizer.optimizer.renderer.imageAnnoApp.scene.listRPoint[i].isRenderable\n      ) {\n        continue;\n      } else {\n        const pt = this.optimizer.optimizer.optimizer.renderer.imageAnnoApp.scene.listRPoint[i];\n        pt.collision.reset();\n        this.listRPoint.push(pt);\n      }\n    }\n  }\n  private buildConnectivity(listPoints: AGeometryBase[]) {\n    for (let i = 0; i < listPoints.length; ++i) {\n      const pt = listPoints[i];\n      for (let j = i + 1; j < listPoints.length; ++j) {\n        const other = listPoints[j];\n        if (\n          !other.isCollapse &&\n          other !== pt &&\n          AABBintersect2D(\n            [pt.collision.minVec, pt.collision.maxVec],\n            [other.collision.minVec, other.collision.maxVec]\n          )\n        ) {\n          pt.collision.isCollided = true;\n          pt.isCollapse = true;\n          pt.numVisit = 0;\n          pt.collision.neighborShapes.push(other);\n\n          other.collision.isCollided = true;\n          other.isCollapse = true;\n          other.numVisit = 0;\n          other.collision.neighborShapes.push(pt);\n\n          // other.collision.neighborShapes.push(pt);\n          // pt.collision.numOrder = numOrder++;\n          // break;\n        }\n      }\n    }\n    return listPoints;\n  }\n  private buildGraph(listPoints: AGeometryBase[]) {\n    const outList = [];\n    for (let i = 0; i < listPoints.length; ++i) {\n      const ptList = [];\n      const queue = [listPoints[i]];\n      queue[0].collision.isVisited = true;\n      ptList.push(queue[0]);\n\n      let safeguard = 0;\n      let current = undefined;\n      while ((current = queue.shift()) !== undefined) {\n        for (let i = 0; i < current.collision.neighborShapes.length; ++i) {\n          if (!current.collision.neighborShapes[i].collision.isVisited) {\n            current.collision.neighborShapes[i].collision.isVisited = true;\n            queue.push(current.collision.neighborShapes[i]);\n            ptList.push(current.collision.neighborShapes[i]);\n          }\n        }\n        if (safeguard++ > 1000) {\n          // console.debug('fail to optimize');\n          return undefined;\n        }\n      }\n\n      if (ptList.length > 1) {\n        outList.push(ptList);\n      }\n    }\n    return outList;\n  }\n  public postUpdateCollisionBasedonGraph() {\n    for (let i = 0; i < this.optimizer.renderer.clustersNPoint.length; ++i) {\n      this.updateByQueue(this.optimizer.renderer.clustersNPoint[i], this.listNPoint);\n    }\n    for (let i = 0; i < this.optimizer.renderer.clustersRPoint.length; ++i) {\n      this.updateByQueue(this.optimizer.renderer.clustersRPoint[i], this.listNPoint);\n    }\n  }\n  private updateByQueue(cluster: PointCluster, geometries: AGeometryBase[]) {\n    let remain = 0;\n    const queue = [...geometries];\n    while (queue.length) {\n      const geo = queue.shift();\n      // console.log(queue.length);\n\n      if (geo) {\n        // safeguard and performance optimization\n        if (geo.numVisit > 100) {\n          geo.numVisit = 0;\n          break;\n        }\n        if (queue.length === 0) {\n          if (geometries.length < remain++) {\n            break;\n          }\n        }\n        // end safeguard and performance optimization\n\n        if (!geo.collision.isCollided) {\n          if (\n            AABBintersect2D(\n              [geo.collision.minVec, geo.collision.maxVec],\n              [cluster.minVec, cluster.maxVec]\n            )\n          ) {\n            geo.collision.isCollided = true;\n            geo.isCollapse = true;\n            geo.numVisit = 0;\n            cluster.addPost(geo);\n          } else {\n            geo.numVisit++;\n            queue.push(geo);\n          }\n        }\n      }\n    }\n  }\n  private needDecompose() {\n    const clusterGraph = [];\n    for (let i = 0; i < this.optimizer.renderer.clustersNPoint.length; ++i) {\n      if (this.optimizer.renderer.clustersNPoint[i].needDecompose()) {\n        clusterGraph.push(this.optimizer.renderer.clustersNPoint[i]);\n      }\n    }\n    for (let i = 0; i < this.optimizer.renderer.clustersRPoint.length; ++i) {\n      if (this.optimizer.renderer.clustersRPoint[i].needDecompose()) {\n        clusterGraph.push(this.optimizer.renderer.clustersRPoint[i]);\n      }\n    }\n    return clusterGraph;\n  }\n  private splitClusters(clusters: PointCluster[]) {\n    for (let i = 0; i < clusters.length; ++i) {\n      clusters[i].split();\n    }\n  }\n  private postMergeCluster() {\n    this.postMergeClusterCompute(this.optimizer.renderer.clustersNPoint);\n    this.postMergeClusterCompute(this.optimizer.renderer.clustersRPoint);\n  }\n  private postMergeClusterCompute(clusters: PointCluster[]) {\n    for (let i = 0; i < clusters.length - 1; ++i) {\n      const cluster = clusters[i];\n      for (let j = i + 1; j < clusters.length; ++j) {\n        const other = clusters[j];\n        if (!other.isVisited) {\n          if (getDistance(cluster.vec, other.vec) < cluster.r1 + 20) {\n            other.isVisited = true;\n            cluster.merge(other);\n          }\n        }\n      }\n    }\n  }\n}\n","import { NVector3 } from '../../../../../../../lib';\nimport { CollisionBased } from '..';\nexport class Interaction {\n  public optimizer: CollisionBased;\n  public m: NVector3 = new NVector3(0, 0);\n  constructor(optimizer: CollisionBased) {\n    this.optimizer = optimizer;\n  }\n  public mouseClick(x: number, y: number) {\n    this.m.x = x;\n    this.m.y = y;\n    for (let i = 0; i < this.optimizer.renderer.clustersNPoint.length; ++i) {\n      // if( this.optimizer.renderer.pointClusters[i].isHover) {\n      if (this.optimizer.renderer.clustersNPoint[i].isInside(this.m)) {\n        // due to touch devices we need to check\n        // this.optimizer.optimizer.optimizer.renderer.annotationInstance.geometryCommon.gcmdSupporting.GotoExtent(this.optimizer.renderer.clustersNPoint[i].geometries);\n        return true;\n      }\n    }\n    for (let i = 0; i < this.optimizer.renderer.clustersRPoint.length; ++i) {\n      if (this.optimizer.renderer.clustersRPoint[i].isInside(this.m)) {\n        // due to touch devices we need to check\n        // this.optimizer.optimizer.optimizer.renderer.annotationInstance.geometryCommon.gcmdSupporting.GotoExtent(this.optimizer.renderer.clustersRPoint[i].geometries);\n        return true;\n      }\n    }\n    return false;\n  }\n  public mouseMove(x: number, y: number) {\n    this.m.x = x;\n    this.m.y = y;\n    for (let i = 0; i < this.optimizer.renderer.clustersNPoint.length; ++i) {\n      this.optimizer.renderer.clustersNPoint[i].isInside(this.m);\n    }\n    for (let i = 0; i < this.optimizer.renderer.clustersRPoint.length; ++i) {\n      this.optimizer.renderer.clustersRPoint[i].isInside(this.m);\n    }\n  }\n}\n","import { getDistance, NVector3, GType } from '../../../../../../../lib';\nimport { AGeometryBase } from '../../../../Common/Base/AGeometryBase';\nimport { Renderer } from '../Renderer';\n\nexport class PointCluster {\n  public renderer: Renderer;\n  public geometries: AGeometryBase[];\n  public r0: number = 32 * 0.5;\n  public r1: number = 48 * 0.5;\n  public isHover = false;\n  public isVisited = false;\n  public boundingBoxMin: NVector3 = new NVector3(\n    Number.MAX_SAFE_INTEGER,\n    Number.MAX_SAFE_INTEGER,\n    Number.MAX_SAFE_INTEGER\n  );\n  public boundingBoxMax: NVector3 = new NVector3(\n    Number.MIN_SAFE_INTEGER,\n    Number.MIN_SAFE_INTEGER,\n    Number.MIN_SAFE_INTEGER\n  );\n  public minVec: NVector3;\n  public maxVec: NVector3;\n  public vec = new NVector3(0, 0, 0);\n  public type: GType;\n  private t = 1.0;\n  private gridResolution = 85;\n\n  private tempVecGridList: NVector3[] = [];\n  private tempGeoGridList: AGeometryBase[][][] = [];\n  constructor(renderer: Renderer, geometries: AGeometryBase[], type: GType) {\n    this.renderer = renderer;\n    this.geometries = geometries;\n    this.type = type;\n    for (let i = 0; i < this.geometries.length; ++i) {\n      this.vec.x += this.geometries[i].vec.x;\n      this.vec.y += this.geometries[i].vec.y;\n      this.updateBoundingBox(this.geometries[i].vec);\n    }\n    this.vec.x /= this.geometries.length;\n    this.vec.y /= this.geometries.length;\n\n    this.minVec = new NVector3(this.vec.x - this.r1, this.vec.y - this.r1, 0);\n    this.maxVec = new NVector3(this.vec.x + this.r1, this.vec.y + this.r1, 0);\n    // for (let i = 0; i < this.geometries.length; ++i) {\n    //   this.geometries[i].isAniEasing = true;\n    //   this.geometries[i].tVec = this.vec;\n    // }\n  }\n  public isInside(m: NVector3) {\n    if (getDistance(this.vec, m) < this.r1) {\n      this.isHover = true;\n      this.geometries[0].scene.annotationInstance.activeCommandController.activeMouseCursor.setActiveCursorHovering();\n      this.geometries[0].scene.annotationInstance.renderer.needFocus = true;\n      this.geometries[0].scene.annotationInstance.activeCommandController.acProperties.hasHovering = true;\n      return true;\n    }\n    this.isHover = false;\n    return false;\n  }\n  public addPost(geo: AGeometryBase) {\n    // @ts-ignore\n    if (this.geometries.includes(geo)) {\n      return;\n    }\n\n    this.geometries.push(geo);\n    this.vec = new NVector3(0, 0, 0);\n    for (let i = 0; i < this.geometries.length; ++i) {\n      this.vec.x += this.geometries[i].vec.x;\n      this.vec.y += this.geometries[i].vec.y;\n      this.updateBoundingBox(this.geometries[i].vec);\n    }\n    this.vec.x /= this.geometries.length;\n    this.vec.y /= this.geometries.length;\n\n    this.minVec = new NVector3(this.vec.x - this.r1, this.vec.y - this.r1, 0);\n    this.maxVec = new NVector3(this.vec.x + this.r1, this.vec.y + this.r1, 0);\n  }\n  public needDecompose() {\n    if (this.boundingBoxMax.x - this.boundingBoxMin.x > this.gridResolution) {\n      return true;\n    }\n    if (this.boundingBoxMax.y - this.boundingBoxMin.y > this.gridResolution) {\n      return true;\n    }\n    return false;\n  }\n  public split() {\n    this.deepRemove();\n    const xNum =\n      (this.boundingBoxMax.x - this.boundingBoxMin.x) / this.gridResolution < 1\n        ? 1\n        : (this.boundingBoxMax.x - this.boundingBoxMin.x) / this.gridResolution;\n    const yNum =\n      (this.boundingBoxMax.y - this.boundingBoxMin.y) / this.gridResolution < 1\n        ? 1\n        : (this.boundingBoxMax.y - this.boundingBoxMin.y) / this.gridResolution;\n    const grid = this.buildGrid(xNum, yNum);\n    this.buildSubCluster(grid, xNum, yNum);\n  }\n  public merge(other: PointCluster) {\n    this.geometries.concat(other.geometries);\n    this.vec = new NVector3(0, 0, 0);\n    for (let i = 0; i < this.geometries.length; ++i) {\n      this.vec.x += this.geometries[i].vec.x;\n      this.vec.y += this.geometries[i].vec.y;\n      this.updateBoundingBox(this.geometries[i].vec);\n    }\n    this.vec.x /= this.geometries.length;\n    this.vec.y /= this.geometries.length;\n\n    this.minVec = new NVector3(this.vec.x - this.r1, this.vec.y - this.r1, 0);\n    this.maxVec = new NVector3(this.vec.x + this.r1, this.vec.y + this.r1, 0);\n    other.deepRemove();\n  }\n  public deepRemove() {\n    this.renderer.removeCluster(this);\n  }\n  public buildGrid(xNum: number, yNum: number) {\n    this.tempGeoGridList = [];\n    const gridList = [];\n    for (let y = 0; y < yNum; ++y) {\n      const theY = this.boundingBoxMin.y + y * this.gridResolution;\n      const geoMat: AGeometryBase[][] = [];\n      for (let x = 0; x < xNum; ++x) {\n        const theX = this.boundingBoxMin.x + x * this.gridResolution;\n        gridList.push(new NVector3(theX, theY));\n        const geoList: AGeometryBase[] = [];\n        geoMat.push(geoList);\n      }\n      this.tempGeoGridList.push(geoMat);\n    }\n    this.tempVecGridList = gridList;\n    return gridList;\n  }\n  public buildSubCluster(vs: NVector3[], xNum: number, yNum: number) {\n    for (let i = 0; i < this.geometries.length; ++i) {\n      this.getCellAtPoint(this.geometries[i].vec, xNum, yNum).push(this.geometries[i]);\n    }\n    for (let y = 0; y < this.tempGeoGridList.length; ++y) {\n      for (let x = 0; x < this.tempGeoGridList[y].length; ++x) {\n        if (this.tempGeoGridList[y][x]) {\n          if (this.tempGeoGridList[y][x].length === 1) {\n            this.tempGeoGridList[y][x][0].collision.reset();\n          } else if (this.tempGeoGridList[y][x].length > 1) {\n            if (this.tempGeoGridList[y][x][0].type === GType.POINT_NUMBERED) {\n              this.renderer.clustersNPoint.push(\n                new PointCluster(\n                  this.renderer,\n                  this.tempGeoGridList[y][x],\n                  this.tempGeoGridList[y][x][0].type\n                )\n              );\n            } else if (this.tempGeoGridList[y][x][0].type === GType.POINT_REGULAR) {\n              this.renderer.clustersRPoint.push(\n                new PointCluster(\n                  this.renderer,\n                  this.tempGeoGridList[y][x],\n                  this.tempGeoGridList[y][x][0].type\n                )\n              );\n            }\n          }\n        }\n      }\n    }\n  }\n  private getCellAtPoint(tv: NVector3, xNum: number, yNum: number) {\n    const dp: NVector3 = new NVector3(tv.x - this.boundingBoxMin.x, tv.y - this.boundingBoxMin.y);\n    // let dp: NVector3 = new NVector3(this.boundingBoxMin.x - tv.x, this.boundingBoxMin.y - tv.y);\n    let i: number = Math.round(dp.x / this.gridResolution);\n    let j: number = Math.round(dp.y / this.gridResolution);\n    if (i >= xNum) {\n      i = xNum - 1;\n    }\n    if (j >= yNum) {\n      j = yNum - 1;\n    }\n    if (i < 0) {\n      i = 0;\n    }\n    if (j < 0) {\n      j = 0;\n    }\n    i = Math.round(i);\n    j = Math.round(j);\n    // console.log(j, i);\n    // console.log(this.tempGeoGridList)\n    return this.tempGeoGridList[j][i];\n  }\n  public draw(ctx: CanvasRenderingContext2D, renderer: Renderer) {\n    this.updateTimer();\n    if (\n      renderer.optimizer.optimizer.optimizer.renderer.imageAnnoApp.activeCommandController\n        .acProperties.extentChanging\n    ) {\n      this.vec = new NVector3(0, 0, 0);\n      this.boundingBoxMin = new NVector3(\n        Number.MAX_SAFE_INTEGER,\n        Number.MAX_SAFE_INTEGER,\n        Number.MAX_SAFE_INTEGER\n      );\n      this.boundingBoxMax = new NVector3(\n        Number.MIN_SAFE_INTEGER,\n        Number.MIN_SAFE_INTEGER,\n        Number.MIN_SAFE_INTEGER\n      );\n      for (let i = 0; i < this.geometries.length; ++i) {\n        this.vec.x += this.geometries[i].vec.x;\n        this.vec.y += this.geometries[i].vec.y;\n        this.updateBoundingBox(this.geometries[i].vec);\n      }\n      this.vec.x /= this.geometries.length;\n      this.vec.y /= this.geometries.length;\n      this.minVec = new NVector3(this.vec.x - this.r1, this.vec.y - this.r1, 0);\n      this.maxVec = new NVector3(this.vec.x + this.r1, this.vec.y + this.r1, 0);\n      // this.vec.y -= this.r * 0.5 // offset the ghost center along y\n    }\n    renderer.optimizer.optimizer.optimizer.renderer.draw.shape.cluster.drawingPresetClustering(\n      ctx,\n      this.geometries,\n      this.vec,\n      this.r0,\n      this.r1,\n      this.isHover,\n      this.t\n    );\n\n    if (\n      renderer.optimizer.optimizer.optimizer.renderer.imageAnnoApp.implementations.app.INSPECTION\n    ) {\n      ctx.beginPath();\n      ctx.rect(\n        this.minVec.x,\n        this.minVec.y,\n        this.maxVec.x - this.minVec.x,\n        this.maxVec.y - this.minVec.y\n      );\n      ctx.closePath();\n      ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';\n      ctx.fill();\n\n      ctx.lineWidth = 0.5;\n      ctx.beginPath();\n      ctx.rect(\n        this.boundingBoxMin.x,\n        this.boundingBoxMin.y,\n        this.boundingBoxMax.x - this.boundingBoxMin.x,\n        this.boundingBoxMax.y - this.boundingBoxMin.y\n      );\n      ctx.closePath();\n      ctx.stroke();\n\n      if (this.tempVecGridList.length > 0) {\n        for (let i = 0; i < this.tempVecGridList.length; ++i) {\n          ctx.beginPath();\n          ctx.rect(\n            this.tempVecGridList[i].x,\n            this.tempVecGridList[i].y,\n            this.gridResolution,\n            this.gridResolution\n          );\n          ctx.closePath();\n          ctx.stroke();\n        }\n      }\n    }\n  }\n  private updateTimer() {\n    if (\n      this.geometries[0].scene.annotationInstance.activeCommandController.acProperties.hasHovering\n    ) {\n      this.t -= this.geometries[0].scene.annotationInstance.customization.themeCurrent.properties.timeTransitionA;\n      this.t = this.t < 0.4 ? 0.4 : this.t;\n    } else {\n      this.t += this.geometries[0].scene.annotationInstance.customization.themeCurrent.properties.timeTransitionB;\n      this.t = this.t > 1 ? 1 : this.t;\n    }\n  }\n  private updateBoundingBox(vec: NVector3) {\n    this.boundingBoxMin.x = vec.x < this.boundingBoxMin.x ? vec.x : this.boundingBoxMin.x;\n    this.boundingBoxMin.y = vec.y < this.boundingBoxMin.y ? vec.y : this.boundingBoxMin.y;\n    this.boundingBoxMax.x = vec.x > this.boundingBoxMax.x ? vec.x : this.boundingBoxMax.x;\n    this.boundingBoxMax.y = vec.y > this.boundingBoxMax.y ? vec.y : this.boundingBoxMax.y;\n  }\n}\n","import { GType } from '../../../../../../../lib';\nimport { AGeometryBase } from '../../../../Common/Base/AGeometryBase';\nimport { PointCluster } from '../Geometry/PointCluster';\nimport { CollisionBased } from '..';\nexport class Renderer {\n  public clustersNPoint: PointCluster[] = [];\n  public clustersRPoint: PointCluster[] = [];\n  public optimizer: CollisionBased;\n  constructor(optimizer: CollisionBased) {\n    this.optimizer = optimizer;\n  }\n  public initGeometry() {\n    this.clustersNPoint = [];\n    this.clustersRPoint = [];\n  }\n  public addClusterByGeometries(geo: AGeometryBase[][], type: GType) {\n    if (type === GType.POINT_NUMBERED) {\n      for (let i = 0; i < geo.length; ++i) {\n        this.clustersNPoint.push(new PointCluster(this, geo[i], type));\n      }\n    } else if (type === GType.POINT_REGULAR) {\n      for (let i = 0; i < geo.length; ++i) {\n        this.clustersRPoint.push(new PointCluster(this, geo[i], type));\n      }\n    }\n  }\n  public removeCluster(cluster: PointCluster) {\n    if (cluster.geometries[0].type === GType.POINT_NUMBERED) {\n      this.clustersNPoint.splice(this.clustersNPoint.indexOf(cluster), 1);\n    } else if (cluster.geometries[0].type === GType.POINT_REGULAR) {\n      this.clustersRPoint.splice(this.clustersRPoint.indexOf(cluster), 1);\n    }\n  }\n  public render(ctx: CanvasRenderingContext2D): void {\n    if (this.clustersNPoint.length > 0) {\n      for (let i = 0; i < this.clustersNPoint.length; ++i) {\n        this.clustersNPoint[i].draw(ctx, this);\n      }\n    }\n    if (this.clustersRPoint.length > 0) {\n      for (let i = 0; i < this.clustersRPoint.length; ++i) {\n        this.clustersRPoint[i].draw(ctx, this);\n      }\n    }\n  }\n}\n","import { PointOptimizerBase } from '../Base/PointOptimizerBase';\nimport { PointOptimizer } from '..';\nimport { Graph } from './Graph';\nimport { Interaction } from './Interaction';\nimport { Renderer } from './Renderer';\nexport class CollisionBased extends PointOptimizerBase {\n  public interaction: Interaction;\n  public renderer: Renderer;\n  public graph: Graph;\n  constructor(optimizer: PointOptimizer) {\n    super(optimizer);\n    this.interaction = new Interaction(this);\n    this.graph = new Graph(this);\n    this.renderer = new Renderer(this);\n  }\n  public mouseClick(x: number, y: number) {\n    if (this.interaction.mouseClick(x, y)) {\n      return true;\n    }\n    return false;\n  }\n  public mouseMove(x: number, y: number) {\n    this.interaction.mouseMove(x, y);\n  }\n  public render(ctx: CanvasRenderingContext2D): void {\n    this.renderer.render(ctx);\n  }\n  public update() {\n    // console.log('OptimizerPointByCollision');\n    this.graph.update();\n  }\n}\n","import { NVector3 } from '../../../../../../../lib';\nimport { AGeometryBase } from '../../../../Common/Base/AGeometryBase';\nimport { GridBased } from '..';\nexport class Grid {\n  public optimizer: GridBased;\n  public listRPoint: AGeometryBase[] = [];\n  public listNPoint: AGeometryBase[] = [];\n\n  public rx = 15;\n  public ry = 8;\n  public xInterval = 0;\n  public yInterval = 0;\n\n  public cells: Cell[][] = [];\n\n  constructor(optimizer: GridBased) {\n    this.optimizer = optimizer;\n  }\n  public update(): void {\n    // console.log(this.optimizer.optimizer.optimizer.renderer.annotationInstance.activeCommandController.acProperties.isZooming);\n    // if (this.optimizer.optimizer.optimizer.renderer.annotationInstance.activeCommandController.acProperties.isZooming) {\n\n    this.initGrid();\n    // }\n  }\n  private initGrid() {\n    this.cells = [];\n    const width = this.optimizer.optimizer.optimizer.renderer.ctx.canvas.width;\n    const height = this.optimizer.optimizer.optimizer.renderer.ctx.canvas.height;\n\n    this.xInterval = width / (this.rx - 1);\n    this.yInterval = height / (this.ry - 1);\n\n    for (let y = 0; y < this.ry; y++) {\n      const cellList: Cell[] = [];\n      for (let x = 0; x < this.rx; x++) {\n        cellList.push(new Cell(this, x, y));\n      }\n      this.cells.push(cellList);\n    }\n    // console.log(this.cells);\n    // debugger;\n\n    for (\n      let i = 0;\n      i < this.optimizer.optimizer.optimizer.renderer.imageAnnoApp.scene.listNPoint.length;\n      ++i\n    ) {\n      const p = this.optimizer.optimizer.optimizer.renderer.imageAnnoApp.scene.listNPoint[\n        i\n      ] as AGeometryBase;\n      this.getCellAtPoint(p.vec).add(p);\n    }\n\n    for (let y = 0; y < this.ry; ++y) {\n      for (let x = 0; x < this.rx; ++x) {\n        if (this.cells[y][x].geometries.length < 2) {\n          this.cells[y][x].isRenderable = false;\n        }\n      }\n    }\n  }\n  public getCellAtPoint(dp: NVector3) {\n    // let dp: NVector3 = vec.Sub(this);\n    let i: number = Math.round(dp.x / this.xInterval);\n    let j: number = Math.round(dp.y / this.yInterval);\n    if (i >= this.rx) {\n      i = this.rx - 1;\n    }\n    if (j >= this.ry) {\n      j = this.ry - 1;\n    }\n    if (i < 0) {\n      i = 0;\n    }\n    if (j < 0) {\n      j = 0;\n    }\n    return this.cells[j][i];\n  }\n  public render(ctx: CanvasRenderingContext2D) {\n    for (let y = 0; y < this.cells.length; y++) {\n      for (let x = 0; x < this.cells[y].length; x++) {\n        // if(this.cells[y][x]) {\n        this.cells[y][x].draw(ctx);\n        // }\n      }\n    }\n  }\n}\n\nclass Cell {\n  grid: Grid;\n  r0: number = 32 * 0.5;\n  r1: number = 48 * 0.5;\n  vec: NVector3;\n  vecRender: NVector3;\n  xI: number;\n  yI: number;\n  isHover = false;\n  geometries: AGeometryBase[] = [];\n  isRenderableValue = true;\n  constructor(grid: Grid, xI: number, yI: number) {\n    this.grid = grid;\n    this.xI = xI;\n    this.yI = yI;\n    this.vec = new NVector3(xI * this.grid.xInterval, yI * this.grid.yInterval);\n    this.geometries = [];\n  }\n  public add(geo: AGeometryBase) {\n    geo.isRenderable = false;\n    this.geometries.push(geo);\n\n    this.vecRender = new NVector3(0, 0, 0);\n    for (let i = 0; i < this.geometries.length; ++i) {\n      this.vecRender.x += this.geometries[i].vec.x;\n      this.vecRender.y += this.geometries[i].vec.y;\n    }\n    this.vecRender.x /= this.geometries.length;\n    this.vecRender.y /= this.geometries.length;\n  }\n  public get isRenderable() {\n    return this.isRenderableValue;\n  }\n  public set isRenderable(v: boolean) {\n    if (!v) {\n      for (let i = 0; i < this.geometries.length; ++i) {\n        this.geometries[i].isRenderable = true;\n      }\n      this.geometries = [];\n    }\n    this.isRenderableValue = v;\n  }\n  // public IsInside(m: NVector3) {\n  //   if(Distance(this.vec, m ) < this.r1 + 2) {\n  //     this.isHover = true;\n  //     return true;\n  //   } else {\n  //     this.isHover = false;\n  //     return false;\n  //   }\n  // }\n  public draw(ctx: CanvasRenderingContext2D) {\n    // ctx.beginPath();\n    // ctx.rect(this.vec.x - this.grid.xInterval * 0.5, this.vec.y - this.grid.yInterval * 0.5, this.grid.xInterval, this.grid.yInterval);\n    // ctx.closePath();\n    // ctx.stroke();\n\n    if (!this.isRenderable) {\n      return;\n    }\n\n    if (\n      this.grid.optimizer.optimizer.optimizer.renderer.imageAnnoApp.activeCommandController\n        .acProperties.extentChanging\n    ) {\n      this.vecRender = new NVector3(0, 0, 0);\n      for (let i = 0; i < this.geometries.length; ++i) {\n        this.vecRender.x += this.geometries[i].vec.x;\n        this.vecRender.y += this.geometries[i].vec.y;\n      }\n      this.vecRender.x /= this.geometries.length;\n      this.vecRender.y /= this.geometries.length;\n      // this.vec.y -= this.r * 0.5 // offset the ghost center along y\n    }\n\n    // ctx.beginPath();\n    // ctx.rect(this.vec.x - this.grid.xInterval * 0.5, this.vec.y - this.grid.yInterval * 0.5, this.grid.xInterval, this.grid.yInterval);\n    // ctx.closePath();\n    // ctx.fillStyle = 'rgba(255, 0, 0, 0.1)';\n    // ctx.fill();\n    // console.log(this.geometries.length);\n\n    ctx.beginPath();\n    ctx.arc(this.vecRender.x, this.vecRender.y, 5, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.stroke();\n\n    this.grid.optimizer.optimizer.optimizer.renderer.draw.shape.cluster.drawingPresetClustering(\n      ctx,\n      this.geometries,\n      this.vecRender,\n      this.r0,\n      this.r1,\n      this.isHover\n    );\n  }\n}\n","import { NVector3 } from '../../../../../../../lib';\nimport { GridBased } from '..';\nexport class Interaction {\n  public optimizer: GridBased;\n  public m: NVector3 = new NVector3(0, 0);\n  constructor(optimizer: GridBased) {\n    this.optimizer = optimizer;\n  }\n  public mouseClick(x: number, y: number) {\n    this.m.x = x;\n    this.m.y = y;\n\n    for (let i = 0; i < this.optimizer.renderer.pointClusters.length; ++i) {\n      // if( this.optimizer.renderer.pointClusters[i].isHover) {\n      if (this.optimizer.renderer.pointClusters[i].isInside(this.m)) {\n        // due to touch devices we need to check\n        // this.optimizer.optimizer.optimizer.renderer.annotationInstance.geometryCommon.gcmdSupporting.GotoExtent(this.optimizer.renderer.pointClusters[i].geometries);\n        return true;\n      }\n    }\n    return false;\n  }\n  public mouseMove(x: number, y: number) {\n    this.m.x = x;\n    this.m.y = y;\n\n    for (let i = 0; i < this.optimizer.renderer.pointClusters.length; ++i) {\n      this.optimizer.renderer.pointClusters[i].isInside(this.m);\n    }\n  }\n}\n","import { getDistance, NVector3, GType } from '../../../../../../../lib';\nimport { AGeometryBase } from '../../../../Common/Base/AGeometryBase';\nimport { GridBased } from '..';\nexport class Renderer {\n  public pointClusters: PointCluster[] = [];\n  public optimizer: GridBased;\n  constructor(optimizer: GridBased) {\n    this.optimizer = optimizer;\n  }\n  public initGeometry() {\n    this.pointClusters = [];\n  }\n  public pushGeometry(geo: AGeometryBase[][], type: GType) {\n    for (let i = 0; i < geo.length; ++i) {\n      this.pointClusters.push(new PointCluster(geo[i], type));\n    }\n  }\n  public render(ctx: CanvasRenderingContext2D): void {\n    this.optimizer.grid.render(ctx);\n    // if (this.pointClusters.length > 0) {\n    //   for (let i = 0 ; i < this.pointClusters.length; ++i) {\n    //     this.pointClusters[i].Draw(ctx, this);\n    //   }\n    // }\n  }\n}\n\nexport class PointCluster {\n  geometries: AGeometryBase[];\n  r0: number = 32 * 0.5;\n  r1: number = 48 * 0.5;\n  isHover = false;\n  public type: GType;\n  private vec = new NVector3(0, 0, 0);\n  constructor(geometries: AGeometryBase[], type: GType) {\n    this.geometries = geometries;\n    this.type = type;\n    for (let i = 0; i < this.geometries.length; ++i) {\n      this.vec.x += this.geometries[i].vec.x;\n      this.vec.y += this.geometries[i].vec.y;\n    }\n    this.vec.x /= this.geometries.length;\n    this.vec.y /= this.geometries.length;\n\n    // for (let i = 0; i < this.geometries.length; ++i) {\n    //   this.geometries[i].isAniEasing = true;\n    //   this.geometries[i].tVec = this.vec;\n    // }\n  }\n  public isInside(m: NVector3) {\n    if (getDistance(this.vec, m) < this.r1 + 2) {\n      this.isHover = true;\n      return true;\n    }\n    this.isHover = false;\n    return false;\n  }\n  public draw(ctx: CanvasRenderingContext2D, renderer: Renderer) {\n    if (\n      renderer.optimizer.optimizer.optimizer.renderer.imageAnnoApp.activeCommandController\n        .acProperties.extentChanging\n    ) {\n      this.vec = new NVector3(0, 0, 0);\n      for (let i = 0; i < this.geometries.length; ++i) {\n        this.vec.x += this.geometries[i].vec.x;\n        this.vec.y += this.geometries[i].vec.y;\n      }\n      this.vec.x /= this.geometries.length;\n      this.vec.y /= this.geometries.length;\n      // this.vec.y -= this.r * 0.5 // offset the ghost center along y\n    }\n    renderer.optimizer.optimizer.optimizer.renderer.draw.shape.cluster.drawingPresetClustering(\n      ctx,\n      this.geometries,\n      this.vec,\n      this.r0,\n      this.r1,\n      this.isHover\n    );\n  }\n}\n","import { PointOptimizerBase } from '../Base/PointOptimizerBase';\nimport { PointOptimizer } from '..';\nimport { Grid } from './Grid';\nimport { Interaction } from './Interaction';\nimport { Renderer } from './Renderer';\nexport class GridBased extends PointOptimizerBase {\n  public interaction: Interaction;\n  public renderer: Renderer;\n  public grid: Grid;\n  constructor(optimizer: PointOptimizer) {\n    super(optimizer);\n    this.interaction = new Interaction(this);\n    this.grid = new Grid(this);\n    this.renderer = new Renderer(this);\n  }\n  public mouseClick(x: number, y: number) {\n    if (this.interaction.mouseClick(x, y)) {\n      return true;\n    }\n    return false;\n  }\n  public mouseMove(x: number, y: number) {\n    this.interaction.mouseMove(x, y);\n  }\n  public render(ctx: CanvasRenderingContext2D): void {\n    this.renderer.render(ctx);\n  }\n  public update() {\n    // console.log('OptimizerPointByCollision');\n    this.grid.update();\n  }\n}\n","import { PointOptimizerBase } from '../Base/PointOptimizerBase';\nimport { PointOptimizer } from '..';\nexport class NoneOptimizer extends PointOptimizerBase {\n  constructor(optimizer: PointOptimizer) {\n    super(optimizer);\n  }\n  public update() {\n    this.optimizerTextleaderlineByNone();\n  }\n  private optimizerTextleaderlineByNone() {\n    for (\n      let i = 0;\n      i < this.optimizer.optimizer.renderer.imageAnnoApp.scene.listNPoint.length;\n      ++i\n    ) {\n      const pt = this.optimizer.optimizer.renderer.imageAnnoApp.scene.listNPoint[i];\n      pt.collision.reset();\n    }\n    for (\n      let i = 0;\n      i < this.optimizer.optimizer.renderer.imageAnnoApp.scene.listRPoint.length;\n      ++i\n    ) {\n      const pt = this.optimizer.optimizer.renderer.imageAnnoApp.scene.listRPoint[i];\n      pt.collision.reset();\n    }\n  }\n}\n","import { PointOptimizerBase } from '../Base/PointOptimizerBase';\nimport { PointOptimizer } from '..';\nexport class ZoomBased extends PointOptimizerBase {\n  constructor(optimizer: PointOptimizer) {\n    super(optimizer);\n  }\n  public update() {\n    this.optimizerTextleaderlineByZoom();\n  }\n  private optimizerTextleaderlineByZoom() {\n    // const ZOOM_TOLERANCE = 1;\n  }\n}\n","import { OptimizerPoint } from '../../../../../lib';\nimport { Optimizer } from '..';\nimport { PointOptimizerBase } from './Base/PointOptimizerBase';\nimport { CollisionBased } from './CollisionBased';\nimport { GridBased } from './GridBased';\nimport { NoneOptimizer } from './NoneOptimizer';\nimport { ZoomBased } from './ZoomBased';\nexport class PointOptimizer {\n  public optimizer: Optimizer;\n  public activeOptimizer: PointOptimizerBase;\n  private _type: OptimizerPoint;\n  constructor(optimizer: Optimizer, type: OptimizerPoint) {\n    this.optimizer = optimizer;\n    this.type = type;\n  }\n  public get type() {\n    return this._type;\n  }\n  public set type(v: OptimizerPoint) {\n    this._type = v;\n    if (!this.optimizer.renderer.imageAnnoApp.implementations.app.PRODUCTION) {\n      // console.debug(this._type);\n    }\n    switch (v) {\n      case OptimizerPoint.Zoom:\n        this.activeOptimizer = new ZoomBased(this);\n        return;\n      case OptimizerPoint.Grid:\n        this.activeOptimizer = new GridBased(this);\n        return;\n      case OptimizerPoint.Collision:\n        this.activeOptimizer = new CollisionBased(this);\n        return;\n      case OptimizerPoint.Agent:\n        return;\n      default:\n        this.activeOptimizer = new NoneOptimizer(this);\n        return;\n    }\n  }\n  public update() {\n    this.activeOptimizer.update();\n  }\n  public render(ctx: CanvasRenderingContext2D) {\n    if (this.activeOptimizer) {\n      this.activeOptimizer.render(ctx);\n    }\n  }\n  public mouseClick(x: number, y: number) {\n    if (this.activeOptimizer) {\n      if (this.activeOptimizer.mouseClick(x, y)) {\n        return true;\n      }\n    }\n    return false;\n  }\n  public mouseMove(x: number, y: number) {\n    if (this.activeOptimizer) {\n      this.activeOptimizer.mouseMove(x, y);\n    }\n  }\n}\n","import { OptimizerPoint, OptimizerTextleaderline } from '../../../../lib';\nimport { Renderer } from '../../Renderer';\nimport { TextleaderlineOptimizer } from './TextleaderlineOptimizer';\nimport { PointOptimizer } from './PointOptimizer';\nexport class Optimizer {\n  public renderer: Renderer;\n  private textleaderlineOptimizer: TextleaderlineOptimizer;\n  private pointOptimizer: PointOptimizer;\n  private initForceTimer = 0;\n  constructor(renderer: Renderer) {\n    this.renderer = renderer;\n    this.init();\n  }\n  public get typeTextleaderline() {\n    return this.textleaderlineOptimizer.type;\n  }\n  public set typeTextleaderline(v: OptimizerTextleaderline) {\n    this.textleaderlineOptimizer.type = v;\n  }\n  public get typePoint() {\n    return this.pointOptimizer.type;\n  }\n  public set typePoint(v: OptimizerPoint) {\n    this.pointOptimizer.type = v;\n  }\n  private init() {\n    this.pointOptimizer = new PointOptimizer(\n      this,\n      this.renderer.imageAnnoApp.activeCommandController.acProperties.optimizerPoint\n    );\n    this.textleaderlineOptimizer = new TextleaderlineOptimizer(\n      this,\n      this.renderer.imageAnnoApp.activeCommandController.acProperties.optimizerTextleaderline\n    );\n  }\n  public update() {\n    if (this.renderer.imageAnnoApp.activeCommandController.acProperties.isPanning) {\n      return;\n    }\n    if (\n      this.renderer.imageAnnoApp.activeCommandController.acProperties.needExecuteOptimizer ||\n      ++this.initForceTimer < 30\n    ) {\n      this.pointOptimizer.update();\n      this.textleaderlineOptimizer.update();\n      this.renderer.imageAnnoApp.activeCommandController.acProperties.needExecuteOptimizer = false;\n    }\n  }\n  public render(ctx: CanvasRenderingContext2D) {\n    this.pointOptimizer.render(ctx);\n  }\n  public mouseClick(x: number, y: number) {\n    if (this.pointOptimizer.mouseClick(x, y)) {\n      return true;\n    }\n    return false;\n  }\n  public mouseMove(x: number, y: number) {\n    this.pointOptimizer.mouseMove(x, y);\n  }\n}\n","import { ANGonWrapper } from '../../Geometry/GeometryAnnotation/FamilyArea/ANGonWrapper';\nimport { AArrow } from '../../Geometry/GeometryAnnotation/FamilyLine/AArrowWrapper/AArrow';\nimport { Renderer } from '..';\nexport class EnvAnnotationMap {\n  public renderer: Renderer;\n  protected index = 0;\n  constructor(renderer: Renderer) {\n    this.renderer = renderer;\n  }\n  public renderEnv(ctx: CanvasRenderingContext2D) {\n    this.renderer.objectSnapping.render(ctx);\n\n    // ....................................... areas\n    if (ANGonWrapper.construction) {\n      ANGonWrapper.construction.renderPost(ctx);\n    }\n\n    this.index = this.renderer.imageAnnoApp.scene.listACircleWrapperr.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listACircleWrapperr[this.index].render(ctx);\n    }\n    // this.index = this.renderer.annotationInstance.scene.listAPolygon.length; while (this.index--) { this.renderer.annotationInstance.scene.listAPolygon[this.index].Render(ctx); }\n    this.index = this.renderer.imageAnnoApp.scene.listAPolygonGraphWrapper.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listAPolygonGraphWrapper[this.index].render(ctx);\n    }\n    this.index = this.renderer.imageAnnoApp.scene.listARectangleWrapper.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listARectangleWrapper[this.index].render(ctx);\n    }\n    // ....................................... line\n    this.index = this.renderer.imageAnnoApp.scene.listAPolylineGraphWrapper.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listAPolylineGraphWrapper[this.index].render(ctx);\n    }\n    if (this.renderer.imageAnnoApp.scene.listAPolylineGraphShadow) {\n      this.renderer.imageAnnoApp.scene.listAPolylineGraphShadow.render(ctx);\n    }\n    this.index = this.renderer.imageAnnoApp.scene.listAFreehandSmartDrawing.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listAFreehandSmartDrawing[this.index].render(ctx);\n    }\n    this.index = this.renderer.imageAnnoApp.scene.listAFreehand.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listAFreehand[this.index].render(ctx);\n    }\n    this.index = this.renderer.imageAnnoApp.scene.listAPolylineWrapper.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listAPolylineWrapper[this.index].render(ctx);\n    }\n    // ....................................... arrow\n    this.index = this.renderer.imageAnnoApp.scene.listACurve.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listACurve[this.index].render(ctx);\n    }\n    this.index = this.renderer.imageAnnoApp.scene.listAArrow.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listAArrow[this.index].render(ctx);\n    }\n    if (AArrow.condition.geo) {\n      AArrow.condition.geo.render(ctx);\n    }\n    // ....................................... textleader line\n    this.index = this.renderer.imageAnnoApp.scene.listATextleaderlineWrapper.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listATextleaderlineWrapper[this.index].renderLeadline(ctx);\n    }\n    // AGeometryCommon.listBaseGrid.Render(ctx);\n    // this.index = ALine.list.length; while (this.index--) { ALine.list[this.index].Render(ctx); }\n    this.index = this.renderer.imageAnnoApp.scene.listAPolygonGraphWrapper.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listAPolygonGraphWrapper[this.index].renderPostNodes(ctx);\n    }\n    // ....................................... point\n    this.index = this.renderer.imageAnnoApp.scene.listAPoint.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listAPoint[this.index].render(ctx);\n    }\n    this.index = this.renderer.imageAnnoApp.scene.listRPoint.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listRPoint[this.index].render(ctx);\n    }\n    this.index = this.renderer.imageAnnoApp.scene.listIPoint.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listIPoint[this.index].render(ctx);\n    }\n    this.index = this.renderer.imageAnnoApp.scene.listNPoint.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listNPoint[this.index].render(ctx);\n    }\n\n    this.renderer.optimizer.render(ctx);\n\n    // ....................................... text box\n    this.index = this.renderer.imageAnnoApp.scene.listATextleaderlineWrapper.length;\n    while (this.index--) {\n      this.renderer.imageAnnoApp.scene.listATextleaderlineWrapper[this.index].render(ctx);\n    }\n    // this.index = this.renderer.annotationInstance.scene.listAText.length;\n    // while (this.index--) {\n    //   this.renderer.annotationInstance.scene.listAText[this.index].Render(ctx);\n    // }\n    // this.index = AText.list.length; while (this.index--) { AText.list[this.index].Render(ctx); }\n\n    if (this.renderer.imageAnnoApp.implementations.app.INSPECTION) {\n      ctx.fillStyle = '#000000';\n      ctx.font = `10px Arial`;\n      if (this.renderer.imageAnnoApp.scene.capture) {\n        const pos = this.renderer.imageAnnoApp.scene.capture.vec;\n        const text = this.renderer.imageAnnoApp.scene.capture.type;\n        ctx.fillText(`${text}`, pos.x, pos.y + 10);\n      }\n      // real-time report\n      const HEIGHT = 30;\n      const numGeo = this.renderer.imageAnnoApp.scene.geometryList.length;\n      const numAPoint = this.renderer.imageAnnoApp.scene.listAPoint.length;\n      const capture = this.renderer.imageAnnoApp.scene.Capture\n        ? this.renderer.imageAnnoApp.scene.Capture.type\n        : undefined;\n      const scaleMap = this.renderer.imageAnnoApp.activeCommandController.acProperties.mapScale;\n      const debugText = this.renderer.debugText;\n      const isMobile = this.renderer.imageAnnoApp.implementations.app.model.appCoreWrapper\n        .browserUtility.isMobile;\n      ctx.fillText(\n        `num of geo: ${numGeo}`,\n        this.renderer.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.ctx.canvas.width *\n          0.5 -\n          150,\n        HEIGHT\n      );\n      ctx.fillText(\n        `num of aPoint(node): ${numAPoint}`,\n        this.renderer.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.ctx.canvas.width *\n          0.5 -\n          150,\n        HEIGHT + 20\n      );\n      ctx.fillText(\n        `capture: ${capture}`,\n        this.renderer.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.ctx.canvas.width *\n          0.5 +\n          0,\n        HEIGHT\n      );\n      ctx.fillText(\n        `map scale: ${scaleMap}`,\n        this.renderer.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.ctx.canvas.width *\n          0.5 +\n          150 +\n          0,\n        HEIGHT\n      );\n      ctx.fillText(\n        `debug: ${debugText}`,\n        this.renderer.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.ctx.canvas.width * 0.5,\n        HEIGHT * 2\n      );\n      ctx.fillText(\n        `isMobile: ${isMobile}`,\n        this.renderer.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.ctx.canvas.width * 0.5,\n        HEIGHT * 3\n      );\n\n      this.renderer.imageAnnoApp.activeCommandController.screenLog.render(ctx);\n    }\n  }\n}\n","import { NVector3 } from '../../../../lib';\nimport { RenderStyle } from '../../Geometry/GeometryAnnotation/Helper/RenderStyle';\nimport { Renderer } from '..';\nexport class DrawingPresetOffscreen {\n  public renderer: Renderer;\n  public ctxTemp: CanvasRenderingContext2D;\n  public canvas: HTMLCanvasElement;\n  constructor(renderer: Renderer) {\n    this.renderer = renderer;\n    this.canvas = document.createElement('canvas');\n    this.canvas.style.background = '#000000';\n    this.canvas.style.position = 'absolute';\n    const ctxTemp = this.canvas.getContext('2d');\n    if (ctxTemp) {\n      this.ctxTemp = ctxTemp;\n    }\n    // this.renderer.annotationInstance.implementations.app.model.modelViewWrapper.viewWrapper.div.append(this.canvas);\n  }\n  public getImgDataFromHTMLImg(img: HTMLImageElement, col: string) {\n    // img.crossOrigin = 'Anonymous';\n    // let img: HTMLImageElement;\n    // if (gtype === GTYPE.POINT_REGULAR) { img = this.pointRegularImg; }\n    // if (gtype === GTYPE.POINT_NUMBERED) { img = this.pointNumberedImg; }\n    // if (img) {\n    img.crossOrigin = 'anonymous';\n    // img.crossOrigin=\"Anonymous\"\n\n    // this.ctxTemp.canvas.width = img.width;\n    // this.ctxTemp.canvas.height = img.height;\n    // this.ctxTemp.clearRect(0, 0, this.ctxTemp.canvas.width, this.ctxTemp.canvas.height);\n\n    this.ctxTemp.drawImage(img, 50, 50);\n\n    // let imgd = this.ctxTemp.getImageData(50, 50 , 2 , 2);\n\n    // console.log(imgd);\n    // let pix = imgd.data;\n\n    // let numbers = col.split(',');\n    // let r = (Number.parseInt(numbers[0].split('(')[1], 10));\n    // let g = (Number.parseInt(numbers[1], 10));\n    // let b = (Number.parseInt(numbers[2], 10));\n\n    // for (let i = 0, n = pix.length; i < n; i += 4) {\n    //     if (pix[i + 3] === 0)  {continue; }\n    //     pix.length[i] = r;\n    //     pix.length[i + 1] = g;\n    //     pix.length[i + 2] = b;\n    //     pix[i + 3] = 255;\n    // }\n    // this.ctxTemp.putImageData(imgd, img.width, img.height);\n    // return imgd;\n  }\n  public ellipseOffScreen(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    c: string,\n    x: number,\n    y: number,\n    r0: number,\n    r1: number,\n    isFill: boolean,\n    opacity = 0.3\n  ) {\n    ctx.beginPath();\n    ctx.ellipse(x, y, r0, r1, 0, 0, 2 * Math.PI, false);\n    ctx.closePath();\n\n    // let c = this.preset.polygonColorFill.split(',');\n    // let cc = c[0] + ',' + c[1] + ',' + c[2] + ',' + opacity + ')';\n    // // console.log(cc);\n    ctx.fillStyle = c;\n\n    if (isFill) {\n      ctx.fill();\n    }\n\n    this.polygonEndOffScreen(ctx, rs, c);\n  }\n  public polygonEndOffScreen(ctx: CanvasRenderingContext2D, rs: RenderStyle, c: string) {\n    ctx.lineWidth = rs.lineWidth;\n    // let col = c;\n    ctx.strokeStyle = c; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    ctx.stroke();\n  }\n  public rectangleOffScreen(ctx: CanvasRenderingContext2D, col: string, vs: NVector3[]) {\n    // if (isFill) {\n    ctx.beginPath();\n    ctx.moveTo(vs[0].x, vs[0].y);\n    for (let i = 1; i < vs.length; ++i) {\n      ctx.lineTo(vs[i].x, vs[i].y);\n    }\n    ctx.fillStyle = col;\n    ctx.closePath();\n    ctx.fill();\n    // }\n\n    // ctx.beginPath();\n    // ctx.moveTo(vs[0].x, vs[0].y);\n    // for (let i = 1; i < vs.length; ++i) {\n    //     ctx.lineTo(vs[i].x, vs[i].y);\n    // }\n    // ctx.lineWidth = this.preset.polygonOutlineWidth;\n    // ctx.strokeStyle = this.preset.polygonOutlineColor;\n\n    // ctx.closePath();\n    // ctx.stroke();\n  }\n  public curveQuadraticArrowOffScreen(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    col: string,\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number\n  ) {\n    ctx.lineWidth = rs.lineWidth + 10;\n    ctx.strokeStyle = col;\n    ctx.beginPath();\n    ctx.moveTo(x0, y0);\n    ctx.quadraticCurveTo(x1, y1, x2, y2);\n    ctx.stroke();\n    ctx.closePath();\n  }\n  // CurveBezierOffScreen(col: string, x0: number, y0: number, x1: number, y1: number, x2: number, y2: number) {\n  public curveBezierOffScreen(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    col: string,\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    x3: number,\n    y3: number\n  ) {\n    ctx.lineWidth = rs.lineWidth + 10;\n    ctx.strokeStyle = col;\n    ctx.beginPath();\n    ctx.moveTo(x0, y0);\n    ctx.bezierCurveTo(x1, y1, x2, y2, x3, y3);\n    ctx.stroke();\n    ctx.closePath();\n  }\n  public polygonOffScreen(ctx: CanvasRenderingContext2D, col: string, vs: NVector3[], tolerance: number = 10) {\n    // console.log(col);\n    ctx.fillStyle = col;\n    ctx.strokeStyle = col;\n    ctx.lineWidth = tolerance;\n    ctx.beginPath();\n    ctx.moveTo(vs[0].x, vs[0].y);\n    for (let i = 1; i < vs.length; ++i) {\n      ctx.lineTo(vs[i].x, vs[i].y);\n    }\n    ctx.closePath();\n    ctx.stroke();\n    ctx.fill();\n  }\n  public PolygonOffScreenByVecs(ctx: CanvasRenderingContext2D, col: string, pts: NVector3[], tolerance: number = 10) {\n    ctx.fillStyle = col;\n    ctx.strokeStyle = col;\n    ctx.lineWidth = tolerance;\n    ctx.beginPath();\n    ctx.moveTo(pts[0].x, pts[0].y);\n    for (let i = 1; i < pts.length; ++i) {\n      ctx.lineTo(pts[i].x, pts[i].y);\n    }\n    ctx.closePath();\n    ctx.stroke();\n    ctx.fill();\n  }\n  public polygonOffScreenByVecsOfVecs(\n    ctx: CanvasRenderingContext2D,\n    col: string,\n    pts: NVector3[][]\n  ) {\n    for (let i = 1; i < pts.length; ++i) {\n      this.PolygonOffScreenByVecs(ctx, col, pts[i]);\n    }\n  }\n  public rPointOffscreen(ctx: CanvasRenderingContext2D, col: string, v: NVector3, scale: number) {\n    // if (this.renderer.annotationInstance.implementations.app.model.appCoreWrapper.browserUtility.type === BROWSER_TYPE.Edge ) {\n    //     this.PointRegularDragOffscreen(ctx, col, v.x, v.y );\n    //     return;\n    // }\n\n    const svgRender = false;\n    if (svgRender) {\n      const x = v.x - this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.width * 0.5 + 7;\n      const y = v.y - this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.height;\n      if (this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n        ctx.save();\n        ctx.translate(x - this.renderer.imageAnnoApp.scene.paramsEditing.croppingMaskParams.x , y - this.renderer.imageAnnoApp.scene.paramsEditing.croppingMaskParams.y);\n        ctx.fillStyle = col;\n        ctx.fill(this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path2D);\n        ctx.restore();\n      }\n      // ctx.globalCompositeOperation = 'source-in';\n      // ctx.fillStyle = col;\n      // ctx.drawImage(this.preset.pointRegularImg, v.x - this.preset.pointRegularImg.width * 0.5, v.y - this.preset.pointRegularImg.height);\n      // ctx.fill();\n    } else {\n      const x = v.x - this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.width * 0.5;\n      const y = v.y - this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.height;\n      // ctx.save();\n      // ctx.translate(x, y);\n      ctx.beginPath();\n      ctx.fillStyle = col;\n      ctx.rect(\n        x - this.renderer.imageAnnoApp.scene.paramsEditing.croppingMaskParams.x +\n          (this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.width * 0.5 -\n            this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.width * 0.5 * scale),\n        y - this.renderer.imageAnnoApp.scene.paramsEditing.croppingMaskParams.y +\n          (this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.height -\n            this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.height * scale),\n        this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.width * scale,\n        this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.height * scale\n      );\n      ctx.closePath();\n      ctx.fill();\n      // ctx.restore();\n    }\n  }\n  public pointRegularDragOffscreen(\n    ctx: CanvasRenderingContext2D,\n    col: string,\n    x: number,\n    y: number,\n    easing = 1.0,\n    isUp = true\n  ) {\n    if (!this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n      return;\n    }\n    let boundingOffset = this.renderer.imageAnnoApp.customization.themeCurrent.properties\n      .pointBoundOffset;\n    if (isUp) {\n      boundingOffset *= easing;\n    } else {\n      boundingOffset -= boundingOffset * easing;\n    }\n\n    const svgRender = false;\n    if (svgRender) {\n      if (this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n        ctx.save();\n        ctx.translate(\n          x - this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.width * 0.25,\n          y - this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.height\n        );\n        ctx.fillStyle = col;\n        ctx.fill(\n          this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path2D,\n          'nonzero'\n        );\n        ctx.restore();\n      }\n    } else {\n      // ctx.save();\n      // ctx.translate(x, y);\n      ctx.beginPath();\n      ctx.fillStyle = col;\n      ctx.rect(\n        x,\n        y,\n        this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.width,\n        this.renderer.imageAnnoApp.customization.themeCurrent.rPoint.height\n      );\n      ctx.closePath();\n      ctx.fill();\n      // ctx.restore();\n    }\n  }\n}\n","import { Draw } from '..';\nexport class ImagePreset {\n  public draw: Draw;\n  public listBase64 = new Map<string, string>();\n  public activeBase64ID = ``;\n  constructor(draw: Draw) {\n    this.draw = draw;\n  }\n  public addBase64(id: string, value: string) {\n    if (!this.listBase64.has(id)) {\n      this.listBase64.set(id, value);\n      this.draw.renderer.imageAnnoApp.io.eventListenerAnnotation.addBase64Stack(id, value);\n    }\n    // console.log(this.listBase64)\n    // this.listBase64.forEach((d) => (\n    //     console.log(d)\n    // ));\n    // this.listBase64\n  }\n  public activeBase64(id: string) {\n    if (this.listBase64.has(id)) {\n      this.activeBase64ID = id;\n      this.draw.renderer.imageAnnoApp.activeCommandController.activeBase64img = this.listBase64.get(\n        id\n      ) as string;\n      this.draw.renderer.imageAnnoApp.io.eventListenerAnnotation.selectBase64(id);\n    }\n  }\n}\n","import { NVector3 } from '../../../../../../lib';\nimport { RenderStyle } from '../../../../Geometry/GeometryAnnotation/Helper/RenderStyle';\nimport { ShapePreset } from '..';\nexport class DrawingPresetArea {\n  public shape: ShapePreset;\n  private index = 0;\n  constructor(shape: ShapePreset) {\n    this.shape = shape;\n  }\n  public polygonEnd(ctx: CanvasRenderingContext2D, rs: RenderStyle, isHover: boolean, isSelected: boolean) {\n    ctx.lineWidth = rs.lineWidth * rs.scaleLocal * rs.scaleGlobal;\n    // ctx.strokeStyle = rs.colorStroke;\n\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    } else {\n      ctx.strokeStyle = rs.colorStroke;\n    }\n    if (isSelected) {\n      ctx.strokeStyle = rs.colorStroke;\n    }\n    ctx.setLineDash(rs.dash);\n    ctx.stroke();\n    ctx.setLineDash([]);\n  }\n  public polygonHoverEnd(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    isHover: boolean,\n    isSelected: boolean,\n    easing: number,\n    visibility: number,\n  ) {\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal *\n                    easing *\n                    this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale;\n    ctx.strokeStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString;\n    // ctx.strokeStyle = rs.colorStrokeHover;\n    // console.log(ctx.lineWidth);\n    // console.log(ctx.strokeStyle);\n    ctx.closePath();\n\n    // if (this.shape.draw.renderer.needFocus && !isHover) {\n    //   ctx.strokeStyle = rs.colorInterpolatedString;\n    // } else {\n    //   ctx.strokeStyle = rs.colorStroke;\n    // }\n    // if (isSelected) {\n    //   ctx.strokeStyle = rs.colorStroke;\n    // }\n    ctx.setLineDash(rs.dash);\n    ctx.stroke();\n    ctx.setLineDash([0, 0]);\n  }\n  public polygonHover(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    vs: NVector3[],\n    isGrayColor: boolean,\n    visibility: number,\n    easing = 1.0,\n    isHover = true,\n    isSelected: boolean,\n  ) {\n    ctx.beginPath();\n    ctx.moveTo(vs[0].x, vs[0].y);\n    for (this.index = 1; this.index < vs.length; ++this.index) {\n      ctx.lineTo(vs[this.index].x, vs[this.index].y);\n    }\n    this.polygonHoverEnd(ctx, rs, isHover, isSelected, easing, visibility);\n  }\n  public ellipse(ctx: CanvasRenderingContext2D, rs: RenderStyle, x: number, y: number, r0: number, r1: number, isFill: boolean, isHover: boolean, isSelected: boolean, opacity = 0.3) {\n    ctx.beginPath();\n    ctx.ellipse(x, y, r0, r1, 0, 0, 2 * Math.PI, false);\n    ctx.closePath();\n\n    // let c = this.shape.preset.polygonColorFill.split(',');\n    // let cc = c[0] + ',' + c[1] + ',' + c[2] + ',' + opacity + ')';\n    // // console.log(cc);\n\n    ctx.fillStyle = rs.colorFill;\n\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.fillStyle = rs.colorInterpolatedString;\n    } else {\n      ctx.fillStyle = rs.colorInterpolatedString;\n    }\n    if (isSelected) {\n      ctx.fillStyle = rs.colorInterpolatedString;\n      if (isFill) {\n        // ctx.fill(); // we do not want to fill polygon family\n      }\n    } else {\n      if (isFill) {\n        // ctx.fill(); // we do not want to fill polygon family\n      }\n    }\n\n    this.polygonEnd(ctx, rs, isHover, isSelected);\n  }\n  public ellipseLocalTint(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    r0: number,\n    r1: number,\n    isFill: boolean,\n    isHover: boolean,\n    isSelected: boolean,\n    opacity = 0.3\n  ) {\n    ctx.beginPath();\n    ctx.ellipse(x, y, r0, r1, 0, 0, 2 * Math.PI, false);\n    ctx.closePath();\n\n    const innerRadius = 0;\n    const outerRadius = r1;\n\n    const col = [255 * 0.5, 255 * 0.5, 255 * 0.5];\n\n    const gradient = ctx.createRadialGradient(x, y, innerRadius, x, y, outerRadius);\n    gradient.addColorStop(0, `rgba(${col[0]}, ${col[1]}, ${col[2]}, 0.9)`);\n    gradient.addColorStop(1, `rgba(${col[0]}, ${col[1]}, ${col[2]}, 0.0)`);\n\n    ctx.fillStyle = gradient;\n    ctx.fill();\n  }\n  public ellipseHover(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    r0: number,\n    r1: number,\n    isGrayColor: boolean,\n    visibility: number,\n    easing = 1.0,\n    isHover = true,\n    isSelected: boolean,\n  ) {\n    ctx.beginPath();\n    ctx.ellipse(x, y, r0, r1, 0, 0, 2 * Math.PI, false);\n    ctx.closePath();\n\n    this.polygonHoverEnd(ctx, rs, isHover, isSelected, easing, visibility);\n  }\n  public roundedRect(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    vs: NVector3[],\n    r: number,\n    xOff = 0\n  ) {\n    // let color = s.backgroundColor;\n    const radius = r; // parseFloat(s.borderRadius);\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal; // parseFloat(s.lineWidth);\n    ctx.strokeStyle = rs.colorStroke;\n    // ctx.save();\n    ctx.beginPath();\n\n    ctx.moveTo(vs[0].x + xOff + radius, vs[0].y);\n    ctx.lineTo(vs[1].x - xOff - radius, vs[1].y);\n\n    ctx.arcTo(vs[1].x - xOff, vs[1].y, vs[1].x - xOff, vs[1].y + radius, radius);\n    ctx.lineTo(vs[2].x - xOff, vs[2].y - radius);\n\n    ctx.arcTo(vs[2].x - xOff, vs[2].y, vs[2].x - xOff - radius, vs[2].y, radius);\n    ctx.lineTo(vs[3].x + xOff + radius, vs[3].y);\n\n    ctx.arcTo(vs[3].x + xOff, vs[3].y, vs[3].x + xOff, vs[3].y - radius, radius);\n    ctx.lineTo(vs[0].x + xOff, vs[0].y + radius);\n    ctx.arcTo(vs[0].x + xOff, vs[0].y, vs[0].x + xOff + radius, vs[0].y, radius);\n\n    ctx.setLineDash(rs.dash);\n    ctx.stroke();\n    ctx.setLineDash([]);\n    // if (s.backgroundColor !== null) ctx.fill();\n    // ctx.restore();\n  }\n  public rectangle(ctx: CanvasRenderingContext2D, rs: RenderStyle, vs: NVector3[], cv: NVector3, isFill: boolean, isHover: boolean, isSelected: boolean) {\n    ctx.beginPath();\n    ctx.moveTo(vs[0].x, vs[0].y);\n    for (this.index = 1; this.index < vs.length; ++this.index) {\n      ctx.lineTo(vs[this.index].x, vs[this.index].y);\n    }\n    ctx.closePath();\n\n    ctx.fillStyle = rs.colorFill;\n\n    if (isFill) {\n      if (this.shape.draw.renderer.needFocus && !isHover) {\n        ctx.fillStyle = rs.colorInterpolatedString;\n      } else {\n        ctx.fillStyle = rs.colorInterpolatedString;\n      }\n      if (isSelected) {\n        ctx.fillStyle = rs.colorInterpolatedString;\n        if (isFill) {\n          // ctx.fill(); // we do not want to fill polygon family\n        }\n      } else {\n        if (isFill) {\n          // ctx.fill(); // we do not want to fill polygon family\n        }\n      }\n    }\n    this.polygonEnd(ctx, rs, isHover, isSelected);\n  }\n  public rectangleHover(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    vs: NVector3[],\n    isGrayColor: boolean,\n    visibility: number,\n    easing = 1.0,\n    isHover = true,\n    isSelected: boolean,\n  ) {\n    ctx.beginPath();\n    ctx.moveTo(vs[0].x, vs[0].y);\n    for (this.index = 1; this.index < vs.length; ++this.index) {\n      ctx.lineTo(vs[this.index].x, vs[this.index].y);\n    }\n    this.polygonHoverEnd(ctx, rs, isHover, isSelected, easing, visibility);\n  }\n  public polygon(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    vs: NVector3[],\n    isUnder: boolean,\n    isGrayColor: boolean,\n    visibility: number,\n    isFill: boolean,\n    isHover: boolean,\n    isSelected: boolean\n  ) {\n    ctx.beginPath();\n    ctx.moveTo(vs[0].x, vs[0].y);\n    for (this.index = 1; this.index < vs.length; ++this.index) {\n      ctx.lineTo(vs[this.index].x, vs[this.index].y);\n    }\n    ctx.closePath();\n\n    // if (this.shape.draw.renderer.needFocus && !isHover ) {\n    //     ctx.fillStyle = rs.colorFillHover;\n    // } else {\n    //     ctx.fillStyle = rs.colorFill;\n    // }\n    // if (isSelected) {\n    //     ctx.fillStyle = rs.colorFill;\n    //     if (isFill) { ctx.fill(); }\n    // } else {\n    //     if (isFill) { ctx.fill(); }\n    // }\n\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.fillStyle = rs.colorInterpolatedString;\n    } else {\n      ctx.fillStyle = rs.colorInterpolatedString;\n    }\n    if (isSelected) {\n      ctx.fillStyle = rs.colorInterpolatedString;\n      if (isFill) {\n        // ctx.fill(); // we do not want to fill polygon family\n      }\n    } else {\n      if (isFill) {\n        // ctx.fill(); // we do not want to fill polygon family\n      }\n    }\n\n    // .................. rendering for stroke\n    ctx.beginPath();\n    ctx.moveTo(vs[0].x, vs[0].y);\n    for (this.index = 1; this.index < vs.length; ++this.index) {\n      ctx.lineTo(vs[this.index].x, vs[this.index].y);\n    }\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n\n    // if (this.shape.draw.renderer.needFocus && !isHover ) {\n    //     ctx.strokeStyle = rs.colorFillHover;\n    // } else {\n    //     ctx.strokeStyle = rs.colorFill;\n    // }\n    // if (isSelected) {\n    //     ctx.strokeStyle = rs.colorFill;\n    // }\n\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    } else {\n      ctx.strokeStyle = rs.colorStroke;\n    }\n    if (isSelected) {\n      ctx.strokeStyle = rs.colorStroke;\n    }\n\n    ctx.setLineDash(rs.dash);\n    if (isUnder) {\n      ctx.stroke();\n      ctx.closePath();\n    } else {\n      ctx.closePath();\n      ctx.stroke();\n    }\n    ctx.setLineDash([]);\n  }\n  public polygonByVecGhost(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    vs: NVector3[],\n    isUnder: boolean,\n    isGrayColor: boolean,\n    visibility: number\n  ) {\n    ctx.beginPath();\n    ctx.moveTo(vs[0].x, vs[0].y);\n    for (this.index = 1; this.index < vs.length; ++this.index) {\n      ctx.lineTo(vs[this.index].x, vs[this.index].y);\n    }\n\n    ctx.fillStyle = rs.colorFill;\n    ctx.closePath();\n    // ctx.fill(); // we do not want to fill polygon family\n\n    ctx.beginPath();\n    ctx.moveTo(vs[0].x, vs[0].y);\n    for (this.index = 1; this.index < vs.length; ++this.index) {\n      ctx.lineTo(vs[this.index].x, vs[this.index].y);\n    }\n    ctx.lineTo(vs[0].x, vs[0].y);\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n    ctx.strokeStyle = rs.colorStroke;\n\n    if (isUnder) {\n      ctx.stroke();\n      ctx.closePath();\n    } else {\n      ctx.closePath();\n      ctx.stroke();\n    }\n  }\n}\n","import { NVector3 } from '../../../../../../lib';\nimport { AGeometryBase } from '../../../../Geometry/Common/Base/AGeometryBase';\nimport { ShapePreset } from '..';\nexport class DrawingPresetCluster {\n  public shape: ShapePreset;\n  // private index: number = 0;\n  constructor(shape: ShapePreset) {\n    this.shape = shape;\n  }\n  public drawingPresetClustering = (\n    ctx: CanvasRenderingContext2D,\n    geometries: AGeometryBase[],\n    vec: NVector3,\n    r0: number,\n    r1: number,\n    isHover: boolean,\n    t = 1\n  ) => {\n    const colString = geometries[0].styleComponent.renderStyle.colorFillHover.split(',');\n    const colorFillHover = `rgba(${+colString[0].split(\n      '('\n    )[1]}, ${+colString[1]}, ${+colString[2]}, ${(+colString[3].split(')')[0] - 0.1) * t})`;\n    const fillColor = geometries[0].styleComponent.renderStyle.colorInterpolatedString; //`rgba(${geometries[0].styleComponent.renderStyle.colorInterpolatedString})`\n\n    // if (renderer.optimizer.optimizer.optimizer.renderer.annotationInstance.implementations.app.INSPECTION) {\n    if (isHover) {\n      for (let i = 0; i < geometries.length; ++i) {\n        ctx.lineWidth = 0.6;\n        ctx.strokeStyle = geometries[0].styleComponent.renderStyle.colorFill;\n        ctx.beginPath();\n        ctx.moveTo(vec.x, vec.y);\n        ctx.lineTo(geometries[i].vec.x, geometries[i].vec.y);\n        ctx.closePath();\n        ctx.stroke();\n\n        // sub points\n        ctx.lineWidth = 1;\n        ctx.strokeStyle = 'rgba(255, 255, 255, 1)';\n        ctx.fillStyle = geometries[0].styleComponent.renderStyle.colorFill;\n        ctx.beginPath();\n        ctx.arc(geometries[i].vec.x, geometries[i].vec.y, 4, 0, Math.PI * 2);\n        ctx.closePath();\n        ctx.fill();\n        ctx.stroke();\n      }\n    }\n\n    // center point\n    if (isHover) {\n      ctx.fillStyle = geometries[0].styleComponent.renderStyle.colorFill;\n      ctx.beginPath();\n      ctx.arc(vec.x, vec.y, 1.5, 0, Math.PI * 2);\n      ctx.closePath();\n      ctx.fill();\n    } else {\n      // if(this.type === GTYPE.POINT_NUMBERED) {\n      //   ctx.fillStyle = 'rgba(0, 255, 0, 0.5)';\n      // } else if(this.type === GTYPE.POINT_REGULAR) {\n      //   ctx.fillStyle = 'rgba(255, 0, 0, 0.5)';\n      // }\n      ctx.beginPath();\n      ctx.arc(vec.x, vec.y, r1, 0, Math.PI * 2);\n      ctx.closePath();\n      ctx.fillStyle = colorFillHover;\n      ctx.fill();\n      ctx.beginPath();\n      ctx.arc(vec.x, vec.y, r0, 0, Math.PI * 2);\n      ctx.closePath();\n      ctx.fillStyle = fillColor;\n      ctx.fill();\n\n      ctx.fillStyle = `rgba(255, 255, 255, 1)`;\n      ctx.font = 'bold 11px Arial';\n      // ctx.font='bold 9px NotoSerif-Bold';\n      ctx.textAlign = 'center';\n      ctx.fillText(`${geometries.length}`, vec.x, vec.y + 4);\n    }\n  };\n}\n","import {\n  deepCopy,\n  getRotationByWorldCoordinateByTwo,\n  NVector3,\n} from '../../../../../../lib';\nimport { ThemeColorId } from '../../../../Customization/ThemeRenderStyle/Utility';\nimport { RenderStyle } from '../../../../Geometry/GeometryAnnotation/Helper/RenderStyle';\nimport { ShapePreset } from '..';\nexport class DrawingPresetCurve {\n  public shape: ShapePreset;\n  private index = 0;\n  constructor(shape: ShapePreset) {\n    this.shape = shape;\n  }\n  public cArrowByTranslation(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    vec0: NVector3,\n    vec1: NVector3,\n    x0: number,\n    y0: number,\n    arrowScale: number,\n    scaleRender: number,\n    isHover: boolean,\n    isGrayColor: boolean,\n    visibility: number,\n    easing = 1.0,\n    isSelected: boolean,\n    themeColorId: ThemeColorId\n  ) {\n    const degree = getRotationByWorldCoordinateByTwo(deepCopy(vec0), deepCopy(vec1));\n    ctx.save();\n    ctx.translate(x0, y0);\n    ctx.rotate(-((degree * Math.PI) / 180));\n\n    const height =\n      7.5 *\n      this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.arrow.scale *\n      scaleRender; // 7.5;\n    const depth =\n      -12 *\n      this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.arrow.scale *\n      scaleRender; // 12;\n\n    // if (isHover) {\n    //     ctx.lineWidth = easing * rs.lineWidth * this.shape.draw.renderer.annotationInstance.customization.themeCurrent.properties.elasticScale;\n    //     ctx.beginPath();\n    //     ctx.moveTo(x0, y0);\n    //     ctx.lineTo(x1, y1);\n    //     ctx.lineTo(x2, y2);\n    //     ctx.lineTo(x0, y0);\n    //     ctx.closePath();\n    //     ctx.fillStyle = this.shape.draw.renderer.annotationInstance.customization.themeCurrent.properties.outlineHoverColorRGBAString;\n    //     ctx.strokeStyle = this.shape.draw.renderer.annotationInstance.customization.themeCurrent.properties.outlineHoverColorRGBAString;\n    //     ctx.stroke();\n    //     ctx.fill();\n    // }\n\n    ctx.beginPath();\n    ctx.moveTo(0, 0);\n    ctx.lineTo(-(depth * arrowScale), -height * arrowScale);\n    ctx.lineTo(-(depth * arrowScale), height * arrowScale);\n    // ctx.lineTo(x0, y0);\n    ctx.closePath();\n\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n\n    // // // let col = this.shape.draw.arrowColor;\n    // if (this.shape.draw.renderer.needFocus && !isHover ) {\n    //     ctx.fillStyle = rs.colorFillHover; // '#000000';\n    //     ctx.strokeStyle = rs.colorStrokeHover;\n    // } else {\n    //     ctx.fillStyle = rs.colorFill;\n    //     ctx.strokeStyle = rs.colorStroke;\n    // }\n\n    // if (isSelected) {\n    //     ctx.fillStyle = rs.colorFill;\n    //     ctx.strokeStyle = rs.colorStroke;\n    // }\n\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.fillStyle = rs.colorFillHover; // '#000000';\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    } else {\n      ctx.fillStyle = rs.colorFill;\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    }\n\n    if (isSelected) {\n      ctx.fillStyle = rs.colorFill;\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    }\n\n    if (isHover) {\n      // console.log('hover')\n      // for ThemeColorId.BackgroundColor, we need to invert the color of outlineHoverColorRGBAString;\n      // let strokeStyle = rs.colorInterpolatedString;\n      if (themeColorId === ThemeColorId.BackgroundColor) {\n        const cols = +rs.colorStroke.split(',')[1];\n        if (cols < 50) {\n          ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';\n        } else {\n          ctx.strokeStyle = 'rgba(0, 0, 0, 0.5)';\n        }\n      }\n      // end\n    }\n\n    ctx.stroke();\n    ctx.fill();\n    ctx.restore();\n  }\n  public curveQuadraticArrow(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    isHover: boolean,\n    vecs: NVector3[],\n    isGrayColor: boolean,\n    visibility: number,\n    easing = 1.0,\n    isSelected: boolean,\n    themeColorId: ThemeColorId,\n    isDash = false,\n    lineDashOffset = 0.0,\n    AniDirection = true\n  ) {\n    /*\n    if (isHover) {\n      const val = easing * rs.lineWidth * this.shape.draw.renderer.annotationInstance.customization.themeCurrent.properties.elasticScale;\n      ctx.lineWidth = val;\n\n      // for ThemeColorId.BackgroundColor, we need to invert the color of outlineHoverColorRGBAString;\n      if (themeColorId === ThemeColorId.BackgroundColor) {\n        const cols  = +rs.colorStroke.split(',');\n        if(cols[0] < 50 && cols[1] < 50 && cols[1] < 50) {\n          ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';\n        } else {\n          ctx.strokeStyle = 'rgba(0, 0, 0, 0.5)';\n        }\n      } else {\n        ctx.strokeStyle = this.shape.draw.renderer.annotationInstance.customization.themeCurrent.properties.outlineHoverColorRGBAString;\n      }\n      // end\n\n      ctx.beginPath();\n      ctx.moveTo(x0, y0);\n      ctx.quadraticCurveTo(x1, y1, x2, y2);\n      ctx.stroke();\n    }\n    */\n\n    ctx.lineDashOffset = lineDashOffset;\n    // if (isDash) {\n    ctx.setLineDash(rs.dash);\n    // console.log(rs.dash);\n    //   ctx.lineDashOffset = this.offset;\n    // }\n    // else if (lineType === 2) {\n    //     ctx.setLineDash([3, 3]);\n    //     ctx.lineDashOffset = this.offset;\n    //     if (++this.offset > 16) { this.offset = 0; }\n    // }\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n    ctx.beginPath();\n    ctx.moveTo(x2, y2);\n    ctx.quadraticCurveTo(x1, y1, x0, y0);\n\n    // ctx.setLineDash([2,3])\n\n    // if (this.shape.draw.renderer.needFocus && !isHover ) {\n    //     ctx.strokeStyle = rs.colorStrokeHover;\n    // } else {\n    //     ctx.strokeStyle = rs.colorStroke;\n    // }\n    // if (isSelected) {\n    //     ctx.fillStyle = rs.colorFill;\n    //     ctx.strokeStyle = rs.colorStroke;\n    // }\n\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    } else {\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    }\n    if (isSelected) {\n      ctx.fillStyle = rs.colorFill;\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    }\n\n    ctx.stroke();\n    ctx.setLineDash([]);\n  }\n  public arrowByVecNode(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    vs: NVector3[],\n    scale: number,\n    isGrayColor: boolean,\n    visibility: number,\n    easing = 1.0,\n    isHover = true,\n    isSelected: boolean\n  ) {\n    for (this.index = 0; this.index < vs.length; ++this.index) {\n      this.shape.node.node(ctx, rs, vs[this.index].x, vs[this.index].y, scale);\n    }\n    this.shape.area.polygonHoverEnd(ctx, rs, isHover, isSelected, easing, visibility);\n  }\n  public curveQuadratic(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    isHover = false,\n    isSelected: boolean\n  ) {\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n    // if (this.shape.draw.renderer.needFocus && !isHover ) {\n    //     ctx.strokeStyle = rs.colorStrokeHover;\n    // } else {\n    //     ctx.strokeStyle = rs.colorStroke;\n    // }\n    // if (isSelected) { ctx.strokeStyle = rs.colorStroke; }\n\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    } else {\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    }\n    if (isSelected) {\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    }\n\n    // ctx.save();\n    ctx.beginPath();\n    ctx.moveTo(x0, y0);\n    ctx.quadraticCurveTo(x1, y1, x2, y2);\n    // ctx.closePath();\n    ctx.stroke();\n    // ctx.restore();\n  }\n  public edgeCurveQuadraticHover(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    easing = 1.0,\n    isHover: boolean,\n    isSelected: boolean\n  ) {\n    ctx.lineWidth =\n      easing *\n      rs.lineWidth * rs.scaleGlobal * rs.scaleLocal *\n      this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale;\n    ctx.strokeStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString;\n    // ctx.strokeStyle = rs.colorInterpolatedString;\n    ctx.beginPath();\n    ctx.moveTo(x0, y0);\n    ctx.quadraticCurveTo(x1, y1, x2, y2);\n    ctx.stroke();\n  }\n  public curveBezier(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    x3: number,\n    y3: number,\n    isHover: boolean,\n    isSelected: boolean\n  ) {\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n    // if (this.shape.draw.renderer.needFocus && !isHover ) {\n    //     ctx.fillStyle = rs.colorFillHover;\n    //     ctx.strokeStyle = rs.colorStrokeHover;\n    // } else {\n    //     ctx.fillStyle = rs.colorFill;\n    //     ctx.strokeStyle = rs.colorStroke;\n    // }\n    // if (isSelected) {\n    //     ctx.fillStyle = rs.colorFill;\n    //     ctx.strokeStyle = rs.colorStroke;\n    // }\n\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.fillStyle = rs.colorFillHover;\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    } else {\n      ctx.fillStyle = rs.colorFill;\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    }\n    if (isSelected) {\n      ctx.fillStyle = rs.colorFill;\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    }\n    ctx.beginPath();\n    ctx.moveTo(x0, y0);\n    ctx.bezierCurveTo(x1, y1, x2, y2, x3, y3);\n    ctx.stroke();\n  }\n  public curveBezierClose(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    x3: number,\n    y3: number\n  ) {\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n    // ctx.strokeStyle = rs.colorStroke;\n    ctx.strokeStyle = rs.colorInterpolatedString;\n    // ctx.save();\n    ctx.beginPath();\n    ctx.moveTo(x0, y0);\n    ctx.bezierCurveTo(x1, y1, x2, y2, x3, y3);\n    // ctx.closePath();\n    ctx.stroke();\n    // ctx.restore();\n  }\n  public curveBezierHoverPolyline(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    x3: number,\n    y3: number,\n    easing: number,\n    visibility = 0.5\n  ) {\n    ctx.lineWidth =\n      easing *\n      rs.lineWidth * rs.scaleGlobal * rs.scaleLocal *\n      this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale;\n    // ctx.strokeStyle = this.shape.draw.renderer.annotationInstance.customization.themeCurrent.properties.outlineHoverColorRGBAString;\n    ctx.strokeStyle = rs.colorInterpolatedString;\n    ctx.beginPath();\n    ctx.moveTo(x0, y0);\n    ctx.bezierCurveTo(x1, y1, x2, y2, x3, y3);\n    ctx.stroke();\n  }\n  public curveBezierClosed(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    x3: number,\n    y3: number,\n    isHover: boolean,\n    isSelected: boolean\n  ) {\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n    // if (this.shape.draw.renderer.needFocus && !isHover ) {\n    //     ctx.fillStyle = rs.colorFillHover;\n    //     ctx.strokeStyle = rs.colorStrokeHover;\n    // } else {\n    //     ctx.fillStyle = rs.colorFill;\n    //     ctx.strokeStyle = rs.colorStroke;\n    // }\n    // if (isSelected) {\n    //     ctx.fillStyle = rs.colorFill;\n    //     ctx.strokeStyle = rs.colorStroke;\n    // }\n\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.fillStyle = rs.colorFillHover;\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    } else {\n      ctx.fillStyle = rs.colorFill;\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    }\n    if (isSelected) {\n      ctx.fillStyle = rs.colorFill;\n      ctx.strokeStyle = rs.colorInterpolatedString;\n    }\n    ctx.beginPath();\n    ctx.moveTo(x0, y0);\n    ctx.bezierCurveTo(x1, y1, x2, y2, x3, y3);\n    ctx.stroke();\n  }\n  public curveBezierClosedHoverPolygon(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    x3: number,\n    y3: number,\n    easing: number\n  ) {\n    ctx.lineWidth =\n      easing *\n      rs.lineWidth * rs.scaleGlobal * rs.scaleLocal *\n      this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale;\n    // ctx.strokeStyle = this.shape.draw.renderer.annotationInstance.customization.themeCurrent.properties.outlineHoverColorRGBAString;\n    ctx.strokeStyle = rs.colorInterpolatedString;\n    // ctx.save();\n    ctx.beginPath();\n    ctx.moveTo(x0, y0);\n    ctx.bezierCurveTo(x1, y1, x2, y2, x3, y3);\n    ctx.stroke();\n    // ctx.closePath();\n    // ctx.restore();\n  }\n  public curveBezierClosedFill(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    x3: number,\n    y3: number\n  ) {\n    // ctx.strokeStyle = rs.colorStroke;\n    ctx.strokeStyle = rs.colorInterpolatedString;\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n    // ctx.save();\n    // ctx.bezierCurveTo(x0, y0, x1, y1, x2, y2);\n    ctx.bezierCurveTo(x1, y1, x2, y2, x3, y3);\n\n    // ctx.closePath();\n    // ctx.restore();\n  }\n  public curveQuadraticHoverPolyline(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    easing: number\n  ) {\n    ctx.lineWidth =\n      easing *\n      rs.lineWidth * rs.scaleGlobal * rs.scaleLocal *\n      this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale;\n    // ctx.strokeStyle = this.shape.draw.renderer.annotationInstance.customization.themeCurrent.properties.outlineHoverColorRGBAString;\n    ctx.strokeStyle = rs.colorInterpolatedString;\n    // ctx.save();\n    ctx.beginPath();\n    ctx.moveTo(x0, y0);\n    ctx.quadraticCurveTo(x1, y1, x2, y2);\n    // ctx.closePath();\n    ctx.stroke();\n  }\n  public drawControlLine(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    px: number,\n    py: number\n  ) {\n    //  Only for demo purposes: show the control line and control points.\n    ctx.lineWidth = 1 * rs.scaleGlobal * rs.scaleLocal;\n    if (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.isDarkBG) {\n      ctx.strokeStyle = rs.colorStroke;\n    } else {\n      ctx.strokeStyle = rs.colorStroke;\n    }\n    ctx.beginPath();\n    ctx.moveTo(x, y);\n    ctx.lineTo(px, py);\n    ctx.closePath();\n    ctx.stroke();\n    ctx.restore();\n  }\n}\n","import {\n  ColorBlending,\n  NVector3\n} from '../../../../../../lib';\n// import { RenderStyle } from '../../../../Geometry/GeometryAnnotation/Helper/RenderStyle';\nimport { ShapePreset } from '..';\nexport class DrawingPresetFreeHand {\n  public shape: ShapePreset;\n  private index = 0;\n  constructor(shape: ShapePreset) {\n    this.shape = shape;\n  }\n  public freeHandbyVecs(ctx: CanvasRenderingContext2D, v: NVector3[], color: number[], lineWidth: number, isClosed = false) {\n    ctx.globalCompositeOperation = ColorBlending.Screen;\n    const col = `rgba(${color[0]},${color[1]},${color[2]},${0.35})`\n    ctx.fillStyle = col;\n    ctx.strokeStyle = col;\n    ctx.lineWidth = lineWidth; // this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.freehand.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n\n    ctx.beginPath();\n    ctx.moveTo(v[0].x, v[0].y);\n    for (this.index = 1; this.index < v.length; ++this.index) {\n      ctx.lineTo(v[this.index].x, v[this.index].y);\n    }\n    ctx.stroke();\n    if (isClosed) {\n      // ctx.fill(); // we do not want to fill the freehand polygon\n    }\n\n    for (this.index = 0; this.index < v.length; ++this.index) {\n      ctx.beginPath();\n      ctx.arc(v[this.index].x, v[this.index].y, 1, 0, 2 * Math.PI, false);\n      ctx.closePath();\n      ctx.stroke();\n    }\n    ctx.globalCompositeOperation = ColorBlending.SourceOver;\n  }\n}\n","import {\n  ColorBlending,\n  ColorHex,\n  GType,\n  deepCopy,\n  getRotationByWorldCoordinateByTwo,\n  NVector3,\n} from '../../../../../../lib';\nimport { RenderStyle } from '../../../../Geometry/GeometryAnnotation/Helper/RenderStyle';\nimport { ShapePreset } from '..';\nexport class DrawingPresetLine {\n  public shape: ShapePreset;\n  private index = 0;\n  constructor(shape: ShapePreset) {\n    this.shape = shape;\n  }\n  public line(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    over: boolean\n  ) {\n    // let style = this.shape.preset.polylineColor;\n    let scale = rs.lineWidth;\n    if (over) {\n      // style = CGeometryRender.themeDrawing.clineStyle.hover;\n      scale = this.shape.draw.renderer.numericalMotion.scale(scale);\n      //   CBoundingBox.RenderBoundingBoxForTwoVecs(ctx, new NVector3(x0, y0), new NVector3(x1, y1), style.strokeColor, 5 + (1.5 * scale), 1.5 * scale);\n    }\n    // ctx.globalAlpha = 1;\n    ctx.beginPath();\n    ctx.moveTo(x0, y0);\n    ctx.lineTo(x1, y1);\n    ctx.closePath();\n    ctx.lineWidth = scale;\n    // const col = this.shape.preset.polylineColor;\n    ctx.strokeStyle = rs.colorStroke;\n    ctx.stroke();\n  }\n  public lineTrajectory(ctx: CanvasRenderingContext2D, rs: RenderStyle, vs: NVector3[]) {\n    // let style = CGeometryRender.themeDrawing.clineStyle.hover;\n    ctx.globalAlpha = 1;\n    ctx.globalCompositeOperation = ColorBlending.Screen;\n    for (this.index = 1; this.index < vs.length - 2; this.index += 2) {\n      ctx.beginPath();\n\n      ctx.moveTo(vs[this.index + 1].x, vs[this.index + 1].y);\n      ctx.lineTo(vs[this.index].x, vs[this.index].y);\n      // ctx.arc(vs[this.index].x, vs[this.index].y, NumericalMotion.Scale(style.fillSize) * i * i, 0, 2 * Math.PI, false);\n      // ctx.arc(vs[this.index].x, vs[this.index].y, i, 0, 2 * Math.PI, false);\n\n      ctx.lineWidth = rs.lineWidth * 0.15 * rs.scaleGlobal * rs.scaleLocal;\n      // const col = rs.colorStroke;\n      // let strength = 0.02;\n      // let falloff = 0.005;\n      // let vis = this.index * (strength * Math.exp(falloff * this.index * this.index));\n      // col[3] = vis;\n      ctx.strokeStyle = rs.colorStroke; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n      ctx.stroke();\n      ctx.closePath();\n    }\n    ctx.globalCompositeOperation = ColorBlending.SourceOver;\n  }\n  public polyline(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    vs: NVector3[],\n    isGrayColor: boolean,\n    visibility: number,\n    isHover: boolean,\n    isSelected: boolean\n  ) {\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.strokeStyle = rs.colorStrokeHover;\n    } else {\n      ctx.strokeStyle = rs.colorStroke;\n    }\n    if (isSelected) {\n      ctx.strokeStyle = rs.colorStroke;\n    }\n\n    ctx.beginPath();\n    ctx.moveTo(vs[0].x, vs[0].y);\n    for (this.index = 1; this.index < vs.length; ++this.index) {\n      ctx.lineTo(vs[this.index].x, vs[this.index].y);\n    }\n    ctx.stroke();\n    ctx.closePath();\n  }\n  public polylineHover(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    vs: NVector3[],\n    isGrayColor: boolean,\n    visibility: number,\n    easing = 1.0,\n    isHover = true\n  ) {\n    ctx.lineWidth =\n      easing *\n      rs.lineWidth * rs.scaleGlobal * rs.scaleLocal *\n      this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale;\n    ctx.strokeStyle = rs.colorStrokeHover;\n    ctx.beginPath();\n    ctx.moveTo(vs[0].x, vs[0].y);\n    for (this.index = 1; this.index < vs.length; ++this.index) {\n      ctx.lineTo(vs[this.index].x, vs[this.index].y);\n    }\n    ctx.stroke();\n    ctx.setLineDash(rs.dash);\n    ctx.closePath();\n    ctx.setLineDash([0, 0]);\n  }\n  public edgePolylineHover(ctx: CanvasRenderingContext2D, rs: RenderStyle, x0: number, y0: number, x1: number, y1: number, easing = 1.0, isHover: boolean, isSelected: boolean) {\n    ctx.lineWidth = easing * rs.lineWidth * rs.scaleGlobal * rs.scaleLocal * this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale;\n    ctx.strokeStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString;\n    // console.log(ctx.lineWidth);\n    // console.log(ctx.strokeStyle);\n    ctx.beginPath();\n    ctx.moveTo(x0, y0);\n    ctx.lineTo(x1, y1);\n    ctx.closePath();\n    ctx.setLineDash(rs.dash);\n    ctx.stroke();\n    ctx.setLineDash([0, 0]);\n  }\n  public shadowMidPointForBending(ctx: CanvasRenderingContext2D, rs: RenderStyle, mv: NVector3) {\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n    ctx.strokeStyle = rs.colorStroke;\n    ctx.fillStyle = rs.colorFill;\n    ctx.beginPath();\n    ctx.arc(\n      mv.x,\n      mv.y,\n      this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.node.sizeMid,\n      0,\n      3.14 * 2\n    );\n    ctx.closePath();\n    ctx.setLineDash(rs.dash);\n    ctx.stroke();\n    ctx.setLineDash([0, 0]);\n  }\n  public polylineByVecGhost(ctx: CanvasRenderingContext2D, rs: RenderStyle, vs: NVector3[], offset: number[], isUnder: boolean, isGrayColor: boolean, visibility: number) {\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n    ctx.strokeStyle = rs.colorStroke;\n    ctx.fillStyle = rs.colorFill;\n    ctx.beginPath();\n    ctx.moveTo(vs[0].x - offset[0], vs[0].y - offset[1]);\n    for (let i = 1; i < vs.length; ++i) {\n      ctx.lineTo(vs[i].x - offset[0], vs[i].y- offset[1]);\n    }\n    // ctx.closePath();\n    if (isUnder) {\n      ctx.stroke();\n    } else {\n      ctx.stroke();\n    }\n  }\n  public polylineShadow(ctx: CanvasRenderingContext2D, rs: RenderStyle, vec: NVector3[], mouseVec: NVector3, gtype: GType) {\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n    ctx.strokeStyle = rs.colorStroke;\n    ctx.fillStyle = rs.colorFill;\n    ctx.beginPath();\n    ctx.moveTo(vec[0].x, vec[0].y);\n    for (let i = 1; i < vec.length; ++i) {\n      ctx.lineTo(vec[i].x, vec[i].y);\n    }\n    ctx.lineTo(mouseVec.x, mouseVec.y);\n    // ctx.closePath(); we do not want to close the lines for polyline\n    ctx.stroke();\n\n    if (gtype === GType.POLYGON_GRAPH) {\n      ctx.fill();\n    }\n\n    // for (let i = 0; i < vec.length; ++i) {\n\n    //     ctx.lineCap = this.preset.renderer.annotationInstance.customization.themeCurrent.properties.lineCap;\n    //     ctx.lineWidth = this.preset.nodeSizeStroke;\n    //     ctx.strokeStyle = this.preset.nodeStrokeColor;\n    //     ctx.fillStyle = this.preset.nodefillColor;\n    //     ctx.beginPath();\n    //     ctx.arc(vec[i].v.x, vec[i].v.y, this.preset.nodeSize, 0, 2 * Math.PI, false);\n    //     ctx.closePath();\n    //     ctx.fill();\n    //     ctx.stroke();\n\n    //     // ctx.arc(, this.preset.nodeSize, 0, 3.14 * 2)\n    // }\n    // ctx.stroke();\n  }\n  public polygonShadow(ctx: CanvasRenderingContext2D, rs: RenderStyle, vec: NVector3[], mouseVec: NVector3, gtype: GType) {\n    ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n    ctx.strokeStyle = rs.colorStroke;\n    ctx.fillStyle = rs.colorFill;\n    ctx.beginPath();\n    ctx.moveTo(vec[0].x, vec[0].y);\n    for (let i = 1; i < vec.length; ++i) {\n      ctx.lineTo(vec[i].x, vec[i].y);\n    }\n    ctx.lineTo(mouseVec.x, mouseVec.y);\n    // ctx.closePath(); we do not want to close the lines for polyline\n    ctx.closePath();\n    ctx.stroke();\n    // ctx.fill(); // we do not want to fill polygon family\n  }\n  public lineDim(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    len: number\n  ) {\n    const x = x0 + (x1 - x0) * 0.5;\n    const y = y0 + (y1 - y0) * 0.5;\n\n    const degree = getRotationByWorldCoordinateByTwo(\n      deepCopy(new NVector3(x0, y0)),\n      deepCopy(new NVector3(x1, y1))\n    );\n\n    // ctx.save();\n    // return NVector3.RotateVecsLoal(vecs, -(degree - 180));\n    ctx.translate(x, y);\n    ctx.rotate((-degree * Math.PI) / 180);\n\n    // ctx.translate(-x, -y);\n    if (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.isDarkBG) {\n      ctx.fillStyle = ColorHex.White;\n    } else {\n      ctx.fillStyle = ColorHex.Black;\n    }\n    ctx.textBaseline = 'bottom';\n    ctx.textAlign = 'center'; // 'start', 'end', 'left', 'center', 'right';\n    // ctx.fillText(len.toString(), (x0 + x1) * 0.5, (y0 + y1) * 0.5);\n\n    const unit = '';\n    // if (CGeometry.appDrawing.activeCommands.unit === UNIT.KM) { unit = ' km'; }\n    // if (CGeometry.appDrawing.activeCommands.unit === UNIT.METER) { unit = ' m'; }\n    // if (CGeometry.appDrawing.activeCommands.unit === UNIT.MILE) { unit = ' mile'; }\n\n    ctx.fillText(len.toFixed(2).toString() + unit, 0, -10);\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n\n    // reset current transformation matrix to the identity matrix\n\n    // ctx.strokeStyle = '#0FAAEA'\n    // ctx.fillStyle = 'white'\n    // ctx.lineWidth = 2\n    // ctx.beginPath();\n    // ctx.arc(x, y, 10, 0, 2 * Math.PI, false);\n    // ctx.closePath();\n    // ctx.fill();\n    // ctx.stroke();\n\n    // ctx.fillStyle = '#ff0000';\n    // ctx.fillRect(1, 1, 100, 150);\n    // //Move to the center of the canvas to (50,10) point.\n    // ctx.translate(50, 10);\n    // // Rotate the canvas by 30 degrees.\n    // ctx.rotate( (Math.PI / 180) * 30);\n    // ctx.fillStyle = '#0000ff';\n    // // Draw another rectangle\n    // ctx.fillRect(1, 1, 100, 150);\n    // Restore the unrotated context\n    // ctx.restore();\n  }\n}\n","// import { NVector3, ColorUtility, NumericalMotion } from '../../../../../../lib';\nimport { APoint } from '../../../../Geometry/GeometryAnnotation/FamilyPoint/Base/APoint';\nimport { ShapePreset } from '..';\nimport { NVector3 } from '../../../../../../lib';\nexport class DrawingPresetNGon {\n  public shape: ShapePreset;\n  // private index: number = 0;\n  constructor(shape: ShapePreset) {\n    this.shape = shape;\n  }\n  public nGon(ctx: CanvasRenderingContext2D, pts: NVector3[], isOver: boolean, isSelected: boolean) {\n    // let style = CGeometryRender.themeDrawing.listCPolygon[s];\n    ctx.globalAlpha = 1;\n\n    ctx.beginPath();\n    ctx.moveTo(pts[0].x, pts[0].y);\n    for (let i = 1; i < pts.length; ++i) {\n      ctx.lineTo(pts[i].x, pts[i].y);\n    }\n    // ctx.fillStyle = ColorUtility.HexToCanvasColor(style.fillColor, 0.2);\n    ctx.closePath();\n    // ctx.fill(); // we do not want to fill polygon family\n\n    ctx.beginPath();\n    ctx.moveTo(pts[0].x, pts[0].y);\n    for (let i = 1; i < pts.length; ++i) {\n      ctx.lineTo(pts[i].x, pts[i].y);\n    }\n    // ctx.lineWidth = style.strokeSize;\n    // ctx.strokeStyle = style.strokeColor;\n    ctx.closePath();\n    ctx.stroke();\n\n    if (isOver || isSelected) {\n      // let vs = APoint.GetVecs(pts);\n      // vs = NVector3.GetMinMaxVecFromVecs(vs);\n      // let cv = NVector3.GetCenterVecFromVecs(vs);\n      // CDrawingPreset.CenterPoint(ctx, cv.x, cv.y);\n      // CBoundingBox.RenderBoundingBoxForTwoVecs(ctx, vs[0], vs[1], style.strokeColor, NumericalMotion.Scale(10), 5 + NumericalMotion.Scale(9));\n    }\n  }\n  public nStar(ctx: CanvasRenderingContext2D, pts: APoint[], isOver: boolean, isSelected: boolean) {\n    // let style = CGeometryRender.themeDrawing.listCPolygon[s];\n    ctx.globalAlpha = 1;\n\n    ctx.beginPath();\n    ctx.moveTo(pts[0].vec.x, pts[0].vec.y);\n    for (let i = 1; i < pts.length; ++i) {\n      ctx.lineTo(pts[i].vec.x, pts[i].vec.y);\n    }\n    const c = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.polygon\n      .fillStyleFirstArray;\n    ctx.fillStyle = `rgba(${c[0]},${c[1]},${c[2]},${c[3]})`;\n    ctx.closePath();\n    ctx.fill();\n\n    ctx.beginPath();\n    ctx.moveTo(pts[0].vec.x, pts[0].vec.y);\n    for (let i = 1; i < pts.length; ++i) {\n      ctx.lineTo(pts[i].vec.x, pts[i].vec.y);\n    }\n    // ctx.lineWidth = style.strokeSize;\n    // ctx.strokeStyle = style.strokeColor;\n    ctx.closePath();\n    ctx.stroke();\n\n    if (isOver || isSelected) {\n      // let vs = APoint.GetVecs(pts);\n      // vs = NVector3.GetMinMaxVecFromVecs(vs);\n      // let cv = NVector3.GetCenterVecFromVecs(vs);\n      // CDrawingPreset.CenterPoint(ctx, cv.x, cv.y);\n      // CBoundingBox.RenderBoundingBoxForTwoVecs(ctx, vs[0], vs[1], style.strokeColor, NumericalMotion.Scale(10), 5 + NumericalMotion.Scale(9));\n    }\n  }\n}\n","import { ThemeColorId } from '../../../../Customization/ThemeRenderStyle/Utility';\nimport { RenderStyle } from '../../../../Geometry/GeometryAnnotation/Helper/RenderStyle';\nimport { ShapePreset } from '..';\nexport class DrawingPresetNode {\n  public shape: ShapePreset;\n  // private index: number = 0;\n  constructor(shape: ShapePreset) {\n    this.shape = shape;\n  }\n  public nodeMidHover(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    scale: number,\n    sc: number,\n    selected = false\n  ) {\n    if (selected) {\n      ctx.lineWidth = rs.lineWidth; //  * rs.scaleGlobal * rs.scaleLocal;\n      ctx.fillStyle = rs.colorFill; // this color is opposite to Node\n      ctx.strokeStyle = rs.colorStroke; // rs.colorFill; // this color is opposite to Node\n      ctx.beginPath();\n      if (sc < 0.1) {\n        ctx.arc(\n          x,\n          y,\n          (Math.abs(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.node.sizeMid) +\n            3) *\n            scale,\n          0,\n          2 * Math.PI,\n          false\n        );\n      } else {\n        ctx.arc(\n          x,\n          y,\n          Math.abs(\n            this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.node.sizeMid + 3\n          ) *\n            scale *\n            sc,\n          0,\n          2 * Math.PI,\n          false\n        );\n      }\n    } else {\n      ctx.lineWidth = rs.lineWidth; // * rs.scaleGlobal * rs.scaleLocal;\n      ctx.fillStyle = rs.colorStroke;\n      ctx.strokeStyle = rs.colorStrokeHover;\n      ctx.beginPath();\n      if (sc < 0.1) {\n        ctx.arc(\n          x,\n          y,\n          (Math.abs(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.node.sizeMid) +\n            1) *\n            scale,\n          0,\n          2 * Math.PI,\n          false\n        );\n      } else {\n        ctx.arc(\n          x,\n          y,\n          Math.abs(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.node.sizeMid) *\n            scale *\n            sc,\n          0,\n          2 * Math.PI,\n          false\n        );\n      }\n    }\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n  }\n  public nodeMidHoverForArrow(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    sc: number,\n    scale: number,\n    selected = false,\n    themeColorId?: ThemeColorId\n  ) {\n    ctx.beginPath();\n    ctx.lineWidth = rs.lineWidth; // * rs.scaleGlobal * rs.scaleLocal;\n    if (selected) {\n      // ctx.lineWidth = rs.lineWidth;\n      // ctx.fillStyle = rs.colorFill; // this color is opposite to Node\n      // ctx.strokeStyle = rs.colorStroke; // rs.colorFill; // this color is opposite to Node\n      // ctx.beginPath();\n      // if (sc < 0.1) {\n      //     ctx.arc(x, y, Math.abs(this.shape.draw.renderer.annotationInstance.customization.themeCurrent.node.sizeMid) + 1 , 0, 2 * Math.PI, false);\n      // } else {\n      //     ctx.arc(x, y, (Math.abs(this.shape.draw.renderer.annotationInstance.customization.themeCurrent.node.sizeMid + 1) * sc), 0, 2 * Math.PI, false);\n      // }\n      ctx.fillStyle = rs.colorFill;\n      // ctx.strokeStyle = rs.colorStrokeHover;\n      if (sc < 0.1) {\n        ctx.arc(x, y, scale, 0, 2 * Math.PI, false);\n      } else {\n        ctx.arc(x, y, scale * sc, 0, 2 * Math.PI, false);\n      }\n      ctx.fill();\n      ctx.closePath();\n      return;\n    }\n    ctx.fillStyle = rs.colorStroke;\n    ctx.strokeStyle = rs.colorStrokeHover;\n\n    if (themeColorId === ThemeColorId.BackgroundColor) {\n      const cols = +rs.colorStroke.split(',')[1];\n      if (cols < 50) {\n        ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';\n      } else {\n        ctx.strokeStyle = 'rgba(0, 0, 0, 0.5)';\n      }\n    }\n\n    if (sc < 0.1) {\n      ctx.arc(x, y, scale, 0, 2 * Math.PI, false);\n    } else {\n      ctx.arc(x, y, scale * sc, 0, 2 * Math.PI, false);\n    }\n\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n  }\n  public nodeMidStart(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    sc: number\n  ) {\n    ctx.lineWidth = rs.lineWidth; // * rs.scaleGlobal * rs.scaleLocal;\n    // ctx.strokeStyle = rs.colorStroke;\n    ctx.fillStyle = rs.colorStroke;\n    ctx.beginPath();\n    // console.log(this.shape.draw.renderer.annotationInstance.customization.themeCurrent.node.sizeMid);\n    if (sc < 0.1) {\n      ctx.arc(\n        x,\n        y,\n        Math.abs(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.node.sizeMid),\n        0,\n        2 * Math.PI,\n        false\n      );\n    } else {\n      ctx.arc(\n        x,\n        y,\n        Math.abs(\n          this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.node.sizeMid * sc\n        ),\n        0,\n        2 * Math.PI,\n        false\n      );\n    }\n    ctx.closePath();\n    ctx.fill();\n    // ctx.stroke();\n  }\n  // public NodeMid(ctx: CanvasRenderingContext2D, rs: RenderStyle, x: number, y: number) {\n  //     ctx.lineWidth = rs.lineWidth;\n  //     // ctx.strokeStyle = rs.colorStroke;\n  //     ctx.fillStyle = rs.colorStroke;\n  //     ctx.beginPath();\n  //     ctx.arc(x, y, this.shape.draw.renderer.annotationInstance.customization.themeCurrent.node.sizeMid, 0, 2 * Math.PI, false);\n  //     ctx.closePath();\n  //     ctx.fill();\n  //     // ctx.stroke();\n  // }\n  public nodeHover(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    scale: number,\n    sc: number\n  ) {\n    ctx.lineWidth = rs.lineWidth; // * rs.scaleGlobal * rs.scaleLocal;\n    ctx.strokeStyle = rs.colorStroke;\n    ctx.fillStyle = rs.colorFill;\n    ctx.beginPath();\n    // ctx.arc(x, y, NumericalMotion.Scale(this.shape.draw.renderer.annotationInstance.customization.themeCurrent.node.size) * 1.45, 0, 2 * Math.PI, false);\n    ctx.arc(\n      x,\n      y,\n      (Math.abs(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.node.size) + 1) *\n        scale,\n      0,\n      2 * Math.PI,\n      false\n    );\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n  }\n  public node(ctx: CanvasRenderingContext2D, rs: RenderStyle, x: number, y: number, scale: number) {\n    ctx.lineWidth = rs.lineWidth; // * rs.scaleGlobal * rs.scaleLocal;\n    ctx.strokeStyle = rs.colorStroke;\n    ctx.fillStyle = rs.colorFill;\n\n    ctx.beginPath();\n    ctx.arc(\n      x,\n      y,\n      (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.node.size + 1) * scale,\n      0,\n      2 * Math.PI,\n      false\n    );\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n  }\n  public nodeSelected(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    scale: number\n  ) {\n    ctx.lineWidth = rs.lineWidth; // * rs.scaleGlobal * rs.scaleLocal;\n    ctx.strokeStyle = rs.colorStroke;\n    ctx.fillStyle = rs.colorFill;\n    ctx.beginPath();\n    ctx.arc(\n      x,\n      y,\n      (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.node.size + 2) * scale,\n      0,\n      2 * Math.PI,\n      false\n    );\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n  }\n  public nodeStart(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    scale: number,\n    sc: number,\n    themeColorId?: ThemeColorId\n  ) {\n    ctx.lineWidth = rs.lineWidth; // * rs.scaleGlobal * rs.scaleLocal;\n    ctx.fillStyle = rs.colorFill;\n    ctx.strokeStyle = rs.colorStroke;\n\n    if (themeColorId === ThemeColorId.BackgroundColor) {\n      const cols = +rs.colorStroke.split(',')[1];\n      if (cols < 50) {\n        ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';\n      } else {\n        ctx.strokeStyle = 'rgba(0, 0, 0, 0.5)';\n      }\n    }\n\n    ctx.beginPath();\n    if (sc < 0.1) {\n      ctx.arc(\n        x,\n        y,\n        Math.abs(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.node.size + 1) *\n          scale,\n        0,\n        2 * Math.PI,\n        false\n      );\n    } else {\n      ctx.arc(\n        x,\n        y,\n        Math.abs(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.node.size + 1) *\n          scale *\n          sc,\n        0,\n        2 * Math.PI,\n        false\n      );\n    }\n    ctx.fill();\n    ctx.stroke();\n  }\n}\n","import { IctxShape } from '../../../../../../../../lib/Utility/SVGUtility';\nimport { BrowserType, ColorHex, hex2CanvasColor, rgbByA } from '../../../../../../lib';\nimport { RenderStyle } from '../../../../Geometry/GeometryAnnotation/Helper/RenderStyle';\nimport { ShapePreset } from '..';\nexport class DrawingPresetPoint {\n  public shape: ShapePreset;\n  // private index: number = 0;\n  constructor(shape: ShapePreset) {\n    this.shape = shape;\n  }\n  public pointRegularOverBoundingBySVGPath(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    scale: number,\n    easing = 1.0,\n    isHover = true,\n    needBoundRender = false,\n    isGrayColor: boolean,\n    visibility: number,\n    isPin: boolean\n  ) {\n    let boundingOffset = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties\n      .pointBoundOffset;\n\n    if (!this.shape.draw.renderer.hasAni) {\n      isHover = false;\n    } // this is for controlling animation effect\n\n    if (isHover) {\n      boundingOffset *= easing;\n    } else {\n      boundingOffset -= boundingOffset * easing;\n    }\n    if (needBoundRender) {\n      ctx.lineWidth =\n        0.5 +\n        easing *\n          rs.lineWidth * rs.scaleGlobal * rs.scaleLocal *\n          this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale;\n      // ctx.lineWidth *= 0.5;\n      // console.log(easing , rs.lineWidth);\n      const xPos =\n        x - this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.width * 0.5 + 6;\n      const yPos =\n        y - this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.height + 0;\n      if (\n        this.shape.draw.renderer.imageAnnoApp.implementations.app.model.appCoreWrapper\n          .browserUtility.type === BrowserType.Edge\n      ) {\n        this.pointRegularOverBoundingBySVGPathEdgeSupport(ctx, rs, xPos, yPos);\n        return;\n      }\n      // ctx.save();\n      // ctx.translate(xPos, yPos);\n      const OffsetX = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.width;\n      const OffsetY = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.height;\n      const widthHalf = OffsetX * 0.25;\n\n      ctx.save();\n      ctx.translate(\n        xPos + (widthHalf - widthHalf * scale) * 1.25,\n        yPos + (OffsetY - OffsetY * scale)\n      );\n      ctx.scale(scale, scale);\n\n      // let col = rs.colorFillHover; // this.shape.preset.regularPointColorHover;\n      ctx.strokeStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n      if (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n        ctx.stroke(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path2D);\n      }\n      ctx.restore();\n    }\n  }\n  public pointRegularOverBoundingBySVGPathSelected(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    scale: number,\n    easing = 1.0,\n    isHover = true,\n    needBoundRender = false,\n    isGrayColor: boolean,\n    visibility: number,\n    isPin: boolean\n  ) {\n    let boundingOffset = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties\n      .pointBoundOffset;\n\n    if (!this.shape.draw.renderer.hasAni) {\n      isHover = false;\n    } // this is for controlling animation effect\n\n    if (isHover) {\n      boundingOffset *= easing;\n    } else {\n      boundingOffset -= boundingOffset * easing;\n    }\n    if (needBoundRender) {\n      ctx.lineWidth =\n        0.5 +\n        easing *\n          rs.lineWidth * rs.scaleGlobal * rs.scaleLocal *\n          this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale;\n      // ctx.lineWidth *= 0.5;\n      // console.log(easing , rs.lineWidth);\n      const xPos =\n        x - this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.width * 0.5 + 6;\n      const yPos =\n        y - this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.height + 0;\n      if (\n        this.shape.draw.renderer.imageAnnoApp.implementations.app.model.appCoreWrapper\n          .browserUtility.type === BrowserType.Edge\n      ) {\n        this.pointRegularOverBoundingBySVGPathEdgeSupport(ctx, rs, xPos, yPos);\n        return;\n      }\n\n      // ..................... outer stroke end\n      ctx.save();\n      ctx.translate(xPos - 1.5, yPos - 1.75);\n      ctx.scale(1.2, 1.125);\n\n      ctx.strokeStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n      if (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n        ctx.stroke(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path2D);\n      }\n      ctx.restore();\n      // ..................... end\n\n      ctx.save();\n      ctx.translate(xPos, yPos);\n      // let col = rs.colorFillHover; // this.shape.preset.regularPointColorHover;\n      ctx.strokeStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n      if (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n        ctx.stroke(\n          this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path2D\n        );\n      }\n      ctx.restore();\n    }\n  }\n  public pointRegularDragBySVGPath(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    scale: number,\n    easing = 1.0,\n    isUp = true,\n    needBoundRender = false,\n    isGrayColor: boolean,\n    visibility: number,\n    isPin: boolean,\n    isHover: boolean,\n    isSelected: boolean\n  ) {\n    let boundingOffset = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties\n      .pointBoundOffset;\n\n    // console.log(this.shape.draw.renderer.hasAni, easing);\n    if (!this.shape.draw.renderer.hasAni) {\n      isUp = false;\n      easing = 1;\n    }\n\n    if (isUp) {\n      boundingOffset *= easing;\n    } else {\n      boundingOffset -= boundingOffset * easing;\n    }\n    y -= boundingOffset * 1.8;\n    if (needBoundRender) {\n      let r = 2.5 * boundingOffset;\n      if (r < 0) {\n        r = 0;\n      }\n    }\n    // console.log('r rendering');\n    if (\n      this.shape.draw.renderer.imageAnnoApp.implementations.app.model.appCoreWrapper.browserUtility\n        .type === BrowserType.Edge\n    ) {\n      this.pointRagularSVGRenderEdgeSupport(\n        ctx,\n        rs,\n        x - this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.width * 0.5 + 6,\n        y - this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.height + 0,\n        isHover,\n        isSelected\n      );\n      return;\n    }\n\n    if (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n      this.pointRagularSVGRender(\n        ctx,\n        rs,\n        x - this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.width * 0.5 + 6,\n        y - this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.height + 0,\n        scale,\n        isHover,\n        isSelected\n      );\n    }\n  }\n  private pointRagularSVGRender(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    scale: number,\n    isHover: boolean,\n    isSelected: boolean,\n    hasStroke = false\n  ) {\n    // const scale = this.shape.draw.renderer.annotationInstance.customization.themeCurrent.rPoint.scale;\n    const OffsetX = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.width;\n    const OffsetY = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.height;\n    // x -= this.shape.draw.renderer.annotationInstance.customization.themeCurrent.rPoint.width * 0.5;\n    // console.log(OffsetX, OffsetY);\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${0.5})`;\n    } else {\n      ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    }\n    if (isSelected) {\n      ctx.fillStyle = rs.colorInterpolatedString;\n    }\n\n    const widthHalf = OffsetX * 0.25;\n\n    ctx.save();\n    // ctx.scale(scale, scale);\n    // ctx.translate(x * 1 / scale + (OffsetX - OffsetX * scale), y + (OffsetY - OffsetY * scale));\n    // ctx.translate( - widthHalf, 0);\n    // ctx.translate(x  * 1 / scale , y * 1 /scale );\n    ctx.translate(x + (widthHalf - widthHalf * scale) * 1.25, y + (OffsetY - OffsetY * scale));\n    ctx.scale(scale, scale);\n\n    ctx.strokeStyle = rs.colorStroke; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    // col = rs.colorStroke; // this.shape.preset.regularPointColorStrok;\n\n    // let region = new Path2D();\n    // Object.keys(this.shape.draw.renderer.annotationInstance.customization.themeCurrent.rPoint.SVG.path).map(key => {\n    //     let g = this.shape.draw.renderer.annotationInstance.customization.themeCurrent.rPoint.SVG.path[key];\n    //     if (g) {\n    //         let ii = key.split(' ')[1];\n    //         if (ii === 'M') {\n    //             region.moveTo(g[0] * scale, g[1] * scale);\n    //         } else if (ii === 'C') {\n    //             region.bezierCurveTo(g[0] * scale, g[1] * scale, g[2] * scale, g[3] * scale, g[4] * scale, g[5] * scale);\n    //         } else if (ii === 'L') {\n    //             region.lineTo(g[0] * scale, g[1] * scale);\n    //         }\n    //     }\n    // });\n    // region.closePath();\n\n    ctx.fill(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path2D, 'evenodd');\n    ctx.lineWidth = 0;\n    if (hasStroke) {\n      ctx.stroke(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path2D);\n    }\n\n    // ctx.strokeStyle = 'rbga(0, 0, 0, 0.2)';\n    // ctx.lineWidth = 0.5;\n    // ctx.beginPath();\n    // ctx.arc(32 * 0.25 ,0 , 3, 0, Math.PI * 2);\n    // ctx.fill();\n    // ctx.closePath();\n    // ctx.stroke();\n    // ctx.translate( OffsetX, OffsetY );\n\n    // ctx.translate(+OffsetX  * 0.25, +OffsetY);\n\n    // if (this.shape.draw.renderer.needFocus && !isHover ) {\n    //     ctx.fillStyle = rs.colorFillHover; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${0.5})`;\n    // } else {\n    //     ctx.fillStyle = rs.colorFill; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    // }\n    // if (isSelected) { ctx.fillStyle = rs.colorFill; }\n\n    ctx.restore();\n  }\n  // PointRegularOverBoundingByImg(ctx: CanvasRenderingContext2D, rs: RenderStyle, x: number, y: number, easing: number = 1.0, isHover: boolean = true, needBoundRender: boolean = false, isGrayColor: boolean, visibility: number, isPin: boolean) {\n  //     if (!this.shape.preset.pointRegularImg) { return; }\n  //     let boundingOffset = this.shape.draw.renderer.annotationInstance.customization.themeCurrent.properties.pointBoundOffset;\n  //     if (isHover) { boundingOffset *= easing; } else { boundingOffset -= boundingOffset * easing; }\n\n  //     if (needBoundRender) {\n  //         let r = 2.5 * boundingOffset;\n  //         if (r < 0) { r = 0; }\n\n  //         if (isPin) {\n  //             const col = this.shape.preset.regularPointColorHover;\n  //             ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n  //         } else {\n  //             const col = this.shape.preset.regularPointColorHover;\n  //             ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`; // this.shape.RGB_by_A(this.shape.preset.regularPointColorHover, visibility - 0.5);\n  //         }\n  //         const col = this.shape.preset.regularPointColorStrok;\n  //         ctx.strokeStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n  //         ctx.lineWidth = this.shape.preset.regularPointColorStrokWidth;\n  //         ctx.beginPath();\n  //         ctx.arc(x, y - this.shape.preset.pointRegularImg.height * 0.5, r, 0, 2 * Math.PI, false);\n  //         ctx.closePath();\n  //         ctx.fill();\n  //         ctx.stroke();\n  //     }\n  // }\n  // PointRegularDragByImg(ctx: CanvasRenderingContext2D, rs: RenderStyle, x: number, y: number, easing: number = 1.0, isUp: boolean = true, needBoundRender: boolean = false, isGrayColor: boolean, visibility: number, isPin: boolean) {\n  //     if (!this.shape.preset.pointRegularImg) { return; }\n  //     let boundingOffset = this.shape.draw.renderer.annotationInstance.customization.themeCurrent.properties.pointBoundOffset;\n\n  //     if (isUp) { boundingOffset *= easing; } else { boundingOffset -= boundingOffset * easing; }\n\n  //     ctx.fillStyle = ColorUtility.hex2CanvasColor(ColorHex.Black, 0.3);\n  //     ctx.beginPath();\n  //     if (isUp) {\n  //         ctx.ellipse(x, y, 7, 2.5, 0, 0, 2 * Math.PI, false);\n  //     } else { ctx.ellipse(x, y + 2, 4, 2, 0, 0, 2 * Math.PI, false); }\n  //     ctx.closePath();\n  //     ctx.fill();\n\n  // y -= boundingOffset * 1.8;\n  //     if (needBoundRender) {\n  //         let r = 2.5 * boundingOffset;\n  //         if (r < 0) { r = 0; }\n\n  //         let col = this.shape.preset.regularPointColorHover;\n  //         ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n  //         col = this.shape.preset.regularPointColorStrok;\n  //         ctx.strokeStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n\n  //         ctx.lineWidth = this.shape.preset.regularPointColorStrokWidth;\n  //         ctx.beginPath();\n  //         ctx.arc(x, y - this.shape.preset.pointRegularImg.height * 0.5, r, 0, 2 * Math.PI, false);\n  //         ctx.closePath();\n  //         ctx.fill();\n  //         ctx.stroke();\n  //     }\n  //     ctx.drawImage(this.shape.preset.pointRegularImg, x - this.shape.preset.pointRegularImg.width * 0.5, y - this.shape.preset.pointRegularImg.height);\n  //     // this.PointRagularSVGRender(ctx, x - this.shape.draw.renderer.annotationInstance.customization.themeCurrent.rPoint.SVGSVGWidth * 0.5 + 6, y - this.shape.draw.renderer.annotationInstance.customization.themeCurrent.rPoint.SVGSVGHeight);\n  //     // console.log(this.shape.preset.pointRegularImg.width, this.shape.preset.pointRegularImg.height);\n  // }\n  public pointRegularDragGhost(ctx: CanvasRenderingContext2D, rs: RenderStyle, x: number, y: number, easing = 1.0, isUp = true, needBoundRender = false, isGrayColor: boolean, visibility: number, isPin: boolean) {\n    if (!this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n      return;\n    }\n    let boundingOffset = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.pointBoundOffset;\n\n    if (isUp) {\n      boundingOffset *= easing;\n    } else {\n      boundingOffset -= boundingOffset * easing;\n    }\n\n    ctx.fillStyle = hex2CanvasColor(ColorHex.Black, 0.3);\n    ctx.beginPath();\n    if (isUp) {\n      ctx.ellipse(x, y, 7, 2.5, 0, 0, 2 * Math.PI, false);\n    } else {\n      ctx.ellipse(x, y + 2, 4, 2, 0, 0, 2 * Math.PI, false);\n    }\n    ctx.closePath();\n    ctx.fill();\n\n    y -= boundingOffset * 1.8;\n    if (needBoundRender) {\n      let r = 2.5 * boundingOffset;\n      if (r < 0) {\n        r = 0;\n      }\n      ctx.strokeStyle = rs.colorStroke;\n      ctx.lineWidth = rs.lineWidth * rs.scaleGlobal * rs.scaleLocal;\n      ctx.beginPath();\n      ctx.arc(x, y - this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.height * 0.5, r, 0, 2 * Math.PI, false);\n      ctx.closePath();\n      ctx.fill();\n      ctx.stroke();\n    }\n\n    if (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n      ctx.save();\n      ctx.translate(x - this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.width * 0.5, y - this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.height);\n      ctx.beginPath();\n      Object.keys(\n        this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path as IctxShape[]\n      ).map((key) => {\n        const g = (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path as IctxShape[])[key];\n        if (g) {\n          const ii = key.split(' ')[1];\n          if (ii === 'M') {\n            ctx.moveTo(g[0], g[1]);\n          } else if (ii === 'C') {\n            ctx.bezierCurveTo(g[0], g[1], g[2], g[3], g[4], g[5]);\n          } else if (ii === 'L') {\n            // console.log(g[0], g[1]);\n            ctx.lineTo(g[0], g[1]);\n          }\n          // console.log(ii);\n        }\n        return 0;\n      });\n      if (isPin) {\n        // ctx.fillStyle = this.shape.RGB_by_A(this.shape.preset.regularPointColor, visibility);\n      } else {\n        ctx.fillStyle = rgbByA('#888888', visibility - 0.8);\n      }\n      ctx.closePath();\n      ctx.fill();\n      // ctx.stroke();\n      ctx.restore();\n    }\n  }\n  public pointNumberedOverBoundingByCircleSelected(ctx: CanvasRenderingContext2D, rs: RenderStyle, x: number, y: number, scale: number, easing = 1.0, isHover = true, needBoundRender = false, isGrayColor: boolean, visibility: number) {\n    const height = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.height;\n    let boundingOffset = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.pointBoundOffset;\n    if (isHover) {\n      boundingOffset *= easing;\n    } else {\n      boundingOffset -= boundingOffset * easing;\n    }\n\n    // ...................... bg bouncing\n    ctx.fillStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString;\n    if (needBoundRender) {\n      // let r = 2.3 * this.shape.draw.renderer.annotationInstance.customization.themeCurrent.nPoint.scale * boundingOffset;\n      // let r = 2.5 * boundingOffset;\n      // console.log(rs.lineWidth);\n      let r = height * scale * 0.5 + 0.75 * easing * this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale;\n      if (r < 0) {\n        r = 0;\n      }\n      ctx.beginPath();\n      ctx.arc(x, y - height * scale * 0.5, r, 0, 2 * Math.PI, false);\n      ctx.closePath();\n      ctx.fill();\n\n      ctx.strokeStyle = rs.colorFill;\n      ctx.lineWidth = 2.5;\n      ctx.beginPath();\n      ctx.arc(x, y - height * scale * 0.5, r + 1, 0, 2 * Math.PI, false);\n      ctx.closePath();\n      ctx.stroke();\n    }\n  }\n  public pointNumberedOverBoundingByCircle(ctx: CanvasRenderingContext2D, rs: RenderStyle, x: number, y: number, scale: number, easing = 1.0, isHover = true, needBoundRender = false, isGrayColor: boolean, visibility: number) {\n    const height = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.height;\n    let boundingOffset = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.pointBoundOffset;\n    if (isHover) {\n      boundingOffset *= easing;\n    } else {\n      boundingOffset -= boundingOffset * easing;\n    }\n\n    // ...................... bg bouncing\n    ctx.fillStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString;\n    if (needBoundRender) {\n      // let r = 2.3 * this.shape.draw.renderer.annotationInstance.customization.themeCurrent.nPoint.scale * boundingOffset;\n      // let r = 2.5 * boundingOffset;\n      // console.log(rs.lineWidth);\n      let r = height * scale * 0.5 + 0.75 * easing * this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale;\n      if (r < 0) {\n        r = 0;\n      }\n      // console.log(height)\n      ctx.beginPath();\n      ctx.arc(x, y - height * scale * 0.5, r, 0, 2 * Math.PI, false);\n      ctx.closePath();\n      ctx.fill();\n    }\n  }\n  public pointNumberedDragByCircle(ctx: CanvasRenderingContext2D, rs: RenderStyle, x: number, y: number, scale: number, easing = 1.0, isUp = true, needBoundRender = false, isGrayColor: boolean, visibility: number, isHover: boolean, isSelected: boolean) {\n\n    const height = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.height * scale;\n    const scaleFactor = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.scale;\n\n    if (!this.shape.draw.renderer.hasAni) {\n      isUp = false;\n      easing = 1;\n    }\n\n    // if (!this.shape.preset.pointNumberedImg) { return; }\n    let boundingOffset = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.pointBoundOffset;\n    if (isUp) {\n      boundingOffset *= easing;\n    } else {\n      boundingOffset -= boundingOffset * easing;\n    }\n\n    // // ..... for shadow\n    // ctx.fillStyle = ColorUtility.hex2CanvasColor(ColorHex.Black, 0.3);\n    // if (isUp) {\n    //     ctx.beginPath();\n    //     ctx.ellipse(x, y, 7, 2.5, 0, 0, 2 * Math.PI, false);\n    //     ctx.closePath();\n    //     ctx.fill();\n    // }\n\n    y -= boundingOffset * 1.8;\n    // ctx.lineWidth = rs.lineWidth; // this.shape.preset.regularPointColorStrokWidth;\n\n    // ...................... bg bouncing\n    ctx.strokeStyle = rs.colorStroke; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    ctx.fillStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString;\n    if (needBoundRender) {\n      let r = 3.5 * scaleFactor * boundingOffset;\n      if (r < 0) {\n        r = 0;\n      }\n      // let col = this.shape.preset.regularPointColorHover;\n      ctx.beginPath();\n      ctx.arc(x, y - height * 0.5, r, 0, 2 * Math.PI, false);\n      ctx.closePath();\n      ctx.fill();\n      // ctx.stroke();\n    }\n\n    // let col = this.shape.preset.PointNumberedColor;\n\n    // if (this.shape.draw.renderer.needFocus && !isHover ) {\n    //     ctx.fillStyle =  rs.colorFillHover; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${this.shape.opacityHover})`;\n    // } else {\n    //     ctx.fillStyle = rs.colorFill; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    // }\n    // if (isSelected) {\n    //     ctx.fillStyle = rs.colorFill; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    // }\n\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${this.shape.opacityHover})`;\n    } else {\n      ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    }\n    if (isSelected) {\n      ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    }\n\n    // let col = this.shape.preset.PointNumberedColor;\n    // ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    ctx.beginPath();\n    ctx.arc(x, y - height * 0.5, height * 0.5, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n\n    // const theFont = `${\n    //   this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.fontSize * scale\n    // }px ${this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.fontFamily}`;\n    // ctx.font = theFont; // '10px Arial';\n    // // if (this.shape.preset.regularPointColorHover === '#ffffff') { ctx.fillStyle = ColorHex.Black; } else { ctx.fillStyle = '#ffffff'; }\n    // const col = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint\n    //   .fontColorArray;\n    // if (isHover || isSelected) {\n    //   ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    // } else {\n    //   ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3] - 0.3})`;\n    // }\n    // ctx.textAlign = 'center'; // 'start', 'end', 'left', 'center', 'right';\n    // // if (this.shape.draw.renderer.annotationInstance.customization.themeCurrent.nPoint.numberedPointSVG) {\n    // ctx.fillText(index.toString(), x, y - height * 0.5 + 6);\n    // // }\n  }\n  public pointNumberedDragByCircleGhost(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    easing = 1.0,\n    isUp = true,\n    needBoundRender = false,\n    isGrayColor: boolean,\n    visibility: number,\n    index: number,\n    isHover: boolean,\n    isSelected: boolean\n  ) {\n    const height = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.height;\n\n    if (!this.shape.draw.renderer.hasAni) {\n      isUp = false;\n      easing = 1;\n    }\n\n    // if (!this.shape.preset.pointNumberedImg) { return; }\n    let boundingOffset = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties\n      .pointBoundOffset;\n    if (isUp) {\n      boundingOffset *= easing;\n    } else {\n      boundingOffset -= boundingOffset * easing;\n    }\n\n    // ..... for shadow\n    ctx.fillStyle = hex2CanvasColor(ColorHex.Black, 0.3);\n    if (isUp) {\n      ctx.beginPath();\n      ctx.ellipse(x, y, 7, 2.5, 0, 0, 2 * Math.PI, false);\n      ctx.closePath();\n      ctx.fill();\n    }\n\n    y -= boundingOffset * 1.8;\n    // ctx.lineWidth = rs.lineWidth; // this.shape.preset.regularPointColorStrokWidth;\n\n    // ...................... bg bouncing\n    ctx.strokeStyle = rs.colorStroke; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    ctx.fillStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString;\n    if (needBoundRender) {\n      let r =\n        2.5 *\n        this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.scale *\n        boundingOffset;\n      if (r < 0) {\n        r = 0;\n      }\n      // let col = this.shape.preset.regularPointColorHover;\n      ctx.beginPath();\n      ctx.arc(x, y - height * 0.5 + 2, r, 0, 2 * Math.PI, false);\n      ctx.closePath();\n      ctx.fill();\n      // ctx.stroke();\n    }\n\n    // let col = this.shape.preset.PointNumberedColor;\n\n    // if (this.shape.draw.renderer.needFocus && !isHover ) {\n    //     ctx.fillStyle =  rs.colorFillHover; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${this.shape.opacityHover})`;\n    // } else {\n    //     ctx.fillStyle = rs.colorFill; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    // }\n\n    // if (isSelected) {\n    //     ctx.fillStyle = rs.colorFill; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    // }\n\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${this.shape.opacityHover})`;\n    } else {\n      ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    }\n\n    if (isSelected) {\n      ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    }\n\n    // let col = this.shape.preset.PointNumberedColor;\n    // ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    ctx.beginPath();\n    ctx.arc(x, y - height * 0.5 + 2, height * 0.5, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n\n    const theFont = `${this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.fontSize}px ${this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.fontFamily}`;\n    ctx.font = theFont; // '10px Arial';\n    // if (this.shape.preset.regularPointColorHover === '#ffffff') { ctx.fillStyle = ColorHex.Black; } else { ctx.fillStyle = '#ffffff'; }\n    const col = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint\n      .fontColorArray;\n    if (isHover || isSelected) {\n      ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    } else {\n      ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3] - 0.3})`;\n    }\n    ctx.textAlign = 'center'; // 'start', 'end', 'left', 'center', 'right';\n    // if (this.shape.draw.renderer.annotationInstance.customization.themeCurrent.nPoint.numberedPointSVG) {\n    ctx.fillText(index.toString(), x, y - height * 0.5 + 6);\n    // }\n  }\n  // ............................................... point icon\n  public pointIcon(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    theWidth: number,\n    theHeight: number,\n    img: HTMLImageElement,\n    over: boolean,\n    isGrayColor: boolean,\n    visibility: number,\n    bg = false,\n    easing = 1.0\n  ) {\n    ctx.globalAlpha = visibility;\n    ctx.fillStyle = rs.colorFill;\n\n    // let style = CGeometryRender.themeDrawing.pointIcon.normal;\n    const scale = 0.5;\n    const easingScale = easing * 10;\n\n    const width = theWidth * scale + easingScale;\n    const height = theHeight * scale + easingScale;\n    const xOffset = width * 0.5;\n    const yOffset = height * 0.5;\n\n    ctx.drawImage(img, x - xOffset, y - yOffset, width, height);\n  }\n  // PointIconStart(ctx: CanvasRenderingContext2D, rs: RenderStyle, x: number, y: number, img: HTMLImageElement, sc: number, isGrayColor: boolean, visibility: number, bg: boolean = false) {\n  //     ctx.save();\n  //     ctx.globalAlpha = visibility;\n  //     let style = CGeometryRender.themeDrawing.pointIcon.normal;\n  //     let scale = Math.abs(0.4 * sc);\n\n  //     let width = img.width * scale;\n  //     let height = img.height * scale;\n  //     let xOffset = width * 0.5;\n  //     let yOffset = height * 0.5;\n\n  //     let recOffset = 3;\n  //     if (bg) {\n  //         CDrawingPreset.RoundedRectSolidForPointIcon(\n  //             ctx, x - xOffset - (recOffset * 0.5),\n  //             y - yOffset - (recOffset * 0.5),\n  //             width + (recOffset * 0.5) + 2, height + (recOffset * 0.5) + 2,\n  //             ColorUtility.hex2CanvasColor(style.strokeColor, visibility, isGrayColor),\n  //             ColorUtility.hex2CanvasColor(style.fillColor, visibility, isGrayColor),\n  //             style.strokeSize, 3\n  //         );\n  //     } else {\n  //         CDrawingPreset.RoundedRectPNGPointIcon(\n  //             ctx, x - xOffset - (recOffset * 0.5),\n  //             y - yOffset - (recOffset * 0.5),\n  //             width + (recOffset * 0.5) + 2, height + (recOffset * 0.5) + 2,\n  //             ColorUtility.hex2CanvasColor(style.strokeColor, visibility, isGrayColor),\n  //             ColorUtility.hex2CanvasColor(style.fillColor, visibility, isGrayColor),\n  //             style.strokeSize, 3\n  //         );\n  //     }\n  //     ctx.drawImage(img, x - xOffset, y - yOffset, width, height);\n  //     ctx.restore();\n  //     // if (over) CBoundingBox.RenderBoundingBoxForTwoVecs(ctx, new NVector3(x - xOffset, y - yOffset), new NVector3(x + xOffset, y + yOffset), 10);\n  // }\n  public centerPoint(ctx: CanvasRenderingContext2D, x: number, y: number) {\n    ctx.beginPath();\n    ctx.arc(x, y, 1, 0, 2 * Math.PI, false);\n    ctx.closePath();\n    ctx.fillStyle = 'black';\n    ctx.fill();\n  }\n  public centerPointCircle(ctx: CanvasRenderingContext2D, x: number, y: number) {\n    ctx.lineWidth = 1;\n    ctx.strokeStyle = '#001c1b';\n    ctx.beginPath();\n    ctx.moveTo(x, y - 4.5);\n    ctx.lineTo(x, y + 4.5);\n    ctx.moveTo(x - 4.5, y);\n    ctx.lineTo(x + 4.5, y);\n    ctx.stroke();\n  }\n  private pointRagularSVGRenderEdgeSupport(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    isHover: boolean,\n    isSelected: boolean,\n    hasStroke = false\n  ) {\n    ctx.save();\n    ctx.translate(x, y);\n    // let col = this.shape.preset.polylineColor;\n\n    // if (this.shape.draw.renderer.needFocus && !isHover ) {\n    //     ctx.fillStyle = rs.colorFillHover; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${0.5})`;\n    // } else {\n    //     ctx.fillStyle = rs.colorFill; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    // }\n    // if (isSelected) { ctx.fillStyle = rs.colorFill; }\n\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${0.5})`;\n    } else {\n      ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    }\n    if (isSelected) {\n      ctx.fillStyle = rs.colorInterpolatedString;\n    }\n\n    ctx.strokeStyle = rs.colorStroke; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    // col = rs.colorStroke; // this.shape.preset.regularPointColorStrok;\n    ctx.lineWidth = 0;\n\n    if (\n      this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG &&\n      this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path\n    ) {\n      const ctxShape = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG\n        .path;\n      ctx.beginPath();\n      Object.keys(ctxShape).map((key) => {\n        const g = ctxShape[key];\n        if (g) {\n          const ii = key.split(' ')[1];\n          if (ii === 'M') {\n            ctx.moveTo(g[0], g[1]);\n          } else if (ii === 'C') {\n            ctx.bezierCurveTo(g[0], g[1], g[2], g[3], g[4], g[5]);\n          } else if (ii === 'L') {\n            // console.log(g[0], g[1]);\n            ctx.lineTo(g[0], g[1]);\n          }\n          // console.log(ii);\n        }\n        return 0\n      });\n      ctx.closePath();\n      ctx.fill();\n    }\n    ctx.restore();\n  }\n  private pointRegularOverBoundingBySVGPathEdgeSupport(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number\n  ) {\n    ctx.save();\n    ctx.translate(x, y);\n    ctx.strokeStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    const ctxShape = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path as IctxShape[];\n    ctx.beginPath();\n    Object.keys(ctxShape).map((key: any) => {\n      const g = ctxShape[key];\n      if (g) {\n        const ii = key.split(' ')[1];\n        if (ii === 'M') {\n          ctx.moveTo(g[0], g[1]);\n        } else if (ii === 'C') {\n          ctx.bezierCurveTo(g[0], g[1], g[2], g[3], g[4], g[5]);\n        } else if (ii === 'L') {\n          ctx.lineTo(g[0], g[1]);\n        }\n      }\n      return 0\n    });\n    ctx.closePath();\n    ctx.stroke();\n    ctx.restore();\n  }\n  public shadowRPoint(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    isSelected: boolean,\n    isHover: boolean\n  ) {\n    if (\n      this.shape.draw.renderer.imageAnnoApp.implementations.app.model.appCoreWrapper.browserUtility\n        .type === BrowserType.Safari ||\n      this.shape.draw.renderer.imageAnnoApp.implementations.app.model.appCoreWrapper.browserUtility\n        .type === BrowserType.Edge\n    ) {\n      return;\n    }\n    ctx.beginPath();\n    ctx.ellipse(x, y + 5, 10, 2.5, 0, 0, 2 * Math.PI, false);\n    ctx.closePath();\n    if (isSelected || isHover) {\n      ctx.fillStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.shadowColorHover;\n    } else {\n      ctx.fillStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.shadowColor;\n    }\n    ctx.filter = `blur(${this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.shadowBlur}px)`;\n    ctx.fill();\n    ctx.filter = 'none';\n  }\n  public shadowRPointLight(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    scale: number,\n    isSelected: boolean,\n    isHover: boolean\n  ) {\n    if (\n      this.shape.draw.renderer.imageAnnoApp.implementations.app.model.appCoreWrapper.browserUtility\n        .type === BrowserType.Safari ||\n      this.shape.draw.renderer.imageAnnoApp.implementations.app.model.appCoreWrapper.browserUtility\n        .type === BrowserType.Edge\n    ) {\n      return;\n    }\n    ctx.beginPath();\n    ctx.ellipse(x, y + 5, 10, 2.5, 0, 0, 2 * Math.PI, false);\n    ctx.closePath();\n    // if (isSelected || isHover) {\n    //     ctx.fillStyle = this.shape.draw.renderer.annotationInstance.customization.themeCurrent.rPoint.shadowColorHover;\n    // } else {\n    ctx.fillStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.shadowColor;\n    // }\n    ctx.filter = `blur(${this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.shadowBlur}px)`;\n    ctx.fill();\n    ctx.filter = 'none';\n  }\n  public shadowNPoint(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    scale: number,\n    isSelected: boolean,\n    isHover: boolean\n  ) {\n    if (\n      this.shape.draw.renderer.imageAnnoApp.implementations.app.model.appCoreWrapper.browserUtility\n        .type === BrowserType.Safari ||\n      this.shape.draw.renderer.imageAnnoApp.implementations.app.model.appCoreWrapper.browserUtility\n        .type === BrowserType.Edge\n    ) {\n      return;\n    }\n    ctx.beginPath();\n    ctx.ellipse(x, y + 5, 10 * scale, 2.5, 0, 0, 2 * Math.PI, false);\n    ctx.closePath();\n    if (isSelected || isHover) {\n      ctx.fillStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.shadowColorHover;\n    } else {\n      ctx.fillStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.shadowColor;\n    }\n    ctx.filter = `blur(${this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.shadowBlur}px)`;\n    ctx.fill();\n    ctx.filter = 'none';\n  }\n  public shadowNPointLight(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    scale: number,\n    isSelected: boolean,\n    isHover: boolean\n  ) {\n    if (\n      this.shape.draw.renderer.imageAnnoApp.implementations.app.model.appCoreWrapper.browserUtility\n        .type === BrowserType.Safari ||\n      this.shape.draw.renderer.imageAnnoApp.implementations.app.model.appCoreWrapper.browserUtility\n        .type === BrowserType.Edge\n    ) {\n      return;\n    }\n    ctx.beginPath();\n    ctx.ellipse(x, y + 5, 10 * scale, 2.5, 0, 0, 2 * Math.PI, false);\n    ctx.closePath();\n    // if (isSelected || isHover) {\n    //     ctx.fillStyle = this.shape.draw.renderer.annotationInstance.customization.themeCurrent.nPoint.shadowColorHover;\n    // } else {\n    ctx.fillStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.shadowColor;\n    // }\n    ctx.filter = `blur(${this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.shadowBlur}px)`;\n    ctx.fill();\n    ctx.filter = 'none';\n  }\n}\n","import {\n  BrowserType,\n  ColorHex,\n  Size,\n  PointRenderType,\n} from '../../../../../../lib';\nimport { RenderStyle } from '../../../../Geometry/GeometryAnnotation/Helper/RenderStyle';\nimport { ShapePreset } from '..';\nexport class DrawingPresetPointGeneric {\n  public shape: ShapePreset;\n  // private index: number = 0;\n  constructor(shape: ShapePreset) {\n    this.shape = shape;\n  }\n  public pointGenericDrag(ctx: CanvasRenderingContext2D, pointRenderType: PointRenderType, rs: RenderStyle, x: number, y: number, scale: number, easing = 1.0, isUp = true, needBoundRender = false, isGrayColor: boolean, visibility: number, isPin: boolean, isHover: boolean, isSelected: boolean) {\n    let boundingOffset = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.pointBoundOffset;\n\n    // console.log(this.shape.draw.renderer.hasAni, easing);\n    if (!this.shape.draw.renderer.hasAni) {\n      isUp = false;\n      easing = 1;\n    }\n\n    if (isUp) {\n      boundingOffset *= easing;\n    } else {\n      boundingOffset -= boundingOffset * easing;\n    }\n    y -= boundingOffset * 1.8;\n    if (needBoundRender) {\n      let r = 2.5 * boundingOffset;\n      if (r < 0) {\n        r = 0;\n      }\n    }\n\n    if (this.shape.draw.renderer.imageAnnoApp.implementations.app.model.appCoreWrapper.browserUtility.type === BrowserType.Edge) {\n      this.pointRegularSVGRenderEdgeSupport(ctx, pointRenderType, rs, x - rs.width * 0.25 * scale, y - rs.height + 0, isHover, isSelected);\n      return;\n    }\n\n    if (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n      this.pointRegularSVGRender(ctx, pointRenderType, rs, x, y, scale, isHover, isSelected);\n    }\n  }\n  private pointRegularSVGRender(ctx: CanvasRenderingContext2D, pointRenderType: PointRenderType, rs: RenderStyle, x: number, y: number, scale: number, isHover: boolean, isSelected: boolean, hasStroke = false) {\n    const OffsetX = rs.width;\n    const OffsetY = rs.height;\n    const widthHalf = OffsetX * 0.25 * scale;\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${0.5})`;\n    } else {\n      ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    }\n    if (isSelected) {\n      ctx.fillStyle = rs.colorInterpolatedString;\n    }\n    ctx.save();\n    ctx.translate(x - widthHalf, y - OffsetY * scale);\n    ctx.scale(scale, scale);\n\n    ctx.strokeStyle = rs.colorStroke; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n\n    switch (pointRenderType) {\n      case PointRenderType.RpointA:\n        ctx.fill(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path2D, 'evenodd');\n        ctx.lineWidth = 0;\n        if (hasStroke) {\n          ctx.stroke(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path2D);\n        }\n        break;\n      case PointRenderType.Image:\n        // console.log('r rendering', rs.url  );\n        // console.log(this.GetIconByURL(rs.url));\n        if (this.getIconByURL(rs.url)) {\n          this.pointIcon(\n            ctx,\n            rs,\n            0,\n            0,\n            32,\n            32,\n            this.getIconByURL(rs.url),\n            false,\n            false,\n            1,\n            isHover,\n            isSelected\n          );\n        }\n        break;\n      default:\n        break;\n    }\n    ctx.restore();\n  }\n  public pointIcon(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    theWidth: number,\n    theHeight: number,\n    img: HTMLImageElement,\n    over: boolean,\n    isGrayColor: boolean,\n    visibility: number,\n    isHover = false,\n    isSelected = false,\n    bg = false,\n    easing = 1.0\n  ) {\n    ctx.globalAlpha = visibility;\n    ctx.fillStyle = rs.colorFill;\n\n    if (!isHover && !isSelected) {\n      ctx.globalAlpha = rs.interpolationNum;\n    }\n    ctx.drawImage(img, x, y, theWidth, theHeight);\n    ctx.globalAlpha = 1.0;\n  }\n  public pointIconHover(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    theWidth: number,\n    theHeight: number,\n    img: HTMLImageElement,\n    over: boolean,\n    isGrayColor: boolean,\n    visibility: number,\n    bg = false,\n    easing = 1.0\n  ) {\n    // console.log('r rendering Over Bounding');\n    // ctx.globalAlpha = visibility;\n    // ctx.fillStyle = rs.colorFill;\n\n    // ctx.drawImage(img, x, y, theWidth, theHeight);\n    ctx.lineWidth = 0.75;\n    ctx.beginPath();\n    ctx.rect(x - 1, y - 1, theWidth + 2, theHeight + 2);\n    ctx.closePath();\n    ctx.strokeStyle = ColorHex.Black;\n    ctx.stroke();\n\n    ctx.beginPath();\n    ctx.rect(x, y, theWidth, theHeight);\n    ctx.closePath();\n    ctx.strokeStyle = ColorHex.White;\n    ctx.stroke();\n    // ctx.fillStyle = rs.colorFill;\n    // ctx.fill()\n\n    /*\n    if(rs.size === SIZE.SMALL) {\n      ctx.lineWidth = 0.75;\n      ctx.beginPath();\n      ctx.rect(x - 5, y - 12, theWidth + 10, theHeight + 12); // offset 2 pixel\n      ctx.closePath();\n      // ctx.fillStyle = rs.colorFill;\n      ctx.strokeStyle = ColorHex.Black;\n      ctx.stroke();\n\n      ctx.beginPath();\n      ctx.rect(x - 4, y - 11, theWidth + 8, theHeight + 10); // offset 1 pixel\n      ctx.closePath();\n      ctx.strokeStyle = ColorHex.White;\n      ctx.stroke();\n\n    } else {\n      ctx.lineWidth = 0.5;\n      ctx.beginPath();\n      ctx.rect(x - 3, y - 7, theWidth + 6, theHeight + 8); // offset 2 pixel\n      ctx.closePath();\n      // ctx.fillStyle = rs.colorFill;\n      ctx.strokeStyle = ColorHex.Black;\n      ctx.stroke();\n\n      ctx.beginPath();\n      ctx.rect(x - 2, y - 6, theWidth + 4, theHeight + 6); // offset 1 pixel\n      ctx.closePath();\n      ctx.strokeStyle = ColorHex.White;\n      ctx.stroke();\n    }\n    */\n  }\n  public pointIconSelected(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    theWidth: number,\n    theHeight: number,\n    img: HTMLImageElement,\n    over: boolean,\n    isGrayColor: boolean,\n    visibility: number,\n    bg = false,\n    easing = 1.0\n  ) {\n    // console.log('r rendering selected');\n    // ctx.globalAlpha = visibility;\n    // ctx.fillStyle = rs.colorFill;\n    if (rs.size === Size.SMALL) {\n      ctx.lineWidth = 0.75;\n      ctx.beginPath();\n      ctx.rect(x - 5, y - 12, theWidth + 10, theHeight + 12); // offset 2 pixel\n      ctx.closePath();\n      // ctx.fillStyle = rs.colorFill;\n      ctx.strokeStyle = ColorHex.Black;\n      ctx.stroke();\n\n      ctx.beginPath();\n      ctx.rect(x - 4, y - 11, theWidth + 8, theHeight + 10); // offset 1 pixel\n      ctx.closePath();\n      ctx.strokeStyle = ColorHex.White;\n      ctx.stroke();\n    } else {\n      ctx.lineWidth = 0.5;\n      ctx.beginPath();\n      ctx.rect(x - 3, y - 7, theWidth + 6, theHeight + 8); // offset 2 pixel\n      ctx.closePath();\n      // ctx.fillStyle = rs.colorFill;\n      ctx.strokeStyle = ColorHex.Black;\n      ctx.stroke();\n\n      ctx.beginPath();\n      ctx.rect(x - 2, y - 6, theWidth + 4, theHeight + 6); // offset 1 pixel\n      ctx.closePath();\n      ctx.strokeStyle = ColorHex.White;\n      ctx.stroke();\n    }\n    // ctx.drawImage(img, x, y, theWidth, theHeight);\n  }\n  public pointGenericOverBoundingSelected(ctx: CanvasRenderingContext2D, pointRenderType: PointRenderType, rs: RenderStyle, x: number, y: number, scale: number, easing = 1.0, isHover = true, needBoundRender = false, isGrayColor: boolean, visibility: number, isPin: boolean) {\n    let boundingOffset = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.pointBoundOffset;\n\n    // const OffsetX = rs.width;\n    const OffsetY = rs.height;\n    // const widthHalf = OffsetX * 0.5 * scale;\n\n    if (!this.shape.draw.renderer.hasAni) {\n      isHover = false;\n    } // this is for controlling animation effect\n\n    if (isHover) {\n      boundingOffset *= easing;\n    } else {\n      boundingOffset -= boundingOffset * easing;\n    }\n    if (needBoundRender) {\n      ctx.lineWidth = 0.5 + easing *\n          rs.lineWidth  * // rs.scaleGlobal * rs.scaleLocal *\n          this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale;\n      // ctx.lineWidth *= 0.5;\n      // console.log(easing , rs.lineWidth);\n      const xPos = x - rs.width * 0.25 * scale;\n      const yPos = y - rs.height * scale;\n      if (this.shape.draw.renderer.imageAnnoApp.implementations.app.model.appCoreWrapper.browserUtility.type === BrowserType.Edge) {\n        this.pointRegularOverBoundingBySVGPathEdgeSupport(ctx, rs, xPos, yPos);\n        return;\n      }\n\n      // ..................... outer stroke end\n      ctx.save();\n      ctx.translate(xPos, y - OffsetY * scale);\n      ctx.scale(scale, scale);\n      // ctx.lineWidth = 7;\n      // ctx.strokeStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n      // if (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n      //   switch (pointRenderType) {\n      //     case PointRenderType.RpointA:\n      //       ctx.stroke(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path2D);\n      //       break;\n      //     case PointRenderType.Image:\n      //       this.pointIconSelected(ctx, rs, 0, 0, 32, 32, this.getIconByURL(rs.url), false, false, 1);\n      //       break;\n      //     default:\n      //       break;\n      //   }\n      // }\n      ctx.lineWidth = 5;\n      ctx.strokeStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n      if (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n        switch (pointRenderType) {\n          case PointRenderType.RpointA:\n            ctx.stroke(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path2D);\n            break;\n          case PointRenderType.Image:\n            this.pointIconSelected(ctx, rs, xPos, yPos, 32, 32, this.getIconByURL(rs.url), false, false, 1);\n            break;\n          default:\n            break;\n        }\n      }\n      ctx.restore();\n    }\n  }\n\n  public pointGenericOverBounding(\n    ctx: CanvasRenderingContext2D,\n    pointRenderType: PointRenderType,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    scale: number,\n    easing = 1.0,\n    isHover = true,\n    needBoundRender = false,\n    isGrayColor: boolean,\n    visibility: number,\n    isPin: boolean\n  ) {\n    let boundingOffset = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties\n      .pointBoundOffset;\n    if (!this.shape.draw.renderer.hasAni) {\n      isHover = false;\n    } // this is for controlling animation effect\n\n    if (isHover) {\n      boundingOffset *= easing;\n    } else {\n      boundingOffset -= boundingOffset * easing;\n    }\n    if (needBoundRender) {\n      ctx.lineWidth =\n        0.5 +\n        easing *\n          rs.lineWidth * // rs.scaleGlobal * rs.scaleLocal *\n          this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale *\n          2;\n      // ctx.lineWidth *= 0.5;\n      // console.log(easing , rs.lineWidth);\n      // console.log(rs.width);\n      const xPos = x - rs.width * 0.25 * scale;\n      const yPos = y - rs.height + 0;\n      if (\n        this.shape.draw.renderer.imageAnnoApp.implementations.app.model.appCoreWrapper\n          .browserUtility.type === BrowserType.Edge\n      ) {\n        this.pointRegularOverBoundingBySVGPathEdgeSupport(ctx, rs, xPos, yPos);\n        return;\n      }\n      // ctx.save();\n      // ctx.translate(xPos, yPos);\n      const OffsetX = rs.width;\n      const OffsetY = rs.height;\n      const widthHalf = OffsetX * 0.25 * scale;\n\n      ctx.save();\n      ctx.translate(x - widthHalf, y - OffsetY * scale);\n      ctx.scale(scale, scale);\n\n      // let col = rs.colorFillHover; // this.shape.preset.regularPointColorHover;\n      ctx.strokeStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n\n      switch (pointRenderType) {\n        case PointRenderType.RpointA:\n          if (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n            ctx.stroke(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path2D);\n          }\n          break;\n        case PointRenderType.Image:\n          this.pointIconHover(ctx, rs, 0, 0, 32, 32, this.getIconByURL(rs.url), false, false, 1);\n          break;\n        default:\n          break;\n      }\n      ctx.restore();\n    }\n  }\n  // ..................................................................................................................\n  // ............................................... point icon\n  private pointRegularSVGRenderEdgeSupport(\n    ctx: CanvasRenderingContext2D,\n    pointRenderType: PointRenderType,\n    rs: RenderStyle,\n    x: number,\n    y: number,\n    isHover: boolean,\n    isSelected: boolean,\n    hasStroke = false\n  ) {\n    ctx.save();\n    ctx.translate(x, y);\n    // let col = this.shape.preset.polylineColor;\n\n    // if (this.shape.draw.renderer.needFocus && !isHover ) {\n    //     ctx.fillStyle = rs.colorFillHover; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${0.5})`;\n    // } else {\n    //     ctx.fillStyle = rs.colorFill; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    // }\n    // if (isSelected) { ctx.fillStyle = rs.colorFill; }\n\n    if (this.shape.draw.renderer.needFocus && !isHover) {\n      ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${0.5})`;\n    } else {\n      ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    }\n    if (isSelected) {\n      ctx.fillStyle = rs.colorInterpolatedString;\n    }\n\n    ctx.strokeStyle = rs.colorStroke; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    // col = rs.colorStroke; // this.shape.preset.regularPointColorStrok;\n    ctx.lineWidth = 0;\n\n    switch (pointRenderType) {\n      case PointRenderType.RpointA:\n        if (\n          this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG &&\n          this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path\n        ) {\n          const ctxShape = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint\n            .SVG.path;\n          ctx.beginPath();\n          Object.keys(ctxShape).map((key) => {\n            const g = ctxShape[key];\n            if (g) {\n              const ii = key.split(' ')[1];\n              if (ii === 'M') {\n                ctx.moveTo(g[0], g[1]);\n              } else if (ii === 'C') {\n                ctx.bezierCurveTo(g[0], g[1], g[2], g[3], g[4], g[5]);\n              } else if (ii === 'L') {\n                // console.log(g[0], g[1]);\n                ctx.lineTo(g[0], g[1]);\n              }\n              // console.log(ii);\n            }\n            return 0;\n          });\n          ctx.closePath();\n          ctx.fill();\n        }\n        break;\n      case PointRenderType.Image:\n        // console.log('r rendering');\n        break;\n      default:\n        break;\n    }\n\n    ctx.restore();\n  }\n  private pointRegularOverBoundingBySVGPathEdgeSupport(\n    ctx: CanvasRenderingContext2D,\n    rs: RenderStyle,\n    x: number,\n    y: number\n  ) {\n    ctx.save();\n    ctx.translate(x, y);\n    ctx.strokeStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    const ctxShape = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG\n      .path;\n    ctx.beginPath();\n    Object.keys(ctxShape).map((key) => {\n      const g = ctxShape[key];\n      if (g) {\n        const ii = key.split(' ')[1];\n        if (ii === 'M') {\n          ctx.moveTo(g[0], g[1]);\n        } else if (ii === 'C') {\n          ctx.bezierCurveTo(g[0], g[1], g[2], g[3], g[4], g[5]);\n        } else if (ii === 'L') {\n          ctx.lineTo(g[0], g[1]);\n        }\n      }\n      return 0;\n    });\n    ctx.closePath();\n    ctx.stroke();\n    ctx.restore();\n  }\n  private getIconByURL(url: string) {\n    return this.shape.draw.renderer.imageAnnoApp.customization.iconAsset.getIconByURL(url);\n  }\n}\n","import {\n    ColorHex,\n    Size,\n    PointRenderType,\n  } from '../../../../../../lib';\n  import { RenderStyle } from '../../../../Geometry/GeometryAnnotation/Helper/RenderStyle';\n  import { ShapePreset } from '..';\n  export class DrawingPresetPointSVG {\n    public shape: ShapePreset;\n    // private index: number = 0;\n    constructor(shape: ShapePreset) {\n      this.shape = shape;\n    }\n    public pointSVGNormalFill(ctx: CanvasRenderingContext2D, pathSVG: Path2D, rs: RenderStyle, x: number, y: number, scale: number, easing = 1.0, isUp = true, needBoundRender = false, isGrayColor: boolean, visibility: number, isPin: boolean, isHover: boolean, isSelected: boolean, hasStroke: boolean = false) {\n      // let boundingOffset = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.pointBoundOffset;\n\n      // // console.log(this.shape.draw.renderer.hasAni, easing);\n      // if (!this.shape.draw.renderer.hasAni) {\n      //   isUp = false;\n      //   easing = 1;\n      // }\n\n      // if (isUp) {\n      //   boundingOffset *= easing;\n      // } else {\n      //   boundingOffset -= boundingOffset * easing;\n      // }\n      // y -= boundingOffset * 1.8;\n      // if (needBoundRender) {\n      //   let r = 2.5 * boundingOffset;\n      //   if (r < 0) {\n      //     r = 0;\n      //   }\n      // }\n\n      this.pointSVGRender(ctx, pathSVG, rs, x, y, scale, isHover, isSelected, hasStroke);\n    }\n    private pointSVGRender(ctx: CanvasRenderingContext2D, pathSVG: Path2D, rs: RenderStyle, x: number, y: number, scale: number, isHover: boolean, isSelected: boolean, hasStroke = false, boundingOffset = 1) {\n      const OffsetX = rs.width;\n      const OffsetY = rs.height;\n\n      const widthHalf = OffsetX * 0.365 * scale;\n      if (this.shape.draw.renderer.needFocus && !isHover) {\n        ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${0.5})`;\n      } else {\n        ctx.fillStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n      }\n      if (isSelected) {\n        ctx.fillStyle = rs.colorInterpolatedString;\n      }\n\n\n      ctx.save();\n      ctx.translate(\n        x - widthHalf,\n        y - OffsetY * scale\n      );\n      ctx.scale(scale, scale);\n\n      ctx.strokeStyle = rs.colorStroke; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n\n\n      if (hasStroke) {\n        ctx.lineWidth = 4 * boundingOffset;\n        ctx.strokeStyle = '#ffffff';\n        ctx.stroke(pathSVG);\n      }\n\n      ctx.fill(pathSVG, 'evenodd');\n      ctx.restore();\n\n      // debug\n      // ctx.lineWidth = 1;\n      // ctx.beginPath();\n      // ctx.rect(x - OffsetX * 0.5, y - OffsetY, rs.width, rs.height);\n      // ctx.closePath();\n      // ctx.stroke();\n    }\n    public pointIcon(\n      ctx: CanvasRenderingContext2D,\n      rs: RenderStyle,\n      x: number,\n      y: number,\n      theWidth: number,\n      theHeight: number,\n      img: HTMLImageElement,\n      over: boolean,\n      isGrayColor: boolean,\n      visibility: number,\n      isHover = false,\n      isSelected = false,\n      bg = false,\n      easing = 1.0\n    ) {\n      ctx.globalAlpha = visibility;\n      ctx.fillStyle = rs.colorFill;\n\n      if (!isHover && !isSelected) {\n        ctx.globalAlpha = rs.interpolationNum;\n      }\n      ctx.drawImage(img, x, y, theWidth, theHeight);\n      ctx.globalAlpha = 1.0;\n    }\n    public pointIconHover(\n      ctx: CanvasRenderingContext2D,\n      rs: RenderStyle,\n      x: number,\n      y: number,\n      theWidth: number,\n      theHeight: number,\n      img: HTMLImageElement,\n      over: boolean,\n      isGrayColor: boolean,\n      visibility: number,\n      bg = false,\n      easing = 1.0\n    ) {\n      // console.log('r rendering Over Bounding');\n      // ctx.globalAlpha = visibility;\n      // ctx.fillStyle = rs.colorFill;\n\n      // ctx.drawImage(img, x, y, theWidth, theHeight);\n      ctx.lineWidth = 0.75;\n      ctx.beginPath();\n      ctx.rect(x - 1, y - 1, theWidth + 2, theHeight + 2);\n      ctx.closePath();\n      ctx.strokeStyle = ColorHex.Black;\n      ctx.stroke();\n\n      ctx.beginPath();\n      ctx.rect(x, y, theWidth, theHeight);\n      ctx.closePath();\n      ctx.strokeStyle = ColorHex.White;\n      ctx.stroke();\n      // ctx.fillStyle = rs.colorFill;\n      // ctx.fill()\n\n      /*\n      if(rs.size === SIZE.SMALL) {\n        ctx.lineWidth = 0.75;\n        ctx.beginPath();\n        ctx.rect(x - 5, y - 12, theWidth + 10, theHeight + 12); // offset 2 pixel\n        ctx.closePath();\n        // ctx.fillStyle = rs.colorFill;\n        ctx.strokeStyle = ColorHex.Black;\n        ctx.stroke();\n\n        ctx.beginPath();\n        ctx.rect(x - 4, y - 11, theWidth + 8, theHeight + 10); // offset 1 pixel\n        ctx.closePath();\n        ctx.strokeStyle = ColorHex.White;\n        ctx.stroke();\n\n      } else {\n        ctx.lineWidth = 0.5;\n        ctx.beginPath();\n        ctx.rect(x - 3, y - 7, theWidth + 6, theHeight + 8); // offset 2 pixel\n        ctx.closePath();\n        // ctx.fillStyle = rs.colorFill;\n        ctx.strokeStyle = ColorHex.Black;\n        ctx.stroke();\n\n        ctx.beginPath();\n        ctx.rect(x - 2, y - 6, theWidth + 4, theHeight + 6); // offset 1 pixel\n        ctx.closePath();\n        ctx.strokeStyle = ColorHex.White;\n        ctx.stroke();\n      }\n      */\n    }\n    public pointIconSelected(\n      ctx: CanvasRenderingContext2D,\n      rs: RenderStyle,\n      x: number,\n      y: number,\n      theWidth: number,\n      theHeight: number,\n      img: HTMLImageElement,\n      over: boolean,\n      isGrayColor: boolean,\n      visibility: number,\n      bg = false,\n      easing = 1.0\n    ) {\n      // console.log('r rendering selected');\n      // ctx.globalAlpha = visibility;\n      // ctx.fillStyle = rs.colorFill;\n      if (rs.size === Size.SMALL) {\n        ctx.lineWidth = 0.75;\n        ctx.beginPath();\n        ctx.rect(x - 5, y - 12, theWidth + 10, theHeight + 12); // offset 2 pixel\n        ctx.closePath();\n        // ctx.fillStyle = rs.colorFill;\n        ctx.strokeStyle = ColorHex.Black;\n        ctx.stroke();\n\n        ctx.beginPath();\n        ctx.rect(x - 4, y - 11, theWidth + 8, theHeight + 10); // offset 1 pixel\n        ctx.closePath();\n        ctx.strokeStyle = ColorHex.White;\n        ctx.stroke();\n      } else {\n        ctx.lineWidth = 0.5;\n        ctx.beginPath();\n        ctx.rect(x - 3, y - 7, theWidth + 6, theHeight + 8); // offset 2 pixel\n        ctx.closePath();\n        // ctx.fillStyle = rs.colorFill;\n        ctx.strokeStyle = ColorHex.Black;\n        ctx.stroke();\n\n        ctx.beginPath();\n        ctx.rect(x - 2, y - 6, theWidth + 4, theHeight + 6); // offset 1 pixel\n        ctx.closePath();\n        ctx.strokeStyle = ColorHex.White;\n        ctx.stroke();\n      }\n      // ctx.drawImage(img, x, y, theWidth, theHeight);\n    }\n    public pointGenericOverBoundingSelected(\n      ctx: CanvasRenderingContext2D,\n      pointRenderType: PointRenderType,\n      rs: RenderStyle,\n      x: number,\n      y: number,\n      scale: number,\n      easing = 1.0,\n      isHover = true,\n      needBoundRender = false,\n      isGrayColor: boolean,\n      visibility: number,\n      isPin: boolean\n    ) {\n      let boundingOffset = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties\n        .pointBoundOffset;\n\n      const OffsetX = rs.width;\n      const OffsetY = rs.height;\n      const widthHalf = OffsetX * 0.5 * scale;\n\n      if (!this.shape.draw.renderer.hasAni) {\n        isHover = false;\n      } // this is for controlling animation effect\n\n      if (isHover) {\n        boundingOffset *= easing;\n      } else {\n        boundingOffset -= boundingOffset * easing;\n      }\n      if (needBoundRender) {\n        ctx.lineWidth =\n          0.5 +\n          easing *\n            rs.lineWidth * rs.scaleGlobal * rs.scaleLocal *\n            this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale;\n        // ctx.lineWidth *= 0.5;\n        // console.log(easing , rs.lineWidth);\n        // const xPos = x - rs.width * 0.5 * scale;\n        // const yPos = y - rs.height * scale;\n\n        // ..................... outer stroke end\n        ctx.save();\n        ctx.translate(x - widthHalf, y - OffsetY * scale);\n        ctx.scale(scale, scale);\n        ctx.lineWidth = 7;\n        ctx.strokeStyle = rs.colorInterpolatedString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n        if (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n          switch (pointRenderType) {\n            case PointRenderType.RpointA:\n              ctx.stroke(\n                this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path2D\n              );\n              break;\n            case PointRenderType.Image:\n              this.pointIconSelected(\n                ctx,\n                rs,\n                0,\n                0,\n                32,\n                32,\n                this.getIconByURL(rs.url),\n                false,\n                false,\n                1\n              );\n              break;\n            default:\n              break;\n          }\n        }\n        ctx.lineWidth = 3;\n        ctx.strokeStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n        if (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n          switch (pointRenderType) {\n            case PointRenderType.RpointA:\n              ctx.stroke(\n                this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path2D\n              );\n              break;\n            case PointRenderType.Image:\n              this.pointIconSelected(\n                ctx,\n                rs,\n                0,\n                0,\n                32,\n                32,\n                this.getIconByURL(rs.url),\n                false,\n                false,\n                1\n              );\n              break;\n            default:\n              break;\n          }\n        }\n        ctx.restore();\n      }\n    }\n\n    public pointGenericOverBounding(\n      ctx: CanvasRenderingContext2D,\n      pointRenderType: PointRenderType,\n      rs: RenderStyle,\n      x: number,\n      y: number,\n      scale: number,\n      easing = 1.0,\n      isHover = true,\n      needBoundRender = false,\n      isGrayColor: boolean,\n      visibility: number,\n      isPin: boolean\n    ) {\n      let boundingOffset = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties\n        .pointBoundOffset;\n      if (!this.shape.draw.renderer.hasAni) {\n        isHover = false;\n      } // this is for controlling animation effect\n\n      if (isHover) {\n        boundingOffset *= easing;\n      } else {\n        boundingOffset -= boundingOffset * easing;\n      }\n      if (needBoundRender) {\n        ctx.lineWidth =\n          0.5 +\n          easing *\n            rs.lineWidth * rs.scaleGlobal * rs.scaleLocal *\n            this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale *\n            2;\n        // ctx.lineWidth *= 0.5;\n        // console.log(easing , rs.lineWidth);\n        // console.log(rs.width);\n        // const xPos = x - rs.width * 0.5 * scale;\n        // const yPos = y - rs.height + 0;\n\n        // ctx.save();\n        // ctx.translate(xPos, yPos);\n        const OffsetX = rs.width;\n        const OffsetY = rs.height;\n        const widthHalf = OffsetX * 0.5 * scale;\n\n        ctx.save();\n        ctx.translate(x - widthHalf, y - OffsetY * scale);\n        ctx.scale(scale, scale);\n\n        // let col = rs.colorFillHover; // this.shape.preset.regularPointColorHover;\n        ctx.strokeStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString; // `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n\n        switch (pointRenderType) {\n          case PointRenderType.RpointA:\n            if (this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG) {\n              ctx.stroke(this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.rPoint.SVG.path2D);\n            }\n            break;\n          case PointRenderType.Image:\n            this.pointIconHover(ctx, rs, 0, 0, 32, 32, this.getIconByURL(rs.url), false, false, 1);\n            break;\n          default:\n            break;\n        }\n        ctx.restore();\n      }\n    }\n    public pointNumberedOverBoundingByCircle(ctx: CanvasRenderingContext2D, pathSVG: Path2D, rs: RenderStyle, x: number, y: number, scale: number, easing = 1.0, isHover = true, needBoundRender = false, isGrayColor: boolean, visibility: number) {\n      const height = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.nPoint.height;\n      let boundingOffset = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.pointBoundOffset;\n      if (isHover) {\n        boundingOffset *= easing;\n      } else {\n        boundingOffset -= boundingOffset * easing;\n      }\n\n      // ...................... bg bouncing\n      ctx.fillStyle = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.outlineHoverColorRGBAString;\n      if (needBoundRender) {\n        // let r = 2.3 * this.shape.draw.renderer.annotationInstance.customization.themeCurrent.nPoint.scale * boundingOffset;\n        // let r = 2.5 * boundingOffset;\n        // console.log(rs.lineWidth);\n        let r = height * scale * 0.5 + 0.75 * easing * this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.properties.elasticScale;\n        if (r < 0) {\n          r = 0;\n        }\n        // console.log(height)\n        // ctx.beginPath();\n        // ctx.arc(x, y - height * scale * 0.5 + 2, r, 0, 2 * Math.PI, false);\n        // ctx.closePath();\n        ctx.fill(pathSVG);\n      }\n    }\n    private getIconByURL(url: string) {\n      return this.shape.draw.renderer.imageAnnoApp.customization.iconAsset.getIconByURL(url);\n    }\n  }\n","import { RenderStyle } from '../../../../Geometry/GeometryAnnotation/Helper/RenderStyle';\nimport { ShapePreset } from '..';\nexport class DrawingPresetPolyline {\n  public shape: ShapePreset;\n  constructor(shape: ShapePreset) {\n    this.shape = shape;\n  }\n  public edgePolylineLineTo(ctx: CanvasRenderingContext2D, rs: RenderStyle, x0: number, y0: number, x1: number, y1: number, over = false, isGrayColor = false, visibility = 1, easing = 1.0, isHover: boolean, isSelected: boolean) {\n    ctx.lineTo(x0, y0);\n    ctx.lineTo(x1, y1);\n  }\n  public edgePolyline(ctx: CanvasRenderingContext2D, rs: RenderStyle, x0: number, y0: number, x1: number, y1: number, over = false, isGrayColor = false, visibility = 1, easing = 1.0, isHover: boolean, isSelected: boolean) {\n    ctx.moveTo(x0, y0);\n    ctx.lineTo(x1, y1);\n  }\n  public curveQuadratic(ctx: CanvasRenderingContext2D, rs: RenderStyle, x0: number, y0: number, x1: number, y1: number, x2: number, y2: number, isHover = false, isSelected: boolean) {\n    ctx.moveTo(x0, y0);\n    ctx.quadraticCurveTo(x1, y1, x2, y2);\n  }\n}\n","import {\n  ColorBlending, \n  NVector3,\n} from '../../../../../../lib';\nimport { ShapePreset } from '..';\nexport class DrawingPresetSelection {\n  public shape: ShapePreset;\n  constructor(shape: ShapePreset) {\n    this.shape = shape;\n  }\n  public selectionLasso(ctx: CanvasRenderingContext2D, vs: NVector3[], isClosed = false, t = 0) {\n    ctx.globalCompositeOperation = ColorBlending.ColorDodge;\n    ctx.lineWidth = 1;\n    ctx.lineDashOffset = -t;\n\n    let col = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.selection\n      .strokeStyleFirstArray;\n    ctx.strokeStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, 0.9)`;\n    col = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.selection\n      .fillStyleFirstArray;\n    ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, 0.3)`;\n\n    ctx.setLineDash([4, 4]);\n\n    ctx.beginPath();\n    ctx.setLineDash([5, 4]);\n    ctx.moveTo(vs[0].x, vs[0].y);\n    for (let i = 1; i < vs.length; ++i) {\n      ctx.lineTo(vs[i].x, vs[i].y);\n    }\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n\n    ctx.setLineDash([]);\n    ctx.globalCompositeOperation = ColorBlending.SourceOver;\n  }\n  public selection(\n    ctx: CanvasRenderingContext2D,\n    v0: NVector3,\n    v1: NVector3,\n    isWindow = false,\n    t = 0\n  ) {\n    ctx.globalCompositeOperation = ColorBlending.ColorDodge;\n    ctx.lineWidth = 1;\n    ctx.lineDashOffset = -t;\n\n    let col = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.selection\n      .strokeStyleFirstArray;\n    ctx.strokeStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, 0.9)`;\n    col = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.selection\n      .fillStyleFirstArray;\n    ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, 0.3)`;\n\n    if (!isWindow) {\n      ctx.setLineDash([5, 4]);\n    } else {\n      ctx.setLineDash([4, 4]);\n    }\n    ctx.beginPath();\n    ctx.moveTo(v0.x, v0.y);\n    ctx.lineTo(v0.x, v1.y);\n    ctx.lineTo(v1.x, v1.y);\n    ctx.lineTo(v1.x, v0.y);\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n\n    ctx.setLineDash([]);\n    ctx.globalCompositeOperation = ColorBlending.SourceOver;\n  }\n}\n","// import { NVector3, COLORBLENDING } from '../../../../../../lib';\nimport { ShapePreset } from '..';\nexport class DrawingPresetSnapping {\n  public shape: ShapePreset;\n  constructor(shape: ShapePreset) {\n    this.shape = shape;\n  }\n  public circleBG(ctx: CanvasRenderingContext2D, x: number, y: number, size: number, easing = 1.0) {\n    // let col = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.selection.strokeStyleFirstArray;\n    let col = this.shape.draw.renderer.imageAnnoApp.activeCommandController.activeColorController.activeColor;\n    ctx.strokeStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, 0.9)`;\n    // col = this.shape.draw.renderer.imageAnnoApp.customization.themeCurrent.selection.fillStyleFirstArray;\n    ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, 0.3)`;\n\n    let r = size + 1 * easing;\n    if (r < 0) {\n      r = 0;\n    }\n    ctx.beginPath();\n    ctx.arc(x, y, r, 0, 2 * Math.PI, false);\n    ctx.closePath();\n    ctx.fill();\n  }\n}\n","import { \n  InteractionMode,\n  NVector3 \n} from '../../../../../../lib';\n// import { text } from '../../../../Customization/ThemeRenderStyle/StorymapsThemeStructure';\nimport { ThemeColorId } from '../../../../Customization/ThemeRenderStyle/Utility';\nimport { StyleComponent as StyleComponentV2 } from '../../../../Geometry/GeometryAnnotation/FamilyText/ATextleaderline/Component/StyleComponent';\nimport { ShapePreset } from '..';\nexport class DrawingPresetText {\n  public shape: ShapePreset;\n  public needResetDash = false;\n  constructor(shape: ShapePreset) {\n    this.shape = shape;\n  }\n  // .............................................................................\n  public roundedRectACTextStoryMapByWidth(\n    ctx: CanvasRenderingContext2D,\n    sc: StyleComponentV2,\n    v0: NVector3,\n    width: number,\n    height: number,\n    r: number,\n    xOff = 0,\n    yOff = 0,\n    isHover: boolean,\n    isSelected: boolean\n  ) {\n    ctx.beginPath();\n    ctx.rect(v0.x, v0.y, width, height);\n    ctx.closePath();\n\n    const col = sc.styleBox.fillStyle;\n    ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, 1)`;\n\n    if (isSelected) {\n      ctx.fillStyle = `rgba(${col[0]}, ${col[1]}, ${col[2]}, 1)`;\n    }\n    if (\n      sc.state.textColor === ThemeColorId.BackgroundColor ||\n      sc.state.textColor === ThemeColorId.TitleColor\n    ) {\n      ctx.shadowBlur = 15;\n      ctx.shadowColor = 'rgba(0,0,0,0.05)';\n      ctx.fill();\n      ctx.shadowBlur = 0;\n    } else {\n      if (\n        this.shape.draw.renderer.imageAnnoApp.implementations.app.param.interactionMode ===\n        InteractionMode.Drawing\n      ) {\n        ctx.strokeStyle = `rgba(${sc.styleLeaderline.strokeStyle[0]}, ${sc.styleLeaderline.strokeStyle[1]}, ${sc.styleLeaderline.strokeStyle[2]}, 1)`;\n        if (isSelected || isHover) {\n          ctx.lineWidth = sc.styleBox.lineWidth; // ATextLeaderlineDrawingPreset.lineWidth; // parseFloat(s.lineWidth);\n          ctx.setLineDash([4, 4]); // (sc.styleBox.dash);\n          ctx.stroke();\n        }\n      }\n      ctx.setLineDash([]);\n    }\n  }\n  public renderNodeDia(\n    ctx: CanvasRenderingContext2D,\n    sc: StyleComponentV2,\n    x: number,\n    y: number,\n    width: number,\n    height: number\n  ) {\n    ctx.beginPath();\n    ctx.moveTo(x + width, y);\n    ctx.lineTo(x, y + height);\n    ctx.lineTo(x - width, y);\n    ctx.lineTo(x, y - height);\n    ctx.closePath();\n    ctx.lineWidth = sc.styleHandleNode.lineWidth; // ATextLeaderlineDrawingPreset.lineWidth;\n    ctx.strokeStyle = `rgba(${sc.styleHandleNode.strokeStyle[0]}, ${sc.styleHandleNode.strokeStyle[1]}, ${sc.styleHandleNode.strokeStyle[2]}, ${sc.styleHandleNode.strokeStyle[3]})`;\n    ctx.fillStyle = `rgba(${sc.styleHandleNode.fillStyle[0]}, ${sc.styleHandleNode.fillStyle[1]}, ${sc.styleHandleNode.fillStyle[2]}, ${sc.styleHandleNode.fillStyle[3]})`;\n    ctx.fill();\n    ctx.stroke();\n  }\n  public renderLeaderLine(\n    ctx: CanvasRenderingContext2D,\n    sc: StyleComponentV2,\n    v0: NVector3,\n    v1: NVector3,\n    v2: NVector3,\n    t: number,\n    isUpperDia: boolean,\n    isHover: boolean,\n    isSelected: boolean\n  ) {\n    const col = sc.styleLeaderline.strokeStyle;\n    const colString = `rgba(${col[0]}, ${col[1]}, ${col[2]}, ${col[3]})`;\n    const r = 7;\n    ctx.lineDashOffset = 0;\n    ctx.beginPath();\n    if (isUpperDia) {\n      if (isSelected) {\n        ctx.moveTo(v0.x, v0.y);\n      } else {\n        ctx.moveTo(v0.x, v0.y);\n      }\n    } else {\n      if (isSelected) {\n        ctx.moveTo(v0.x, v0.y);\n      } else {\n        ctx.moveTo(v0.x, v0.y);\n      }\n    }\n    ctx.lineTo(v1.x, v1.y);\n    ctx.lineTo(v2.x, v2.y);\n    /* for the transparent background for the marker's fill\n    // if (v2.x - v1.x < 0) {\n    //   ctx.lineTo(v2.x + r, v2.y);\n    // } else {\n    //   ctx.lineTo(v2.x - r, v2.y);\n    // }\n    */\n\n    ctx.setLineDash(sc.styleLeaderline.dash);\n    this.needResetDash = true;\n    ctx.strokeStyle = colString;\n    ctx.lineWidth = sc.styleLeaderline.lineWidth; //rs.lineWidth;\n    ctx.stroke();\n    ctx.setLineDash([]);\n\n    if (isHover || isSelected) {\n      ctx.beginPath();\n      ctx.arc(v2.x, v2.y, r, 0, 3.14 * 2);\n      ctx.closePath();\n      ctx.strokeStyle = `rgba(${sc.styleAnchorNode.strokeStyle[0]}, ${sc.styleAnchorNode.strokeStyle[1]}, ${sc.styleAnchorNode.strokeStyle[2]}, ${sc.styleAnchorNode.strokeStyle[3]})`;\n      ctx.fillStyle = `rgba(${sc.styleAnchorNode.fillStyle[0]}, ${sc.styleAnchorNode.fillStyle[1]}, ${sc.styleAnchorNode.fillStyle[2]}, ${sc.styleAnchorNode.fillStyle[3]})`;\n      ctx.lineWidth = sc.styleAnchorNode.lineWidth;\n      ctx.fill();\n      ctx.stroke();\n    }\n  }\n}\n","import { Draw } from '..';\nimport { DrawingPresetArea } from './Preset/DrawingPresetArea';\nimport { DrawingPresetCluster } from './Preset/DrawingPresetCluster';\nimport { DrawingPresetCurve } from './Preset/DrawingPresetCurve';\nimport { DrawingPresetFreeHand } from './Preset/DrawingPresetFreeHand';\nimport { DrawingPresetLine } from './Preset/DrawingPresetLine';\nimport { DrawingPresetNGon } from './Preset/DrawingPresetNGon';\nimport { DrawingPresetNode } from './Preset/DrawingPresetNode';\nimport { DrawingPresetPoint } from './Preset/DrawingPresetPoint';\nimport { DrawingPresetPointGeneric } from './Preset/DrawingPresetPointGeneric';\nimport { DrawingPresetPointSVG } from './Preset/DrawingPresetPointSVG';\nimport { DrawingPresetPolyline } from './Preset/DrawingPresetPolyline';\nimport { DrawingPresetSelection } from './Preset/DrawingPresetSelection';\nimport { DrawingPresetSnapping } from './Preset/DrawingPresetSnapping';\nimport { DrawingPresetText } from './Preset/DrawingPresetText';\nexport class ShapePreset {\n  public draw: Draw;\n  public point: DrawingPresetPoint;\n  public pointGeneric: DrawingPresetPointGeneric;\n  public pointSVG: DrawingPresetPointSVG;\n  public cluster: DrawingPresetCluster;\n  public node: DrawingPresetNode;\n  public line: DrawingPresetLine;\n  public ngon: DrawingPresetNGon;\n  public area: DrawingPresetArea;\n  public text: DrawingPresetText;\n  public snapping: DrawingPresetSnapping;\n  public curve: DrawingPresetCurve;\n  public polyline: DrawingPresetPolyline;\n  public selection: DrawingPresetSelection;\n  public freeHand: DrawingPresetFreeHand;\n  constructor(draw: Draw) {\n    this.draw = draw;\n    this.point = new DrawingPresetPoint(this);\n    this.pointGeneric = new DrawingPresetPointGeneric(this);\n    this.pointSVG = new DrawingPresetPointSVG(this);\n    this.node = new DrawingPresetNode(this);\n    this.cluster = new DrawingPresetCluster(this);\n    this.line = new DrawingPresetLine(this);\n    this.ngon = new DrawingPresetNGon(this);\n    this.area = new DrawingPresetArea(this);\n    this.text = new DrawingPresetText(this);\n    this.curve = new DrawingPresetCurve(this);\n    this.polyline = new DrawingPresetPolyline(this);\n    this.selection = new DrawingPresetSelection(this);\n    this.freeHand = new DrawingPresetFreeHand(this);\n    this.snapping = new DrawingPresetSnapping(this);\n  }\n}\n","import { Renderer } from '..';\nimport { ImagePreset } from './ImagePreset';\nimport { ShapePreset } from './ShapePreset';\nexport class Draw {\n  public shape: ShapePreset;\n  public image: ImagePreset;\n  public renderer: Renderer;\n  constructor(renderer: Renderer) {\n    this.renderer = renderer;\n    this.init();\n  }\n  public init() {\n    this.shape = new ShapePreset(this);\n    this.image = new ImagePreset(this);\n  }\n}\n","import { IOGeometry } from '../../../lib/Extended/GeometryUtility';\nimport { MouseEventData, NVector3, NumericalMotion, RendererInterface, CompileMode } from '../../../lib';\nimport { Blackhole } from '../Geometry/Blackhole';\nimport { ASelection } from '../Geometry/GeometryAnnotation/ASelection';\nimport { ObjectSnapping } from '../Geometry/ObjectSnapping';\nimport { Optimizer } from '../Geometry/Optimizer';\nimport { ImageAnnoApp } from '..';\nimport { EnvAnnotationMap } from './Environment/EnvAnnotationMap';\nimport { DrawingPresetOffscreen } from './Offscreen/DrawingPresetOffscreen';\nimport { Draw } from './Draw';\nexport class Renderer implements RendererInterface {\n  public imageAnnoApp: ImageAnnoApp;\n  public optimizer: Optimizer;\n  public draw: Draw;\n  public offscreen: DrawingPresetOffscreen;\n  public env: EnvAnnotationMap;\n  public debugText = 0;\n  public blackhole: Blackhole;\n  public selection: ASelection;\n  public t: number;\n  public frameRate: number;\n  public anchor: NVector3;\n  public xOff: number;\n  public yOff: number;\n  public xOffCurrent: number;\n  public yOffCurrent: number;\n  public xOffPre: number;\n  public yOffPre: number;\n  public zoomFactor: number;\n  public zoomFactorPre: number;\n  public zoomFactorCurrent: number;\n  public needBlackhole: boolean;\n  public isFetchTheme = false;\n  public ctx: CanvasRenderingContext2D;\n  public ctxOffscreen: CanvasRenderingContext2D;\n\n  public objectSnapping: ObjectSnapping;\n  public numericalMotion: NumericalMotion;\n  public unHover = false;\n\n  public hasAni = false;\n\n  protected frameValue = 0;\n  protected frameUpdateValue = 0;\n  protected frameSkipValue = 2;\n\n  private _updateProjectionForce = true;\n  private _needFocus = false;\n  private index = 0;\n  constructor(imageAnnoApp: ImageAnnoApp, hasAni: boolean, frameRate = 60) {\n    this.imageAnnoApp = imageAnnoApp;\n    this.numericalMotion = new NumericalMotion();\n    this.t = 0.0;\n    this.hasAni = hasAni;\n    this.frameRate = frameRate;\n    this.needBlackhole = false;\n\n    this.env = new EnvAnnotationMap(this);\n\n    this.objectSnapping = new ObjectSnapping(this);\n    this.draw = new Draw(this);\n    this.offscreen = new DrawingPresetOffscreen(this);\n    // AGeometryCommon.sound = this.annotationDrawing.sound;\n    // AGeometryCommon.listBaseGrid = this.grid = new AGrid(this);\n    if (\n      this.imageAnnoApp.implementations.app.model.appCoreWrapper.appProperties.compileMode !==\n      CompileMode.Production\n    ) {\n      this.development();\n    }\n    this.selection = new ASelection(this.imageAnnoApp.scene);\n    if (this.needBlackhole) {\n      this.blackhole = new Blackhole(this.imageAnnoApp.scene);\n    }\n  }\n  public initPost() {\n    this.canvasOff();\n    // this.cVisRenerer = new CVisualizationRenderer(this.annotationDrawing);\n    // this.annotationInstance.geometryCommon.gcmdSupporting.RenderForceMask();\n    // this.annotationInstance.geometryCommon.gcmdSupporting.UpdateExtent();\n    this.bindContextForOffscreen();\n    this.optimizer = new Optimizer(this);\n  }\n  public get needFocus() {\n    return this._needFocus;\n  }\n  public set needFocus(v: boolean) {\n    // this value needs to be always false because we do not want to dim the style of other shapes.\n    this._needFocus = false;\n  }\n  public get dt() {\n    return this.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvas.deltaTime.dt;\n  }\n  public bindContextForOffscreen() {\n    this.ctxOffscreen = this.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvasOffScreen.offScreenCtx;\n  }\n  public development() {\n    // this.blackhole = new CBlackhole(50, 50, 20);\n    // this.mouseVis = new CMouse(this.annotationDrawing);\n  }\n  public canvasOff() {\n    this.xOff = 0;\n    this.yOff = 0;\n    this.xOffCurrent = 0;\n    this.yOffCurrent = 0;\n    this.xOffPre = 0;\n    this.yOffPre = 0;\n    this.zoomFactor = 0;\n    this.zoomFactorPre = 0;\n    this.zoomFactorCurrent = 0;\n    this.anchor = new NVector3(0, 0, 0);\n  }\n  public saveDrawingGeometries() {\n    const data = new Map<string, IOGeometry>();\n    this.index = this.imageAnnoApp.scene.geometryList.length;\n    while (this.index--) {\n      const d = this.imageAnnoApp.scene.geometryList[this.index].toJSON();\n      if (d !== undefined) {\n        data.set(this.imageAnnoApp.scene.geometryList[this.index].id, d);\n      }\n    }\n    return data;\n  }\n  public Init() {\n    //\n  }\n  public render(ctx: CanvasRenderingContext2D) {\n    this.updatePre();\n    this.renderPre(ctx);\nconsole.log('rendering...');\n    // this.imageAnnoApp.mapticon.render(ctx);\n    this.env.renderEnv(ctx);\n\n    this.renderPost(ctx);\n    this.updatePost();\n  }\n  public get updateProjectionForce() {\n    return this._updateProjectionForce;\n  }\n  public set updateProjectionForce(v: boolean) {\n    this._updateProjectionForce = v;\n    this.t = 0.0;\n  }\n  public destroy() {\n    //\n  }\n  public updateMouseHover(e: MouseEventData) {\n    let isHoverOrisSelected = false;\n    this.index = this.imageAnnoApp.scene.geometryList.length;\n    // ........ shapes\n    while (this.index--) {\n      // not yet a overlap function for keeping clean code\n      // if (AGeometryCommon.list[i].isRemove) continue;\n      if (this.imageAnnoApp.scene.geometryList[this.index].isSelectedValue) {\n        isHoverOrisSelected = true;\n      }\n      if (this.imageAnnoApp.scene.geometryList[this.index].isMouseInside(e.x, e.y)) {\n        this.imageAnnoApp.scene.geometryList[this.index].isHover = true;\n        // if (\n        //   this.annotationInstance.uiWrapper &&\n        //   this.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore\n        //     .mapView\n        // ) {\n        //   this.annotationInstance.uiWrapper.log.logGeometry.text = this.annotationInstance.scene.geometryList[\n        //     this.index\n        //   ].GetLog();\n        // }\n        this.imageAnnoApp.geometryCommon.gcmdProcessing.setCaptureHovered(\n          this.imageAnnoApp.scene.geometryList[this.index]\n        );\n        isHoverOrisSelected = true;\n      } else {\n        this.imageAnnoApp.scene.geometryList[this.index].isHover = false;\n      }\n    }\n    // ........ end shapes\n\n    if (!isHoverOrisSelected) {\n      this.imageAnnoApp.geometryCommon.gcmdProcessing.setCaptureHovered(undefined);\n    }\n    this.imageAnnoApp.renderer.needFocus = isHoverOrisSelected;\n    this.imageAnnoApp.activeCommandController.acProperties.hasHovering = isHoverOrisSelected;\n  }\n  private updatePre() {\n    this.imageAnnoApp.scene.reset();\n    this.xOff = this.xOffCurrent - this.xOffPre;\n    this.yOff = this.yOffCurrent - this.yOffPre;\n    this.zoomFactor = this.zoomFactorCurrent - this.zoomFactorPre;\n    this.t += 0.01;\n    this.index = this.imageAnnoApp.scene.listBasePoint.length;\n    if (this.updateProjectionForce) {\n      // for projection init, only init time of app\n      // this.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.isViewChanging = true;\n      this.imageAnnoApp.activeCommandController.acProperties.isPanning = true;\n      // this.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.UpdateExtent();\n      if (this.frameUpdateValue++ % 2 === 0) {\n        while (this.index--) {\n          this.imageAnnoApp.scene.listBasePoint[this.index].update(true);\n        }\n      }\n      if (this.t > 0.5) {\n        // after time up, these scope will be exeucted one time, that's whay we force to change isViewChanging, isPanning as false\n        // this.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.isViewChanging = false;\n        this.imageAnnoApp.activeCommandController.acProperties.isPanning = false;\n        this.updateProjectionForce = false;\n      }\n    } else {\n      // optimize update loop\n      if (\n        this.imageAnnoApp.activeCommandController.acProperties.isPanning ||\n        this.imageAnnoApp.activeCommandController.acProperties.isZooming\n      ) {\n        // console.log('extent chaning, update...');\n        while (this.index--) {\n          this.imageAnnoApp.scene.listBasePoint[this.index].update();\n        }\n      } else {\n        if (this.frameUpdateValue++ % 3 === 0) {\n          // console.log('optimzied update...');\n          while (this.index--) {\n            this.imageAnnoApp.scene.listBasePoint[this.index].update();\n          }\n        }\n      }\n    }\n\n    this.optimizer.update();\n  }\n  private updatePost() {\n    this.xOffPre = this.xOffCurrent;\n    this.yOffPre = this.yOffCurrent;\n    this.zoomFactorPre = this.zoomFactorCurrent;\n  }\n  private renderPre(ctx: CanvasRenderingContext2D) {\n    if (this.blackhole) {\n      this.blackhole.render(ctx);\n    }\n  }\n  private renderPost(ctx: CanvasRenderingContext2D) {\n    // ctx.clearRect()\n\n    // ....................................... log\n    if (true) {\n      if(this.imageAnnoApp.implementations.app.model.appCoreWrapper.appProperties.compileMode !== CompileMode.Production) {\n        \n      }\n      // this.index = this.imageAnnoApp.scene.listCanvasLog.length;\n      // while (this.index--) {\n      //   this.imageAnnoApp.scene.listCanvasLog[this.index].Render(ctx);\n      // }\n      this.index = this.imageAnnoApp.scene.listALog.length;\n      while (this.index--) {\n        this.imageAnnoApp.scene.listALog[this.index].render(ctx);\n      }\n      // debug\n      // if (this.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.mapView) {\n      //   this.annotationInstance.implementations.app.model.appCoreWrapper.arcGISWrapper.mapViewCore.extent.Render(ctx);\n      // }\n      // end debug\n    }\n\n    this.renderCroppingArea(ctx);\n\n    this.selection.render(ctx);\n  }\n\n  // public updateDataImg(img: HTMLImageElement) {\n  //   console.log('renderer', img);\n\n  //   if (img.width === this.imageAnnoApp.implementations.app.model.modelViewWrapper.img.width &&\n  //     img.height === this.imageAnnoApp.implementations.app.model.modelViewWrapper.img.height) {\n  //       console.log('return');\n  //       return;\n  //     }\n\n  //   this.imageAnnoApp.implementations.app.updateImage(img, JSON.stringify(this.croppingMaskParm));\n  // }\n  public renderCroppingArea(ctx: CanvasRenderingContext2D) {\n    this.imageAnnoApp.scene.paramsEditing.renderCroppingArea(ctx);\n  }\n}\n","import { SceneManager as _SceneManager } from '../../../lib'\nimport { IOGeometry } from '../../../lib/Extended/GeometryUtility';\n/*\nThis is a Scene Manager for undo and redo operation.\nWhenever you do actions like add, remove, or translation,\nwe capture the geometry data in the history that allow us\nto go back and forth.\n*/\n\nexport class SceneState {\n  geometry: IOGeometry[] = [];\n  activeColor: string = '#000000';\n  globalScale: number = 1;\n  isModifiedImage: boolean = true;\n  constructor(geometry: IOGeometry[], isModifiedImage: boolean, activeColor: string, globalScale: number) {\n    this.geometry = geometry;\n    this.isModifiedImage = isModifiedImage;\n    this.activeColor = activeColor;\n    this.globalScale = globalScale;\n  }\n}\nexport class SceneManager extends _SceneManager {\n  //@ts-ignore\n  protected history: SceneState[] = [];\n\n  constructor() {\n    super();\n  }\n  public pushAdapter(data: IOGeometry[], isModifiedImage: boolean, activeColor: string, globalScale: number) {\n    this.push(new SceneState(data, isModifiedImage, activeColor, globalScale));\n  }\n  public push(data: any ) {\n    if (this.currentIndex < this.history.length - 1) {\n      this.history.splice(this.currentIndex + 1, this.history.length);\n    }\n    this.history.push(data);\n    this.currentIndex = this.history.length - 1;\n  }\n  public undo() {\n    if (this.currentIndex === 0) {\n      return undefined;\n    }\n    this.currentIndex--;\n    return this.history[this.currentIndex];\n  }\n  public redo() {\n    this.currentIndex++;\n    this.currentIndex = this.currentIndex < this.history.length ? this.currentIndex : this.history.length - 1;\n    return this.history[this.currentIndex];\n  }\n}\n","import { FrameShapeType, cutOutContextByShape } from '../../../lib';\nimport { Scene } from '.';\nexport class ParamsEditing {\n    public scene: Scene;\n    public ctx: CanvasRenderingContext2D\n\n    // this.app.implementations.imageAnnoApp.scene.paramsEditing.updateDataCropping(parma);\n\n    public croppingMaskParams: any;\n    constructor(scene: Scene) {\n        this.scene = scene;\n    }\n    public isInsideCropShape(x: number, y: number) {\n        switch (this.croppingMaskParams.shape) {\n            case FrameShapeType.Circle:\n                const projectedPos = this.scene.annotationInstance.implementations.app.model.imageWrapper.projectionToImageSpace(x, y)\n                const v = this.ctx.getImageData(projectedPos[0], projectedPos[1], 1, 1);\n                if (v.data[3] === 0) {\n                    return true;\n                } else {\n                    return false;\n                }\n\n            default:\n                return true;\n        }\n      }\n    public updateDataCropping(param: any) {\n        const canvas = document.createElement('canvas');\n        // this style(width and height) is only for screen space for visualization purpose. We need to project the number from image to screen as well.\n        canvas.style.width = '100%';\n        canvas.style.height = '100%';\n        // this.scene.annotationInstance.implementations.divHost.append(canvas); // before debugging\n        this.ctx = canvas.getContext('2d')\n        canvas.width = param.width;\n        canvas.height = param.height;\n        this.croppingMaskParams = param;\n        // console.log('imple',this.croppingMaskParams);\n        this.scene.annotationInstance.geometryCommon.gcmdSupporting.renderForce();\n        this.drawOffscreen(this.ctx);\n    }\n    public updateBGStyle() {\n        if (this.croppingMaskParams.isCropGraphics) {\n            // this.scene.annotationInstance.implementations.app.model.imageWrapper.imgAppended.style.background = 'rgba(0,0,0,0.0)';\n            // this.scene.annotationInstance.implementations.app.model.imageWrapper.imgAppended.style.border = 'dotted';\n            // this.scene.annotationInstance.implementations.app.model.imageWrapper.imgAppended.style.borderColor = 'darkgray';\n        } else {\n            // this.scene.annotationInstance.implementations.app.model.imageWrapper.imgAppended.style.background = 'rgba(255, 255, 255, 0.15)';\n            // this.scene.annotationInstance.implementations.app.model.imageWrapper.imgAppended.style.border = 'none';\n            // this.scene.annotationInstance.implementations.app.model.imageWrapper.imgAppended.style.borderColor = '#000000';\n        }\n\n    }\n    public toggleCropGraphics() {\n        this.croppingMaskParams.isCropGraphics = !this.croppingMaskParams.isCropGraphics;\n        // console.log(this.croppingMaskParams.isCropGraphics);\n    }\n    public renderCroppingArea(ctx: CanvasRenderingContext2D) {\n        if (this.croppingMaskParams.isCropGraphics) {\n            cutOutContextByShape(ctx, this.croppingMaskParams.shape, 0, 0, this.croppingMaskParams.width, this.croppingMaskParams.height, false);\n        }\n\n        this.updateBGStyle();\n        return;\n    //     if (this.croppingMaskParm) {\n\n    //       ctx.fillStyle = 'rgba(200, 200, 200, 0.5)';\n\n    //       switch (this.croppingMaskParm.shape ) {\n    //         case FrameShapeType.Circle:\n    //           const width = this.croppingMaskParm.width * 0.5;\n    //           const height = this.croppingMaskParm.height * 0.5;\n    //           ctx.beginPath();\n    //           ctx.rect(0, 0, ctx.canvas.width, ctx.canvas.height);\n    //           ctx.ellipse(this.croppingMaskParm.x +  width, this.croppingMaskParm.y + height, width, height, 0, 0, Math.PI * 2 );\n    //           ctx.closePath();\n    //           ctx.fill('evenodd');\n    //           break;\n\n    //         default:\n    //           ctx.beginPath();\n    //           ctx.rect(0, 0, ctx.canvas.width, this.croppingMaskParm.y);\n    //           ctx.rect(0, this.croppingMaskParm.y + this.croppingMaskParm.height, ctx.canvas.width, ctx.canvas.height);\n    //           ctx.rect(0, 0, this.croppingMaskParm.x, ctx.canvas.height);\n    //           ctx.rect(this.croppingMaskParm.x + this.croppingMaskParm.width , 0, ctx.canvas.width, ctx.canvas.height);\n    //           ctx.closePath();\n    //           ctx.fill();\n    //           break;\n    //       }\n\n\n    //       ctx.lineWidth = 0.5;\n    //       // ctx.lineDashOffset = this._t;\n\n\n    //       ctx.beginPath();\n    //       ctx.rect(\n    //         this.croppingMaskParm.x,\n    //         this.croppingMaskParm.y,\n    //         this.croppingMaskParm.width,\n    //         this.croppingMaskParm.height,\n    //       );\n    //       ctx.closePath();\n\n    //       ctx.strokeStyle = 'rgba(255, 255, 255, 1)'\n    //       ctx.stroke();\n\n    //       ctx.setLineDash([2, 2]);\n    //       ctx.strokeStyle = 'rgba(0, 0, 0, 1)'\n    //       ctx.stroke();\n    //       ctx.setLineDash([]);\n\n    //     }\n    //   }\n    }\n    private drawOffscreen(ctx: CanvasRenderingContext2D) {\n          switch (this.croppingMaskParams.shape ) {\n            case FrameShapeType.Circle:\n              const width = this.croppingMaskParams.width * 0.5;\n              const height = this.croppingMaskParams.height * 0.5;\n              ctx.beginPath();\n              ctx.rect(-1, -1, ctx.canvas.width + 1, ctx.canvas.height + 1);\n              ctx.ellipse(width , height, width, height, 0, 0, Math.PI * 2 );\n              ctx.closePath();\n              ctx.fill('evenodd');\n              break;\n\n            default:\n              ctx.beginPath();\n              ctx.rect(0, 0, ctx.canvas.width, this.croppingMaskParams.y);\n              ctx.rect(0, this.croppingMaskParams.y + this.croppingMaskParams.height, ctx.canvas.width, ctx.canvas.height);\n              ctx.rect(0, 0, this.croppingMaskParams.x, ctx.canvas.height);\n              ctx.rect(this.croppingMaskParams.x + this.croppingMaskParams.width , 0, ctx.canvas.width, ctx.canvas.height);\n              ctx.closePath();\n              ctx.fill();\n              break;\n          }\n    }\n}\n","import { getRandomRGB, getUUID } from '../../../lib';\nimport { IOGeometry } from '../../../lib/Extended/GeometryUtility';\nimport { AGeometryBase } from '../Geometry/Common/Base/AGeometryBase';\nimport { APointBase } from '../Geometry/Common/Base/APointBase';\nimport { ACircleWrapper } from '../Geometry/GeometryAnnotation/FamilyArea/ACircleWrapper/ACircleWrapper';\nimport { ANGonWrapper } from '../Geometry/GeometryAnnotation/FamilyArea/ANGonWrapper';\nimport { APolygonGraphWrapper } from '../Geometry/GeometryAnnotation/FamilyArea/APolygonGraphWrapper';\nimport { APolygonWrapper } from '../Geometry/GeometryAnnotation/FamilyArea/APolygonWrapper/APolygonWrapper';\nimport { ARectangleWrapper } from '../Geometry/GeometryAnnotation/FamilyArea/ARectangleWrapper/ARectangleWrapper';\nimport { ACurve } from '../Geometry/GeometryAnnotation/FamilyCurve/ACurveWrapper/ACurve';\nimport { AFreehandSmartDrawing } from '../Geometry/GeometryAnnotation/FamilyFreehand/AFreehandSmartDrawingWrapper/AFreehandSmartDrawing';\nimport { AFreehand } from '../Geometry/GeometryAnnotation/FamilyFreehand/AFreehandWrapper/AFreehand';\nimport { AArrow } from '../Geometry/GeometryAnnotation/FamilyLine/AArrowWrapper/AArrow';\nimport { APolylineGraphWrapper } from '../Geometry/GeometryAnnotation/FamilyLine/APolylineGraphWrapper/APolylineGraphWrapper';\nimport { APolylineGraphShadow } from '../Geometry/GeometryAnnotation/FamilyLine/APolylineGraphWrapper/Base/APolylineGraphShadow';\nimport { APolylineWrapper } from '../Geometry/GeometryAnnotation/FamilyLine/APolylineWrapper/APolylineWrapper';\nimport { APointIconWrapper } from '../Geometry/GeometryAnnotation/FamilyPoint/APointIconWrapper/APointIconWrapper';\nimport { APointNumberedWrapper } from '../Geometry/GeometryAnnotation/FamilyPoint/APointNumberedWrapper';\nimport { APointRegularWrapper } from '../Geometry/GeometryAnnotation/FamilyPoint/APointRegularWrapper';\nimport { APoint } from '../Geometry/GeometryAnnotation/FamilyPoint/Base/APoint';\nimport { ATextleaderlineWrapper } from '../Geometry/GeometryAnnotation/FamilyText/ATextleaderline';\nimport { ALog } from '../Geometry/GeometryAnnotation/Helper/ALog';\nimport { ImageAnnoApp } from '..';\nimport { SceneManager } from './SceneManager';\nimport { ParamsEditing } from './ParamsEditing';\nexport interface HashColorInterface {\n  [col: string]: AGeometryBase;\n}\nexport class Scene {\n  public geometryList: AGeometryBase[] = [];\n  public listBasePoint: APointBase[] = [];\n  public listAPoint: APoint[] = [];\n  public listRPoint: APointRegularWrapper[] = [];\n  public listNPoint: APointNumberedWrapper[] = [];\n  public listIPoint: APointIconWrapper[] = [];\n  public listARectangleWrapper: ARectangleWrapper[] = [];\n  public listACircleWrapperr: ACircleWrapper[] = [];\n  public listAPolylineWrapper: APolylineWrapper[] = [];\n  public listAPolygonWrapper: APolygonWrapper[] = [];\n  public listANGonWrapper: ANGonWrapper[] = [];\n  public listAPolygonGraphWrapper: APolygonGraphWrapper[] = [];\n  public listAPolylineGraphWrapper: APolylineGraphWrapper[] = [];\n  public listAPolylineGraphShadow: APolylineGraphShadow | undefined = undefined;\n  public listAArrow: AArrow[] = [];\n  public listACurve: ACurve[] = [];\n  public listAFreehand: AFreehand[] = [];\n  public listAFreehandSmartDrawing: AFreehandSmartDrawing[] = [];\n  public listATextleaderlineWrapper: ATextleaderlineWrapper[] = [];\n  public listALog: ALog[] = [];\n  public listHashColor: HashColorInterface = {};\n  public copyPasteGeo: AGeometryBase[] = [];\n  public preCapture: AGeometryBase | undefined = undefined;\n  public capture: AGeometryBase | undefined = undefined;\n  public capturePT: APoint | undefined = undefined;\n  public captureMultiple: AGeometryBase[] | undefined = undefined;\n  public captureHovered: AGeometryBase | undefined = undefined;\n  public captureForEasing: AGeometryBase | undefined = undefined;\n  public captureText: ATextleaderlineWrapper | undefined = undefined;\n  public sceneManager: SceneManager;\n  public paramsEditing: ParamsEditing;\n  public annotationInstance: ImageAnnoApp;\n  public useModifiedImage: boolean = true;\n  constructor(imageAnnoApp: ImageAnnoApp) {\n    this.annotationInstance = imageAnnoApp;\n    this.sceneManager = new SceneManager();\n    this.paramsEditing = new ParamsEditing(this)\n  }\n  public undo() {\n    const geoData = this.sceneManager.undo();\n    // console.log('undo', geoData)\n    if (geoData === undefined) {\n      this.annotationInstance.geometryCommon.gcmdProcessing.removeBeforeDump();\n    } else {\n      this.annotationInstance.activeCommandController.setScaleGlobal(geoData.globalScale);\n      this.annotationInstance.activeCommandController.reUndoProcessing(geoData.geometry);\n\n      if (geoData.isModifiedImage !== this.useModifiedImage) {\n        // console.log('update needed undo ', geoData.isModifiedImage)\n          if (geoData.isModifiedImage) {\n            this.annotationInstance.implementations.app.model.imageWrapper.toCroppedImg();\n            // console.log('toCroppedImg')\n            // this.paramsEditing./\n      //       this.paramsEditing.updateDataCropping(this.paramsEditing.croppingMaskParm)\n          } else {\n            this.annotationInstance.implementations.app.model.imageWrapper.toOriginalImg();\n      //       // console.log(this.annotationInstance.renderer.croppingMaskParm)\n      //       // this.paramsEditing.updateDataCropping(this.annotationInstance.renderer.croppingMaskParm)\n          }\n      }\n\n      this.useModifiedImage = geoData.isModifiedImage\n      this.annotationInstance.implementations.app.api.emitDataToExpressImageData();\n      this.emitUndoRedoHistory();\n    }\n    this.annotationInstance.renderer.needFocus = false;\n  }\n  public redo() {\n    const geoData = this.sceneManager.redo();\n    // console.log('redo', geoData)\n    if (geoData !== undefined) {\n      this.annotationInstance.activeCommandController.setScaleGlobal(geoData.globalScale);\n      this.annotationInstance.activeCommandController.reUndoProcessing(geoData.geometry);\n      // if (geoData.cropping) {\n      //   this.annotationInstance.renderer.updateDataCropping(geoData.cropping);\n      // }\n\n      if (geoData.isModifiedImage !== this.useModifiedImage) {\n        // console.log('update needed redo ', geoData.isModifiedImage)\n        if (geoData.isModifiedImage) {\n          this.annotationInstance.implementations.app.model.imageWrapper.toCroppedImg();\n          // this.paramsEditing./\n    //       this.paramsEditing.updateDataCropping(this.paramsEditing.croppingMaskParm)\n        } else {\n          this.annotationInstance.implementations.app.model.imageWrapper.toOriginalImg();\n    //       // console.log(this.annotationInstance.renderer.croppingMaskParm)\n    //       // this.paramsEditing.updateDataCropping(this.annotationInstance.renderer.croppingMaskParm)\n        }\n      }\n\n      this.useModifiedImage = geoData.isModifiedImage\n      this.emitUndoRedoHistory();\n    }\n    this.annotationInstance.renderer.needFocus = false;\n  }\n  // public shiftBGImg() {\n\n  // }\n  public captureScene() {\n    // console.log('captureScene');\n    // console.trace();\n    const geometries: IOGeometry[] = [];\n    for (let i = 0; i < this.geometryList.length; ++i) {\n      const data = this.geometryList[i].toJSON();\n      if (data) {\n        geometries.push(data);\n      }\n    }\n\n    this.useModifiedImage = this.annotationInstance.implementations.app.model.imageWrapper.useModifiedImage;;\n    const activeCommandController = this.annotationInstance.activeCommandController;\n    this.sceneManager.pushAdapter(geometries, this.useModifiedImage, activeCommandController.activeColorController.getActiveColor(), activeCommandController.scaleGlobal);\n    this.emitUndoRedoHistory();\n  }\n  public emitUndoRedoHistory() {\n    const history = this.sceneManager.getCurrentState();\n    this.annotationInstance.io.emitAction(`history@${JSON.stringify(history)}`)\n  }\n  public addGeometry(g: AGeometryBase) {\n    this.geometryList.push(g);\n  }\n  public removeGeometry(g: AGeometryBase) {\n    this.geometryList.splice(this.geometryList.indexOf(g), 1);\n  }\n  public addBasePoint(g: APointBase) {\n    this.listBasePoint.push(g);\n  }\n  public removeBasePoint(g: APointBase) {\n    this.listBasePoint.splice(this.listBasePoint.indexOf(g), 1);\n  }\n  public addAPoint(g: APoint) {\n    this.listAPoint.push(g);\n  }\n  public removeAPoint(g: APoint) {\n    this.listAPoint.splice(this.listAPoint.indexOf(g), 1);\n  }\n  public addRPoint(g: APointRegularWrapper) {\n    this.listRPoint.push(g);\n  }\n  public removeRPoint(g: APointRegularWrapper) {\n    this.listRPoint.splice(this.listRPoint.indexOf(g), 1);\n  }\n  public addNPoint(g: APointNumberedWrapper) {\n    this.listNPoint.push(g);\n  }\n  public removeNPoint(g: APointNumberedWrapper) {\n    this.listNPoint.splice(this.listNPoint.indexOf(g), 1);\n  }\n  public addIPoint(g: APointIconWrapper) {\n    this.listIPoint.push(g);\n  }\n  public removeIPoint(g: APointIconWrapper) {\n    this.listIPoint.splice(this.listIPoint.indexOf(g), 1);\n  }\n  // ...................................................................................................\n  public addARectangleWrapper(g: ARectangleWrapper) {\n    this.listARectangleWrapper.push(g);\n  }\n  public removeARectangleWrapper(g: ARectangleWrapper) {\n    this.listARectangleWrapper.splice(this.listARectangleWrapper.indexOf(g), 1);\n  }\n  public addACircleWrapper(g: ACircleWrapper) {\n    this.listACircleWrapperr.push(g);\n  }\n  public removeACircle(g: ACircleWrapper) {\n    this.listACircleWrapperr.splice(this.listACircleWrapperr.indexOf(g), 1);\n  }\n  // ...................................................................................................\n  public addAArrow(g: AArrow) {\n    this.listAArrow.push(g);\n  }\n  public removeAArrow(g: AArrow) {\n    this.listAArrow.splice(this.listAArrow.indexOf(g), 1);\n  }\n  public addACurve(g: ACurve) {\n    this.listACurve.push(g);\n  }\n  public removeACurve(g: ACurve) {\n    this.listACurve.splice(this.listACurve.indexOf(g), 1);\n  }\n  public addAFreehand(g: AFreehand) {\n    this.listAFreehand.push(g);\n  }\n  public removeAFreehand(g: AFreehand) {\n    this.listAFreehand.splice(this.listAFreehand.indexOf(g), 1);\n  }\n  public addAFreehandSmartDrawing(g: AFreehandSmartDrawing) {\n    this.listAFreehandSmartDrawing.push(g);\n  }\n  public removeAFreehandSmartDrawing(g: AFreehandSmartDrawing) {\n    this.listAFreehandSmartDrawing.splice(this.listAFreehandSmartDrawing.indexOf(g), 1);\n  }\n  // ...................................................................................................\n  public addAPolylineGraphWrapper(g: APolylineGraphWrapper) {\n    this.listAPolylineGraphWrapper.push(g);\n  }\n  public removeAPolylineGraphWrapper(g: APolylineGraphWrapper) {\n    this.listAPolylineGraphWrapper.splice(this.listAPolylineGraphWrapper.indexOf(g), 1);\n  }\n  public addAPolylineWrapper(g: APolylineWrapper) {\n    this.listAPolylineWrapper.push(g);\n  }\n  public removeAPolylineWrapper(g: APolylineWrapper) {\n    this.listAPolylineWrapper.splice(this.listAPolylineWrapper.indexOf(g), 1);\n  }\n  public addAPolygonWrapper(g: APolygonWrapper) {\n    this.listAPolygonWrapper.push(g);\n  }\n  public removeAPolygonWrapper(g: APolygonWrapper) {\n    this.listAPolygonWrapper.splice(this.listAPolygonWrapper.indexOf(g), 1);\n  }\n  public addAPolygonGraphWrapper(g: APolygonGraphWrapper) {\n    this.listAPolygonGraphWrapper.push(g);\n  }\n  public removeAPolygonGraphWrapper(g: APolygonGraphWrapper) {\n    this.listAPolygonGraphWrapper.splice(this.listAPolygonGraphWrapper.indexOf(g), 1);\n  }\n  public addANGonWrapper(g: ANGonWrapper) {\n    this.listANGonWrapper.push(g);\n  }\n  public removeANGonWrapper(g: ANGonWrapper) {\n    this.listANGonWrapper.splice(this.listANGonWrapper.indexOf(g), 1);\n  }\n  public addATextleaderlineWrapper(g: ATextleaderlineWrapper) {\n    this.listATextleaderlineWrapper.push(g);\n  }\n  public removeATextleaderlineWrapper(g: ATextleaderlineWrapper) {\n    this.listATextleaderlineWrapper.splice(this.listATextleaderlineWrapper.indexOf(g), 1);\n  }\n  public addALog(g: ALog) {\n    this.listALog.push(g);\n  }\n  public removeALog(g: ALog) {\n    this.listALog.splice(this.listALog.indexOf(g), 1);\n  }\n  public getUUID() {\n    return getUUID();\n  }\n  public getHashColor(geo: AGeometryBase) {\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      const col = getRandomRGB();\n      if (!this.listHashColor[col]) {\n        this.listHashColor[col] = geo;\n        return col;\n      }\n    }\n  }\n  public get Capture() {\n    return this.capture;\n  }\n  public set Capture(g: AGeometryBase | undefined) {\n    if (this.annotationInstance.implementations.app.INSPECTION) {\n      if (g === undefined) {\n        this.annotationInstance.activeCommandController.screenLog.push('undefined');\n      } else {\n        this.annotationInstance.activeCommandController.screenLog.push(g.type);\n      }\n    }\n\n    if (this.capture !== undefined) {\n      this.capture.isCapturedValue = false;\n    } else {\n      // CanvasCommandChain.app = undefined;\n    }\n    this.preCapture = this.capture;\n    if (this.preCapture) {\n      this.preCapture.isCapturedValue = false;\n    }\n\n    this.capture = g;\n    if (this.capture) {\n      this.annotationInstance.geometryCommon.gcmdProcessing.checkAttachedTextleaderline(\n        this.capture\n      );\n      this.capture.isCapturedValue = true;\n      // this.capture.IsSelected = true;\n      this.capture.updateVecsHistory(); // vecsHistory.push(NVector3.DeepCopy(this.capture.vec));\n    }\n    // if (g !== undefined) this.annotationDrawing.panel.PushModifyPanel(g);\n  }\n  public reset() {\n    // TODO\n  }\n  // .....................................................................................\n  public destroy() {\n    this.annotationInstance.geometryCommon.gcmdProcessing.removeAll();\n  }\n}\n","import { ActionType, InteractionMode } from '../../lib';\nimport { MouseEventData } from '../../../../lib/EventData/MouseEventData';\nimport { Implementations } from '..';\nimport { ActiveCommandController } from './ActiveCommandController/ActiveCommandController';\nimport { GeometryCommon } from './Geometry/Common';\nimport { APIWrapper } from './APIWrapper';\nimport { Customization } from './Customization';\nimport { GraphicsCoreWrapper } from './GraphicsCoreWrapper';\nimport { IOAnnotationInstance } from './IO';\nimport { Renderer } from './Renderer';\nimport { Scene } from './Scene';\n// import { UIWrapper } from './UIWrapper';\n\n/*\nThis ImageAnnoApp class is the place where all drawing related features live in\nscene : data structure containing geometries to render\nrenderer: canvas context renderer for looping\ngeometryCommon: sets of functions to manipulate geometry-related functions or actions\ncustomization: style and shortcut for this app\napiWrapper: upper layer of geometryCommon\nio: communication between Model and this Implementation\nactiveCommanders: pipeline for commands connected to UI on react side\n*/\nexport class ImageAnnoApp {\n  // uiWrapper: UIWrapper | undefined;\n  public scene: Scene;\n  public graphicsCoreWrapper: GraphicsCoreWrapper;\n  public implementations: Implementations;\n  public geometryCommon: GeometryCommon;\n  public activeCommandController: ActiveCommandController;\n  public renderer: Renderer;\n  public io: IOAnnotationInstance;\n  public customization: Customization;\n  public interactionMode: InteractionMode;\n  public apiWrapper: APIWrapper;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  constructor(implementations: Implementations, hasAni: boolean, isActive: boolean, theme?: any) {\n    this.implementations = implementations;\n    this.interactionMode = this.implementations.app.model.appCoreWrapper.appControllerStatus.mode;\n    this.apiWrapper = new APIWrapper(this);\n    this.graphicsCoreWrapper = new GraphicsCoreWrapper(this, isActive);\n    this.scene = new Scene(this);\n    this.renderer = new Renderer(this, hasAni);\n    this.io = new IOAnnotationInstance(this);\n    this.geometryCommon = new GeometryCommon(this);\n    this.activeCommandController = new ActiveCommandController(this);\n    this.customization = new Customization(this, theme);\n    this.renderer.ctx = this.graphicsCoreWrapper.canvasWrapper.aCanvas.ctx;\n    this.renderer.ctxOffscreen = this.graphicsCoreWrapper.canvasWrapper.aCanvasOffScreen.offScreenCtx;\n    if (this.interactionMode) {\n      // this.uiWrapper = new UIWrapper(this);\n    }\n  }\n  public initPost() {\n    this.graphicsCoreWrapper.initPost();\n    this.graphicsCoreWrapper.canvasWrapper.aCanvas.imageSmoothingEnabled = true;\n    this.renderer.initPost();\n  }\n  public resize(width: number, height: number) {\n    this.graphicsCoreWrapper.resizeCanvas(width, height);\n  }\n  public destroy() {\n    this.renderer.destroy();\n    // this.scene.destroy(); for Annotation Image\n    this.graphicsCoreWrapper.destroy();\n  }\n  // ............................................... Event\n  public mouseEventController(e: MouseEventData) {\n    this.activeCommandController.activeCommand.mouseEventController(e);\n  }\n  public pushAction(v: string | { type: ActionType | string; payload: unknown }) {\n    this.io.stateProcessingAnnotation.pushAction(v);\n  }\n}\n","import { ActionType, KeyboardEventData, MouseEventData, TouchEventDataList } from '../lib';\nimport { AppImageDrawing } from '..';\nimport { ImageAnnoApp } from './ImageAnnotation';\n// import { MapticonApp } from './MapticonApp';\nimport { SketchApp } from './SketchApp';\n/*\nThis Implementations class is a root for the real implementation\nand it also has several pipeline for communication\nbetween the model and the real implementation\nsuch as pushAction, event pipelines.\n*/\nexport class Implementations {\n  public app: AppImageDrawing;\n  public divHost: HTMLElement;\n  public imageAnnoApp: ImageAnnoApp;\n  public sketch: SketchApp;\n  // public mapticon: MapticonApp | undefined;\n  constructor(app: AppImageDrawing, divHost: HTMLElement) {\n    this.divHost = divHost;\n    this.app = app;\n\n    // this.sketch = new SketchApp(this);\n    // this.mapticon = new MapticonApp(this);\n  }\n  // eslint:disable-next-line:no-any\n  public initAnnotationCanvasInstance(hasAni: boolean, isActive: boolean, theme?: unknown) {\n    this.imageAnnoApp = new ImageAnnoApp(this, hasAni, isActive, theme);\n  }\n  // eslint:disable-next-line:no-any\n  public initAnnotationSVGInstance(hasAni: boolean, isActive: boolean, theme?: unknown) {\n    // this.annotationSVGInstance = new AnnotationSVGInstance(this, theme);\n  }\n  // ................................................................................................\n  public set isViewChanging(v: boolean) {\n    if (this.imageAnnoApp) {\n      this.imageAnnoApp.activeCommandController.acProperties.isViewChanging = v;\n    }\n    // if (this.annotationSVGInstance) {\n    //   this.annotationSVGInstance.activeCommandController.isViewChanging = v;\n    // }\n  }\n  public set isTouchEvent(v: boolean) {\n    if (this.imageAnnoApp) {\n      this.imageAnnoApp.activeCommandController.IsTouchEvent = v;\n    }\n    // if (this.annotationSVGInstance) {\n    //   this.annotationSVGInstance.activeCommandController.IsTouchEvent = v;\n    // }\n  }\n  public set isCustomAPI(v: boolean) {\n    if (!v) {\n      if (this.imageAnnoApp) {\n        if (this.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvasMask) {\n          this.imageAnnoApp.graphicsCoreWrapper.canvasWrapper.aCanvasMask.width = 0;\n        }\n      }\n    }\n  }\n  // ................................................................................................\n  public updateExtentSVG() {\n    // if (this.annotationSVGInstance) {\n    //   this.annotationSVGInstance.renderer.RenderUpdate();\n    // }\n  }\n  // eslint:disable-next-line:no-any\n  public pushTheme(v: unknown) {\n    if (this.imageAnnoApp) {\n      this.imageAnnoApp.geometryCommon.gcmdSupporting.pushThemeJSON(v);\n    }\n  }\n  // ................................................................................................\n  public initPost() {\n    if (this.imageAnnoApp) {\n      this.imageAnnoApp.initPost();\n    }\n  }\n  public resize(width: number, height: number) {\n    if (this.imageAnnoApp) {\n      this.imageAnnoApp.resize(width, height);\n    }\n  }\n  public Pause(t = 0) {\n    if (this.imageAnnoApp) {\n      this.imageAnnoApp.graphicsCoreWrapper.pause(t);\n    }\n  }\n  public resume() {\n    if (this.imageAnnoApp) {\n      this.imageAnnoApp.graphicsCoreWrapper.resume();\n    }\n  }\n  public mouseEventController(e: MouseEventData) {\n    this.updateEventLog(e);\n    if (this.imageAnnoApp) {\n      this.imageAnnoApp.mouseEventController(e);\n    }\n    if (this.sketch) {\n      this.sketch.mouseEventController(e);\n    }\n  }\n  public keyboardEventController(k: KeyboardEventData) {\n    this.updateEventLog(k);\n    if (this.imageAnnoApp) {\n      this.imageAnnoApp.activeCommandController.activeCommand.keyboardEventController(k);\n    }\n  }\n  public keyboardEventControllerFromDocument(k: KeyboardEventData) {\n    this.updateEventLog(k);\n    if (this.imageAnnoApp) {\n      this.imageAnnoApp.activeCommandController.activeCommand.keyboardEventControllerFromDocument(k);\n    }\n  }\n  public touchEventController(t: TouchEventDataList) {\n    this.updateEventLog(t);\n    if (this.imageAnnoApp) {\n      this.imageAnnoApp.activeCommandController.activeCommand.touchEventController(t);\n    }\n  }\n  public render(ctx: CanvasRenderingContext2D) {\n    if (this.imageAnnoApp) {\n      this.imageAnnoApp.renderer.render(ctx);\n    }\n  }\n  public destroy() {\n    if (this.imageAnnoApp) {\n      this.imageAnnoApp.destroy();\n    }\n    if (this.sketch) {\n      this.sketch.destroy();\n    }\n  }\n  public pushAction(v: string | { type: ActionType | string; payload: unknown }) {\n    // console.log('in', v);\n    if (this.imageAnnoApp) {\n      this.imageAnnoApp.pushAction(v);\n    }\n    if (this.sketch) {\n      this.sketch.pushAction(v);\n    }\n  }\n  // public pushActionTyped(a: { type : ACTION_TYPE | string; payload: unknown }) {\n  //   // { type: ActionTypeEnum; payload: unknown }\n  //   if (this.imageAnnoApp) {\n  //     this.imageAnnoApp.io.stateProcessingAnnotation.pushActionTyped(a);\n  //   }\n  // }\n  // eslint:disable-next-line:no-any\n  private updateEventLog(e: unknown) {\n    if (this.imageAnnoApp && !this.imageAnnoApp.activeCommandController.acProperties.isHiddenLog // &&\n      // this.annotationCanvasInstance.uiWrapper\n    ) {\n      // this.annotationCanvasInstance.uiWrapper.log.log.textEvent = e.CLICK_TYPE;\n    }\n  }\n}\n"],"names":["IOData","constructor","content","font","this","IOGeoVec","sx","sy","sz","IOGeometry","id","type","isSelected","isOver","isHidden","renderStyle","nodes","styles","data","pushNode","vs","i","length","push","x","y","z","pushData","GeometryBase","CollisionComponent","geo","neighborShapes","numOrder","offset","isVisited","isFixed","isRenderable","colA","colB","colC","cVec","NVector3","_minVec","_maxVec","isCollided","isCollidable","geoCollided","undefined","vec","reset","numVisit","isCollapse","updateBBox","minVec","v","maxVec","updateByScale","styleComponent","width","height","update","render","ctx","scene","annotationInstance","implementations","app","INSPECTION","fillStyle","beginPath","rect","closePath","fill","Inspector","host","showStatus","pos","arc","text","isTransform","fillText","scale","scaleMap","numNeighbors","collision","AGeometryBase","super","renderer","transformation","interaction","isFill","isGhost","isTransformValue","needEmitRemoveByBlackhole","isPinValue","isRemove","isHoverValue","isHoverPre","isGeoPos","isSelectedValue","isSelectable","isMovableValue","isDraggable","isDrag","isLeave","isHiddenValue","isHiddenPre","isAniAccel","isAniEasing","isCapturedValue","isMovedValue","isDrop","isInsideExtent","needEmit","needEmitHoverPost","isUndo","isGrayColor","enableEditValue","visibilityValue","isUnderConstruction","visTrajector","trajectoryVecs","typeSub","needBlackhole","zoomDisX","zoomDisY","tVec","r","hasSound","isZoomStart","hasPopupValue","hasPopupPre","hasGhostPopup","ghostPopupOffset","popup","hashColor","inspector","scaleForRender","isRenderCollapse","timePopupDelay","vecSelectedSnapping","disableValue","sizeValue","Size","textLeaderlineValue","vecsHistory","showPopupStackTimer","addGeometry","origin","getUUID","getHashColor","initScale","getNode","getArea","Number","MAX_SAFE_INTEGER","toJSON","p","isSelectedByWindow","isInsideOfVecs","isSelectedByCrossing","isInsideOfVecsByCrossing","isMouseInsideSnapFrom","io","eventListenerAnnotation","hideStack","size","isMovable","isHover","visibility","textLeaderline","t","textLeaderlinePost","removeLeaderline","updateColor","c","updateLeaderlineSnap","tor","isPin","isCaptured","isEditiable","isMove","disable","hasPopup","getNodePopup","getBoundary","updateActiveCursor","showPopupSummary","activeCommandController","needPopup","document","createElement","style","position","zIndex","backgroundColor","model","modelViewWrapper","div","appendChild","GType","n","top","left","clearTimeout","setTimeout","showPopupStack","getVecs","hidePopUpSummary","parentNode","tOverPopupSummary","removeChild","hidePopupStack","needSnapping","getDistance","getVecForSnapping","move","activateEasing","e","ac","easing","accelerating","findClosestNode","renderPre","scaleGlobal","setDash","updateBoundingBox","mouseDoubleClick","outExtent","inExtent","updateTheme","updateStyle","s","updateStyleCustom","acProperties","activateMapScale","mapScale","setScaleLocal","value","scaleLocal","graphicsCoreWrapper","renderForce","updateScaleByZoomLevel","isScaleDynamicRender","isNaN","tDown1","tDown2","removeByBlackhole","isMoveUpdate","updatePopup","updateHoverPost","needCollisionDetection","renderPost","customization","themeCurrent","nPoint","emitHoverPostStack","compareTwoVectors","initVecsHistory","deepCopy","updateVecsHistory","shift","goToBlackhole","updatePostTransformation","fromJSON","g","dummy","getDistanceByArray","blackhole","remove","mouseLeftClick","mouseRightClick","mouseUp","emitAddStack","addGeometryStack","hoverPostStack","list","APointBase","radius","rOrigin","rTarget","isMid","isLineNetwork","edges","graph","isPointMid","weightLeft","weightRight","isAniUp","addBasePoint","init","canvasWrapper","aCanvas","canvasLoopController","level","updateScreenVecForPan","getParentType","distance","Math","sqrt","addEdge","indexOf","removeEdge","capture","plus","isMouseInside","getLog","toString","getLogDOM","hide","translateByMouseEventData","preX","preY","leaderline","v2","translate","url","toJson","getIOGeometry","visTrajectory","updateDivPos","InterpolateColor","tOpacityA","tOpacityB","colorInterpolatedValue","_opacity","colorInterpolated","interpolateColor","updateVauleNormalized","interpolationNum","needFocus","properties","timeTransitionA","col","linearColorInterpolation","getArray","colorA","b","a","timeTransitionB","colorB","opacity","Timer","incrementTimePopupSummary","tUp","dt","tOver","updatePopupSummery","RendererComponent","timer","_RendererComponent","scaleScreenByRatioImageSize","lineCap","Linecap","appCoreWrapper","appControllerStatus","mode","InteractionMode","pressESC","geometryCommon","gcmdSupporting","toScreenVecOnCropping","draw","shape","node","nodeMidHover","numericalMotion","easeOutElastic2","isSelectedSole","nodeMidHoverForArrow","sizeMid","state","themeColorId","nodeHover","nodeStart","nodeSelected","tSelectedSole","LineTypeId","ThemeColorId","NColor","hex2rgba","rgb2Hex","_r","_g","_b","_a","rgnaStringValue","updateByRGBA","updateString","normaliz","toRBGA_String","RenderStyle","rs","theme","cols","rPoint","_colorFillFirst","fillStyleFirstArray","_colorFillSecond","fillStyleSecondArray","_lineWidth","lineWidth","initInterpolation","desaturationValue","polyline","_colorStrokeFirst","strokeStyleFirstArray","_colorStrokeSecond","strokeStyleSecondArray","initInterpolationStroke","isDarkBG","arrow","styleCustom","colorRgba","polygon","colsStroke","colsFill","freehand","theOpacity","other","_lineCap","_url","_dash","_size","desaturateVaule","rgbaHueSaturationLightness","colorInterpolatedString","colorFill","colorFillHover","colorStroke","colorStrokeHover","dash","iconAsset","addIcon","State","TitleColor","lineTypeId","Continuous","StyleComponent","renderStyleNode","isCustom","tempColorRgba","tempFillRgba","isSameStyle","_StyleComponent","geoHost","renderStyleOrigin","renderStyleOpposite","updateStyleForNode","shiftNodeStyle","show","APoint","static","listAPoint","j","pts","temp","w","isDeepCopy","getNodeFromScreenPos","aEdges","isConnected","nodeID","_isSelectedSole","initComponent","addAPoint","addNode","getSharedNode","ee","dis","p0","p1","splice","removeAPolylineEdge","makeUnique","add_AEdge","pGraph","m","capturePT","mergeTwoEdge","otherAA","otherBB","pm","deepRemove","ne","checkMinPt","computeCenterVec","pressKey","ioGeo","transformStack","removeByAttachedShape","removeBasePoint","removeAPoint","removeGeometry","translateForCurvedPolyline","pressCtrlKey","splitPointbyNewVec","translateForLineMidPoint","Capture","pressShift","pl","splitMidPointbyNewVec","checkIsCurved","np","splitEdge","moveMidPt","initRenderTheme","isConstraint","textAlign","constraintTargetDistance","vecs","showUnit","dimension","renderLength","renderTotalArea","renderTotalLength","renderPostGeometryConstraint","renderPostGeometry","offscreenRender","lineDashOffset","setLineDash","strokeStyle","moveTo","lineTo","stroke","renderConstraintTargetDistance","renderConstraintTargetDistancePercentage","renderPolyline","renderMidVec","isCurvedPolyline","renderPolygon","line","polylineHover","ves","area","polygonHover","updateMidVec","l","vecMid","offscreenRenderPolygon","offscreen","polygonOffScreen","ctxOffscreen","updateRenderStylePolyline","updateRenderStylePolylineNode","APolylineWrapper","listAPolylineWrapper","count","cl","findAtPoint","getNodeFromJSON","addPT","IsSelectable","construction","removePT","cancel","goToACMode","ioWrapper","eventInteraction","isEnableZoomByDoubleClick","isSmartSelectionWhenDrawing","cGeo","gcmdProcessing","getLine","isClosed","isDone","drawShadow","done","relatedVecs","mPts","constraintTargetArea","vecSelected","vecsBound","isPan","_constraintTargetDistancePercentage","_constraintTargetDistance","initPolyline","addAPolylineWrapper","updateScreenVec","updatePan","updateZoom","toFixed","isColse","checkDistance","len","distanceMouseWithTwoVecs","isMouseInsideByOffScreen","hasSamePtWtithCapture","xo","yo","translateForTextLeaderline","removeGeometryStack","removeAPolylineWrapper","getLength","sum","abs","getGeoArea","constraintTargetDistancePercentage","out","getVecsFromDivision","geoVec","geoDis","get1KMLatLongGeoUnit","scVec","toScreen","scDis","v0","v1","normalize","sub","getVecsFromNumber","getDivideByNum","forEach","computeVec","computeBoundingVecs","midVec","computeMidPts","getCenterVecFromVecs","getMinMaxVecFromVecs","computeMidPT","mp","mv","ng","selectionStack","hoverStack","removeAllPopup","renderTotalLengthInput","isPanning","split","updateRenderStylePolygon","updateRenderStylePolygonNode","APolygonWrapper","listAPolygonWrapper","IsTouchEvent","doneByTouch","doneByMouseClick","mouseDown","initComponentPolygon","initPolygon","addAPolygonWrapper","removeAPolygonWrapper","Dimension","geometryBase","numToFixed","renderDimTotal","lineDim","renderLengthCircle","renderTotalAreaCircle","renderLengthRect","renderTotalAreaRect","renderLengthCurve","renderTotalLengthCurve","renderRemainLengthByValue","remain","renderTotalAreaCurve","InteractionComponent","isRotate","isMouseInsidePt","isMouseInsideCPMid","isMouseInsideCP","vecRotationHandler","isInsideEllipse","vecsCP","vecSelectedCp","isHoverDuplicatedVecs","paramsEditing","croppingMaskParams","updateActiveMouseCursor","setMouseCursorMidCP","setMouseCursorCP","activeMouseCursor","setActiveCursor","Cursor","setActiveCursorDrag","toleranceSnapping","checkAttachedTextleaderline","hasLeaderline","attachedShape","updateVecsCP","updateRotationAbsolute","extentChanging","isConstraintRatio","toScreenVecsOnCropping","cv","ellipseHover","enableRotate","renderRotationHandler","ellipse","point","centerPointCircle","renderBoundingBox","renderCP","renderPostGeometryOffScreen","ellipseOffScreen","globalAlpha","updateRotationHandler","PI","AccentColor1","color","activeColorController","activeColor","updateRenderColorPolygon","updateRenderColorPolygonNode","updateRenderStylePolygonCustom","updateRenderStylePolygonNodeCustom","output","TransformationComponent","_TransformationComponent","anglePre","angle","translateByMouseEventDataNode","rotatingShape","translateCPByMouseEventData","updateTextleaderlineVec","atan2","xOff","yOff","computeConstraintRatio","translatePt","widthOffset","heightOffset","angleRelative","rotateVecsLoal","cptToWorld","moveVecs","rotateVecs","pV","crossProduct","dirV","offV","unitize","ratio","resizeConstraintRatio","newRatio","getRatioByNewWidth","getRatioByNewHeight","ACircleWrapper","getRectByVecs","getBoundingByVecs","xx","yy","updatePos","gcmdSelecting","deSelectAllObjects","getRect","swap","initVecsCP","computeRecPts","initShape","addACircleWrapper","nv0","nv1","getRelatedVec","IsHiddenChildren","updateVecsBySnapping","index","removeACircle","Error","IsRenderable","bool","CheckAttachedTextleaderline","mouse","rectangleHover","rectangle","rectangleOffScreen","ARectangleWrapper","addARectangleWrapper","removeARectangleWrapper","APolylineEdge","pt","weight","cp","getControlPoints","drawSpline","x0","y0","x1","y1","x2","y2","d01","pow","fa","fb","cPoints","cps","weights","curve","edgeCurveQuadraticHover","curveQuadratic","curveQuadraticArrowOffScreen","pg","arrayVertexs","arrayWeight","arrayControlPoint","isCurved","detectionTolerance","curveTolerance","needBend","IsHidden","IsHover","Visibility","IsSelected","getClosePt","e0","e1","reBuildConnection","computeCurve","computeVertex","computeWeight","computeControlPoint","checkIsSnapStraight","isMouseInsideByCurve","isInsideFirstAndLastCurves","getOtherPt","removeFromParent","getCenVec","renderPostHover","isPath","drawSplineHover","drawLineHover","drawLine","isHiddenLog","edgePolylineLineTo","edgePolylineHover","shadowMidPointForBending","vertexs","ii","concat","getDistance2","ShadowNode","isRender","initStyle","updateRenderColorPolylineNode","ShadowMidNode","nodeMidStart","APolylineGraphShadow","constraintLength","ps","psMid","MouseVec","isConstraintDrawing","updateRenderColorPolyline","mmp","removeVecsWithinDis","getVecsVis","add","sn","addMid","mouseMove","undo","listAPolylineGraphShadow","pop","renderPLine","renderNode","vm","polylineShadow","polygonShadow","updateProjection","renderHoverEffect","imageAnnoApp","elasticScale","outlineHoverColorRGBAString","updateRenderStylePolylineCustom","updateRenderStylePolylineNodeCustom","APolylineGraphWrapper","listAPolylineGraphWrapper","sp","slice","getPolyline","autoClosing","getPolygonbyVecs","isScreen","torVisMidPt","vecOthers","vecOthersCustom","checkIsClosed","computeNode","computeEdge","initPolylineGraph","addAPolylineGraphWrapper","nm","removeAndAppendEdge","es","RemovePt","pA","pB","nList","indexFistEdge","lastIndexOf","indexSecondEdge","indexInsert","removeAPolylineGraphWrapper","removeOrphanNode","updateGeometryByProjectedpos","isMouseInsideNode","resetVisitPt","translateByMouseEventDataForTextLeaderline","wrappingProjectedPosShape","pv","direction","ap","reorderEdges","safeguard","ls","isSplit","ARemove","ASelection","isWindow","vecTooltip","computeRecPtsWithMouse","addVecs","isTooltipRenderable","mouseDrag","isLasso","deSelectCaptureObjects","selecteObjectsByVecs","getBoundingVecs","selection","selectionLasso","ShortcutImplementation","keyEventController","keypress","k","sc","acWrapper","acs","shortcut","shortcutCommands","key","toUpperCase","hasCtrlKey","hasControl","hasShiftKey","hasShift","setActiveCommand","ByDeleteKey","ActiveCommandMode","activeCommand","removeAllCapturedGeoGroup","ByESCKey","cancelActiveCommand","KeyboardEventController","activeCommandCommon","shortcutImplementation","keyboardEventController","PRESS_TYPE","PressType","keydownPre","keyUpPre","keyboardEventControllerFromDocument","keydownPreFromDocument","keyUpPreFromDocument","keyCode","apiWrapper","environment","shiftLog","initViewController","PRODUCTION","shiftDash","setLevel1","setLevel2","setLevel3","setLevel4","setLevel5","setLevel6","removeAll","appProperties","compileMode","CompileMode","shiftDTMode","logCommon","download","open","shiftUnit","hasAltKey","pressAltKey","needDuplicateByAlt","currentControllerStatus","keyDown","shiftGrid","shiftMeasure","shiftMapfilter","selectAllObjects","hasMetaCommand","copySelGeo","gcmdAProcessing","pasteSelGeo","keydown","toggleBorderFeaturePolygon","snap","shiftIcon","shiftRenderShapeForRPoint","shiftScaleForRPoint","activecommandIconPoint","shiftActiveCluster","shiftScaleDynamicRender","shiftOptimizerTextleaderline","toggleDebuggerMode","keyUp","MouseEventBase","mouseEventController","mc","mouseDownPre","mouseLeftClickPre","mouseMiddleClickPre","mouseRightClickPre","mouseUpPre","mouseDoubleClickPre","mouseMovePre","mouseDragPre","mouseWheelPre","MouseEventAnnotationImage","_frameMove","screenLog","isActivateSnapping","updatePosBySnapping","mDownPos","commonEvent","stopRender","isDown","isUp","needExecuteOptimizer","clickMenu","isReturn","resetTranformation","hasMultiSel","isTextEditing","captureText","endEditingText","isDrawing","aGeo","findAtPointFromAPoint","pGeo","findAtPointFromPolygonGraph","filterNodeSelectionForMovingMultipleShapes","nodeForEdge","isClick","clickLeft","optimizer","mouseClick","deselectNeeded","browserUtility","isMobile","findAtPointByTouch","processSelectionViewerMode","updateMouseHover","pointerOutStack","emitSelections","clickMiddle","mouseMiddleClick","clickRight","rightClickOnHoverGeo","isDragging","autoSnapping","doneDragging","objectSnapping","updateGhostSnappingVec","updateActiveCursorByUp","mouseUpPost","clickDouble","updateActiveCursorByMove","moveMidPoint","moveSelectedGeo","autoSnappingTracker","captureHovered","updateActiveCursorByDrag","MouseEventController","MouseEvent","stop","isStandalone","isOutsideExtent","CLICK_TYPE","ClickType","mouseDownPost","mouseLeftClickPost","mouseMiddleClickPost","mouseRightClickPost","mouseDoubleClickPost","mouseMovePost","mouseDragPost","mouseWheelPost","posBySnapping","getPosBySnapping","theWidth","aCanvasMask","canvas","ActiveCommandCommonWrapper","mouseController","keyboardController","touchEventController","CActiveCommandNone","CActiveCommandRemove","CActiveCommandSelection","CActiveCommandSelectionRect","CActiveCommandSelectionLasso","checkCP","dx","dy","widthHalf","heightHalf","getCenterVec","renderBoundbox","centerPoint","updateCP","ACircle","R0","R1","listACircleWrapperr","R","getCircleByVecs","dim","getXYDimForCircle","getRadiusByArea","toMapConvertGeoDis","circumference","getRadiusByCircumference","getCirlceByTouch","getCircle","rTaget","vecOtherCenter","initCircle","Init","getType","r0","r1","divByVal","geoToScreen","ANGonWrapper","aPolygonFromNGon","numClick","shiftNGon","updateGeo","nNumber","r2","updateVecs","theN","trunc","Scale","updateNGonByScale","updateNGon","mouVec","getAngleByTwoVectors","angleIncrement","cos","sin","updateNStar","computeNGon","nSides","ngon","nGon","nStar","GraphCore","selVec","selMidVec","selectedVec","selVecForTextLeaderline","mouseV","mouseR","initByVec","removeSelVec","getclosestVec","theIndex","thedis","mx","my","insertMidVec","splitNodeVec","targetIndexA","targetIndexB","graphCore","GetLog","theDis","getDistanceByNum","IOComponent","ToJSON","MouseEventComponent","mouseMoveClick","updateCenVec","renderPostNodes","interactionMode","renderNodes","renderSelectedVec","renderStyleNodeSelected","shiftNodeStyleCustom","_needCtrlKey","polygonGraphResetForSplit","skipTranslationForLeaderline","isSelectedNode","APolygonGraphWrapper","getPolygon","ioComponent","mouseEventComponent","interactionComponent","transformationComponent","initGraph","addAPolygonGraphWrapper","removeAPolygonGraphWrapper","getclosestNode","findClosestVec","computeBoundingVecsAndCenterVec","renderSpline","drawControlLine","drawControPoint","APoints","curveBezierClosedHoverPolygon","curveBezierClosed","renderCurveInfill","curveBezierHoverPolyline","curveQuadraticHoverPolyline","curveBezier","curveBezierClosedFill","renderCurveInfillOffscreen","save","restore","curveBezierOffScreen","ACurve","unshift","listACurve","ep","IsCapture","getCurveByPt","getCurve","showDetails","addACurve","computeVertexDuplication","removeACurve","ALineBase","_InteractionComponent","isMouseInsideByMath","_isDash","arrowScale","isViewChanging","computeMidPoint","ptVec","preset","curveQuadraticArrow","cArrowByTranslation","isDash","updateRenderStyleArrow","updateRenderStyleArrowNode","updateStyleNode","updateRenderColorArrowCustom","updateRenderColorArrowNodeCustom","updateAccentColor","lineDash","Large","Small","convertDashEnumToArray","updateRenderStyleArrowCustom","updateRenderStyleArrowNodeCustom","AArrow","listAArrow","single","numSelectionWhenConstruction","condition","consType","p2","gType","getLineByPt","curveWeight","initAArow","addAArrow","vert","removeAArrow","CONFIG","LAB","json","TextLeaderlineDiv","wrapper","offsetForTextDiv","divTextAnchor","divText","showTextDiv","textCol","updateDiv","textleaderline","vecOffset","vUp","offsetForTextEditor","hideTextDiv","hideTextStack","getDivBaseContainer","getDivAnchor","showTextStack","focusOnTextDiv","getElementById","startEditingText","IsTextEditing","insertBefore","textOverflow","minWidth","widthMin","onmousedown","addEventListener","clientHeight","textContent","CATEXT_NODE_RENDER_TYPE","ATextLeaderlineNode","caText","CIRCLE","diaHeight","diaWidth","renderNodeDia","ATextLeaderlineNodeCircle","ATextLeaderlineNodeDia","DIAMOND","ATextLeaderlineLine","caTextNodeDia","v1Render","isMouseClick","isUpperDia","_v2","updateMidV","updateTransformationStack","mouseX","mouseY","renderLeaderLine","cAText","_isSelectedReaderline","IsSelectedReaderline","enableDrag","translateByMouseEventDataCollapse","isSideNode","LEFT","RIGHT","leadlineInteraction","nodeTargetLeaderLine","updateLeaderlineTarget","updateVecsBox","txtDiv","updateSideNodes","updateConectNodes","isSelectedReaderlineByClick","isMouseInsideDiv","snapForPoint","isMouseInsideLeaderline","isMouseInsideNodes","isInsideOfTwoVecs","offDiv","vLeft","vRight","vDown","getClosestNodeDia","contentHtmltemp","version","zoom","zoomLevel","processingUpdate","d","JSON","parse","updateStack","drawing","removeDiv","removeATextleaderlineWrapper","resetAnchorVec","RemoveLeaderline","error","ProjectionComponent","zoomDifference","contentHtmltempForHide","hasSnippet","scaleRuntime","widthRuntime","heightRuntime","v0Runtime","renderSnippet","roundedRectACTextStoryMapByWidth","hidden","findClosestNodeDia","renderLeadline","renderMarker","styleAnchorNode","ThemeRegularPoint","URL","SVG","shadowColor","shadowColorHover","shadowBlur","ThemeNumberedPoint","fontFamily","fontSize","fontColorArray","ThemeIconPoint","ThemeArrow","ThemePolyline","ThemePolygon","ThemeLeaderline","ThemeAnchorNode","ThemeHandleNode","ThemeBox","ThemeTextLeaderline","handleNode","box","anchorNode","ThemeNode","lineWidthMid","ThemeInternalProperties","pointBoundOffset","outlineHoverColorArray","maskColor","opacityHover","ThemeSelection","ThemeFreehand","ThemeObjectForStorymaps","iPoint","stringify","downloadJson","name","DownloadJSON","_State","textColor","BackgroundColor","styleLeaderline","styleHandleNode","styleBox","showVecOffset","showVecBound","showLeaderlineInfo","showLeaderlinePos","ShowVecCenter","vecCenter","textX","textY","pos0","pos1","showVecAnchor","ATextleaderlineWrapper","txt","initLeaderlineOffset","initZoomLevel","initHeightFromJSON","projection","lineWidthForCheck","numToggleTheme","_height","_heightPre","addATextleaderlineWrapper","emitTransformationStackRightNode","updateOptimizer","zoomLevelForMoving","getClosestNodeForSnapping","initSnapForPointForUndo","val","updateDivHeight","isFreehandDrawing","freeHand","freeHandbyVecs","updateRenderStyleFH","AFreehandSmartDrawing","computeVector","modelType","MLModelType","typeFreehand","isClose","Optimizer","addAFreehandSmartDrawing","checkDotProduct","vv","vvv","vvvv","vvvvv","d0","getDotProduct","d1","d2","divVecs","getPtByVs","async","dotProductProcess","FHType","dotPros","computeDotProductsWithCenter","isContainNagativeNumber","vsBySimplifyPath","dotValue","computeDotProducts","getInterpolatedArray","dotArrayForTrainSimplify","vArray","dotVecArrayForTrainSimplify","dotArrayForTrainOrigin","dotVecArrayForTrainOrigin","predictDrawingShape","dotValueInterpolated","predictionLosisticR","addon","smartDrawing","PredictByLogisticRegression","PredictByMultiClassification","getShapeFromPrediction","predictionMultiC","fromSmartDrawing","getCurveByVecs","removeAFreehandSmartDrawing","vsRendering","updateStyleByFHType","updateRenderStyleFHPolygon","updateRenderStyleFHPolygonNode","updateRenderStyleFHPolyline","updateRenderStyleFHPolylineNode","AFreehand","addAFreehand","DouglasPeucker","getPolylineByVecs","removeAFreehand","img","rotate","pointIcon","widthRender","heightRender","renderBoundary","renderControlPoint","needShadowBound","renderShadow","renderIcon","boundaryVecs","arrayCP","roundedRect","sizes","newSize","xMin","yMin","ControPoint","strokeWith","updateRenderStyleRPoint","APointIconWrapper","idBase64","src","image","listBase64","get","activeBase64ID","path","divHeight","divWidth","imgString","midHeightImg","midWidthImg","indexControPointSelected","xOffset","yOffset","centerCP","needRotation","needEmitResizeTransform","sizesDis","InitIcon","addIPoint","appendDiv","Image","getRatioByWidthHidthByHeight","computeDistanceForSnap","background","translateDiv","translateControlPointForFreeform","translateControlPointSnap","removeIPoint","drawingPresetPointSVG","pointSVG","drawingPresetPoint","vecRendering","shadowNPoint","param","Environment","pointNumberedOverBoundingByCircle","pointNumberedDragByCircle","pointSVGNormalFill","path2D","pointNumberedOverBoundingByCircleSelected","shadowNPointLight","DrawingText","renderNPointCircleOffScreen","offScreenRender","theFont","getIndex","svgNpoint","getNumberedPointSMX","renderNPointOffScreen","ICON_SIZE","updateRenderStyleNPoint","updateTextColor","updateRenderColorNPoint","updateRenderColorRPointCustom","number","toLowerCase","readableColor","APointNumberedWrapper","listNPoint","IsMouseInside","numberIndexNeeded","svgPath","Path2D","_numberIndex","_hashColorRGB","numberIndex","colString","InitComponent","addNPoint","isMouseInsideByOffScreenNumberPoint","isMouseInsideWithTolerance","tolerance","removeNPoint","pointerEvents","insideMap","pointRenderType","PointRenderType","pointRegularDragBySVGPath","shadowRPoint","pointRegularOverBoundingBySVGPathSelected","shadowRPointLight","pointRegularOverBoundingBySVGPath","rPointOffscreen","RendererComponentGeneric","renderPointA","renderPointIcon","drawingPresetPointGeneric","pointGeneric","pointGenericOverBoundingSelected","pointGenericDrag","pointGenericOverBounding","renderImg","drawImage","symbol","defaultURL","config","BASE_URL","onload","symbolType","APointRegularWrapper","listRPoint","updateIcon","imgData","iconSize","addRPoint","removeIcon","removeRPoint","sizeRattho","LARGE","MEDIUM","SMALL","renderType","CActiveCommandPoint","CActiveCommandANPointRegular","CActiveCommandANPointNumbered","CActiveCommandIcon","CActiveCommandArrow","CActiveCommandArrowDouble","CActiveCommandANCurve","doneByKeyboard","CActiveCommandANCurveClosed","CActiveCommandANFHPolyline","CActiveCommandANFHPolylineBending","CActiveCommandANFHPolygon","CActiveCommandANFHPolygonGraph","CActiveCommandANFHCurve","CActiveCommandANFHCurveClosed","CActiveANCommandRect","onMouseLeftClick","onMouseRightClick","onMouseMove","onMouseDrag","onMouseUp","CActiveANCommandCircle","CActiveANCommandCircleConstraintArea","getCircleByArea","CActiveANCommandCircleConstraintCircumference","getCircleByCircumference","CActiveANCommandPolyline","CActiveANCommandBendingPolylineGraph","CActiveANCommandPolylineConstraint","CActiveANCommandPolygon","CActiveANCommandPolygonGraph","CActiveANCommandPolygonMultiple","CActiveANCommandPolygonConstraint","CActiveCommandTextLederline","CActiveCommandANSmartDrawing","CActiveCommandANSmartDrawingDeepLearning","CActiveCommandStar","ActiveCommandProperties","unit","Unit","unitEnumInt","needPostACMode","isMarkupEnv","isShortCutActive","showTooltip","showActiveCommandChain","activateCollsion","showTooltipPoint","hasHovering","needrePositionTextLeaderLine","needHideTextLeaderLine","accentColor","isActiveCluster","_needExecuteOptimizer","_optimizerTextleaderline","OptimizerTextleaderline","_optimizerPoint","OptimizerPoint","_pressCtrlKey","_isPanning","_isZooming","_extentChanging","optimizerPoint","typePoint","optimizerTextleaderline","typeTextleaderline","isZooming","shiftRenderLoop","ActiveMouseCursor","activeCursor","initActiveCursor","acType","default","dragging","setActiveCursorHovering","hovering","activeCursorForText","creating","texting","listATextleaderlineWrapper","ActiveCursor","CursorType","set_ew_resize","set_ns_resize","set_nesw_resize","set_nwse_resize","ActiveColor","checkChanges","debounce","captureScene","setActiveColor","undoNeeded","updateColorSelGeometries","getActiveColor","updateColorStyle","ScreenLog","numLins","TextAlign","ActiveCommandController","commands","sanpValue","mNoSnap","activeBase64img","PostACMode","_postACMode","_isTouchEvent","_zoomLevelForMoving","MouseEventData","postACMode","setScaleGlobal","theAC","remapActiveCommandVersion","cancelAC","postAC","shiftCAMode","floor","resizeCanvas","getCircleFromVoice","getRectangleFromVoice","reUndoProcessing","states","reUndoProcessingStorymaps","repopulateGeometries","base64DumpIcon","action","base64","base64Processing","removeSelShape","ActionType","addBase64","activeBase64","mousePostProcess","sValue","removeByIDs","ids","removeAllShapes","removeAllGeo","imageWrapper","projectionToImageSpace","unhide","setupPolylineConstraintLength","setupPolylineConstraintLengthPercentage","disableExcept","highlight","downloadShapes","downloadTheme","pause","resume","IsRenderSkip","setScaleGraphics","absolute","GeometryAdvancedProcessing","gcmd","downloadImag","link","href","toDataURL","click","computeBoundaryFromGeos","pasteSelGeoInPlace","copyPasteGeo","dp","vc","Add","getCanvas","GeometryCommonProcessing","divHost","geometryList","moveSelectedGeoPreSmartVersionBetweenGeometryAndNodes","listAPolygonGraphWrapper","mult","geoVSecond","toMap","setCaptureHovered","getRandomRGB","listHashColor","getShapeByHashCol","colTarget","pickColorsOffscreen","getColorDistance","pickColorOffscreen","listBasePoint","listARectangleWrapper","xRes","yRes","getImageData","pixel","getSelGeo","getGeoById","getRPointtById","updateIconPoint","duplicateByDragging","geos","theGeo","getSelectedGeoIDs","ioGeos","removeBeforeDump","removeAllCapturedGeo","removeAllDiv","resetGeometryList","getGeoByIOGeometry","initConnectionTextleaderlines","geometries","tempTarget","childElementCount","lastChild","HTMLDivElement","includes","listIPoint","listALog","removeCapturedTextLeaderline","DumpByIGeometriesFromImageDataModel","DumpByIGeometries","FromJSON","captureMultiple","ioGeometries","jsonData","setSizeRPoint","setRenderTypePoint","closestGeo","pointList","needOnlyArea","areas","findIndexOfMin","hasSelectedOvered","reorderNumberedPoints","num","hasMultisel","shapesRemove","shapesTransformation","isActive","removeSelectedShapesByBlackhole","redo","getCapturedGeometries","emitAction","captureForEasing","GeometryCommonSelecting","selectionsStackByID","getAllGeometries","geometry","GeometryCommonSupporting","checkBoundIntersection","pushThemeJSON","themeRenderStyle","updateCanvasSize","canvasView","outVecs","nv","GeometryCommon","Addon","initAddon","_scalePoint","_renderTypePoint","_iconPoint","toggleClusteringPoint","setOptimizerClusteringPoint","toggleInspector","payload","bindFromDisplay","toggleMapfilter","stateBool","toggleActiveCommandChain","toggleDrawingTooltips","toggleGrid","toggleMeasure","togglTooltip","togglActiveCommandChain","shiftSnapping","shiftUnitDisplay","alog","isShow","toggleCollisionDetection","activateOffScreen","aCanvasOffScreen","deactivateOffScreen","shiftBlackholeRender","shiftBlackholePos","smartEvasion","APIWrapper","IconAsset","icons","tempImageID","initIcon","property","iconBase64","addIconAsset","getIconByURL","removeIconAsset","crossOrigin","ThemeRenderStyle","shiftStyle","shiftTheme","shiftThemeNumberLayerOrdering","numLayer","queueTheme","defaultRPoint","defaultNPoint","getRegularPointAGSM","getRegularPointSMX","computeTheme","shiftEnvironment","updateRPointPath","widthNew","heightNew","updateNPointPath","themes","updateThemeBGType","updateThemeInteraction","updateMaskColor","updateSelection","graphics","buildPropertiesData","buildThemeDataShape","buildThemeDataAsync","theTheme","sizeNode","sizeNodeMid","iconPoint","regularPoint","numberedPoint","fontColor","svgForCanvas","outlineHoverColor","ShortcutCommand","shortcutProperties","control","Shortcut","assets","Object","keys","Customization","AbstractCanvasDynamic","ctxView","canvasOffScreen","loopNum","needRenderloop","deltaTime","frameRate","isLoop","_log","requestAnimationFrameRender","initPre","getContext","globalCompositeOperation","Deltatime","CanvasLoopController","loop","before","performance","now","updateFPS","requestAnimationFrame","clear","timerForStop","after","log","logOut","initOffscreen","resize","clearRect","renderSetLevel4","delta","last","timeLastRender","msLoop","window","min","Date","numStopFrame","_level","_stop","numRender","AbstractCanvasOffScreen","hostCanvas","offScreenCtx","instance","ACanvas","xOffCurrent","yOffCurrent","xOffPre","yOffPre","anchor","zoomFactor","zoomFactorPre","zoomFactorCurrent","div3d","dropRate","then","interval","frameVisTimer","theDate","asyncSafeGuard","time","_isRenderSkip","_frameSkip","frameSkip","initPost","rendererActive","imageSmoothingEnabled","clearPost","rendererWrapper","destroy","doPause","doResume","ACanvasMask","_maskColor","_width","renderMask","ACanvasOffScreen","getOffscreenRenderer","getColorByPos","CanvasWrapper","RendererWrapper","GraphicsCoreWrapper","delimiter","EventListenerAnnotation","numOfCommand","shiftOptionStack","command","modificationStack","geoData","APP","Apps","othersIDs","initGhostStack","showGhostPopupStack","mapping","hideGhostPopupStack","stringData","getActionString","actionType","addBase64Stack","base64Stack","selectBase64","StateProcessingAnnotation","pushActionTyped","pushAction","doAction","actionIn","substring","geoList","obj","acMode","mappingCommand","datad","iconList","dataBase64","geoms","Map","shapes","set","convertShapeToIOGeometry","arrayPolygonMultiple","pgs","POLYGON_MULTIPLE","parseFloat","idsDisableExcept","getProjectedBoundingVec","projectedXMin","projectedYMin","projectedXMax","MIN_SAFE_INTEGER","projectedYMax","proX","proY","geom","map","vertex","getVecforGraphicApp","long","lat","ele","proZ","IOAnnotationInstance","stateProcessingAnnotation","Renderer","tInit","tLeave","ColorHex","theSize","sizeTrash","imgTrash","easeInElastic","val0","removeGeo","exceptionByLeaderline","updateTime","Blackhole","needRender","hasCapture","hover","hoverPre","distanceForDetection","offX","removeForce","isInside","listRemove","AGhostObjectSnapping","vecGhostSnapping","snapping","circleBG","renderGhostGeo","rp","getVecFromAPolylineGraph","polylineByVecGhost","getVecFromArrow","getVecFromAPolygonGraph","polygonByVecGhost","tv1","tv2","nodePts","checkMidPtPolylineBending","checkLeaderlineOffset","aGhostSnapping","SnappingProcessor","isSnappingToCircle","selVecSnap","isSnappingToRectangle","donotSnapForCircle","donotSnapForCircleRect","isSnappingItself","geoOther","isAllowSnappingPointToPoint","capturedGeo","isAllowSnappingNodeToNodeInSameShape","isAllowMidNodePolylineBending","ObjectSnapping","frameValue","snappingProcessor","isMouseUp","updateSnapping","captureGeo","pointBase","needStop","aPointByPolylineGraph","TextleaderlineOptimizerBase","AgentBaseRectOptimizer","needUpdateComputeCollision","needOptimization","isDoneOptimization","collisionDetectionCompute","collisionDetection","reposition","listLeaderline","txt0","txt1","AABBintersect2D","CollisionBased","optimizerTextleaderlineByCollision","optimizerTextleaderlineByCollisionCostBased","NoneOptimizer","optimizerTextleaderlineByNone","ZoomBased","optimizerTextleaderlineByZoom","TextleaderlineOptimizer","activeOptimizer","_type","PointOptimizerBase","Graph","updatePoints","buildConnectivity","initGeometry","buildGraph","addClusterByGeometries","postUpdateCollisionBasedonGraph","graphcs","needDecompose","splitClusters","postMergeCluster","outGraphList","listPoints","outList","ptList","queue","current","clustersNPoint","updateByQueue","clustersRPoint","cluster","addPost","clusterGraph","clusters","postMergeClusterCompute","merge","Interaction","PointCluster","boundingBoxMin","boundingBoxMax","gridResolution","tempVecGridList","tempGeoGridList","xNum","yNum","grid","buildGrid","buildSubCluster","removeCluster","gridList","theY","geoMat","theX","getCellAtPoint","tv","round","updateTimer","drawingPresetClustering","Grid","rx","ry","xInterval","yInterval","cells","initGrid","cellList","Cell","xI","yI","vecRender","isRenderableValue","pointClusters","pushGeometry","GridBased","PointOptimizer","textleaderlineOptimizer","pointOptimizer","initForceTimer","EnvAnnotationMap","renderEnv","listAFreehandSmartDrawing","listAFreehand","HEIGHT","numGeo","numAPoint","debugText","DrawingPresetOffscreen","ctxTemp","getImgDataFromHTMLImg","polygonEndOffScreen","quadraticCurveTo","x3","y3","bezierCurveTo","PolygonOffScreenByVecs","polygonOffScreenByVecsOfVecs","pointRegularDragOffscreen","boundingOffset","ImagePreset","has","DrawingPresetArea","polygonEnd","polygonHoverEnd","ellipseLocalTint","outerRadius","gradient","createRadialGradient","addColorStop","arcTo","isUnder","DrawingPresetCluster","fillColor","DrawingPresetCurve","vec0","vec1","scaleRender","degree","getRotationByWorldCoordinateByTwo","depth","arrowByVecNode","curveBezierClose","px","py","DrawingPresetFreeHand","ColorBlending","DrawingPresetLine","over","lineTrajectory","mouseVec","gtype","textBaseline","setTransform","DrawingPresetNGon","DrawingPresetNode","selected","DrawingPresetPoint","needBoundRender","hasAni","xPos","yPos","BrowserType","pointRegularOverBoundingBySVGPathEdgeSupport","OffsetX","OffsetY","pointRagularSVGRender","pointRagularSVGRenderEdgeSupport","hasStroke","pointRegularDragGhost","hex2CanvasColor","rgbByA","scaleFactor","pointNumberedDragByCircleGhost","theHeight","easingScale","ctxShape","filter","DrawingPresetPointGeneric","pointRegularSVGRender","pointRegularSVGRenderEdgeSupport","pointIconHover","pointIconSelected","DrawingPresetPointSVG","pathSVG","pointSVGRender","DrawingPresetPolyline","edgePolyline","DrawingPresetSelection","DrawingPresetSnapping","DrawingPresetText","needResetDash","ShapePreset","Draw","env","isFetchTheme","unHover","frameUpdateValue","frameSkipValue","_updateProjectionForce","_needFocus","NumericalMotion","development","canvasOff","bindContextForOffscreen","saveDrawingGeometries","updatePre","console","updatePost","updateProjectionForce","isHoverOrisSelected","renderCroppingArea","SceneState","isModifiedImage","globalScale","SceneManager","_SceneManager","history","pushAdapter","currentIndex","ParamsEditing","isInsideCropShape","FrameShapeType","projectedPos","updateDataCropping","drawOffscreen","updateBGStyle","isCropGraphics","toggleCropGraphics","cutOutContextByShape","Scene","listANGonWrapper","preCapture","sceneManager","useModifiedImage","toCroppedImg","toOriginalImg","api","emitDataToExpressImageData","emitUndoRedoHistory","getCurrentState","addANGonWrapper","removeANGonWrapper","addALog","removeALog","ImageAnnoApp","Implementations","sketch","initAnnotationCanvasInstance","initAnnotationSVGInstance","isTouchEvent","isCustomAPI","updateExtentSVG","pushTheme","Pause","updateEventLog"],"sourceRoot":""}