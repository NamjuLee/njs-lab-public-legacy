"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[21947],{21947:(t,i,s)=>{s.r(i),s.d(i,{ImageEditor:()=>g,Solution:()=>p});class e{constructor(t,i){this.core=void 0,this.div=void 0,this.canvas=void 0,this.ctx=void 0,this.isActive=!1,this.log=void 0,this.isViewChanging=!1,this.loopNum=0,this.needRenderloop=!0,this.ablePan=!0,this.mousePre=[0,0],this.canvasOut=void 0,this.ctxOut=void 0,this.loopNeeded=!1,this.core=t,this.div=i,this.loopNeeded=!1,this.init(),this.loopInit()}init(){const t=document.createElement("canvas"),i=document.createElement("canvas");if(t&&i){this.canvas=t,this.canvas.width=this.div.clientWidth,this.canvas.height=this.div.clientHeight,this.div.append(this.canvas),this.canvasOut=i,this.canvasOut.style.backgroundColor="#999999",this.canvasOut.style.border="5px",this.ctxOut=this.canvasOut.getContext("2d"),this.core.divHost.append(this.canvasOut);const s=this.canvas.getContext("2d");s&&(this.ctx=s,this.isActive=!0,this.initEvent())}}initEvent(){this.canvas.addEventListener("keydown",(t=>{})),this.canvas.addEventListener("keyup",(t=>{})),this.canvas.addEventListener("mousedown",(t=>{this.core.controller.mouseInteraction.mouseDown(t)}),!1),this.canvas.addEventListener("mouseup",(t=>{this.core.controller.mouseInteraction.mouseUp(t)}),!1),this.canvas.addEventListener("mousemove",(t=>{this.core.controller.mouseInteraction.mouseMove(t)}),!1),this.canvas.addEventListener("wheel",(t=>this.core.controller.mouseInteraction.mouseWheel(t,t.deltaY)),!1),this.canvas.addEventListener("mouseout",(t=>{this.core.controller.mouseInteraction.mouseUp(t)}),!1),this.canvas.addEventListener("touchstart",(t=>this.core.controller.touchInteraction.touchstart(t)),!1),this.canvas.addEventListener("touchmove",(t=>this.core.controller.touchInteraction.touchmove(t)),!1),this.canvas.addEventListener("touchcancel",(t=>this.core.controller.touchInteraction.touchcancel(t)),!1),this.canvas.addEventListener("touchend",(t=>this.core.controller.touchInteraction.touchend(t)),!1)}capture(){const t=new Image;return t.crossOrigin="anonymous",t.src=this.canvasOut.toDataURL(),t}loopInit(){this.loop()}resize(){this.canvas.width=this.div.clientWidth,this.canvas.height=this.div.clientHeight}loop(){if(requestAnimationFrame((()=>{this.loop()})),this.loopNum++<130){let t=performance.now();this.renderPre(this.ctx);let i=performance.now();this.log="level: , total frames: ".concat(this.loopNum++," (FPS: ), a loop took: ").concat((i-t).toFixed(2)," ms to execute.")}}clear(t){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}renderForce(){this.loopNum=0}renderPre(t){this.isActive&&(this.clear(this.ctx),this.render(t))}render(t){}}const h=(t,i,s,e)=>Math.sqrt((t-s)*(t-s)+(i-e)*(i-e)),o=function(t,i,s,e,h){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.5;t.beginPath(),t.arc(i+e-o,s-h+o,o,4.71,6.28,!1),t.arc(i+e-o,s+h-o,o,0,1.57,!1),t.arc(i-e+o,s+h-o,o,1.57,3.14,!1),t.arc(i-e+o,s-h+o,o,3.14,4.71,!1),t.closePath(),t.strokeStyle="#000000",t.fillStyle="#ffffff",t.fill(),t.stroke()};let r,n;!function(t){t.GetImage="GetImage"}(r||(r={})),function(t){t.Canvas="Canvas",t.WebGL2="WebGL2",t.WebGPU="WebGPU",t.WebAssembly="WebAssembly"}(n||(n={}));class c{constructor(t){this.id=-1,this.x=100,this.y=100,this.width=200,this.height=200,this.xOffGuid=0,this.yOffGuid=0,this.r=19,this.tOpacityA=0,this.tOpacityB=0,this.fillStyle="rgba(220, 220, 220, 1)",this.fillStyleHover="rgba(220, 220, 220, 0.5)",this.strokeStyle="rgba(200, 200, 200, 1)",this.strokeStyleInner="rgba(200, 200, 200, 1)",this.t=0,this.cv=[0,0],this.core=void 0,this.core=t,this.xOffGuid=this.width/3,this.yOffGuid=this.height/3}linearColorInterpolation(t,i){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;const e=[];for(let h=0;h<t.length;++h){const o=t[1]+(i[h]-t[h])*s;e.push(o)}return e}ColorInterpolation(){let t=0;this.core.controller.isHover?(this.tOpacityA+=.05,this.tOpacityB=0,t=this.tOpacityA):(this.tOpacityA=0,this.tOpacityB+=.05,t=this.tOpacityB)}render(t){this.ColorInterpolation(),this.core.controller.isHover?t.fillStyle=this.fillStyleHover:t.fillStyle=this.fillStyle,t.beginPath(),t.rect(0,0,t.canvas.width,this.y),t.rect(0,this.y+this.height,t.canvas.width,t.canvas.height),t.rect(0,0,this.x,t.canvas.height),t.rect(this.x+this.width,0,t.canvas.width,t.canvas.height),t.fill()}renderPost(t){t.lineWidth=1,t.lineDashOffset=this.t,t.setLineDash([4,1]),t.beginPath(),t.rect(this.x,this.y,this.width,this.height),t.strokeStyle=this.strokeStyle,t.stroke(),t.beginPath();for(let i=1;i<3;++i)t.moveTo(this.x+this.xOffGuid*i,this.y),t.lineTo(this.x+this.xOffGuid*i,this.y+this.height),t.moveTo(this.x,this.y+this.yOffGuid*i),t.lineTo(this.x+this.width,this.y+this.yOffGuid*i);t.stroke(),t.setLineDash([]);o(t,this.x,this.y,3,3),o(t,this.x+this.width,this.y,3,3),o(t,this.x+this.width,this.y+this.height,3,3),o(t,this.x,this.y+this.height,3,3),o(t,this.x+.5*this.width,this.y,12,3),o(t,this.x+.5*this.width,this.y+this.height,12,3),o(t,this.x,this.y+.5*this.height,3,12),o(t,this.x+this.width,this.y+.5*this.height,3,12),this.t+=.15}translate(t,i){this.x+t<0||this.x+this.width+t>this.core.canvs.canvas.width||this.y+i<0||this.y+this.height+i>this.core.canvs.canvas.height||(0===this.id?(this.x+=t,this.y+=i,this.width-=t,this.height-=i):1===this.id?(this.width+=t,this.y+=i,this.height-=i):2===this.id?(this.width+=t,this.height+=i):3===this.id?(this.x+=t,this.width-=t,this.height+=i):(this.x+=t,this.y+=i),this.xOffGuid=this.width/3,this.yOffGuid=this.height/3,this.cv[0]=this.x+.5*this.width,this.cv[1]=this.y+.5*this.height)}isHover(t,i){return h(t,i,this.x,this.y)<this.r?(this.core.controller.isHover=!0,this.id=0,!0):h(t,i,this.x+this.width,this.y)<this.r?(this.core.controller.isHover=!0,this.id=1,!0):h(t,i,this.x+this.width,this.y+this.height)<this.r?(this.core.controller.isHover=!0,this.id=2,!0):h(t,i,this.x,this.y+this.height)<this.r?(this.core.controller.isHover=!0,this.id=3,!0):this.x<t&&this.x+this.width>t&&this.y<i&&this.y+this.height>i?(this.id=-1,this.core.controller.isHover=!0,!0):(this.id=-1,this.core.controller.isHover=!1,!1)}}class a{constructor(t){this.core=void 0,this.t=0,this.core=t}render(t){if(this.core.img){t.save();const i=new DOMMatrix([1,0,0,1,0,0]),s=this.core.img.width,e=this.core.img.height,h=this.core.frame.cv[0]/this.core.img.width,o=this.core.frame.cv[1]/this.core.img.height;t.setTransform(i.translate(s*h,e*o).rotate(180*this.core.controller.rotation).scale(this.core.controller.zoomLevel).translate(s*(1-h),e*(1-o))),t.drawImage(this.core.img,-this.core.img.width,-this.core.img.height),t.restore()}this.captureImage(),this.core.frame.render(t),this.core.frame.renderPost(t),t.beginPath();const i=this.core.controller.touchInteraction.touchPre[0],s=this.core.controller.touchInteraction.touchPre[1];t.arc(i,s,20,0,6.28),t.closePath();const e=1-this.t;t.fillStyle="rgba{255, 255, 255, ".concat(e,"}"),t.fill(),t.restore(),this.t+=.025}captureImage(){this.core.canvs.ctxOut.drawImage(this.core.canvs.canvas,-this.core.frame.x,-this.core.frame.y)}}class l{constructor(t){this.controller=void 0,this.down=!1,this.touchPre=[0,0],this.zoom=1,this.controller=t}touchstart(t){this.controller.core.renderer.t=0;var i=this.controller.core.canvs.canvas.getBoundingClientRect();const s=t.targetTouches[0].pageX-i.left,e=t.targetTouches[0].pageY-i.top;this.touchPre[0]=s,this.touchPre[1]=e,this.controller.pointDown(s,e)}touchmove(t){var i=this.controller.core.canvs.canvas.getBoundingClientRect();const s=t.targetTouches[0].pageX-i.left,e=t.targetTouches[0].pageY-i.top;this.touchPre[0]=s,this.touchPre[1]=e,this.controller.pointDrag(s,e)}touchcancel(t){console.log("touchcancel",t)}touchend(t){this.controller.pointUp(-1,-1)}}class d{constructor(t){this.controller=void 0,this.controller=t}mouseDown(t){this.controller.pointDown(t.offsetX,t.offsetY)}mouseUp(t){this.controller.pointUp(t.offsetX,t.offsetY)}mouseWheel(t,i){this.controller.zoom(t.deltaY)}mouseMove(t){this.controller.down?this.controller.pointDrag(t.offsetX,t.offsetY):this.controller.pointMove(t.offsetX,t.offsetY)}}class v{constructor(t){this.core=void 0,this.mouseInteraction=void 0,this.touchInteraction=void 0,this.isHover=!1,this.down=!1,this.mousePre=[0,0],this.zoomLevel=1,this.rotation=0,this.mouseDragRect=(t,i)=>{const s=t-this.mousePre[0],e=i-this.mousePre[1];this.core.frame.translate(s,e),this.core.canvs.canvasOut.width=this.core.frame.width,this.core.canvs.canvasOut.height=this.core.frame.height,this.mousePre[0]=t,this.mousePre[1]=i},this.mouseDragPan=(t,i)=>{this.pan(t,i)},this.core=t,this.touchInteraction=new l(this),this.mouseInteraction=new d(this)}import(t){this.reset()}reset(){}rotate(t){this.rotation=t,this.postUpdate()}pointDown(t,i){this.down=!0,this.core.frame.isHover(t,i),this.mousePre[0]=t,this.mousePre[1]=i,this.postUpdate()}pointUp(t,i){this.down=!1,this.core.controller.isHover=!1,this.postUpdate()}pointMove(t,i){this.core.frame.isHover(t,i),this.mousePre[0]=t,this.mousePre[1]=i,this.postUpdate()}pointDrag(t,i){this.core.controller.isHover?this.mouseDragRect(t,i):this.mouseDragPan(t,i),this.postUpdate()}zoom(t){t<0?this.zoomLevel+=.19*this.zoomLevel:this.zoomLevel-=.19*this.zoomLevel,this.postUpdate()}pan(t,i){}postUpdate(){this.core.canvs.renderForce()}}class m{constructor(t){this.param=void 0,this.divHost=void 0,this.div=void 0,this.frame=void 0,this.renderer=void 0,this.canvs=void 0,this.controller=void 0,this.ctx=void 0,this.img=void 0,this.param=t;const i=document.getElementById(this.param.id);i&&(this.divHost=i,this.divHost.style.backgroundColor="#ffffff",this.initApp(),this.initCanvas(),this.importImage("https://raw.githubusercontent.com/NamjuLee/data/master/img/bg/zoom-James-River-Kayaking.jpg"))}initApp(){this.frame=new c(this),this.renderer=new a(this),this.controller=new v(this)}initCanvas(){const t=document.createElement("div");t.style.width="400px",t.style.height="400px",t.style.margin="50px",t.style.overflow="hidden",t.style.backgroundColor="#ffffff",this.div=t,this.divHost.append(t),this.canvs=new e(this,t),this.canvs.render=t=>{this.renderer.render(t)}}importImage(t){const i=new Image;i.crossOrigin="anonymous",i.src=t,i.style.pointerEvents="none",i.onload=()=>{this.canvs.canvas.width=i.width,this.canvs.canvas.height=i.height,this.div.style.width=i.width+"px",this.div.style.height=i.height+"px",this.img=i}}}class u{static Init(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SandBox";new u(t).Dummy()}constructor(t){this.implementation=void 0,this.param=void 0,this.param={id:t,ui:!0},this.implementation=new m(this.param),this.param.ui}Dummy(){}}class g{static Init(t){new g(t).Dummy()}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SandBox";this.implementation=void 0,this.implementation=new u(t)}Dummy(){}}class p{constructor(t){this.divHost=void 0,this.divHost=document.getElementById(t),g.Init(t)}destroy(){if(this.divHost)try{for(;this.divHost.firstChild;)this.divHost.removeChild(this.divHost.firstChild)}catch(t){console.error("Error in destroy method:",t)}else console.warn("divHost is undefined in destroy method")}}}}]);
//# sourceMappingURL=21947.4c861d95.chunk.js.map