"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[97673],{97673:(t,i,s)=>{s.r(i),s.d(i,{Demo60ImageProcessor:()=>C,Solution:()=>_});s(59008);var e=s(458);let o;!function(t){t.NORMAL="NORMAL",t.GAUSSIAN_BLUR_1="GAUSSIAN_BLUR_1",t.GAUSSIAN_BLUR_2="GAUSSIAN_BLUR_2",t.GAUSSIAN_BLUR_3="GAUSSIAN_BLUR_3",t.BOX_BLUR="BOX_BLUR",t.TRIANGLE_BLUR="TRIANGLE_BLUR",t.EMBOSS="EMBOSS",t.UNSHARPEN="UNSHARPEN",t.SHARPENESS="SHARPENESS",t.SHARPEN="SHARPEN",t.EDGE_DETECTION_1="EDGE_DETECTION_1",t.EDGE_DETECTION_2="EDGE_DETECTION_2",t.EDGE_DETECTION_3="EDGE_DETECTION_3",t.EDGE_DETECTION_4="EDGE_DETECTION_4",t.EDGE_DETECTION_5="EDGE_DETECTION_5",t.EDGE_DETECTION_6="EDGE_DETECTION_6",t.SOBEL_HORIZONTAL="SOBEL_HORIZONTAL",t.SOBEL_VERTICAL="SOBEL_VERTICAL",t.PREVIT_HORIZONTAL="PREVIT_HORIZONTAL",t.PREVIT_VERTICAL="PREVIT_VERTICAL"}(o||(o={}));const h={NORMAL:[0,0,0,0,1,0,0,0,0],GAUSSIAN_BLUR_1:[.045,.122,.045,.122,.332,.122,.045,.122,.045],GAUSSIAN_BLUR_2:[1,2,1,2,4,2,1,2,1],GAUSSIAN_BLUR_3:[0,1,0,1,1,1,0,1,0],BOX_BLUR:[.111,.111,.111,.111,.111,.111,.111,.111,.111],TRIANGLE_BLUR:[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625],EMBOSS:[-2,-1,0,-1,1,1,0,1,2],UNSHARPEN:[-1,-1,-1,-1,9,-1,-1,-1,-1],SHARPENESS:[0,-1,0,-1,5,-1,0,-1,0],SHARPEN:[-1,-1,-1,-1,16,-1,-1,-1,-1],EDGE_DETECTION_1:[-.125,-.125,-.125,-.125,1,-.125,-.125,-.125,-.125],EDGE_DETECTION_2:[-1,-1,-1,-1,8,-1,-1,-1,-1],EDGE_DETECTION_3:[-5,0,0,0,0,0,0,0,5],EDGE_DETECTION_4:[-1,-1,-1,0,0,0,1,1,1],EDGE_DETECTION_5:[-1,-1,-1,2,2,2,-1,-1,-1],EDGE_DETECTION_6:[-5,-5,-5,-5,39,-5,-5,-5,-5],SOBEL_HORIZONTAL:[1,2,3,0,0,0,-1,-2,-1],SOBEL_VERTICAL:[1,0,-1,2,0,-2,1,0,-1],PREVIT_HORIZONTAL:[1,1,1,0,0,0,-1,-1,-1],PREVIT_VERTICAL:[1,0,-1,1,0,-1,1,0,-1]};class n{constructor(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.pixels=void 0,this.bitmap=void 0,this.bitmapResult=void 0,this.height=-1,this.width=-1,this.isGray=!1,this.isGray=i,this.bitmap=t,this.pixels=[],this.height=t.height,this.width=t.width;let s=0,o=-1,h=0;if(this.isGray)for(let n=0;n<this.bitmap.data.length;n+=4){h++%this.bitmap.width===0?(s=0,o++):s++;let t=new a(this.bitmap.data[n+0],this.bitmap.data[n+1],this.bitmap.data[n+2],this.bitmap.data[n+3]),i=e.mK.RGBtoGray(t.R,t.G,t.B),l=a.FromArgb(255,Math.floor(i),Math.floor(i),Math.floor(i)),d=new r(this,s,this.height-o-1,l);this.pixels.push(d)}else for(let e=0;e<this.bitmap.data.length;e+=4){e%this.bitmap.width===0?(s=0,o++):s++;let t=new a(this.bitmap.data[e+0],this.bitmap.data[e+1],this.bitmap.data[e+2],this.bitmap.data[e+3]),i=new r(this,s,this.height-o-1,t);this.pixels.push(i)}this.InitGridNeighbor()}InitGridNeighbor(){for(let t=0;t<this.height;++t)for(let i=0;i<this.width;++i){let s=t*this.width+i,e=this.pixels[s];i>0&&t<this.height-1&&(e.npix.push(this.pixels[s+this.width-1]),e.UP_LEFT=this.pixels[s+this.width-1]),t<this.height-1&&(e.npix.push(this.pixels[s+this.width]),e.UP_MIDDLE=this.pixels[s+this.width]),i<this.width-1&&t<this.height-1&&(e.npix.push(this.pixels[s+this.width+1]),e.UP_RIGHT=this.pixels[s+this.width+1]),i>0&&(e.npix.push(this.pixels[s-1]),e.MIDDLE_LEFT=this.pixels[s-1]),i<this.width-1&&(e.npix.push(this.pixels[s+1]),e.MIDDLE_RIGHT=this.pixels[s+1]),i>0&&t>0&&(e.npix.push(this.pixels[s-this.width-1]),e.DOWN_LEFT=this.pixels[s-this.width-1]),t>0&&(e.npix.push(this.pixels[s-this.width]),e.DOWN_MIDDLE=this.pixels[s-this.width]),i<this.width-1&&t>0&&(e.npix.push(this.pixels[s-this.width+1]),e.DOWN_RIGHT=this.pixels[s-this.width+1])}}update(t){this.bitmap=t;let i=0;for(let s=0;s<this.bitmap.data.length;s+=4)this.pixels[i].color.R=this.bitmap.data[s+0],this.pixels[i].color.G=this.bitmap.data[s+1],this.pixels[i].color.B=this.bitmap.data[s+2],this.pixels[i].color.A=this.bitmap.data[s+3],i++}computeConvolution(t){for(let i of this.pixels)i.ComputeByKernelList(t)}getBitmap(){this.bitmapResult=new ImageData(this.bitmap.width,this.bitmap.height);let t=0;for(let i=0;i<this.bitmapResult.data.length;i+=4){let s=this.pixels[t].colNew;this.bitmapResult.data[i+0]=s.R,this.bitmapResult.data[i+1]=s.G,this.bitmapResult.data[i+2]=s.B,this.bitmapResult.data[i+3]=s.A,t++}return this.bitmapResult}}class r{constructor(t,i,s,o){this.pm=void 0,this.p0=void 0,this.p1=void 0,this.p=void 0,this.width=.5,this.height=.5,this.temp=0,this.i=void 0,this.j=void 0,this.UP_LEFT=void 0,this.UP_MIDDLE=void 0,this.UP_RIGHT=void 0,this.MIDDLE_LEFT=void 0,this.MIDDLE_RIGHT=void 0,this.DOWN_LEFT=void 0,this.DOWN_MIDDLE=void 0,this.DOWN_RIGHT=void 0,this.val=0,this.npix=[],this.color=void 0,this.colNew=void 0,this.pm=t,this.color=a.FromArgb(255,o.R,o.G,o.B),this.colNew=a.FromArgb(255,o.R,o.G,o.B),this.p=new e.h9(i,s,0)}ComputeByKernelList(t){let i=0,s=0,e=0,o=0;void 0!==this.UP_LEFT&&(s+=this.UP_LEFT.color.R*t[0],e+=this.UP_LEFT.color.G*t[0],o+=this.UP_LEFT.color.B*t[0],i+=t[0]),void 0!==this.UP_MIDDLE&&(s+=this.UP_MIDDLE.color.R*t[1],e+=this.UP_MIDDLE.color.G*t[1],o+=this.UP_MIDDLE.color.B*t[1],i+=t[1]),void 0!==this.UP_RIGHT&&(s+=this.UP_RIGHT.color.R*t[2],e+=this.UP_RIGHT.color.G*t[2],o+=this.UP_RIGHT.color.B*t[2],i+=t[2]),void 0!==this.MIDDLE_LEFT&&(s+=this.MIDDLE_LEFT.color.R*t[3],e+=this.MIDDLE_LEFT.color.G*t[3],o+=this.MIDDLE_LEFT.color.B*t[3],i+=t[3]),s+=this.color.R*t[4],e+=this.color.G*t[4],o+=this.color.B*t[4],i+=t[4],void 0!==this.MIDDLE_RIGHT&&(s+=this.MIDDLE_RIGHT.color.R*t[5],e+=this.MIDDLE_RIGHT.color.G*t[5],o+=this.MIDDLE_RIGHT.color.B*t[5],i+=t[5]),void 0!==this.DOWN_LEFT&&(s+=this.DOWN_LEFT.color.R*t[6],e+=this.DOWN_LEFT.color.G*t[6],o+=this.DOWN_LEFT.color.B*t[6],i+=t[6]),void 0!==this.DOWN_MIDDLE&&(s+=this.DOWN_MIDDLE.color.R*t[7],e+=this.DOWN_MIDDLE.color.G*t[7],o+=this.DOWN_MIDDLE.color.B*t[7],i+=t[7]),void 0!==this.DOWN_RIGHT&&(s+=this.DOWN_RIGHT.color.R*t[8],e+=this.DOWN_RIGHT.color.G*t[8],o+=this.DOWN_RIGHT.color.B*t[8],i+=t[8]),i<=0&&(i=1),this.colNew=a.FromArgb(255,this.CutColorValue(s/i),this.CutColorValue(e/i),this.CutColorValue(o/i))}ComputeKernelWeight(t){let i=0;for(let s of t)i+=s;return i<=0?1:i}CutColorValue(t){return t<0?0:255<t?255:Math.floor(t)}}class a{static FromArgb(t,i,s,e){return new a(i,s,e,t)}constructor(t,i,s,e){this.R=void 0,this.G=void 0,this.B=void 0,this.A=void 0,this.R=t,this.G=i,this.B=s,this.A=e}}class l{constructor(t,i){this.renderer=void 0,this.div=void 0,this.canvas=void 0,this.ctx=void 0,this.isActive=!1,this.scale=.5,this.translation=[0,0],this.translationZoom=[0,0],this.deltaTime=void 0,this.canvasLoopController=void 0,this.log=void 0,this.isViewChanging=!1,this.loopNum=0,this.needRenderloop=!0,this.ablePan=!0,this.pause=!1,this.renderer=t,this.div=i,this.Init()}Init(){const t=document.createElement("canvas");if(t){this.canvas=t,this.canvas.width=this.div.clientWidth,this.canvas.height=this.div.clientHeight,this.div.append(this.canvas);const i=this.canvas.getContext("2d");i&&(this.ctx=i,this.isActive=!0)}this.deltaTime=new e.gk,this.canvasLoopController=new e.NI(60)}LoopInit(){this.translation[0]=.5*this.ctx.canvas.width,this.translation[1]=.5*this.ctx.canvas.height,this.SetLevel4(),this.initBinder(this.ctx),this.Loop()}Loop(){let t=performance.now();if(this.deltaTime.UpdateFPS(),this.canvasLoopController.level>3){if(6===this.canvasLoopController.level)requestAnimationFrame((()=>{this.Loop()})),this.RenderPre(this.ctx);else if(5===this.canvasLoopController.level)this.isViewChanging,requestAnimationFrame((()=>{this.Loop()})),this.RenderPre(this.ctx);else if(4===this.canvasLoopController.level){if(this.isViewChanging,requestAnimationFrame((()=>{this.Loop()})),this.canvasLoopController.stop)return;this.RenderPre(this.ctx),this.canvasLoopController.TimerForStop()}}else 1===this.canvasLoopController.level&&this.isViewChanging||this.RenderPre(this.ctx);let i=performance.now();this.log="level:  ".concat(this.canvasLoopController.level,", total frames: ").concat(this.loopNum++," (FPS: ").concat(this.deltaTime.frameRate.toFixed(0),"), a loop took: ").concat((i-t).toFixed(2)," ms to execute.")}SetLevel1(){this.canvasLoopController.level=1,this.Loop()}SetLevel2(){this.canvasLoopController.level=2,this.Loop()}SetLevel3(){this.canvasLoopController.level=3,this.Loop()}RenderSetLevel4(){this.canvasLoopController.stop=!0}SetLevel4(){this.canvasLoopController.Reset(),setTimeout((()=>{this.canvasLoopController.level=4,this.Loop()}),500)}SetLevel5(){this.canvasLoopController.Reset(),setTimeout((()=>{this.canvasLoopController.level=5,this.Loop()}),500)}SetLevel6(){this.canvasLoopController.stop=!1,this.canvasLoopController.Reset(),setTimeout((()=>{this.canvasLoopController.level=6,this.Loop()}),500)}Clear(t){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}Zoom(t){t.wheel<0?this.scale+=.09*this.scale:this.scale-=.09*this.scale}RemapByZoom(t){return t.x=(t.xs-this.translation[0])/this.scale,t.y=(t.ys-this.translation[1])/this.scale,t}Pan(t){if(!this.ablePan)return;const i=t.xs-t.preXs,s=t.ys-t.preYs;this.translation[0]+=i,this.translation[1]+=s}RenderForce(){this.canvasLoopController.stop=!1}RenderPre(t){if(this.isActive){this.Clear(this.ctx),this.ctx.save(),this.ctx.translate(this.translation[0],this.translation[1]),this.ctx.scale(this.scale,this.scale);for(let i=-10;i<10;++i)for(let s=-10;s<10;++s)t.beginPath(),t.fillStyle="rgba(255, 0, 0, 0.9)",t.arc(10*i,10*s,2,0,2*Math.PI),t.closePath(),t.fill();this.RenderBinder(t),this.ctx.restore()}}initBinder(t){}RenderBinder(t){}}let d;!function(t){t.LEFT="LEFT",t.MIDDLE="MIDDLE",t.RIGHT="RIGHT",t.WHEEL="WHEEL",t.DRAG="DRAG",t.DRAG_LEFT="DRAG_LEFT",t.DRAG_MIDDLE="DRAG_MIDDLE",t.DRAG_RIGHT="DRAG_RIGHT",t.MOVE="MOVE",t.DOUBLE="DOUBLE",t.UP="UP",t.DOWN="DOWN",t.DOWN_MIDDLE="DOWN_MIDDLE",t.DOWN_RIGHT="DOWN_RIGHT"}(d||(d={}));class c{constructor(){this.x=-1,this.y=-1,this.z=-1,this.preX=-1,this.preY=-1,this.preZ=-1,this.xs=-1,this.ys=-1,this.preXs=-1,this.preYs=-1,this.yGLPicking=void 0,this.command=void 0,this.CLICK_TYPE=d.MOVE,this.isDown=!1,this.isDoubleClick=!1,this.isMove=!1,this.pressedShift=!1,this.pressedAlt=!1,this.pressedCtrl=!1,this.wheel=0,this.preWheel=0,this.isActive=!0,this.native=void 0}DeepCopy(){let t=new c;return t.x=this.x,t.y=this.y,t.z=this.z,t.preX=this.preX,t.preY=this.preY,t.preZ=this.preZ,t.xs=this.x,t.ys=this.y,t.preXs=this.preXs,t.preYs=this.preYs,t.pressedAlt=this.pressedAlt,t.pressedShift=this.pressedShift,t.pressedCtrl=this.pressedCtrl,t.isDoubleClick=this.isDoubleClick,t.isDown=this.isDown,t.isMove=this.isMove,t.wheel=this.wheel,t.preWheel=this.preWheel,t.yGLPicking=this.yGLPicking,t.CLICK_TYPE=this.CLICK_TYPE,t.command=this.command,t.native=this.native,t}}class v{constructor(){this.mouseInteractionUI=void 0,this.mouseEventDataPre=new c,this.isEnable=!0,this.clickCount=0,this.click=!1,this.prevent=!1,this.delay=250,this.timer=void 0,this.down=!1,this.e=void 0,this._stopPropagation=!1}InitNativeMouseEvent(t){t.onclick=t=>{this.prevent=!1,this.timer=setTimeout((()=>{this.prevent||this.MouseClick(t),this.prevent=!1}),this.delay)},t.ondblclick=t=>{clearTimeout(this.timer),this.prevent=!0,this.MouseDoubleClick(t)},t.onmousedown=t=>{this.MouseDown(t)},t.onmouseup=t=>{this.MouseUp(t)},t.onmousemove=t=>{this.MouseMove(t)},t.addEventListener("wheel",(t=>this.MouseWheel(t,t.deltaY)))}MouseDown(t){this.click=!0,this.down=!0;let i=this.CommonEventBuilder(t);i.CLICK_TYPE=d.DOWN,i.isDown=!0,this.MouseEvenEmitting(i)}MouseClick(t){if(!this.click)return;let i=this.CommonEventBuilder(t);0===t.button?i.CLICK_TYPE=d.LEFT:1===t.button?i.CLICK_TYPE=d.MIDDLE:2===t.button&&(i.CLICK_TYPE=d.RIGHT),this.MouseEvenEmitting(i)}MouseDoubleClick(t){let i=this.CommonEventBuilder(t);i.CLICK_TYPE=d.DOUBLE,this.MouseEvenEmitting(i)}MouseDrag(t){this.click=!1,this.prevent=!0;let i=this.CommonEventBuilder(t);i.CLICK_TYPE=d.DRAG,i.isDown=!0,1===t.buttons?i.CLICK_TYPE=d.DRAG:4===t.buttons?i.CLICK_TYPE=d.DRAG_MIDDLE:2===t.buttons&&(i.CLICK_TYPE=d.DRAG_RIGHT),this.MouseEvenEmitting(i)}MouseMove(t){if(this.down)return void this.MouseDrag(t);let i=this.CommonEventBuilder(t);i.CLICK_TYPE=d.MOVE,i.isDown=!0,this.prevent=!0,this.MouseEvenEmitting(i)}MouseUp(t){this.down=!1,this.click=!0;let i=this.CommonEventBuilder(t);i.CLICK_TYPE=d.UP,i.isDown=!1,this.MouseEvenEmitting(i)}MouseWheel(t,i){let s=this.CommonEventBuilder(t);s.wheel=i,s.CLICK_TYPE=d.WHEEL,this.MouseEvenEmitting(s)}CommonEventBuilder(t){let i=new c;return i.preXs=this.mouseEventDataPre.xs,i.preYs=this.mouseEventDataPre.ys,i.preX=this.mouseEventDataPre.x,i.preY=this.mouseEventDataPre.y,i.pressedShift=t.shiftKey,i.pressedAlt=t.altKey,i.pressedCtrl=t.ctrlKey,i.xs=t.offsetX,i.ys=t.offsetY,i.preWheel=this.mouseEventDataPre.wheel,i.wheel=0,i.native=t,this.mouseEventDataPre=i,this.e=i,i}get stopPropagation(){return this._stopPropagation}set stopPropagation(t){t?this._stopPropagation=t:setTimeout((()=>{this._stopPropagation=t}),500)}MouseEvenEmitting(t){this.MouseEventEmittingForViewController(t),this._stopPropagation||this.MouseEventEmittingBinder(t)}MouseEventEmittingForViewController(t){this.mouseInteractionUI&&this.mouseInteractionUI.MouseInteractionMenu(t)}MouseEventEmittingBinder(t){}}class E{constructor(t){this.renderer=void 0,this.mouse=new e.h9(0,0),this.renderer=t}MouseEventController(t){const i=t.DeepCopy();i.x=t.xs,i.y=t.ys,this.renderer.canvas.RenderForce(),t.CLICK_TYPE!==e.uh.LEFT?t.CLICK_TYPE!==e.uh.MIDDLE?t.CLICK_TYPE!==e.uh.DOWN_RIGHT?t.CLICK_TYPE!==e.uh.DOUBLE?t.CLICK_TYPE!==e.uh.MOVE?t.CLICK_TYPE!==e.uh.DRAG?t.CLICK_TYPE!==e.uh.DOWN?t.CLICK_TYPE!==e.uh.WHEEL?t.CLICK_TYPE!==e.uh.UP||this.MouseUpPre(t):this.MouseWheelPre(t):this.MouseDownPre(t):this.MouseDragPre(t):this.MouseMovePre(t):this.MouseDoubleClickPre(t):this.MouseRightClickPre(t):this.MouseMiddleClickPre(t):this.MouseLeftClickPre(t)}MouseDown(t){}MouseDownPre(t){this.MouseDown(t)}MouseLeftClick(t){}MouseLeftClickPre(t){this.MouseLeftClick(t)}MouseMiddleClick(t){}MouseMiddleClickPre(t){this.MouseMiddleClick(t)}MouseRightClick(t){}MouseRightClickPre(t){this.MouseRightClick(t)}MouseUp(t){}MouseUpPre(t){this.MouseUp(t)}MouseDoubleClick(t){}MouseDoubleClickPre(t){this.MouseDoubleClick(t)}MouseMove(t){}MouseMovePre(t){this.MouseMove(t)}MouseDrag(t){}MouseDragPre(t){this.mouse.x=t.x,this.mouse.y=t.y,this.renderer.canvas.Pan(t),this.MouseDrag(t)}MouseWheel(t){}MouseWheelPre(t){this.renderer.canvas.Zoom(t),this.MouseWheel(t)}pushActionFromPulldown(t){t.split("@")[0]}}class p{constructor(t){this.divUI=void 0,this.divConsole=void 0,this.divLocalMain=void 0,this.canvasRanderer=void 0,this.canvasRanderer=t,this.divLocalMain=this.canvasRanderer.hostDiv,this.initUI()}initUI(){const t=document.createElement("div");if(!t)return;this.divUI=t,this.divLocalMain.append(t),this.divUI.style.marginLeft="10px",this.divUI.style.width="100%";const i=document.createElement("button");i.textContent="toggle",i.onclick=()=>{this.canvasRanderer.implmentation.toggle()},this.divUI.append(i);let s=document.createElement("input");s.oninput=()=>{const t=+s.value;console.log(t);let i=o.NORMAL;0===t?i=o.NORMAL:1===t?i=o.BOX_BLUR:2===t?i=o.EDGE_DETECTION_1:3===t?i=o.EDGE_DETECTION_2:4===t?i=o.EDGE_DETECTION_3:5===t?i=o.EDGE_DETECTION_4:6===t?i=o.EDGE_DETECTION_5:7===t?i=o.EDGE_DETECTION_6:8===t?i=o.EMBOSS:9===t?i=o.GAUSSIAN_BLUR_1:10===t?i=o.GAUSSIAN_BLUR_2:11===t?i=o.GAUSSIAN_BLUR_3:12===t?i=o.PREVIT_HORIZONTAL:13===t?i=o.PREVIT_VERTICAL:14===t?i=o.SHARPEN:15===t?i=o.SHARPENESS:16===t?i=o.SOBEL_HORIZONTAL:17===t?i=o.SOBEL_VERTICAL:18===t?i=o.TRIANGLE_BLUR:19===t&&(i=o.UNSHARPEN),this.divConsole.innerHTML="Convolutional filter: "+i,this.canvasRanderer.implmentation.setFilter(i)},s.type="range",s.min="0",s.max="19.0",s.step="1.0",s.value="0",this.divUI.append(s);let e=document.createElement("input");e.oninput=()=>{const t=+e.value;console.log(t)},e.type="range",e.min="1",e.max="10.0",e.value="4",this.divUI.append(e),this.divConsole=document.createElement("p"),this.divConsole&&(this.divUI.append(this.divConsole),this.divConsole.style.width="max-content",this.divConsole.innerHTML="Convolutional filter: Normal")}}class m{constructor(t,i){this.canvas=void 0,this.ctx=void 0,this.implmentation=void 0,this.img=void 0,this.imgDataOrigin=void 0,this.pixelMapFilter=void 0,this.implmentation=t,this.img=i,this.canvas=document.createElement("canvas"),this.canvas.width=this.img.width,this.canvas.height=this.img.height,this.ctx=this.canvas.getContext("2d"),this.ctx.drawImage(this.img,0,0,this.img.width,this.img.height),this.imgDataOrigin=this.ctx.getImageData(0,0,this.img.width,this.img.height)}setFilter(t){this.pixelMapFilter=new n(this.imgDataOrigin),this.pixelMapFilter.computeConvolution(h[t]);const i=this.pixelMapFilter.getBitmap();this.ctx.putImageData(i,0,0,0,0,this.img.width,this.img.height)}render(t){t.drawImage(this.canvas,.5*-this.img.width,.5*-this.img.height,this.img.width,this.img.height)}}class u{constructor(t,i){this.canvas=void 0,this.ctx=void 0,this.implmentation=void 0,this.img=void 0,this.imgDataOrigin=void 0,this.pixelMapFilter=void 0,this.video=void 0,this.width=200,this.height=200,this.kernel=h.NORMAL,this.implmentation=t,this.img=new Image;const s=300,e=300;this.width=s,this.height=e,this.canvas=document.createElement("canvas"),this.canvas.width=s,this.canvas.height=e,this.ctx=this.canvas.getContext("2d");const o=document.createElement("video");o.id=this.implmentation.hostDiv.id+"camera",o.setAttribute("playsinline",""),o.setAttribute("autoplay",""),o.setAttribute("muted",""),o.setAttribute("width","".concat(s,"px")),o.setAttribute("height","".concat(e,"px")),o.style.width="".concat(s,"px"),o.style.height="".concat(e,"px"),navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then((t=>{o.srcObject=t})).catch((t=>{console.debug("something went wrong...",t)})),this.video=o,o&&i&&i.appendChild(o),this.pixelMapFilter=new n(this.ctx.getImageData(0,0,this.width,this.height))}setFilter(t){this.kernel=h[t]}render(t){this.video&&(this.ctx.drawImage(this.video,0,0,this.video.width,this.video.height),this.pixelMapFilter.update(this.ctx.getImageData(0,0,this.video.width,this.video.height)),this.pixelMapFilter.computeConvolution(this.kernel),this.imgDataOrigin=this.pixelMapFilter.getBitmap(),this.ctx.putImageData(this.imgDataOrigin,0,0),t.drawImage(this.canvas,.5*-this.video.width,.5*-this.video.height,this.video.width,this.video.height))}}class D{constructor(t){this.hostDiv=void 0,this.imageProcessor=void 0,this.videoProcessor=void 0,this.num=0,this.hostDiv=t}async init(t){const i=await async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://raw.githubusercontent.com/NamjuLee/data/master/img/bg/zoom-James-River-Kayaking.jpg";return new Promise(((i,s)=>{const e=new Image;e.src=t,e.crossOrigin="Anonymous",e.onload=()=>i(e),e.onerror=()=>s(new Error("cannot loade the img by url..."))}))}(),s=i;this.imageProcessor=new m(this,s),this.videoProcessor=new u(this,this.hostDiv)}toggle(){this.num++}setFilter(t){this.num%2===0?this.videoProcessor.setFilter(t):this.imageProcessor.setFilter(t)}render(t){this.num%2===0?this.videoProcessor&&this.videoProcessor.render(t):this.imageProcessor&&this.imageProcessor.render(t)}}class L{static Init(){new L(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SandBox")}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SandBox";this.id=void 0,this.hostDiv=void 0,this.div=void 0,this.canvas=void 0,this.activeCommandController=void 0,this.mouseInteraction=void 0,this.implmentation=void 0,this.view=void 0,this.id=t,this.Init(),window.app=this}Init(){const t=document.getElementById(this.id);if(!t)return;this.hostDiv=t;const i=document.createElement("div");i&&(this.div=i,this.div.style.width="400px",this.div.style.height="300px",this.div.style.background="#dddddd",this.hostDiv.append(this.div)),this.implmentation=new D(this.hostDiv),this.canvas=new l(this,i),this.canvas.initBinder=t=>this.InitRender(t),this.canvas.RenderBinder=t=>this.Render(t),this.activeCommandController=new E(this),this.mouseInteraction=new v,this.InitEventListener(i),this.view=new p(this),this.canvas.LoopInit(),this.canvas.SetLevel6()}InitEventListener(t){this.mouseInteraction.InitNativeMouseEvent(t),this.mouseInteraction.MouseEventEmittingBinder=t=>{this.activeCommandController.MouseEventController(t)},window.addEventListener("resize",(t=>{this.Resize(t,this.hostDiv.clientWidth,this.hostDiv.clientHeight)}))}Resize(t,i,s){}InitRender(t){this.implmentation.init(t)}Render(t){this.implmentation.render(t)}}class I{static Init(){new I(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SandBox",1)}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SandBox",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.id=void 0,this.renderer=void 0,this.hostDiv=void 0,this.div=void 0,this.version=1,this.id=t,this.version=i,this.Init()}Init(){if(1===this.version)this.renderer=new L(this.id)}}class C{static Init(t){new C(t).Dummy()}constructor(){new I(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SandBox")}Dummy(){}}class _{constructor(t){this.divHost=void 0,this.divHost=document.getElementById(t),C.Init(t)}destroy(){if(this.divHost)try{for(;this.divHost.firstChild;)this.divHost.removeChild(this.divHost.firstChild)}catch(t){console.error("Error in destroy method:",t)}else console.warn("divHost is undefined in destroy method")}}}}]);
//# sourceMappingURL=97673.3e809ef0.chunk.js.map