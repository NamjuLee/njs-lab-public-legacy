"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[72707,60026,20587,6503],{31001:(t,s,i)=>{i.d(s,{L:()=>e});class e{constructor(t,s){this.firebaseConfig={apiKey:"AIzaSyA1yKg85WGZoshbk8xR23cXr3SwpqXVgIc",authDomain:"njs-data.firebaseapp.com",projectId:"njs-data",storageBucket:"njs-data.appspot.com",messagingSenderId:"635991152770",appId:"1:635991152770:web:722f5356e0d14cea50fc9b"},this.getData=t=>{let s=t.val();for(let i in s);},this.getError=t=>{console.error(t)}}sendData(t){}}},60026:(t,s,i)=>{i.r(s),i.d(s,{CanvasSD:()=>e});class e{constructor(t){this.app=void 0,this.ctx=void 0,this.canvas=void 0,this.vs=[],this.isDown=!1,this.radius=3,this.div=void 0,this.app=t;const s=document.getElementById("classText");s&&(this.div=s),this.canvas=document.createElement("canvas"),this.app.host&&(this.app.host.appendChild(this.canvas),this.canvas.width=300,this.canvas.height=300),this.canvas.style.background="#ffffff",this.canvas.style.margin="20px",this.canvas.style.zIndex="1";const i=this.canvas.getContext("2d");null!==i&&(this.ctx=i),this.app.Init(this.ctx),this.InitEvent(),this.Loop()}InitEvent(){this.canvas.onmousedown=t=>{this.isDown=!0,this.vs=[]},this.canvas.onmouseup=t=>{this.isDown=!1;const s=this.app.implementation.smartDrawing.Predict(this.vs);this.div.innerHTML="class: "+s},this.canvas.onmousemove=t=>{this.isDown&&(this.vs.push([t.offsetX,t.offsetY]),this.Loop())}}Loop(){if(this.UpdateBG(),0!==this.vs.length){this.ctx.lineWidth=2,this.ctx.fillStyle="rgba(250, 50, 15, 0.2)",this.ctx.strokeStyle="rgba(250, 50, 15, 0.5)",this.ctx.beginPath(),this.ctx.moveTo(this.vs[0][0],this.vs[0][1]);for(let t=1;t<this.vs.length;++t)this.ctx.lineTo(this.vs[t][0],this.vs[t][1]);this.ctx.stroke();for(let t of this.vs)this.ctx.beginPath(),this.ctx.arc(t[0],t[1],this.radius,0,6.28),this.ctx.closePath(),this.ctx.fill()}}Clear(){this.vs=[],this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.UpdateBG()}UpdateBG(){this.ctx.beginPath(),this.ctx.rect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.closePath(),this.ctx.fillStyle="#ddaadd",this.ctx.fill()}}},6503:(t,s,i)=>{i.r(s),i.d(s,{SmartDrawing:()=>n});var e=i(65812),o=i(37415),a=i(31001);class n{constructor(){this.modelLogisticRegression=void 0,this.modelMultiClassification=void 0,this.divText=void 0,this.firebaseWrapper=void 0,this.AppendDiv(),this.LoadModelFromPublic(),console.log(e.version),this.firebaseWrapper=new a.L("smartDrawing",this.callback)}callback(t){let s=t.val();console.log("callback -------- get data",s);for(let i in s)console.log(i,s[i])}AppendDiv(){const t=document.getElementById("main"),s=document.createElement("div");t&&s&&(this.divText=s,t.insertBefore(this.divText,null),this.divText.style.marginLeft="20px")}async LoadModelFromJsons(){}async LoadModelFromPublic(){let t="https://raw.githubusercontent.com/NamjuLee/data/master/smart-drawing/model/modelLogisticRegression0/model.json";this.modelLogisticRegression=await this.LoadModelFromPath(t),t="https://raw.githubusercontent.com/NamjuLee/data/master/smart-drawing/model/modelMultiClassification0/model.json",this.modelMultiClassification=await this.LoadModelFromPath(t)}async LoadModelFromPath(t){return await e.loadLayersModel(t)}PredictByLogisticRegression(t){if(void 0!==this.modelLogisticRegression)return(0,e.tidy)((()=>{const s=(0,e.tensor2d)([t]),i=this.modelLogisticRegression.predict(s).dataSync();return this.PredictionPostProcessingLogisticRegression(i[0])}));console.error("no model loaded")}PredictByMultiClassification(t){if(void 0!==this.modelMultiClassification)return(0,e.tidy)((()=>{const s=e.tensor2d([t]),i=this.modelMultiClassification.predict(s);{const t=Array.from(i.dataSync()),s=this.GetIndexBySortDescending(t),e=[];for(let i of s){const s=t[i],o="class:"+n.CLASS_TYPE[i]+", probability:"+s.toFixed(5);console.log(o),e.push(o)}this.UpdateDivWithText(e)}const o=i.argMax(-1).dataSync()[0];return n.CLASS_TYPE[o]}));console.error("no model loaded")}UpdateDivWithText(t){let s="<p>*** FROM DEEP LEARNING MODEL B *** </p>";for(let i=0;i<t.length;++i)s+="<p> ".concat(t[i],"</p>");this.divText.innerHTML=s}PredictionPostProcessingLogisticRegression(t){const s=Math.floor(t+.5);return n.CLASS_TYPE[s]}GetIndexBySortDescending(t){let s=t.length,i=new Array(s);for(var e=0;e<s;++e)i[e]=e;return i.sort(((s,i)=>t[s]>t[i]?-1:t[s]<t[i]?1:0)),i}Remove(){}Predict(t){const s=[];for(let n of t)s.push(new o.NVector3(n[0],n[1],0));const i=o.NVector3.ComputeDotProducts(s),e=this.GetInterpolatedArray(i,501);console.log("*** FROM DEEP LEARNING MODELS ***");const a=this.PredictByMultiClassification(e);return console.debug("pridiction:%c ".concat(a," from MC model"),"background: #4e2c7e; color: white"),this.firebaseWrapper.sendData({class:a,vec:t}),a}LinearInterpolate(t,s,i){return t+(s-t)*i}GetInterpolatedArray(t,s){let i={},e=(t.length-1)/(s-1);i[0]=t[0];for(let o=1;o<s-1;o++){let s=o*e,a=+Math.floor(s).toFixed(),n=+Math.ceil(s).toFixed(),r=s-a;i[o]=this.LinearInterpolate(t[a],t[n],r)}return i[s-1]=t[t.length-1],i}}n.CLASS_TYPE={0:"CIRCLE",1:"TRI-GON",2:"ARROW_SINGLE",3:"ARROW_DOUBLE",4:"RECTANGLE",5:"TEXT",6:"CURVE",7:"HEART",8:"CLOUD"}},20587:(t,s,i)=>{i.r(s),i.d(s,{Implementation:()=>o});var e=i(6503);class o{constructor(t){this.app=void 0,this.smartDrawing=void 0,this.app=t,this.smartDrawing=new e.SmartDrawing}}},72707:(t,s,i)=>{i.r(s),i.d(s,{AppML:()=>a,Solution:()=>n});var e=i(60026),o=i(20587);class a{static Init(t){new a(t)}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";this.canvasSD=void 0,this.implementation=void 0,this.host=void 0,this.divText=void 0,console.log("id: "+t+", App Init!!!!!");const s=document.getElementById(t);s&&(this.host=s),this.InitHTML(),this.canvasSD=new e.CanvasSD(this),this.implementation=new o.Implementation(this)}InitHTML(){const t=document.createElement("button");t.style.width="100px",t.style.height="20px",t.style.marginLeft="20px",t.style.zIndex="5",t.name="Clear",t.innerText="Clear",t.value="Clear",t.onclick=()=>{console.log(this),this.canvasSD.Clear()},this.host.appendChild(t),this.divText=document.createElement("div"),this.divText.id="classText",this.divText.style.zIndex="5",this.divText.innerText="class: ",this.divText.style.marginLeft="20px",this.host.appendChild(this.divText)}Init(t){console.log("this is init...")}Clear(){this.canvasSD.Clear()}}class n{constructor(t){this.divHost=void 0,this.divHost=document.getElementById(t),a.Init(t)}destroy(){if(this.divHost)try{for(;this.divHost.firstChild;)this.divHost.removeChild(this.divHost.firstChild)}catch(t){console.error("Error in destroy method:",t)}else console.warn("divHost is undefined in destroy method")}}}}]);
//# sourceMappingURL=72707.1683fc1c.chunk.js.map