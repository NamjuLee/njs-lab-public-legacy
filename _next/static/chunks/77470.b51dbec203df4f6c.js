"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[77470],{77470:function(r,e,t){var a,i;t.r(e),t.d(e,{ATTR:function(){return a},AttribLocations:function(){return o},Shader:function(){return s},ShaderUtility:function(){return l},UniformLocations:function(){return n}}),(i=a||(a={})).ATTR_POSITION_NAME="a_position",i[i.ATTR_POSITION_LOC=0]="ATTR_POSITION_LOC",i.ATTR_NORMAL_NAME="a_norm",i[i.ATTR_NORMAL_LOC=1]="ATTR_NORMAL_LOC",i.ATTR_UV_NAME="a_uv",i[i.ATTR_UV_LOC=2]="ATTR_UV_LOC",i.ATTR_COLOR_NAME="a_color",i[i.ATTR_COLOR_LOC=4]="ATTR_COLOR_LOC";class o{constructor(r,e){this.position=r.getAttribLocation(e,"a_position"),this.norm=r.getAttribLocation(e,"a_norm"),this.uv=r.getAttribLocation(e,"a_uv")}}class n{constructor(r,e){this.perspective=r.getUniformLocation(e,"uPMatrix"),this.modelMatrix=r.getUniformLocation(e,"uMVMatrix"),this.cameraMatrix=r.getUniformLocation(e,"uCameraMatrix"),this.mainTexture=r.getUniformLocation(e,"uMainTex")}}class s{activate(){return this.gl.useProgram(this.program),this}deactivate(){return this.gl.useProgram(null),this}dispose(){this.gl.getParameter(this.gl.CURRENT_PROGRAM)===this.program&&this.gl.useProgram(null),this.gl.deleteProgram(this.program)}setPerspective(r){return this.gl.uniformMatrix4fv(this.uniformLoc.perspective,!1,r),this}setModelMatrix(r){return this.gl.uniformMatrix4fv(this.uniformLoc.modelMatrix,!1,r),this}setCameraMatrix(r){return this.gl.uniformMatrix4fv(this.uniformLoc.cameraMatrix,!1,r),this}preRender(){}renderModel(r){return this.setModelMatrix(r.transform.getViewMatrix()),this.gl.bindVertexArray(r.vao.vao),r.vao.noCulling&&this.gl.disable(this.gl.CULL_FACE),r.vao.doBlending&&this.gl.enable(this.gl.BLEND),r.vao.indexCount?this.gl.drawElements(r.vao.drawMode,r.vao.indexCount,this.gl.UNSIGNED_SHORT,0):this.gl.drawArrays(r.vao.drawMode,0,r.vao.vertexCount),this.gl.bindVertexArray(null),r.vao.noCulling&&this.gl.enable(this.gl.CULL_FACE),r.vao.doBlending&&this.gl.disable(this.gl.BLEND),this}constructor(r,e,t,a=!0){if(this.gl=r,this.vShader=l.CreateShader(r,r.VERTEX_SHADER,e),this.fShader=l.CreateShader(r,r.FRAGMENT_SHADER,t),this.vShader&&this.fShader){let e=l.CreateProgram(r,this.vShader,this.fShader,a);if(e){this.program=e,r.useProgram(this.program),this.attribLoc=new o(r,this.program),this.uniformLoc=new n(r,this.program);return}console.error("vertex fragment shader error");return}console.error("vertex fragment shader error");return}}class l{static CreateProgram(r,e,t){let a=!(arguments.length>3)||void 0===arguments[3]||arguments[3],i=r.createProgram();return null===i?null:(r.attachShader(i,e),r.attachShader(i,t),r.bindAttribLocation(i,0,"a_position"),r.bindAttribLocation(i,1,"a_norm"),r.bindAttribLocation(i,2,"a_uv"),r.linkProgram(i),r.getProgramParameter(i,r.LINK_STATUS))?a&&(r.validateProgram(i),!r.getProgramParameter(i,r.VALIDATE_STATUS))?(console.error("Failed to validate program",r.getProgramInfoLog(i)),r.deleteProgram(i),r.deleteShader(t),r.deleteShader(e),null):(r.deleteShader(t),r.deleteShader(e),i):(console.log("Failed to link program: "+r.getProgramInfoLog(i)),r.deleteProgram(i),r.deleteShader(t),r.deleteShader(e),null)}static CreateShader(r,e,t){let a=r.createShader(e);return null===a?null:(r.shaderSource(a,t),r.compileShader(a),r.getShaderParameter(a,r.COMPILE_STATUS))?a:(console.log(r.getShaderInfoLog(a)),r.deleteShader(a),null)}static LoadTexture(r,e,t){let a=r.createTexture();return!0===t&&r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,1),r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_NEAREST),r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null),!0===t&&r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,1),a}}}}]);