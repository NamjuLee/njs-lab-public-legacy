(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[89868],{58478:function(t){function e(t){return Promise.resolve().then(function(){var e=Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}e.keys=function(){return[]},e.resolve=e,e.id=58478,t.exports=e},15510:function(t){function e(t){return Promise.resolve().then(function(){var e=Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}e.keys=function(){return[]},e.resolve=e,e.id=15510,t.exports=e},75410:function(){},48628:function(){},31601:function(){},67792:function(){},34977:function(){},75042:function(){},21322:function(t,e,i){"use strict";i.d(e,{P:function(){return r}});var s=i(88405);class r{predict1d(t){return t.mul(this.weights[0]).add(this.bias)}predict2d(t){return t.square().mul(this.weights[1]).add(t.mul(this.weights[0])).add(this.bias)}predict3d(t){return t.pow(s.scalar(3)).mul(this.weights[2]).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict4d(t){return t.pow(s.scalar(4)).mul(this.weights[3]).add(t.pow(s.scalar(3)).mul(this.weights[2])).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict5d(t){return t.pow(s.scalar(5)).mul(this.weights[4]).add(t.pow(s.scalar(4)).mul(this.weights[3])).add(t.pow(s.scalar(3)).mul(this.weights[2])).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict(t){return 5===this.dim?this.predict5d(t):4===this.dim?this.predict4d(t):3===this.dim?this.predict3d(t):2===this.dim?this.predict2d(t):(this.dim,this.predict1d(t))}loss(t,e){return t.sub(e).square().mean()}train(t,e){s.tidy(()=>{let i=s.tensor1d(t),r=s.tensor1d(e);this.optimizer.minimize(()=>this.loss(this.predict(i),r))})}constructor(t=0){this.weights=[],this.dim=3,this.leraningRate=.2,this.dim=t;for(let t=0;t<5;++t){let t=s.variable(s.scalar(2*Math.random()-1));t.print(),this.weights.push(t)}this.bias=s.variable(s.scalar(2*Math.random()-1)),this.optimizer=s.train.adam(this.leraningRate)}}},88876:function(t,e,i){"use strict";i.d(e,{NJSCORE:function(){return n},PolynomialRegression:function(){return o.P},RendererThree:function(){return s.T}});var s=i(14540),r=i(45169);i.o(r,"AStart")&&i.d(e,{AStart:function(){return r.AStart}}),i.o(r,"COLOR_BLENDING")&&i.d(e,{COLOR_BLENDING:function(){return r.COLOR_BLENDING}}),i.o(r,"Graph")&&i.d(e,{Graph:function(){return r.Graph}}),i.o(r,"KNN")&&i.d(e,{KNN:function(){return r.KNN}}),i.o(r,"LinearRegression")&&i.d(e,{LinearRegression:function(){return r.LinearRegression}}),i.o(r,"LinearRegressionGradientDescent")&&i.d(e,{LinearRegressionGradientDescent:function(){return r.LinearRegressionGradientDescent}}),i.o(r,"MercatorProjection")&&i.d(e,{MercatorProjection:function(){return r.MercatorProjection}}),i.o(r,"PolynomialRegression")&&i.d(e,{PolynomialRegression:function(){return r.PolynomialRegression}}),i.o(r,"RGBtoGray")&&i.d(e,{RGBtoGray:function(){return r.RGBtoGray}}),i.o(r,"RendererCanvas")&&i.d(e,{RendererCanvas:function(){return r.RendererCanvas}}),i.o(r,"RendererJSAPI")&&i.d(e,{RendererJSAPI:function(){return r.RendererJSAPI}}),i.o(r,"TypeDithering")&&i.d(e,{TypeDithering:function(){return r.TypeDithering}}),i.o(r,"Vector3")&&i.d(e,{Vector3:function(){return r.Vector3}}),i.o(r,"buildNetwork")&&i.d(e,{buildNetwork:function(){return r.buildNetwork}}),i.o(r,"crossProduct")&&i.d(e,{crossProduct:function(){return r.crossProduct}}),i.o(r,"deepCopy")&&i.d(e,{deepCopy:function(){return r.deepCopy}}),i.o(r,"distanceEuclidean")&&i.d(e,{distanceEuclidean:function(){return r.distanceEuclidean}}),i.o(r,"distanceTo")&&i.d(e,{distanceTo:function(){return r.distanceTo}}),i.o(r,"dithering4_4")&&i.d(e,{dithering4_4:function(){return r.dithering4_4}}),i.o(r,"ditheringFloydSteinberg")&&i.d(e,{ditheringFloydSteinberg:function(){return r.ditheringFloydSteinberg}}),i.o(r,"getArrayBinaryImgFromCtx")&&i.d(e,{getArrayBinaryImgFromCtx:function(){return r.getArrayBinaryImgFromCtx}}),i.o(r,"getCSVFromURL")&&i.d(e,{getCSVFromURL:function(){return r.getCSVFromURL}}),i.o(r,"getCheckBox")&&i.d(e,{getCheckBox:function(){return r.getCheckBox}}),i.o(r,"getImgFromURL")&&i.d(e,{getImgFromURL:function(){return r.getImgFromURL}}),i.o(r,"getJSONFromURL")&&i.d(e,{getJSONFromURL:function(){return r.getJSONFromURL}}),i.o(r,"getLineSeg")&&i.d(e,{getLineSeg:function(){return r.getLineSeg}}),i.o(r,"getRandomHex")&&i.d(e,{getRandomHex:function(){return r.getRandomHex}}),i.o(r,"getSlider")&&i.d(e,{getSlider:function(){return r.getSlider}}),i.o(r,"getUUID")&&i.d(e,{getUUID:function(){return r.getUUID}}),i.o(r,"hex2RGBA")&&i.d(e,{hex2RGBA:function(){return r.hex2RGBA}}),i.o(r,"isInsideOfVecs")&&i.d(e,{isInsideOfVecs:function(){return r.isInsideOfVecs}}),i.o(r,"normalize")&&i.d(e,{normalize:function(){return r.normalize}}),i.o(r,"reflect")&&i.d(e,{reflect:function(){return r.reflect}}),i.o(r,"remap")&&i.d(e,{remap:function(){return r.remap}}),i.o(r,"shuffleArray")&&i.d(e,{shuffleArray:function(){return r.shuffleArray}});var o=i(21322),n=i(8483)},14540:function(t,e,i){"use strict";i.d(e,{T:function(){return o}});var s=i(97776),r=i(78252);class o{initCanvas(){this.scene=new s.xsS,this.scene.background=new s.Ilk(0),this.scene.castShadow=!0,this.renderer=new s.CP7({antialias:!0,alpha:!0}),this.renderer.setPixelRatio(this.hostDiv.clientWidth/this.hostDiv.clientHeight),this.renderer.domElement.id="Three",this.renderer.domElement.style.position="absolute",this.renderer.shadowMap.enabled=!0,this.renderer.setSize(this.hostDiv.clientWidth,this.hostDiv.clientHeight),this.hostDiv.appendChild(this.renderer.domElement),this.camera=new s.cPb(30,this.hostDiv.clientWidth/this.hostDiv.clientHeight,1,5e3),this.controls=new r.OrbitControls(this.camera,this.renderer.domElement),this.camera.position.set(0,0,5),this.controls.update(),this.canvas=this.renderer.domElement,this.init()}init(){this.eventBind()}eventBind(){this.renderer.domElement.onmousedown=t=>this.mouseDown(t),this.renderer.domElement.onmouseup=t=>this.mouseUp(t),this.renderer.domElement.onmousemove=t=>this.mouseMove(t),this.renderer.domElement.addEventListener("click",t=>this.mouseClick(t)),window.addEventListener("resize",()=>this.onWindowResize())}onWindowResize(){this.camera.aspect=this.hostDiv.clientWidth/this.hostDiv.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.hostDiv.clientWidth,this.hostDiv.clientHeight)}start(){this.loop()}mouseDown(t){}mouseUp(t){}mouseClick(t){}mouseDClick(t){}mouseMove(t){}mouseDrag(t){}update(t){}destroy(){for(window.removeEventListener("resize",()=>this.onWindowResize()),cancelAnimationFrame(this.requestFrame),this.requestFrame=void 0;this.hostDiv.lastChild;)this.hostDiv.removeChild(this.hostDiv.lastChild)}constructor(t){this.t=0,this.requestFrame=void 0,this.loop=()=>{this.requestFrame=requestAnimationFrame(this.loop),this.controls.update(),this.update(this.scene),this.renderer.render(this.scene,this.camera),this.t+=.01},this.hostDiv=document.getElementById(t),this.initCanvas()}}},69876:function(t,e,i){"use strict";i.r(e),i.d(e,{Solution:function(){return U},WaterHyacinth:function(){return B}});var s,r,o,n,h,a,c=i(88876),d=i(45169);class l extends c.RendererJSAPI{initPost(){this.app.initPost()}init(){this.zoom(3),this.center(-98.292649,39.043903),this.start()}render(t){t.globalCompositeOperation="screen";let e=t.canvas.width-300,i=t.canvas.height-50;for(let s=0;s<this.colorArray.length;++s)t.beginPath(),t.rect(1*s+e,i,1,10),t.closePath(),t.fillStyle="rgba(".concat(this.colorArray[s][0],", ").concat(this.colorArray[s][1],", ").concat(this.colorArray[s][2],", 1)"),t.fill();this.app.core.scene.render(t)}keyDown(t){}mouseDown(t,e){this.app.core.activeCommand.mouseDown(t,e)}mouseUp(t,e){this.app.core.activeCommand.mouseUp(t,e)}mouseClick(t,e){this.app.core.activeCommand.mouseClick(t,e)}mouseMove(t,e){this.app.core.activeCommand.mouseMove(t,e)}constructor(t,e){super(e),this.colorArray=[],this.colorArray2=[],this.app=t,this.colorArray=[];for(let t=0;t<255;++t){let e=(0,d.getFalseColor)(t/255);this.colorArray.push(e)}this.colorArray2=[]}}class u{constructor(t){this.solution=t;let e=document.createElement("div");e.style.position="absolute",e.style.width="200px",e.style.height="100%",e.style.padding="10px",e.style.background="rgba(40, 40, 40, 1)",this.solution.renderer.hostDiv.append(e);let i=document.createElement("div");i.textContent="map",e.appendChild(i);let s=document.createElement("div");e.appendChild(s);let r=document.createElement("div");s.appendChild(r),r.textContent="tracing mode",r.onclick=()=>{},r=document.createElement("div"),s.appendChild(r),r.textContent="log",r.onclick=()=>{}}}class p{mouseDown(t,e){}mouseUp(t,e){}mouseDrag(t,e){}mouseMove(t,e){this.core.common.checkHover(t,e)}mouseClick(t,e){if(this.core.scene.capture){this.core.scene.capture.click(t,e);return}let i=this.core.common.getCloseSite(t,e);void 0!==i&&(this.core.scene.capture=i)}constructor(t){this.core=t}}(s=n||(n={})).SOURCE_OVER="source-over",s.SOURCE_IN="source-in",s.SOURCE_OUT="source-out",s.SOURCE_ATOP="source-atop",s.COPY="copy",s.DESTAINATION_OVER="destination-over",s.DESTAINATION_IN="destination-in",s.DESTAINATION_OUT="destination-out",s.DESTAINATION_ATOP="destination-atop",s.LIGHTER="lighter",s.MULTIPLY="multiply",s.SCREEN="screen",s.OVERLAY="overlay",s.DARKEN="darken",s.LIGHTEN="lighten",s.COLOR_DODGE="color-dodge",s.COLOR_BURN="color-burn",s.HARD_LIGHT="hard-light",s.SOFT_LIGHT="soft-light",s.DIFFERENCE="difference",s.EXCLUSION="exclusion",s.HUE="hue",s.SATURATION="saturation",s.COLOR="color",s.LUMINOSITY="luminosity",(r=h||(h={})).BayerOrderedDithering="Bayer ordered dithering",r.FloydSteinberg="Floyd Steinberg",r.None="None";let y=(t,e)=>{let i=t.x,s=t.y,r=!1;for(let t=0,o=e.length-1;t<e.length;o=t++){let n=e[t].x,h=e[t].y,a=e[o].x,c=e[o].y;h>s!=c>s&&i<(a-n)*(s-h)/(c-h)+n&&(r=!r)}return r};class m{set(t,e,i){return this.x=t,this.y=e,this.z=i,this}scale(t){return this.x*=t,this.y*=t,this.z*=t,this}multi(t){return this.x*=t,this.y*=t,this.z*=t,this}divByVal(t){return this.x/=t,this.y/=t,this.z/=t,this}divByVec(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}negate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}Equals(t){return this.x===t.x&&this.y===t.y&&this.z===t.z}distanceTo(t){return m.distanceTo(this,t)}normalize(){let t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return t<1e-4||(this.x=this.x/t,this.y=this.y/t,this.z=this.z/t),this}clone(){return new m(this.x,this.y,this.z)}length(){let t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return t<1e-5?1e-5:t}unitize(){return this.normalize()}getAngle(){return Math.atan2(this.y,this.x)}getAngleDegree(){return 180*this.getAngle()/Math.PI}toJSON(){}toString(){return"x: "+this.x.toFixed(3).toString()+" , y: "+this.y.toFixed(3).toString()+", z: "+this.z.toFixed(3).toString()}toFloat32Array(){return new Float32Array([this.x,this.y,this.z])}constructor(t=0,e=0,i=0){this.x=0,this.y=0,this.z=0,this.x=t,this.y=e,this.z=i}}m.distanceTo=(t,e)=>Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)+(t.z-e.z)*(t.z-e.z));let g=(t,e,i,s,r,o)=>Math.sqrt((t-s)*(t-s)+(e-r)*(e-r)+(i-o)*(i-o));class v{}v.TYPE={Manhattan:"Manhattan  ",Euclidean:"Euclidean "},v.strength=.01,v.distanceManhattan=(t,e,i,s,r,o)=>Math.abs(t-s)+Math.abs(e-r)+Math.abs(i-o),v.distanceEuclidean=(t,e,i,s,r,o)=>Math.sqrt((t-s)*(t-s)+(e-r)*(e-r)+(i-o)*(i-o)),v.gePath=(t,e,i)=>{let s;v.typeHeuristic=v.distanceEuclidean,i===v.TYPE.Manhattan&&(v.typeHeuristic=v.distanceManhattan);let r=[t],o=[],n=100;for(;n--&&(void 0===(s=v.propagation(r,o,e))||!s.length););return s},v.path=[],v.propagation=(t,e,i)=>{if(!(t.length>0))return v.path;{let s=0;for(let e=0;e<t.length;e++)t[e].f<t[s].f&&(s=e),t[e].f===t[s].f&&t[e].g>t[s].g&&(s=e);let r=t[s];if(r===i)return[r,r.previous,...v.path];v.path=[];let o=r;for(;o.previous&&(v.path.push(o.previous),(o=o.previous).previous!==v.path[v.path.length-2]););t.splice(t.indexOf(r),1),e.push(r);let n=r.neighbors;for(let s=0;s<n.length;s++){let o=n[s];if(!e.includes(o)&&!o.blocked){let e=r.g+v.heuristic(o,r)*v.strength;if(t.includes(o))continue;t.push(o),o.g=e,o.h=v.heuristic(o,i),o.f=o.g+o.h,o.previous=r}}return}},v.heuristic=(t,e)=>v.typeHeuristic(t.x,t.y,t.z,e.x,e.y,e.z),i(37526),i(28101),(o=a||(a={})).DOWN="DOWN",o.UP="UP",o.MOVE="MOVE",o.CLICK="CLICK",o.DRAG="DRAG";let x=(t,e,i,s,r)=>(t-e)*(r-s)/(i-e)+s;class f{getCloseSite(t,e){for(let i=0;i<this.core.app.project.sites.length;++i){let s=this.core.app.project.sites[i];if(g(s.vec.x,s.vec.y,0,t,e,0)<s.r)return s}}toScreen(t,e){return this.core.app.renderer.toScreen(t,e)}toMap(t,e){return this.core.app.renderer.toMap(t,e)}get zoom(){return this.core.app.renderer.mView.zoom}set zoom(t){this.core.app.renderer.mView.zoom=t}center(t,e){return this.core.app.renderer.center(t,e)}checkHover(t,e){this.core.app.project.sites.forEach(i=>{i.isHover(t,e)})}constructor(t){this.core=t}}class C{render(t){this.core.app.project.sites.forEach(e=>{e.renderDot(t)}),void 0!==this._capture&&this._capture.render(t)}set capture(t){void 0!==this._capture&&(this._capture.isActivated=!1),this._capture=t,void 0!==this._capture&&(this._capture.isActivated=!0,this._capture.focus())}get capture(){return this._capture}constructor(t){this.core=t}}class z{constructor(t){this.app=t,this.activeCommand=new p(this),this.common=new f(this),this.scene=new C(this)}}class S{Update(){this.UpdateVec1()}UpdateTarget(){this.target=this.BoidContollerWander0.site.boundary.getRandomSpot()}UpdateVec1(){this.desiredVelocity=new m(this.target.x-this.p.x,this.target.y-this.p.y,this.target.z-this.p.z),this.desiredVelocity.unitize(),this.desiredVelocity.x*=this.maxVelocity,this.desiredVelocity.y*=this.maxVelocity,this.desiredVelocity.z*=this.maxVelocity;let t=this.desiredVelocity.x-this.velocity.x<this.maxForce?this.desiredVelocity.x-this.velocity.x:this.maxForce,e=this.desiredVelocity.y-this.velocity.y<this.maxForce?this.desiredVelocity.y-this.velocity.y:this.maxForce,i=this.desiredVelocity.z-this.velocity.z<this.maxForce?this.desiredVelocity.z-this.velocity.z:this.maxForce;this.steering=new m(t/this.mass,e/this.mass,i/this.mass),this.velocity.x=this.velocity.x+this.steering.x<this.maxSpeed?this.velocity.x+this.steering.x:this.maxSpeed,this.velocity.y=this.velocity.y+this.steering.y<this.maxSpeed?this.velocity.y+this.steering.y:this.maxSpeed,this.velocity.z=this.velocity.z+this.steering.z<this.maxSpeed?this.velocity.z+this.steering.z:this.maxSpeed,this.Queue(),this.p.x+=this.velocity.x,this.p.y+=this.velocity.y,this.p.z+=this.velocity.z,this.t+=.01,this.t>3&&(this.t=0,this.UpdateTarget())}UpdateVec0(){this.steering=this.Wander(new m(this.velocity.x,this.velocity.y,this.velocity.z)),this.steering.x=this.steering.x<this.maxForce?this.steering.x:this.maxForce,this.steering.y=this.steering.y<this.maxForce?this.steering.y:this.maxForce,this.steering.z=this.steering.z<this.maxForce?this.steering.z:this.maxForce,this.steering.x/=this.mass,this.steering.y/=this.mass,this.steering.z/=this.mass,this.velocity.x+this.steering.x<this.maxSpeed?this.velocity.x=this.velocity.x+this.steering.x:this.velocity.x=this.maxSpeed,this.velocity.y+this.steering.y<this.maxSpeed?this.velocity.y=this.velocity.y+this.steering.y:this.velocity.y=this.maxSpeed,this.velocity.z+this.steering.z<this.maxSpeed?this.velocity.z=this.velocity.z+this.steering.z:this.velocity.z=this.maxSpeed,this.Queue(),console.log(this.maxSpeed),this.p.x+=this.velocity.x,this.p.y+=this.velocity.y,this.p.z+=this.velocity.z}Wander(t){let e=new m(t.x,t.y,t.z);e.normalize(),e.scale(this.CIRCLE_DISTANCE);let i=new m(0,-1);return i.scale(this.CIRCLE_RADIUS),i=this.setAngle(i,this.wanderAngle),this.wanderAngle+=Math.random()*this.ANGLE_CHANGE-.5*this.ANGLE_CHANGE,e.add(i)}setAngle(t,e){let i=t.length();return t.x=Math.cos(e)*i,t.y=Math.sin(e)*i,t}GetNeighborAhead(){var t=void 0,e=this.velocity.clone();e.normalize(),e.scale(this.MAX_QUEUE_AHEAD);let i=this.p.clone().add(e);for(let e=0;e<S.list.length;e++){let s=S.list[e],r=m.distanceTo(i,s.p);if(s!==this&&r<=this.MAX_QUEUE_RADIUS){t=s;break}}return t}Queue(){return void 0!==this.GetNeighborAhead()&&this.velocity.scale(.3),new m(0,0)}Render(t){this.RenderCircle(t)}RenderDesiredVelocity(t){}RenderCurrentVelocity(t){}RenderCircle(t){let e=this.BoidContollerWander0.site.project.app.core.common.toScreen(this.p.x,this.p.y);this.t+=.05,this.timerTrajectory+=1,this.timerTrajectory%5==0&&(this.trajectory.length>30&&this.trajectory.shift(),this.trajectory.push(new m(this.p.x,this.p.y)),this.timerTrajectory=0);for(let e=0;e<this.trajectory.length;++e)t.fillStyle="rgba(100, 100, 100 ,0.1)",t.beginPath(),t.arc(this.trajectory[e].x,this.trajectory[e].y,.2*e,0,6.28),t.closePath(),t.fill();t.strokeStyle="#000000",t.lineWidth=.5,t.fillStyle="#000000",t.beginPath(),t.arc(this.target.x,this.target.y,2.5,0,6.28),t.closePath(),t.fill(),t.fillStyle="#fff",t.beginPath(),t.arc(e[0],e[1],2.5,0,6.28),t.closePath(),t.fill(),t.beginPath(),t.arc(e[0],e[1],10+5*Math.sin(this.t),0,6.28),t.closePath(),t.stroke(),t.lineWidth=.5,t.strokeStyle="rgba(".concat(255,", ",255,", ",0,", ").concat(1-.07*this.scaleBounding,")"),t.fillStyle="rgba(".concat(255,", ",255,", ",0,", ").concat(1-.07*this.scaleBounding,")"),t.beginPath(),t.arc(e[0],e[1],this.scaleBounding,0,6.28),t.closePath(),t.fill(),t.stroke(),this.scaleBounding+=.2,1-.07*this.scaleBounding<0&&(this.scaleBounding=0)}constructor(t,e,i){this.maxForce=1e-4,this.maxVelocity=1e-4,this.maxSpeed=1e-4,this.mass=10,this.isRenderable=!0,this.targetID=0,this.col=!1,this.velocity=new m(0,0,0),this.wanderAngle=0,this.CIRCLE_DISTANCE=50,this.CIRCLE_RADIUS=50,this.ANGLE_CHANGE=15,this.t=0,this.MAX_QUEUE_AHEAD=15,this.MAX_QUEUE_RADIUS=10,this.trajectory=[],this.timerTrajectory=0,this.scaleBounding=0,this.BoidContollerWander0=t,S.list.push(this),this.p=e,i&&(this.boundary=i),this.UpdateTarget()}}S.list=[];class A{AddAgent(t,e){let i=this.site.project.app.core.common.toMap(t,e);console.log(i);let s=new S(this,new m(i[0],i[1]),this.vsBoundary);this.boids.push(s)}Update(){for(let t of this.boids)t.Update()}GetPoint(){let t=[];for(let e of this.boids)e.isRenderable&&t.push(e.p);return t}Render(t){this.boids.forEach(e=>{e.Render(t)}),t.beginPath(),t.moveTo(this.vsBoundary[0].x,this.vsBoundary[0].y);for(let e=1;e<this.vsBoundary.length;++e)t.lineTo(this.vsBoundary[e].x,this.vsBoundary[e].y);t.stroke()}constructor(t){this.boids=[],this.site=t,this.boids=[],this.vsBoundary=t.boundary.vsBoundary}}class w{getRandomSpot(){let t=new m(x(Math.random(),0,1,this.pMin.x,this.pMax.x),x(Math.random(),0,1,this.pMin.y,this.pMax.y)),e=0;for(;!y(t,this.vsBoundary)&&(t.x=x(Math.random(),0,1,this.pMin.x,this.pMax.x),t.y=x(Math.random(),0,1,this.pMin.y,this.pMax.y),!(e++>1e3)););return t}render(t){let e=this.site.project.app.core.common.toScreen(this.vsBoundary[0].x,this.vsBoundary[0].y);t.moveTo(e[0],e[1]);for(let i=1;i<this.vsBoundary.length;i+=1)e=this.site.project.app.core.common.toScreen(this.vsBoundary[i].x,this.vsBoundary[i].y),t.lineTo(e[0],e[1]);t.lineWidth=2,t.strokeStyle="#000000",t.stroke()}constructor(t,e){this.vsBoundary=[],this.pMin=new m(180,90,0),this.pMax=new m(-180,-90,0),this.pCenter=new m(0,0,0),this.site=t;for(let t=0;t<e.length;t+=2)this.pCenter.x+=e[t],this.pCenter.y+=e[t+1],e[t]<this.pMin.x&&(this.pMin.x=e[t]),e[t+1]<this.pMin.y&&(this.pMin.y=e[t+1]),e[t]>this.pMax.x&&(this.pMax.x=e[t]),e[t+1]>this.pMax.y&&(this.pMax.y=e[t+1]),this.vsBoundary.push(new m(e[t],e[t+1],0));this.pCenter.x/=.2*e.length,this.pCenter.y/=.2*e.length}}class E{constructor(){this.probability=0}}class R{initAgent(){this.BoidContollerWander0=new A(this),this.needAgent=!0}focus(){this.project.app.core.common.center(this.properties.lon,this.properties.lat),this.project.app.core.common.zoom=this.properties.zoom}blur(){}click(t,e){console.log(t,e),void 0===this.BoidContollerWander0&&(this.initAgent(),this.BoidContollerWander0.AddAgent(this.vec.x,this.vec.y)),this.BoidContollerWander0&&this.needAgent&&this.BoidContollerWander0.AddAgent(t,e)}isHover(t,e){g(t,e,0,this.vec.x,this.vec.y,0)<this.r?this.hover=!0:this.hover=!1}renderDot(t){let e=this.project.app.core.common.toScreen(this.properties.lon,this.properties.lat);if(this.vec.x=e[0],this.vec.y=e[1],this.project.app.core.common.zoom<this.properties.zoom-2){let e="#ff0000";this.properties.probability<.3&&(e="#00ff00"),t.fillStyle=e,t.beginPath(),t.arc(this.vec.x,this.vec.y,9.434712181799046,0,2*Math.PI),t.closePath(),t.fill(),this.hover&&(t.lineWidth=3,t.strokeStyle="#ffffff",t.stroke())}this.project.app.core.common.zoom<this.properties.zoom-2&&this.project.app.core.scene.capture===this&&(this.project.app.core.scene.capture=void 0)}render(t){if(this.isActivated){if(this.project.app.core.common.zoom>=this.properties.zoom-2){t.beginPath();let e=this.project.app.core.common.toScreen(this.boundary.vsBoundary[0].x,this.boundary.vsBoundary[0].y);t.moveTo(e[0],e[1]);for(let i=1;i<this.boundary.vsBoundary.length;i+=1)e=this.project.app.core.common.toScreen(this.boundary.vsBoundary[i].x,this.boundary.vsBoundary[i].y),t.lineTo(e[0],e[1]);t.lineWidth=2,t.strokeStyle="#000000",t.stroke()}this.BoidContollerWander0&&(this.BoidContollerWander0.Update(),this.BoidContollerWander0.Render(t))}}constructor(t,e){this.vec=new m(0,0,0),this.r=15,this.pMin=new m(180,90,0),this.pMax=new m(-180,-90,0),this.needAgent=!1,this.isActivated=!1,this.hover=!1,this.project=t,this.properties=new E,this.properties.lon=e.loc[0],this.properties.lat=e.loc[1],this.properties.zoom=e.zoom,this.properties.name=e.name,this.properties.probability=e.probability,this.r=15,this.boundary=new w(this,e.boundary)}}class b{initSite(t){this.rawSiteData=t;for(let e=0;e<t.length;++e){let i=new R(this,t[e]);this.sites.push(i)}}constructor(t,e){this.sites=[],this.app=t,this.initSite(e)}}let M=void 0,D=[{name:"Fresh Pond, MA",loc:[-71.149732,42.384607],zoom:15,boundary:[-71.1471427741205,42.38369829310599,-71.1454147151241,42.3832249146333,-71.14483106749,42.3832249146333,-71.144361859028,42.3833770728034,-71.1441215328383,42.383732105164675,-71.14404142410845,42.383918074064034,-71.14333189076628,42.38393498100385,-71.14304578890791,42.38390962107612,-71.14250791563302,42.38439990023337,-71.14218748071345,42.38483100457135,-71.14194715583345,42.385515693014376,-71.1419242679991,42.38611584616517,-71.14195859975062,42.38675825758481,-71.14258802305322,42.38719779779073,-71.14291990319965,42.38732458778373,-71.14453352040498,42.386800521078975,-71.14480817834618,42.386682182643234,-71.1458152574639,42.386614560234314,-71.14628446723574,42.38642014715624,-71.14731443549749,42.386310260185624,-71.1480583005912,42.386825879355264,-71.14865339345197,42.38736685138028,-71.14920271064405,42.38786555599473,-71.14972913869208,42.38809377527334,-71.15045011595143,42.38839806619294,-71.150770550871,42.38855866418817,-71.15119398235481,42.38851640139403,-71.15201795748807,42.38808532284766,-71.152601605122,42.387831745678575,-71.1531280344797,42.38768805126903,-71.15357435379786,42.38762888291559,-71.15443266068266,42.38764578837241,-71.15494764481353,42.387510546041405,-71.15566862272772,42.38729077717622,-71.15596616784842,42.38674135140531,-71.15580595169831,42.38591297834076,-71.15579450647148,42.38537199330331,-71.15533674389097,42.38487326936299,-71.15510786096365,42.38474647441903,-71.15506208529494,42.38436608756697,-71.15518797034836,42.38398569889383,-71.1550048643994,42.383698293105994,-71.15437543978712,42.38314883589375,-71.15383756651222,42.382548654862966,-71.15368879427928,42.382109081622424,-71.15355146596352,42.381661052013705,-71.152897722045,42.38158391447455,-71.15219963196516,42.3816473151721,-71.1516159836764,42.38149092663678,-71.1510380566914,42.38128804386745,-71.15056884888406,42.38108515995885,-71.1502713024538,42.380882275394804,-71.15031135681876,42.38053990659923,-71.1502713024538,42.380205989424546,-71.15002525430553,42.37991856585079,-71.14973915179233,42.37980021492652,-71.1489151773139,42.379817122007765,-71.1484173590588,42.380003102503316,-71.1477135476752,42.38003691703571,-71.14716995244171,42.380015782773704,-71.14683807425982,42.380176401728896,-71.14592826974774,42.380844234617186,-71.14588249276937,42.381038665446106,-71.14597976737502,42.3811739212357,-71.14702690151253,42.381672675046346,-71.14758194000835,42.381985450580224,-71.14785087664579,42.38231935829161,-71.14782798881144,42.382619450861974,-71.14754188629824,42.383080153525164,-71.14754188629824,42.383342202953166,-71.14743888907917,42.38349858687732,-71.14730156010857,42.38364651714675,-71.1471427741205,42.38369829310599],probability:.8},{name:"Lake, Atkinson County",loc:[-82.716073,31.205917],zoom:18,boundary:[1,18],probability:.2}];class B{init(t){this.renderer=new l(this,t)}initPost(){this.core=new z(this),this.project=new b(this,D),this.ui=new u(this),this.renderer.init()}destroy(){this.renderer&&this.renderer.destroy()}constructor(t){!0===M.demo&&this.init(t)}}class U{destroy(){if(this.divHost)try{for(;this.divHost.firstChild;)this.divHost.removeChild(this.divHost.firstChild)}catch(t){console.error("Error in destroy method:",t)}else console.warn("divHost is undefined in destroy method")}constructor(t){this.divHost=document.getElementById(t),new B(t)}}}}]);