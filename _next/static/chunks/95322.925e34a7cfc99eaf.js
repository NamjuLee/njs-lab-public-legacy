"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95322],{57812:function(e,t,r){r.d(t,{z:function(){return n}});var i=r(85515);class n{constructor(e,t){this._storage=new i.WJ,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),t&&this._storage.registerRemoveFunc("",t)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(e,t,r=1){this._storage.put(this,e,t,r,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}}},85515:function(e,t,r){r.d(t,{WJ:function(){return o},Xq:function(){return a}});var i,n,s=r(35313);(i=n||(n={}))[i.ALL=0]="ALL",i[i.SOME=1]="SOME";class a{constructor(e,t,r){this.name=e,this._storage=t,this.id=l+++":",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),r&&(this._storage.registerRemoveFunc(this.id,r),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(e){return this._storage.getSize(this,e)}resetHitRate(){this._hit=this._miss=0}put(e,t,r,i=0){this._storage.put(this,e,t,r,i)}pop(e){let t=this._storage.pop(this,e);return void 0===t?++this._miss:++this._hit,t}get(e){let t=this._storage.get(this,e);return void 0===t?++this._miss:++this._hit,t}peek(e){return this._storage.peek(this,e)}updateSize(e,t,r){this._storage.updateSize(this,e,t,r)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class o{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new s.Z,this._users=new s.Z}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,t){this._removeFuncs.push([e,t])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace(t=>t[0]!==e)}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,-1),this._checkSize()}getSize(e,t){let r=this._db.get(e.id+t);return r?.size??0}put(e,t,r,i,s){t=e.id+t;let a=this._db.get(t);return(a&&(this._size-=a.size,e.size-=a.size,this._db.delete(t),a.entry!==r&&this._notifyRemove(t,a.entry,a.size,n.ALL)),i>this._maxSize)?void this._notifyRemove(t,r,i,n.ALL):void 0===r?void console.warn("Refusing to cache undefined entry "):!i||i<0?(console.warn(`Refusing to cache entry with size ${i} for key ${t}`),void this._notifyRemove(t,r,0,n.ALL)):void(this._db.set(t,new u(r,i,1+Math.max(s,-4)- -3)),this._size+=i,e.size+=i,this._checkSize())}updateSize(e,t,r,i){t=e.id+t;let s=this._db.get(t);if(s&&s.entry===r){for(this._size-=s.size,e.size-=s.size;i>this._maxSize;){let e=this._notifyRemove(t,r,i,n.SOME);if(!(null!=e&&e>0))return void this._db.delete(t);i=e}s.size=i,this._size+=i,e.size+=i,this._checkSize()}}pop(e,t){t=e.id+t;let r=this._db.get(t);if(r)return this._size-=r.size,e.size-=r.size,this._db.delete(t),++this._hit,r.entry;++this._miss}get(e,t){t=e.id+t;let r=this._db.get(t);if(void 0!==r)return this._db.delete(t),r.lives=r.lifetime,this._db.set(t,r),++this._hit,r.entry;++this._miss}peek(e,t){let r=this._db.get(e.id+t);return r?++this._hit:++this._miss,r?.entry}get performanceInfo(){let e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},t={},r=[];this._db.forEach((e,i)=>{let n=e.lifetime;r[n]=(r[n]||0)+e.size,this._users.forAll(r=>{let{id:n,name:s}=r;if(i.startsWith(n)){let r=t[s]||0;t[s]=r+e.size}})});let i={};this._users.forAll(e=>{let r=e.name;if("hitRate"in e&&"number"==typeof e.hitRate&&!isNaN(e.hitRate)&&e.hitRate>0){let n=t[r]||0;t[r]=n,i[r]=Math.round(100*e.hitRate)+"%"}else i[r]="0%"});let n=Object.keys(t);n.sort((e,r)=>t[r]-t[e]),n.forEach(r=>e[r]=Math.round(t[r]/1048576)+"MB / "+i[r]);for(let t=r.length-1;t>=0;--t){let i=r[t];i&&(e["Priority "+(t+-3-1)]=Math.round(i/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll(e=>e.resetHitRate())}clear(e){let t=e.id;this._db.forEach((e,r)=>{r.startsWith(t)&&(this._size-=e.size,this._db.delete(r),this._notifyRemove(r,e.entry,e.size,n.ALL))}),e.size=0}clearAll(){this._db.forEach((e,t)=>this._notifyRemove(t,e.entry,e.size,n.ALL)),this._users.forAll(e=>e.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,t,r,i){let n;return this._removeFuncs.some(s=>{if(e.startsWith(s[0])){let e=s[1](t,i,r);return"number"==typeof e&&(n=e),!0}return!1}),n}_checkSize(){this._users.forAll(e=>this._checkSizeLimits(e)),this._checkSizeLimits()}_checkSizeLimits(e){let t=e??this;if(t.maxSize<0||t.size<=t.maxSize)return;let r=e?.id,i=!0;for(;i;)for(let[n,s]of(i=!1,this._db))if(0===s.lifetime&&(!r||n.startsWith(r))){if(this._purgeItem(n,s,e),t.size<=.9*t.maxSize)return;i||=this._db.has(n)}for(let[i,n]of this._db)if((!r||i.startsWith(r))&&(this._purgeItem(i,n,e),t.size<=.9*t.maxSize))return}_purgeItem(e,t,r=this._users.find(t=>e.startsWith(t.id))){if(this._db.delete(e),t.lives<=1){this._size-=t.size,r&&(r.size-=t.size);let i=this._notifyRemove(e,t.entry,t.size,n.SOME);null!=i&&i>0&&(this._size+=i,r&&(r.size+=i),t.lives=t.lifetime,t.size=i,this._db.set(e,t))}else--t.lives,this._db.set(e,t)}}let l=0;class u{constructor(e,t,r){this.entry=e,this.size=t,this.lifetime=r,this.lives=r}}},25607:function(e,t,r){function i(){return[1,0,0,0,1,0,0,0,1]}function n(e,t,r,i,n,s,a,o,l){return[e,t,r,i,n,s,a,o,l]}r.d(t,{Ue:function(){return i},Wd:function(){return s},al:function(){return n}});let s=i();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:s,clone:function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},create:i,createView:function(e,t){return new Float64Array(e,t,9)},fromValues:n},Symbol.toStringTag,{value:"Module"}))},67346:function(e,t,r){r.d(t,{E:function(){return p},H:function(){return c}});var i=r(15514),n=r(25607),s=r(76827),a=r(60964);let o=(0,r(82955).Ue)(),l=(0,n.Ue)(),u=(0,n.Ue)(),h=(0,n.Ue)();function c(e,t,r){return(0,a.s)(o,t[0],t[1],1),(0,a.t)(o,o,(0,i.p4)(l,r)),0===o[2]?(0,s.t8)(e,o[0],o[1]):(0,s.t8)(e,o[0]/o[2],o[1]/o[2])}function p(e,t,r){return d(u,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),d(h,r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]),(0,i.Jp)(e,(0,i.uj)(u,u),h),0!==e[8]&&(e[0]/=e[8],e[1]/=e[8],e[2]/=e[8],e[3]/=e[8],e[4]/=e[8],e[5]/=e[8],e[6]/=e[8],e[7]/=e[8],e[8]/=e[8]),e}function d(e,t,r,n,s,u,h,c,p){(0,i.t8)(e,t,n,u,r,s,h,1,1,1),(0,a.s)(o,c,p,1),(0,i.uj)(l,e);let[d,f,m]=(0,a.t)(o,o,(0,i.p4)(l,l));return(0,i.t8)(l,d,0,0,0,f,0,0,0,m),(0,i.Jp)(e,l,e)}},93904:function(e,t,r){r.d(t,{$7:function(){return h},$e:function(){return a},N5:function(){return u},lW:function(){return o}}),r(37180);var i=r(94605),n=r(31124),s=r(72659);function a(e){let t=l(e);return null!=t?t.toDataURL():""}async function o(e,t){let r=l(e);if(null==r)throw new i.Z("imageToArrayBuffer","Unsupported image type");let a=function(e){if(!(e instanceof HTMLImageElement))return"image/png";let t=e.src;if((0,s.HK)(t)){let e=(0,s.sJ)(t);return"image/jpeg"===e?.mediaType?e.mediaType:"image/png"}return/\.png$/i.test(t)?"image/png":/\.(jpg|jpeg)$/i.test(t)?"image/jpeg":"image/png"}(e),o=await new Promise(e=>r.toBlob(e,a));if((0,n.k_)(t),!o)throw new i.Z("imageToArrayBuffer","Failed to encode image");let u=await o.arrayBuffer();return(0,n.k_)(t),{data:u,type:a}}function l(e){if(e instanceof HTMLCanvasElement)return e;if(e instanceof HTMLVideoElement)return null;let t=document.createElement("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");return e instanceof HTMLImageElement?r.drawImage(e,0,0,e.width,e.height):e instanceof ImageData&&r.putImageData(e,0,0),t}function u(e){let t=[],r=new Uint8Array(e);for(let e=0;e<r.length;e++)t.push(String.fromCharCode(r[e]));return"data:application/octet-stream;base64,"+btoa(t.join(""))}function h(e){if(e.byteLength<8)return!1;let t=new Uint8Array(e);return 137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]&&13===t[4]&&10===t[5]&&26===t[6]&&10===t[7]}},92353:function(e,t,r){r.d(t,{Q:function(){return h}});var i=r(92882),n=r(94605),s=r(68665);r(19324);var a,o=r(42656),l={exports:{}};a=function(){function e(t,r,i,n){var s=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(s,e.prototype),s.expected=r,s.found=i,s.location=n,s.name="SyntaxError",s}function t(e,t,r){return r=r||" ",e.length>t?e:(t-=e.length,e+(r+=r.repeat(t)).slice(0,t))}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.prototype.format=function(e){var r="Error: "+this.message;if(this.location){var i,n=null;for(i=0;i<e.length;i++)if(e[i].source===this.location.source){n=e[i].text.split(/\r\n|\n|\r/g);break}var s=this.location.start,a=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(s):s,o=this.location.source+":"+a.line+":"+a.column;if(n){var l=this.location.end,u=t("",a.line.toString().length," "),h=n[s.line-1],c=(s.line===l.line?l.column:h.length+1)-s.column||1;r+="\n --> "+o+"\n"+u+" |\n"+a.line+" | "+h+"\n"+u+" | "+t("",s.column-1," ")+t("",c,"^")}else r+="\n at "+o}return r},e.buildMessage=function(e,t){var r={literal:function(e){return'"'+n(e.text)+'"'},class:function(e){var t=e.parts.map(function(e){return Array.isArray(e)?s(e[0])+"-"+s(e[1]):s(e)});return"["+(e.inverted?"^":"")+t.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function i(e){return e.charCodeAt(0).toString(16).toUpperCase()}function n(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+i(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+i(e)})}function s(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+i(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+i(e)})}function a(e){return r[e.type](e)}return"Expected "+function(e){var t,r,i=e.map(a);if(i.sort(),i.length>0){for(t=1,r=1;t<i.length;t++)i[t-1]!==i[t]&&(i[r]=i[t],r++);i.length=r}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(e)+" but "+(t?'"'+n(t)+'"':"end of input")+" found."},{SyntaxError:e,parse:function(t,r){var i,n,s,a,o,l,u,h,c={},p=(r=void 0!==r?r:{}).grammarSource,d={start:ed},f=ed,m="none",g="grad",y="turn",_=/^[ \t\n\r]/,v=/^[a-z\-]/,w=/^[0-9a-fA-F]/,b=/^[+\-]/,A=/^[0-9]/,S=eh("none"),x=el("none",!1),C=el(")",!1),R=el(",",!1),z=eh("whitespace"),E=eu([" ","	","\n","\r"],!1,!1),T=eh("function"),F=el("(",!1),M=eh("identifier"),O=eu([["a","z"],"-"],!1,!1),P=eh("percentage"),Z=el("%",!1),L=eh("length"),H=el("px",!1),I=el("cm",!1),q=el("mm",!1),V=el("in",!1),j=el("pt",!1),U=el("pc",!1),D=eh("angle"),k=el("deg",!1),N=el("rad",!1),W=el("grad",!1),G=el("turn",!1),$=eh("number"),B=eh("color"),Y=el("#",!1),X=eu([["0","9"],["a","f"],["A","F"]],!1,!1),J=eu(["+","-"],!1,!1),Q=eu([["0","9"]],!1,!1),K=el(".",!1),ee=el("e",!1),et=0,er=0,ei=[{line:1,column:1}],en=0,es=[],ea=0;if("startRule"in r){if(!(r.startRule in d))throw Error("Can't start parsing from rule \""+r.startRule+'".');f=d[r.startRule]}function eo(){return t.substring(er,et)}function el(e,t){return{type:"literal",text:e,ignoreCase:t}}function eu(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function eh(e){return{type:"other",description:e}}function ec(e){var r,i=ei[e];if(i)return i;for(r=e-1;!ei[r];)r--;for(i={line:(i=ei[r]).line,column:i.column};r<e;)10===t.charCodeAt(r)?(i.line++,i.column=1):i.column++,r++;return ei[e]=i,i}function ep(e){et<en||(et>en&&(en=et,es=[]),es.push(e))}function ed(){var e,r,i;return ea++,r=et,eg(),t.substr(et,4)===m?(i=m,et+=4):(i=c,0===ea&&ep(x)),i!==c?(eg(),er=r,r=[]):(et=r,r=c),ea--,r===c&&0===ea&&ep(S),(e=r)===c&&(e=function(){var e,t;if(e=[],(t=ef())!==c)for(;t!==c;)e.push(t),t=ef();else e=c;return e}()),e}function ef(){var e,r,i,n,s,a,o;return e=et,eg(),(ea++,s=et,(a=ey())!==c?(40===t.charCodeAt(et)?(o="(",et++):(o=c,0===ea&&ep(F)),o!==c?(er=s,s=a):(et=s,s=c)):(et=s,s=c),ea--,s===c&&(a=c,0===ea&&ep(T)),(r=s)!==c)?(eg(),(i=function(){var e,r,i,n,s,a,o,l,u;if(e=et,(r=em())!==c){for(i=[],n=et,s=eg(),44===t.charCodeAt(et)?(a=",",et++):(a=c,0===ea&&ep(R)),a===c&&(a=null),o=eg(),(l=em())!==c?n=s=[s,a,o,l]:(et=n,n=c);n!==c;)i.push(n),n=et,s=eg(),44===t.charCodeAt(et)?(a=",",et++):(a=c,0===ea&&ep(R)),a===c&&(a=null),o=eg(),(l=em())!==c?n=s=[s,a,o,l]:(et=n,n=c);er=e,e=i.length>0?(u=0,[r].concat(i.map(function(e){return e[3]}))):[r]}else et=e,e=c;return e}())===c&&(i=null),eg(),41===t.charCodeAt(et)?(n=")",et++):(n=c,0===ea&&ep(C)),n!==c?(eg(),er=e,e={type:"function",name:r,parameters:i||[]}):(et=e,e=c)):(et=e,e=c),e}function em(){var e,r,i,n,s,a,o,l,u,h,p,d,f,m,_;return e=et,ea++,s=et,eg(),(a=e_())!==c?(37===t.charCodeAt(et)?(o="%",et++):(o=c,0===ea&&ep(Z)),o!==c?(er=s,s={value:a,unit:"%"}):(et=s,s=c)):(et=s,s=c),ea--,s===c&&0===ea&&ep(P),(r=s)===c&&(ea++,l=et,eg(),(u=e_())!==c?("px"===t.substr(et,2)?(h="px",et+=2):(h=c,0===ea&&ep(H)),h!==c?(er=l,l={value:u,unit:"px"}):(et=l,l=c)):(et=l,l=c),l===c&&(l=et,eg(),(u=e_())!==c?("cm"===t.substr(et,2)?(h="cm",et+=2):(h=c,0===ea&&ep(I)),h!==c?(er=l,l={value:u,unit:"cm"}):(et=l,l=c)):(et=l,l=c),l===c&&(l=et,eg(),(u=e_())!==c?("mm"===t.substr(et,2)?(h="mm",et+=2):(h=c,0===ea&&ep(q)),h!==c?(er=l,l={value:u,unit:"mm"}):(et=l,l=c)):(et=l,l=c),l===c&&(l=et,eg(),(u=e_())!==c?("in"===t.substr(et,2)?(h="in",et+=2):(h=c,0===ea&&ep(V)),h!==c?(er=l,l={value:u,unit:"in"}):(et=l,l=c)):(et=l,l=c),l===c&&(l=et,eg(),(u=e_())!==c?("pt"===t.substr(et,2)?(h="pt",et+=2):(h=c,0===ea&&ep(j)),h!==c?(er=l,l={value:u,unit:"pt"}):(et=l,l=c)):(et=l,l=c),l===c&&(l=et,eg(),(u=e_())!==c?("pc"===t.substr(et,2)?(h="pc",et+=2):(h=c,0===ea&&ep(U)),h!==c?(er=l,l={value:u,unit:"pc"}):(et=l,l=c)):(et=l,l=c)))))),ea--,l===c&&0===ea&&ep(L),(r=l)===c)&&(ea++,p=et,(d=e_())!==c?("deg"===t.substr(et,3)?(f="deg",et+=3):(f=c,0===ea&&ep(k)),f!==c?(er=p,p={value:d,unit:"deg"}):(et=p,p=c)):(et=p,p=c),p===c&&(p=et,(d=e_())!==c?("rad"===t.substr(et,3)?(f="rad",et+=3):(f=c,0===ea&&ep(N)),f!==c?(er=p,p={value:d,unit:"rad"}):(et=p,p=c)):(et=p,p=c),p===c&&(p=et,(d=e_())!==c?(t.substr(et,4)===g?(f=g,et+=4):(f=c,0===ea&&ep(W)),f!==c?(er=p,p={value:d,unit:"grad"}):(et=p,p=c)):(et=p,p=c),p===c&&(p=et,(d=e_())!==c?(t.substr(et,4)===y?(f=y,et+=4):(f=c,0===ea&&ep(G)),f!==c?(er=p,p={value:d,unit:"turn"}):(et=p,p=c)):(et=p,p=c)))),ea--,p===c&&(d=c,0===ea&&ep(D)),(r=p)===c)&&(ea++,m=et,eg(),(_=e_())!==c?(er=m,m={value:_,unit:null}):(et=m,m=c),ea--,m===c&&0===ea&&ep($),r=m),r!==c&&(er=e,r={type:"quantity",value:(i=r).value,unit:i.unit}),(e=r)===c&&(e=et,(r=function(){var e,r,i,n;if(ea++,e=et,35===t.charCodeAt(et)?(r="#",et++):(r=c,0===ea&&ep(Y)),r!==c){if(i=[],w.test(t.charAt(et))?(n=t.charAt(et),et++):(n=c,0===ea&&ep(X)),n!==c)for(;n!==c;)i.push(n),w.test(t.charAt(et))?(n=t.charAt(et),et++):(n=c,0===ea&&ep(X));else i=c;i!==c?(er=e,e={type:"hex",value:eo()}):(et=e,e=c)}else et=e,e=c;return e===c&&(e=et,(r=ef())!==c&&(er=e,r={type:"function",value:r}),(e=r)===c&&(e=et,(r=ey())!==c&&(er=e,r={type:"named",value:eo()}),e=r)),ea--,e===c&&(r=c,0===ea&&ep(B)),e}())!==c&&(er=e,r={type:"color",colorType:(n=r).type,value:n.value}),e=r),e}function eg(){var e,r;for(ea++,e=[],_.test(t.charAt(et))?(r=t.charAt(et),et++):(r=c,0===ea&&ep(E));r!==c;)e.push(r),_.test(t.charAt(et))?(r=t.charAt(et),et++):(r=c,0===ea&&ep(E));return ea--,r=c,0===ea&&ep(z),e}function ey(){var e,r,i;if(ea++,e=et,r=[],v.test(t.charAt(et))?(i=t.charAt(et),et++):(i=c,0===ea&&ep(O)),i!==c)for(;i!==c;)r.push(i),v.test(t.charAt(et))?(i=t.charAt(et),et++):(i=c,0===ea&&ep(O));else r=c;return r!==c&&(er=e,r=eo()),ea--,(e=r)===c&&(r=c,0===ea&&ep(M)),e}function e_(){var e,r,i,n,s,a,o;for(e=et,b.test(t.charAt(et))?(t.charAt(et),et++):0===ea&&ep(J),r=et,i=[],A.test(t.charAt(et))?(n=t.charAt(et),et++):(n=c,0===ea&&ep(Q));n!==c;)i.push(n),A.test(t.charAt(et))?(n=t.charAt(et),et++):(n=c,0===ea&&ep(Q));if(46===t.charCodeAt(et)?(n=".",et++):(n=c,0===ea&&ep(K)),n!==c){if(s=[],A.test(t.charAt(et))?(a=t.charAt(et),et++):(a=c,0===ea&&ep(Q)),a!==c)for(;a!==c;)s.push(a),A.test(t.charAt(et))?(a=t.charAt(et),et++):(a=c,0===ea&&ep(Q));else s=c;s!==c?r=i=[i,n,s]:(et=r,r=c)}else et=r,r=c;if(r===c){if(r=[],A.test(t.charAt(et))?(i=t.charAt(et),et++):(i=c,0===ea&&ep(Q)),i!==c)for(;i!==c;)r.push(i),A.test(t.charAt(et))?(i=t.charAt(et),et++):(i=c,0===ea&&ep(Q));else r=c}if(r!==c){if(i=et,101===t.charCodeAt(et)?(n="e",et++):(n=c,0===ea&&ep(ee)),n!==c){if(b.test(t.charAt(et))?(s=t.charAt(et),et++):(s=c,0===ea&&ep(J)),s===c&&(s=null),a=[],A.test(t.charAt(et))?(o=t.charAt(et),et++):(o=c,0===ea&&ep(Q)),o!==c)for(;o!==c;)a.push(o),A.test(t.charAt(et))?(o=t.charAt(et),et++):(o=c,0===ea&&ep(Q));else a=c;a!==c?i=n=[n,s,a]:(et=i,i=c)}else et=i,i=c;i===c&&(i=null),er=e,e=parseFloat(eo())}else et=e,e=c;return e}if((h=f())!==c&&et===t.length)return h;throw h!==c&&et<t.length&&ep({type:"end"}),o=es,l=en<t.length?t.charAt(en):null,i=en,n=en<t.length?en+1:en,s=ec(i),a=ec(n),u={source:p,start:{offset:i,line:s.line,column:s.column},end:{offset:n,line:a.line,column:a.column}},new e(e.buildMessage(o,l),o,l,u)}}},l.exports&&(l.exports=a());var u=l.exports;function h(e){if(!e||0===e.length)return null;if("string"==typeof e){let t=c(e);return t&&0!==t.length?t:null}let t=e.map(e=>{if(!Number.isFinite(e.scale)||e.scale<=0)throw new n.Z("effect:invalid-scale","scale must be finite and greater than 0",{stop:e});return{scale:e.scale,effects:c(e.value)}});t.sort((e,t)=>t.effects.length-e.effects.length);for(let e=0;e<t.length-1;e++){if(!(0,o.AS)(t[e].effects,t[e+1].effects))throw new n.Z("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:t[e].effects,b:t[e+1].effects});(0,o.uF)(t[e].effects,t[e+1].effects)}return t.sort((e,t)=>t.scale-e.scale),t}function c(e){let t;if(!e)return[];try{t=u.parse(e)}catch(t){throw new n.Z("effect:invalid-syntax","Invalid effect syntax",{value:e,error:t})}return t.map(e=>(function(e){try{var t;switch(e.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":let r;return r=1,p(e.parameters,1),1===e.parameters.length&&(r=y(e.parameters[0])),new s.GI(e.name,r);case"opacity":let a;return a=1,p(e.parameters,1),1===e.parameters.length&&(a=y(e.parameters[0])),new s.Zx(a);case"hue-rotate":let o;return o=0,p(e.parameters,1),1===e.parameters.length&&(t=e.parameters[0],function(e){if("quantity"!==e.type||!(0===e.value&&null===e.unit||e.unit&&null!=m[e.unit]))throw new n.Z("effect:type-error",`Expected <angle>, Actual: ${d(e)}`,{term:e})}(t),o=t.value*m[t.unit]||0),new s.Tq(o);case"blur":let l;return l=0,p(e.parameters,1),1===e.parameters.length&&f(l=_(e.parameters[0]),e.parameters[0]),new s.Tj(l);case"drop-shadow":return function(e){let t=[],r=null;for(let s of e.parameters)if("color"===s.type){if(t.length&&Object.freeze(t),r)throw new n.Z("effect:type-error","Accepts only one color",{});r=function(e){switch(e.colorType){case"hex":return(0,i.rW)(e.value);case"named":return v(e.value);case"function":return function(e){if(p(e.parameters,4),w.test(e.name))return[y(e.parameters[0]),y(e.parameters[1]),y(e.parameters[2]),e.parameters[3]?y(e.parameters[3]):1];if(b.test(e.name)){var t;return(0,i.B7)((function(e){if("quantity"!==e.type||null!==e.unit)throw new n.Z("effect:type-error",`Expected <double>, Actual: ${d(e)}`,{term:e})}(t=e.parameters[0]),f(t.value,t),t.value),y(e.parameters[1]),y(e.parameters[2]),e.parameters[3]?y(e.parameters[3]):1)}throw new n.Z("effect:syntax-error",`Invalid color function '${e.name}'`,{colorFunction:e})}(e.value)}}(s)}else{let e=_(s);if(Object.isFrozen(t))throw new n.Z("effect:type-error","<length> parameters not consecutive",{lengths:t});t.push(e),3===t.length&&f(e,s)}if(t.length<2||t.length>3)throw new n.Z("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${t.length}}`,{lengths:t});return new s.CE(t[0],t[1],t[2]||0,r||v("black"))}(e);case"bloom":let u,h,c;return u=1,h=0,c=0,p(e.parameters,3),e.parameters[0]&&(u=y(e.parameters[0])),e.parameters[1]&&f(h=_(e.parameters[1]),e.parameters[1]),e.parameters[2]&&(c=y(e.parameters[2])),new s.rk(u,h,c)}}catch(t){throw t.details.filter=e,t}throw new n.Z("effect:unknown-effect",`Effect '${e.name}' is not supported`,{effect:e})})(e))}function p(e,t){if(e.length>t)throw new n.Z("effect:type-error",`Function supports up to ${t} parameters, Actual: ${e.length}`,{parameters:e})}function d(e){if("color"===e.type)return"<color>";if(e.unit){if(e.unit in g)return"<length>";if(e.unit in m)return"<angle>";if("%"===e.unit)return"<percentage>"}return"<double>"}function f(e,t){if(e<0)throw new n.Z("effect:type-error",`Negative values are not allowed, Actual: ${e}`,{term:t})}let m={deg:1,grad:.9,rad:180/Math.PI,turn:360},g={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function y(e){!function(e){if("quantity"!==e.type||null!==e.unit&&"%"!==e.unit)throw new n.Z("effect:type-error",`Expected <double> or <percentage>, Actual: ${d(e)}`,{term:e})}(e);let t=e.value;return f(t,e),"%"===e.unit?.01*t:t}function _(e){return function(e){if("quantity"!==e.type||!(0===e.value&&null===e.unit||e.unit&&null!=g[e.unit]))throw new n.Z("effect:type-error",`Expected <length>, Actual: ${d(e)}`,{term:e})}(e),e.value*g[e.unit]||0}function v(e){if(!(0,i.St)(e))throw new n.Z("effect:unknown-color",`color '${e}' isn't valid`,{namedColor:e});return(0,i.VL)(e)}let w=/^rgba?/i,b=/^hsla?/i},70817:function(e,t,r){r.d(t,{L:function(){return c}});var i=r(86641),n=r(94761),s=r(89312);r(37180),r(65223),r(3457);var a=r(64186),o=r(54001),l=r(20928),u=r(20795),h=r(79578);let c=class extends n.Z{constructor(e){super(e)}get bounds(){let e=this.coords;return null==e?.extent?null:(0,u.oJ)(e.extent)}get coords(){let e=this.element.georeference?.coords;return(0,l.projectOrLoad)(e,this.spatialReference).geometry}get normalizedCoords(){return o.Z.fromJSON((0,h.Ui)(this.coords))}get normalizedBounds(){let e=null!=this.normalizedCoords?this.normalizedCoords.extent:null;return null!=e?(0,u.oJ)(e):null}};(0,i._)([(0,s.Cb)()],c.prototype,"spatialReference",void 0),(0,i._)([(0,s.Cb)()],c.prototype,"element",void 0),(0,i._)([(0,s.Cb)()],c.prototype,"bounds",null),(0,i._)([(0,s.Cb)()],c.prototype,"coords",null),(0,i._)([(0,s.Cb)()],c.prototype,"normalizedCoords",null),(0,i._)([(0,s.Cb)()],c.prototype,"normalizedBounds",null),c=(0,i._)([(0,a.j)("esri.layers.support.MediaElementView")],c)},95015:function(e,t,r){r.d(t,{AJ:function(){return u},If:function(){return c},k0:function(){return l},uI:function(){return h},ul:function(){return o},wx:function(){return p}});var i=r(13507),n=r(4392),s=r(91870),a=r(40465);let o=2.4;function l(e){return(0,n.Wz)(e*o)}function u(e){return(0,n.F2)(e)/o}function h(e){let t=new Uint8ClampedArray(2048);if((e=e.filter(({ratio:e})=>e>=0&&e<=1).sort((e,t)=>e.ratio-t.ratio).map(({color:e,ratio:t})=>({color:e,ratio:Math.max(t,.001)}))).length<1)return t;let r=e[0],n=e[0],o=1,l=(0,a.Ue)();for(let a=0;a<512;a++){let u=(a+.5)/512;for(;u>n.ratio&&o<e.length;)r=n,n=e[o++];(function(e,t,r,n){let{color:a,ratio:o}=t,{color:l,ratio:u}=r;u===o&&(1===u?o-=1e-6:u+=1e-6);let h=(0,i.uZ)((n-o)/(u-o),0,1);(0,s.l)(e,a.toArray(),l.toArray(),h)})(l,r,n,u),t.set(l,4*a)}return t}function c(e,t,r){let i=Math.sqrt(e**2+t**2)/r;return i>1?0:3/(Math.PI*r**2)*(1-i**2)**2}function p(e){return"function"==typeof e?e:e?t=>+t[e]:()=>1}},21860:function(e,t,r){r.d(t,{Z:function(){return d}});var i=r(15514),n=r(24971),s=r(6977),a=r(34256),o=r(38028),l=r(62329),u=r(73970),h=r(54897),c=r(80320),p=r(67236);class d extends p.Z{constructor(){super(...arguments),this._viewStateId=-1,this._dvsMat3=(0,n.Ue)()}get dvsMat3(){return this._dvsMat3}beforeRender(e){for(let t of(this._updateMatrices(e),this._updateOverlays(e,this.children),this.children))t.beforeRender(e)}prepareRenderPasses(e){let t=e.registerRenderPass({name:"overlay",brushes:[h.U.overlay],target:()=>this.children,drawPhase:c.jx.MAP});return[...super.prepareRenderPasses(e),t]}_updateMatrices(e){let{state:t}=e,{id:r,size:n,pixelRatio:l,resolution:u,rotation:h,viewpoint:c,displayMat3:p}=t;if(this._viewStateId===r)return;let d=l*n[0],f=l*n[1];this._localOrigin=c.targetGeometry.clone();let{x:m,y:g}=this._localOrigin,y=(0,o.or)(m,t.spatialReference);this._localOrigin.x=y,this._localOrigin.y=g;let _=(0,i.yR)(this._dvsMat3);(0,i.Jp)(_,_,p),(0,i.Iu)(_,_,(0,s.al)(d/2,f/2)),(0,i.bA)(_,_,(0,a.al)(d/(u*d),-f/(u*f),1)),(0,i.U1)(_,_,-(Math.PI/180*h)),this._viewStateId=r}_updateOverlays(e,t){let{state:r}=e,{rotation:i,spatialReference:n,worldScreenWidth:s,size:a,viewpoint:o}=r,h=this._localOrigin,c,p=0,d=(0,l.C5)(n);if(d&&n.isWrappable){let e;let t=a[0],l=a[1],h=180/Math.PI*i,f=Math.round(t*Math.abs(Math.cos(h))+l*Math.abs(Math.sin(h))),[m,g]=d.valid,y=(0,u.ut)(n),{x:_,y:v}=o.targetGeometry,w=[0,0];r.toScreen(w,[_,v]);let b=[0,0];e=f>s?.5*s:.5*f;let A=Math.floor((_+.5*y)/y),S=[w[0]+e,0];r.toMap(b,S),b[0]>g+A*y&&(p=y),S[0]=w[0]-e,r.toMap(b,S),b[0]<m+A*y&&(p=-y),c={worldWidth:y,xBounds:[m,g]}}for(let e of t)e.updateDrawCoords(h,p,n,c)}}},35354:function(e,t,r){r.d(t,{hY:function(){return u}});var i=r(1662),n=r(21684);r(93904);var s=r(50758),a=r(15986);function o(e,t){let{width:r,height:i,getFrame:s}=e,a=e.frameDurations.slice(),o=a.pop();return a.push((0,n.HA)(o+t)),{frameCount:e.frameCount,duration:e.duration+t,frameDurations:a,getFrame:s,width:r,height:i}}class l{constructor(e,t,r,i){this._animation=e,this._repeatType=r,this._onFrameData=i,this._direction=1,this._currentFrame=0,this.timeToFrame=this._animation.frameDurations[this._currentFrame];let n=0;for(;t>n;)n+=this.timeToFrame,this.nextFrame();let s=this._animation.getFrame(this._currentFrame);this._onFrameData(s)}nextFrame(){if(this._currentFrame+=this._direction,this._direction>0){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case s.of.None:this._currentFrame-=this._direction;break;case s.of.Loop:this._currentFrame=0;break;case s.of.Oscillate:this._currentFrame-=this._direction,this._direction=-1}}else if(-1===this._currentFrame)switch(this._repeatType){case s.of.None:this._currentFrame-=this._direction;break;case s.of.Loop:this._currentFrame=this._animation.frameDurations.length-1;break;case s.of.Oscillate:this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=this._animation.frameDurations[this._currentFrame];let e=this._animation.getFrame(this._currentFrame);this._onFrameData(e)}}function u(e,t,r,u){let h=null==t.playAnimation||t.playAnimation,c=function(e,t,r,i){let u,{repeatType:h}=t;if(null==h&&(h=s.of.Loop),!0===t.reverseAnimation&&(e=function(e){let{width:t,height:r}=e,i=e.frameDurations.reverse();return{frameCount:e.frameCount,duration:e.duration,frameDurations:i,getFrame:t=>{let r=e.frameDurations.length-1-t;return e.getFrame(r)},width:t,height:r}}(e)),null!=t.duration&&(e=function(e,t){let{width:r,height:i,getFrame:s}=e,a=t/e.duration,o=e.frameDurations.map(e=>(0,n.HA)(e*a));return{frameCount:e.frameCount,duration:e.duration,frameDurations:o,getFrame:s,width:r,height:i}}(e,(0,n.HA)(1e3*t.duration))),null!=t.repeatDelay){let r=1e3*t.repeatDelay;h===s.of.Loop?e=o(e,(0,n.HA)(r)):h===s.of.Oscillate&&(e=function(e,t){let{width:r,height:i,getFrame:s}=e,a=e.frameDurations.slice(),o=a.shift();return a.unshift((0,n.HA)(o+t)),{frameCount:e.frameCount,duration:e.duration+t,frameDurations:a,getFrame:s,width:r,height:i}}(o(e,(0,n.HA)(r/2)),(0,n.HA)(r/2)))}if(null!=t.startTimeOffset)u=(0,n.HA)(1e3*t.startTimeOffset);else if(null!=t.randomizeStartTime){var c;let i=null!=t.randomizeStartSeed?t.randomizeStartSeed:82749913,s=(0,a.f)(r,i);u=(0,n.HA)(s*(c=e,(0,n.HA)(c.frameDurations.reduce((e,t)=>e+t,0))))}else u=(0,n.HA)(0);return new l(e,u,h,i)}(e,t,r,u),p,d=c.timeToFrame;return function e(){p=h?setTimeout(()=>{c.nextFrame(),d=c.timeToFrame,e()},d):void 0}(),(0,i.kB)(()=>h&&clearTimeout(p))}},15986:function(e,t,r){r.d(t,{c:function(){return s},f:function(){return n}});var i=r(44340);function n(e,t){let r;if("string"==typeof e)r=(0,i.hP)(e+`-seed(${t})`);else{let i=12;r=e^t;do r=107*(r>>8^r)+i|0;while(0!=--i)}return(1+-(r/2147483648))/2}function s(e){return Math.floor(n(e,a)*o)}let a=53290320,o=10},50338:function(e,t,r){r.d(t,{y:function(){return b}});var i,n=r(86641),s=r(50973),a=r(4514),o=r(94605),l=r(20128),u=r(89312);r(37180),r(65223),r(3457);var h=r(64186),c=r(43390),p=r(25823),d=r(76457);let f=i=class extends d.Z{constructor(e){super(e),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new i({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}commitVersionProperties(){this.commitProperty("left"),this.commitProperty("right"),this.commitProperty("top"),this.commitProperty("bottom")}};(0,n._)([(0,u.Cb)({type:[Number,String],json:{write:!0}})],f.prototype,"left",void 0),(0,n._)([(0,u.Cb)({type:[Number,String],json:{write:!0}})],f.prototype,"right",void 0),(0,n._)([(0,u.Cb)({type:[Number,String],json:{write:!0}})],f.prototype,"top",void 0),(0,n._)([(0,u.Cb)({type:[Number,String],json:{write:!0}})],f.prototype,"bottom",void 0);let m=f=i=(0,n._)([(0,h.j)("esri.views.layers.support.ClipRect")],f);var g=r(55485);let y=class extends d.Z{constructor(e){super(e),this.type="path",this.path=[]}commitVersionProperties(){this.commitProperty("path")}};(0,n._)([(0,u.Cb)({type:[[[Number]]],json:{write:!0}})],y.prototype,"path",void 0);let _=y=(0,n._)([(0,h.j)("esri.views.layers.support.Path")],y);var v=r(37864);let w=s.Z.ofType({key:"type",base:null,typeMap:{rect:m,path:_,geometry:g.Z}}),b=e=>{let t=class extends e{constructor(){super(...arguments),this.attached=!1,this.clips=new w,this.highlightOptions=null,this.lastUpdateId=-1,this.moving=!1,this.updateRequested=!1,this._visibleAtCurrentScale=!0}initialize(){let e=this.view?.spatialReferenceLocked??!0;this.view?.spatialReference&&e&&!this.spatialReferenceSupported?this.addResolvingPromise(Promise.reject(new o.Z("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new c.W),this.container.fadeTransitionEnabled=!0,this.container.visible=!1,this.container.endTransitions(),this.addHandles([(0,l.YP)(()=>this.suspended,e=>{this.container&&(this.container.visible=!e)},l.tX),(0,l.YP)(()=>this.updateSuspended,e=>{this.view&&!e&&this.updateRequested&&this.view.requestUpdate()},l.tX),(0,l.YP)(()=>this.layer?.opacity??1,e=>{this.container&&(this.container.opacity=e)},l.tX),(0,l.YP)(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",e=>{this.container&&(this.container.blendMode=e)},l.tX),(0,l.YP)(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,e=>{this.container&&(this.container.effect=e)},l.tX),(0,l.YP)(()=>this.highlightOptions,e=>this.container.highlightOptions=e,l.tX),(0,l.on)(()=>this.clips,"change",()=>{this.container&&(this.container.clips=this.clips)},l.tX),(0,l.YP)(()=>({scale:this.view?.scale,scaleRange:this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null}),({scale:e,scaleRange:t})=>{let r=(0,v.GB)(t,e);r!==this._visibleAtCurrentScale&&(this._visibleAtCurrentScale=r)},l.tX)],"constructor"),this.view?.whenLayerView?this.view.whenLayerView(this.layer).then(e=>{e===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},()=>{}))}destroy(){this.processDetach(),this.updateRequested=!1}get spatialReferenceSupported(){let e=this.view?.spatialReference;return null==e||this.supportsSpatialReference(e)}get updating(){return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!this._updatingHandles?.updating)}get visibleAtCurrentScale(){return this._visibleAtCurrentScale}processAttach(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())}processDetach(){this.attached&&(this.attached=!1,this.removeHandles("attach"),this.detach(),this.updateRequested=!1)}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.updateSuspended||this.view.requestUpdate())}processUpdate(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.updateSuspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1}hitTest(e,t){return Promise.resolve(null)}supportsSpatialReference(e){return!0}canResume(){return!!this.spatialReferenceSupported&&!!super.canResume()&&this.visibleAtCurrentScale}getSuspendInfo(){let e=super.getSuspendInfo(),t=!this.spatialReferenceSupported;return t&&(e.spatialReferenceNotSupported=t),e}addAttachHandles(e){this.addHandles(e,"attach")}};return(0,n._)([(0,u.Cb)()],t.prototype,"attached",void 0),(0,n._)([(0,u.Cb)({type:w,set(e){let t=(0,a.Z)(e,this._get("clips"),w);this._set("clips",t)}})],t.prototype,"clips",void 0),(0,n._)([(0,u.Cb)()],t.prototype,"container",void 0),(0,n._)([(0,u.Cb)({type:p.Z})],t.prototype,"highlightOptions",void 0),(0,n._)([(0,u.Cb)()],t.prototype,"moving",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],t.prototype,"spatialReferenceSupported",null),(0,n._)([(0,u.Cb)({readOnly:!0})],t.prototype,"updateParameters",void 0),(0,n._)([(0,u.Cb)()],t.prototype,"updateRequested",void 0),(0,n._)([(0,u.Cb)()],t.prototype,"updating",null),(0,n._)([(0,u.Cb)()],t.prototype,"view",void 0),(0,n._)([(0,u.Cb)()],t.prototype,"_visibleAtCurrentScale",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],t.prototype,"visibleAtCurrentScale",null),t=(0,n._)([(0,h.j)("esri.views.2d.layers.LayerView2D")],t)}},24252:function(e,t,r){r.r(t),r.d(t,{default:function(){return W}});var i=r(86641);r(55066),r(19637),r(97278),r(79073),r(92494),r(57489),r(54844),r(21153),r(1406),r(94267),r(90071);var n=r(65223);r(21161);var s=r(50973);r(37180);var a=r(59528),o=r(31124),l=r(20128),u=r(89312);r(3457);var h=r(64186),c=r(20795),p=r(81475),d=r(66515),f=r(70817),m=r(94605);r(93417),r(33385),r(45865),r(39301),r(17553),r(5574);var g=r(9377);r(90389),r(18736),r(33876),r(54001),r(58144),r(37436),r(62329),r(83536),r(5043),r(38398),r(14203),r(20790),r(71728),r(46497),r(86052),r(68690),r(27211),r(62289),r(63685),r(76136),r(18453),r(17753),r(79358),r(68062),r(6301),r(35894),r(15076),r(61535),r(44865);var y=r(50758);r(13507),r(36091),r(6977),r(66494),r(98499),r(43139),r(44837),r(36337),r(60163),r(37911),r(80320),r(41194),r(19692),r(39972);var _=r(71193);r(59546),r(83778),r(36230);var v=r(15809);r(94901),r(68100),r(92092),r(71663),r(66366),r(5747),r(55058),r(11688),r(83653),r(36362),r(16011),r(54748),r(72659),r(97177),r(51224),r(22219),r(41233),r(12420),r(31408),r(97398),r(52776),r(30375),r(14888),r(52165),r(60186),r(89767),r(14162),r(54053),r(87585),r(23040),r(35619),r(88125),r(6013),r(12702),r(44163),r(1755),r(61909),r(52894),r(80893),r(27719),r(34256),r(12206),r(36502),r(9397),r(94596),r(99585),r(27817),r(66789),r(81343),r(10045),r(8622);var w=r(49841),b=r(97123),A=r(75969),S=r(36152),x=r(67346),C=r(25607),R=r(76827),z=r(24168),E=r(6396),T=r(35354),F=r(28859),M=r(66897),O=r(98163);let P=[1,1],Z=(0,C.Ue)(),L={none:y.of.None,loop:y.of.Loop,oscillate:y.of.Oscillate};class H extends E.s{constructor(e){super(),this.elementView=e,this.isWrapAround=!1,this.wrapAroundShift=0,this.perspectiveTransform=(0,z.Ue)(),this._playHandle=null,this._vertices=new Float32Array(20),this._handles=[],this._handles.push((0,l.YP)(()=>this.elementView.element.opacity,e=>this.opacity=e,l.nn),(0,l.YP)(()=>[this.elementView.coords],()=>{this.requestRender()},l.nn),(0,l.YP)(()=>["animationOptions"in this.elementView.element&&this.elementView.element.animationOptions],()=>{this._playHandle?.remove(),this.texture=(0,S.M2)(this.texture),this.requestRender()},l.nn),(0,l.gx)(()=>this.elementView.element.loaded,()=>{let e=this.elementView.element;this.ready(),"video"===e.type&&null!=e.content&&this._handles.push((0,A.on)(e.content,"play",()=>this.requestRender()))},l.nn)),e.element.load().catch(t=>{n.Z.getLogger("esri.views.2d.layers.MediaLayerView2D").error(new m.Z("element-load-error","Element cannot be displayed",{element:e,error:t}))})}getMesh(e){throw Error("Method not implemented.")}destroy(){this._playHandle?.remove(),this._handles.forEach(e=>e.remove()),this.texture=(0,S.M2)(this.texture)}get textureSize(){return P}get dvsMat3(){return this.parent.dvsMat3}beforeRender(e){let{context:t}=e,r=this.elementView.element.content;if(null!=r){let e=r instanceof HTMLImageElement,n=r instanceof HTMLVideoElement,s=e?r.naturalWidth:n?r.videoWidth:r.width,a=e?r.naturalHeight:n?r.videoHeight:r.height;if(this._updatePerspectiveTransform(s,a),this.texture)n&&!r.paused&&(this.texture.setData(r),this.requestRender(),this.texture.generateMipmap());else{let e=new M.X;if(e.wrapMode=_.e8.CLAMP_TO_EDGE,e.preMultiplyAlpha=!0,e.width=s,e.height=a,"getFrame"in r){var i;"animationOptions"in this.elementView.element&&(this._playHandle=(0,T.hY)(r,(i=this.elementView.element.animationOptions)?{...i,playAnimation:i.playing,repeatType:i.repeatType?L[i.repeatType]:void 0}:{},null,r=>{this.texture?this.texture.setData(r):this.texture=new v.x(t,e,r),this.requestRender()}))}else this.texture=new v.x(t,e,r);this.texture.generateMipmap(),n&&!r.paused&&this.requestRender()}}super.beforeRender(e)}_createTransforms(){return null}draw(e){e.drawArrays(_.MX.TRIANGLE_STRIP,0,4)}updateDrawCoords(e,t,r,i){let{coords:n,bounds:s}=this.elementView;if(null==n||null==s)return;let[a,o,l,u]=n.rings[0],h=this._vertices,{x:c,y:p}=e;h.set([o[0]-c,o[1]-p,a[0]-c,a[1]-p,l[0]-c,l[1]-p,u[0]-c,u[1]-p]);let d=t;if(i){let[e,,t]=s,{worldWidth:r,xBounds:n}=i,[a,o]=n;e<a&&t>a?d=r:t>o&&e<o&&(d=-r)}this.wrapAroundShift=d,this.isWrapAround=0!==d}getVAO(e,t,r){if(null==this.elementView.coords)return null;let i=this._vertices;if(this._vao)this._geometryVbo.setData(i);else{this._geometryVbo=F.f.createVertex(e,_.l1.DYNAMIC_DRAW,i);let n=F.f.createVertex(e,_.l1.STATIC_DRAW,new Uint16Array([0,0,0,1,1,0,1,1,1,1,0,0,0,0,0,1,1,0,1,1]));this._vao=new O.U(e,r,t,{geometry:this._geometryVbo,tex:n})}return this._vao}_updatePerspectiveTransform(e,t){let r=this._vertices;(0,x.E)(Z,[0,0,e,0,0,t,e,t],[r[0],r[1],r[4],r[5],r[2],r[3],r[6],r[7]]),(0,R.t8)(this.perspectiveTransform,Z[6]/Z[8]*e,Z[7]/Z[8]*t)}}var I=r(21860),q=r(50338),V=r(1003);let j=class extends(0,q.y)(V.Z){constructor(){super(...arguments),this._overlayContainer=null,this._fetchQueue=null,this._tileStrategy=null,this._elementReferences=new Map,this._debugGraphicsView=null,this.layer=null,this.elements=new s.Z}attach(){this.addAttachHandles([(0,l.on)(()=>this.layer.effectiveSource,"refresh",()=>{this._tileStrategy.refresh(e=>this._updateTile(e)),this.requestUpdate()}),(0,l.on)(()=>this.layer.effectiveSource,"change",({element:e})=>this._elementUpdateHandler(e))]),this._overlayContainer=new I.Z,this.container.addChild(this._overlayContainer),this._fetchQueue=new w.Z({tileInfoView:this.view.featuresTilingScheme,concurrency:10,process:(e,t)=>this._queryElements(e,t)}),this._tileStrategy=new b.Z({cachePolicy:"purge",resampling:!0,acquireTile:e=>this._acquireTile(e),releaseTile:e=>this._releaseTile(e),tileInfoView:this.view.featuresTilingScheme}),this.requestUpdate()}detach(){this.elements.removeAll(),this._tileStrategy.destroy(),this._fetchQueue.destroy(),this._overlayContainer.removeAllChildren(),this.container.removeAllChildren(),this._elementReferences.clear(),this._debugGraphicsView?.destroy()}supportsSpatialReference(e){return!0}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}update(e){this._tileStrategy.update(e),this._debugGraphicsView?.update(e)}async hitTest(e,t){let r=[],i=e.normalize(),n=[i.x,i.y];for(let{projectedElement:{normalizedCoords:t,element:i}}of this._elementReferences.values())null!=t&&(0,p.wP)(t.rings,n)&&r.push({type:"media",element:i,layer:this.layer,mapPoint:e,sourcePoint:i.toSource(e)});return r.reverse()}canResume(){return null!=this.layer.source&&super.canResume()}async doRefresh(){this._fetchQueue.reset(),this._tileStrategy.refresh(e=>this._updateTile(e))}_acquireTile(e){let t=new N(e.clone());return this._updateTile(t),t}_updateTile(e){this._updatingHandles.addPromise(this._fetchQueue.push(e.key).then(t=>{let[r,i]=e.setElements(t);this._referenceElements(e,r),this._dereferenceElements(e,i),this.requestUpdate()},e=>{(0,o.D_)(e)||n.Z.getLogger(this).error(e)}))}_releaseTile(e){this._fetchQueue.abort(e.key.id),e.elements&&this._dereferenceElements(e,e.elements),this.requestUpdate()}async _queryElements(e,t){let r=this.layer.effectiveSource;if(null==r)return[];this.view.featuresTilingScheme.getTileBounds(U,e,!0);let i=new g.Z({xmin:U[0],ymin:U[1],xmax:U[2],ymax:U[3],spatialReference:this.view.spatialReference});return r.queryElements(i,t)}_referenceElements(e,t){if(null!=this.layer.source)for(let r of t)this._referenceElement(e,r)}_referenceElement(e,t){(0,a.s1)(this._elementReferences,t.uid,()=>{let e=new f.L({element:t,spatialReference:this.view.spatialReference}),r=new H(e);return this._overlayContainer.addChild(r),this.elements.add(t),{tiles:new Set,projectedElement:e,overlay:r,debugGraphic:null}}).tiles.add(e)}_dereferenceElements(e,t){for(let r of t)this._dereferenceElement(e,r)}_dereferenceElement(e,t){let r=this._elementReferences.get(t.uid);r.tiles.delete(e),r.tiles.size||(this._overlayContainer.removeChild(r.overlay),r.overlay.destroy(),r.projectedElement.destroy(),this._elementReferences.delete(t.uid),this.elements.remove(t),this._debugGraphicsView?.graphics.remove(r.debugGraphic))}_elementUpdateHandler(e){let t=this._elementReferences.get(e.uid);if(t){let r=t.projectedElement.normalizedCoords;if(null==r)return this._overlayContainer.removeChild(t.overlay),t.overlay.destroy(),t.projectedElement.destroy(),this._elementReferences.delete(e.uid),this.elements.remove(e),void this._debugGraphicsView?.graphics.remove(t.debugGraphic);let i=[],n=[];for(let e of this._tileStrategy.tiles){let s=k(this.view.featuresTilingScheme,e,r);t.tiles.has(e)?s||n.push(e):s&&i.push(e)}for(let t of i)this._referenceElement(t,e);for(let t of n)this._dereferenceElement(t,e);return t=this._elementReferences.get(e.uid),void(t?.debugGraphic&&(t.debugGraphic.geometry=t.projectedElement.normalizedCoords,this._debugGraphicsView.graphicUpdateHandler({graphic:t.debugGraphic,property:"geometry"})))}let r=new f.L({element:e,spatialReference:this.view.spatialReference}).normalizedCoords;if(null!=r)for(let t of this._tileStrategy.tiles)k(this.view.featuresTilingScheme,t,r)&&this._referenceElement(t,e)}};(0,i._)([(0,u.Cb)()],j.prototype,"layer",void 0),(0,i._)([(0,u.Cb)({readOnly:!0})],j.prototype,"elements",void 0),j=(0,i._)([(0,h.j)("esri.views.2d.layers.MediaLayerView2D")],j);let U=(0,c.Ue)(),D={xmin:0,ymin:0,xmax:0,ymax:0};function k(e,t,r){return e.getTileBounds(U,t.key,!0),D.xmin=U[0],D.ymin=U[1],D.xmax=U[2],D.ymax=U[3],(0,d.Nl)(D,r)}class N{constructor(e){this.key=e,this.elements=null,this.isReady=!1,this.visible=!0}setElements(e){let t=[],r=new Set(this.elements);for(let i of(this.elements=e,e))r.has(i)?r.delete(i):t.push(i);return this.isReady=!0,[t,Array.from(r)]}destroy(){}}let W=j},1003:function(e,t,r){r.d(t,{Z:function(){return m}});var i=r(86641),n=r(94761),s=r(60163),a=r(2090),o=r(65223),l=r(36152),u=r(31534),h=r(89312);r(37180),r(3457);var c=r(64186),p=r(66789),d=r(37864);let f=class extends(0,a.IG)((0,u.v)(s.Z.EventedMixin(n.Z))){constructor(e){super(e),this._updatingHandles=new p.R,this.layer=null,this.parent=null}initialize(){this.when().catch(e=>{if("layerview:create-error"!==e.name){let t=this.layer&&this.layer.id||"no id",r=this.layer?.title||"no title";o.Z.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${r}', id: '${t}')`,e)}})}destroy(){this._updatingHandles=(0,l.SC)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){return!0===this.layer?.visible}set visible(e){this._overrideIfSome("visible",e)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){let e=this.view.timeExtent,t=this.layer?.visibilityTimeExtent;return!e||!t||!e.intersection(t).isEmpty}canResume(){let e=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready&&(0,d.Cy)(e)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){let e=this.parent?.suspended?this.parent.suspendInfo:{};this.view?.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0);let t=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return(0,d.Cy)(t)&&this.visibleAtCurrentScale||(e.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(e.outsideVisibilityTimeExtent=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};(0,i._)([(0,h.Cb)()],f.prototype,"view",void 0),(0,i._)([(0,h.Cb)()],f.prototype,"fullOpacity",null),(0,i._)([(0,h.Cb)()],f.prototype,"layer",void 0),(0,i._)([(0,h.Cb)()],f.prototype,"parent",void 0),(0,i._)([(0,h.Cb)({readOnly:!0})],f.prototype,"suspended",null),(0,i._)([(0,h.Cb)({readOnly:!0})],f.prototype,"suspendInfo",null),(0,i._)([(0,h.Cb)({readOnly:!0})],f.prototype,"legendEnabled",null),(0,i._)([(0,h.Cb)({type:Boolean,readOnly:!0})],f.prototype,"updating",null),(0,i._)([(0,h.Cb)({readOnly:!0})],f.prototype,"updatingProgress",null),(0,i._)([(0,h.Cb)()],f.prototype,"updateSuspended",null),(0,i._)([(0,h.Cb)()],f.prototype,"visible",null),(0,i._)([(0,h.Cb)({readOnly:!0})],f.prototype,"visibleAtCurrentScale",null),(0,i._)([(0,h.Cb)({readOnly:!0})],f.prototype,"visibleAtCurrentTimeExtent",null);let m=f=(0,i._)([(0,c.j)("esri.views.layers.LayerView")],f)},76457:function(e,t,r){r.d(t,{Z:function(){return l}});var i=r(86641),n=r(689),s=r(89312);r(37180),r(65223),r(3457);var a=r(64186);let o=class extends n.wq{get version(){return this.commitVersionProperties(),(this._get("version")||0)+1}};(0,i._)([(0,s.Cb)({readOnly:!0})],o.prototype,"version",null);let l=o=(0,i._)([(0,a.j)("esri.views.layers.support.ClipArea")],o)},55485:function(e,t,r){r.d(t,{Z:function(){return f}});var i,n=r(86641);r(55066);var s=r(89312);r(37180),r(65223),r(3457);var a=r(64186),o=r(90389),l=r(5005),u=r(76457),h=r(9377),c=r(54001);let p={base:o.Z,key:"type",typeMap:{extent:h.Z,polygon:c.Z}},d=i=class extends u.Z{constructor(e){super(e),this.type="geometry",this.geometry=null}clone(){return new i({geometry:this.geometry?.clone()??null})}commitVersionProperties(){this.commitProperty("geometry")}};(0,n._)([(0,s.Cb)({types:p,json:{read:l.im,write:!0}})],d.prototype,"geometry",void 0);let f=d=i=(0,n._)([(0,a.j)("esri.views.layers.support.Geometry")],d)},37864:function(e,t,r){function i(e){return e&&"function"==typeof e.highlight}function n(e,t){if(t&&e){let{minScale:r,maxScale:i}=e;if(null!=r&&r>0||null!=i&&i>0)return null==t||t>=i&&(0===r||t<=r)}return!0}function s(e){return!e?.minScale||!e.maxScale||e.minScale>=e.maxScale}r.d(t,{Cy:function(){return s},GB:function(){return n},tl:function(){return i}})}}]);