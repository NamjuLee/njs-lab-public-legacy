(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[45540],{23356:function(e,t,n){"use strict";n.d(t,{H:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&r.util.assert("complex64"!==e.dtype,()=>`${t} does not support complex64 tensors in the CPU backend.`)})}},50111:function(e,t,n){"use strict";n.d(t,{bk:function(){return a},fC:function(){return o}});var r=n(94976),i=n(23356);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(e){let t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}let o={kernelName:r.Abs,backendName:"cpu",kernelFunc:e=>{let{x:t}=e.inputs,n=e.backend;(0,i.H)(t,"abs");let o=new Float32Array(r.util.sizeFromShape(t.shape));return o=a(n.data.get(t.dataId).values),n.makeOutput(o,t.shape,t.dtype)}}},43902:function(e,t,n){"use strict";n.d(t,{EH:function(){return o},IH:function(){return u},j4:function(){return l}});var r=n(94976),i=n(95592),a=n(84840);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.b)((e,t)=>e+t),s=(0,a.H)((e,t,n,r)=>({real:e+n,imag:t+r})),u=(0,a.j)(r.Add,o,s),l={kernelName:r.Add,backendName:"cpu",kernelFunc:u}},41903:function(e,t,n){"use strict";n.d(t,{W:function(){return i},i:function(){return a}});var r=n(94976);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n,i,a){let o=r.util.sizeFromShape(i),s=r.util.makeZerosTypedArray(a,n);for(let n=0;n<e.length;n++){let r=e[n];if(r<0)throw Error("Input x must be non-negative!");r>=a||(o>0?s[r]+=t[n]:s[r]+=1)}return s}function a(e,t,n,i=!1){let a=e.shape[0],o=e.shape[1],s=(0,r.buffer)([a,n],t.dtype);for(let r=0;r<a;r++)for(let a=0;a<o;a++){let o=e.get(r,a);if(o<0)throw Error("Input x must be non-negative!");o>=n||(i?s.set(1,r,o):t.size>0?s.set(s.get(r,o)+t.get(r,a),r,o):s.set(s.get(r,o)+1,r,o))}return s}},62722:function(e,t,n){"use strict";n.d(t,{T0:function(){return u},nv:function(){return o}});var r=n(94976),i=n(95592),a=n(84840);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.b)((e,t)=>e&t),s=(0,a.j)(r.BitwiseAnd,o),u={kernelName:r.BitwiseAnd,backendName:"cpu",kernelFunc:s}},26647:function(e,t,n){"use strict";n.d(t,{Mq:function(){return d},pj:function(){return c},sJ:function(){return l}});var r=n(94976),i=n(95592),a=n(84451),o=n(96110),s=n(59094),u=n(3271);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l(e,t,n,a){if("int32"===a)return[t,"int32",Int32Array.from(e)];if("bool"===a){let a=r.util.toTypedArray([0],n),[o,s]=(0,i.b)((e,t)=>e!==t?1:0)(t,[],e,a,"bool");return[s,"bool",o]}throw Error(`Error in Cast: failed to cast ${n} to ${a}`)}function c(e){let{inputs:t,backend:n,attrs:i}=e,{x:d}=t,{dtype:h}=i;if("complex64"===h){if("complex64"===d.dtype)return(0,s.y)({inputs:{x:d},backend:n});let e=(0,a.l)(n,d.shape,d.dtype),t=c({inputs:{x:d},backend:n,attrs:{dtype:"float32"}}),r=(0,o.P)({inputs:{real:t,imag:e},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),r}if("complex64"===d.dtype){let e=(0,u.k)({inputs:{input:d},backend:n}),t=c({inputs:{x:e},backend:n,attrs:{dtype:h}});return n.disposeIntermediateTensorInfo(e),t}if(!r.util.hasEncodingLoss(d.dtype,h)){let e=(0,s.y)({inputs:{x:d},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:h}}let[f,p,m]=l(n.data.get(d.dataId).values,d.shape,d.dtype,h);return n.makeTensorInfo(f,p,m)}let d={kernelName:r.Cast,backendName:"cpu",kernelFunc:c}},78116:function(e,t,n){"use strict";n.d(t,{__:function(){return o},y2:function(){return u}});var r=n(94976),i=n(87962),a=n(32497);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.a)(e=>Math.ceil(e)),s=(0,a.O)(r.Ceil,o),u={kernelName:r.Ceil,backendName:"cpu",kernelFunc:s}},96110:function(e,t,n){"use strict";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r(e){let{inputs:t,backend:n}=e,{real:r,imag:i}=t,a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",a),imag:n.makeTensorInfo(i.shape,"float32",o)},s}n.d(t,{P:function(){return r},z:function(){return i}});let i={kernelName:n(94976).Complex,backendName:"cpu",kernelFunc:r}},22578:function(e,t,n){"use strict";n.d(t,{j:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n,i){let a=r.util.getArrayFromDType(n,r.util.sizeFromShape(t));if(i&&"string"!==n){let t=0;e.forEach(e=>{let n=r.util.sizeFromShape(e.shape);a.set(e.vals,t),t+=n})}else{let i=0;e.forEach(e=>{let o="string"===n?r.backend_util.fromUint8ToStringArray(e.vals):e.vals,s=0;for(let n=0;n<e.shape[0];++n){let r=n*t[1]+i;for(let t=0;t<e.shape[1];++t)a[r+t]=o[s++]}i+=e.shape[1]})}return a}},4801:function(e,t,n){"use strict";n.d(t,{Dg:function(){return s},Kx:function(){return u},tW:function(){return o}});var r=n(94976),i=n(95592),a=n(84840);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.b)((e,t)=>e===t?1:0),s=(0,a.j)(r.Equal,o,null,"bool"),u={kernelName:r.Equal,backendName:"cpu",kernelFunc:s}},93980:function(e,t,n){"use strict";n.d(t,{Qq:function(){return s},Ro:function(){return o},SX:function(){return u}});var r=n(94976),i=n(87962),a=n(32497);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.a)(e=>Math.exp(e)),s=(0,a.O)(r.Exp,o,"float32"),u={kernelName:r.Exp,backendName:"cpu",kernelFunc:s}},73330:function(e,t,n){"use strict";n.d(t,{OF:function(){return o},Vu:function(){return u}});var r=n(94976),i=n(87962),a=n(32497);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.a)(e=>Math.expm1(e)),s=(0,a.O)(r.Expm1,o),u={kernelName:r.Expm1,backendName:"cpu",kernelFunc:s}},55573:function(e,t,n){"use strict";n.d(t,{Ao:function(){return u},r6:function(){return o}});var r=n(94976),i=n(87962),a=n(32497);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.a)(e=>Math.floor(e)),s=(0,a.O)(r.Floor,o),u={kernelName:r.Floor,backendName:"cpu",kernelFunc:s}},69257:function(e,t,n){"use strict";n.d(t,{EE:function(){return u},JP:function(){return o}});var r=n(94976),i=n(95592),a=n(84840);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.b)((e,t)=>Math.floor(e/t)),s=(0,a.j)(r.FloorDiv,o,null,"int32"),u={kernelName:r.FloorDiv,backendName:"cpu",kernelFunc:s}},54574:function(e,t,n){"use strict";n.d(t,{m:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n,i,a,o,s,u,l){let c=(0,r.buffer)([i,o],n);for(let n=0;n<i;n++){let r=[],i=0;for(let t=0;t<a;t++){let o=e[n*a+t];i+=o*s[t],r.push(o)}if(i<0||i>=l/o)throw Error(`Invalid indices: ${r} does not index into ${u}`);for(let e=0;e<o;e++)c.values[n*o+e]=t.get(...t.indexToLoc(i*o+e))}return c}},39437:function(e,t,n){"use strict";n.d(t,{i:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n){let i=(0,r.buffer)(n,e.dtype);for(let n=0;n<i.size;++n){let r=i.indexToLoc(n).slice(),a=r[0],o=r[2],s=t.locToIndex([a,o]);r[2]=t.values[s];let u=e.locToIndex(r);0<=u&&u<e.values.length&&(i.values[n]=e.values[u])}return i}},21771:function(e,t,n){"use strict";n.d(t,{Ce:function(){return u},o:function(){return o}});var r=n(94976),i=n(95592),a=n(84840);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.b)((e,t)=>e>t?1:0),s=(0,a.j)(r.Greater,o,null,"bool"),u={kernelName:r.Greater,backendName:"cpu",kernelFunc:s}},55552:function(e,t,n){"use strict";n.d(t,{HL:function(){return o},V:function(){return u}});var r=n(94976),i=n(95592),a=n(84840);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.b)((e,t)=>e>=t?1:0),s=(0,a.j)(r.GreaterEqual,o,null,"bool"),u={kernelName:r.GreaterEqual,backendName:"cpu",kernelFunc:s}},59094:function(e,t,n){"use strict";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}n.d(t,{I:function(){return i},y:function(){return r}});let i={kernelName:n(94976).Identity,backendName:"cpu",kernelFunc:r}},24277:function(e,t,n){"use strict";n.d(t,{rO:function(){return o},zh:function(){return u}});var r=n(94976),i=n(95592),a=n(84840);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.b)((e,t)=>e<t?1:0),s=(0,a.j)(r.Less,o,null,"bool"),u={kernelName:r.Less,backendName:"cpu",kernelFunc:s}},68123:function(e,t,n){"use strict";n.d(t,{lx:function(){return o},m3:function(){return u}});var r=n(94976),i=n(95592),a=n(84840);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.b)((e,t)=>e<=t?1:0),s=(0,a.j)(r.LessEqual,o,null,"bool"),u={kernelName:r.LessEqual,backendName:"cpu",kernelFunc:s}},67021:function(e,t,n){"use strict";n.d(t,{b:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n){let i=(t-e)/(n-1),a=r.util.makeZerosTypedArray(n,"float32");a[0]=e;for(let e=1;e<a.length;e++)a[e]=a[e-1]+i;return a}},72266:function(e,t,n){"use strict";n.d(t,{vX:function(){return o},xM:function(){return u}});var r=n(94976),i=n(87962),a=n(32497);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.a)(e=>Math.log(e)),s=(0,a.O)(r.Log,o),u={kernelName:r.Log,backendName:"cpu",kernelFunc:s}},28410:function(e,t,n){"use strict";n.d(t,{B:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n,i){let a=r.util.getTypedArrayFromDType(i,r.util.sizeFromShape(n));for(let n=0;n<a.length;++n){let r=n*t,i=e[r];for(let n=0;n<t;++n){let t=e[r+n];(Number.isNaN(t)||t>i)&&(i=t)}a[n]=i}return a}},29155:function(e,t,n){"use strict";n.d(t,{eJ:function(){return u},wS:function(){return o}});var r=n(94976),i=n(95592),a=n(84840);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.b)((e,t)=>Math.max(e,t)),s=(0,a.j)(r.Maximum,o),u={kernelName:r.Maximum,backendName:"cpu",kernelFunc:s}},49779:function(e,t,n){"use strict";n.d(t,{u0:function(){return u},vP:function(){return o}});var r=n(94976),i=n(95592),a=n(84840);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.b)((e,t)=>Math.min(e,t)),s=(0,a.j)(r.Minimum,o),u={kernelName:r.Minimum,backendName:"cpu",kernelFunc:s}},52873:function(e,t,n){"use strict";n.d(t,{$3:function(){return o},Jp:function(){return u},f$:function(){return l}});var r=n(94976),i=n(95592),a=n(84840);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.b)((e,t)=>e*t),s=(0,a.H)((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n})),u=(0,a.j)(r.Multiply,o,s),l={kernelName:r.Multiply,backendName:"cpu",kernelFunc:u}},14751:function(e,t,n){"use strict";n.d(t,{AF:function(){return s},uC:function(){return o}});var r=n(94976),i=n(23356),a=n(52873);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o(e,t,n){let i=r.util.createScalarValue(-1,n);return(0,a.$3)([],t,i,e,n)}let s={kernelName:r.Neg,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:r}=t;(0,i.H)(r,"neg");let[a,s]=o(n.data.get(r.dataId).values,r.shape,r.dtype);return n.makeTensorInfo(s,r.dtype,a)}}},74666:function(e,t,n){"use strict";n.d(t,{Gj:function(){return o},nP:function(){return u}});var r=n(94976),i=n(95592),a=n(84840);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.b)((e,t)=>e!==t?1:0),s=(0,a.j)(r.NotEqual,o,null,"bool"),u={kernelName:r.NotEqual,backendName:"cpu",kernelFunc:s}},54158:function(e,t,n){"use strict";n.d(t,{Iz:function(){return s},Qg:function(){return o}});var r=n(94976),i=n(23356),a=n(46985);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o(e,t,n,i){let[a,o]=r.backend_util.computeOutAndReduceShapes(e,i),s=(0,r.upcastType)(t,"int32"),u=r.util.makeZerosTypedArray(r.util.sizeFromShape(a),s),l=r.util.sizeFromShape(o);for(let e=0;e<u.length;++e){let t=e*l,r=1;for(let e=0;e<l;++e)r*=n[t+e];u[e]=r}return{outVals:u,outShape:a,outDtype:s}}let s={kernelName:r.Prod,backendName:"cpu",kernelFunc:function(e){let{inputs:t,backend:n,attrs:s}=e,{x:u}=t,{axis:l,keepDims:c}=s;(0,i.H)(u,"prod");let d=u.shape.length,h=r.util.parseAxisParam(l,u.shape),f=r.backend_util.getAxesPermutation(h,d),p=h,m=u,g=[];null!=f&&(g.push(m=(0,a.p)({inputs:{x:u},backend:n,attrs:{perm:f}})),p=r.backend_util.getInnerMostAxes(p.length,d));let x=n.data.get(m.dataId).values,{outVals:b,outShape:y,outDtype:v}=o(m.shape,m.dtype,x,p),w=y;return c&&(w=r.backend_util.expandShapeToKeepDim(y,h)),g.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(w,v,b)}}},9591:function(e,t,n){"use strict";n.d(t,{c:function(){return a}});var r=n(94976);function i(e,t){let n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function a(e,t,n,a,o,s,u,l){if(0===e.length)throw Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw Error("Split tensors must not be scalars");if(!/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){e.forEach((e,i)=>{if(e<0||e>=n){let a=r.util.indexToLoc(i,t.length,r.util.computeStrides(t)).join(",");throw Error(`indices[${a}] = ${e} is not in [0, ${n})`)}})}(s,u,t[0][0]-1),0===a.length)throw Error("params.rank must be nonzero");let{outSplits:c,valueSlices:d,numValues:h}=function(e,t,n,r){let i=[],a=0,o=Array(t.length-1+n.length).fill(null).map(()=>[0]);!function(e,t){for(let n=0;n<e.length;++n){let r=e[n],i=n===e.length-1?t:e[n+1].length;if(0===r.length)throw Error("Ragged splits may not be empty");if(r[0]<0)throw Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw Error("Ragged splits must not point past values");for(let e=1;e<r.length;++e)if(r[e-1]>r[e])throw Error("Ragged splits must be sorted in ascending order")}}(n,r);let s=1;for(let e=0;e<t.length-1;++e){s*=t[e];let n=t[e+1];for(let t=1;t<s+1;++t)o[e].push(t*n)}for(let r=0;r<e.length;++r){let s=e[r],u=e[r]+1;for(let e=0;e<n.length;++e){let r=n[e],i=e+t.length-1;if(i>=0){let e=o[i],t=e[e.length-1]-r[s];for(let e=s;e<u;++e)o[i].push(r[e+1]+t)}s=r[s],u=r[u]}u!==s&&(i.push([s,u]),a+=u-s)}return{outSplits:o,valueSlices:i,numValues:a}}(s,u,e,a[0]),f=function(e){let t=[];for(let n=0;n<e.length;++n){let i=e[n].length,a=r.util.getArrayFromDType("int32",i);t.push(a),e[n].forEach((e,t)=>a[t]=e)}return t}(c),p=function(e,t,n,a,o){let s=t.slice();s[0]=o;let u=r.util.getArrayFromDType(n,r.util.sizeFromShape(s)),l=e.length,c=0===l?0:l/t[0];return!function(e,t,n,r,a,o){let s=i(t,2)[1],u=i(o,2)[1],l=0;for(let t of n)for(let n=t[0];n<t[1];++n){for(let t=0;t<r;++t)a[l*u+t]=e[n*s+t];++l}}(e,t,a,c,u,s),[u,s]}(n,a,o,d,h);return[f,p[0],p[1]]}},38873:function(e,t,n){"use strict";n.d(t,{S:function(){return i}});var r=n(94976);function i(e,t,n,i,a,o,s){if(t.length>1)throw Error("starts must be a scalar or vector");if(a.length>1)throw Error("limits must be a scalar or vector");if(s.length>1)throw Error("deltas must be a scalar or vector");let u=0===t.length,l=0===a.length,c=0===s.length,d=[];u||d.push(t[0]),l||d.push(a[0]),c||d.push(s[0]);for(let e=1;e<d.length;++e)if(d[e]!==d[e-1])throw Error("starts, limits, and deltas must have the same shape");let h=0===d.length?1:d[0],f=r.util.getArrayFromDType("int32",h+1);f[0]=0;for(let t=0;t<h;++t){let n;let r=u?e[0]:e[t],a=l?i[0]:i[t],s=c?o[0]:o[t];if(0===s)throw Error("Requires delta != 0");if(s>0&&a<r||s<0&&a>r)n=0;else if((n=Math.ceil(Math.abs((a-r)/s)))>2147483647)throw Error("Requires ((limit - start) / delta) <= 2147483647");f[t+1]=f[t]+n}let p=f[h],m=r.util.getArrayFromDType(n,p),g=0;for(let t=0;t<h;++t){let n=f[t+1]-f[t],r=u?e[0]:e[t],i=c?o[0]:o[t];for(let e=0;e<n;++e)m[g++]=r,r+=i}return[f,m]}},34078:function(e,t,n){"use strict";n.d(t,{p:function(){return u}});var r=n(94976),i=r.backend_util.RowPartitionType;class a{constructor(e,t,n,i,a,o,s,u,l,c){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=i,this.valuesDType=a,this.defaultValue=o,this.defaultValueShape=s,this.rowPartitionValues=u,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=r.backend_util.getRowPartitionTypesHelper(c),this.raggedRank=r.backend_util.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===i.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===i.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){let t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case i.VALUE_ROWIDS:return a.getMaxWidthValueRowID(t);case i.ROW_SPLITS:return a.getMaxWidthRowSplit(t);default:throw Error(`Cannot handle partition type ${i[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){let t=e.length;if(0===t||1===t)return 0;let n=0;for(let r=0;r<t-1;++r){let t=e[r+1]-e[r];t>n&&(n=t)}return n}static getMaxWidthValueRowID(e){let t=e.length;if(0===t)return 0;let n=0,r=e[0],i=0;for(let a=1;a<t;++a){let t=e[a];t!==r&&(r=t,i=Math.max(a-n,i),n=a)}return Math.max(t-n,i)}tensorShapeFromTensor(e,t,n=!0){if(0===t.length){if(-1===e[0])return[];throw Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return s(e,n)}calculateOutputSize(e){let t=this.valuesShape,n=this.defaultValueShape;r.backend_util.validateDefaultValueShape(n,t);let i=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=r.backend_util.combineRaggedTensorToTensorShapes(this.raggedRank,i,t);a[0]<0&&(a[0]=e);for(let e=1;e<=this.raggedRank;++e)a[e]<0&&(a[e]=this.getMaxWidth(e));return a}calculateFirstParentOutputIndex(e,t,n){let i=Math.min(e,n),a=[],o=0;for(let e=0;e<i;++e,o+=t)a.push(o);for(let t=i;t<e;++t)a.push(-1);return r.util.assert(a.length===e,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(e,t,n,r){let i=e.length,a=[];for(let o=0;o<i-1;++o){let i=e[o+1]-e[o],s=Math.min(r,i),u=t[o];-1===u&&(s=0);for(let e=0;e<s;++e)a.push(u),u+=n;for(let e=0;e<i-s;++e)a.push(-1)}if(i>0&&a.length!==e[i-1])throw Error("Invalid row split size.");return a}calculateOutputIndexValueRowID(e,t,n,r){let i=e.length,a=[];if(0===i)return[];let o=0,s=e[0];if(s>=t.length)throw Error(`Got currentValueRowId=${s}, which is not less than ${t.length}`);let u=t[s];a.push(u);for(let l=1;l<i;++l){let i=e[l];if(i===s)u>=0&&(++o<r?u+=n:u=-1);else{if(o=0,s=i,i>=t.length)throw Error(`Got nextValueRowId=${i} which is not less than ${t.length}`);u=t[i]}a.push(u)}if(a.length!==e.length)throw Error("Invalid row ids.");return a}calculateOutputIndex(e,t,n,r){let a=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case i.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,n,r);case i.ROW_SPLITS:if(a.length-1>t.length)throw Error(`Row partition size is greater than output size: ${a.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(a,t,n,r);default:throw Error(`Unsupported partition type: ${i[o]}`)}}getFirstDimensionSize(){let e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw Error("No row_partition_types given.");let t=this.rowPartitionTypes[0];switch(t){case i.FIRST_DIM_SIZE:return e[0];case i.VALUE_ROWIDS:throw Error("Cannot handle VALUE_ROWIDS in first dimension.");case i.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw Error(`Cannot handle type ${i[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw Error("Invalid first partition input. Tensor requires at least one element.");let e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=Array(this.raggedRank+1);n[n.length-1]=1;for(let e=n.length-2;e>=0;--e)n[e]=n[e+1]*t[e+1];let i=s(t,!1),a=r.util.getArrayFromDType(this.valuesDType,r.util.sizeFromShape(i));if(n[0]*t[0]>0){let r=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let e=1;e<=this.raggedRank;++e)r=this.calculateOutputIndex(e-1,r,n[e],t[e]);this.setOutput(this.raggedRank,r,a,i)}return[i,a]}setOutput(e,t,n,i){if(0===n.length)return;let a=this.values,s=i.slice();s=s.slice(e+1);let u=r.util.sizeFromShape(s),l=t.length,c=this.defaultValue;if(c.length!==u&&1!==c.length){let e=this.defaultValueShape;(0,r.tidy)(()=>{let t=(0,r.reshape)(c,e);c=(0,r.broadcastTo)(t,s).dataSync()})}let d=0,h=0,f=0;for(let e=0;e<=l;++e){let r=e<l?t[e]:-1;if(r===f){++f;continue}if(h<f){let e=a.subarray(d*u);o(n.subarray(h*u),e,(f-h)*u)}if(e>=l&&(r=Math.floor(n.length/u)),r>f){if(1===this.defaultValue.length)n.subarray(f*u,r*u).fill(this.defaultValue[0]),f=r;else for(;r>f;)o(n.slice(f*u),c,u),++f}r<0?(d=e+1,h=f):(d=e,f=(h=f)+1)}}}function o(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function s(e,t){let n=[];for(let r of e){if(r<0){if(!t)throw Error(`Dimension ${r} must be >= 0`);if(r<-1)throw Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function u(e,t,n,r,i,o,s,u,l,c){return new a(e,t,n,r,i,o,s,u,l,c).compute()}},61304:function(e,t,n){"use strict";n.d(t,{b:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n,i){let a=e<t&&n<0,o=t<e&&n>1;if(e===t||a||o)return r.util.makeZerosTypedArray(0,i);let s=Math.abs(Math.ceil((t-e)/n)),u=r.util.makeZerosTypedArray(s,i);t<e&&1===n&&(n=-1),u[0]=e;for(let e=1;e<u.length;e++)u[e]=u[e-1]+n;return u}},3271:function(e,t,n){"use strict";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r(e){let{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.real,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}n.d(t,{O:function(){return i},k:function(){return r}});let i={kernelName:n(94976).Real,backendName:"cpu",kernelFunc:r}},75857:function(e,t,n){"use strict";n.d(t,{FY:function(){return u},zd:function(){return o}});var r=n(94976),i=n(87962),a=n(32497);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.a)(e=>1/Math.sqrt(e)),s=(0,a.O)(r.Rsqrt,o),u={kernelName:r.Rsqrt,backendName:"cpu",kernelFunc:s}},43972:function(e,t,n){"use strict";n.d(t,{N:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n,i,a,o,s,u,l,c){let d=e.values,h=t.values;if(0===i)return(0,r.buffer)(n,t.dtype);let f=l instanceof r.TensorBuffer?l:(0,r.buffer)([i/a,a],t.dtype);"string"==typeof l?f.values.fill(l):"number"==typeof l?f.values.fill(l):"boolean"==typeof l&&f.values.fill(+l);for(let e=0;e<o;e++){let r=[],o=0;for(let t=0;t<s;t++){let n=d[e*s+t];r.push(n),o+=n*u[t]}if(o<0||o>=i/a)throw Error(`Invalid indices: ${r} does not index into ${n}`);for(let n=0;n<a;n++)c?f.values[o*a+n]+=h[e*a+n]:f.values[o*a+n]=0===t.rank?h[0]:h[e*a+n]}return f}},95721:function(e,t,n){"use strict";n.d(t,{BP:function(){return u},VY:function(){return o},XD:function(){return s}});var r=n(94976),i=n(87962),a=n(32497);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.a)(e=>1/(1+Math.exp(-e))),s=(0,a.A)(r.Sigmoid,e=>1/(1+Math.exp(-e))),u={kernelName:r.Sigmoid,backendName:"cpu",kernelFunc:s}},95014:function(e,t,n){"use strict";n.d(t,{C6:function(){return s},rT:function(){return a},tP:function(){return o}});var r=n(94976),i=n(23356);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(e,t,n,i,a){let o=r.slice_util.isSliceContinous(i,t,n),s=r.util.sizeFromShape(n),u=r.util.computeStrides(i);if(o){let n=r.slice_util.computeFlatOffset(t,u);return"string"===a?e.slice(n,n+s):e.subarray(n,n+s)}let l="string"===a?r.backend_util.fromUint8ToStringArray(e):e,c=(0,r.buffer)(i,a,l),d=(0,r.buffer)(n,a);for(let e=0;e<d.size;++e){let n=d.indexToLoc(e),r=n.map((e,n)=>e+t[n]);d.set(c.get(...r),...n)}return"string"===a?r.backend_util.fromStringArrayToUint8(d.values):d.values}function o(e){let{inputs:t,backend:n,attrs:o}=e,{x:s}=t,{begin:u,size:l}=o;(0,i.H)(s,"slice");let[c,d]=r.slice_util.parseSliceParams(s,u,l);r.slice_util.assertParamsValid(s,c,d);let h=a(n.data.get(s.dataId).values,c,d,s.shape,s.dtype);return n.makeTensorInfo(d,s.dtype,h)}let s={kernelName:r.Slice,backendName:"cpu",kernelFunc:o}},79292:function(e,t,n){"use strict";n.d(t,{c:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n,i,a,o,s){let u=t[0],l=o[0],c=Array(l),d=Array(u),h=t[1];if(0===l){if(0!==u)throw Error(r.backend_util.getSparseFillEmptyRowsIndicesDenseShapeMismatch(u));return[r.util.getArrayFromDType(n,0),[0,h],r.util.getArrayFromDType(a,0),c,d]}let f=!0,p=0,m=Array(l).fill(0);for(let t=0;t<u;++t){let n=e[t*h];if(n<0)throw Error(r.backend_util.getSparseFillEmptyRowsNegativeIndexErrorMessage(t,n));if(n>=l)throw Error(r.backend_util.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(t,n,l));++m[n],f=f&&n>=p,p=n}let g=!0;for(let e=0;e<l;++e){let t=0===m[e];c[e]=t,g=g&&!t,m[e]=Math.max(m[e],1),e>0&&(m[e]+=m[e-1])}if(g&&f){for(let e=0;e<u;++e)d[e]=e;return[e,[u,h],i,c,d]}{let t=m[l-1],o=r.util.getArrayFromDType(n,t*h),f=r.util.getArrayFromDType(a,t),p=Array(l).fill(0);for(let t=0;t<u;++t){let n=e[t*h],r=p[n],a=(0===n?0:m[n-1])+r;p[n]++;for(let n=0;n<h;++n)o[a*h+n]=e[t*h+n];f[a]=i[t],d[t]=a}for(let e=0;e<l;++e)if(0===p[e]){let t=0===e?0:m[e-1];o[t*h+0]=e;for(let e=1;e<h;++e)o[t*h+e]=0;f[t]=s}return[o,[t,h],f,c,d]}}},40349:function(e,t,n){"use strict";n.d(t,{U:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n,i,a){let o=r.util.sizeFromShape(i),s=t[0],u=a.length,l=[],c=1,d=-1;for(let e=0;e<u;++e){let t=a[e];if(-1===t){if(-1!==d)throw Error(r.backend_util.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(d,e));d=e,l.push(1)}else{if(t<0)throw Error(r.backend_util.getSparseReshapeNegativeOutputDimErrorMessage(e,t));c*=t,l.push(t)}}if(-1!==d){if(c<=0)throw Error(r.backend_util.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());let e=Math.trunc(o/c);if(c*e!==o)throw Error(r.backend_util.getSparseReshapeInputOutputMultipleErrorMessage(i,l));l[d]=e}if(r.util.sizeFromShape(l)!==o)throw Error(r.backend_util.getSparseReshapeInputOutputMismatchErrorMessage(i,l));let h=i.length,f=[];if(h>0){f[h-1]=1;for(let e=h-2;e>=0;--e)f[e]=f[e+1]*i[e+1]}let p=[];if(u>0){p[u-1]=1;for(let e=u-2;e>=0;--e)p[e]=p[e+1]*l[e+1]}let m=r.util.getArrayFromDType(n,s*u);for(let t=0;t<s;++t){let n=0;for(let r=0;r<h;++r)n+=e[t*h+r]*f[r];for(let e=0;e<u;++e)m[t*u+e]=Math.trunc(n/p[e]),n%=p[e]}return[m,[s,u],l]}},40292:function(e,t,n){"use strict";n.d(t,{V:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n,i,a,o=!1,s=0){let u=i.length,l=[t[0],e.length/t[0]],c=l[1],d=u>0?a[u-1]+1:0;if(d<0)throw Error(r.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let h=t.slice();h[0]=d;let f=h.reduce((e,t)=>e*t,1),p=r.util.getArrayFromDType(n,f);if(0===u)return d>0&&p.fill(s),[p,h];if(d<=0)throw Error(r.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let m=0,g=1,x=0,b=a[0];for(;;){let t=0;if(g<u){if(b===(t=a[g])){++g;continue}if(b>=t)throw Error(r.backend_util.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(b<0||b>=d)throw Error(r.backend_util.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(b,d));b>x&&p.fill(s,x*c,b*c);for(let t=m;t<g;++t){let n=i[t];if(n<0||n>=l[0])throw Error(r.backend_util.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(t,i[t],l[0]));for(let t=0;t<c;t++)p[b*c+t]+=e[n*c+t]}if(o)for(let e=0;e<c;e++)p[b*c+e]/=g-m;if(m=g,++g,x=b+1,b=t,g>u)break}return x<d&&p.fill(s,x*c,d*c),[p,h]}},7824:function(e,t,n){"use strict";n.d(t,{cz:function(){return u},zT:function(){return o}});var r=n(94976),i=n(87962),a=n(32497);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.a)(e=>Math.sqrt(e)),s=(0,a.A)(r.Sqrt,e=>Math.sqrt(e)),u={kernelName:r.Sqrt,backendName:"cpu",kernelFunc:s}},75649:function(e,t,n){"use strict";n.d(t,{Hz:function(){return o},MS:function(){return u}});var r=n(94976),i=n(95592),a=n(84840);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.b)((e,t)=>{let n=e-t;return n*n}),s=(0,a.j)(r.SquaredDifference,o),u={kernelName:r.SquaredDifference,backendName:"cpu",kernelFunc:s}},29901:function(e,t,n){"use strict";n.d(t,{P:function(){return o},j:function(){return u}});var r=n(94976),i=n(87962),a=n(32497);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.a)((e,t)=>{let{pattern:n,replaceGlobal:r,rewrite:i}=t;return e.replace(new RegExp(n,r?"g":""),i)}),s=(0,a.O)(r.StaticRegexReplace,o),u={kernelName:r.StaticRegexReplace,backendName:"cpu",kernelFunc:s}},23582:function(e,t,n){"use strict";n.d(t,{t:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n,i){let a=(0,r.buffer)(e,t.dtype);for(let e=0;e<a.size;e++){let r=a.indexToLoc(e),o=Array(r.length);for(let e=0;e<o.length;e++)o[e]=r[e]*n[e]+i[e];a.set(t.get(...o),...r)}return a}},16468:function(e,t,n){"use strict";n.d(t,{A:function(){return a}});var r=n(94976);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i{constructor(e,t,n,i,a,o){this.separator=r.util.encodeString(e),this.nGramWidths=t,this.leftPad=r.util.encodeString(n),this.rightPad=r.util.encodeString(i),this.padWidth=a,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){return Math.max(0,e+2*this.getPadWidth(t)-t+1)}createNGrams(e,t,n,r,i,a){for(let o=0;o<i;++o){let s;let u=this.getPadWidth(a),l=Math.max(0,u-o),c=Math.max(0,u-(i-(o+1))),d=a-(l+c),h=t+(l>0?0:o-u);s=0+l*this.leftPad.length;for(let t=0;t<d;++t)s+=e[h+t].length;s+=c*this.rightPad.length+(l+c+d-1)*this.separator.length,n[r+o]=new Uint8Array(s);let f=n[r+o],p=0,m=e=>e.forEach(e=>f[p++]=e);for(let e=0;e<l;++e)m(this.leftPad),m(this.separator);for(let t=0;t<d-1;++t)m(e[h+t]),m(this.separator);if(d>0){m(e[h+d-1]);for(let e=0;e<c;++e)m(this.separator),m(this.rightPad)}else{for(let e=0;e<c-1;++e)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,t){let n=e.length,i=t.length;if(i>0){let e=t[0];if(0!==e)throw Error(`First split value must be 0, got ${e}`);for(let r=1;r<i;++r){let i=t[r]>=e;if(!(i=i&&t[r]<=n))throw Error(`Invalid split value ${t[r]}, must be in [${e}, ${n}]`);e=t[r]}if(e!==n)throw Error(`Last split value must be data size. Expected ${n}, got ${e}`)}let a=i-1,o=r.util.getArrayFromDType("int32",i);if(0===n||0===i){let e=Array(n);for(let e=0;e<=a;++e)o[e]=0;return[e,o]}o[0]=0;for(let e=1;e<=a;++e){let n=t[e]-t[e-1],r=0;this.nGramWidths.forEach(e=>{r+=this.getNumNGrams(n,e)}),this.preserveShort&&n>0&&0===r&&(r=1),o[e]=o[e-1]+r}let s=Array(o[a]);for(let n=0;n<a;++n){let r=t[n],i=o[n];if(this.nGramWidths.forEach(a=>{let o=t[n+1]-t[n],u=this.getNumNGrams(o,a);this.createNGrams(e,r,s,i,u,a),i+=u}),this.preserveShort&&i===o[n]){let a=t[n+1]-t[n];if(0===a)continue;let o=a+2*this.padWidth;this.createNGrams(e,r,s,i,1,o)}}return[s,o]}}function a(e,t,n,r,a,o,s,u){return new i(n,r,a,o,s,u).compute(e,t)}},75297:function(e,t,n){"use strict";n.d(t,{Q:function(){return i}});var r=n(94976);function i(e,t,n){let i=e.length,a=[],o=0,s=0,u=Array(i);for(let r=0;r<i;++r){let i=a.length;!/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)r.push(e.subarray(t,t+1));return}if(1===t.length){let i=t[0],a=e.indexOf(i);for(;-1!==a;){let t=e.subarray(0,a);n&&0===t.length||r.push(t),a=(e=e.subarray(a+1)).indexOf(i)}n&&0===e.length||r.push(e);return}let i=0;for(let a=0;a<e.length+1;a++)if(a===e.length||-1!==t.indexOf(e[a])){let t=e.subarray(i,a);n&&0===t.length||r.push(t),i=a+1}}(e[r],t,n,a);let l=a.length-i;u[r]=l,o+=l,s=Math.max(s,l)}let l=r.util.getArrayFromDType("int32",2*o),c=Array(o),d=[i,s],h=0;for(let e=0;e<i;++e)for(let t=0;t<u[e];++t)l[2*h]=e,l[2*h+1]=t,c[h]=a[h],++h;return[l,c,d]}},57347:function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t){let n=r.util.getArrayFromDType("int32",e.length);for(let i=0;i<e.length;++i)n[i]=r.util.fingerPrint64(e[i]).modulo(t).getLowBitsUnsigned();return n}},8968:function(e,t,n){"use strict";n.d(t,{GR:function(){return l},VY:function(){return o},lu:function(){return u}});var r=n(94976),i=n(95592),a=n(84840);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.b)((e,t)=>e-t),s=(0,a.H)((e,t,n,r)=>({real:e-n,imag:t-r})),u=(0,a.j)(r.Sub,o,s),l={kernelName:r.Sub,backendName:"cpu",kernelFunc:u}},13387:function(e,t,n){"use strict";n.d(t,{R:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t){let n=Array(e.rank);for(let r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];let i=(0,r.buffer)(n,e.dtype);for(let t=0;t<i.values.length;++t){let n=i.indexToLoc(t),r=Array(e.rank);for(let t=0;t<r.length;t++)r[t]=n[t]%e.shape[t];let a=e.locToIndex(r);i.values[t]=e.values[a]}return i}},21399:function(e,t,n){"use strict";n.d(t,{W:function(){return a}});var r=n(94976);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let i=(e,t)=>{let n=t.value-e.value;return 0===n?e.index-t.index:n};function a(e,t,n,a,o){let s=t[t.length-1],[u,l]=[e.length/s,s],c=r.util.getTypedArrayFromDType(n,u*a),d=r.util.getTypedArrayFromDType("int32",u*a);for(let t=0;t<u;t++){let n=t*l,s=e.subarray(n,n+l),u=Array(s.length);s.forEach((e,t)=>u[t]={value:e,index:t}),a<u.length&&(function e(t,n,a=0,o=t.length-1){for(;o>a;){if(o-a>600){let r=o-a+1,i=n-a+1,s=Math.log(r),u=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*u*(r-u)/r)*Math.sign(i-r/2),c=Math.max(a,Math.floor(n-i*u/r+l)),d=Math.min(o,Math.floor(n+(r-i)*u/r+l));e(t,n,c,d)}let s=t[n],u=a,l=o;for(r.util.swap(t,a,n),i(t[o],s)>0&&r.util.swap(t,a,o);u<l;){for(r.util.swap(t,u,l),u++,l--;0>i(t[u],s);)u+=1;for(;i(t[l],s)>0;)l-=1}0===i(t[a],s)?r.util.swap(t,a,l):(l+=1,r.util.swap(t,l,o)),l<=n&&(a=l+1),n<=l&&(o=l-1)}}(u,a),u=u.slice(0,a)),o&&u.sort(i);let h=t*a,f=c.subarray(h,h+a),p=d.subarray(h,h+a);for(let e=0;e<a;e++)f[e]=u[e].value,p[e]=u[e].index}let h=t.slice();return h[h.length-1]=a,[(0,r.buffer)(h,n,c),(0,r.buffer)(h,"int32",d)]}},46985:function(e,t,n){"use strict";n.d(t,{b:function(){return s},p:function(){return o}});var r=n(94976),i=n(23356),a=n(2379);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o(e){let{inputs:t,attrs:n,backend:r}=e,{x:o}=t,{perm:s}=n;(0,i.H)(o,"transpose");let u=Array(o.shape.length);for(let e=0;e<u.length;e++)u[e]=o.shape[s[e]];let l=r.data.get(o.dataId).values,c=(0,a.H)(l,o.shape,o.dtype,s,u);return{dataId:r.write(c,u,o.dtype),shape:u,dtype:o.dtype}}let s={kernelName:r.Transpose,backendName:"cpu",kernelFunc:o}},2379:function(e,t,n){"use strict";n.d(t,{H:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n,i,a){let o=t.length,s=r.util.sizeFromShape(t),u=r.util.computeStrides(t),l=r.util.computeStrides(a),c=r.util.getTypedArrayFromDType(n,r.util.sizeFromShape(a));for(let t=0;t<s;++t){let n=r.util.indexToLoc(t,o,u),a=Array(n.length);for(let e=0;e<a.length;e++)a[e]=n[i[e]];c[r.util.locToIndex(a,o,l)]=e[t]}return c}},5433:function(e,t,n){"use strict";n.d(t,{S:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n,i){let a=r.util.parseAxisParam(t,n)[0],o=[1,n[0],1];for(let e=0;e<a;e++)o[0]*=n[e];o[1]=n[a];for(let e=a+1;e<n.length;e++)o[2]*=n[e];let s=new Map,u=new Int32Array(n[a]),l=new r.TensorBuffer(o,i,e),c=[],d=1===o[0]&&1===o[2];for(let t=0;t<n[a];t++){let n;if(d)n=e[t].toString();else{let e=[];for(let n=0;n<o[0];n++)for(let r=0;r<o[2];r++)e.push(l.get(n,t,r));n=e.join(",")}let r=s.get(n);if(null!=r)u[t]=r;else{let e=s.size;s.set(n,e),u[t]=e,c.push(t)}}let h=o.slice();h[1]=s.size;let f=new r.TensorBuffer(h,i);c.forEach((e,t)=>{for(let n=0;n<o[0];n++)for(let r=0;r<o[2];r++)f.set(l.get(n,e,r),n,t,r)});let p=n.slice();return p[a]=h[1],{outputValues:f.values,outputShape:p,indices:u}}},69095:function(e,t,n){"use strict";n.r(t),n.d(t,{addImpl:function(){return i.EH},bincountImpl:function(){return a.W},bincountReduceImpl:function(){return a.i},bitwiseAndImpl:function(){return o.nv},castImpl:function(){return s.sJ},ceilImpl:function(){return u.__},concatImpl:function(){return l.j},equalImpl:function(){return c.tW},expImpl:function(){return d.Ro},expm1Impl:function(){return h.OF},floorDivImpl:function(){return p.JP},floorImpl:function(){return f.r6},gatherNdImpl:function(){return m.m},gatherV2Impl:function(){return g.i},greaterEqualImpl:function(){return b.HL},greaterImpl:function(){return x.o},lessEqualImpl:function(){return v.lx},lessImpl:function(){return y.rO},linSpaceImpl:function(){return w.b},logImpl:function(){return k.vX},maxImpl:function(){return C.B},maximumImpl:function(){return I.wS},minimumImpl:function(){return $.vP},multiplyImpl:function(){return S.$3},negImpl:function(){return E.uC},notEqualImpl:function(){return _.Gj},prodImpl:function(){return T.Qg},raggedGatherImpl:function(){return N.c},raggedRangeImpl:function(){return R.S},raggedTensorToTensorImpl:function(){return A.p},rangeImpl:function(){return F.b},rsqrtImpl:function(){return O.zd},scatterImpl:function(){return B.N},sigmoidImpl:function(){return D.VY},simpleAbsImpl:function(){return r.bk},sliceImpl:function(){return P.rT},sparseFillEmptyRowsImpl:function(){return M.c},sparseReshapeImpl:function(){return V.U},sparseSegmentReductionImpl:function(){return L.V},sqrtImpl:function(){return W.zT},squaredDifferenceImpl:function(){return G.Hz},staticRegexReplaceImpl:function(){return U.P},stridedSliceImpl:function(){return z.t},stringNGramsImpl:function(){return X.A},stringSplitImpl:function(){return H.Q},stringToHashBucketFastImpl:function(){return K.h},subImpl:function(){return q.VY},tileImpl:function(){return j.R},topKImpl:function(){return Y.W},transposeImpl:function(){return Q.H},uniqueImpl:function(){return Z.S}});var r=n(50111),i=n(43902),a=n(41903),o=n(62722),s=n(26647),u=n(78116),l=n(22578),c=n(4801),d=n(93980),h=n(73330),f=n(55573),p=n(69257),m=n(54574),g=n(39437),x=n(21771),b=n(55552),y=n(24277),v=n(68123),w=n(67021),k=n(72266),C=n(28410),I=n(29155),$=n(49779),S=n(52873),E=n(14751),_=n(74666),T=n(54158),N=n(9591),R=n(38873),A=n(34078),F=n(61304),O=n(75857),B=n(43972),D=n(95721),P=n(95014),M=n(79292),V=n(40349),L=n(40292),W=n(7824),G=n(75649),U=n(29901),z=n(23582),X=n(16468),H=n(75297),K=n(57347),q=n(8968),j=n(13387),Y=n(21399),Q=n(2379),Z=n(5433);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */},95592:function(e,t,n){"use strict";n.d(t,{b:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e){return(t,n,i,a,o)=>{let s=r.backend_util.assertAndGetBroadcastShape(t,n),u=s.length,l=r.util.computeStrides(s),c=r.util.sizeFromShape(s),d=r.util.getTypedArrayFromDType(o,c),h=t.length,f=n.length,p=r.util.computeStrides(t),m=r.util.computeStrides(n),g=r.backend_util.getBroadcastDims(t,s),x=r.backend_util.getBroadcastDims(n,s);if(g.length+x.length===0)for(let t=0;t<d.length;++t)d[t]=e(i[t%i.length],a[t%a.length]);else for(let t=0;t<d.length;++t){let n=r.util.indexToLoc(t,u,l),o=n.slice(-h);g.forEach(e=>o[e]=0);let s=r.util.locToIndex(o,h,p),c=n.slice(-f);x.forEach(e=>c[e]=0);let b=r.util.locToIndex(c,f,m);d[t]=e(i[s],a[b])}return[d,s]}}},84840:function(e,t,n){"use strict";n.d(t,{H:function(){return u},j:function(){return s}});var r=n(94976),i=n(23356),a=n(26647),o=n(96110);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s(e,t,n,s){return null==n?({inputs:n,backend:a})=>{let{a:o,b:u}=n;(0,i.H)([o,u],e);let l=a.data.get(o.dataId).values,c=a.data.get(u.dataId).values,d="string"===o.dtype?r.backend_util.fromUint8ToStringArray(l):l,h="string"===o.dtype?r.backend_util.fromUint8ToStringArray(c):c,f=s||o.dtype,[p,m]=t(o.shape,u.shape,d,h,f);return a.makeTensorInfo(m,f,p)}:({inputs:e,backend:r})=>{let{a:i,b:u}=e;if("complex64"===i.dtype||"complex64"===u.dtype){let e=(0,a.pj)({inputs:{x:i},backend:r,attrs:{dtype:"complex64"}}),t=r.data.get(e.dataId),s=t.complexTensorInfos.real,l=t.complexTensorInfos.imag,c=r.data.get(s.dataId).values,d=r.data.get(l.dataId).values,h=(0,a.pj)({inputs:{x:u},backend:r,attrs:{dtype:"complex64"}}),f=r.data.get(h.dataId),p=f.complexTensorInfos.real,m=f.complexTensorInfos.imag,g=r.data.get(p.dataId).values,x=r.data.get(m.dataId).values,[b,y,v]=n(i.shape,u.shape,c,d,g,x),w=r.makeTensorInfo(v,"float32",b),k=r.makeTensorInfo(v,"float32",y),C=(0,o.P)({inputs:{real:w,imag:k},backend:r});return r.disposeIntermediateTensorInfo(e),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(k),C}{let e=r.data.get(i.dataId).values,n=r.data.get(u.dataId).values,a=s||i.dtype,[o,l]=t(i.shape,u.shape,e,n,a);return r.makeTensorInfo(l,a,o)}}}function u(e){return(t,n,i,a,o,s)=>{let u=r.backend_util.assertAndGetBroadcastShape(t,n),l=r.util.sizeFromShape(u),c=u.length,d=r.util.computeStrides(u),h=r.util.getTypedArrayFromDType("float32",l),f=r.util.getTypedArrayFromDType("float32",l),p=r.backend_util.getBroadcastDims(t,u),m=r.backend_util.getBroadcastDims(n,u),g=r.backend_util.mergeRealAndImagArrays(i,a),x=r.backend_util.mergeRealAndImagArrays(o,s),b=t.length,y=r.util.computeStrides(t),v=n.length,w=r.util.computeStrides(n);if(p.length+m.length===0)for(let t=0;t<h.length;t++){let n=t%g.length,r=t%x.length,i=e(g[2*n],g[2*n+1],x[2*r],x[2*r+1]);h[t]=i.real,f[t]=i.imag}else for(let t=0;t<h.length;t++){let n=r.util.indexToLoc(t,c,d),i=n.slice(-b);p.forEach(e=>i[e]=0);let a=r.util.locToIndex(i,b,y),o=n.slice(-v);m.forEach(e=>o[e]=0);let s=r.util.locToIndex(o,v,w),u=e(g[2*a],g[2*a+1],x[2*s],x[2*s+1]);h[t]=u.real,f[t]=u.imag}return[h,f,u]}}},87962:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e){return(t,n,i)=>{let a=r.util.getArrayFromDType(n,t.length);for(let n=0;n<t.length;++n)a[n]=e(t[n],i);return a}}},32497:function(e,t,n){"use strict";n.d(t,{A:function(){return o},O:function(){return s}});var r=n(94976),i=n(23356),a=n(87962);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o(e,t,n){return s(e,(0,a.a)(t),n)}function s(e,t,n){return({inputs:a,attrs:o,backend:s})=>{let u;let{x:l}=a;(0,i.H)(l,e);let c=s.data.get(l.dataId).values;if("string"===l.dtype){if(!Array.isArray(c))throw Error("String tensor's value was not an instance of Array");u=r.backend_util.fromUint8ToStringArray(c)}else u=c;let d=n||l.dtype,h=t(u,d,o);return s.makeTensorInfo(l.shape,d,h)}}},84451:function(e,t,n){"use strict";n.d(t,{l:function(){return(/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e(t,n,a="float32"){if("complex64"===a){let r=e(t,n,"float32"),a=e(t,n,"float32");return(0,i.P)({inputs:{real:r,imag:a},backend:t})}let o=r.util.makeZerosTypedArray(r.util.sizeFromShape(n),a);return t.makeTensorInfo(n,a,o)})}});var r=n(94976),i=n(96110)},46641:function(e,t,n){"use strict";n.d(t,{jl:function(){return function e(t,n){if(!(t in i)||null!=n){let e=function(e,t){if(1!==e&&2!==e)throw Error("Cannot get WebGL rendering context, WebGL is disabled.");let n=null==t?function(e){if(!(0,r.env)().getBool("IS_SAFARI")&&"undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw Error("Cannot create a canvas in this context")}(e):t;return(n.addEventListener("webglcontextlost",t=>{t.preventDefault(),delete i[e]},!1),(0,r.env)().getBool("SOFTWARE_WEBGL_ENABLED")&&(a.failIfMajorPerformanceCaveat=!1),1===e)?n.getContext("webgl",a)||n.getContext("experimental-webgl",a):n.getContext("webgl2",a)}(t,n);if(null===e)return console.log("Could not get context for WebGL version",t),null;i[t]=e}let o=i[t];return null==o||o.isContextLost()?(delete i[t],e(t)):(o.disable(o.DEPTH_TEST),o.disable(o.STENCIL_TEST),o.disable(o.BLEND),o.disable(o.DITHER),o.disable(o.POLYGON_OFFSET_FILL),o.disable(o.SAMPLE_COVERAGE),o.enable(o.SCISSOR_TEST),o.enable(o.CULL_FACE),o.cullFace(o.BACK),i[t])}},nd:function(){return o}});var r=n(94976);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let i={},a={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function o(e,t){i[e]=t}},85638:function(e,t,n){"use strict";n.d(t,{_:function(){return s}});var r=n(26826),i=n(62051),a=n(39040),o=n(31929);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=o.m1.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=(0,r.A)();this.outputShape=e,this.enableShapeUniforms=(0,i.C9)(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?a.Kn(["r","c","d"],e):a.RW(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}},60122:function(e,t,n){"use strict";n.d(t,{G:function(){return s}});var r=n(26826),i=n(62051),a=n(39040),o=n(31929);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=o.m1.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let t=(0,r.A)();this.outputShape=e,this.enableShapeUniforms=(0,i.C9)(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?a.Kn(["r","c","d"],e):a.RW(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}},53899:function(e,t,n){"use strict";n.d(t,{q:function(){return o}});var r=n(26826),i=n(39040),a=n(31929);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o{constructor(e){this.variableNames=["A"],this.outTexUsage=a.v2.DOWNLOAD;let t=(0,r.A)();this.outputShape=e,this.userCode=`
      ${i.ye}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}},18821:function(e,t,n){"use strict";n.d(t,{d:function(){return o}});var r=n(26826),i=n(39040),a=n(31929);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=a.v2.DOWNLOAD;let t=(0,r.A)();this.outputShape=e,this.userCode=`
      ${i.ye}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}},3575:function(e,t,n){"use strict";n.d(t,{F:function(){return s}});var r=n(26826),i=n(62051),a=n(39040);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o={R:0,G:1,B:2,A:3};class s{constructor(e,t=!1,n="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let s=(0,r.A)();this.outputShape=e,this.enableShapeUniforms=(0,i.C9)(this.outputShape.length);let u="result";t&&(u="floor(result * 255. + 0.5)");let l="";for(let e=0;e<n.length;e++){let t=n[e];l+=`
          if(offset == ${e}) {
            result = values[${o[t]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?a.nc():a.ku(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${n.length});

        flatIndex = idiv(flatIndex, ${n.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${l}
        }
        ${s.output} = vec4(${u}, 0., 0., 0.);
      }
    `}}},47212:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(26826),i=n(62051),a=n(39040);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let n=(0,r.A)();this.outputShape=e,this.enableShapeUniforms=(0,i.C9)(this.outputShape.length);let o="",s="result";t&&(s="floor(result * 255. + 0.5)");for(let t=0;t<=1;t++)for(let r=0;r<=1;r++){let i=2*t+r;o+=`
          localCoords = coords;
          if(localCoords[2] + ${r} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${r};
          if (localCoords[1] + ${t} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${t};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${n.texture2D}(A, uv);

            if (offset == 0) {
              result[${i}] = values[0];
            } else if (offset == 1) {
              result[${i}] = values[1];
            } else if (offset == 2) {
              result[${i}] = values[2];
            } else {
              result[${i}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?a.nc():a.ku(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${o}

          ${n.output} = ${s};
        }
    `}}},9586:function(e,t,n){"use strict";var r=n(94976),i=n(86413);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let a=(0,r.env)();a.registerFlag("HAS_WEBGL",()=>a.getNumber("WEBGL_VERSION")>0),a.registerFlag("WEBGL_VERSION",()=>(0,i.isWebGLVersionEnabled)(2)?2:(0,i.isWebGLVersionEnabled)(1)?1:0),a.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),a.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===a.get("WEBGL_VERSION")),a.registerFlag("WEBGL_CPU_FORWARD",()=>!0),a.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),a.registerFlag("WEBGL_PACK",()=>a.getBool("HAS_WEBGL")),a.registerFlag("WEBGL_PACK_NORMALIZATION",()=>a.getBool("WEBGL_PACK")),a.registerFlag("WEBGL_PACK_CLIP",()=>a.getBool("WEBGL_PACK")),a.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>a.getBool("WEBGL_PACK")),a.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>a.getBool("WEBGL_PACK")),a.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>a.getBool("WEBGL_PACK")),a.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>a.getBool("WEBGL_PACK")),a.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>a.getBool("WEBGL_PACK")),a.registerFlag("WEBGL_PACK_REDUCE",()=>a.getBool("WEBGL_PACK")),a.registerFlag("WEBGL_LAZILY_UNPACK",()=>a.getBool("WEBGL_PACK")),a.registerFlag("WEBGL_CONV_IM2COL",()=>a.getBool("WEBGL_PACK")),a.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>a.getBool("WEBGL_PACK")),a.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>(0,i.getWebGLMaxTextureSize)(a.getNumber("WEBGL_VERSION"))),a.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>(0,i.getMaxTexturesInShader)(a.getNumber("WEBGL_VERSION"))),a.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let e=a.getNumber("WEBGL_VERSION");return 0===e?0:(0,i.getWebGLDisjointQueryTimerVersion)(e)}),a.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>a.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!r.device_util.isMobile()),a.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>(0,i.isCapableOfRenderingToFloatTexture)(a.getNumber("WEBGL_VERSION"))),a.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!a.getBool("WEBGL_FORCE_F16_TEXTURES")&&a.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),a.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>(0,i.isDownloadFloatTextureEnabled)(a.getNumber("WEBGL_VERSION"))),a.registerFlag("WEBGL_FENCE_API_ENABLED",()=>(0,i.isWebGLFenceEnabled)(a.getNumber("WEBGL_VERSION"))),a.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>a.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),a.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if("number"!=typeof e)throw Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${e}.`);if(e<0&&-1!==e)throw Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)}),a.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>r.device_util.isMobile()?1:-1,e=>{if("number"!=typeof e)throw Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${e}.`);if(e<0&&-1!==e)throw Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)}),a.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),a.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),a.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),a.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),a.registerFlag("WEBGL_EXP_CONV",()=>!1),a.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>a.getBool("IS_TEST")),a.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),a.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),a.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1),a.registerFlag("ENGINE_COMPILE_ONLY",()=>!1)},26826:function(e,t,n){"use strict";n.d(t,{A:function(){return i}});var r=n(94976);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(){let e,t,n,i,a,o,s,u,l,c;return 2===(0,r.env)().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",i="in",a="texture",o="outputColor",s="out vec4 outputColor;",u=(0,r.env)().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",i="varying",a="texture2D",o="gl_FragColor",s="",u=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:i,texture2D:a,output:o,defineOutput:s,defineSpecialNaN:u,defineSpecialInf:l,defineRound:c}}},36754:function(e,t,n){"use strict";n.d(t,{A:function(){return u}});var r=n(94976),i=n(46641),a=n(74480),o=n(31929),s=n(86413);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];let t=(0,r.env)().getNumber("WEBGL_VERSION");if(null!=e?(this.gl=e,(0,i.nd)(t,e)):this.gl=(0,i.jl)(t),e=this.gl,2===(0,r.env)().getNumber("WEBGL_VERSION")){let t=e;this.createVertexArray=()=>s.callAndCheck(t,()=>t.createVertexArray()),this.bindVertexArray=e=>s.callAndCheck(t,()=>t.bindVertexArray(e)),this.deleteVertexArray=e=>s.callAndCheck(t,()=>t.deleteVertexArray(e)),this.getVertexArray=()=>s.callAndCheck(t,()=>t.getParameter(t.VERTEX_ARRAY_BINDING))}else if(null!=e){let t=e.getExtension("OES_vertex_array_object");if(null==t)throw Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>s.callAndCheck(e,()=>t.createVertexArrayOES()),this.bindVertexArray=n=>s.callAndCheck(e,()=>t.bindVertexArrayOES(n)),this.deleteVertexArray=n=>s.callAndCheck(e,()=>t.deleteVertexArrayOES(n)),this.getVertexArray=()=>s.callAndCheck(e,()=>e.getParameter(t.VERTEX_ARRAY_BINDING_OES))}let n="WEBGL_color_buffer_float",u="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===(0,r.env)().getNumber("WEBGL_VERSION")){let e="OES_texture_half_float";if(this.textureFloatExtension=s.getExtensionOrThrow(this.gl,"OES_texture_float"),s.hasExtension(this.gl,e))this.textureHalfFloatExtension=s.getExtensionOrThrow(this.gl,e);else if((0,r.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),s.hasExtension(this.gl,u))this.colorBufferHalfFloatExtension=s.getExtensionOrThrow(this.gl,u);else if((0,r.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",s.hasExtension(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else if(s.hasExtension(this.gl,u))this.colorBufferHalfFloatExtension=this.gl.getExtension(u);else throw Error("GL context does not support color renderable floats");this.vertexBuffer=a.createVertexBuffer(this.gl),this.indexBuffer=a.createIndexBuffer(this.gl),this.framebuffer=s.createFramebuffer(this.gl),this.textureConfig=o.Sq(this.gl,this.textureHalfFloatExtension)}get debug(){return(0,r.env)().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let e=this.gl;s.callAndCheck(e,()=>e.finish()),s.callAndCheck(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),s.callAndCheck(e,()=>e.deleteFramebuffer(this.framebuffer)),s.callAndCheck(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),s.callAndCheck(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),s.callAndCheck(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),a.createFloat32MatrixTexture(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),a.createFloat16MatrixTexture(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),a.createUnsignedBytesMatrixTexture(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),a.uploadPixelDataToTexture(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,r){this.throwIfDisposed(),a.uploadDenseMatrixToTexture(this.gl,e,t,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),a.createFloat16PackedMatrixTexture(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),a.createPackedMatrixTexture(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(s.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer),this.outputTexture=null),s.callAndCheck(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>a.downloadByteEncodedFloatMatrixFromOutputTexture(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,r,i,o){return a.downloadPackedMatrixFromBuffer(this.gl,e,t,n,r,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return a.downloadFloat32MatrixFromBuffer(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);let r=a.createBufferFromOutputTexture(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if((0,r.env)().getBool("WEBGL_FENCE_API_ENABLED")){let r=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{let t=e.clientWaitSync(r,0,0);return t===e.ALREADY_SIGNALED||t===e.CONDITION_SATISFIED},t=r}else(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>a.downloadMatrixFromPackedOutputTexture(this.gl,t,n))}createProgram(e){this.throwIfDisposed();let t=this.gl;null==this.vertexShader&&(this.vertexShader=a.createVertexShader(t));let n=s.createProgram(t);s.callAndCheck(t,()=>t.attachShader(n,this.vertexShader)),s.callAndCheck(t,()=>t.attachShader(n,e)),s.linkProgram(t,n);let r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&s.validateProgram(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);let t=this.gl;s.callAndCheck(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),a.bindVertexProgramAttributeStreams(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(s.callAndCheck(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&s.validateProgram(this.gl,this.program),s.callAndCheck(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,n=!0){return(this.throwIfDisposed(),n)?s.getProgramUniformLocationOrThrow(this.gl,e,t):s.getProgramUniformLocation(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),s.callAndCheck(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),s.bindTextureToProgramUniformSampler(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();let[r,i]=o.qe(t,n);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&s.validateProgram(this.gl,this.program),s.validateFramebuffer(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let e=this.gl;this.debug&&(console.assert(this.getVertexArray()===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()),s.callAndCheck(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),s.callAndCheck(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=s.getExtensionOrThrow(this.gl,2===(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){let e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}let e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(2===(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){let e=this.gl,t=this.getQueryTimerExtensionWebGL2();e.endQuery(t.TIME_ELAPSED_EXT);return}let e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await r.util.repeatedTry(()=>this.disposed||this.isQueryAvailable(e,(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){let t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}{let t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){let t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{let t=this.getQueryTimerExtensionWebGL1(),n=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(t.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){let e=function(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map(e=>e.isDoneFn));for(let t=0;t<=e;++t){let{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){let n;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||("setTimeoutCustom"in(0,r.env)().platform&&(n=(0,r.env)().platform.setTimeoutCustom.bind((0,r.env)().platform)),r.util.repeatedTry(()=>(this.pollItems(),0===this.itemsToPoll.length),()=>0,null,n))}bindTextureToFrameBuffer(e){this.throwIfDisposed(),s.bindColorTextureToFramebuffer(this.gl,e,this.framebuffer),this.debug&&s.validateFramebuffer(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(s.bindColorTextureToFramebuffer(this.gl,this.outputTexture,this.framebuffer),this.debug&&s.validateFramebuffer(this.gl)):s.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);let n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();let r=this.gl;s.bindColorTextureToFramebuffer(r,e,this.framebuffer),this.debug&&s.validateFramebuffer(r),this.outputTexture=e,s.callAndCheck(r,()=>r.viewport(0,0,t,n)),s.callAndCheck(r,()=>r.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),s.callAndCheck(this.gl,()=>this.gl.scissor(e,t,n,r))}throwIfDisposed(){if(this.disposed)throw Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw Error("No GPU program is currently set.")}}},62051:function(e,t,n){"use strict";n.d(t,{C9:function(){return d},IJ:function(){return o},Yv:function(){return s},_s:function(){return l},mi:function(){return c}});var r=n(94976),i=n(86854),a=n(86413);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o(e,t,n,o){let u=n.map((e,n)=>{let r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}}),l=u.map(e=>e.shapeInfo),c={logicalShape:o.shape,texShape:o.texData.texShape,isUniform:!1,isPacked:o.texData.isPacked,flatOffset:null},d=i.Vm(u,c,t),h=(0,a.createFragmentShader)(e.gl,d),f=e.createProgram(h);return(0,r.env)().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:h,source:d,webGLProgram:f,inShapeInfos:l,outShapeInfo:c,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(f),Object.assign({program:t,fragmentShader:h,source:d,webGLProgram:f,inShapeInfos:l,outShapeInfo:c},s(e,t,f)))}function s(e,t,n){let i,a,o;let s=[],u=[],l=null,c=null;for(let i of(c=e.getUniformLocation(n,"NAN",!1),1===(0,r.env)().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(n,"INFINITY",!1)),t.variableNames)){let r={name:i,uniform:e.getUniformLocation(n,i,!1),offset:e.getUniformLocation(n,`offset${i}`,!1)};t.enableShapeUniforms&&(r.shape=e.getUniformLocation(n,`${i}Shape`,!1),r.texShape=e.getUniformLocation(n,`${i}TexShape`,!1)),s.push(r)}if(t.enableShapeUniforms&&(i=e.getUniformLocation(n,"outShape",!1),o=e.getUniformLocation(n,"outShapeStrides",!1),a=e.getUniformLocation(n,"outTexShape",!1)),t.customUniforms)for(let r of t.customUniforms)u.push(e.getUniformLocation(n,r.name,!1));return{variablesLocations:s,customUniformLocations:u,infLoc:l,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:a}}function u(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach((e,n)=>{let i=e.logicalShape,a=t[n],o=a.shape;if(!r.util.arraysEqual(i,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${i} and ${o} must match`);if(e.isUniform&&a.isUniform)return;let s=e.texShape,u=a.isUniform?null:a.texData.texShape;if(!r.util.arraysEqual(s,u))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${s} and ${u} must match`)})}function l(e,t,n,a,o){t.program.enableShapeUniforms||(u(t.inShapeInfos,n),u([t.outShapeInfo],[a]));let s=a.texData.texture,l=a.texData.texShape;a.texData.isPacked?e.setOutputPackedMatrixTexture(s.texture,l[0],l[1]):e.setOutputMatrixTexture(s.texture,l[0],l[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===(0,r.env)().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(let a=0;a<n.length;++a){let o=n[a],{uniform:s,offset:u,shape:l,texShape:c}=t.variablesLocations[a];if(l){let{uniformShape:n}=i.Tt(t.program.packedInputs,o.shape,o.texData.texShape);switch(n.length){case 1:e.gl.uniform1iv(l,new Int32Array(n));break;case 2:e.gl.uniform2iv(l,new Int32Array(n));break;case 3:e.gl.uniform3iv(l,new Int32Array(n));break;case 4:e.gl.uniform4iv(l,new Int32Array(n))}}if(c&&e.gl.uniform2i(c,o.texData.texShape[0],o.texData.texShape[1]),null!=s){if(o.isUniform){if(2>r.util.sizeFromShape(o.shape))e.gl.uniform1f(s,o.uniformValues[0]);else{let t=o.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(s,t)}continue}null!=o.texData.slice&&null!=u&&e.gl.uniform1i(u,o.texData.slice.flatOffset),e.setInputMatrixTexture(o.texData.texture.texture,s,a)}}let c=t.outShapeLocation;if(c)switch(a.shape.length){case 1:e.gl.uniform1iv(c,new Int32Array(a.shape));break;case 2:e.gl.uniform2iv(c,new Int32Array(a.shape));break;case 3:e.gl.uniform3iv(c,new Int32Array(a.shape));break;case 4:e.gl.uniform4iv(c,new Int32Array(a.shape))}if(t.outShapeStridesLocation){let n=r.util.computeStrides(a.shape);switch(a.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(n));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(n));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(n))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,a.texData.texShape[0],a.texData.texShape[1]),t.program.customUniforms&&o)for(let n=0;n<t.program.customUniforms.length;++n){let r=t.program.customUniforms[n],i=t.customUniformLocations[n],a=o[n];if("float"===r.type)e.gl.uniform1fv(i,a);else if("vec2"===r.type)e.gl.uniform2fv(i,a);else if("vec3"===r.type)e.gl.uniform3fv(i,a);else if("vec4"===r.type)e.gl.uniform4fv(i,a);else if("int"===r.type)e.gl.uniform1iv(i,a);else if("ivec2"===r.type)e.gl.uniform2iv(i,a);else if("ivec3"===r.type)e.gl.uniform3iv(i,a);else if("ivec4"===r.type)e.gl.uniform4iv(i,a);else throw Error(`uniform type ${r.type} is not supported yet.`)}e.executeProgram()}function c(e,t,n){let a="";t.concat(n).forEach(t=>{let o=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){let s=t.texData.texShape,{useSqueezeShape:u,uniformShape:l,keptDims:c}=i.Tt(e.packedInputs,t.shape,s),d="",h="",f="";if(1===l.length&&e.packedInputs){let e=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];d=`${e[0]>1}_${e[1]>1}`}else if(2!==l.length||e.packedInputs){if(l.length>2&&!e.packedInputs){let e=r.util.computeStrides(l);f=`${e[0]===s[1]}_${e[e.length-1]===s[1]}`}}else h=`${l[0]>1}_${l[1]>1}`;let p=t.shape.length,m=2===l.length&&r.util.arraysEqual(t.shape,s),g=1===r.util.sizeFromShape(t.shape),x=r.backend_util.getBroadcastDims(t.shape,n.shape),b=!e.packedInputs&&p===n.shape.length&&r.util.arraysEqual(s,n.texData.texShape),y=e.packedInputs||l.length>2?"":`${s[0]>1}_${s[1]>1}`;a+=`${p}_${b}_${u?c:""}_${l.length}_${g}_${x}_${m}_${d}_${h}_${f}_${y}_${o}`}else{let e=t.isUniform?"uniform":t.texData.texShape;a+=`${t.shape}_${e}_${o}`}});let o=e.userCode;return e.constructor.name+("_"+a+"_"+o)+`${(0,r.env)().getNumber("WEBGL_VERSION")}`}function d(e){return(0,r.env)().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}},74480:function(e,t,n){"use strict";n.r(t),n.d(t,{bindVertexProgramAttributeStreams:function(){return w},createBufferFromOutputTexture:function(){return I},createFloat16MatrixTexture:function(){return p},createFloat16PackedMatrixTexture:function(){return v},createFloat32MatrixTexture:function(){return h},createIndexBuffer:function(){return l},createPackedMatrixTexture:function(){return b},createUnsignedBytesMatrixTexture:function(){return g},createVertexBuffer:function(){return u},createVertexShader:function(){return s},downloadByteEncodedFloatMatrixFromOutputTexture:function(){return S},downloadFloat32MatrixFromBuffer:function(){return $},downloadMatrixFromPackedOutputTexture:function(){return _},downloadPackedMatrixFromBuffer:function(){return E},getInternalFormatForFloat16MatrixTexture:function(){return f},getInternalFormatForFloat16PackedMatrixTexture:function(){return y},getInternalFormatForFloat32MatrixTexture:function(){return d},getInternalFormatForPackedMatrixTexture:function(){return x},getInternalFormatForUnsignedBytesMatrixTexture:function(){return m},uploadDenseMatrixToTexture:function(){return k},uploadPixelDataToTexture:function(){return C}});var r=n(94976),i=n(26826),a=n(31929),o=n(86413);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s(e){let t=(0,i.A)(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return o.createVertexShader(e,n)}function u(e){let t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return o.createStaticVertexBuffer(e,t)}function l(e){let t=new Uint16Array([0,1,2,2,1,3]);return o.createStaticIndexBuffer(e,t)}function c(e,t,n,i,a,s){o.validateTextureSize(t,n);let u=o.createTexture(e),l=e.TEXTURE_2D;return o.callAndCheck(e,()=>e.bindTexture(l,u)),o.callAndCheck(e,()=>e.texParameteri(l,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),o.callAndCheck(e,()=>e.texParameteri(l,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),o.callAndCheck(e,()=>e.texParameteri(l,e.TEXTURE_MIN_FILTER,e.NEAREST)),o.callAndCheck(e,()=>e.texParameteri(l,e.TEXTURE_MAG_FILTER,e.NEAREST)),1===(0,r.env)().getNumber("WEBGL_VERSION")?o.callAndCheck(e,()=>e.texImage2D(l,0,i,t,n,0,a,s,null)):o.callAndCheck(e,()=>e.texStorage2D(l,1,i,t,n)),o.callAndCheck(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:u,texShape:[n,t]}}function d(e){return e.internalFormatFloat}function h(e,t,n,r){let[i,o]=a.kk(t,n);return c(e,i,o,d(r),r.textureFormatFloat,e.FLOAT)}function f(e){return e.internalFormatHalfFloat}function p(e,t,n,r){let[i,o]=a.kk(t,n);return c(e,i,o,f(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function m(e){return e.downloadTextureFormat}function g(e,t,n,r){let[i,o]=a.kk(t,n);return c(e,i,o,m(r),e.RGBA,e.UNSIGNED_BYTE)}function x(e){return e.internalFormatPackedFloat}function b(e,t,n,r){let[i,o]=a.qe(t,n);return c(e,i,o,x(r),e.RGBA,e.FLOAT)}function y(e){return e.internalFormatPackedHalfFloat}function v(e,t,n,r){let[i,o]=a.qe(t,n);return c(e,i,o,y(r),e.RGBA,r.textureTypeHalfFloat)}function w(e,t,n){return o.callAndCheck(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),o.bindVertexBufferToProgramAttribute(e,t,"clipSpacePos",n,3,20,0)&&o.bindVertexBufferToProgramAttribute(e,t,"uv",n,2,20,12)}function k(e,t,n,i,a,s){let u,l,c;o.callAndCheck(e,()=>e.bindTexture(e.TEXTURE_2D,t)),a instanceof Uint8Array?(u=new Uint8Array(n*i*4),l=e.UNSIGNED_BYTE,c=e.RGBA):(u=new Float32Array(n*i*4),l=e.FLOAT,c=s.internalFormatPackedFloat),u.set(a),2===(0,r.env)().getNumber("WEBGL_VERSION")?o.callAndCheck(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,i,e.RGBA,l,u)):o.callAndCheck(e,()=>e.texImage2D(e.TEXTURE_2D,0,c,n,i,0,e.RGBA,l,u)),o.callAndCheck(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function C(e,t,n){o.callAndCheck(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?2===(0,r.env)().getNumber("WEBGL_VERSION")?o.callAndCheck(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):o.callAndCheck(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):2===(0,r.env)().getNumber("WEBGL_VERSION")?o.callAndCheck(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):o.callAndCheck(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),o.callAndCheck(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function I(e,t,n,r){let i=e.createBuffer();o.callAndCheck(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,i));let a=16*t*n;return o.callAndCheck(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)),o.callAndCheck(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),o.callAndCheck(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),i}function $(e,t,n){let r=new Float32Array(n);return e.bindBuffer(e.PIXEL_PACK_BUFFER,t),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,r),e.bindBuffer(e.PIXEL_PACK_BUFFER,null),r}function S(e,t,n,r){let[i,s]=a.kk(t,n),u=new Uint8Array(a.yb(t*n,4));return o.callAndCheck(e,()=>e.readPixels(0,0,i,s,r.downloadTextureFormat,e.UNSIGNED_BYTE,u)),new Float32Array(u.buffer)}function E(e,t,n,r,i,o,s,u){let l=new Float32Array(a.Se(o,s));return e.bindBuffer(e.PIXEL_PACK_BUFFER,t),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,l),e.bindBuffer(e.PIXEL_PACK_BUFFER,null),l}function _(e,t,n){let r=new Float32Array(t*n*4);return o.callAndCheck(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)),r}},53844:function(e,t,n){"use strict";let r;n.d(t,{Af:function(){return h.A},QC:function(){return s.QC},kS:function(){return f},lz:function(){return l},nd:function(){return d.nd},ic:function(){return u},yO:function(){return p},fZ:function(){return c}});var i,a,o=n(94976),s=n(485);/** @license See the LICENSE file. */let u="4.20.0";var l=n(74480),c=n(86413),d=n(46641),h=n(36754);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f(){(0,o.env)().set("WEBGL_FORCE_F16_TEXTURES",!0)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */o.device_util.isBrowser()&&(0,o.registerBackend)("webgl",()=>new s.QC,2);let p={forceHalfFloat:f};var m=n(62051);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let g=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class x{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=o.backend_util.assertAndGetBroadcastShape(t,n),this.enableShapeUniforms=(0,m.C9)(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}var b=n(76899),y=n(86854);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let v=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class w{constructor(e,t,n,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o.backend_util.assertAndGetBroadcastShape(t,n);let i=this.outputShape.length;this.enableShapeUniforms=(0,m.C9)(i);let a="";if(r){if(0===i||1===o.util.sizeFromShape(this.outputShape))a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else{let e=(0,y.kW)(i);if(a=`
          ${e} coords = getOutputCoords();
        `,1===i)this.enableShapeUniforms?a+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:a+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{let e=(0,b.Ky)("coords",i);this.enableShapeUniforms?a+=`
            bool nextRowOutOfBounds =
              (${e[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${e[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:a+=`
            bool nextRowOutOfBounds =
              (${e[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${e[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}}}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${a}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}let C={kernelName:o.Identity,backendName:"webgl",kernelFunc:k};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I(e){let{inputs:t,backend:n}=e,{real:r,imag:i}=t,a=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(a.dataId),s=k({inputs:{x:r},backend:n}),u=k({inputs:{x:i},backend:n});return o.complexTensorInfos={real:s,imag:u},a}let $={kernelName:o.Complex,backendName:"webgl",kernelFunc:I},S="return (a < 0.) ? b * a : a;",E=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,_={kernelName:o.LeakyRelu,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:a}=r,s=n.makeTensorInfo([],"float32",o.util.createScalarValue(a,"float32")),u=(0,o.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new w(E,i.shape,s.shape):new x(S,i.shape,s.shape),l=n.runWebGLProgram(u,[i,s],"float32");return n.disposeIntermediateTensorInfo(s),l}},T="return (a < 0.) ? b * a : a;",N=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,R={kernelName:o.Prelu,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:r,alpha:i}=t,a=(0,o.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new w(N,r.shape,i.shape):new x(T,r.shape,i.shape);return n.runWebGLProgram(a,[r,i],"float32")}};var A=n(85768),F=n(15090);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let O="if (isnan(x)) return x;";function B({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:i,backend:a})=>{let s;let{x:u}=i,l=r||u.dtype;if(a.shouldExecuteOnCPU([u])&&null!=n){let e=n(a.texData.get(u.dataId).values,l);return a.makeTensorInfo(u.shape,l,e)}return s=(0,o.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=t?new F.cc(u.shape,t):new A.l(u.shape,e),a.runWebGLProgram(s,[u],l)}}function D({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:a}){return({inputs:s,backend:u})=>{let l;let{a:c,b:d}=s;if(r&&"complex64"===c.dtype){let t=u.texData.get(c.dataId),n=u.texData.get(d.dataId),[r,i]=[[t.complexTensorInfos.real,n.complexTensorInfos.real],[t.complexTensorInfos.imag,n.complexTensorInfos.imag]].map(t=>{let[n,r]=t,i={dataId:n.dataId,dtype:n.dtype,shape:c.shape},a={dataId:r.dataId,dtype:r.dtype,shape:d.shape},s=new x(e,c.shape,d.shape);return u.runWebGLProgram(s,[i,a],(0,o.upcastType)(n.dtype,r.dtype))}),a=I({inputs:{real:r,imag:i},backend:u});return u.disposeIntermediateTensorInfo(r),u.disposeIntermediateTensorInfo(i),a}let h=a||(0,o.upcastType)(c.dtype,d.dtype);if(("string"===c.dtype||"string"===d.dtype||u.shouldExecuteOnCPU([c,d]))&&null!=i){let e=u.texData.get(c.dataId).values,t=u.texData.get(d.dataId).values,n="string"===c.dtype?o.backend_util.fromUint8ToStringArray(e):e,r="string"===c.dtype?o.backend_util.fromUint8ToStringArray(t):t,[a,s]=i(c.shape,d.shape,n,r,h),l=u.makeTensorInfo(s,h);return u.texData.get(l.dataId).values=a,l}return l=(0,o.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=t?new w(t,c.shape,d.shape,n):new x(e,c.shape,d.shape),u.runWebGLProgram(l,[c,d],h)}}function P(e,t=!1){if("linear"===e)return t?F.t$:A.t$;if("relu"===e)return t?F.RX:A.RX;if("elu"===e)return t?F.Cv:A.Cv;if("relu6"===e)return t?F.eW:A.eW;if("prelu"===e)return t?N:T;if("leakyrelu"===e)return t?E:S;if("sigmoid"===e)return t?F.Tq:A.Tq;throw Error(`Activation ${e} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M{constructor(e,t,n,r=!1,i=!1,a=!1,o=null,s=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=(0,m.C9)(this.outputShape.length);let l=Math.ceil((r?e[1]:e[2])/2),c=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",f="";o&&(h=s?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:u?`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:`vec4 activation(vec4 x) {
          ${o}
        }`,f="result = activation(result);"),a&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let p="rc.x",g="rc.x";e[0]<t[0]?p=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(g=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${h}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${l}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${p};
        int batchB = ${g};
        for (int i = 0; i < ${l}; i++) {
          vec4 a = getMatrixA(batchA, ${r?"i * 2, rc.y":"rc.y, i * 2"});
          vec4 b = getMatrixB(batchB, ${i?"rc.z, i * 2":"i * 2, rc.z"});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${c[0]} * ${d[0]});
          result += (${c[1]} * ${d[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${a?"result += getBiasAtOutCoords();":""}

        ${f}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let V={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class L{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=o.backend_util.assertAndGetBroadcastShape(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}var W=n(74331);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let G="return a * b;";function U(e){let t;let{inputs:n,backend:r}=e,{a:i,b:a}=n,s=o.backend_util.upcastType(i.dtype,a.dtype);if("complex64"===i.dtype){let e=r.texData.get(i.dataId),t=r.texData.get(a.dataId),n=new L(V.REAL,i.shape,a.shape),o=new L(V.IMAG,i.shape,a.shape),s=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:i.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:i.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:a.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:a.shape}],u=r.runWebGLProgram(n,s,"float32"),l=r.runWebGLProgram(o,s,"float32"),c=I({inputs:{real:u,imag:l},backend:r});return r.disposeIntermediateTensorInfo(u),r.disposeIntermediateTensorInfo(l),c}if(r.shouldExecuteOnCPU([i,a])){let e=r.texData.get(i.dataId),t=r.texData.get(a.dataId),[n,o]=(0,W.Th)(i.shape,a.shape,e.values,t.values,s),u=r.makeTensorInfo(o,s);return r.texData.get(u.dataId).values=n,u}return t=(0,o.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new w(G,i.shape,a.shape):new x(G,i.shape,a.shape),r.runWebGLProgram(t,[i,a],s)}let z={kernelName:o.Multiply,backendName:"webgl",kernelFunc:U};var X=n(62411);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:a}=r,s=o.util.sizeFromShape(i.shape),u=o.util.inferFromImplicitShape(a,s),l=o.util.sizeFromShape(u);o.util.assert(s===l,()=>`The new shape (${u}) has ${l} elements and the old shape (${i.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`);let d=n.texData.get(i.dataId);return!d.isPacked||(0,c.isReshapeFree)(i.shape,u)||null!==d.texture&&(0,c.isReshapeFree)(d.shape,u)?(n.incRef(i.dataId),{dataId:i.dataId,shape:u,dtype:i.dtype}):/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let r=[(0,c.getBatchDim)(e.shape),...(0,c.getRowsCols)(e.shape)],i={dtype:e.dtype,shape:r,dataId:e.dataId},a=[(0,c.getBatchDim)(t),...(0,c.getRowsCols)(t)],o=new X.v(a,r),s=n.runWebGLProgram(o,[i],e.dtype,[r],!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}(i,u,n)}let K={kernelName:o.Reshape,backendName:"webgl",kernelFunc:H};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:i,outSize:a}=e;this.outputShape=[r,a];let s=4*Math.floor(n/4),u=n%4,l="sumValue += dot(values, ones);";if(null!=t){let e=1/t;l=`sumValue += dot(values * ${o.util.isInt(e)?e.toPrecision(2):e}, ones);`}let c="";i%n>0&&(c=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        float sumValue = 0.0;

        for (int i = 0; i < ${s}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${l}
        }

        int inIdx = inOffset + ${s};
        if (${1===u}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${l}
        } else if (${2===u}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${l}
        } else if (${3===u}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${l}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j{constructor(e,t){this.variableNames=["x"];let{windowSize:n,batchSize:r,inSize:i,outSize:a}=e;this.outputShape=[r,a];let o="0.0",s="";"prod"===t?o="1.0":"min"===t?(o="1.0 / 1e-20",s="min"):"max"===t&&(o="-1.0 / 1e-20",s="max");let u=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===t?u="sumValue":"prod"===t?u="prodValue":"all"===t?u="allValue":"any"===t&&(u="anyValue");let l=4*Math.floor(n/4),c=n%4,d=`
      if (${"sum"===t}) {
        sumValue += dot(values, ones);
      } else if (${"prod"===t}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${s}(values, minMaxValue);
        if (${"min"===t} || ${"max"===t}) {
          minMaxValue = ${s}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,h="vec4";"all"===t?(o="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,h="bvec4"):"any"===t&&(o="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,h="bvec4");let f="";i%n>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${l}; i += 4) {
          int inIdx = inOffset + i;
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${l};
        if (${1===c}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${2===c}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${3===c}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${u});
      }
    `}}function Y(e,t,n,r){let i=/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=[];for(;0===t.length||1!==t[t.length-1].outSize;){let n=t.length?t[t.length-1].outSize:e[1],r=o.backend_util.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),a=e;for(let o=0;o<i.length;o++){let s,u;let{inSize:l,windowSize:c,outSize:d}=i[o];s="mean"===n?0===o?new q({windowSize:c,inSize:l,batchSize:e.shape[0],outSize:d},l):new q({windowSize:c,inSize:l,batchSize:e.shape[0],outSize:d}):new j({windowSize:c,inSize:l,batchSize:e.shape[0],outSize:d},n),u=a,a=r.runWebGLProgram(s,[a],t),u.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(u)}return a}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q{constructor(e,t){this.variableNames=["A"];let n=Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;let r=(0,y.kW)(this.rank),i=function(e){let t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=Array(t);for(let t=0;t<e.length;t++)r[e[t]]=n[t];return r.join()}(t);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let n=Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);let r=(0,y.kW)(this.rank),i=(0,b.k6)("rc",this.rank),a=Array(this.rank);for(let e=0;e<t.length;e++)a[t[e]]=i[e];let o=`vec2(${a.slice(-2).join()})`,s=`++${i[this.rank-1]} < ${n[this.rank-1]}`,u=`getChannel(getA(${a.join()}), ${o})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${s}) {
        result[1] = ${u};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${n[this.rank-2]}) {
        result[2] = ${u};
        if(${s}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J(e,t,n){let r=(0,o.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Z(e.shape,t):new Q(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ee(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:s}=r;return(/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r){let i=e.shape.length,a=o.util.parseAxisParam(t,e.shape),s=a,u=o.backend_util.getAxesPermutation(s,i),l=null!=u,c=e;l&&(c=J(e,u,r),s=o.backend_util.getInnerMostAxes(s.length,i)),o.backend_util.assertAxesAreInnerMostDims("sum",s,i);let[d,h]=o.backend_util.computeOutAndReduceShapes(c.shape,s),f=d;n&&(f=o.backend_util.expandShapeToKeepDim(d,a));let p=o.util.sizeFromShape(h),m=H({inputs:{x:c},attrs:{shape:[o.util.sizeFromShape(e.shape)/p,p]},backend:r}),g=Y(m,(0,o.sumOutType)(e.dtype),"sum",r),x=H({inputs:{x:g},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(g),l&&r.disposeIntermediateTensorInfo(c),x}(i,a,s,n))}let et={kernelName:o.Sum,backendName:"webgl",kernelFunc:ee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function en(e){let t;let{inputs:n,backend:r,attrs:i}=e,{x:a}=n,{perm:o}=i,s=Array(a.shape.length);for(let e=0;e<s.length;e++)s[e]=a.shape[o[e]];if(r.shouldExecuteOnCPU([a])){let e=r.texData.get(a.dataId).values,n=(0,W.Fv)(e,a.shape,a.dtype,o,s);t=r.makeTensorInfo(s,a.dtype),r.texData.get(t.dataId).values=n}else t=J(a,o,r);return t}let er={kernelName:o.Transpose,backendName:"webgl",kernelFunc:en};function ei({a:e,b:t,transposeA:n,transposeB:r,backend:i,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:u=0,activation:l=null}){let c;let d=e.shape.length,h=t.shape.length,f=n?e.shape[d-2]:e.shape[d-1],p=r?t.shape[h-1]:t.shape[h-2],m=n?e.shape[d-1]:e.shape[d-2],g=r?t.shape[h-2]:t.shape[h-1],x=e.shape.slice(0,-2),b=t.shape.slice(0,-2),y=o.util.sizeFromShape(x),v=o.util.sizeFromShape(b),w=o.broadcast_util.assertAndGetBroadcastShape(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([m,g]);o.util.assert(f===p,()=>`Error in matMul: inner shapes (${f}) and (${p}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${r} must match.`);let k=n?[y,f,m]:[y,m,f],C=r?[v,g,p]:[v,p,g],I=H({inputs:{x:e},backend:i,attrs:{shape:k}}),$=H({inputs:{x:t},backend:i,attrs:{shape:C}}),S=[I,$],E=Math.max(y,v),_=n?I.shape[1]:I.shape[2],T=null!=a,N=null!=s,R="leakyrelu"===l,A=null!=l?P(l,!0):null,F=T||N||R||null!=A;if((1===m||1===g)&&_>1e3&&!1===F){let e=I,t=$;n&&(e=en({inputs:{x:I},backend:i,attrs:{perm:[0,2,1]}}),S.push(e)),r&&(t=en({inputs:{x:$},backend:i,attrs:{perm:[0,2,1]}}),S.push(t));let a=1!==g,o=1===g,s=e;a&&(s=H({inputs:{x:e},backend:i,attrs:{shape:[E,_,1]}}),S.push(s));let u=t;o&&(u=H({inputs:{x:t},backend:i,attrs:{shape:[E,1,_]}}),S.push(u));let l=U({inputs:{a:s,b:u},backend:i});c=ee({inputs:{x:l},backend:i,attrs:{axis:1===g?2:1,keepDims:!0}}),S.push(l)}else{let l=(0,o.upcastType)(e.dtype,t.dtype),d=new M(k,C,[E,m,g],n,r,T,A,N,R),h=[I,$];if(null!=a&&h.push(a),N&&h.push(s),R){let e=i.makeTensorInfo([],"float32",o.util.createScalarValue(u,"float32"));h.push(e),S.push(e)}c=i.runWebGLProgram(d,h,l)}let O=H({inputs:{x:c},backend:i,attrs:{shape:w}});for(let e of(S.push(c),S))i.disposeIntermediateTensorInfo(e);return O}let ea={kernelName:o._FusedMatMul,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:a,bias:o,preluActivationWeights:s}=t,{transposeA:u,transposeB:l,activation:c,leakyreluAlpha:d}=r;return ei({a:i,b:a,transposeA:u,transposeB:l,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:d,activation:c})}},eo="return abs(x);",es={kernelName:o.Abs,backendName:"webgl",kernelFunc:function(e){let t;let{inputs:n,backend:r}=e,{x:i}=n;if(r.shouldExecuteOnCPU([i])&&"complex64"!==i.dtype){let e=r.texData.get(i.dataId),t=(0,W.CJ)(e.values);return r.makeTensorInfo(i.shape,i.dtype,t)}return t=(0,o.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new F.cc(i.shape,eo):new A.l(i.shape,eo),r.runWebGLProgram(t,[i],i.dtype)}},eu=B({opSnippet:A.D1+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`}),el={kernelName:o.Acos,backendName:"webgl",kernelFunc:eu},ec=B({opSnippet:A.D1+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`}),ed={kernelName:o.Acosh,backendName:"webgl",kernelFunc:ec},eh="return a + b;",ef=D({opSnippet:eh,packedOpSnippet:eh,supportsComplex:!0,cpuKernelImpl:W.cK}),ep={kernelName:o.Add,backendName:"webgl",kernelFunc:ef};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class em{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((e,t)=>`T${t}`);let n=[];this.variableNames.forEach(e=>{n.push(`float v${e} = get${e}AtOutCoords();`)});let r=this.variableNames.map(e=>`v${e}`).join(" + ");this.userCode=`
      void main() {
        ${n.join("\n        ")}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eg{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((e,t)=>`T${t}`);let n=[];this.variableNames.forEach(e=>{n.push(`vec4 v${e} = get${e}AtOutCoords();`)});let r=this.variableNames.map(e=>`v${e}`).join(" + ");this.userCode=`
      void main() {
        ${n.join("\n        ")}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}let ex={kernelName:o.AddN,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e(t){let{inputs:n,backend:r}=t;if(1===n.length)return k({inputs:{x:n[0]},backend:r});if(n.length>(0,o.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){let t=Math.floor(n.length/2),i=e({inputs:n.slice(0,t),backend:r}),a=e({inputs:n.slice(t),backend:r});return e({inputs:[i,a],backend:r})}let i=n.map(e=>e.dtype).reduce((e,t)=>(0,o.upcastType)(e,t)),a=n.map(e=>e.shape),s=(0,o.env)().getBool("WEBGL_PACK")?new eg(n[0].shape,a):new em(n[0].shape,a);return r.runWebGLProgram(s,n,i)}},eb={kernelName:o.All,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t;let{inputs:n,backend:r,attrs:i}=e,{x:a}=n,{axis:s,keepDims:u}=i,l=a.shape.length,c=o.util.parseAxisParam(s,a.shape),d=c,h=o.backend_util.getAxesPermutation(d,l),f=a;null!=h&&(f=en({inputs:{x:a},backend:r,attrs:{perm:h}}),d=o.backend_util.getInnerMostAxes(d.length,l)),o.backend_util.assertAxesAreInnerMostDims("all",d,l);let[p,m]=o.backend_util.computeOutAndReduceShapes(f.shape,d),g=H({inputs:{x:f},backend:r,attrs:{shape:[-1,o.util.sizeFromShape(m)]}}),x=Y(g,g.dtype,"all",r);return t=u?H({inputs:{x:x},backend:r,attrs:{shape:o.backend_util.expandShapeToKeepDim(p,c)}}):H({inputs:{x:x},backend:r,attrs:{shape:p}}),r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(x),null!=h&&r.disposeIntermediateTensorInfo(f),t}},ey={kernelName:o.Any,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t;let{inputs:n,backend:r,attrs:i}=e,{x:a}=n,{axis:s,keepDims:u}=i,l=a.shape.length,c=o.util.parseAxisParam(s,a.shape),d=c,h=o.backend_util.getAxesPermutation(d,l),f=a;null!=h&&(f=en({inputs:{x:a},backend:r,attrs:{perm:h}}),d=o.backend_util.getInnerMostAxes(d.length,l)),o.backend_util.assertAxesAreInnerMostDims("any",d,l);let[p,m]=o.backend_util.computeOutAndReduceShapes(f.shape,d),g=H({inputs:{x:f},backend:r,attrs:{shape:[-1,o.util.sizeFromShape(m)]}}),x=Y(g,g.dtype,"any",r);return t=u?H({inputs:{x:x},backend:r,attrs:{shape:o.backend_util.expandShapeToKeepDim(p,c)}}):H({inputs:{x:x},backend:r,attrs:{shape:p}}),r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(x),null!=h&&r.disposeIntermediateTensorInfo(f),t}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ev{constructor(e,t,n){this.variableNames=["A"];let{windowSize:r,batchSize:i,outSize:a}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));"};
          float candidate = getA(batch, inIdx);
          if (candidate ${"max"===t?">":"<"} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ew{constructor(e,t,n,r){let i,a;this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,o.util.assert(e.length>2,()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`);let s=Math.ceil(e[e.length-1]/t);this.outputShape=e.slice(0,-1),s>1&&this.outputShape.push(s),r||this.variableNames.push("bestIndicesA");let u=this.outputShape,l=u.length,c=(0,y.kW)(l),d=(0,b.Ky)("coords",l);if(1===s){a=l+1;let e=(0,y.kW)(a);i=`
        ${e} sourceLocR = ${e}(${d.join()}, 0);
        ++${d[l-1]};
        ${e} sourceLocG = ${e}(${d.join()}, 0);
        ++${d[l-2]};
        ${e} sourceLocA = ${e}(${d.join()}, 0);
        --${d[l-1]};
        ${e} sourceLocB = ${e}(${d.join()}, 0);
        --${d[l-2]};`}else a=l,i=`
        ${c} sourceLocR = coords;
        ++${d[l-1]};
        ${c} sourceLocG = coords;
        ++${d[l-2]};
        ${c} sourceLocA = coords;
        --${d[l-1]};
        ${c} sourceLocB = coords;
        --${d[l-2]};`;let h=["x","y","z","w","u","v"].slice(0,a),f="."+h[a-1],p=h.map(e=>"int "+e),m=(0,b.Ky)("sourceLocR",a-1).concat("inIdx.r"),g=(0,b.Ky)("sourceLocG",a-1).concat("inIdx.g"),x=(0,b.Ky)("sourceLocB",a-1).concat("inIdx.b"),v=(0,b.Ky)("sourceLocA",a-1).concat("inIdx.a"),w=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${v.join()})));`,k=`vec4(
            getAChannel(${m.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,C=r?"":`
      float getBestIndicesAChannel(${p.join()}) {
        return getChannel(getBestIndicesA(${h.join()}),
                                          vec2(${h.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${p.join()}) {
        return getChannel(getA(${h.join()}),
                               vec2(${h.slice(-2).join()}));
      }
      ${C}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${d[l-1]} < ${u[l-1]-1};
        bool hasNextRow = ${d[l-2]} < ${u[l-2]-1};
        ${i}
        ivec4 srcIdx = ivec4(sourceLocR${f}, sourceLocG${f},
          sourceLocB${f}, sourceLocA${f}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${k};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${w}
          vec4 candidate = ${k};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${"max"===n?"greaterThan":"lessThan"}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}function ek(e,t,n,r){let i=[n];if(o.backend_util.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,t.shape.length),!(0,o.env)().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){let n=[],a=e.texData.get(t.dataId),s=null!==a&&a.isPacked,u=t;s&&n.push(u=e.unpackTensor(t));let[l,c]=o.backend_util.computeOutAndReduceShapes(u.shape,i),d=H({inputs:{x:u},backend:e,attrs:{shape:[-1,o.util.sizeFromShape(c)]}});n.push(d);let h=/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e(t,n,r,i=null){let a=n.shape[0],s=n.shape[1];null!=i&&(a=i.shape[0],s=i.shape[1]);let u=o.backend_util.computeOptimalWindowSize(s),l=new ev({windowSize:u,inSize:s,batchSize:a,outSize:Math.ceil(s/u)},r,null==i),c=[n];null!=i&&c.push(i);let d=t.runWebGLProgram(l,c,"int32");if(1===d.shape[1])return d;let h=e(t,n,r,d);return t.disposeIntermediateTensorInfo(d),h}(e,d,r);n.push(h);let f=H({inputs:{x:h},backend:e,attrs:{shape:l}});return n.forEach(t=>e.disposeIntermediateTensorInfo(t)),f}return function e(t,n,r,i=null){let a=null!=i?i.shape:n.shape,s=a[a.length-1],u=new ew(a,o.backend_util.computeOptimalWindowSize(s),r,null==i),l=t.runWebGLProgram(u,null==i?[n]:[n,i],"int32");if(l.shape.length===n.shape.length){let i=e(t,n,r,l);return t.disposeIntermediateTensorInfo(l),i}return l}(e,t,r)}let eC={kernelName:o.ArgMax,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a}=r,s=o.util.parseAxisParam(a,i.shape),u=o.backend_util.getAxesPermutation(s,i.shape.length),l=i,c=[];null!=u&&(c.push(l=en({inputs:{x:i},backend:n,attrs:{perm:u}})),s=o.backend_util.getInnerMostAxes(s.length,l.shape.length)),o.backend_util.assertAxesAreInnerMostDims("argMax",[s[0]],l.shape.length);let d=ek(n,l,s[0],"max");return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),d}},eI={kernelName:o.ArgMin,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a}=r,s=o.util.parseAxisParam(a,i.shape),u=o.backend_util.getAxesPermutation(s,i.shape.length),l=i,c=[];null!=u&&(c.push(l=en({inputs:{x:i},backend:n,attrs:{perm:u}})),s=o.backend_util.getInnerMostAxes(s.length,l.shape.length)),o.backend_util.assertAxesAreInnerMostDims("argMin",[s[0]],l.shape.length);let d=ek(n,l,s[0],"min");return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),d}},e$=B({opSnippet:A.D1+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`}),eS={kernelName:o.Asin,backendName:"webgl",kernelFunc:e$},eE=B({opSnippet:A.D1+"return log(x + sqrt(x * x + 1.0));"}),e_={kernelName:o.Asinh,backendName:"webgl",kernelFunc:eE},eT=B({opSnippet:A.D1+`
  return atan(x);
`}),eN={kernelName:o.Atan,backendName:"webgl",kernelFunc:eT},eR=D({opSnippet:g+`
  return atan(a, b);
`,packedOpSnippet:`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+v+`
  return result;
`}),eA={kernelName:o.Atan2,backendName:"webgl",kernelFunc:eR},eF=B({opSnippet:A.D1+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`}),eO={kernelName:o.Atanh,backendName:"webgl",kernelFunc:eF};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eB{constructor(e,t,n,r=!1,i=!1){if(this.variableNames=["x"],"avg"===t&&n)throw Error("Cannot compute positions for average pool.");let a=e.filterWidth,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.top,f=e.padInfo.left;this.outputShape=e.outShape;let p="avg"===t,m=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`,x="0.0";if(p||(x="-1.0 / 1e-20"),n){this.userCode=`
        const ivec2 strides = ivec2(${o}, ${s});
        const ivec2 pads = ivec2(${h}, ${f});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${c};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${l}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?i?m:g:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let b=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===t&&(b="avgValue / max(count, 1.0)");let y=4*Math.floor(a/4),v=a%4,w=`
      if (${p}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${s});
      const ivec2 pads = ivec2(${h}, ${f});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${c};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${y}; wC += 4) {
            int xC = xCCorner + wC * ${l};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${l}, d),
              getValue(batch, xR, xC + 2 * ${l}, d),
              getValue(batch, xR, xC + 3 * ${l}, d)
            );

            ${w}
          }

          int xC = xCCorner + ${y};
          if (${1===v}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${w}
          } else if (${2===v}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${l}, d),
              initializationValue,
              initializationValue
            );

            ${w}
          } else if (${3===v}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${l}, d),
              getValue(batch, xR, xC + 2 * ${l}, d),
              initializationValue
            );

            ${w}
          }
        }
        setOutput(${b});
      }
    `}}class eD{constructor(e,t,n,r=!1,i=!1){if(this.variableNames=["x"],"avg"===t&&n)throw Error("Cannot compute positions for average pool.");let a=e.filterWidth,o=e.strideDepth,s=e.strideHeight,u=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,d=e.dilationWidth,h=e.effectiveFilterDepth,f=e.effectiveFilterHeight,p=e.effectiveFilterWidth,m=e.padInfo.front,g=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;let b="avg"===t,y="0.0";if(b||(y="-1.0 / 1e-20"),n){this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${s}, ${u});
        const ivec3 pads = ivec3(${m}, ${g}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${h};
              wD += ${l}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${f};
                wR += ${c}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${p};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${f} * ${p} +
                      wR * ${p} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let v=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===t&&(v="avgValue / max(count, 1.0)");let w=4*Math.floor(a/4),k=a%4,C=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${s}, ${u});
      const ivec3 pads = ivec3(${m}, ${g}, ${x});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${l}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f};
            wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${w}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${C}
            }

            int xC = xCCorner + ${w};
            if (${1===k}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${C}
            } else if (${2===k}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${C}
            } else if (${3===k}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${C}
            }
          }
        }
        setOutput(${v});
      }
    `}}let eP={kernelName:o.AvgPool,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;(0,c.assertNotComplex)(i,"avgPool");let{filterSize:a,strides:s,pad:u,dimRoundingMode:l}=r;o.util.assert(o.backend_util.eitherStridesOrDilationsAreOne(s,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '1'`);let d=o.backend_util.computePool2DInfo(i.shape,a,s,1,u,l);if(1===d.filterWidth&&1===d.filterHeight&&o.util.arraysEqual(d.inShape,d.outShape))return k({inputs:{x:i},backend:n});let h=new eB(d,"avg",!1);return n.runWebGLProgram(h,[i],"float32")}},eM={kernelName:o.AvgPool3D,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:s,pad:u,dimRoundingMode:l,dataFormat:c}=r,d=new eD(o.backend_util.computePool3DInfo(i.shape,a,s,[1,1,1],u,l,c),"avg",!1);return n.runWebGLProgram(d,[i],"float32")}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eV{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=s-1-e.padInfo.top,c=u-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${l}, ${c});
      const float avgMultiplier = float(${1/(t*n)});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${s};
            wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class eL{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=c-1-e.padInfo.front,p=d-1-e.padInfo.top,m=h-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${p}, ${m});
      const float avgMultiplier = float(${1/(t*n*r)});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${c};
            wD += ${s}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${l}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}let eW={kernelName:o.AvgPool3DGrad,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,{filterSize:s,strides:u,pad:l,dimRoundingMode:c}=r,d=new eL(o.backend_util.computePool3DInfo(a.shape,s,u,[1,1,1],l,c));return n.runWebGLProgram(d,[i],a.dtype)}},eG={kernelName:o.AvgPoolGrad,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t;(0,c.assertNotComplex)([i,a],"avgPoolGrad");let{filterSize:s,strides:u,pad:l}=r,d=new eV(o.backend_util.computePool2DInfo(a.shape,s,u,1,l));return n.runWebGLProgram(d,[i],a.dtype)}},eU={kernelName:o.BatchMatMul,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:a}=t,{transposeA:o,transposeB:s}=r;return ei({a:i,b:a,transposeA:o,transposeB:s,backend:n})}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ez{constructor(e,t,n,r,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],o.backend_util.assertAndGetBroadcastShape(e,t),o.backend_util.assertAndGetBroadcastShape(e,n);let s="0.0";null!=r&&(o.backend_util.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let u="1.0";null!=i&&(o.backend_util.assertAndGetBroadcastShape(e,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${s};
        float scale = ${u};
        float inv = scale * inversesqrt(variance + float(${a}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eX{constructor(e,t,n,r,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],o.backend_util.assertAndGetBroadcastShape(e,t),o.backend_util.assertAndGetBroadcastShape(e,n);let s="vec4(0.0)";null!=r&&(o.backend_util.assertAndGetBroadcastShape(e,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let u="vec4(1.0)";null!=i&&(o.backend_util.assertAndGetBroadcastShape(e,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${s};
        vec4 scale = ${u};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${a}));

        setOutput((x - mean) * inv + offset);
      }
    `}}let eH={kernelName:o.FusedBatchNorm,backendName:"webgl",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,mean:i,variance:a,offset:s,scale:u}=e;o.util.assert(i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),o.util.assert(null==s||i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),o.util.assert(null==u||i.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;null==l&&(l=.001);let c=[r,i,a],d=null;null!=s&&(d=s.shape,c.push(s));let h=null;null!=u&&(h=u.shape,c.push(u));let f=(0,o.env)().getBool("WEBGL_PACK_NORMALIZATION")?new eX(r.shape,i.shape,a.shape,d,h,l):new ez(r.shape,i.shape,a.shape,d,h,l);return t.runWebGLProgram(f,c,c[0].dtype)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eK{constructor(e){let t;this.variableNames=["source"],this.outputShape=e,this.rank=e.length;let n=(0,y.kW)(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let r=function(e){if(1===e)return"sourceLoc";if(e<=6)return eq.slice(0,e).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}(this.rank),i=e.map((e,t)=>`sourceLoc.${eq[t]} = start[${t}] + coords.${eq[t]};`);t=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join("\n")}
      `,this.userCode=`
      void main() {
        ${t}
        setOutput(getSource(${r}));
      }
    `}}let eq=["x","y","z","w","u","v"];/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ej{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let t=(0,y.kW)(this.rank),n=(0,b.Ky)("coords",this.rank),r=(0,b.Ky)("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":`vec2(${r.slice(-2).join()})`,a=`getChannel(getSource(${r.join()}), ${i})`,o=`
      result.x = ${a};
      if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${a};
        --${r[this.rank-1]};
      }
    `,s=1===this.rank?"":`
      --${n[this.rank-1]};
      if (++${n[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${a};
        if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${a};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((e,t)=>`start[${t}]`).join()});`:e.map((e,t)=>`${r[t]} = ${n[t]} + start[${t}];`).join("\n");this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${o}
        ${s}
        setOutput(result);
      }
    `}}function eY(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:a,size:s}=r,[u,l]=o.slice_util.parseSliceParams(i,a,s);if(o.slice_util.assertParamsValid(i,u,l),0===o.util.sizeFromShape(l))return n.makeTensorInfo(l,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||"string"===i.dtype){let e=n.texData.get(i.dataId),t=(0,W.nT)(e.values,u,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,t)}let{isPacked:c}=n.texData.get(i.dataId),d=o.slice_util.isSliceContinous(i.shape,u,l);if(c||!d){let e=(0,o.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ej(l):new eK(l),t=[u];return n.runWebGLProgram(e,[i],i.dtype,t)}return n.uploadToGPU(i.dataId),/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r){let i=r.texData.get(e.dataId),a=r.makeTensorInfo(n,e.dtype),s=r.texData.get(a.dataId);Object.assign(s,i),s.refCount=1,s.shape=n,s.dtype=e.dtype;let u=o.slice_util.computeFlatOffset(t,o.util.computeStrides(e.shape));i.slice&&(u+=i.slice.flatOffset),s.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||e.dataId};let l=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,l+1),a}(i,u,l,n)}let eQ={kernelName:o.Slice,backendName:"webgl",kernelFunc:eY},eZ={kernelName:o.BatchToSpaceND,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,crops:s}=r;o.util.assert(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let u=a.reduce((e,t)=>e*t),l=o.backend_util.getReshaped(i.shape,a,u),c=o.backend_util.getPermuted(l.length,a.length),d=o.backend_util.getReshapedPermuted(i.shape,a,u),h=o.backend_util.getSliceBeginCoords(s,a.length),f=o.backend_util.getSliceSize(d,s,a.length),p=[],m=H({inputs:{x:i},backend:n,attrs:{shape:l}}),g=en({inputs:{x:m},backend:n,attrs:{perm:c}}),x=H({inputs:{x:g},backend:n,attrs:{shape:d}}),b=eY({inputs:{x:x},backend:n,attrs:{begin:h,size:f}});return p.push(m),p.push(g),p.push(x),p.forEach(e=>n.disposeIntermediateTensorInfo(e)),b}},eJ={kernelName:o.Bincount,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,weights:a}=t,{size:o}=r,s=n.readSync(i.dataId),u=n.readSync(a.dataId),l=(0,W.qO)(s,u,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,l)}},e0=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,e1=`
  return float(int(a.r) & int(b.r));
`,e2={kernelName:o.BitwiseAnd,backendName:"webgl",kernelFunc:function(e){let t;let{inputs:n,backend:r}=e,{a:i,b:a}=n,s=(0,o.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"),u=(0,o.env)().getNumber("WEBGL_VERSION");if(r.shouldExecuteOnCPU([i,a])||1===u){let e=r.texData.get(i.dataId).values,t=r.texData.get(a.dataId).values,[n,o]=(0,W.XM)(i.shape,a.shape,e,t,i.dtype),s=r.makeTensorInfo(o,i.dtype);return r.texData.get(s.dataId).values=n,s}return t=s?new w(e0,i.shape,a.shape,!1):new x(e1,i.shape,a.shape),r.runWebGLProgram(t,[i,a],i.dtype)}},e3={kernelName:o.BroadcastArgs,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n}=e,{s0:r,s1:i}=t,a=n.readSync(r.dataId),s=n.readSync(i.dataId),u=o.backend_util.assertAndGetBroadcastShape(Array.from(a),Array.from(s));return n.makeTensorInfo([u.length],"int32",Int32Array.from(u))}},e4=D({opSnippet:"return float(a != b);",cpuKernelImpl:W.cZ,dtype:"bool"}),e5={kernelName:o.NotEqual,backendName:"webgl",kernelFunc:e4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e8(e){let{inputs:t,backend:n}=e,{input:r}=t;return k({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}let e9={kernelName:o.Real,backendName:"webgl",kernelFunc:e8},e6={kernelName:o.Cast,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e(t){let{inputs:n,backend:r,attrs:i}=t,{x:a}=n,{dtype:s}=i;if("complex64"===s){if("complex64"===a.dtype)return k({inputs:{x:a},backend:r});let t=o.zeros(a.shape),n=e({inputs:{x:a},backend:r,attrs:{dtype:"float32"}}),i=I({inputs:{real:n,imag:t},backend:r});return t.dispose(),r.disposeIntermediateTensorInfo(n),i}if("complex64"===a.dtype){let t=e8({inputs:{input:a},backend:r}),n=e({inputs:{x:t},backend:r,attrs:{dtype:s}});return r.disposeIntermediateTensorInfo(t),n}if(!o.util.hasEncodingLoss(a.dtype,s)){let e=k({inputs:{x:a},backend:r});return{dataId:e.dataId,shape:e.shape,dtype:s}}if(r.shouldExecuteOnCPU([a])){let e=r.texData.get(a.dataId).values,[t,n,i]=(0,W.cm)(e,a.shape,a.dtype,s);return r.makeTensorInfo(t,n,i)}if("int32"===s)return function(e,t){let n=new A.l(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(a,r);if("bool"===s){let e=r.makeTensorInfo([],"bool",o.util.getTypedArrayFromDType("bool",1)),t=e4({inputs:{a:a,b:e},backend:r});return r.disposeIntermediateTensorInfo(e),t}throw Error(`Error in Cast: failed to cast ${a.dtype} to ${s}`)}},e7="return ceil(x);",te=B({opSnippet:e7,packedOpSnippet:e7,cpuKernelImpl:W.pk}),tt={kernelName:o.Ceil,backendName:"webgl",kernelFunc:te};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tn{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tr{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}let ti={kernelName:o.ClipByValue,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t;let{inputs:n,backend:r,attrs:i}=e,{x:a}=n,{clipValueMin:s,clipValueMax:u}=i;return t=(0,o.env)().getBool("WEBGL_PACK_CLIP")?new tr(a.shape):new tn(a.shape),r.runWebGLProgram(t,[a],a.dtype,[[s],[u]])}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ta{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function to(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}let ts={kernelName:o.ComplexAbs,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n}=e,{x:r}=t,i=n.texData.get(r.dataId),a=new ta(r.shape),o=[to(r,i.complexTensorInfos.real),to(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(a,o,o[0].dtype)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tu{constructor(e){this.outputShape=[],this.outputShape=o.backend_util.computeOutShape(e,1),this.variableNames=e.map((e,t)=>`T${t}`);let t=Array(e.length-1);t[0]=e[0][1];for(let n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];let n=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let e=1;e<t.length;e++){let r=t[e-1];n.push(`else if (yC < ${t[e]}) setOutput(getT${e}(yR, yC-${r}));`)}let r=t.length,i=t[t.length-1];n.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${n.join("\n        ")}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tl{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=o.backend_util.computeOutShape(e,t);let n=this.outputShape,r=n.length,i=(0,y.kW)(r),a=(0,b.Ky)("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((e,t)=>`T${t}`);let u=Array(e.length-1);u[0]=e[0][t];for(let n=1;n<u.length;n++)u[n]=u[n-1]+e[n][t];let l=s[t],c=s.slice(-2),d=s.join(),h=`if (${l} < ${u[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let e=1;e<u.length;e++){let t=u[e-1];h+=`
        if (${l} < ${u[e]}  && ${l} >= ${u[e-1]}) {
          return getChannel(
            getT${e}(${tc(s,l,t)}),
            vec2(${tc(c,l,t)}));
        }`}let f=u.length,p=u[u.length-1];h+=`
        return getChannel(
          getT${f}(${tc(s,l,p)}),
          vec2(${tc(c,l,p)}));`,this.userCode=`
      float getValue(${s.map(e=>"int "+e)}) {
        ${h}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${a}), 0., 0., 0.);

        ${a[r-1]} = ${a[r-1]} + 1;
        if (${a[r-1]} < ${n[r-1]}) {
          result.g = getValue(${a});
        }

        ${a[r-2]} = ${a[r-2]} + 1;
        if (${a[r-2]} < ${n[r-2]}) {
          result.a = getValue(${a});
        }

        ${a[r-1]} = ${a[r-1]} - 1;
        if (${a[r-2]} < ${n[r-2]} &&
            ${a[r-1]} < ${n[r-1]}) {
          result.b = getValue(${a});
        }
        setOutput(result);
      }
    `}}function tc(e,t,n){let r=e.indexOf(t);return e.map((e,t)=>t===r?`${e} - ${n}`:e).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function td(e){let{inputs:t,backend:n}=e,{input:r}=t;return k({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}let th={kernelName:o.Imag,backendName:"webgl",kernelFunc:td};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tf(e){let{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,a=o.util.parseAxisParam(i,t[0].shape)[0],s=t.map(e=>e.shape);o.backend_util.assertParamsConsistent(s,a);let u=o.backend_util.computeOutShape(t.map(e=>e.shape),a);if(0===o.util.sizeFromShape(u))return n.makeTensorInfo(u,t[0].dtype,[]);let l=t.filter(e=>o.util.sizeFromShape(e.shape)>0);return 1===l.length?k({inputs:{x:l[0]},backend:n}):/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e(t,n,r){let i=t[0].dtype;if("complex64"===i){let i=t.map(e=>e8({inputs:{input:e},backend:r})),a=t.map(e=>td({inputs:{input:e},backend:r})),o=e(i,n,r),s=e(a,n,r),u=I({inputs:{real:o,imag:s},backend:r});return i.forEach(e=>r.disposeIntermediateTensorInfo(e)),a.forEach(e=>r.disposeIntermediateTensorInfo(e)),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),u}let a=r.shouldExecuteOnCPU(t);if("string"===i&&(a=!0),a){let e=t.map(e=>{let t=o.util.sizeFromShape(e.shape.slice(n));return H({inputs:{x:e},backend:r,attrs:{shape:[-1,t]}})}),a=e.map(e=>({vals:r.readSync(e.dataId),shape:e.shape})),s=o.backend_util.computeOutShape(e.map(e=>e.shape),1),u=1===e[0].shape[0],l=(0,W.n7)(a,s,i,u),c=o.backend_util.computeOutShape(t.map(e=>e.shape),n),d=r.makeTensorInfo(c,i,l);return e.forEach(e=>r.disposeIntermediateTensorInfo(e)),d}let s=t.filter(e=>o.util.sizeFromShape(e.shape)>0),u=(0,o.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(1===s.length){let e=u?new A.l(t[0].shape,A.bl):new F.cc(t[0].shape,A.bl);return r.runWebGLProgram(e,t,i)}let l=(0,o.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>l){let t=[];for(let i=0;i<s.length;i+=l){let a=s.slice(i,i+l);t.push(e(a,n,r))}let i=e(t,n,r);for(let e of t)r.disposeIntermediateTensorInfo(e);return i}if(u){let e=new tl(s.map(e=>e.shape),n);return r.runWebGLProgram(e,s,i)}let{tensors2D:c,outShape:d}=function(e,t,n){let r=o.backend_util.computeOutShape(e.map(e=>e.shape),t);return{tensors2D:e.map(e=>H({inputs:{x:e},attrs:{shape:[-1,o.util.sizeFromShape(e.shape.slice(t))]},backend:n})),outShape:r}}(s,n,r),h=new tu(c.map(e=>e.shape)),f=r.runWebGLProgram(h,c,i);c.forEach(e=>r.disposeIntermediateTensorInfo(e));let p=H({inputs:{x:f},attrs:{shape:d},backend:r});return r.disposeIntermediateTensorInfo(f),p}(l,a,n)}let tp={kernelName:o.Concat,backendName:"webgl",kernelFunc:tf};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tm{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;let a=e.padInfo.top,o=e.padInfo.left,s=e.strideHeight,u=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,f=4*Math.floor(e.inChannels/4),p=e.inChannels%4,m="channelsLast"===e.dataFormat,g="",x="";n&&(g=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:i?`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:`
          float activation(float x) {
            ${n}
          }
        `,x="result = activation(result);"),t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${g}

      const ivec2 strides = ivec2(${s}, ${u});
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${m?3:1}];

        ivec2 xRCCorner =
            ivec2(coords[${m?1:2}], coords[${m?2:3}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${l};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${h}; wC++) {
            int xC = xCCorner + wC * ${c};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${f}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${m}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${1===p}) {

              if (${m}) {
                dotProd +=
                    getX(batch, xR, xC, ${f}) *
                    getW(wR, wC, ${f}, d2);
              } else {
                dotProd +=
                    getX(batch, ${f}, xR, xC) *
                    getW(wR, wC, ${f}, d2);
              }

            } else if (${2===p}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2)
              );

              if (${m}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${3===p}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2),
                getW(wR, wC, ${f} + 2, d2)
              );

              if (${m}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1),
                  getX(batch, xR, xC, ${f} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC),
                  getX(batch, ${f} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${t?"result += getBiasAtOutCoords();":""}
        ${x}
        setOutput(result);
      }
    `}}class tg{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterDepth,d=e.filterHeight,h=e.filterWidth,f=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${a}, ${o});
      const ivec3 pads = ivec3(${t}, ${n}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${c}; wF++) {
          int xF = xFCorner + wF * ${s};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h}; wC++) {
              int xC = xCCorner + wC * ${l};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${f}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${1===p}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${f}) *
                  getW(wF, wR, wC, ${f}, d2);
              } else if (${2===p}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${3===p}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1),
                  getX(batch, xF, xR, xC, ${f} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2),
                  getW(wF, wR, wC, ${f} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tx{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=(0,m.C9)(this.outputShape.length);let a=e.padInfo.left,s=e.strideWidth,u=e.dilationWidth,l=e.filterHeight,c=e.filterWidth,d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let e=0;e<c;e++)d+=`
           vec4 xTexelC${2*e};
           int xTexelC${2*e}Ready;
           vec4 xTexelC${2*e+1};
           int xTexelC${2*e+1}Ready;
           vec4 xC${e};`;d+=`
     for (int r = 0; r < ${l}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let e=0;e<c;e++)d+=`
           xTexelC${2*e} = vec4(0.0);
           xTexelC${2*e}Ready = 0;
           xTexelC${2*e+1} = vec4(0.0);
           xTexelC${2*e+1}Ready = 0;
           xC${e} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let t=0;t<(c+1)/2;t++){let n=2*t;if(d+=`
           xC = xCCorner + ${n*u};
           `,1===s){if(n<c&&(a%2==1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${n}Ready == 0) {
                   xTexelC${n} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${n}.zw = vec2(0.0);
                   }
                   xTexelC${n}Ready = 1;
                 }
               `,1===u&&n>0?d+=`
                 xC${n} = vec4(xTexelC${n-2}.zw, xTexelC${n}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${n} = vec4(previous.zw, xTexelC${n}.xy);
                   } else {
                     xC${n} = vec4(0.0, 0.0, xTexelC${n}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${n}Ready == 0) {
                   xTexelC${n} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${n}.zw = vec2(0.0);
                   }
                   xTexelC${n}Ready = 1;
                 }

                 xC${n} = xTexelC${n};
                 `,n+1<c)){let e=a%2==0?o.util.nearestLargerEven(u):u;u%2==0&&a%2==1||u%2!=0&&a%2!=1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${e};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${n+1}Ready == 0) {
                     xTexelC${n+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${n+1}.zw = vec2(0.0);
                     }
                     xTexelC${n+1}Ready = 1;
                   }
                   `,u>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${n+1} = vec4(previous.zw, xTexelC${n+1}.xy);
                     } else {
                      xC${n+1} = vec4(0.0, 0.0, xTexelC${n+1}.xy);
                     }
                     `:d+=`
                     xC${n+1} = vec4(xTexelC${n}.zw, xTexelC${n+1}.xy);
                     `):1===e?d+=`
                     xC${n+1} = xTexelC${n};
                     `:d+=`
                     xCOffset = xC + ${e};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${n+1}Ready == 0) {
                       xTexelC${n+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${n+1}.zw = vec2(0.0);
                       }
                       xTexelC${n+1}Ready = 1;
                     }

                     xC${n+1} = xTexelC${n+1};
                     `}}else n<c&&(a%2==1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${n}Ready == 0) {
                   xTexelC${n} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${n}.zw = vec2(0.0);
                   }
                   xTexelC${n}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${n+1}Ready == 0) {
                   xTexelC${n+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${n+1}.zw = vec2(0.0);
                   }
                   xTexelC${n+1}Ready = 1;
                 }

                 xC${n} = vec4(xTexelC${n}.zw, xTexelC${n+1}.zw);
               `,n+1<c&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${n+1} = vec4(xTexelC${n+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${n}Ready == 0) {
                   xTexelC${n} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${n}.zw = vec2(0.0);
                   }
                   xTexelC${n}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${n+1}Ready == 0) {
                   xTexelC${n+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${n+1}.zw = vec2(0.);
                   }
                   xTexelC${n+1}Ready = 1;
                 }

                 xC${n} = vec4(
                   xTexelC${n}.xy, xTexelC${n+1}.xy);
               `,n+1<c&&(d+=`
                   xC${n+1} = vec4(xTexelC${n}.zw, xTexelC${n+1}.zw);
                 `)));n<c&&(d+=`
             wTexel = getW(r, ${n}, d1, d2);
             dotProd += xC${n}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${n}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,n+1<c&&(d+=`
               wTexel = getW(r, ${n+1}, d1, d2);
               dotProd += xC${n+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${n+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   
     }
   
     }
   `;let h="",f="";n&&(h=r?`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${n}
         }`:i?`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${n}
         }`:`vec4 activation(vec4 x) {
           ${n}
         }`,f="result = activation(result);"),t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${h}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${t?"result += getBiasAtOutCoords();":""}
         ${f}
         setOutput(result);
       }
     `}}var tb=n(26826);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ty{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=(0,m.C9)(this.outputShape.length);let{dataFormat:n}=t,r=(0,tb.A)(),i="channelsLast"===n,a=i?1:2,o=i?2:3,s=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`,u="";for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)u+=`
          blockIndex = rc.z + ${t};
          pos = rc.y + ${e};

          ${s}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${a}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${2*e+t}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${2*e+t}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tv(e,t){let n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&1===n&&e[0]>1?[e[0],1]:null}function tw({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:s=0,activation:u=null}){let l;let d=e.shape,h=r.texData.get(e.dataId),f=n.inChannels,p=d[0]*d[1]*d[2],m=n.outChannels,g="channelsLast"===n.dataFormat,x=[];if(null!=a){let e=tv(a.shape,g);null!=e&&(a=H({inputs:{x:a},backend:r,attrs:{shape:e}}),x.push(a))}if(null!=i){let e=tv(i.shape,g);null!=e&&(i=H({inputs:{x:i},backend:r,attrs:{shape:e}}),x.push(i))}if(!((1===p||1===m)&&f>1e3)&&h.isPacked&&g&&null!=h.texture&&d[2]%2!=0&&o.util.arraysEqual(h.shape.slice(-3),d.slice(-3))){let f=d[0]*d[1]*(d[2]+1),p={dataId:e.dataId,shape:[1,f,n.inChannels],dtype:e.dtype},m=h.shape;h.shape=h.shape.slice(),h.shape[h.shape.length-2]++,o.util.assert(c.isReshapeFree(h.shape,p.shape),()=>`packed reshape ${h.shape} to ${p.shape} isn't free`);let g=H({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});x.push(g);let b=ei({a:p,b:g,backend:r,transposeA:!1,transposeB:!1,bias:i,activation:u,preluActivationWeights:a,leakyreluAlpha:s}),y=r.texData.get(b.dataId);o.util.assert(y.isPacked,()=>"batchMatMul result is expected to be packed"),h.shape=m,y.shape=n.outShape,(l=k({inputs:{x:b},backend:r})).shape=n.outShape,x.push(b)}else{let o=n.outHeight*n.outWidth,c=H({inputs:{x:e},backend:r,attrs:{shape:g?[n.batchSize,o,n.inChannels]:[n.batchSize,n.inChannels,o]}}),d=H({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),h=ei({a:g?c:d,b:g?d:c,transposeA:!g,transposeB:!1,backend:r,bias:i,activation:u,preluActivationWeights:a,leakyreluAlpha:s});l=H({inputs:{x:h},backend:r,attrs:{shape:n.outShape}}),x.push(c),x.push(d),x.push(h)}for(let e of x)r.disposeIntermediateTensorInfo(e);return l}function tk({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:s=0,activation:u=null}){let{filterWidth:l,filterHeight:c,inChannels:d,outWidth:h,outHeight:f,dataFormat:p}=n,m="channelsLast"===p,g=l*c*d,x=f*h,b=[n.batchSize,g,x],y=[];if(null!=a){let e=tv(a.shape,m);null!=e&&(a=H({inputs:{x:a},backend:r,attrs:{shape:e}}),y.push(a))}if(null!=i){let e=tv(i.shape,m);null!=e&&(i=H({inputs:{x:i},backend:r,attrs:{shape:e}}),y.push(i))}let v=H({inputs:{x:t},backend:r,attrs:{shape:[1,g,o.util.sizeFromShape(t.shape)/g]}});y.push(v);let w=new ty(b,n),k=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],C=r.runWebGLProgram(w,[e],"float32",k),I=H({inputs:{x:C},backend:r,attrs:{shape:b}});y.push(C),y.push(I);let $=null!=i,S=null!=a,E="leakyrelu"===u,_=u?P(u,!0):null,T=new M(m?I.shape:v.shape,m?v.shape:I.shape,m?[n.batchSize,x,n.outChannels]:[n.batchSize,n.outChannels,x],!0,!1,$,_,S,E),N=m?[I,v]:[v,I];if(i&&N.push(i),S&&N.push(a),E){let e=r.makeTensorInfo([],"float32",o.util.createScalarValue(s,"float32"));N.push(e),y.push(e)}let R=r.runWebGLProgram(T,N,"float32"),A=H({inputs:{x:R},backend:r,attrs:{shape:n.outShape}});for(let e of(y.push(R),y))r.disposeIntermediateTensorInfo(e);return A}let tC={kernelName:o.Conv2D,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t;let{inputs:n,backend:r,attrs:i}=e,{x:a,filter:s}=n,{strides:u,pad:l,dataFormat:c,dilations:d,dimRoundingMode:h}=i,f=o.backend_util.convertConv2DDataFormat(c),p=o.backend_util.computeConv2DInfo(a.shape,s.shape,u,d,l,h,!1,f);if(1===p.filterHeight&&1===p.filterWidth&&1===p.dilationHeight&&1===p.dilationWidth&&1===p.strideHeight&&1===p.strideWidth&&("SAME"===p.padInfo.type||"VALID"===p.padInfo.type))t=tw({x:a,filter:s,convInfo:p,backend:r});else if(p.strideWidth<=2&&"channelsLast"===f&&(0,o.env)().getBool("WEBGL_EXP_CONV")){let e=new tx(p),n=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];t=r.runWebGLProgram(e,[a,s],"float32",n)}else if((0,o.env)().getBool("WEBGL_CONV_IM2COL"))t=tk({x:a,filter:s,convInfo:p,backend:r});else{let e=new tm(p);t=r.runWebGLProgram(e,[a,s],"float32")}let m=H({inputs:{x:t},backend:r,attrs:{shape:p.outShape}});return r.disposeIntermediateTensorInfo(t),m}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tI{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a="channelsLast"===e.dataFormat;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${a?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class t${constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a="channelsLast"===e.dataFormat,o=t-1-e.padInfo.top,s=n-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${a?3:1}];

        ivec2 dyCorner = ivec2(coords[${a?1:2}], coords[${a?2:3}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${a}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class tS{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,a=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${n} - ${a};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${o};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class tE{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${s}, ${u}, ${l});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${n}; wR++) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${n} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}let t_={kernelName:o.Conv2DBackpropFilter,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,pad:u,dataFormat:l,dimRoundingMode:c,filterShape:d}=r,h=o.backend_util.convertConv2DDataFormat(l),f=new tI(o.backend_util.computeConv2DInfo(i.shape,d,s,1,u,c,!1,h));return n.runWebGLProgram(f,[i,a],"float32")}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tT{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=(0,m.C9)(this.outputShape.length);let t=e.filterHeight,n=e.filterWidth,r=t-1-e.padInfo.top,i=n-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            int wCPerm = ${n} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}let tN={kernelName:o.Conv2DBackpropInput,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{inputShape:s,strides:u,pad:l,dataFormat:c,dimRoundingMode:d}=r,h=o.backend_util.convertConv2DDataFormat(c),f=o.backend_util.computeConv2DInfo(s,a.shape,u,1,l,d,!1,h);if((0,o.env)().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===h){let e=[[f.strideHeight,f.strideWidth]],t=new tT(f);return n.runWebGLProgram(t,[i,a],"float32",e)}{let e=new t$(f);return n.runWebGLProgram(e,[i,a],"float32")}}},tR={kernelName:o.Conv3D,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:s,pad:u,dilations:l}=r,c=new tg(o.backend_util.computeConv3DInfo(i.shape,a.shape,s,l,u));return n.runWebGLProgram(c,[i,a],"float32")}},tA={kernelName:o.Conv3DBackpropFilterV2,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,pad:u,filterShape:l}=r,c=new tS(o.backend_util.computeConv3DInfo(i.shape,l,s,1,u));return n.runWebGLProgram(c,[i,a],"float32")}},tF={kernelName:o.Conv3DBackpropInputV2,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{pad:s,strides:u,inputShape:l}=r,c=new tE(o.backend_util.computeConv3DInfo(l,a.shape,u,1,s));return n.runWebGLProgram(c,[i,a],"float32")}},tO=B({opSnippet:O+`
  return cos(x);
`,packedOpSnippet:`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${v}
  return result;
`}),tB={kernelName:o.Cos,backendName:"webgl",kernelFunc:tO},tD=B({opSnippet:`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`}),tP={kernelName:o.Cosh,backendName:"webgl",kernelFunc:tD};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tM{constructor(e,t,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[a,o,s,u]=e,[l]=t,[c,d]=n;this.outputShape=[l,c,d,u];let[h,f]=[`${o-1}.0`,`${s-1}.0`],[p,m,g]=c>1?[`${(o-1)/(c-1)}`,"(y2-y1) * height_ratio",`y1*${h} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${h}`],[x,b,y]=d>1?[`${(s-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${f} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${f}`];this.userCode=`
      const float height_ratio = float(${p});
      const float width_ratio = float(${x});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${a}) {
          return;
        }

        float height_scale = ${m};
        float width_scale = ${b};

        float in_y = ${g};
        if( in_y < 0.0 || in_y > ${h} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${y};
        if( in_x < 0.0 || in_x > ${f} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${"bilinear"===r?1:0} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}let tV={kernelName:o.CropAndResize,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:a,boxInd:o}=t,{cropSize:s,method:u,extrapolationValue:l}=r,c=new tM(i.shape,a.shape,s,u,l);return n.runWebGLProgram(c,[i,a,o],"float32")}};(i=a||(a={})).Prod="*",i.Sum="+";class tL{constructor(e,t,n,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];let i=this.outputShape.length,o=this.op===a.Prod?"1.0":"0.0",s=n?o:`getX(${tW(i,"coords",this.op)})`,u=this.outputShape[this.outputShape.length-1],l="",c="";n?(l=r?`end != ${u-1}`:"end != 0",c=r?"end + 1":"end - 1"):(l=r?`end + pow2 < ${u}`:"end >= pow2",c=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${(0,y.kW)(i)} coords = getOutputCoords();
        int end = ${tG(i,"coords",this.op)};
        float val = ${s};
        int pow2 = int(pow(2.0, index));
        if (${l}) {
          int idx = ${c};
          ${tG(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${tW(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function tW(e,t,n){if(1===e)return`${t}`;if(2===e)return`${t}.x, ${t}.y`;if(3===e)return`${t}.x, ${t}.y, ${t}.z`;if(4===e)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function tG(e,t,n){if(1===e)return`${t}`;if(2===e)return`${t}.y`;if(3===e)return`${t}.z`;if(4===e)return`${t}.w`;throw Error(`Cumulative ${n} for rank ${e} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tU(e,t,n,r,i,a){let s=t.shape.length,u=o.backend_util.getAxesPermutation([r],s),l=t;null!=u&&(l=en({inputs:{x:t},backend:n,attrs:{perm:u}}));let c=o.backend_util.getInnerMostAxes(1,s)[0];if(c!==s-1)throw Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);let d=l.shape[c],h=k({inputs:{x:l},backend:n});for(let t=0;t<=Math.ceil(Math.log2(d))-1;t++){let r=new tL(e,l.shape,!1,a),i=[[t]],o=h;h=n.runWebGLProgram(r,[h],h.dtype,i),n.disposeIntermediateTensorInfo(o)}if(i){let t=new tL(e,l.shape,i,a),r=h;h=n.runWebGLProgram(t,[h],h.dtype),n.disposeIntermediateTensorInfo(r)}if(null!=u){let e=en({inputs:{x:h},backend:n,attrs:{perm:o.backend_util.getUndoAxesPermutation(u)}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(l),e}return h}let tz={kernelName:o.Cumprod,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,exclusive:s,reverse:u}=r;return tU(a.Prod,i,n,o,s,u)}},tX={kernelName:o.Cumsum,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,exclusive:s,reverse:u}=r;return tU(a.Sum,i,n,o,s,u)}},tH={kernelName:o.DenseBincount,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,weights:a}=t,{size:o,binaryOutput:s}=r;if(1===i.shape.length){let e=n.readSync(i.dataId),t=n.readSync(a.dataId),r=(0,W.qO)(e,t,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,r)}if(2===i.shape.length){let e=n.bufferSync(i),t=n.bufferSync(a),r=(0,W.cx)(e,t,o,s);return n.makeTensorInfo(r.shape,a.dtype,r.values)}throw Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tK{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}let tq={kernelName:o.DepthToSpace,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:a,dataFormat:o}=r,s=i.shape[0],u="NHWC"===o?i.shape[1]:i.shape[2],l="NHWC"===o?i.shape[2]:i.shape[3],c="NHWC"===o?i.shape[3]:i.shape[1],d=u*a,h=l*a,f=c/(a*a),p=new tK("NHWC"===o?[s,d,h,f]:[s,f,d,h],a,o);return n.runWebGLProgram(p,[i],i.dtype)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tj{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=(0,m.C9)(this.outputShape.length);let a=e.filterHeight,o=e.filterWidth,s=e.outChannels/e.inChannels,u="",l="";n&&(u=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:i?`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:`
          float activation(float x) {
            ${n}
          }
        `,l="result = activation(result);"),t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${s};
        int q = d2 - d1 * ${s};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${a}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${t?"result += getBiasAtOutCoords();":""}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tY{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=(0,m.C9)(this.outputShape.length);let a=e.outChannels/e.inChannels,s=e.padInfo.left,u=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,h=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let e=0;e<d;e++)h+=`
          vec4 xTexelC${2*e};
          int xTexelC${2*e}Ready;
          vec4 xTexelC${2*e+1};
          int xTexelC${2*e+1}Ready;
          vec4 xC${e};`;h+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let e=0;e<d;e++)h+=`
          xTexelC${2*e} = vec4(0.0);
          xTexelC${2*e}Ready = 0;
          xTexelC${2*e+1} = vec4(0.0);
          xTexelC${2*e+1}Ready = 0;
          xC${e} = vec4(0.0);`;h+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let e=0;e<(d+1)/2;e++){let t=2*e;if(h+=`
          xC = xCCorner + ${t*l};
          `,1===u){if(t<d&&(s%2==1?(h+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {
                  xTexelC${t} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${t}.zw = vec2(0.0);
                  }
                  xTexelC${t}Ready = 1;
                }
              `,1===l&&t>0?h+=`
                xC${t} = vec4(xTexelC${t-2}.zw, xTexelC${t}.xy);
                `:h+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${t} = vec4(previous.zw, xTexelC${t}.xy);
                  } else {
                    xC${t} = vec4(0.0, 0.0, xTexelC${t}.xy);
                  }
                  `):h+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {
                  xTexelC${t} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${t}.zw = vec2(0.0);
                  }
                  xTexelC${t}Ready = 1;
                }

                xC${t} = xTexelC${t};
                `,t+1<d)){let e=s%2==0?o.util.nearestLargerEven(l):l;l%2==0&&s%2==1||l%2!=0&&s%2!=1?(h+=`
                  xCOffset = xC + imod(pads[1], 2) + ${e};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {
                    xTexelC${t+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${t+1}.zw = vec2(0.0);
                    }
                    xTexelC${t+1}Ready = 1;
                  }
                  `,l>1?h+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${t+1} = vec4(previous.zw, xTexelC${t+1}.xy);
                    } else {
                     xC${t+1} = vec4(0.0, 0.0, xTexelC${t+1}.xy);
                    }
                    `:h+=`
                    xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.xy);
                    `):1===e?h+=`
                    xC${t+1} = xTexelC${t};
                    `:h+=`
                    xCOffset = xC + ${e};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {
                      xTexelC${t+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${t+1}.zw = vec2(0.0);
                      }
                      xTexelC${t+1}Ready = 1;
                    }

                    xC${t+1} = xTexelC${t+1};
                    `}}else t<d&&(s%2==1?(h+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {
                  xTexelC${t} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${t}.zw = vec2(0.0);
                  }
                  xTexelC${t}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${t+1}Ready == 0) {
                  xTexelC${t+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${t+1}.zw = vec2(0.0);
                  }
                  xTexelC${t+1}Ready = 1;
                }

                xC${t} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);
              `,t+1<d&&(h+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${t+1} = vec4(xTexelC${t+1}.xy, final.xy);
                `)):(h+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {
                  xTexelC${t} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${t}.zw = vec2(0.0);
                  }
                  xTexelC${t}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {
                  xTexelC${t+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${t+1}.zw = vec2(0.);
                  }
                  xTexelC${t+1}Ready = 1;
                }

                xC${t} = vec4(
                  xTexelC${t}.xy, xTexelC${t+1}.xy);
              `,t+1<d&&(h+=`
                  xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);
                `)));t<d&&(h+=`
            wTexel = getW(r, ${t}, d1, q);
            dotProd += xC${t} * vec4(wTexel.xz, wTexel.xz);
          `,t+1<d&&(h+=`
              wTexel = getW(r, ${t+1}, d1, q);
              dotProd += xC${t+1} * vec4(wTexel.xz, wTexel.xz);
            `))}h+=`
    }
  
      }
    `;let f="",p="";n&&(f=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:i?`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:`vec4 activation(vec4 x) {
          ${n}
        }`,p="result = activation(result);"),t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${f}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${a};
        int q = d2 - d1 * ${a};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${h}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${t?"result += getBiasAtOutCoords();":""}
        ${p}
        setOutput(result);
      }
    `}}let tQ={kernelName:o.DepthwiseConv2dNative,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t;let{inputs:n,backend:r,attrs:i}=e,{x:a,filter:s}=n,{strides:u,pad:l,dilations:c,dimRoundingMode:d}=i,h=c;null==h&&(h=[1,1]),o.util.assert(o.backend_util.eitherStridesOrDilationsAreOne(u,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${h}'`);let f=o.backend_util.computeConv2DInfo(a.shape,s.shape,u,h,l,d,!0);t=(0,o.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels==1?new tY(f):new tj(f);let p=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return r.runWebGLProgram(t,[a,s],"float32",p)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tZ{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${a} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class tJ{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=t-1-e.padInfo.top,o=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${s}; dm++) {
              int d2 = d1 * ${s} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}let t0={kernelName:o.DepthwiseConv2dNativeBackpropFilter,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:s,dilations:u,pad:l,dimRoundingMode:c,filterShape:d}=r,h=new tZ(o.backend_util.computeConv2DInfo(i.shape,d,s,u,l,c,!0));return n.runWebGLProgram(h,[i,a],"float32")}},t1={kernelName:o.DepthwiseConv2dNativeBackpropInput,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{strides:s,dilations:u,pad:l,dimRoundingMode:c,inputShape:d}=r,h=new tJ(o.backend_util.computeConv2DInfo(d,a.shape,s,u,l,c,!0));return n.runWebGLProgram(h,[i,a],"float32")}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t2{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}let t3={kernelName:o.Diag,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n}=e,{x:r}=t,i=[...r.shape,...r.shape],a=o.util.sizeFromShape(r.shape),s=H({inputs:{x:r},backend:n,attrs:{shape:[a]}}),u=new t2(a),l=n.runWebGLProgram(u,[s],s.dtype),c=H({inputs:{x:l},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),c}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t4{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;let{inHeight:t,inWidth:n,padInfo:r,strideHeight:i,strideWidth:a,filterHeight:o,filterWidth:s,dilationHeight:u,dilationWidth:l}=e,{top:c,left:d}=r;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${a});
      const ivec2 pads = ivec2(${c}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${s}; w++) {
              int wIn = wBeg + w * ${l};

              if (wIn >= 0 && wIn < ${n}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}let t5={kernelName:o.Dilation2D,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t;let{inputs:n,backend:r,attrs:i}=e,{x:a,filter:s}=n,{strides:u,pad:l,dilations:c}=i,d=o.backend_util.computeDilation2DInfo(a.shape,s.shape,u,l,"NHWC",c),h=new t4(d),f=H({inputs:{x:t=r.runWebGLProgram(h,[a,s],"float32")},backend:r,attrs:{shape:d.outShape}});return r.disposeIntermediateTensorInfo(t),f}},t8={kernelName:o.Einsum,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,{allDims:a,summedDims:s,idDims:u}=o.backend_util.decodeEinsumEquation(i,t.length);o.backend_util.checkEinsumDimSizes(a.length,u,t);let{path:l,steps:c}=o.backend_util.getEinsumComputePath(s,u),d=c.length,h=null,f=a.length,p=[];for(let e=0;e<d;++e){for(let r of c[e]){let e;let{permutationIndices:i,expandDims:a}=o.backend_util.getEinsumPermutation(f,u[r]);o.backend_util.isIdentityPermutation(i)?e=t[r]:(e=en({inputs:{x:t[r]},backend:n,attrs:{perm:i}}),p.push(e));let s=e.shape.slice();for(let e=0;e<a.length;++e)s.splice(a[e],0,1);o.util.arraysEqual(e.shape,s)||(e=H({inputs:{x:e},backend:n,attrs:{shape:s}}),p.push(e)),null===h?h=e:(h=U({inputs:{a:e,b:h},backend:n}),p.push(h))}e<d-1&&(l[e]>=0&&(h=ee({inputs:{x:h},backend:n,attrs:{axis:l[e]-(a.length-f),keepDims:!1}}),p.push(h)),f--)}for(let e of p)e!==h&&n.disposeIntermediateTensorInfo(e);return h}},t9=B({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`}),t6={kernelName:o.Elu,backendName:"webgl",kernelFunc:t9},t7=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,ne={kernelName:o.EluGrad,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n}=e,{dy:r,y:i}=t,a=(0,o.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new w(t7,r.shape,i.shape):new x("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,i.shape);return n.runWebGLProgram(a,[r,i],r.dtype)}},nt=D({opSnippet:"return float(a == b);",packedOpSnippet:`
  return vec4(equal(a, b));
`,dtype:"bool",cpuKernelImpl:W.gv}),nn={kernelName:o.Equal,backendName:"webgl",kernelFunc:nt},nr=B({opSnippet:`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${o.backend_util.ERF_P};
  float a1 = ${o.backend_util.ERF_A1};
  float a2 = ${o.backend_util.ERF_A2};
  float a3 = ${o.backend_util.ERF_A3};
  float a4 = ${o.backend_util.ERF_A4};
  float a5 = ${o.backend_util.ERF_A5};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`}),ni={kernelName:o.Erf,backendName:"webgl",kernelFunc:nr},na=B({opSnippet:O+`
  return exp(x);
`,packedOpSnippet:`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cpuKernelImpl:W.aX,dtype:"float32"}),no={kernelName:o.Exp,backendName:"webgl",kernelFunc:na};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ns(e){let{inputs:t,attrs:n,backend:r}=e,{dim:i}=n,{input:a}=t,s=a.shape.length,u=a.shape.slice(),l=i;return i<0&&(o.util.assert(-(s+1)<=i,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+i+1),u.splice(l,0,1),H({inputs:{x:a},backend:r,attrs:{shape:u}})}let nu={kernelName:o.ExpandDims,backendName:"webgl",kernelFunc:ns},nl="return exp(x) - 1.0;",nc=B({opSnippet:nl,packedOpSnippet:nl,cpuKernelImpl:W.tx}),nd={kernelName:o.Expm1,backendName:"webgl",kernelFunc:nc};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nh{constructor(e,t,n){let r;this.variableNames=["real","imag"];let i=t[1];this.outputShape=t;let a=n?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=n?`${i}.0`:"1.0";if("real"===e)r="return real * expR - imag * expI;";else if("imag"===e)r="return real * expI + imag * expR;";else throw Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${r}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${i});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${i}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nf(e,t,n){let r=n.texData.get(e.dataId),i=o.util.sizeFromShape(e.shape),a=e.shape[e.shape.length-1],s=H({inputs:{x:e},backend:n,attrs:{shape:[i/a,a]}}),u=s.shape,l=new nh("real",u,t),c=new nh("imag",u,t),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:u},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:u}],h=n.runWebGLProgram(l,d,"float32"),f=n.runWebGLProgram(c,d,"float32"),p=I({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);let m=H({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(p),m}let np={kernelName:o.FFT,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n}=e,{input:r}=t;return nf(r,!1,n)}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nm{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ng(e){let{backend:t,attrs:n}=e,{shape:r,value:i}=n,{dtype:a}=n;if("string"===(a=a||o.util.inferDtype(i))){let e=o.util.getArrayFromDType(a,o.util.sizeFromShape(r));return e.fill(i),t.makeTensorInfo(r,a,e)}{let e=new nm(r,i),n=[[i]];return t.runWebGLProgram(e,[],a,n)}}let nx={kernelName:o.Fill,backendName:"webgl",kernelFunc:ng};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nb{constructor(e){this.variableNames=["Image"],this.outputShape=[];let t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ny={kernelName:o.FlipLeftRight,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{let{image:n}=e,r=new nb(n.shape);return t.runWebGLProgram(r,[n],n.dtype)}},nv="return floor(x);",nw=B({opSnippet:nv,packedOpSnippet:nv,cpuKernelImpl:W.MZ}),nk={kernelName:o.Floor,backendName:"webgl",kernelFunc:nw},nC=D({opSnippet:`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,packedOpSnippet:`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,dtype:"int32"}),nI={kernelName:o.FloorDiv,backendName:"webgl",kernelFunc:nC};var n$=n(31929);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nS{constructor(e){this.variableNames=["A"];let t=(0,tb.A)(),[n,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nE{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let t=(0,tb.A)(),[n,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${n}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let n_={kernelName:o.FromPixels,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:i}=e,{pixels:a}=t,{numChannels:s}=i,u="undefined"!=typeof HTMLVideoElement&&a instanceof HTMLVideoElement,l="undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement,[c,d]=u?[a.videoWidth,a.videoHeight]:[a.width,a.height],h=[d,c],f=[d,c,s];if(l||u){let e=(0,o.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(null==r||e!==nT)&&(nT=e,r=document.createElement("canvas").getContext("2d",{willReadFrequently:nT})),r.canvas.width=c,r.canvas.height=d,r.drawImage(a,0,0,c,d),a=r.canvas}let p=n.makeTensorInfo(h,"int32");n.texData.get(p.dataId).usage=n$.v2.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),a);let m=(0,o.env)().getBool("WEBGL_PACK")?new nE(f):new nS(f),g=n.runWebGLProgram(m,[p],"int32");return n.disposeData(p.dataId),g}},nT=(0,o.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU"),nN={kernelName:o.FusedConv2D,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t;let{inputs:n,backend:r,attrs:i}=e,{x:a,filter:s,bias:u,preluActivationWeights:l}=n,{strides:c,pad:d,dataFormat:h,dilations:f,dimRoundingMode:p,activation:m,leakyreluAlpha:g}=i,x=o.backend_util.convertConv2DDataFormat(h),b=o.backend_util.computeConv2DInfo(a.shape,s.shape,c,f,d,p,!1,x),y=[],v=null!=u,w=null!=l,k="leakyrelu"===m,C=()=>{let e=[a,s],t=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){let t=H({inputs:{x:e},backend:r,attrs:{shape:[e.shape[0],1,1]}});return y.push(t),t}return e};if(v&&e.push(t(u,h)),w&&e.push(t(l,h)),k){let t=r.makeTensorInfo([],"float32",o.util.createScalarValue(g,"float32"));e.push(t),y.push(t)}return e};if(1===b.filterHeight&&1===b.filterWidth&&1===b.dilationHeight&&1===b.dilationWidth&&1===b.strideHeight&&1===b.strideWidth&&("SAME"===b.padInfo.type||"VALID"===b.padInfo.type))t=tw({x:a,filter:s,convInfo:b,backend:r,bias:u,activation:m,preluActivationWeights:l,leakyreluAlpha:g});else if(b.strideWidth<=2&&"channelsLast"===x&&(0,o.env)().getBool("WEBGL_EXP_CONV")){let e=new tx(b,v,m?P(m,!0):null,w,k),n=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],i=C();t=r.runWebGLProgram(e,i,"float32",n)}else if((0,o.env)().getBool("WEBGL_CONV_IM2COL"))t=tk({x:a,filter:s,convInfo:b,backend:r,bias:u,activation:m,preluActivationWeights:l,leakyreluAlpha:g});else{let e=new tm(b,v,m?P(m,!1):null,w,k),n=C();t=r.runWebGLProgram(e,n,"float32")}let I=H({inputs:{x:t},backend:r,attrs:{shape:b.outShape}});return y.push(t),y.forEach(e=>r.disposeIntermediateTensorInfo(e)),I}},nR={kernelName:o.FusedDepthwiseConv2D,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t;let{inputs:n,backend:r,attrs:i}=e,{x:a,filter:s,bias:u,preluActivationWeights:l}=n,{strides:c,pad:d,dilations:h,dimRoundingMode:f,activation:p,leakyreluAlpha:m}=i,g=[],x=h;null==x&&(x=[1,1]),o.util.assert(o.backend_util.eitherStridesOrDilationsAreOne(c,x),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${c} and dilations '${x}'`);let b=o.backend_util.computeConv2DInfo(a.shape,s.shape,c,x,d,f,!0),y=(0,o.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&b.strideWidth<=2&&b.outChannels/b.inChannels==1,v=p?P(p,y):null,w=[a,s],k=null!=u,C=null!=l,I="leakyrelu"===p;if(k&&w.push(u),C&&w.push(l),I){let e=r.makeTensorInfo([],"float32",o.util.createScalarValue(m,"float32"));w.push(e),g.push(e)}t=y?new tY(b,k,v,C,I):new tj(b,k,v,C,I);let $=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],S=r.runWebGLProgram(t,w,"float32",$);return g.forEach(e=>r.disposeIntermediateTensorInfo(e)),S}};class nA{constructor(e,t,n,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;let i=(0,y.kW)(n.length),a=`
    int index;`;for(let e=0;e<this.sliceDim;e++)a+=`
          index = round(getIndices(coords[0], ${e}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[e]};
          flattenIndex += index * ${this.strides[e]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${a}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}let nF={kernelName:o.GatherNd,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n}=e,{params:r,indices:i}=t,a=i.shape,s=a[a.length-1],u=o.util.sizeFromShape(r.shape),[l,c,d,h]=o.backend_util.prepareAndValidate(r,i),f=H({inputs:{x:i},backend:n,attrs:{shape:[c,s]}}),p=H({inputs:{x:r},backend:n,attrs:{shape:[o.util.sizeFromShape(r.shape)/d,d]}});if(n.shouldExecuteOnCPU([r,i])||"string"===r.dtype){let e=n.readSync(i.dataId),t=n.bufferSync(r),a=(0,W.TD)(e,t,r.dtype,c,s,d,h,r.shape,u);return n.makeTensorInfo(l,r.dtype,a.values)}let m=new nA(s,h,[c,d],r.shape),g=n.runWebGLProgram(m,[p,f],p.dtype),x=H({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),x}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nO{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;let n=(0,y.kW)(this.rank),r=function(e,t){let n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let t=0;t<e.length;t++)2===t?r.push("index"):r.push(`${n[t]}`);return r.join()}(e,0);this.userCode=`
      void main() {
        ${n} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nB(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,indices:a}=t,{axis:s,batchDims:u}=r,l=o.util.parseAxisParam(s,i.shape)[0];if((0,o.env)().get("DEBUG")){let e=n.readSync(a.dataId),t=i.shape[l];for(let n=0;n<e.length;++n){let r=e[n];o.util.assert(r<=t-1&&r>=0,()=>`GatherV2: the index value ${r} is not in [0, ${t-1}]`)}}let c=o.backend_util.segment_util.collectGatherOpShapeInfo(i,a,l,u),d=o.util.sizeFromShape(a.shape),h=[],f=H({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),p=H({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,d/c.batchSize]}});h.push(f),h.push(p);let m=[c.batchSize,c.outerSize,d/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([i,a])||"string"===i.dtype){let e=n.bufferSync(p),t=n.bufferSync(f),r=(0,W.m$)(t,e,m);return h.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(c.outputShape,r.dtype,r.values)}let g=new nO(f.shape,m),x=n.runWebGLProgram(g,[f,p],f.dtype);h.push(x);let b=H({inputs:{x:x},backend:n,attrs:{shape:c.outputShape}});return h.forEach(e=>n.disposeIntermediateTensorInfo(e)),b}let nD={kernelName:o.GatherV2,backendName:"webgl",kernelFunc:nB},nP=D({opSnippet:"return float(a > b);",packedOpSnippet:`
  return vec4(greaterThan(a, b));
`,cpuKernelImpl:W.B_,dtype:"bool"}),nM={kernelName:o.Greater,backendName:"webgl",kernelFunc:nP},nV=D({opSnippet:"return float(a >= b);",packedOpSnippet:`
  return vec4(greaterThanEqual(a, b));
`,dtype:"bool",cpuKernelImpl:W.ji}),nL={kernelName:o.GreaterEqual,backendName:"webgl",kernelFunc:nV},nW={kernelName:o.IFFT,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n}=e,{input:r}=t;return nf(r,!0,n)}},nG=B({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),nU={kernelName:o.IsFinite,backendName:"webgl",kernelFunc:nG},nz=B({opSnippet:"return float(isinf(x));",dtype:"bool"}),nX={kernelName:o.IsInf,backendName:"webgl",kernelFunc:nz},nH=B({opSnippet:"return float(isnan(x));",dtype:"bool"}),nK={kernelName:o.IsNan,backendName:"webgl",kernelFunc:nH},nq=D({opSnippet:"return float(a < b);",packedOpSnippet:`
  return vec4(lessThan(a, b));
`,cpuKernelImpl:W.kY,dtype:"bool"}),nj={kernelName:o.Less,backendName:"webgl",kernelFunc:nq},nY=D({opSnippet:"return float(a <= b);",packedOpSnippet:`
  return vec4(lessThanEqual(a, b));
`,cpuKernelImpl:W.Rn,dtype:"bool"}),nQ={kernelName:o.LessEqual,backendName:"webgl",kernelFunc:nY},nZ={kernelName:o.LinSpace,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{backend:t,attrs:n}=e,{start:r,stop:i,num:a}=n,o=(0,W.PQ)(r,i,a);return t.makeTensorInfo([o.length],"float32",o)}},nJ=B({opSnippet:O+`
  return x < 0.0 ? 0./0. : log(x);
`,packedOpSnippet:`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,cpuKernelImpl:W.Sd}),n0={kernelName:o.Log,backendName:"webgl",kernelFunc:nJ},n1=B({opSnippet:O+`
  return log(1.0 + x);
`}),n2={kernelName:o.Log1p,backendName:"webgl",kernelFunc:n1},n3=D({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,dtype:"bool"}),n4={kernelName:o.LogicalAnd,backendName:"webgl",kernelFunc:n3},n5=B({opSnippet:"return float(!(x >= 1.0));"}),n8={kernelName:o.LogicalNot,backendName:"webgl",kernelFunc:n5},n9=D({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,dtype:"bool"}),n6={kernelName:o.LogicalOr,backendName:"webgl",kernelFunc:n9};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n7{constructor(e,t,n,r,i){let a;this.variableNames=["x"],this.outputShape=[];let o=e[3]-1;this.outputShape=e;let s=`float(${n}) + float(${r}) * sum`;a=.5===i?`inversesqrt(${s})`:1===i?`1.0/(${s})`:`exp(log(${s}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${t}; j <= ${t}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${a};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class re{constructor(e,t,n,r,i){let a;this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let o=e[3]-1;this.outputShape=e;let s=`float(${n}) + float(${r}) * sum`;a=.5===i?`inversesqrt(${s})`:1===i?`1.0/(${s})`:`exp(log(${s}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${t};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${t}; j <= ${t}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${a};
        setOutput(result);
      }
    `}}let rt={kernelName:o.LRN,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:a,bias:s,alpha:u,beta:l}=r,c=(0,o.env)().getBool("WEBGL_PACK_NORMALIZATION")?new re(i.shape,a,s,u,l):new n7(i.shape,a,s,u,l);return n.runWebGLProgram(c,[i],i.dtype)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rn{constructor(e,t,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${n});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}let rr={kernelName:o.LRNGrad,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i,y:a,dy:o}=t,{depthRadius:s,bias:u,alpha:l,beta:c}=r,d=new rn(i.shape,s,u,l,c);return n.runWebGLProgram(d,[i,a,o],i.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ri(e){let t;let{inputs:n,backend:r,attrs:i}=e,{x:a}=n,{reductionIndices:s,keepDims:u}=i,l=a.shape.length,c=o.util.parseAxisParam(s,a.shape),d=c,h=o.backend_util.getAxesPermutation(d,l),f=null!=h,p=r.shouldExecuteOnCPU([a]),m=a;if(f){if(p){let e=r.texData.get(m.dataId).values,t=Array(l);for(let e=0;e<t.length;e++)t[e]=a.shape[h[e]];let n=(0,W.Fv)(e,a.shape,a.dtype,h,t);m=r.makeTensorInfo(t,a.dtype),r.texData.get(m.dataId).values=n}else m=J(a,h,r);d=o.backend_util.getInnerMostAxes(d.length,l)}o.backend_util.assertAxesAreInnerMostDims("max",d,l);let[g,x]=o.backend_util.computeOutAndReduceShapes(m.shape,d),b=g;if(u&&(b=o.backend_util.expandShapeToKeepDim(g,c)),p){let e=r.texData.get(m.dataId).values,n=(0,W.$O)(e,o.util.sizeFromShape(x),b,a.dtype);t=r.makeTensorInfo(b,a.dtype),r.texData.get(t.dataId).values=n}else t=/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r){let i=o.util.sizeFromShape(t),a=o.util.sizeFromShape(e.shape),s=H({inputs:{x:e},attrs:{shape:[a/i,i]},backend:r}),u=Y(s,e.dtype,"max",r),l=H({inputs:{x:u},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),l}(m,x,b,r);return f&&r.disposeIntermediateTensorInfo(m),t}let ra={kernelName:o.Max,backendName:"webgl",kernelFunc:ri},ro=D({opSnippet:g+`
  return max(a, b);
`,packedOpSnippet:`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+v+`
  return result;
`,cpuKernelImpl:W.nL}),rs={kernelName:o.Maximum,backendName:"webgl",kernelFunc:ro},ru={kernelName:o.MaxPool,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;(0,c.assertNotComplex)(i,"maxPool");let{filterSize:a,strides:s,pad:u,dimRoundingMode:l}=r;o.util.assert(o.backend_util.eitherStridesOrDilationsAreOne(s,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '1'`);let d=o.backend_util.computePool2DInfo(i.shape,a,s,1,u,l);if(1===d.filterWidth&&1===d.filterHeight&&o.util.arraysEqual(d.inShape,d.outShape))return k({inputs:{x:i},backend:n});let h=new eB(d,"max",!1);return n.runWebGLProgram(h,[i],i.dtype)}},rl={kernelName:o.MaxPool3D,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:s,pad:u,dataFormat:l,dimRoundingMode:c}=r,d=new eD(o.backend_util.computePool3DInfo(i.shape,a,s,[1,1,1],u,c,l),"max",!1);return n.runWebGLProgram(d,[i],i.dtype)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rc{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,a=e.effectiveFilterWidth,o=i-1-e.padInfo.top,s=a-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${a}; wC++) {
            float dyC = float(dyCCorner + wC) / ${n}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${i*a-1} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${a} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class rd{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.front,d=u-1-e.padInfo.top,h=l-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${c}, ${d}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${s};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${a}) {
            float dyR = float(dyRCorner + wR) / ${n}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${l};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${s*u*l-1} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${l} +
                  wR * ${l} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}let rh={kernelName:o.MaxPool3DGrad,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,{filterSize:s,strides:u,pad:l,dimRoundingMode:c}=r,d=o.backend_util.computePool3DInfo(a.shape,s,u,[1,1,1],l,c),h=new eD(d,"max",!0),f=n.runWebGLProgram(h,[a],a.dtype),p=new rd(d),m=n.runWebGLProgram(p,[i,f],a.dtype);return n.disposeIntermediateTensorInfo(f),m}},rf={kernelName:o.MaxPoolGrad,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a,output:s}=t;(0,c.assertNotComplex)([a,s],"maxPoolGrad");let{filterSize:u,strides:l,pad:d,dimRoundingMode:h}=r,f=o.backend_util.computePool2DInfo(a.shape,u,l,1,d,h),p=new eB(f,"max",!0),m=n.runWebGLProgram(p,[a],a.dtype),g=new rc(f),x=n.runWebGLProgram(g,[i,m],a.dtype);return n.disposeIntermediateTensorInfo(m),x}},rp={kernelName:o.MaxPoolWithArgmax,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{filterSize:i,strides:a,pad:s,includeBatchInIndex:u}=t;o.util.assert(4===r.shape.length,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);let l=[1,1];o.util.assert(o.backend_util.eitherStridesOrDilationsAreOne(a,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${l}'`);let c=o.backend_util.computePool2DInfo(r.shape,i,a,l,s),[d,h]=/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r){let i=new eB(n,"max",!1),a=r.runWebGLProgram(i,[e],"float32");return i=new eB(n,"max",!0,!0,t),[a,r.runWebGLProgram(i,[e],"float32")]}(r,u,c,n);return[d,h]}},rm={kernelName:o.Mean,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{keepDims:i,axis:a}=t,s=r.shape.length,u=o.util.parseAxisParam(a,r.shape),l=u,c=o.backend_util.getAxesPermutation(l,s),d=null!=c,h=n.shouldExecuteOnCPU([r]),f=[],p=r;if(d){if(h){let e=n.texData.get(p.dataId).values,t=Array(s);for(let e=0;e<t.length;e++)t[e]=r.shape[c[e]];let i=(0,W.Fv)(e,r.shape,r.dtype,c,t);p=n.makeTensorInfo(t,r.dtype),n.texData.get(p.dataId).values=i}else p=J(r,c,n);f.push(p),l=o.backend_util.getInnerMostAxes(l.length,s)}o.backend_util.assertAxesAreInnerMostDims("sum",l,s);let[m,g]=o.backend_util.computeOutAndReduceShapes(p.shape,l),x=m;i&&(x=o.backend_util.expandShapeToKeepDim(m,u));let b=/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r){let i=o.util.sizeFromShape(t),a=o.util.sizeFromShape(e.shape),s=H({inputs:{x:e},attrs:{shape:[a/i,i]},backend:r}),u=Y(s,"float32","mean",r),l=H({inputs:{x:u},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),l}(p,g,x,n);for(let e of f)n.disposeIntermediateTensorInfo(e);return b}},rg={kernelName:o.Min,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t;let{inputs:n,backend:r,attrs:i}=e,{x:a}=n,{axis:s,keepDims:u}=i,l=a.shape.length,c=o.util.parseAxisParam(s,a.shape),d=c,h=o.backend_util.getAxesPermutation(d,l),f=a;null!=h&&(f=en({inputs:{x:a},backend:r,attrs:{perm:h}}),d=o.backend_util.getInnerMostAxes(d.length,a.shape.length)),o.backend_util.assertAxesAreInnerMostDims("min",d,l);let[p,m]=o.backend_util.computeOutAndReduceShapes(f.shape,d),g=H({inputs:{x:f},backend:r,attrs:{shape:[-1,o.util.sizeFromShape(m)]}}),x=Y(g,g.dtype,"min",r);return t=u?H({inputs:{x:x},backend:r,attrs:{shape:o.backend_util.expandShapeToKeepDim(p,c)}}):H({inputs:{x:x},backend:r,attrs:{shape:p}}),r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(x),null!=h&&r.disposeIntermediateTensorInfo(f),t}},rx=D({opSnippet:g+`
  return min(a, b);
`,packedOpSnippet:`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+v+`
  return result;
`,cpuKernelImpl:W.r}),rb={kernelName:o.Minimum,backendName:"webgl",kernelFunc:rx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ry{constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let r=e.length,i=(0,y.kW)(r),a=t.map(e=>e[0]).join(","),o=t.map((t,n)=>t[0]+e[n]).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),u="reflect"===n?0:1;if(1===r){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${a});
      ${i} end = ${i}(${o});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${s}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rv{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let r=e.length,i=(0,y.kW)(r),a=t.map(e=>e[0]).join(","),o=t.map((t,n)=>t[0]+e[n]).join(","),s=(0,b.Ky)("rc",r),u=(0,b.Ky)("source",r),l=`${s[r-1]} < ${this.outputShape[r-1]}`,c=1===r?"source":`vec2(${u.slice(-2).join()})`,d="reflect"===n?0:1,h="";if(1===r){let e=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;h=`
        ${i} rc = outputLoc;
        ${e}
        result[0] = getChannel(getX(${u.join()}), ${c});
        ${s[r-1]} += 1;
        if(${l}) {
          ${e}
          result[1] = getChannel(getX(${u.join()}), ${c});
        }
      `}else{let e=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;h=`
        ${i} rc = outputLoc;
        ${e}
        result[0] = getChannel(getX(${u.join()}), ${c});
        ${s[r-1]} += 1;
        if(${l}) {
          ${e}
          result[1] = getChannel(getX(${u.join()}), ${c});
        }
        rc = outputLoc;
        ${s[r-2]} += 1;
        if(${s[r-2]} < ${this.outputShape[r-2]}) {
          ${e}
          result[2] = getChannel(getX(${u.join()}), ${c});
          ${s[r-1]} += 1;
          if(${l}) {
            ${e}
            result[3] = getChannel(getX(${u.join()}), ${c});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${a});
      const ${i} end = ${i}(${o});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}}let rw={kernelName:o.MirrorPad,backendName:"webgl",kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r}=e,{paddings:i,mode:a}=n,s=(0,o.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rv(r.shape,i,a):new ry(r.shape,i,a);return t.runWebGLProgram(s,[r],r.dtype)}},rk=D({opSnippet:`if (b == 0.0) return NAN;
  return mod(a, b);`,packedOpSnippet:`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+v+`
  return result;
`}),rC={kernelName:o.Mod,backendName:"webgl",kernelFunc:rk};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rI{constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}let r$=D({opSnippet:`
if (a == b) {
  return 1.0;
};
return a / b;`,packedOpSnippet:`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,checkOutOfBounds:!0}),rS={kernelName:o.RealDiv,backendName:"webgl",kernelFunc:r$},rE="return a - b;",r_=D({opSnippet:rE,packedOpSnippet:rE,supportsComplex:!0,cpuKernelImpl:W.kI}),rT={kernelName:o.Sub,backendName:"webgl",kernelFunc:r_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rN(e){let{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:a}=r,s=o.util.parseAxisParam([a],i.shape),u=ri({inputs:{x:i},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),l=o.backend_util.expandShapeToKeepDim(u.shape,s),c=H({inputs:{x:u},backend:n,attrs:{shape:l}}),d=r_({inputs:{a:i,b:c},backend:n}),h=na({inputs:{x:d},backend:n}),f=ee({inputs:{x:h},backend:n,attrs:{axis:s,keepDims:!1}}),p=H({inputs:{x:f},backend:n,attrs:{shape:l}}),m=r$({inputs:{a:h,b:p},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}let rR={kernelName:o.Softmax,backendName:"webgl",kernelFunc:rN},rA={kernelName:o.Multinomial,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:a,seed:o,normalized:s}=r,u=s?i:rN({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),l=new rI(u.shape[0],u.shape[1],a),c=n.runWebGLProgram(l,[u],"int32",[[o]]);return s||n.disposeIntermediateTensorInfo(u),c}},rF=A.D1+`
  return -x;
`,rO=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,rB={kernelName:o.Neg,backendName:"webgl",kernelFunc:function(e){let t;let{inputs:n,backend:r}=e,{x:i}=n;if(r.shouldExecuteOnCPU([i])){let e=r.texData.get(i.dataId),[t,n]=(0,W.Bo)(e.values,i.shape,i.dtype);return r.makeTensorInfo(n,i.dtype,t)}return t=(0,o.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new F.cc(i.shape,rO):new A.l(i.shape,rF),r.runWebGLProgram(t,[i],i.dtype)}},rD=o.kernel_impls.nonMaxSuppressionV3Impl,rP={kernelName:o.NonMaxSuppressionV3,backendName:"webgl",kernelFunc:function(e){o.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:s,iouThreshold:u,scoreThreshold:l}=r,{selectedIndices:c}=rD(n.readSync(i.dataId),n.readSync(a.dataId),s,u,l);return n.makeTensorInfo([c.length],"int32",new Int32Array(c))}},rM=o.kernel_impls.nonMaxSuppressionV4Impl,rV={kernelName:o.NonMaxSuppressionV4,backendName:"webgl",kernelFunc:function(e){o.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:s,iouThreshold:u,scoreThreshold:l,padToMaxOutputSize:c}=r,{selectedIndices:d,validOutputs:h}=rM(n.readSync(i.dataId),n.readSync(a.dataId),s,u,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}},rL=o.kernel_impls.nonMaxSuppressionV5Impl,rW={kernelName:o.NonMaxSuppressionV5,backendName:"webgl",kernelFunc:function(e){o.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:s,iouThreshold:u,scoreThreshold:l,softNmsSigma:c}=r,{selectedIndices:d,selectedScores:h}=rL(n.readSync(i.dataId),n.readSync(a.dataId),s,u,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([h.length],"float32",new Float32Array(h))]}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rG{constructor(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${n}),
                      float(index == coords.y)));
      }
    `}}let rU={kernelName:o.OneHot,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:a,depth:s,onValue:u,offValue:l}=r,c=o.util.sizeFromShape(i.shape),d=new rG(c,s,u,l),h=H({inputs:{x:i},backend:n,attrs:{shape:[c]}}),f=n.runWebGLProgram(d,[h],a);n.disposeIntermediateTensorInfo(h);let p=H({inputs:{x:f},backend:n,attrs:{shape:[...i.shape,s]}});return n.disposeIntermediateTensorInfo(f),p}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rz(e){let{inputs:t,backend:n}=e,{x:r}=t;if("complex64"!==r.dtype)return ng({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n});{let e=e8({inputs:{input:r},backend:n}),t=rz({inputs:{x:e},backend:n}),i=td({inputs:{input:r},backend:n}),a=rz({inputs:{x:i},backend:n}),o=I({inputs:{real:t,imag:a},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),o}}let rX={kernelName:o.ZerosLike,backendName:"webgl",kernelFunc:rz},rH={kernelName:o.OnesLike,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e(t){let{inputs:n,backend:r}=t,{x:i}=n;if("string"===i.dtype)throw Error("onesLike is not supported under string dtype");if("complex64"!==i.dtype)return ng({attrs:{shape:i.shape,dtype:i.dtype,value:1},backend:r});{let t=e8({inputs:{input:i},backend:r}),n=e({inputs:{x:t},backend:r}),a=td({inputs:{input:i},backend:r}),o=rz({inputs:{x:a},backend:r}),s=I({inputs:{real:n,imag:o},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(o),s}}},rK={kernelName:o.Pack,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(1===t.length)return ns({inputs:{input:t[0]},backend:n,attrs:{dim:i}});let a=t[0].shape,s=t[0].dtype;t.forEach(e=>{o.util.assertShapesMatch(a,e.shape,"All tensors passed to stack must have matching shapes"),o.util.assert(s===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});let u=[],l=tf({inputs:t.map(e=>{let t=ns({inputs:{input:e},backend:n,attrs:{dim:i}});return u.push(t),t}),backend:n,attrs:{axis:i}});return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),l}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rq{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let r=e.length,i=(0,y.kW)(r),a=t.map(e=>e[0]).join(","),o=t.map((t,n)=>t[0]+e[n]).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(1===r){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${a});
      ${i} end = ${i}(${o});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${s}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rj{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let r=e.length,i=(0,y.kW)(r),a=t.map(e=>e[0]).join(","),o=t.map((t,n)=>t[0]+e[n]).join(","),s=(0,b.Ky)("rc",r),u=(0,b.Ky)("source",r),l=`${s[r-1]} < ${this.outputShape[r-1]}`,c=1===r?"source":`vec2(${u.slice(-2).join()})`,d=[`${i} rc = outputLoc;`,`${s[r-1]} += 1;
       if(${l}) {
      `,1===r?"":`}
       rc = outputLoc;
       ${s[r-2]} += 1;
       if(${s[r-2]} < ${this.outputShape[r-2]}) {`,1===r?"":`  ${s[r-1]} += 1;
         if(${l}) {`],h=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="";for(let e=0,t=1===r?2:4;e<t;e++)f+=`
        ${d[e]}
        if (${h}) {
          result[${e}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${e}] = getChannel(getX(${u.join()}), ${c});
        }
      `;f+=1===r?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${a});
      const ${i} end = ${i}(${o});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let rY=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:a,constantValue:s}=r;if(0===o.util.sizeFromShape(i.shape))return ng({backend:n,attrs:{shape:a.map((e,t)=>e[0]+i.shape[t]+e[1]),value:s,dtype:i.dtype}});let u=(0,o.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rj(i.shape,a,s):new rq(i.shape,a,s),l=[[s]];return n.runWebGLProgram(u,[i],i.dtype,l)},rQ={kernelName:o.PadV2,backendName:"webgl",kernelFunc:rY},rZ=D({opSnippet:`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,packedOpSnippet:`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+v+`
  return result;
`}),rJ={kernelName:o.Pow,backendName:"webgl",kernelFunc:rZ},r0={kernelName:o.Prod,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t;let{inputs:n,backend:r,attrs:i}=e,{x:a}=n,{axis:s,keepDims:u}=i,l=a.shape.length,c=[],d=o.util.parseAxisParam(s,a.shape),h=d,f=o.backend_util.getAxesPermutation(h,l),p=a;if(null!=f&&(p=en({inputs:{x:a},backend:r,attrs:{perm:f}}),h=o.backend_util.getInnerMostAxes(h.length,l),c.push(p)),o.backend_util.assertAxesAreInnerMostDims("prod",h,l),r.shouldExecuteOnCPU([p])){let e=r.texData.get(p.dataId).values,{outVals:n,outShape:i,outDtype:a}=(0,W.Tg)(p.shape,p.dtype,e,h);t=r.makeTensorInfo(i,a,n)}else{let[e,n]=o.backend_util.computeOutAndReduceShapes(p.shape,h),i=H({inputs:{x:p},backend:r,attrs:{shape:[-1,o.util.sizeFromShape(n)]}}),s=Y(i,(0,o.sumOutType)(a.dtype),"prod",r);t=H({inputs:{x:s},backend:r,attrs:{shape:e}}),c.push(i),c.push(s)}if(u){c.push(t);let e=o.backend_util.expandShapeToKeepDim(t.shape,d);t=H({inputs:{x:t},backend:r,attrs:{shape:e}})}return c.forEach(e=>r.disposeIntermediateTensorInfo(e)),t}},r1={kernelName:o.RaggedGather,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:a,indices:o}=t,{outputRaggedRank:s}=r,u=i.map(e=>n.readSync(e.dataId)),l=i.map(e=>e.shape),c=n.readSync(a.dataId),d=n.readSync(o.dataId),[h,f,p]=(0,W.Qs)(u,l,c,a.shape,a.dtype,d,o.shape,s),m=h.map(e=>n.makeTensorInfo([e.length],"int32",e)),g=n.makeTensorInfo(p,a.dtype,f);return m.concat([g])}},r2={kernelName:o.RaggedRange,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:a}=t,o=n.readSync(r.dataId),s=n.readSync(i.dataId),u=n.readSync(a.dataId),[l,c]=(0,W.M8)(o,r.shape,r.dtype,s,i.shape,u,a.shape);return[n.makeTensorInfo([l.length],"int32",l),n.makeTensorInfo([c.length],r.dtype,c)]}},r3={kernelName:o.RaggedTensorToTensor,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{shape:i,values:a,defaultValue:o,rowPartitionTensors:s}=t,{rowPartitionTypes:u}=r,l=n.readSync(i.dataId),c=n.readSync(a.dataId),d=n.readSync(o.dataId),h=s.map(e=>n.readSync(e.dataId)),f=s.map(e=>e.shape),[p,m]=(0,W.fy)(l,i.shape,c,a.shape,a.dtype,d,o.shape,h,f,u);return n.makeTensorInfo(p,a.dtype,m)}},r4=e=>{let{backend:t,attrs:n}=e,{start:r,stop:i,step:a,dtype:o}=n,s=(0,W.hO)(r,i,a,o);return t.makeTensorInfo([s.length],o,s)},r5={kernelName:o.Range,backendName:"webgl",kernelFunc:r4},r8=B({opSnippet:"return 1.0 / x;"}),r9={kernelName:o.Reciprocal,backendName:"webgl",kernelFunc:r8},r6=B({opSnippet:A.D1+`
  return (x < 0.0) ? 0.0 : x;
`,packedOpSnippet:`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`}),r7={kernelName:o.Relu,backendName:"webgl",kernelFunc:r6},ie=B({opSnippet:A.D1+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,packedOpSnippet:`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`}),it={kernelName:o.Relu6,backendName:"webgl",kernelFunc:ie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ir{constructor(e,t,n,r,i){let a;this.variableNames=["A"],this.outputShape=[];let[o,s,u,l]=e;this.outputShape=[o,t,n,l];let c=[r&&t>1?s-1:s,r&&n>1?u-1:u],d=[r&&t>1?t-1:t,r&&n>1?n-1:n];a=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${s}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${a};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ii{constructor(e,t,n,r,i){let a;this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[o,s,u,l]=e;this.outputShape=[o,t,n,l];let c=[r&&t>1?s-1:s,r&&n>1?u-1:u],d=[r&&t>1?t-1:t,r&&n>1?n-1:n];a=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${s}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${a};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${n-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}let ia={kernelName:o.ResizeBilinear,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:a,halfPixelCenters:s,size:u}=r,[l,c]=u,d=(0,o.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new ii(i.shape,l,c,a,s):new ir(i.shape,l,c,a,s);return n.runWebGLProgram(d,[i],"float32")}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class io{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,r,i]=t,[,a,o]=e,s=[n&&a>1?r-1:r,n&&o>1?i-1:i],u=[n&&a>1?a-1:a,n&&o>1?o-1:o],l=s[0]/u[0],c=s[1]/u[1],d=1/l,h=1/c,f=2*Math.ceil(d)+2,p=2*Math.ceil(h)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${l});
        const float widthScale = float(${c});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${h});

        const int winHeight = int(${f});
        const int winWidth = int(${p});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}let is={kernelName:o.ResizeBilinearGrad,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:o}=r,s=new io(a.shape,i.shape,o);return n.runWebGLProgram(s,[a],a.dtype)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iu{constructor(e,t,n,r,i){let a;this.variableNames=["A"],this.outputShape=[];let[o,s,u,l]=e;this.outputShape=[o,t,n,l];let c=[r&&t>1?s-1:s,r&&n>1?u-1:u],d=[r&&t>1?t-1:t,r&&n>1?n-1:n];a=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${s}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${a};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${r?"0.5":"0.0"})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class il{constructor(e,t,n,r,i){let a;this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[o,s,u,l]=e;this.outputShape=[o,t,n,l];let c=[r&&t>1?s-1:s,r&&n>1?u-1:u],d=[r&&t>1?t-1:t,r&&n>1?n-1:n];a=i?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${s}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${a};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${r?"0.5":"0.0"})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${n-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}let ic={kernelName:o.ResizeNearestNeighbor,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:a,halfPixelCenters:s,size:u}=r,[l,c]=u,d=(0,o.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new il(i.shape,l,c,a,s):new iu(i.shape,l,c,a,s);return n.runWebGLProgram(d,[i],i.dtype)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class id{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;let[,r,i]=t,[,a,o]=e,s=[n&&a>1?r-1:r,n&&o>1?i-1:i],u=[n&&a>1?a-1:a,n&&o>1?o-1:o],l=s[0]/u[0],c=s[1]/u[1],d=1/l,h=1/c,f=2*Math.ceil(d)+2,p=2*Math.ceil(h)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${l});
        const float widthScale = float(${c});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${h});

        const int winHeight = int(${f});
        const int winWidth = int(${p});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${s[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${s[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${n} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${n} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}let ih={kernelName:o.ResizeNearestNeighborGrad,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:o}=r,s=new id(a.shape,i.shape,o);return n.runWebGLProgram(s,[a],a.dtype)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ip{constructor(e,t){this.variableNames=["x"];let n=e.length;if(n>4)throw Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=e,1===n){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}let r=n=>-1!==t.indexOf(n)&&1!==e[n]?`${e[n]} - coords[${n}] - 1`:`coords[${n}]`,i=e.map((e,t)=>r(t)).join(","),a=(0,y.kW)(n);this.userCode=`
      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class im{constructor(e,t){var n,r,i;this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let a=e.length;if(a>4)throw Error(`WebGL backend: Reverse of rank-${a} tensor is not yet supported`);this.outputShape=e;let o=(0,b.Ky)("rc",a),s=`${o[a-1]} + 1 < ${this.outputShape[a-1]}`,u=`${o[a-2]} + 1 < ${this.outputShape[a-2]}`,l=(0,y.kW)(a);function c(n){let r=e.map((r,i)=>-1!==t.indexOf(i)&&1!==e[i]?`${e[i]} - ${n[i]} - 1`:`${n[i]}`),i=r.join(","),a=r.slice(-2).join(",");return`getChannel(getX(${i}), vec2(${a}))`}1===a?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${s}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${l} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${c(o.slice())};
          if(${s}){
            result.g = ${(n=o.slice())[a-1]="("+n[a-1]+" + 1)",c(n)};
          }
          if(${u}) {
            result.b = ${(r=o.slice())[a-2]="("+r[a-2]+" + 1)",c(r)};
            if(${s}) {
              result.a = ${(i=o.slice())[a-1]="("+i[a-1]+" + 1)",i[a-2]="("+i[a-2]+" + 1)",c(i)};
            }
          }
          setOutput(result);
        }
    `}}let ig={kernelName:o.Reverse,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:a}=r,s=i.shape.length,u=o.util.parseAxisParam(a,i.shape);if(0===s)return k({inputs:{x:i},backend:n});let l=(0,o.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new im(i.shape,u):new ip(i.shape,u);return n.runWebGLProgram(l,[i],i.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ix{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let n=e[1],r=e[2];this.outputShape=e;let i="";i="number"==typeof t?`float outputValue = ${t.toFixed(2)};`:`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${n}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ib={kernelName:o.RotateWithOffset,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,{radians:i,fillValue:a,center:s}=t,u=new ix(r.shape,a),[l,c]=o.backend_util.getImageCenter(s,r.shape[1],r.shape[2]);return n.runWebGLProgram(u,[r],r.dtype,[[l,c,Math.sin(i),Math.cos(i)]])}},iy=B({opSnippet:`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`}),iv={kernelName:o.Round,backendName:"webgl",kernelFunc:iy},iw=B({opSnippet:"return inversesqrt(x);",cpuKernelImpl:W.St}),ik={kernelName:o.Rsqrt,backendName:"webgl",kernelFunc:iw};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iC{constructor(e,t,n,r,i,a,o=!0,s=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;let u=(0,y.kW)(i.length),l=(0,y.kW)(a.length),c="";1===n?c="i":2===n&&(c="i, j");let d=`getIndices(${c})`,h="";1===r?h="i":2===r&&(h="i, coords[1]");let f=`getUpdates(${h})`,p="";s&&(p="coords[0], coords[1]");let m=`getDefaultValue(${p})`;this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${l} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${t>1?"strides[j]":"strides"};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(${m}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iI{constructor(e,t,n,r,i,a,o=!0,s=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=a;let u=(0,y.kW)(i.length),l=(0,y.kW)(a.length),c="";1===n?c="i":2===n&&(c="i, j");let d=`getIndices(${c})`,h="";1===r?h="i":2===r&&(h="i, coords[1]");let f=`getUpdates(${h})`,p="";s&&(p="coords[0], coords[1]");let m=`getDefaultValue(${p})`;this.userCode=`
        ${u} strides = ${u}(${i});

        void main() {
          ${l} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${t>1?"strides[j]":"strides"};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${t>1?"strides[j + 1]":"strides"};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${f};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${m}, sum, found));
        }
      `}}let i$={kernelName:o.ScatterNd,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t;let{inputs:n,backend:r,attrs:i}=e,{indices:a,updates:s}=n,{shape:u}=i,{sliceRank:l,numUpdates:c,sliceSize:d,strides:h,outputSize:f}=o.backend_util.calculateShapes(s,a,u),p=[f/d,d];if(0===f)return r.makeTensorInfo(u,a.dtype);let m=H({inputs:{x:a},backend:r,attrs:{shape:[c,l]}}),g=H({inputs:{x:s},backend:r,attrs:{shape:[c,d]}}),x=r.makeTensorInfo([],"float32",new Float32Array([0]));t=(0,o.env)().getBool("WEBGL_PACK")?new iI(c,l,m.shape.length,g.shape.length,h,p):new iC(c,l,m.shape.length,g.shape.length,h,p);let b=r.runWebGLProgram(t,[g,m,x],g.dtype),y=H({inputs:{x:b},backend:r,attrs:{shape:u}});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(x),y}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iS{constructor(e,t,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];let i=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,a=2===(0,o.env)().getNumber("WEBGL_VERSION")?"while (left < right) {":i;this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${"left"===r?"<":"<="} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}let iE={kernelName:o.SearchSorted,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:a}=t,{side:o}=r,s=new iS(i.shape[0],i.shape[1],a.shape[1],o),u=[[i.shape[1]]];return n.runWebGLProgram(s,[i,a],"int32",u)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i_{constructor(e,t,n){let r,i;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error(`Where for rank ${n} is not yet supported`);if(1===n)i="resRC",r="resRC";else{let n=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],o=[];for(let r=0;r<t.length;r++)o.push(`${n[r]}`),r<e&&a.push(`${n[r]}`);r=a.join(),i=o.join()}let a=(0,y.kW)(n);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}let iT={kernelName:o.Select,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n}=e,{condition:r,t:i,e:a}=t,s=new i_(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(s,[r,i,a],(0,o.upcastType)(i.dtype,a.dtype))}},iN=B({opSnippet:`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${o.backend_util.SELU_SCALEALPHA};
  float scale = ${o.backend_util.SELU_SCALE};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`}),iR={kernelName:o.Selu,backendName:"webgl",kernelFunc:iN},iA=B({opSnippet:O+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,packedOpSnippet:`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cpuKernelImpl:W.UN}),iF={kernelName:o.Sigmoid,backendName:"webgl",kernelFunc:iA},iO=B({opSnippet:`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`}),iB={kernelName:o.Sign,backendName:"webgl",kernelFunc:iO},iD=B({opSnippet:O+`
  return sin(x);
`,packedOpSnippet:`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${v}
  return result;
`}),iP={kernelName:o.Sin,backendName:"webgl",kernelFunc:iD},iM=B({opSnippet:`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`}),iV={kernelName:o.Sinh,backendName:"webgl",kernelFunc:iM},iL=B({opSnippet:`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`}),iW={kernelName:o.Softplus,backendName:"webgl",kernelFunc:iL},iG={kernelName:o.SpaceToBatchND,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,paddings:s}=r;o.util.assert(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let u=a.reduce((e,t)=>e*t),l=[[0,0]];l.push(...s);for(let e=1+a.length;e<i.shape.length;++e)l.push([0,0]);let c=[],d=rY({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),h=o.backend_util.getReshaped(d.shape,a,u,!1),f=o.backend_util.getPermuted(h.length,a.length,!1),p=o.backend_util.getReshapedPermuted(d.shape,a,u,!1),m=H({inputs:{x:d},backend:n,attrs:{shape:h}}),g=en({inputs:{x:m},backend:n,attrs:{perm:f}}),x=H({inputs:{x:g},backend:n,attrs:{shape:p}});return c.push(d),c.push(m),c.push(g),c.forEach(e=>n.disposeIntermediateTensorInfo(e)),x}},iU={kernelName:o.SparseFillEmptyRows,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:a,defaultValue:o}=t;if(1!==a.shape.length)throw Error(`Dense shape must be a vector, saw:
         ${a.shape}`);if(2!==r.shape.length)throw Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(1!==i.shape.length)throw Error(`Values must be a vector, saw:
         ${i.shape}`);if(0!==o.shape.length)throw Error(`Default value must be a scalar, saw:
        ${o.shape}`);let s=n.readSync(r.dataId),u=n.readSync(i.dataId),l=n.readSync(a.dataId),c=n.readSync(o.dataId)[0],[d,h,f,p,m]=(0,W.X8)(s,r.shape,r.dtype,u,i.dtype,l,c);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],i.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(e=>Number(e)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}},iz={kernelName:o.SparseReshape,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:a}=t;if(2!==r.shape.length)throw Error(`Input indices should be a matrix but received shape ${r.shape}`);if(1!==i.shape.length)throw Error(`Input shape should be a vector but received shape ${i.shape}`);if(1!==a.shape.length)throw Error(`Target shape should be a vector but received shape ${a.shape}`);let o=Array.from(n.readSync(i.dataId)),s=n.readSync(r.dataId),u=Array.from(n.readSync(a.dataId)),[l,c,d]=(0,W.LS)(s,r.shape,r.dtype,o,u);return[n.makeTensorInfo(c,r.dtype,l),n.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}},iX={kernelName:o.SparseSegmentMean,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:a}=t;if(r.shape.length<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw Error(`Indices should be a vector but received shape
              ${i.shape}`);if(1!==a.shape.length)throw Error(`Segment ids should be a vector but received shape
              ${a.shape}`);let o=n.readSync(r.dataId),s=n.readSync(i.dataId),u=n.readSync(a.dataId),[l,c]=(0,W.AR)(o,r.shape,r.dtype,s,u,!0);return n.makeTensorInfo(c,r.dtype,l)}},iH={kernelName:o.SparseSegmentSum,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:a}=t;if(r.shape.length<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw Error(`Indices should be a vector but received shape
             ${i.shape}`);if(1!==a.shape.length)throw Error(`Segment ids should be a vector but received shape
             ${a.shape}`);let o=n.readSync(r.dataId),s=n.readSync(i.dataId),u=n.readSync(a.dataId),[l,c]=(0,W.AR)(o,r.shape,r.dtype,s,u);return n.makeTensorInfo(c,r.dtype,l)}},iK={kernelName:o.SparseToDense,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:a,defaultValue:s}=t,{outputShape:u}=r,{sliceRank:l,numUpdates:c,sliceSize:d,strides:h,outputSize:f}=o.backend_util.calculateShapes(a,i,u);if("string"===a.dtype){let e=n.bufferSync(i),t=n.bufferSync(a),r=o.util.decodeString(n.readSync(s.dataId)[0]),p=(0,W.Y1)(e,t,u,f,d,c,l,h,r,!1);return n.makeTensorInfo(u,p.dtype,p.values)}let p=new iC(c,l,i.shape.length,a.shape.length,h,[f,1],!1),m=n.runWebGLProgram(p,[a,i,s],a.dtype),g=H({inputs:{x:m},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(m),g}},iq={kernelName:o.SplitV,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:a,axis:s}=r,u=o.util.parseAxisParam(s,i.shape)[0],l=o.backend_util.prepareSplitSize(i,a,u),c=Array(i.shape.length).fill(0),d=i.shape.slice();return l.map(e=>{let t=[...d];t[u]=e;let r=eY({inputs:{x:i},backend:n,attrs:{begin:c,size:t}});return c[u]+=e,r})}},ij="return sqrt(x);",iY=B({opSnippet:ij,packedOpSnippet:ij,cpuKernelImpl:W.Bk}),iQ={kernelName:o.Sqrt,backendName:"webgl",kernelFunc:iY},iZ=B({opSnippet:"return x * x;"}),iJ={kernelName:o.Square,backendName:"webgl",kernelFunc:iZ},i0="return (a - b) * (a - b);",i1=D({opSnippet:i0,packedOpSnippet:i0}),i2={kernelName:o.SquaredDifference,backendName:"webgl",kernelFunc:i1},i3={kernelName:o.StaticRegexReplace,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;if("string"!==i.dtype)throw Error("Input must be of datatype string");let a=n.readSync(i.dataId),s=o.backend_util.fromUint8ToStringArray(a),u=(0,W.F1)(s,"string",r);return n.makeTensorInfo(i.shape,"string",u)}},i4={kernelName:o.Step,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function({inputs:e,attrs:t,backend:n}){let{x:r}=e,i=A.D1+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,a=new A.l(r.shape,i);return n.runWebGLProgram(a,[r],r.dtype)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i5{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;let r=n.length,i=(0,y.kW)(n.length),a=(0,y.kW)(n.length),o="";if(1===r)o="coords * strides + begin";else{let e=0;o=n.map((t,r)=>(e++,1===n.length?`coords * strides[${r}] + begin[${r}]`:`coords[${e-1}] * strides[${r}] + begin[${r}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${t});

      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}let i8={kernelName:o.StridedSlice,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t;let{inputs:n,backend:r,attrs:i}=e,{x:a}=n,{begin:s,end:u,strides:l,beginMask:c,endMask:d,ellipsisMask:h,newAxisMask:f,shrinkAxisMask:p}=i,{finalShapeSparse:m,finalShape:g,isIdentity:x,sliceDim0:b,isSimpleSlice:y,begin:v,end:w,strides:k}=o.slice_util.sliceInfo(a.shape,s,u,l,c,d,h,f,p);if(x)t=H({inputs:{x:a},backend:r,attrs:{shape:g}});else if(b||y){o.util.assert(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);let e=o.slice_util.computeOutShape(v,w,k),n=eY({inputs:{x:a},backend:r,attrs:{begin:v,size:e}});t=H({inputs:{x:n},backend:r,attrs:{shape:g}}),r.disposeIntermediateTensorInfo(n)}else if(r.shouldExecuteOnCPU([a])){let e=r.readSync(a.dataId),n=(0,o.buffer)(a.shape,a.dtype,e),i=(0,W.$u)(m,n,k,v);t=r.makeTensorInfo(g,a.dtype,i.values)}else{let e=new i5(v,k,m);t=r.runWebGLProgram(e,[a],a.dtype)}let C=H({inputs:{x:t},backend:r,attrs:{shape:g}});return r.disposeIntermediateTensorInfo(t),C}},i9={kernelName:o.StringNGrams,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:a,leftPad:o,rightPad:s,padWidth:u,preserveShortSequences:l}=r,{data:c,dataSplits:d}=t,h=n.readSync(c.dataId),f=n.readSync(d.dataId),[p,m]=(0,W.$j)(h,f,i,a,o,s,u,l);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}},i6={kernelName:o.StringSplit,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:a,delimiter:o}=t;if("string"!==a.dtype)throw Error("Input must be of datatype string");if(1!==a.shape.length)throw Error(`Input must be a vector, got shape: ${a.shape}`);if(0!==o.shape.length)throw Error(`Delimiter must be a scalar, got shape: ${o.shape}`);let s=n.readSync(a.dataId),u=n.readSync(o.dataId)[0],[l,c,d]=(0,W.A0)(s,u,i),h=c.length;return[n.makeTensorInfo([h,2],"int32",l),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}},i7={kernelName:o.StringToHashBucketFast,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:a}=t;if("string"!==a.dtype)throw Error("Input must be of datatype string");if(i<=0)throw Error("Number of buckets must be at least 1");let o=n.readSync(a.dataId),s=(0,W._9)(o,i);return n.makeTensorInfo(a.shape,"int32",s)}},ae=B({opSnippet:"return tan(x);"}),at={kernelName:o.Tan,backendName:"webgl",kernelFunc:ae},an=B({opSnippet:`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`}),ar={kernelName:o.Tanh,backendName:"webgl",kernelFunc:an},ai={kernelName:o.TensorScatterUpdate,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{tensor:i,indices:a,updates:s}=t,{}=r,{sliceRank:u,numUpdates:l,sliceSize:c,strides:d,outputSize:h}=o.backend_util.calculateShapes(s,a,i.shape),f=[h/c,c];if(0===h)return n.makeTensorInfo(i.shape,a.dtype);let p=H({inputs:{x:a},backend:n,attrs:{shape:[l,u]}}),m=H({inputs:{x:s},backend:n,attrs:{shape:[l,c]}}),g=H({inputs:{x:i},backend:n,attrs:{shape:f}}),x=new iC(l,u,p.shape.length,m.shape.length,d,f,!1,!0),b=n.runWebGLProgram(x,[m,p,g],g.dtype),y=H({inputs:{x:b},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),y}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aa{constructor(e,t){this.variableNames=["A"];let n=Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;let r=(0,y.kW)(this.rank),i=function(e){let t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(1===t)return`imod(resRC, ${e[0]})`;let n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let t=0;t<e.length;t++)r.push(`imod(${n[t]}, ${e[t]})`);return r.join()}(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ao(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:a}=r;if("string"===i.dtype||i.shape.length>5){let e=n.readSync(i.dataId),t="string"===i.dtype?e.map(e=>o.util.decodeString(e)):e,r=(0,o.buffer)(i.shape,i.dtype,t),s=(0,W.KX)(r,a);return n.makeTensorInfo(s.shape,s.dtype,s.values)}let s=new aa(i.shape,a);return n.runWebGLProgram(s,[i],i.dtype)}let as={kernelName:o.Tile,backendName:"webgl",kernelFunc:ao};class au{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class al{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ac(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function ad(e){let t=1;for(;t<e;)t*=2;return t}let ah={kernelName:o.TopK,backendName:"webgl",kernelFunc:function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:a,sorted:s}=r,u=(0,o.env)().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=(0,o.env)().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=i.shape,d=c[c.length-1];if(n.shouldExecuteOnCPU([i])||d<u||a>l){let e=n.readSync(i.dataId),[t,r]=(0,W.oC)(e,c,i.dtype,a,s);return[n.makeTensorInfo(t.shape,t.dtype,t.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===a)return c[c.length-1]=0,[n.makeTensorInfo(c,i.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(1===d)return[i,ng({attrs:{shape:c,dtype:"int32",value:0},backend:n})];let h=n.texData.get(i.dataId),f=null!==h&&h.isPacked,p=f?n.unpackTensor(i):i,m=o.util.sizeFromShape(c)/d,g=H({inputs:{x:p},attrs:{shape:[m,d]},backend:n});f&&ac(n,p);let x=ad(a),b=ad(d),y=null,v=()=>null===y?[g,g]:[g,y],w=(e,t,r)=>{let i=v(),a=new au(r),o=[[d],[null===y?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],s=y;y=n.runWebGLProgram(a,i,"int32",o),ac(n,s)};for(let e=1;e<x;e*=2){let t=2*e;for(let n=e;n>=1;n/=2)w(t,n,[m,b])}for(let e=b;e>x;e/=2){let t=v(),r=new al([m,e/2]),i=[[d],[null===y?1:0],[x]],a=y;y=n.runWebGLProgram(r,t,"int32",i),ac(n,a);let o=x/2,s=2*o;for(let e=o;e>=1;e/=2)w(s,e,y.shape)}let k=y;y=eY({inputs:{x:y},backend:n,attrs:{begin:0,size:[m,a]}}),ac(n,k);let C=nB({inputs:{x:g,indices:y},backend:n,attrs:{axis:1,batchDims:1}});ac(n,g);let I=c.slice(0,-1);I.push(a),k=y,y=H({inputs:{x:y},attrs:{shape:I},backend:n}),ac(n,k);let $=C;return C=H({inputs:{x:C},attrs:{shape:I},backend:n}),ac(n,$),[C,y]}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class af{constructor(e,t,n,r,i,a){let o;switch(this.variableNames=["Image","Transforms"],this.outputShape=a,r){case"constant":default:o=1;break;case"reflect":o=2;break;case"wrap":o=3;break;case"nearest":o=4}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${o} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${o} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${o} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${"nearest"===n?1:2} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}let ap={kernelName:o.Transform,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{image:i,transforms:a}=t,{interpolation:o,fillMode:s,fillValue:u,outputShape:l}=r,[c,d,h,f]=i.shape,[p,m]=null!=l?l:[d,h],g=new af(d,h,o,s,u,[c,p,m,f]);return n.runWebGLProgram(g,[i,a],"float32")}},am={kernelName:o.Unique,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:a}=t;(0,c.assertNotComplex)(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let o=r.readSync(a.dataId),{outputValues:s,outputShape:u,indices:l}=(0,W.CV)(o,i,a.shape,a.dtype);return[r.makeTensorInfo(u,a.dtype,s),r.makeTensorInfo([l.length],"int32",l)]}},ag={kernelName:o.Unpack,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{value:i}=t,{axis:a}=r;a<0&&(a+=i.shape.length);let o=i.shape.length,s=i.shape[a],u=Array(o-1),l=0;for(let e=0;e<o;e++)e!==a&&(u[l++]=i.shape[e]);let c=[],d=Array(o).fill(0),h=i.shape.slice();h[a]=1;let f=Array(s);for(let e=0;e<f.length;e++){d[a]=e;let t=eY({inputs:{x:i},backend:n,attrs:{begin:d,size:h}}),r=H({inputs:{x:t},backend:n,attrs:{shape:u}});f[e]=r,c.push(t)}return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),f}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ax{constructor(e,t){this.variableNames=["x","segmentIds"];let n=e.windowSize,r=e.batchSize,i=e.inSize,a=e.numSegments,o=a*Math.ceil(i/n);this.outputShape=[r,o];let s=4*Math.floor(n/4),u=n%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";i%n>0&&(c=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let d="";i%n>0&&(d=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${d}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${a})) * float(${n}));
        int currentSeg = int(mod(float(outIdx), float(${a})));

        float sumValue = 0.0;

        for (int i = 0; i < ${s}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${l}
        }

        int inIdx = inOffset + ${s};
        if (${1===u}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${l}
        } else if (${2===u}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${l}
        } else if (${3===u}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${l}
        }
        setOutput(sumValue);
      }
    `}}for(let e of[ea,es,el,ed,ep,ex,eb,ey,eC,eI,eS,e_,eN,eA,eO,eP,eM,eW,eG,eU,eH,eZ,eJ,e2,e3,e6,tt,ti,$,ts,tp,tC,t_,tN,tR,tA,tF,tB,tP,tV,tz,tX,tH,tq,tQ,t0,t1,t3,t5,t8,t6,ne,nn,ni,no,nu,nd,np,nx,ny,nk,nI,n_,nN,nR,nF,nD,nM,nL,C,nW,th,nU,nX,nK,_,nj,nQ,nZ,n0,n2,n4,n8,n6,rt,rr,ra,rs,ru,rl,rh,rf,rp,rm,rg,rb,rw,rC,rA,z,rB,rP,rV,rW,e5,rU,rH,rK,rQ,rJ,R,r0,r1,r2,r3,r5,e9,rS,r9,r7,it,K,ia,is,ic,ih,ig,ib,iv,ik,i$,iE,iT,iR,iF,iB,iP,iV,eQ,rR,iW,iG,iU,iz,iX,iH,iK,iq,iQ,iJ,i2,i3,i4,i8,i9,i6,i7,rT,et,at,ar,ai,as,ah,ap,er,am,ag,{kernelName:o.UnsortedSegmentSum,backendName:"webgl",kernelFunc:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:a}=t,{numSegments:s}=r,u=i.shape.length,l=[],c=0,d=o.backend_util.getAxesPermutation([c],u),h=i;null!=d&&(h=en({inputs:{x:i},backend:n,attrs:{perm:d}}),l.push(h),c=o.backend_util.getInnerMostAxes(1,u)[0]);let f=o.backend_util.segment_util.computeOutShape(h.shape,c,s),p=o.util.sizeFromShape([h.shape[c]]),m=H({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}});l.push(m);let g=(0,o.sumOutType)(i.dtype),x=(e,t,r,i,a)=>{let s=e.shape[0],u=e.shape[1],c=o.backend_util.segment_util.segOpComputeOptimalWindowSize(u,a),d=new ax({windowSize:c,inSize:u,batchSize:s,numSegments:a},t),h=n.compileAndRun(d,[e,r],i);if(l.push(h),h.shape[1]===a)return h;let f=r4({backend:n,attrs:{start:0,stop:a,step:1,dtype:"float32"}}),p=ao({inputs:{x:f},backend:n,attrs:{reps:[u/c]}});return l.push(f),l.push(p),x(h,t,p,i,a)},b=H({inputs:{x:x(m,"unsortedSegmentSum",a,g,s)},backend:n,attrs:{shape:f}}),y=b;return null!=d&&(l.push(b),y=en({inputs:{x:y},backend:n,attrs:{perm:o.backend_util.getUndoAxesPermutation(d)}})),l.forEach(e=>n.disposeIntermediateTensorInfo(e)),y}},rX])(0,o.registerKernel)(e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */},74331:function(e,t,n){"use strict";n.d(t,{$O:function(){return k},$j:function(){return z},$u:function(){return U},A0:function(){return X},AR:function(){return L},B_:function(){return g},Bk:function(){return W},Bo:function(){return S},CJ:function(){return D},CV:function(){return Q},F1:function(){return G},Fv:function(){return Y},KX:function(){return q},LS:function(){return V},M8:function(){return N},MZ:function(){return f},PQ:function(){return v},Qs:function(){return T},Rn:function(){return y},Sd:function(){return w},St:function(){return F},TD:function(){return p},Tg:function(){return _},Th:function(){return $},UN:function(){return B},X8:function(){return M},XM:function(){return o},Y1:function(){return O},_9:function(){return H},aX:function(){return d},cK:function(){return r},cZ:function(){return E},cm:function(){return s},cx:function(){return a},fy:function(){return R},gv:function(){return c},hO:function(){return A},ji:function(){return x},kI:function(){return K},kY:function(){return b},m$:function(){return m},n7:function(){return l},nL:function(){return C},nT:function(){return P},oC:function(){return j},pk:function(){return u},qO:function(){return i},r:function(){return I},tx:function(){return h}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let{addImpl:r,bincountImpl:i,bincountReduceImpl:a,bitwiseAndImpl:o,castImpl:s,ceilImpl:u,concatImpl:l,equalImpl:c,expImpl:d,expm1Impl:h,floorImpl:f,gatherNdImpl:p,gatherV2Impl:m,greaterImpl:g,greaterEqualImpl:x,lessImpl:b,lessEqualImpl:y,linSpaceImpl:v,logImpl:w,maxImpl:k,maximumImpl:C,minimumImpl:I,multiplyImpl:$,negImpl:S,notEqualImpl:E,prodImpl:_,raggedGatherImpl:T,raggedRangeImpl:N,raggedTensorToTensorImpl:R,rangeImpl:A,rsqrtImpl:F,scatterImpl:O,sigmoidImpl:B,simpleAbsImpl:D,sliceImpl:P,sparseFillEmptyRowsImpl:M,sparseReshapeImpl:V,sparseSegmentReductionImpl:L,sqrtImpl:W,staticRegexReplaceImpl:G,stridedSliceImpl:U,stringNGramsImpl:z,stringSplitImpl:X,stringToHashBucketFastImpl:H,subImpl:K,tileImpl:q,topKImpl:j,transposeImpl:Y,uniqueImpl:Q}=n(69095)},3559:function(e,t,n){"use strict";n.d(t,{U:function(){return o}});var r=n(62051),i=n(76899),a=n(86854);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=(0,r.C9)(this.outputShape.length),0===this.rank)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{let e=(0,i.Ky)("rc",this.rank),t=(0,a.kW)(this.rank),n=this.getOutOfBoundsCondition(e),r=this.getSetup(e),o=this.getOutput(e);this.userCode=`
        void main() {
          ${t} rc = getOutputCoords();

          if(${n}) {
            setOutput(vec4(0));
          } else {
            ${r}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){let t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let i=`${0===n?"r":"rp1"}, ${0===r?"c":"cp1"}`;for(let t=2;t<this.rank;t++)i=`${e[e.length-1-t]},`+i;t.push(i)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let n=this.rank-2;n<this.rank;n++)t+=`${e[n]} >= ${this.enableShapeUniforms?`outShape[${n}]`:this.outputShape[n]}`,n<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";let t=e.slice(-2),n=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${n};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){let t=this.getSourceCoordsArr(e);if(1===this.rank){let e=this.enableShapeUniforms?"outShape":this.outputShape[0];return`getA(rc), (rc + 1 >= ${e} ? 0. : getA(rc + 1)), 0, 0`}return`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}},76899:function(e,t,n){"use strict";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r(e,t){return["x","y","z","w","u","v"].slice(0,t).map(t=>`${e}.${t}`)}function i(e,t){return 1===t?[e]:r(e,t)}function a(e,t){if(1===e)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}n.d(t,{Ky:function(){return i},Qc:function(){return a},k6:function(){return r}})},62411:function(e,t,n){"use strict";n.d(t,{v:function(){return a}});var r=n(62051),i=n(39040);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=(0,r.C9)(this.outputShape.length);let n="";for(let e=0;e<4;e++){let t="thisRC = rc;";e%2==1&&(t+="thisRC.z += 1;"),e>1&&(t+="thisRC.y += 1;"),n+=`
        ${t}
        ${e>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${e}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${e>0?"}":""}
      `}this.userCode=`
      ${function(e,t){let n=t?i.al(["r","c","d"],"inputShape"):i.RW(["r","c","d"],e);return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${n}
      return ivec3(r, c, d);
    }
  `}(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?i.nc():i.ku(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${n}

        setOutput(result);
      }
    `}}},39040:function(e,t,n){"use strict";n.d(t,{Kn:function(){return a},RW:function(){return i},al:function(){return o},ku:function(){return s},nc:function(){return u},ye:function(){return l}});var r=n(94976);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n="index"){let i=r.util.computeStrides(t);return i.map((t,r)=>{let a=`int ${e[r]} = ${n} / ${t}`,o=r===i.length-1?`int ${e[r+1]} = ${n} - ${e[r]} * ${t}`:`index -= ${e[r]} * ${t}`;return`${a}; ${o};`}).join("")}function a(e,t,n="index"){let i=r.util.computeStrides(t);return i.map((t,r)=>{let a=`int ${e[r]} = ${n} / outShapeStrides[${r}]`,o=r===i.length-1?`int ${e[r+1]} = ${n} - ${e[r]} * outShapeStrides[${r}]`:`index -= ${e[r]} * outShapeStrides[${r}]`;return`${a}; ${o};`}).join("")}function o(e,t,n="index"){let r=function(e,t){let n=e.length,r=e.map(e=>`${t}[${e}]`),i=Array(n-1);i[n-2]=r[n-1];for(let e=n-3;e>=0;--e)i[e]=`(${i[e+1]} * ${r[e+1]})`;return i}(e.map((e,t)=>t),t);return r.map((t,i)=>{let a=`int ${e[i]} = ${n} / ${r[i]}`,o=i===r.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * ${r[i]}`:`index -= ${e[i]} * ${r[i]}`;return`${a}; ${o};`}).join("")}function s(e){let t=r.util.computeStrides(e).map(e=>e.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function u(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}let l=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`},31929:function(e,t,n){"use strict";n.d(t,{Se:function(){return p},Sq:function(){return m},V9:function(){return u},Yz:function(){return h},kk:function(){return c},m1:function(){return o},qe:function(){return f},v2:function(){return s},yb:function(){return d}});var r,i,a,o,s,u,l=n(94976);function c(e,t){return[t,e]}function d(e,t){return e*t}function h(e){let t=l.util.sizeFromShape(e);return l.util.sizeToSquarishShape(Math.ceil(t/4))}function f(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function p(e,t){let[n,r]=f(e,t);return n*r*4}function m(e,t){let n,r,i,a,o,s,u,c,d,h;return 2===(0,l.env)().getNumber("WEBGL_VERSION")?(n=e.R32F,r=e.R16F,i=e.RGBA16F,a=e.RGBA32F,o=e.RED,u=4,c=1,d=e.HALF_FLOAT,h=e.FLOAT,s=e.RGBA8):(n=e.RGBA,r=e.RGBA,i=e.RGBA,a=e.RGBA,o=e.RGBA,u=4,c=4,d=null!=t?t.HALF_FLOAT_OES:null,h=e.FLOAT,s=e.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:s,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:h}}(r=o||(o={}))[r.DENSE=0]="DENSE",r[r.SHARED_BATCH=1]="SHARED_BATCH",(i=s||(s={}))[i.RENDER=0]="RENDER",i[i.UPLOAD=1]="UPLOAD",i[i.PIXELS=2]="PIXELS",i[i.DOWNLOAD=3]="DOWNLOAD",(a=u||(u={}))[a.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",a[a.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",a[a.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",a[a.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",a[a.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"},35528:function(e,t,n){"use strict";n.d(t,{I:function(){return o}});var r=n(94976),i=n(74480),a=n(31929);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){let r;let i=u(t,n),o=l(e,i,n);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);let c=s(e,i,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=c,this.log();let e=this.freeTextures[o].pop();return this.usedTextures[o].push(e),e}return i===a.V9.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):i===a.V9.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):i===a.V9.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):i===a.V9.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):i===a.V9.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(r),this.numUsedTextures++,this._numBytesAllocated+=c,this.log(),r}releaseTexture(e,t,n,i){if(null==this.freeTextures)return;let a=u(n,i),o=l(t,a,i);o in this.freeTextures||(this.freeTextures[o]=[]);let c=s(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,i),d=(0,r.env)().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==d&&this._numBytesAllocated>d?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=c):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=c),this.numUsedTextures--;let h=this.usedTextures[o],f=h&&h.indexOf(e);if(null==f||f<0)throw Error("Cannot release a texture that was never provided by this texture manager");h[f]=h[h.length-1],h.pop(),this.log()}log(){if(!this.logEnabled)return;let e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);let t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(let e in this.freeTextures)this.freeTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(let e in this.usedTextures)this.usedTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function s(e,t,n,r,o){let s;let u=function(e,t){switch(e){case a.V9.PACKED_2X2_FLOAT32:return(0,i.getInternalFormatForPackedMatrixTexture)(t);case a.V9.PACKED_2X2_FLOAT16:return(0,i.getInternalFormatForFloat16PackedMatrixTexture)(t);case a.V9.UNPACKED_FLOAT32:return(0,i.getInternalFormatForFloat32MatrixTexture)(t);case a.V9.UNPACKED_FLOAT16:return(0,i.getInternalFormatForFloat16MatrixTexture)(t);case a.V9.PACKED_4X1_UNSIGNED_BYTE:return(0,i.getInternalFormatForUnsignedBytesMatrixTexture)(t);default:throw Error(`Unknown physical texture type ${e}`)}}(t,r);if(o){let[t,n]=(0,a.qe)(e[0],e[1]);s=t*n}else{let[t,n]=(0,a.kk)(e[0],e[1]);s=t*n}return s*function(e,t){if(t===e.R32F)return 4;if(t===e.R16F)return 2;if(t===e.RGBA32F||t===e.RGBA)return 16;if(t===e.RGBA16F)return 8;if(t===e.RGBA8)return 4;throw Error(`Unknown internal format ${t}`)}(n,u)}function u(e,t){if(e===a.v2.UPLOAD)return a.V9.PACKED_2X2_FLOAT32;if(e===a.v2.RENDER||null==e)return(0,r.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?a.V9.PACKED_2X2_FLOAT32:a.V9.UNPACKED_FLOAT32:t?a.V9.PACKED_2X2_FLOAT16:a.V9.UNPACKED_FLOAT16;if(e===a.v2.DOWNLOAD||e===a.v2.PIXELS)return a.V9.PACKED_4X1_UNSIGNED_BYTE;throw Error(`Unknown logical texture type ${e}`)}function l(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}},85768:function(e,t,n){"use strict";n.d(t,{Cv:function(){return u},D1:function(){return a},Et:function(){return s},RX:function(){return l},Tq:function(){return h},bl:function(){return d},eW:function(){return c},l:function(){return i},t$:function(){return o}});var r=n(62051);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=(0,r.C9)(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}let a="if (isnan(x)) return x;",o="return x;",s="return abs(x);",u="return (x >= 0.0) ? x : (exp(x) - 1.0);",l=a+`
  return (x < 0.0) ? 0.0 : x;
`,c=a+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,d="return x;",h="return 1.0 / (1.0 + exp(-1.0 * x));"},15090:function(e,t,n){"use strict";n.d(t,{Cv:function(){return a},RX:function(){return o},Tq:function(){return u},cc:function(){return l},eW:function(){return s},t$:function(){return i}});var r=n(62051);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let i="return x;",a=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,o=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,s=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,u="return 1.0 / (1.0 + exp(-1.0 * x));";class l{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=(0,r.C9)(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}},8938:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var r=n(62051),i=n(76899),a=n(86854);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=(0,r.C9)(this.outputShape.length);let t=e.length,n=(0,i.Ky)("rc",t),o=(0,a.kW)(t),s=(0,i.Qc)(t,n),u=n.slice(-2),l=t<=1?"rc":`vec2(${u.join(",")})`;this.userCode=`
      void main() {
        ${o} rc = getOutputCoords();
        vec4 packedInput = getA(${s});

        setOutput(getChannel(packedInput, ${l}));
      }
    `}}},86413:function(e,t,n){"use strict";let r,i;n.r(t),n.d(t,{assertNotComplex:function(){return ee},bindCanvasToFramebuffer:function(){return R},bindColorTextureToFramebuffer:function(){return A},bindTextureToProgramUniformSampler:function(){return N},bindTextureUnit:function(){return S},bindVertexBufferToProgramAttribute:function(){return $},callAndCheck:function(){return u},canBeRepresented:function(){return l},createFragmentShader:function(){return f},createFramebuffer:function(){return I},createProgram:function(){return g},createStaticIndexBuffer:function(){return v},createStaticVertexBuffer:function(){return y},createTexture:function(){return k},createVertexShader:function(){return h},getBatchDim:function(){return M},getExtensionOrThrow:function(){return d},getFramebufferErrorMessage:function(){return B},getMaxTexturesInShader:function(){return H},getNumChannels:function(){return w},getProgramUniformLocation:function(){return T},getProgramUniformLocationOrThrow:function(){return _},getRowsCols:function(){return V},getShapeAs3D:function(){return L},getTextureShapeFromLogicalShape:function(){return W},getWebGLDisjointQueryTimerVersion:function(){return K},getWebGLErrorMessage:function(){return c},getWebGLMaxTextureSize:function(){return U},hasExtension:function(){return q},isCapableOfRenderingToFloatTexture:function(){return Y},isDownloadFloatTextureEnabled:function(){return Q},isReshapeFree:function(){return G},isWebGLFenceEnabled:function(){return J},isWebGLVersionEnabled:function(){return j},linkProgram:function(){return x},logShaderSourceAndInfoLog:function(){return m},resetMaxTextureSize:function(){return z},resetMaxTexturesInShader:function(){return X},unbindColorTextureFromFramebuffer:function(){return F},unbindTextureUnit:function(){return E},validateFramebuffer:function(){return O},validateProgram:function(){return b},validateTextureSize:function(){return C}});var a=n(94976),o=n(46641),s=n(31929);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u(e,t){let n=t();return(0,a.env)().getBool("DEBUG")&&function(e){let t=e.getError();if(t!==e.NO_ERROR)throw Error("WebGL Error: "+c(e,t))}(e),n}function l(e){return!!((0,a.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||596e-10<Math.abs(e)&&65504>Math.abs(e))}function c(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function d(e,t){return D(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function h(e,t){let n=D(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(u(e,()=>e.shaderSource(n,t)),u(e,()=>e.compileShader(n)),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),Error("Failed to compile vertex shader.");return n}function f(e,t){let n=D(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(u(e,()=>e.shaderSource(n,t)),u(e,()=>e.compileShader(n)),(0,a.env)().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw m(t,e.getShaderInfoLog(n)),Error("Failed to compile fragment shader.");return n}let p=/ERROR: [0-9]+:([0-9]+):/g;function m(e,t){let n=p.exec(t);if(null==n){console.log(`Couldn't parse line number in error: ${t}`),console.log(e);return}let r=+n[1],i=e.split("\n"),o=i.length.toString().length+2,s=i.map((e,t)=>a.util.rightPad((t+1).toString(),o)+e),u=0;for(let e=0;e<s.length;e++)u=Math.max(s[e].length,u);let l=s.slice(0,r-1),c=s.slice(r-1,r),d=s.slice(r);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log(`%c ${a.util.rightPad(c[0],u)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(d.join("\n"))}function g(e){return D(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}function x(e,t){if(u(e,()=>e.linkProgram(t)),!(0,a.env)().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),Error("Failed to link vertex and fragment shaders.")}function b(e,t){if(u(e,()=>e.validateProgram(t)),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),Error("Shader program validation failed.")}function y(e,t){let n=D(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return u(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),u(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function v(e,t){let n=D(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return u(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),u(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function w(){return 2===(0,a.env)().getNumber("WEBGL_VERSION")?1:4}function k(e){return D(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}function C(e,t){let n=(0,a.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0)throw Error(`Requested texture size [${e}x${t}] is invalid.`);if(e>n||t>n)throw Error(`Requested texture size [${e}x${t}] greater than WebGL maximum on this browser / GPU [${n}x${n}].`)}function I(e){return D(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function $(e,t,n,r,i,a,o){let s=e.getAttribLocation(t,n);return -1!==s&&(u(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),u(e,()=>e.vertexAttribPointer(s,i,e.FLOAT,!1,a,o)),u(e,()=>e.enableVertexAttribArray(s)),!0)}function S(e,t,n){P(e,n),u(e,()=>e.activeTexture(e.TEXTURE0+n)),u(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function E(e,t){P(e,t),u(e,()=>e.activeTexture(e.TEXTURE0+t)),u(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function _(e,t,n){return D(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function T(e,t,n){return e.getUniformLocation(t,n)}function N(e,t,n,r){u(e,()=>S(e,t,r)),u(e,()=>e.uniform1i(n,r))}function R(e){u(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),u(e,()=>e.viewport(0,0,e.canvas.width,e.canvas.height)),u(e,()=>e.scissor(0,0,e.canvas.width,e.canvas.height))}function A(e,t,n){u(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),u(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function F(e,t){u(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),u(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function O(e){let t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw Error("Error binding framebuffer: "+B(e,t))}function B(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function D(e,t,n){let r=u(e,()=>t());if(null==r)throw Error(n);return r}function P(e,t){let n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){let e=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw Error(`textureUnit must be in ${e}.`)}}function M(e,t=2){return a.util.sizeFromShape(e.slice(0,e.length-t))}function V(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function L(e){let t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[M(e),...V(e)]),t}function W(e,t=!1){let n=(0,a.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=(0,a.env)().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&(0,a.env)().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,1===(e=e.map((t,n)=>n>=e.length-2?a.util.nearestLargerEven(e[n]):e[n])).length&&(e=[2,e[0]])),2!==e.length&&(e=a.util.squeezeShape(e).newShape);let i=a.util.sizeFromShape(e),o=null;e.length<=1&&i<=n?o=[1,i]:2===e.length&&e[0]<=n&&e[1]<=n?o=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?o=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?o=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?o=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(o=[e[0],e[1]*e[2]*e[3]]);let s=null!=o&&Math.max(...o)>r&&Math.min(...o)<=(t?2:1)&&Math.min(...o)>0;if(null==o||s){if(t){let t=M(e),n=2,r=2;e.length&&([n,r]=V(e)),i=n/2*t*(r/2),o=a.util.sizeToSquarishShape(i).map(e=>2*e)}else o=a.util.sizeToSquarishShape(i)}return o}function G(e,t){if(e=e.slice(-2),t=t.slice(-2),a.util.arraysEqual(e,t)||!e.length||!t.length||0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){let n=e[e.length-1],r=t[t.length-1];if(n===r||n%2==0&&r%2==0&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&e[0]%2==0&&t[0]%2==0}function U(e){if(null==r){let t=(0,o.jl)(e);r=t.getParameter(t.MAX_TEXTURE_SIZE)}return r}function z(){r=null}function X(){i=null}function H(e){if(null==i){let t=(0,o.jl)(e);i=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,i)}function K(e){if(0===e)return 0;let t=(0,o.jl)(e);return q(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:q(t,"EXT_disjoint_timer_query")?1:0}function q(e,t){return null!=e.getExtension(t)}function j(e){try{let t=(0,o.jl)(e);if(null!=t)return!0}catch(e){console.log("Error when getting WebGL context: ",e)}return!1}function Y(e){if(0===e)return!1;let t=(0,o.jl)(e);if(1===e){if(!q(t,"OES_texture_float"))return!1}else if(!q(t,"EXT_color_buffer_float"))return!1;return Z(t)}function Q(e){if(0===e)return!1;let t=(0,o.jl)(e);if(1===e){if(!q(t,"OES_texture_float")||!q(t,"WEBGL_color_buffer_float"))return!1}else{if(q(t,"EXT_color_buffer_float"))return Z(t);let e="EXT_color_buffer_half_float";if(q(t,e)){let n=t.getExtension(e);return function(e,t){let n=(0,s.Sq)(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);let i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);let a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(i),a}(t,n)}return!1}return Z(t)}function Z(e){let t=(0,s.Sq)(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);let r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);let i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),i}function J(e){return 2===e&&null!=(0,o.jl)(e).fenceSync}function ee(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&a.util.assert("complex64"!==e.dtype,()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}},22884:function(e,t,n){"use strict";n.d(t,{JL:function(){return r},Zu:function(){return i}});class r{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class i{refCount(e){return a("refCount")}incRef(e){return a("incRef")}timerAvailable(){return!0}time(e){return a("time")}read(e){return a("read")}readSync(e){return a("readSync")}readToGPU(e,t){return a("readToGPU")}numDataIds(){return a("numDataIds")}disposeData(e,t){return a("disposeData")}write(e,t,n){return a("write")}move(e,t,n,r,i){return a("move")}createTensorFromGPUData(e,t,n){return a("createTensorFromGPUData")}memory(){return a("memory")}floatPrecision(){return a("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return a("dispose")}}function a(e){throw Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}},69154:function(e,t,n){"use strict";function r(e,t){return e>t?1:e<t?-1:0}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n,r,i){return s(e,t,n,r,i,0)}function a(e,t,n,r,i,a){return s(e,t,n,r,i,0,!1,a,!0)}function o(e,t,n,r,i,a){return s(e,t,n,r,i,a,!0)}function s(e,t,n,i,a,o,s=!1,l=!1,c=!1){let d=[];for(let e=0;e<t.length;e++)t[e]>a&&d.push({score:t[e],boxIndex:e,suppressBeginIndex:0});d.sort(u);let h=o>0?-.5/o:0,f=[],p=[];for(;f.length<n&&d.length>0;){let t=d.pop(),{score:n,boxIndex:o,suppressBeginIndex:s}=t;if(n<a)break;let l=!1;for(let n=f.length-1;n>=s;--n){let r=function(e,t,n){let r=e.subarray(4*t,4*t+4),i=e.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),d=Math.max(i[0],i[2]),h=Math.max(i[1],i[3]),f=(s-a)*(u-o),p=(d-l)*(h-c);if(f<=0||p<=0)return 0;let m=Math.max(Math.min(s,d)-Math.max(a,l),0)*Math.max(Math.min(u,h)-Math.max(o,c),0);return m/(f+p-m)}(e,o,f[n]);if(r>=i){l=!0;break}if(t.score=t.score*function(e,t,n){let r=Math.exp(t*n*n);return n<=e?r:0}(i,h,r),t.score<=a)break}t.suppressBeginIndex=f.length,!l&&(t.score===n?(f.push(o),p.push(t.score)):t.score>a&&/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let i=function(e,t,n){let r=0,i=e.length,a=0,o=!1;for(;r<i;){let s=n(t,e[a=r+(i-r>>>1)]);s>0?r=a+1:(i=a,o=!s)}return o?r:-r-1}(e,t,n||r);e.splice(i<0?-(i+1):i,0,t)}(d,t,u))}let m=f.length,g=n-m;l&&g>0&&(f.push(...Array(g).fill(0)),p.push(...Array(g).fill(0)));let x={selectedIndices:f};return s&&(x.selectedScores=p),c&&(x.validOutputs=m),x}function u(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}n.d(t,{GP:function(){return i},qP:function(){return a},pA:function(){return o}})},35736:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(84171);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t){let n=[];for(let e=0;e<t.length;e++)t[e]&&n.push(e);let i=(0,r.f)(e,"int32"),a=(0,r.f)([n.length,e.length],"int32");for(let t=0;t<n.length;t++){let r=i.indexToLoc(n[t]),o=t*e.length;a.values.set(r,o)}return a.toTensor()}},58520:function(e,t,n){"use strict";n.d(t,{BV:function(){return y},wv:function(){return b}});var r=n(22884),i=n(3845),a=n(16588),o=n(89052),s=n(77413),u=n(45641),l=n(3165),c=n(31143);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new h)}profileKernel(e,t,n){let r,a;let o=()=>{r=n()},s=l.now();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(o);else{for(let e of(o(),r))e.dataSync();a=Promise.resolve({kernelMs:l.now()-s})}if((0,i.OB)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let t=0;t<r.length;t++){let n=r[t];n.data().then(t=>{!function(e,t,n){if("float32"===t)for(let t=0;t<e.length;t++){let r=e[t];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}}(t,n.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:a.then(e=>e.kernelMs),extraInfo:a.then(e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():"")}}logKernelProfile(e){let{kernelName:t,outputs:n,timeMs:r,inputs:i,extraInfo:a}=e;n.forEach(e=>{Promise.all([e.data(),r,a]).then(n=>{this.logger.logKernelProfile(t,e,n[0],n[1],i,n[2])})})}}class h{logKernelProfile(e,t,n,r,i,a){let o="number"==typeof r?c.oj(`${r}ms`,9):r.error,s=c.oj(e,25),u=t.rank,l=t.size,d=c.oj(t.shape.toString(),14),h="";for(let e in i){let n=i[e];if(null!=n){let r=n.shape||t.shape,i=r.length;h+=`${e}: ${i}D ${i>0?r:""} `}}console.log(`%c${s}	%c${o}	%c${u}D ${d}	%c${l}	%c${h}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}var f=n(85013),p=n(66484);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m(e){return null!=e.kernelName}class g{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(let e in this.registeredVariables)this.registeredVariables[e].dispose()}}class x{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new g}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t];if(await this.initializeBackend(n).success){await this.setBackend(n);return}}throw Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){let{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{let{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,n=1){return e in this.registryFactory?(u.Z(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;let{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new d(this.backendInstance),!0}setupRegisteredKernels(){(0,s.tr)(this.backendName).forEach(e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){(0,s.tr)(e).forEach(t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])})}initializeBackend(e){let t=this.registryFactory[e];if(null==t)throw Error(`Cannot initialize backend ${e}, no registration found.`);try{let n=t.factory();if(!n||n instanceof r.Zu||"function"!=typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{let t=++this.pendingBackendInitId,r=n.then(n=>!(t<this.pendingBackendInitId)&&(this.registry[e]=n,this.pendingBackendInit=null,!0)).catch(n=>!(t<this.pendingBackendInitId)&&(this.pendingBackendInit=null,u.Z(`Initialization of backend ${e} failed`),u.Z(n.stack||n.message),!1));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(t){return u.Z(`Initialization of backend ${e} failed`),u.Z(t.stack||t.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw Error(`${e} backend not found in registry`);this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t],{success:r,asyncInit:i}=this.initializeBackend(n);if(i||r)return{name:n,asyncInit:i}}throw Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){let n=this.state.tensorInfo.get(t),r=n.backend,i=this.readSync(t),a=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,i,n.shape,n.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,r=null;if(null==t){if("function"!=typeof e)throw Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}return this.scopedRun(()=>this.startScope(r),()=>this.endScope(n),()=>((n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n))}scopedRun(e,t,n){e();try{let e=n();return t(),e}catch(e){throw t(),e}}nextTensorId(){return x.nextTensorId++}nextVariableId(){return x.nextVariableId++}clone(e){let t=y.runKernel(o.iJz,{x:e});return this.addTapeNode(this.state.activeScope.name,{x:e},[t],e=>({x:()=>y.runKernel(o.RFZ,{x:e},{dtype:"float32"})}),[],{}),t}runKernel(e,t,n){if(null==this.backendName&&this.backend,!(null!=(0,s.pI)(e,this.backendName)))throw Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){let r=this.backend.numDataIds(),i=0;n.forEach(e=>{i+="complex64"===e.dtype?3:1});let a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-i-a;if(o>0)throw Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let t,n,r,i;let a=[],o=this.isTapeOn(),u=this.state.numBytes,l=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;let d=m(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(m(e)){let{kernelName:t,inputs:i,attrs:u}=e;null==this.backendName&&this.backend;let l=(0,s.pI)(t,this.backendName);c.hu(null!=l,()=>`Cannot find registered kernel '${t}' for backend '${this.backendName}'`),n=()=>{let e=this.backend.numDataIds(),n=Array.isArray(r=l.kernelFunc({inputs:i,attrs:u,backend:this.backend}))?r:[r];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,n);let s=n.map(e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e));if(o){let e=this.getTensorsForGradient(t,i,s);a=this.saveTensorsForBackwardMode(e)}return s}}else{let{forwardFunc:t}=e,i=e=>{o&&(a=e.map(e=>this.keep(this.clone(e))))};n=()=>{let e=this.backend.numDataIds(),n=Array.isArray(r=this.tidy(()=>t(this.backend,i)))?r:[r];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(d,e,n),n}}let{inputs:h,attrs:f}=e,p=m(e)?null:e.backwardsFunc;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(i=this.profiler.profileKernel(d,h,()=>n()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(i),t=i.outputs):t=n()}),o&&this.addTapeNode(d,h,t,p,a,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:d,bytesAdded:this.state.numBytes-u,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-l,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(h).map(e=>null!=h[e]?h[e].shape:null),outputShapes:t.map(e=>e.shape),kernelTimeMs:i.timeMs,extraInfo:i.extraInfo}),Array.isArray(r)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(e=>this.keep(this.clone(e)))}getTensorsForGradient(e,t,n){let r=(0,s.uk)(e);if(null!=r){let e;let i=r.inputsToSave||[],a=r.outputsToSave||[];r.saveAllInputs?(c.hu(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),e=Object.keys(t).map(e=>t[e])):e=i.map(e=>t[e]);let o=n.filter((e,t)=>a[t]);return e.concat(o)}return[]}makeTensor(e,t,n,r){if(null==e)throw Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let i=e;"string"===n&&c.HD(e[0])&&(i=e.map(e=>l.encodeString(e)));let a=r.write(i,t,n),o=new f.es(t,n,a,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){let e=this.state.tensorInfo.get(a),t=(0,c.Ub)(i);this.state.numBytes+=t-e.bytes,e.bytes=t}return o}makeTensorFromDataId(e,t,n,r){let i={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,t){let{dataId:n,shape:r,dtype:i}=e,a=new f.es(r,i,n,this.nextTensorId());return this.trackTensor(a,t),a}makeVariable(e,t=!0,n,r){n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));let i=new f._w(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*c.bT(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof f._w||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;let t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){let t=e.size*c.bT(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(let e in this.state.registeredVariables){let t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){let e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;let t=this.state.numBytes,n=this.state.numTensors;for(let r of(this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(e=>e.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,this.state.activeProfile.kernels))r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,r,i,a){let o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:i},u=(0,s.uk)(e);null!=u&&(r=u.gradFunc),null!=r&&(o.gradient=e=>(e=e.map((e,t)=>{if(null==e){let e=n[t],r=c.wT(e.size,e.dtype);return this.makeTensor(r,e.shape,e.dtype)}return e}),r(e.length>1?e:e[0],i,a))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){let t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){let t=(0,p.getTensorsInContainer)(e),n=new Set(t.map(e=>e.id));for(let e=0;e<this.state.activeScope.track.length;e++){let t=this.state.activeScope.track[e];t.kept||n.has(t.id)||t.dispose()}let r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(e=>{e.kept||e.scopeId!==r.id||this.track(e)})}gradients(e,t,n,r=!1){if(c.hu(t.length>0,()=>"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);let i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));c.hu(i instanceof f.es,()=>"The result y returned by f() must be a tensor.");let a=/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let r={},i={};for(let e=0;e<t.length;e++)r[t[e].id]=!0;for(let n=0;n<e.length;n++){let a=e[n],o=a.inputs;for(let e in o){let n=o[e],s=!1;for(let e=0;e<t.length;e++)if(r[n.id]){a.outputs.forEach(e=>r[e.id]=!0),s=!0,i[a.id]=!0;break}if(s)break}}let a={};a[n.id]=!0;let o={};for(let t=e.length-1;t>=0;t--){let n=e[t],r=n.inputs;for(let e=0;e<n.outputs.length;e++)if(a[n.outputs[e].id]){for(let e in r)a[r[e].id]=!0,o[n.id]=!0;break}}let s=[];for(let t=0;t<e.length;t++){let n=e[t];if(i[n.id]&&o[n.id]){let e={};for(let t in n.inputs){let i=n.inputs[t];r[i.id]&&(e[t]=i)}let t=Object.assign({},n);t.inputs=e,t.outputs=n.outputs,s.push(t)}}return s}(this.state.activeTape,t,i);if(!r&&0===a.length&&t.length>0)throw Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let e={};e[i.id]=null==n?function(e){let t=(0,c.p8)((0,c.NA)(e),"float32");return y.makeTensor(t,e,"float32")}(i.shape):n,function(e,t,n,r){for(let i=t.length-1;i>=0;i--){let a=t[i],o=[];if(a.outputs.forEach(t=>{let n=e[t.id];null!=n?o.push(n):o.push(null)}),null==a.gradient)throw Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);let s=a.gradient(o);for(let t in a.inputs){if(!(t in s))throw Error(`Cannot backprop through input ${t}. Available gradients found: ${Object.keys(s)}.`);let i=n(()=>s[t]());if("float32"!==i.dtype)throw Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${t} must have 'float32' dtype, but has '${i.dtype}'`);let o=a.inputs[t];if(!c.cO(i.shape,o.shape))throw Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${t}' has shape '${i.shape}', which does not match the shape of the input '${o.shape}'`);if(null==e[o.id])e[o.id]=i;else{let t=e[o.id];e[o.id]=r(t,i),t.dispose()}}}}(e,a,e=>this.tidy(e),v);let r=t.map(t=>e[t.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(e=>{for(let t of e.saved)t.dispose()}),this.state.activeTape=null),{value:i,grads:r}})}customGrad(e){return c.hu(c.mf(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{let n;c.hu(t.every(e=>e instanceof f.es),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r={};return t.forEach((e,t)=>{r[t]=e}),this.runKernelFunc({forwardFunc:(r,i)=>(n=e(...t,i),c.hu(n.value instanceof f.es,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),c.hu(c.mf(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),backwardsFunc:(e,r)=>{let i=n.gradFunc(e,r),a=Array.isArray(i)?i:[i];c.hu(a.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),c.hu(a.every(e=>e instanceof f.es),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let o={};return a.forEach((e,t)=>{o[t]=()=>e}),o},inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){let t=(0,l.now)(),n=await this.backend.time(e);return n.wallMs=(0,l.now)()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){for(let e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new g,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function b(){let e=(0,a.D)();if(null==e._tfengine){let t=new i.qA(e);e._tfengine=new x(t)}return(0,i.iG)(e._tfengine.ENV),(0,f.Vi)(()=>e._tfengine),e._tfengine}x.nextTensorId=0,x.nextVariableId=0;let y=b();function v(e,t){return y.runKernel(o.mm_,{a:e,b:t})}},3845:function(e,t,n){"use strict";n.d(t,{OB:function(){return s},Vi:function(){return u},iG:function(){return l},qA:function(){return a}});var r=n(31143);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let i="tfjsflags";class a{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=o,this.populateURLFlags()}setPlatform(e,t){null==this.platform||u.getBool("IS_TEST")||u.getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){let t=this.urlFlags[e];u.getBool("IS_TEST")||u.getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${t}.`),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];let t=this.evaluateFlag(e);if((0,r.tI)(t))throw Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;let e=this.getQueryParams(this.global.location.search);i in e&&e[i].split(",").forEach(e=>{let[t,n]=e.split(":");this.urlFlags[t]=function(e,t){let n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:`${+n}`===n?+n:t}(0,n)})}}function o(e){let t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(e,...n)=>{var r,i;return r=n[0],i=n[1],t[decodeURIComponent(r)]=decodeURIComponent(i||""),n.join("=")}),t}function s(){return u}let u=null;function l(e){u=e}},16588:function(e,t,n){"use strict";let r;n.d(t,{D:function(){return a},R:function(){return o}});var i=n(20357);function a(){if(null==r){let e;if("undefined"!=typeof window)e=window;else if(void 0!==n.g)e=n.g;else if(void 0!==i)e=i;else if("undefined"!=typeof self)e=self;else throw Error("Could not find a global object");r=e}return r}function o(e,t){let n=function(){let e=a();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{let r=t();return n.set(e,r),n.get(e)}}},65139:function(e,t,n){"use strict";n.d(t,{B9:function(){return g},CQ:function(){return y},Cd:function(){return v},Cn:function(){return x},G4:function(){return s},MX:function(){return c},N5:function(){return p},N8:function(){return d},N_:function(){return w},R:function(){return u},SR:function(){return h},VY:function(){return E},XV:function(){return b},cF:function(){return l},cj:function(){return k},jq:function(){return $},lu:function(){return m},sq:function(){return f},x3:function(){return C},y3:function(){return S},ze:function(){return I}});var r=n(58520),i=n(3845),a=n(85013),o=n(66484);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s(){(0,i.OB)().set("PROD",!0)}function u(){(0,i.OB)().set("DEBUG",!0)}function l(){(0,i.OB)().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function c(e){(0,i.OB)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function d(){r.BV.disposeVariables()}function h(){return r.BV}function f(){return r.BV.memory()}function p(e){return r.BV.profile(e)}function m(e,t){return r.BV.tidy(e,t)}function g(e){(0,o.getTensorsInContainer)(e).forEach(e=>e.dispose())}function x(e){return r.BV.keep(e)}function b(e){return r.BV.time(e)}function y(e){return r.BV.setBackend(e)}function v(){return r.BV.ready()}function w(){return r.BV.backendName}function k(e){r.BV.removeBackend(e)}function C(e){return r.BV.findBackend(e)}function I(e){return r.BV.findBackendFactory(e)}function $(e,t,n=1){return r.BV.registerBackend(e,t,n)}function S(){return r.BV.backend}function E(e,t){(0,i.OB)().setPlatform(e,t)}(0,a.FZ)(c)},56426:function(e,t,n){"use strict";n.d(t,{UQ:function(){return s},cb:function(){return h},fN:function(){return c},h7:function(){return l},pn:function(){return d},ti:function(){return u}});var r=n(58520),i=n(85013),a=n(34950),o=n(31143);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s(e){return o.hu(o.mf(e),()=>"The f passed in grad(f) must be a function"),(t,n)=>{let i=(0,a._1)(t,"x","tf.grad","string_or_numeric"),s=null!=n?(0,a._1)(n,"dy","tf.grad"):null;return r.BV.tidy(()=>{let{value:t,grads:n}=r.BV.gradients(()=>e(i),[i],s);return null!=s&&o.k5(t.shape,s.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),f(n),n[0]})}}function u(e){return o.hu(o.mf(e),()=>"The f passed in grads(f) must be a function"),(t,n)=>{o.hu(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");let i=(0,a.sI)(t,"args","tf.grads","string_or_numeric"),s=null!=n?(0,a._1)(n,"dy","tf.grads"):null;return r.BV.tidy(()=>{let{value:t,grads:n}=r.BV.gradients(()=>e(...i),i,s);return null!=s&&o.k5(t.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),f(n),n})}}function l(e){return o.hu(o.mf(e),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{o.hu(t instanceof i.es,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),o.hu(null==n||n instanceof i.es,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");let{grads:a,value:s}=r.BV.gradients(()=>e(t),[t],n);return f(a),{grad:a[0],value:s}}}function c(e){return o.hu(o.mf(e),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{o.hu(Array.isArray(t)&&t.every(e=>e instanceof i.es),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),o.hu(null==n||n instanceof i.es,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");let a=r.BV.gradients(()=>e(...t),t,n);return null!=n&&o.k5(a.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),f(a.grads),a}}function d(e,t){o.hu(o.mf(e),()=>"The f passed in variableGrads(f) must be a function"),o.hu(null==t||Array.isArray(t)&&t.every(e=>e instanceof i._w),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");let n=null!=t;if(!n)for(let e in t=[],r.BV.registeredVariables)t.push(r.BV.registeredVariables[e]);let a=n?t.filter(e=>!e.trainable):null,s=t.length;t=t.filter(e=>e.trainable),o.hu(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);let{value:u,grads:l}=r.BV.gradients(e,t,null,!0);o.hu(l.some(e=>null!=e),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),o.hu(0===u.rank,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${u.rank} tensor`);let c={};return t.forEach((e,t)=>{null!=l[t]&&(c[e.name]=l[t])}),null!=a&&a.forEach(e=>c[e.name]=null),{value:u,grads:c}}function h(e){return r.BV.customGrad(e)}function f(e){if(e.filter(e=>null==e).length>0)throw Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}},94976:function(e,t,n){"use strict";let r,i,a;n.r(t),n.d(t,{Abs:function(){return ta.SYM},Acos:function(){return ta.VGw},Acosh:function(){return ta.SpW},AdadeltaOptimizer:function(){return e_},AdagradOptimizer:function(){return eN},AdamOptimizer:function(){return eF},AdamaxOptimizer:function(){return eD},Add:function(){return ta.mm_},AddN:function(){return ta.Xze},All:function(){return ta.oT6},Any:function(){return ta.IKK},ArgMax:function(){return ta.sJF},ArgMin:function(){return ta.aJk},Asin:function(){return ta.M2y},Asinh:function(){return ta.qw7},Atan:function(){return ta.jMg},Atan2:function(){return ta.QCc},Atanh:function(){return ta.Oyi},AvgPool:function(){return ta.JhU},AvgPool3D:function(){return ta._k9},AvgPool3DGrad:function(){return ta.IMb},AvgPoolGrad:function(){return ta.ROF},BatchMatMul:function(){return ta.XLW},BatchToSpaceND:function(){return ta.zws},Bincount:function(){return ta.zvY},BitwiseAnd:function(){return ta.hCO},BroadcastArgs:function(){return ta.eEB},BroadcastTo:function(){return ta.Ly9},Cast:function(){return ta.RFZ},Ceil:function(){return ta.gJX},ClipByValue:function(){return ta.xnO},Complex:function(){return ta.Zz9},ComplexAbs:function(){return ta.yj2},Concat:function(){return ta.Eh3},Conv2D:function(){return ta.mhS},Conv2DBackpropFilter:function(){return ta.wUP},Conv2DBackpropInput:function(){return ta.wm},Conv3D:function(){return ta.x12},Conv3DBackpropFilterV2:function(){return ta.o2y},Conv3DBackpropInputV2:function(){return ta.ik2},Cos:function(){return ta.mc4},Cosh:function(){return ta.TR1},CropAndResize:function(){return ta.VcC},Cumprod:function(){return ta.Byc},Cumsum:function(){return ta.iHb},DataStorage:function(){return nB.JL},DenseBincount:function(){return ta.QRR},DepthToSpace:function(){return ta.T0n},DepthwiseConv2dNative:function(){return ta.cie},DepthwiseConv2dNativeBackpropFilter:function(){return ta.sL$},DepthwiseConv2dNativeBackpropInput:function(){return ta.y7R},Diag:function(){return ta.$w},Dilation2D:function(){return ta.p4S},Dilation2DBackpropFilter:function(){return ta.Vn9},Dilation2DBackpropInput:function(){return ta.ekb},Draw:function(){return ta.hGc},ENV:function(){return k.Vi},Einsum:function(){return ta.$g6},Elu:function(){return ta.SX0},EluGrad:function(){return ta.HEU},Environment:function(){return k.qA},Equal:function(){return ta.hdR},Erf:function(){return ta.Omj},Exp:function(){return ta.NEP},ExpandDims:function(){return ta.YFo},Expm1:function(){return ta.Y0y},FFT:function(){return ta.vwp},Fill:function(){return ta.deh},FlipLeftRight:function(){return ta.Uyb},Floor:function(){return ta.OR},FloorDiv:function(){return ta.jeX},FromPixels:function(){return ta.eBW},FusedBatchNorm:function(){return ta.sHE},FusedConv2D:function(){return ta._V0},FusedDepthwiseConv2D:function(){return ta.luS},GatherNd:function(){return ta.q1x},GatherV2:function(){return ta.qi_},Greater:function(){return ta.iZT},GreaterEqual:function(){return ta.Acj},IFFT:function(){return ta.Qg5},Identity:function(){return ta.iJz},Imag:function(){return ta.J_u},IsFinite:function(){return ta.avt},IsInf:function(){return ta.iWB},IsNan:function(){return ta.r7n},KernelBackend:function(){return nB.Zu},LRN:function(){return ta.eZ0},LRNGrad:function(){return ta.Hhh},LeakyRelu:function(){return ta.J$2},Less:function(){return ta.vtC},LessEqual:function(){return ta.CAk},LinSpace:function(){return ta.e7N},Log:function(){return ta.ZbH},Log1p:function(){return ta.kU},LogSoftmax:function(){return ta.qCd},LogicalAnd:function(){return ta.PYm},LogicalNot:function(){return ta.VfG},LogicalOr:function(){return ta.MZg},LogicalXor:function(){return ta.w6g},LowerBound:function(){return ta.qIC},MatrixBandPart:function(){return ta.J7O},Max:function(){return ta.YoZ},MaxPool:function(){return ta.mTV},MaxPool3D:function(){return ta.OAf},MaxPool3DGrad:function(){return ta.OU7},MaxPoolGrad:function(){return ta.OV7},MaxPoolWithArgmax:function(){return ta.vFR},Maximum:function(){return ta.BMI},Mean:function(){return ta.q2K},Min:function(){return ta.c17},Minimum:function(){return ta.q8u},MirrorPad:function(){return ta.jQs},Mod:function(){return ta.Vbg},MomentumOptimizer:function(){return eM},Multinomial:function(){return ta.NZg},Multiply:function(){return ta.wYn},Neg:function(){return ta.kuV},NonMaxSuppressionV3:function(){return ta.uv1},NonMaxSuppressionV4:function(){return ta.cye},NonMaxSuppressionV5:function(){return ta.W0H},NotEqual:function(){return ta.yQU},OP_SCOPE_SUFFIX:function(){return tB.zvA},OneHot:function(){return ta.we_},OnesLike:function(){return ta.qWM},Optimizer:function(){return eE},OptimizerConstructors:function(){return tF},Pack:function(){return ta.QiL},PadV2:function(){return ta.lyA},Pool:function(){return ta.Kgp},Pow:function(){return ta.pe_},Prelu:function(){return ta.o0g},Prod:function(){return ta.DlI},RMSPropOptimizer:function(){return eV},RaggedGather:function(){return ta.dDz},RaggedRange:function(){return ta.CQl},RaggedTensorToTensor:function(){return ta.BiW},Range:function(){return ta.e6w},Rank:function(){return tO.yw},Real:function(){return ta.xJR},RealDiv:function(){return ta.oHH},Reciprocal:function(){return ta.$HU},Reduction:function(){return tD.I},Relu:function(){return ta.qkr},Relu6:function(){return ta.SbG},Reshape:function(){return ta.HZH},ResizeBilinear:function(){return ta._Yw},ResizeBilinearGrad:function(){return ta.zbQ},ResizeNearestNeighbor:function(){return ta.dpD},ResizeNearestNeighborGrad:function(){return ta.Hmb},Reverse:function(){return ta.mKl},RotateWithOffset:function(){return ta.b9H},Round:function(){return ta.e07},Rsqrt:function(){return ta.bV0},SGDOptimizer:function(){return eP},ScatterNd:function(){return ta.xQA},SearchSorted:function(){return ta.nr8},Select:function(){return ta.PhF},Selu:function(){return ta.oFR},Sigmoid:function(){return ta.a5O},Sign:function(){return ta.i5y},Sin:function(){return ta.RQH},Sinh:function(){return ta.wYB},Slice:function(){return ta.p2w},Softmax:function(){return ta.Gcp},Softplus:function(){return ta.MRv},SpaceToBatchND:function(){return ta.TQc},SparseFillEmptyRows:function(){return ta.O3z},SparseReshape:function(){return ta.nhH},SparseSegmentMean:function(){return ta.w3H},SparseSegmentSum:function(){return ta.ZjV},SparseToDense:function(){return ta.D2d},SplitV:function(){return ta.L8s},Sqrt:function(){return ta.FKq},Square:function(){return ta.bK0},SquaredDifference:function(){return ta._tC},StaticRegexReplace:function(){return ta.e0R},Step:function(){return ta.h8e},StridedSlice:function(){return ta.jQk},StringNGrams:function(){return ta._JP},StringSplit:function(){return ta.s1s},StringToHashBucketFast:function(){return ta.XkS},Sub:function(){return ta.Tr8},Sum:function(){return ta.GBy},Tan:function(){return ta.sEM},Tanh:function(){return ta.MIZ},Tensor:function(){return ec.es},TensorBuffer:function(){return ec.YD},TensorScatterUpdate:function(){return ta.SIB},Tile:function(){return ta.n9L},TopK:function(){return ta.cWu},Transform:function(){return ta.wx7},Transpose:function(){return ta.G3Y},Unique:function(){return ta.kpP},Unpack:function(){return ta.ToN},UnsortedSegmentSum:function(){return ta.Qvg},UpperBound:function(){return ta.XDQ},Variable:function(){return ec._w},ZerosLike:function(){return ta.RuY},_FusedMatMul:function(){return ta.usg},abs:function(){return tB.WnP},acos:function(){return tB.Khb},acosh:function(){return tB.__u},add:function(){return tB.IHx},addN:function(){return tB.QBD},all:function(){return tB.$6P},any:function(){return tB.YjB},argMax:function(){return tB.NqF},argMin:function(){return tB.vHJ},asin:function(){return tB.ZRM},asinh:function(){return tB.VfV},atan:function(){return tB.z4N},atan2:function(){return tB.fvJ},atanh:function(){return tB.C80},avgPool:function(){return tB.wS1},avgPool3d:function(){return tB.uR5},backend:function(){return eh.y3},backend_util:function(){return g},basicLSTMCell:function(){return tB.zEQ},batchNorm:function(){return tB.tgs},batchNorm2d:function(){return tB.Dxk},batchNorm3d:function(){return tB.JY5},batchNorm4d:function(){return tB.p3b},batchToSpaceND:function(){return tB.E4h},bincount:function(){return tB.yE8},bitwiseAnd:function(){return tB.ycw},booleanMaskAsync:function(){return tB.anm},broadcastArgs:function(){return tB.XsQ},broadcastTo:function(){return tB.UFq},broadcast_util:function(){return ti},browser:function(){return h},buffer:function(){return tB.f3b},cast:function(){return tB.pju},ceil:function(){return tB.mDi},clipByValue:function(){return tB.iUl},clone:function(){return tB.d9v},complex:function(){return tB.PYB},concat:function(){return tB.zoF},concat1d:function(){return tB.gME},concat2d:function(){return tB.Izb},concat3d:function(){return tB.MNy},concat4d:function(){return tB.ZaL},conv1d:function(){return tB.PAt},conv2d:function(){return tB.Tek},conv2dTranspose:function(){return tB.bc},conv3d:function(){return tB.pdZ},conv3dTranspose:function(){return tB.$QV},copyRegisteredKernels:function(){return to.T3},cos:function(){return tB.mCk},cosh:function(){return tB.f9Y},cosineWindow:function(){return tB.mew},cumprod:function(){return tB.$Gn},cumsum:function(){return tB.zbp},customGrad:function(){return ey.cb},denseBincount:function(){return tB.ppE},deprecationWarn:function(){return eh.MX},depthToSpace:function(){return tB.nTT},depthwiseConv2d:function(){return tB.B10},device_util:function(){return u},diag:function(){return tB.Ka3},dilation2d:function(){return tB.WmZ},disableDeprecationWarnings:function(){return eh.cF},dispose:function(){return eh.B9},disposeVariables:function(){return eh.N8},div:function(){return tB.hiC},divNoNan:function(){return tB.NTj},dot:function(){return tB.AKD},dropout:function(){return tB.rvX},einsum:function(){return tB.WYO},elu:function(){return tB.pyx},enableDebugMode:function(){return eh.R},enableProdMode:function(){return eh.G4},enclosingPowerOfTwo:function(){return tB.GRh},engine:function(){return eh.SR},ensureShape:function(){return tB.EDe},env:function(){return k.OB},equal:function(){return tB.DgJ},erf:function(){return tB.qNN},euclideanNorm:function(){return tB.d2q},exp:function(){return tB.Qqt},expandDims:function(){return tB.dt4},expm1:function(){return tB.t$B},eye:function(){return tB.iyy},fft:function(){return tB.kp_},fill:function(){return tB.hlL},findBackend:function(){return eh.x3},findBackendFactory:function(){return eh.ze},floor:function(){return tB.GWj},floorDiv:function(){return tB.qPi},fused:function(){return tB.imm},gather:function(){return tB.Iqj},gatherND:function(){return tB.dbB},gather_util:function(){return f},getBackend:function(){return eh.N_},getGradient:function(){return to.uk},getKernel:function(){return to.pI},getKernelsForBackend:function(){return to.tr},grad:function(){return ey.UQ},grads:function(){return ey.ti},greater:function(){return tB.pjt},greaterEqual:function(){return tB.brS},ifft:function(){return tB.Sxn},imag:function(){return tB.asL},image:function(){return tB.BHj},inTopKAsync:function(){return tB.V3u},io:function(){return c},irfft:function(){return tB.wx0},isFinite:function(){return tB.xVT},isInf:function(){return tB.UWc},isNaN:function(){return tB.i2d},keep:function(){return eh.Cn},kernel_impls:function(){return x},leakyRelu:function(){return tB.hi7},less:function(){return tB.d9m},lessEqual:function(){return tB.zN1},linalg:function(){return tB.$r2},linspace:function(){return tB.SX3},localResponseNormalization:function(){return tB.G9k},log:function(){return tB.cM7},log1p:function(){return tB.Krr},logSigmoid:function(){return tB.e_t},logSoftmax:function(){return tB.CmS},logSumExp:function(){return tB.l_t},logicalAnd:function(){return tB.HvI},logicalNot:function(){return tB.hJK},logicalOr:function(){return tB.K5V},logicalXor:function(){return tB.egP},losses:function(){return tB.MB5},lowerBound:function(){return tB.eab},matMul:function(){return tB.OI3},math:function(){return d},max:function(){return tB.Fp7},maxPool:function(){return tB._sB},maxPool3d:function(){return tB.YQQ},maxPoolWithArgmax:function(){return tB.Ip$},maximum:function(){return tB.gWQ},mean:function(){return tB.J69},memory:function(){return eh.sq},meshgrid:function(){return tB.ry_},min:function(){return tB.VV$},minimum:function(){return tB.LTh},mirrorPad:function(){return tB.VdP},mod:function(){return tB.wQq},moments:function(){return tB.Gi7},movingAverage:function(){return tB.p_},mul:function(){return tB.dC7},multiRNNCell:function(){return tB.rq4},multinomial:function(){return tB.SJ_},neg:function(){return tB.W76},nextFrame:function(){return tV},norm:function(){return tB.KOy},notEqual:function(){return tB.Quu},oneHot:function(){return tB.lfX},ones:function(){return tB.iUs},onesLike:function(){return tB.JpU},op:function(){return tB.op},outerProduct:function(){return tB.N2O},pad:function(){return tB.vku},pad1d:function(){return tB.pNR},pad2d:function(){return tB.koy},pad3d:function(){return tB.t1L},pad4d:function(){return tB.lGY},pool:function(){return tB.d_R},pow:function(){return tB.sQ3},prelu:function(){return tB.AL3},print:function(){return tB.S0v},prod:function(){return tB.WVs},profile:function(){return eh.N5},raggedGather:function(){return tB.$gW},raggedRange:function(){return tB.VT$},raggedTensorToTensor:function(){return tB.N89},rand:function(){return tB.TN_},randomGamma:function(){return tB.wzB},randomNormal:function(){return tB.nGf},randomStandardNormal:function(){return tB.ruB},randomUniform:function(){return tB.LGj},randomUniformInt:function(){return tB.pe5},range:function(){return tB.w6H},ready:function(){return eh.Cd},real:function(){return tB.kwC},reciprocal:function(){return tB.M25},registerBackend:function(){return eh.jq},registerGradient:function(){return to.Li},registerKernel:function(){return to.wC},relu:function(){return tB.UYe},relu6:function(){return tB.btT},removeBackend:function(){return eh.cj},reshape:function(){return tB.XLQ},reverse:function(){return tB.GYS},reverse1d:function(){return tB.SDf},reverse2d:function(){return tB.diP},reverse3d:function(){return tB.sx7},reverse4d:function(){return tB.mG2},rfft:function(){return tB.QEs},round:function(){return tB.NMM},rsqrt:function(){return tB.bp0},scalar:function(){return tB.iD$},scatterND:function(){return tB.snQ},scatter_util:function(){return tg},searchSorted:function(){return tB.zcT},selu:function(){return tB.U8D},separableConv2d:function(){return tB.U_I},serialization:function(){return l},setBackend:function(){return eh.CQ},setPlatform:function(){return eh.VY},setdiff1dAsync:function(){return tB.ODp},sigmoid:function(){return tB.XD2},sign:function(){return tB.Xxe},signal:function(){return tB.tdS},sin:function(){return tB.O$l},sinh:function(){return tB.R_K},slice:function(){return tB.tPi},slice1d:function(){return tB.jZU},slice2d:function(){return tB.SmN},slice3d:function(){return tB.CnO},slice4d:function(){return tB.p0P},slice_util:function(){return tx},softmax:function(){return tB.XAC},softplus:function(){return tB.Wvh},spaceToBatchND:function(){return tB.fBT},sparse:function(){return tB.rVs},sparseToDense:function(){return tB.ers},spectral:function(){return tB.uN7},split:function(){return tB.Vl2},sqrt:function(){return tB._b3},square:function(){return tB.h62},squaredDifference:function(){return tB.$i},squeeze:function(){return tB.L9e},stack:function(){return tB.knu},step:function(){return tB.Nbs},stridedSlice:function(){return tB.NXj},string:function(){return tB.Z_8},sub:function(){return tB.luU},sum:function(){return tB.Smz},sumOutType:function(){return tO.z4},tan:function(){return tB.ORZ},tanh:function(){return tB.AEp},tensor:function(){return tB.XeE},tensor1d:function(){return tB.RRF},tensor2d:function(){return tB.odF},tensor3d:function(){return tB.wOQ},tensor4d:function(){return tB.yXz},tensor5d:function(){return tB.Bfx},tensor6d:function(){return tB.xZs},tensorScatterUpdate:function(){return tB.Pg0},tensor_util:function(){return tb},test_util:function(){return p},tidy:function(){return eh.lu},tile:function(){return tB.Gg6},time:function(){return eh.XV},topk:function(){return tB.hg7},train:function(){return tP},transpose:function(){return tB.p4s},truncatedNormal:function(){return tB.Xu6},unique:function(){return tB.Two},unregisterGradient:function(){return to.bt},unregisterKernel:function(){return to.nE},unsortedSegmentSum:function(){return tB.pUJ},unstack:function(){return tB.HHK},upcastType:function(){return tO.x8},upperBound:function(){return tB.GaM},util:function(){return ty},valueAndGrad:function(){return ey.h7},valueAndGrads:function(){return ey.fN},variable:function(){return tB.VD$},variableGrads:function(){return ey.pn},version_core:function(){return tA},where:function(){return tB.arb},whereAsync:function(){return tB.itS},zeros:function(){return tB.lls},zerosLike:function(){return tB.P84}});var o,s,u={};n.r(u),n.d(u,{isBrowser:function(){return w},isMobile:function(){return v},mockIsMobile:function(){return y}});var l={};n.r(l),n.d(l,{Serializable:function(){return eC},SerializationMap:function(){return eI},getRegisteredName:function(){return eS},registerClass:function(){return e$}});var c={};n.r(c),n.d(c,{CompositeArrayBuffer:function(){return R.w},browserFiles:function(){return ez},browserHTTPRequest:function(){return e0},concatenateArrayBuffers:function(){return $.JY},copyModel:function(){return J},decodeWeights:function(){return $.dI},decodeWeightsStream:function(){return $.r},encodeWeights:function(){return $.yz},fromMemory:function(){return e4},fromMemorySync:function(){return e5},getLoadHandlers:function(){return N},getModelArtifactsForJSON:function(){return $.jN},getModelArtifactsForJSONSync:function(){return $.ji},getModelArtifactsInfoForJSON:function(){return $.Q},getSaveHandlers:function(){return T},getWeightSpecs:function(){return $.hu},http:function(){return eJ},isHTTPScheme:function(){return eQ},listModels:function(){return Q},loadWeights:function(){return eq},moveModel:function(){return ee},registerLoadRouter:function(){return _},registerSaveRouter:function(){return E},removeModel:function(){return Z},weightsLoaderFactory:function(){return ej},withSaveHandler:function(){return e8},withSaveHandlerSync:function(){return e9}});var d={};n.r(d),n.d(d,{confusionMatrix:function(){return tr}});var h={};n.r(h),n.d(h,{draw:function(){return tf},fromPixels:function(){return tp},fromPixelsAsync:function(){return tc},toPixels:function(){return th}});var f={};n.r(f),n.d(f,{prepareAndValidate:function(){return tm}});var p={};n.r(p),n.d(p,{TEST_EPSILON_FLOAT16:function(){return tv},createVideoElement:function(){return tN},encodeStrings:function(){return function e(t){for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)?e(r):t[n]=(0,ty.encodeString)(r)}return t}},expectArrayBuffersEqual:function(){return tT},expectArraysClose:function(){return tw},expectArraysEqual:function(){return t$},expectNumbersClose:function(){return tS},expectPromiseToFail:function(){return tI},expectValuesInRange:function(){return t_},play:function(){return tR},testEpsilon:function(){return tk}});var m={};n.r(m),n.d(m,{collectGatherOpShapeInfo:function(){return nN},computeOutShape:function(){return nT},segOpComputeOptimalWindowSize:function(){return n_}});var g={};n.r(g),n.d(g,{ERF_A1:function(){return t5},ERF_A2:function(){return t8},ERF_A3:function(){return t9},ERF_A4:function(){return t6},ERF_A5:function(){return t7},ERF_P:function(){return t4},PARALLELIZE_THRESHOLD:function(){return tj},RowPartitionType:function(){return s},SELU_SCALE:function(){return t3.$},SELU_SCALEALPHA:function(){return t3.y},applyActivation:function(){return tz.QH},assertAndGetBroadcastShape:function(){return ti.assertAndGetBroadcastShape},assertAxesAreInnerMostDims:function(){return tL.lB},assertParamsConsistent:function(){return tW},assignToTypedArray:function(){return no},axesAreInnerMostDims:function(){return tL.YB},calculateShapes:function(){return tg.calculateShapes},checkEinsumDimSizes:function(){return nh},checkPadOnDimRoundingMode:function(){return tU.m},combineLocations:function(){return tL.Vh},combineRaggedTensorToTensorShapes:function(){return tX},complexWithEvenIndex:function(){return nr},complexWithOddIndex:function(){return ni},computeConv2DInfo:function(){return tU.Ix},computeConv3DInfo:function(){return tU.jw},computeDefaultPad:function(){return tU.aO},computeDilation2DInfo:function(){return tU.Rf},computeOptimalWindowSize:function(){return tY},computeOutAndReduceShapes:function(){return tL.kz},computeOutShape:function(){return tG},computePool2DInfo:function(){return tU.Xw},computePool3DInfo:function(){return tU.pl},convertConv2DDataFormat:function(){return tU.sl},decodeEinsumEquation:function(){return nc},eitherStridesOrDilationsAreOne:function(){return tU.jT},expandShapeToKeepDim:function(){return tL.rv},exponent:function(){return nu},exponents:function(){return ns},fromStringArrayToUint8:function(){return nA},fromUint8ToStringArray:function(){return nR},getAxesPermutation:function(){return tL.Q3},getBroadcastDims:function(){return ti.getBroadcastDims},getComplexWithIndex:function(){return na},getEinsumComputePath:function(){return nf},getEinsumPermutation:function(){return nd},getFusedBiasGradient:function(){return tz.pf},getFusedDyActivation:function(){return tz.Fr},getImageCenter:function(){return tQ},getInnerMostAxes:function(){return tL.sY},getPermuted:function(){return tJ},getRaggedRank:function(){return tK},getReductionAxes:function(){return ti.getReductionAxes},getReshaped:function(){return tZ},getReshapedPermuted:function(){return t0},getRowPartitionTypesHelper:function(){return tH},getSliceBeginCoords:function(){return t1},getSliceSize:function(){return t2},getSparseFillEmptyRowsIndicesDenseShapeMismatch:function(){return ng},getSparseFillEmptyRowsNegativeIndexErrorMessage:function(){return nx},getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:function(){return nb},getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:function(){return nw},getSparseReshapeInputOutputMismatchErrorMessage:function(){return nC},getSparseReshapeInputOutputMultipleErrorMessage:function(){return nk},getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:function(){return ny},getSparseReshapeNegativeOutputDimErrorMessage:function(){return nv},getSparseSegmentReductionIndicesOutOfRangeErrorMessage:function(){return nE},getSparseSegmentReductionNegativeSegmentIdsErrorMessage:function(){return nI},getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:function(){return n$},getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:function(){return nS},getUndoAxesPermutation:function(){return tL.LJ},isIdentityPermutation:function(){return np},log:function(){return ne.c},mergeRealAndImagArrays:function(){return nt},prepareAndValidate:function(){return tm},prepareSplitSize:function(){return nm},segment_util:function(){return m},shouldFuse:function(){return tz.uy},slice_util:function(){return tx},splitRealAndImagArrays:function(){return nn},stridesOrDilationsArePositive:function(){return tU.U3},tupleValuesAreOne:function(){return tU.I0},upcastType:function(){return tO.x8},validateDefaultValueShape:function(){return tq},validateInput:function(){return tg.validateInput},validateUpdateShape:function(){return tg.validateUpdateShape},warn:function(){return ne.Z}});var x={};n.r(x),n.d(x,{nonMaxSuppressionV3Impl:function(){return nF.GP},nonMaxSuppressionV4Impl:function(){return nF.qP},nonMaxSuppressionV5Impl:function(){return nF.pA},whereImpl:function(){return nO.Z}});var b=n(58520);function y(e){r=e}function v(e){if(void 0!==r)return r;if(e||"undefined"!=typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;let t=e.userAgent||e.vendor||("undefined"!=typeof window?window.opera:"");if(!t){let t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function w(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var k=n(3845),C=n(20357);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let I=(0,k.OB)();I.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),I.registerFlag("IS_BROWSER",()=>w()),I.registerFlag("IS_NODE",()=>void 0!==C&&void 0!==C.versions&&void 0!==C.versions.node),I.registerFlag("IS_CHROME",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),I.registerFlag("IS_SAFARI",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),I.registerFlag("PROD",()=>!1),I.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>I.getBool("DEBUG")),I.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),I.registerFlag("IS_TEST",()=>!1),I.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>I.getBool("DEBUG")),I.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),I.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),I.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);var $=n(71149);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==S.instance&&(S.instance=new S),S.instance}static registerSaveRouter(e){S.getInstance().saveRouters.push(e)}static registerLoadRouter(e){S.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return S.getHandlers(e,"save")}static getLoadHandlers(e,t){return S.getHandlers(e,"load",t)}static getHandlers(e,t,n){let r=[];return("load"===t?S.getInstance().loadRouters:S.getInstance().saveRouters).forEach(t=>{let i=t(e,n);null!==i&&r.push(i)}),r}}let E=e=>S.registerSaveRouter(e),_=e=>S.registerLoadRouter(e),T=e=>S.getSaveHandlers(e),N=(e,t)=>S.getLoadHandlers(e,t);var R=n(56566);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let A="tensorflowjs",F="models_store",O="model_info_store";function B(){if(!(0,k.OB)().getBool("IS_BROWSER"))throw Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let e="undefined"==typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw Error("The current browser does not appear to support IndexedDB.");return t}function D(e){let t=e.result;t.createObjectStore(F,{keyPath:"modelPath"}),t.createObjectStore(O,{keyPath:"modelPath"})}class P{constructor(e){if(this.indexedDB=B(),null==e||!e)throw Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((e,n)=>{let r=this.indexedDB.open(A,1);r.onupgradeneeded=()=>D(r),r.onsuccess=()=>{let i=r.result;if(null==t){let t=i.transaction(F,"readonly"),r=t.objectStore(F).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return i.close(),n(Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));e(r.result.modelArtifacts)},r.onerror=e=>(i.close(),n(r.error)),t.oncomplete=()=>i.close()}else{let r,a;t.weightData=R.w.join(t.weightData);let o=(0,$.Q)(t),s=i.transaction(O,"readwrite"),u=s.objectStore(O);try{r=u.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(e){return n(e)}r.onsuccess=()=>{let r;let l=(a=i.transaction(F,"readwrite")).objectStore(F);try{r=l.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:o})}catch(e){return n(e)}r.onsuccess=()=>e({modelArtifactsInfo:o}),r.onerror=e=>{let t=(u=s.objectStore(O)).delete(this.modelPath);t.onsuccess=()=>(i.close(),n(r.error)),t.onerror=e=>(i.close(),n(r.error))}},r.onerror=e=>(i.close(),n(r.error)),s.oncomplete=()=>{null==a?i.close():a.oncomplete=()=>i.close()}}},r.onerror=e=>n(r.error)})}}P.URL_SCHEME="indexeddb://";let M=e=>{var t;return(0,k.OB)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(P.URL_SCHEME)?(t=e.slice(P.URL_SCHEME.length),new P(t)):null};S.registerSaveRouter(M),S.registerLoadRouter(M);class V{constructor(){this.indexedDB=B()}async listModels(){return new Promise((e,t)=>{let n=this.indexedDB.open(A,1);n.onupgradeneeded=()=>D(n),n.onsuccess=()=>{let r=n.result,i=r.transaction(O,"readonly"),a=i.objectStore(O).getAll();a.onsuccess=()=>{let t={};for(let e of a.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},a.onerror=e=>(r.close(),t(a.error)),i.oncomplete=()=>r.close()},n.onerror=e=>t(n.error)})}async removeModel(e){var t;return e=(t=e).startsWith(P.URL_SCHEME)?t.slice(P.URL_SCHEME.length):t,new Promise((t,n)=>{let r=this.indexedDB.open(A,1);r.onupgradeneeded=()=>D(r),r.onsuccess=()=>{let i;let a=r.result,o=a.transaction(O,"readwrite"),s=o.objectStore(O),u=s.get(e);u.onsuccess=()=>{if(null==u.result)return a.close(),n(Error(`Cannot find model with path '${e}' in IndexedDB.`));{let r=s.delete(e),o=()=>{let r=(i=a.transaction(F,"readwrite")).objectStore(F).delete(e);r.onsuccess=()=>t(u.result.modelArtifactsInfo),r.onerror=e=>n(u.error)};r.onsuccess=o,r.onerror=e=>(o(),a.close(),n(u.error))}},u.onerror=e=>(a.close(),n(u.error)),o.oncomplete=()=>{null==i?a.close():i.oncomplete=()=>a.close()}},r.onerror=e=>n(r.error)})}}var L=n(31143);let W="tensorflowjs_models",G="info";function U(e){return{info:[W,e,G].join("/"),topology:[W,e,"model_topology"].join("/"),weightSpecs:[W,e,"weight_specs"].join("/"),weightData:[W,e,"weight_data"].join("/"),modelMetadata:[W,e,"model_metadata"].join("/")}}function z(e){for(let t of Object.values(e))window.localStorage.removeItem(t)}class X{constructor(e){if(!(0,k.OB)().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=U(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=(0,$.Q)(e),i=R.w.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,(0,$._n)(i));let a={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:r}}catch(e){throw z(this.keys),Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==e.modelTopologyType)throw Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=n;let r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;let i=this.LS.getItem(this.keys.modelMetadata);if(null!=i){let e=JSON.parse(i);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(t.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}let a=this.LS.getItem(this.keys.weightData);if(null==a)throw Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=(0,$.n7)(a),t}}X.URL_SCHEME="localstorage://";let H=e=>{var t;return(0,k.OB)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(X.URL_SCHEME)?(t=e.slice(X.URL_SCHEME.length),new X(t)):null};S.registerSaveRouter(H),S.registerLoadRouter(H);class K{constructor(){(0,L.hu)((0,k.OB)().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),(0,L.hu)("undefined"==typeof window||void 0!==window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){let e={},t=W+"/",n="/"+G;for(let r=0;r<this.LS.length;++r){let i=this.LS.key(r);i.startsWith(t)&&i.endsWith(n)&&(e[function(e){let t=e.split("/");if(t.length<3)throw Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join("/")}(i)]=JSON.parse(this.LS.getItem(i)))}return e}async removeModel(e){var t;let n=U(e=(t=e).startsWith(X.URL_SCHEME)?t.slice(X.URL_SCHEME.length):t);if(null==this.LS.getItem(n.info))throw Error(`Cannot find model at path '${e}'`);let r=JSON.parse(this.LS.getItem(n.info));return z(n),r}}class q{constructor(){this.managers={}}static getInstance(){return null==q.instance&&(q.instance=new q),q.instance}static registerManager(e,t){(0,L.hu)(null!=e,()=>"scheme must not be undefined or null."),e.endsWith("://")&&(e=e.slice(0,e.indexOf("://"))),(0,L.hu)(e.length>0,()=>"scheme must not be an empty string.");let n=q.getInstance();(0,L.hu)(null==n.managers[e],()=>`A model store manager is already registered for scheme '${e}'.`),n.managers[e]=t}static getManager(e){let t=q.getInstance().managers[e];if(null==t)throw Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(q.getInstance().managers)}}function j(e){if(-1===e.indexOf("://"))throw Error(`The url string provided does not contain a scheme. Supported schemes are: ${q.getSchemes().join(",")}`);return{scheme:e.split("://")[0],path:e.split("://")[1]}}async function Y(e,t,n=!1){(0,L.hu)(e!==t,()=>`Old path and new path are the same: '${e}'`);let r=S.getLoadHandlers(e);(0,L.hu)(r.length>0,()=>`Copying failed because no load handler is found for source URL ${e}.`),(0,L.hu)(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${e}.`);let i=r[0],a=S.getSaveHandlers(t);(0,L.hu)(a.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),(0,L.hu)(a.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`);let o=a[0],s=j(e).scheme,u=j(e).path,l=s===j(e).scheme,c=await i.load();n&&l&&await q.getManager(s).removeModel(u);let d=await o.save(c);return n&&!l&&await q.getManager(s).removeModel(u),d.modelArtifactsInfo}async function Q(){let e=q.getSchemes(),t={};for(let n of e){let e=await q.getManager(n).listModels();for(let r in e)t[n+"://"+r]=e[r]}return t}async function Z(e){let t=j(e);return q.getManager(t.scheme).removeModel(t.path)}async function J(e,t){return Y(e,t,!1)}async function ee(e,t){return Y(e,t,!0)}var et=n(41424);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class en{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw Error(`Browser's encoder only supports utf-8, but got ${t}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if("undefined"==typeof window||!(0,k.OB)().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",e=>{e.source===window&&e.data.name===this.messageName&&(e.stopPropagation(),(0,this.functionRefs[e.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0))},!0))}isTypedArray(e){return(0,et.j)(e)}}if((0,k.OB)().get("IS_BROWSER")){(0,k.OB)().setPlatform("browser",new en);try{q.registerManager(X.URL_SCHEME,new K)}catch(e){}try{q.registerManager(P.URL_SCHEME,new V)}catch(e){}}var er=n(20357);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ei={importFetch:()=>n(75410)};class ea{constructor(){this.util=n(48628),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=(0,k.OB)().global.fetch?(0,k.OB)().global.fetch(e,t):(null==i&&(i=ei.importFetch()),i(e,t))}now(){let e=er.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}(0,k.OB)().get("IS_NODE")&&!(0,k.OB)().get("IS_BROWSER")&&(0,k.OB)().setPlatform("node",new ea);var eo=n(84171),es=n(42460),eu=n(92932),el=n(44410),ec=n(85013);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(0,b.wv)();let ed={buffer:eo.f,cast:es.p,clone:eu.d,print:el.S};(0,ec.Vp)(ed);var eh=n(65139),ef=n(28796),ep=n(69750),em=n(74644),eg=n(13681),ex=n(97888),eb=n(33113),ey=n(56426),ev=n(86008);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ew=new Map,ek=new Map;class eC{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class eI{constructor(){this.classNameMap={}}static getMap(){return null==eI.instance&&(eI.instance=new eI),eI.instance}static register(e){eI.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function e$(e,t,n){(0,L.hu)(null!=e.className,()=>"Class being registered does not have the static className property defined."),(0,L.hu)("string"==typeof e.className,()=>"className is required to be a string, but got type "+typeof e.className),(0,L.hu)(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),void 0===t&&(t="Custom"),void 0===n&&(n=e.className);let r=t+">"+n;return eI.register(e),ew.set(r,e),ek.set(e,r),e}function eS(e){return ek.has(e)?ek.get(e):e.className}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eE extends eC{minimize(e,t=!1,n){let{value:r,grads:i}=this.computeGradients(e,n);if(null!=n){let e=n.map(e=>({name:e.name,tensor:i[e.name]}));this.applyGradients(e)}else this.applyGradients(i);return((0,eh.B9)(i),t)?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return(0,ey.pn)(e,t)}dispose(){null!=this.iterations_&&(0,eh.B9)(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:(0,ev.i)(this.iterations_,"int32")}}async getWeights(){throw Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(eE,Symbol.hasInstance,{value:e=>null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e_ extends eE{static get className(){return"Adadelta"}constructor(e,t,n=null){super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=b.BV.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let r=b.BV.registeredVariables[t];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:`${t}/accum_grad`,variable:(0,eh.lu)(()=>(0,eb.P)(r).variable(!1))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:`${t}/accum_var`,variable:(0,eh.lu)(()=>(0,eb.P)(r).variable(!1))});let i=Array.isArray(e)?e[n].tensor:e[t];if(null==i)return;let a=this.accumulatedGrads[n].variable,o=this.accumulatedUpdates[n].variable;(0,eh.lu)(()=>{let e=(0,ef.I)((0,em.d)(a,this.rho),(0,em.d)((0,ex.h)(i),1-this.rho)),t=(0,em.d)((0,ep.h)((0,eg._)((0,ef.I)(o,this.epsilon)),(0,eg._)((0,ef.I)(a,this.epsilon))),i),n=(0,ef.I)((0,em.d)(o,this.rho),(0,em.d)((0,ex.h)(t),1-this.rho));a.assign(e),o.assign(n);let s=(0,ef.I)((0,em.d)(t,-this.learningRate),r);r.assign(s)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&((0,eh.B9)(this.accumulatedGrads.map(e=>e.variable)),(0,eh.B9)(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){let e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){let t=(e=await this.extractIterations(e)).length/2;this.accumulatedGrads=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.accumulatedUpdates=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}var eT=n(17851);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eN extends eE{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let r=b.BV.registeredVariables[t];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:`${t}/accumulator`,variable:(0,eh.lu)(()=>(0,eT.h)(r.shape,this.initialAccumulatorValue).variable(!1))});let i=Array.isArray(e)?e[n].tensor:e[t];if(null==i)return;let a=this.accumulatedGrads[n].variable;(0,eh.lu)(()=>{let e=(0,ef.I)(a,(0,ex.h)(i));a.assign(e);let t=(0,ef.I)((0,em.d)((0,ep.h)(i,(0,eg._)((0,ef.I)(e,b.BV.backend.epsilon()))),-this.learningRate),r);r.assign(t)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&(0,eh.B9)(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),this.accumulatedGrads=e.map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}var eR=n(52952),eA=n(67435);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eF extends eE{static get className(){return"Adam"}constructor(e,t,n,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],(0,eh.lu)(()=>{this.accBeta1=(0,ev.i)(t).variable(),this.accBeta2=(0,ev.i)(n).variable()}),null==r&&(this.epsilon=b.BV.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);(0,eh.lu)(()=>{let n=(0,eA.l)(1,this.accBeta1),r=(0,eA.l)(1,this.accBeta2);t.forEach((t,i)=>{let a=b.BV.registeredVariables[t];null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:`${t}/m`,variable:(0,eh.lu)(()=>(0,eb.P)(a).variable(!1))}),null==this.accumulatedSecondMoment[i]&&(this.accumulatedSecondMoment[i]={originalName:`${t}/v`,variable:(0,eh.lu)(()=>(0,eb.P)(a).variable(!1))});let o=Array.isArray(e)?e[i].tensor:e[t];if(null==o)return;let s=this.accumulatedFirstMoment[i].variable,u=this.accumulatedSecondMoment[i].variable,l=(0,ef.I)((0,em.d)(s,this.beta1),(0,em.d)(o,1-this.beta1)),c=(0,ef.I)((0,em.d)(u,this.beta2),(0,em.d)((0,ex.h)(o),1-this.beta2)),d=(0,ep.h)(l,n),h=(0,ep.h)(c,r);s.assign(l),u.assign(c);let f=(0,ef.I)((0,em.d)((0,ep.h)(d,(0,ef.I)((0,eg._)(h),this.epsilon)),-this.learningRate),a);a.assign(f)}),this.accBeta1.assign((0,em.d)(this.accBeta1,this.beta1)),this.accBeta2.assign((0,em.d)(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&(0,eh.B9)(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedSecondMoment&&(0,eh.B9)(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),(0,eh.lu)(()=>{this.accBeta1.assign((0,eR.s)(this.beta1,this.iterations_+1)),this.accBeta2.assign((0,eR.s)(this.beta2,this.iterations_+1))});let t=e.length/2;this.accumulatedFirstMoment=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.accumulatedSecondMoment=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}var eO=n(5273),eB=n(41725);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eD extends eE{static get className(){return"Adamax"}constructor(e,t,n,r=null,i=0){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],(0,eh.lu)(()=>{this.iteration=(0,ev.i)(0).variable(),this.accBeta1=(0,ev.i)(t).variable()}),null==r&&(this.epsilon=b.BV.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);(0,eh.lu)(()=>{let n=(0,eA.l)(1,this.accBeta1),r=(0,ep.h)(-this.learningRate,(0,ef.I)((0,em.d)(this.iteration,this.decay),1));t.forEach((t,i)=>{let a=b.BV.registeredVariables[t];null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:`${t}/m`,variable:(0,eb.P)(a).variable(!1)}),null==this.accumulatedWeightedInfNorm[i]&&(this.accumulatedWeightedInfNorm[i]={originalName:`${t}/v`,variable:(0,eb.P)(a).variable(!1)});let o=Array.isArray(e)?e[i].tensor:e[t];if(null==o)return;let s=this.accumulatedFirstMoment[i].variable,u=this.accumulatedWeightedInfNorm[i].variable,l=(0,ef.I)((0,em.d)(s,this.beta1),(0,em.d)(o,1-this.beta1)),c=(0,em.d)(u,this.beta2),d=(0,eO.W)(o),h=(0,eB.g)(c,d);s.assign(l),u.assign(h);let f=(0,ef.I)((0,em.d)((0,ep.h)(r,n),(0,ep.h)(l,(0,ef.I)(h,this.epsilon))),a);a.assign(f)}),this.iteration.assign((0,ef.I)(this.iteration,1)),this.accBeta1.assign((0,em.d)(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&(0,eh.B9)(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedWeightedInfNorm&&(0,eh.B9)(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eP extends eE{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;let i=b.BV.registeredVariables[t];(0,eh.lu)(()=>{let e=(0,ef.I)((0,em.d)(this.c,r),i);i.assign(e)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=(0,eh.Cn)((0,ev.i)(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(0!==(e=await this.extractIterations(e)).length)throw Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eM extends eP{static get className(){return"Momentum"}constructor(e,t,n=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=(0,ev.i)(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let r=b.BV.registeredVariables[t];null==this.accumulations[n]&&(this.accumulations[n]={originalName:`${t}/momentum`,variable:(0,eh.lu)(()=>(0,eb.P)(r).variable(!1))});let i=this.accumulations[n].variable,a=Array.isArray(e)?e[n].tensor:e[t];null!=a&&(0,eh.lu)(()=>{let e;let t=(0,ef.I)((0,em.d)(this.m,i),a);e=this.useNesterov?(0,ef.I)((0,em.d)(this.c,(0,ef.I)(a,(0,em.d)(t,this.m))),r):(0,ef.I)((0,em.d)(this.c,t),r),i.assign(t),r.assign(e)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&(0,eh.B9)(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),this.accumulations=e.map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eV extends eE{static get className(){return"RMSProp"}constructor(e,t=.9,n=0,r=null,i=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,null==r&&(this.epsilon=b.BV.backend.epsilon()),null==e)throw Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let r=b.BV.registeredVariables[t];null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:`${t}/rms`,variable:(0,eh.lu)(()=>(0,eb.P)(r).variable(!1))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:`${t}/momentum`,variable:(0,eh.lu)(()=>(0,eb.P)(r).variable(!1))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:`${t}/mg`,variable:(0,eh.lu)(()=>(0,eb.P)(r).variable(!1))});let i=Array.isArray(e)?e[n].tensor:e[t];if(null==i)return;let a=this.accumulatedMeanSquares[n].variable,o=this.accumulatedMoments[n].variable;(0,eh.lu)(()=>{let e=(0,ef.I)((0,em.d)(a,this.decay),(0,em.d)((0,ex.h)(i),1-this.decay));if(this.centered){let t=this.accumulatedMeanGrads[n].variable,s=(0,ef.I)((0,em.d)(t,this.decay),(0,em.d)(i,1-this.decay)),u=(0,ep.h)((0,em.d)(i,this.learningRate),(0,eg._)((0,eA.l)(e,(0,ef.I)((0,ex.h)(s),this.epsilon)))),l=(0,ef.I)((0,em.d)(o,this.momentum),u);a.assign(e),t.assign(s),o.assign(l);let c=(0,eA.l)(r,l);r.assign(c)}else{let e=(0,ef.I)((0,em.d)(a,this.decay),(0,em.d)((0,ex.h)(i),1-this.decay)),t=(0,ef.I)((0,em.d)(o,this.momentum),(0,ep.h)((0,em.d)(i,this.learningRate),(0,eg._)((0,ef.I)(e,this.epsilon))));a.assign(e),o.assign(t);let n=(0,eA.l)(r,t);r.assign(n)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&(0,eh.B9)(this.accumulatedMeanSquares.map(e=>e.variable)),null!=this.accumulatedMeanGrads&&this.centered&&(0,eh.B9)(this.accumulatedMeanGrads.map(e=>e.variable)),null!=this.accumulatedMoments&&(0,eh.B9)(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=this.centered?e.length/3:e.length/2;this.accumulatedMeanSquares=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.accumulatedMoments=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let eL=[e_,eN,eF,eD,eM,eV,eP];function eW(e){return new Promise(e=>setTimeout(e)).then(e)}class eG{constructor(e){if(!(0,k.OB)().getBool("IS_BROWSER"))throw Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(eG.URL_SCHEME)&&(e=e.slice(eG.URL_SCHEME.length)),(null==e||0===e.length)&&(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}async save(e){if("undefined"==typeof document)throw Error("Browser downloads are not supported in this environment since `document` is not present");let t=R.w.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let t=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r=(0,$.Yd)(e,t),i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),a=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=i,await eW(()=>a.dispatchEvent(new MouseEvent("click"))),null!=e.weightData){let e=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;e.download=this.weightDataFileName,e.href=n,await eW(()=>e.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:(0,$.Q)(e)}}}}eG.URL_SCHEME="downloads://";class eU{constructor(e){if(null==e||e.length<1)throw Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{let n=new FileReader;n.onload=n=>{let r=JSON.parse(n.target.result),i=r.modelTopology;if(null==i){t(Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(null==r.weightsManifest){t(Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(0===this.weightsFiles.length){e({modelTopology:i});return}e((0,$.jN)(r,e=>this.loadWeights(e)))},n.onerror=e=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),n.readAsText(this.jsonFile)})}loadWeights(e){let t=[],n=[];for(let r of e)t.push(...r.weights),n.push(...r.paths);let r=this.checkManifestAndWeightFiles(e);return Promise.all(n.map(e=>this.loadWeightsFile(e,r[e]))).then(e=>[t,e])}loadWeightsFile(e,t){return new Promise((n,r)=>{let i=new FileReader;i.onload=e=>{n(e.target.result)},i.onerror=t=>r(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){let t=[],n=this.weightsFiles.map(e=>(0,$.EZ)(e.name)),r={};for(let i of e)i.paths.forEach(e=>{let i=(0,$.EZ)(e);if(-1!==t.indexOf(i))throw Error(`Duplicate file basename found in weights manifest: '${i}'`);if(t.push(i),-1===n.indexOf(i))throw Error(`Weight file with basename '${i}' is not provided.`);r[e]=this.weightsFiles[n.indexOf(i)]});if(t.length!==this.weightsFiles.length)throw Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}function ez(e){return new eU(e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eX(e,t,n,r){var i,a;(0,L.hu)(null!=e&&Array.isArray(e)&&e.length>0,()=>"promises must be a none empty array"),i=n=null==n?0:n,a=r=null==r?1:r,(0,L.hu)(i>=0&&i<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${i}`),(0,L.hu)(a>=0&&a<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${a}`),(0,L.hu)(a>=i,()=>`startFraction must be no more than endFraction, but got startFraction ${i} and endFraction ${a}`);let o=0;return Promise.all(e.map(i=>(i.then(i=>(t(n+ ++o/e.length*(r-n)),i)),i)))}S.registerSaveRouter(e=>(0,k.OB)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(eG.URL_SCHEME)?function(e="model"){return new eG(e)}(e.slice(eG.URL_SCHEME.length)):null);var eH=n(20404);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function eK(e,t){null==t&&(t={});let n=null==t.fetchFunc?(0,k.OB)().platform.fetch:t.fetchFunc,r=e.map(e=>n(e,t.requestInit,{isBinary:!0})),i=(null==t.onProgress?await Promise.all(r):await eX(r,t.onProgress,0,.5)).map(e=>e.arrayBuffer());return null==t.onProgress?await Promise.all(i):await eX(i,t.onProgress,.5,1)}async function eq(e,t="",n,r){return ej(e=>eK(e,{requestInit:r}))(e,t,n)}function ej(e){return async(t,n="",r)=>{let i=t.map(()=>!1),a={},o=null!=r?r.map(()=>!1):[],s=[];if(t.forEach((e,t)=>{let n=0;e.weights.forEach(e=>{let u="quantization"in e?e.quantization.dtype:e.dtype,l=eH.J[u]*L.NA(e.shape),c=()=>{i[t]=!0,null==a[t]&&(a[t]=[]),a[t].push({manifestEntry:e,groupOffset:n,sizeBytes:l})};null!=r?r.forEach((t,n)=>{t===e.name&&(c(),o[n]=!0)}):c(),s.push(e.name),n+=l})}),!o.every(e=>e)){let e=r.filter((e,t)=>!o[t]);throw Error(`Could not find weights in manifest with names: ${e.join(", ")}. 
Manifest JSON has weights with names: ${s.join(", ")}.`)}let u=i.reduce((e,t,n)=>(t&&e.push(n),e),[]),l=[];u.forEach(e=>{t[e].paths.forEach(e=>{let t=n+(n.endsWith("/")?"":"/")+e;l.push(t)})});let c=await e(l),d={},h=0;return u.forEach(e=>{let n=t[e].paths.length,r=new R.w(c.slice(h,h+n));a[e].forEach(e=>{let t=r.slice(e.groupOffset,e.groupOffset+e.sizeBytes),n=(0,$.dI)(t,[e.manifestEntry]);for(let e in n)d[e]=n[e]}),h+=n}),d}}class eY{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?((0,L.hu)("function"==typeof t.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=(0,k.OB)().platform.fetch,(0,L.hu)(null!=e&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&(0,L.hu)(2===e.length,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;let n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=(0,$.Yd)(e,n);if(t.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=e.weightData){let n=R.w.join(e.weightData);t.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}let i=await this.fetch(this.path,t);if(i.ok)return{modelArtifactsInfo:(0,$.Q)(e),responses:[i]};throw Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async loadModelJSON(){let e;let t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);try{e=await t.json()}catch(t){let e=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?e+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":e+=" Please make sure the server is serving valid JSON for this request.",Error(e)}let n=e.modelTopology,r=e.weightsManifest;if(null==n&&null==r)throw Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return e}async load(){if(this.loadOptions.streamWeights)return this.loadStream();let e=await this.loadModelJSON();return(0,$.jN)(e,e=>this.loadWeights(e))}async loadStream(){let e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=(0,$.hu)(e.weightsManifest);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:()=>(function(e,t){var n;let r;let i=null==t.fetchFunc?(0,k.OB)().platform.fetch:t.fetchFunc,a=0;return null===(n=t.onProgress)||void 0===n||n.call(t,0),new ReadableStream({pull:async n=>{for(var o;a<e.length;){r||(r=(await i(e[a],t.requestInit,{isBinary:!0})).body.getReader());let{done:s,value:u}=await r.read();if(s){a++,r=void 0,null===(o=t.onProgress)||void 0===o||o.call(t,a/e.length);continue}n.enqueue(u);return}n.close()}})})(t,this.loadOptions)})}async getWeightUrls(e){let[t,n]=function(e){let t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}(Array.isArray(this.path)?this.path[1]:this.path),r=this.weightPathPrefix||t,i=[],a=[];for(let t of e)for(let e of t.paths)null!=this.weightUrlConverter?a.push(this.weightUrlConverter(e)):i.push(r+e+n);return this.weightUrlConverter&&i.push(...await Promise.all(a)),i}async loadWeights(e){let t=await this.getWeightUrls(e);return[(0,$.hu)(e),await eK(t,this.loadOptions)]}}function eQ(e){return null!=e.match(eY.URL_SCHEME_REGEX)}eY.URL_SCHEME_REGEX=/^https?:\/\//;let eZ=(e,t)=>{if("undefined"==typeof fetch&&(null==t||null==t.fetchFunc));else if(Array.isArray(e)?e.every(e=>eQ(e)):eQ(e))return eJ(e,t);return null};function eJ(e,t){return new eY(e,t)}function e0(e,t){return eJ(e,t)}S.registerSaveRouter(eZ),S.registerLoadRouter(eZ);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e1{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class e2{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class e3{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function e4(e,t,n,r){let i=arguments;return new e3(e5(...i))}function e5(e,t,n,r){return 1!=arguments.length?(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new e1({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r})):null!=e.modelTopology||null!=e.weightSpecs?new e1(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new e1({modelTopology:e}))}function e8(e){return new e2(e)}function e9(e){return new e2(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e6=n(34950),e7=n(33229),te=n(3885),tt=n(73080),tn=n(33072);let tr=(0,tt.op)({confusionMatrix_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let r=(0,e6._1)(e,"labels","confusionMatrix"),i=(0,e6._1)(t,"predictions","confusionMatrix");L.hu(null==n||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),L.hu(1===r.rank,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),L.hu(1===i.rank,()=>`Expected the rank of predictions to be 1, but got ${i.rank}`),L.hu(r.shape[0]===i.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${i.shape[0]}. Labels and predictions should have the same number of elements.`),L.hu(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);let a=(0,te.l)((0,es.p)(r,"int32"),n),o=(0,te.l)((0,es.p)(i,"int32"),n),s=(0,tn.p)(a),u=(0,e7.O)(s,o);return(0,es.p)(u,"int32")}});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ti=n(87355),ta=n(89052),to=n(77413),ts=n(24395);let tu=!1;function tl(e,t=3){let n,r;if(t>4)throw Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw Error("pixels passed to tf.browser.fromPixels() can not be null");let i=!1,o=!1,s=!1,u=!1,l=!1,c=!1;if(e.data instanceof Uint8Array)i=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)o=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)s=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)u=!0;else if(null!=e.getContext)l=!0;else if("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap)c=!0;else throw Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);if(null!=(0,to.pI)(ta.eBW,b.BV.backendName))return b.BV.runKernel(ta.eBW,{pixels:e},{numChannels:t});let[d,h]=s?[e.videoWidth,e.videoHeight]:[e.width,e.height];if(l)n=e.getContext("2d").getImageData(0,0,d,h).data;else if(o||i)n=e.data;else if(u||s||c){if(null==a){if("undefined"==typeof document){if("undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof OffscreenCanvasRenderingContext2D)a=new OffscreenCanvas(1,1).getContext("2d");else throw Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.")}else a=document.createElement("canvas").getContext("2d",{willReadFrequently:!0})}a.canvas.width=d,a.canvas.height=h,a.drawImage(e,0,0,d,h),n=a.getImageData(0,0,d,h).data}if(4===t)r=new Int32Array(n);else{let e=d*h;r=new Int32Array(e*t);for(let i=0;i<e;i++)for(let e=0;e<t;++e)r[i*t+e]=n[4*i+e]}let f=[h,d,t];return(0,ts.w)(r,f,"int32")}async function tc(e,t=3){var n;let r=null;if((0,k.OB)().getBool("WRAP_TO_IMAGEBITMAP")&&"undefined"!=typeof window&&"undefined"!=typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(e instanceof ImageBitmap)&&null!=(n=e)&&0!==n.width&&0!==n.height&&!(null!=e&&e.data instanceof Uint8Array)){let t;try{t=await createImageBitmap(e,{premultiplyAlpha:"none"})}catch(e){t=null}r=null!=t&&t.width===e.width&&t.height===e.height?t:e}else r=e;return tl(r,t)}function td(e){if(2!==e.rank&&3!==e.rank)throw Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);let t=2===e.rank?1:e.shape[2];if(t>4||2===t)throw Error(`toPixels only supports depth of size 1, 3 or 4 but got ${t}`);if("float32"!==e.dtype&&"int32"!==e.dtype)throw Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`)}async function th(e,t){let n=(0,e6._1)(e,"img","toPixels");if(!(e instanceof ec.es)){let e=n;n=(0,es.p)(e,"int32"),e.dispose()}td(n);let[r,i]=n.shape.slice(0,2),a=2===n.rank?1:n.shape[2],o=await n.data(),s="float32"===n.dtype?255:1,u=new Uint8ClampedArray(i*r*4);for(let e=0;e<r*i;++e){let t=[0,0,0,255];for(let r=0;r<a;r++){let i=o[e*a+r];if("float32"===n.dtype){if(i<0||i>1)throw Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${i}.`)}else if("int32"===n.dtype&&(i<0||i>255))throw Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${i}.`);1===a?(t[0]=i*s,t[1]=i*s,t[2]=i*s):t[r]=i*s}let r=4*e;u[r+0]=Math.round(t[0]),u[r+1]=Math.round(t[1]),u[r+2]=Math.round(t[2]),u[r+3]=Math.round(t[3])}if(null!=t){tu||null==(0,to.pI)(ta.hGc,b.BV.backendName)||(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),tu=!0),t.width=i,t.height=r;let e=t.getContext("2d"),n=new ImageData(u,i,r);e.putImageData(n,0,0)}return n!==e&&n.dispose(),u}function tf(e,t,n){let r=(0,e6._1)(e,"img","draw");if(!(e instanceof ec.es)){let e=r;r=(0,es.p)(e,"int32"),e.dispose()}td(r),function(e){let t=(null==e?void 0:e.alpha)||1;if(t>1||t<0)throw Error(`Alpha value ${t} is suppoed to be in range [0 - 1].`)}(null==n?void 0:n.imageOptions);let i={image:r};b.BV.runKernel(ta.hGc,i,{canvas:t,options:n})}let tp=(0,tt.op)({fromPixels_:tl});function tm(e,t){let n=e.shape.length,r=t.shape.length;if(n<1)throw Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if("int32"!==t.dtype)throw Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(0===(0,L.NA)(e.shape))throw Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);let i=t.shape,a=i[i.length-1],o=1;for(let e=0;e<i.length-1;++e)o*=i[e];let s=e.shape,u=i.slice();u.pop();let l=1;for(let e=a;e<n;++e)l*=s[e],u.push(s[e]);let c=[...(0,L.e3)(e.shape).map(e=>e/l),1].slice(0,a);return[u,o,l,c]}var tg=n(35900),tx=n(74021),tb=n(66484),ty=n(3165);let tv=.1;function tw(e,t,n){return null==n&&(n=tk()),tC(e,t,(e,t)=>tE(e,t,n))}function tk(){return 32===b.BV.backend.floatPrecision()?.001:tv}function tC(e,t,n){let r=!0;if(((0,ty.isTypedArray)(e)||(0,ty.isTypedArray)(t))&&(r=!1),(0,ty.isTypedArray)(e)&&(0,ty.isTypedArray)(t)&&(r=!0),r){let n=e.constructor.name,r=t.constructor.name;if(n!==r)throw Error(`Arrays are of different type. Actual: ${n}. Expected: ${r}`)}if(Array.isArray(e)&&Array.isArray(t)){let n=(0,e6.C)(e),r=(0,e6.C)(t);if(!(0,L.cO)(n,r))throw Error(`Arrays have different shapes. Actual: [${n}]. Expected: [${r}]`)}let i=(0,ty.isTypedArray)(e)?e:(0,ty.flatten)(e),a=(0,ty.isTypedArray)(t)?t:(0,ty.flatten)(t);if(i.length!==a.length)throw Error(`Arrays have different lengths actual: ${i.length} vs expected: ${a.length}.
Actual:   ${i}.
Expected: ${a}.`);for(let e=0;e<a.length;++e){let t=i[e],r=a[e];if(!n(t,r))throw Error(`Arrays differ: actual[${e}] = ${t}, expected[${e}] = ${r}.
Actual:   ${i}.
Expected: ${a}.`)}"undefined"!=typeof expect&&expect().nothing()}function tI(e,t){e().then(()=>t.fail(),()=>t()),"undefined"!=typeof expect&&expect().nothing()}function t$(e,t){let n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return(0,L.HD)(e)||(0,L.HD)(e[0])||(0,L.HD)(t)||(0,L.HD)(t[0])?tC(e,n,(e,t)=>e==t):tC(e,t,(e,t)=>tE(e,t,0))}function tS(e,t,n){if(null==n&&(n=tk()),!tE(e,t,n))throw Error(`Numbers differ: actual === ${e}, expected === ${t}`);"undefined"!=typeof expect&&expect().nothing()}function tE(e,t,n){return!(isFinite(e)||isFinite(t))||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function t_(e,t,n){for(let r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw Error(`Value out of range:${e[r]} low: ${t}, high: ${n}`)}function tT(e,t){let n=new Float32Array(e),r=new Float32Array(t);if(n.length!==r.length)throw Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let e=0;e<r.length;e++)if(n[e]!==r[e])throw Error(`Expected ArrayBuffer value at ${e} to be ${r[e]} but got ${n[e]} instead`)}function tN(e){let t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise(e=>{t.addEventListener("loadeddata",n=>e(t)),t.load()})}async function tR(e){await e.play(),"requestVideoFrameCallback"in e&&await new Promise(t=>{e.requestVideoFrameCallback(t)})}/** @license See the LICENSE file. */let tA="4.20.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tF{static sgd(e){return new eP(e)}static momentum(e,t,n=!1){return new eM(e,t,n)}static rmsprop(e,t=.9,n=0,r=null,i=!1){return new eV(e,t,n,r,i)}static adam(e=.001,t=.9,n=.999,r=null){return new eF(e,t,n,r)}static adadelta(e=.001,t=.95,n=null){return new e_(e,t,n)}static adamax(e=.002,t=.9,n=.999,r=null,i=0){return new eD(e,t,n,r,i)}static adagrad(e,t=.1){return new eN(e,t)}}var tO=n(77297),tB=n(82487),tD=n(33671);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let tP=tF,tM="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:e=>e();function tV(){return new Promise(e=>tM(()=>e()))}var tL=n(63584);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tW(e,t){let n=e[0].length;e.forEach((e,t)=>{L.hu(e.length===n,()=>`Error in concat${n}D: rank of tensors[${t}] must be the same as the rank of the rest (${n})`)}),L.hu(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);let r=e[0];e.forEach((e,i)=>{for(let a=0;a<n;a++)L.hu(a===t||e[a]===r[a],()=>`Error in concat${n}D: Shape of tensors[${i}] (${e}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function tG(e,t){let n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}var tU=n(72235),tz=n(78984);function tX(e,t,n){let r=[];if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let i=1;i<n.length;++i){let a=n[i],o=r[r.length-n.length+i],s=r[o];if(a>=0){if(s>=0){if(s!==a)throw Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${i+e}] = ${a} but shape[${i+e}] = ${s}`)}else r[o]=a}}return r}function tH(e){let t={FIRST_DIM_SIZE:s.FIRST_DIM_SIZE,VALUE_ROWIDS:s.VALUE_ROWIDS,ROW_LENGTHS:s.ROW_LENGTHS,ROW_SPLITS:s.ROW_SPLITS,ROW_LIMITS:s.ROW_LIMITS,ROW_STARTS:s.ROW_STARTS},n=[];for(let r of e)if(r in t)n.push(t[r]);else break;return n}function tK(e){return 0===e.length?0:e[0]===s.FIRST_DIM_SIZE?e.length-1:e.length}function tq(e,t){if(null==e||null==t)return;let n=e.length,r=t.length;if(n>=r)throw Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(n,r-1);++i){let n=e[i],r=t[i+1];if(n>=0&&r>=0&&1!==n&&n!==r)throw Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${i-e.length}] = ${n} but ragged tensor input.flatValues.shape[${i-e.length}] = ${r}`)}}(o=s||(s={}))[o.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",o[o.VALUE_ROWIDS=1]="VALUE_ROWIDS",o[o.ROW_LENGTHS=2]="ROW_LENGTHS",o[o.ROW_SPLITS=3]="ROW_SPLITS",o[o.ROW_LIMITS=4]="ROW_LIMITS",o[o.ROW_STARTS=5]="ROW_STARTS";/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let tj=30;function tY(e){return e<=tj?e:(0,L.jP)(e,Math.floor(Math.sqrt(e)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tQ(e,t,n){return[n*("number"==typeof e?e:e[0]),t*("number"==typeof e?e:e[1])]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tZ(e,t,n,r=!0){let i=[];if(r)(i=i.concat(t.slice(0))).push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);let n=t.length;for(let r=0;r<n;++r)i=i.concat([e[r+1]/t[r],t[r]]);i=i.concat(e.slice(n+1))}return i}function tJ(e,t,n=!0){let r=[];if(n){r.push(t);for(let n=t+1;n<e;++n)n<=2*t?(r.push(n),r.push(n-(t+1))):r.push(n)}else{let n=[],i=[];for(let r=1;r<e;++r)r>=2*t+1||r%2==1?i.push(r):n.push(r);r.push(...n),r.push(0),r.push(...i)}return r}function t0(e,t,n,r=!0){let i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(let n=1;n<e.length;++n)n<=t.length?r?i.push(t[n-1]*e[n]):i.push(e[n]/t[n-1]):i.push(e[n]);return i}function t1(e,t){let n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function t2(e,t,n){let r=e.slice(0,1);for(let i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}var t3=n(35437);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let t4=.3275911,t5=.254829592,t8=-.284496736,t9=1.421413741,t6=-1.453152027,t7=1.061405429;var ne=n(45641);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nt(e,t){if(e.length!==t.length)throw Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);let n=new Float32Array(2*e.length);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function nn(e){let t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function nr(e){let t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let t=0;t<e.length;t+=4)n[Math.floor(t/4)]=e[t],r[Math.floor(t/4)]=e[t+1];return{real:n,imag:r}}function ni(e){let t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let t=2;t<e.length;t+=4)n[Math.floor(t/4)]=e[t],r[Math.floor(t/4)]=e[t+1];return{real:n,imag:r}}function na(e,t){return{real:e[2*t],imag:e[2*t+1]}}function no(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function ns(e,t){let n=new Float32Array(e/2),r=new Float32Array(e/2);for(let i=0;i<Math.ceil(e/2);i++){let a=(t?2:-2)*Math.PI*(i/e);n[i]=Math.cos(a),r[i]=Math.sin(a)}return{real:n,imag:r}}function nu(e,t,n){let r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}let nl=/->/g;function nc(e,t){let n=((e=e.replace(/\s/g,"")).length-e.replace(nl,"").length)/2;if(n<1)throw Error("Equations without an arrow are not supported.");if(n>1)throw Error('Equation must contain exactly one arrow ("->").');let[r,i]=e.split("->");(0,L.hu)(-1===r.indexOf("..."),()=>'The ellipsis notation ("...") is not supported yet.');let a=r.split(","),o=a.length;if(t!==o)throw Error(`Expected ${o} input tensors, received ${t}`);if(o>2)throw Error("Support for more than 2 input tensors is not implemented yet.");let s=[];for(let e=0;e<i.length;++e){let t=i[e];if(!a.some(e=>-1!==e.indexOf(t)))throw Error(`Output subscripts contain the label ${t} not present in the input subscripts.`);-1===s.indexOf(t)&&s.push(t)}for(let e=0;e<r.length;++e){let t=r[e];-1===s.indexOf(t)&&","!==t&&s.push(t)}let u=Array(a.length);for(let e=0;e<o;++e){if(new Set(a[e].split("")).size!==a[e].length)throw Error(`Found duplicate axes in input component ${a[e]}. Support for duplicate axes in input is not implemented yet.`);u[e]=[];for(let t=0;t<a[e].length;++t)u[e].push(s.indexOf(a[e][t]))}let l=s.length,c=i.length,d=[];for(let e=c;e<l;++e)d.push(e);return{allDims:s,summedDims:d,idDims:u}}function nd(e,t){let n=Array(e);n.fill(-1);for(let e=0;e<t.length;++e)n[t[e]]=e;let r=[];for(let t=0;t<e;++t)-1===n[t]&&r.push(t);return{permutationIndices:n=n.filter(e=>-1!==e),expandDims:r}}function nh(e,t,n){let r=Array(e);for(let e=0;e<n.length;++e){let i=n[e].shape;for(let n=0;n<t[e].length;++n)void 0===r[t[e][n]]?r[t[e][n]]=i[n]:(0,L.hu)(r[t[e][n]]===i[n],()=>`Expected dimension ${r[t[e][n]]} at axis ${n} of input shaped ${JSON.stringify(i)}, but got dimension ${i[n]}`)}}function nf(e,t){let n=[],r=0;0===e.length&&e.push(-1),r=e.length+1;for(let e=0;e<r;++e)n.push([]);let i=[];for(let r=0;r<e.length;++r)for(let a of function(e,t){let n=[];for(let r=0;r<e.length;++r)(0===e[r].length||-1!==e[r].indexOf(t)||-1===t)&&n.push(r);return n}(t,e[r]))-1===i.indexOf(a)&&(n[r].push(a),i.push(a));return{path:e,steps:n}}function np(e){return e.every((e,t)=>e===t)}function nm(e,t,n=0){let r=[];if("number"==typeof t)(0,L.hu)(e.shape[n]%t==0,()=>"Number of splits must evenly divide the axis."),r=Array(t).fill(e.shape[n]/t);else{let i=t.reduce((e,t)=>(-1===t&&(e+=1),e),0);(0,L.hu)(i<=1,()=>"There should be only one negative value in split array.");let a=t.indexOf(-1);if(-1!==a){let r=t.reduce((e,t)=>t>0?e+t:e);t[a]=e.shape[n]-r}(0,L.hu)(e.shape[n]===t.reduce((e,t)=>e+t),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ng(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function nx(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function nb(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ny(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function nv(e,t){return`size ${e} must be non-negative, not ${t}`}function nw(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function nk(e,t){let n=(0,L.NA)(e),r=(0,L.NA)(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${e} outputShape= ${t}`}function nC(e,t){let n=(0,L.NA)(e),r=(0,L.NA)(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${e} outputShape=${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nI(){return"segment ids must be >= 0"}function n$(){return"segment ids are not increasing"}function nS(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function nE(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n_(e,t){let n,r=!1;for(e<=tj?(n=e,r=!0):n=(0,L.jP)(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=(0,L.jP)(e,n+1);return n}function nT(e,t,n){let r=[],i=e.length;for(let a=0;a<i;a++)a!==t?r.push(e[a]):r.push(n);return r}function nN(e,t,n,r){let i=t.shape.length,a=e.shape.length;if(0!==r&&(r<-i||r>i))throw Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>a)throw Error(`batchDims (${r}) must be less than rank(x) (
    ${a}).`);if(n<r)throw Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let n=0;n<r;++n)if(e.shape[n]!==t.shape[n])throw Error(`x.shape[${n}]: ${e.shape[n]} should be equal to indices.shape[${n}]: ${t.shape[n]}.`);let o=e.shape[n],s=[],u=1,l=1,c=1;for(let t=0;t<r;++t)s.push(e.shape[t]),u*=e.shape[t];for(let t=r;t<n;t++)s.push(e.shape[t]),l*=e.shape[t];for(let e=r;e<i;e++)s.push(t.shape[e]);for(let t=n+1;t<a;t++)s.push(e.shape[t]),c*=e.shape[t];return{batchSize:u,sliceSize:c,outerSize:l,dimSize:o,outputShape:s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nR(e){try{return e.map(e=>(0,ty.decodeString)(e))}catch(e){throw Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function nA(e){return e.map(e=>(0,ty.encodeString)(e))}var nF=n(69154),nO=n(35736),nB=n(22884);!/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(){for(let e of eL)e$(e)}()},56566:function(e,t,n){"use strict";n.d(t,{w:function(){return i}});var r=n(3165);class i{static join(e){return new i(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,null==e||(e instanceof Array||(e=[e]),0===(e=e.map(e=>r.isTypedArray(e)?e.buffer:e)).length))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){let r=e[n];n!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);let i=t+r.byteLength;this.shards.push({buffer:r,start:t,end:i}),t=i}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(0===this.shards.length||(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),(t=Math.min(this.byteLength,t))<=e))return new ArrayBuffer(0);let n=this.findShardForByte(e);if(-1===n)throw Error(`Could not find start shard for byte ${e}`);let r=new ArrayBuffer(t-e),i=new Uint8Array(r),a=0;for(let r=n;r<this.shards.length;r++){let n=this.shards[r],o=e+a-n.start,s=a,u=Math.min(t,n.end)-n.start,l=new Uint8Array(n.buffer,o,u-o);if(i.set(l,s),a+=l.length,t<n.end)break}return r}findShardForByte(e){if(0===this.shards.length||e<0||e>=this.byteLength)return -1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;let n=function(e,t){let n=0,r=e.length;for(;n<=r;){let i=Math.floor((r-n)/2)+n,a=t(e[i]);if(0===a)return i;a<0?r=i:n=i+1}return -1}(this.shards,t);return -1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}},71149:function(e,t,n){"use strict";n.d(t,{EZ:function(){return k},JY:function(){return w},Q:function(){return S},Yd:function(){return C},_n:function(){return y},dI:function(){return h},hu:function(){return E},jN:function(){return $},ji:function(){return I},n7:function(){return v},r:function(){return g},yz:function(){return d}});var r=n(42812),i=n(4194),a=n(31143),o=n(20404),s=n(56566),u=n(65139),l=n(3845),c=n(86300).Buffer;async function d(e,t){let n=[],r=[],i=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);for(let a=0;a<i.length;++a){let o=i[a],s=Array.isArray(e)?e[a].tensor:e[o];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw Error(`Unsupported dtype in weight '${o}': ${s.dtype}`);let u={name:o,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){let e=new Promise(async e=>{let t=await s.bytes(),n=new Uint8Array(t.reduce((e,t)=>e+t.length,0)+4*t.length),r=0;for(let e=0;e<t.length;e++){let i=t[e],a=new Uint8Array(new Uint32Array([i.length]).buffer);n.set(a,r),r+=4,n.set(i,r),r+=i.length}e(n)});r.push(e)}else r.push(s.data());null!=t&&(u.group=t),n.push(u)}return{data:function(e){if(null===e)throw Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0,n=[];e.forEach(e=>{if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw Error(`Unsupported TypedArray subtype: ${e.constructor.name}`)});let r=new Uint8Array(t),i=0;return n.forEach(e=>{r.set(new Uint8Array(e.buffer),i),i+=e.byteLength}),r.buffer}(await Promise.all(r)),specs:n}}function h(e,t){let n=new s.w(e),r={},i=0;for(let e of t){let t=function(e,t){let n;let r=(0,a.NA)(e.shape);if("quantization"in e){let t=e.quantization;n=o.J[t.dtype]}else if("string"===e.dtype){let e=0;for(let n=0;n<r;n++)e+=4+new Uint32Array(t(e,e+4))[0];return e}else n=o.J[e.dtype];return r*n}(e,(e,t)=>n.slice(i+e,i+t));r[e.name]=p(e,n.slice(i,i+t)),i+=t}return r}async function f(e,t){let n;let r=(0,a.NA)(e.shape);if("quantization"in e){let t=e.quantization;n=o.J[t.dtype]}else if("string"===e.dtype){let e=0;for(let n=0;n<r;n++)e+=4+new Uint32Array(await t(e,e+4))[0];return e}else n=o.J[e.dtype];return r*n}function p(e,t){let n;let s=e.name,u=e.dtype,l=e.shape,c=(0,a.NA)(l),d=0;if("quantization"in e){let r=e.quantization;if("uint8"===r.dtype||"uint16"===r.dtype){if(!("min"in r&&"scale"in r))throw Error(`Weight ${e.name} with quantization ${r.dtype} doesn't have corresponding metadata min and scale.`)}else if("float16"===r.dtype){if("float32"!==u)throw Error(`Weight ${e.name} is quantized with ${r.dtype} which only supports weights of type float32 not ${u}.`)}else throw Error(`Weight ${e.name} has unknown quantization dtype ${r.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);let i=o.J[r.dtype],a="uint8"===r.dtype?new Uint8Array(t):new Uint16Array(t);if("float32"===u){if("uint8"===r.dtype||"uint16"===r.dtype){n=new Float32Array(a.length);for(let e=0;e<a.length;e++){let t=a[e];n[e]=t*r.scale+r.min}}else if("float16"===r.dtype)n=(function(){let e=function(){let e=e=>{let t=e<<13,n=0;for(;(8388608&t)==0;)n-=8388608,t<<=1;return(t&=-8388609)|(n+=947912704)},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let e=1024;e<2048;e++)t[e]=939524096+(e-1024<<13);return t}(),t=function(){let e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}(),n=function(){let e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return r=>{let i=new ArrayBuffer(4*r.length),a=new Uint32Array(i);for(let i=0;i<r.length;i++){let o=r[i],s=e[n[o>>10]+(1023&o)]+t[o>>10];a[i]=s}return new Float32Array(i)}})()(a);else throw Error(`Unsupported quantization type ${r.dtype} for weight type float32.`)}else if("int32"===u){if("uint8"!==r.dtype&&"uint16"!==r.dtype)throw Error(`Unsupported quantization type ${r.dtype} for weight type int32.`);n=new Int32Array(a.length);for(let e=0;e<a.length;e++){let t=a[e];n[e]=Math.round(t*r.scale+r.min)}}else throw Error(`Unsupported dtype in weight '${s}': ${u}`);d+=c*i}else if("string"===u){let r=(0,a.NA)(e.shape);n=[];for(let e=0;e<r;e++){let e=new Uint32Array(t.slice(d,d+4))[0];d+=4;let r=new Uint8Array(t.slice(d,d+e));n.push(r),d+=e}}else{let e=o.J[u];if("float32"===u)n=new Float32Array(t);else if("int32"===u)n=new Int32Array(t);else if("bool"===u)n=new Uint8Array(t);else if("complex64"===u){n=new Float32Array(t);let e=new Float32Array(n.length/2),a=new Float32Array(n.length/2);for(let t=0;t<e.length;t++)e[t]=n[2*t],a[t]=n[2*t+1];let o=(0,i.X)(e,l,"float32"),s=(0,i.X)(a,l,"float32"),u=(0,r.P)(o,s);return o.dispose(),s.dispose(),u}else throw Error(`Unsupported dtype in weight '${s}': ${u}`);d+=c*e}return(0,i.X)(n,l,u)}async function m(e,t,n){let r=new Uint8Array(t);for(;r.byteLength<n;){let{done:t,value:i}=await e.read();if(t&&null==i){let e=n-r.byteLength;throw Error(`Reader is done but ${e} bytes are still expected`)}let a=new Uint8Array(r.length+i.byteLength);a.set(r,0),a.set(new Uint8Array(i),r.length),r=a}return r.buffer}async function g(e,t){let n={},r=e.getReader(),i=new ArrayBuffer(0);for(let e of t){let t=await f(e,async(e,t)=>(i=await m(r,i,t)).slice(e,t)),o=(i=await m(r,i,t)).slice(0,t);i=i.slice(t);let s=p(e,o);if(n[e.name]=s,"webgpu"===(0,u.N_)()){let e=(0,u.y3)();"uploadToGPU"in e&&(0,a.NA)(s.shape)>=(0,l.OB)().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&e.uploadToGPU(s.dataId)}}return n}let x=void 0!==c&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function b(e){return x?c.byteLength(e,"utf8"):new Blob([e]).size}function y(e){if(x)return c.from(e).toString("base64");let t=new Uint8Array(e),n="";for(let e=0,r=t.length;e<r;e++)n+=String.fromCharCode(t[e]);return btoa(n)}function v(e){if(x){let t=c.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}let t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;++e)n.set([t.charCodeAt(e)],e);return n.buffer}function w(e){return s.w.join(e)}function k(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);let t=e.split("/");return t[t.length-1]}function C(e,t){let n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function I(e,t,n){let r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(r.initializerSignature=e.initializerSignature),r}async function $(e,t){let n,r;return null!=e.weightsManifest&&([n,r]=await t(e.weightsManifest)),I(e,n,r)}function S(e){if(e.modelTopology instanceof ArrayBuffer)throw Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:b(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:b(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new s.w(e.weightData).byteLength}}function E(e){let t=[];for(let n of e)t.push(...n.weights);return t}},20404:function(e,t,n){"use strict";n.d(t,{J:function(){return r}});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let r={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}},89052:function(e,t,n){"use strict";n.d(t,{$HU:function(){return tu},$g6:function(){return et},$w:function(){return j},Acj:function(){return eb},BMI:function(){return eW},BiW:function(){return ta},Byc:function(){return W},CAk:function(){return eE},CQl:function(){return ti},D2d:function(){return tV},DlI:function(){return tn},Eh3:function(){return A},FKq:function(){return tN},G3Y:function(){return tJ},GBy:function(){return tR},Gcp:function(){return tO},HEU:function(){return er},HZH:function(){return tc},Hhh:function(){return eM},Hmb:function(){return th},IKK:function(){return l},IMb:function(){return v},J$2:function(){return e$},J7O:function(){return eV},J_u:function(){return ew},JhU:function(){return x},Kgp:function(){return e7},L8s:function(){return tF},Ly9:function(){return $},M2y:function(){return h},MIZ:function(){return tj},MRv:function(){return tT},MZg:function(){return eF},NEP:function(){return eo},NZg:function(){return eZ},O3z:function(){return tB},OAf:function(){return ez},OR:function(){return eh},OU7:function(){return eX},OV7:function(){return eU},Omj:function(){return ei},Oyi:function(){return m},PYm:function(){return eR},PhF:function(){return tk},QCc:function(){return g},QRR:function(){return z},Qg5:function(){return ev},QiL:function(){return e9},Qvg:function(){return t2},RFZ:function(){return E},ROF:function(){return b},RQH:function(){return t$},RuY:function(){return t4},SIB:function(){return tv},SX0:function(){return en},SYM:function(){return r},SbG:function(){return tm},SpW:function(){return a},T0n:function(){return X},TQc:function(){return tA},TR1:function(){return L},ToN:function(){return t1},Tr8:function(){return tK},Uyb:function(){return ed},VGw:function(){return i},Vbg:function(){return eQ},VcC:function(){return U},VfG:function(){return eA},Vn9:function(){return Z},W0H:function(){return e4},XDQ:function(){return t3},XLW:function(){return w},XkS:function(){return tH},Xze:function(){return s},Y0y:function(){return eu},YFo:function(){return es},YoZ:function(){return eL},ZbH:function(){return eT},ZjV:function(){return tM},Zz9:function(){return N},_JP:function(){return tz},_V0:function(){return t7},_Yw:function(){return tf},_k9:function(){return y},_tC:function(){return tL},a5O:function(){return t_},aJk:function(){return d},avt:function(){return ek},b9H:function(){return t9},bK0:function(){return tW},bV0:function(){return tb},c17:function(){return eq},cWu:function(){return tQ},cie:function(){return H},cye:function(){return e3},dDz:function(){return tr},deh:function(){return ec},dpD:function(){return td},e07:function(){return tx},e0R:function(){return tG},e6w:function(){return to},e7N:function(){return e_},eBW:function(){return t8},eEB:function(){return S},eZ0:function(){return eP},ekb:function(){return Q},gJX:function(){return _},h8e:function(){return t5},hCO:function(){return I},hGc:function(){return J},hdR:function(){return ea},i5y:function(){return tE},iHb:function(){return G},iJz:function(){return ey},iWB:function(){return eC},iZT:function(){return ex},ik2:function(){return M},jMg:function(){return p},jQk:function(){return tU},jQs:function(){return eY},jeX:function(){return ef},kU:function(){return eN},kpP:function(){return t0},kuV:function(){return e0},luS:function(){return ne},lyA:function(){return e6},mKl:function(){return tg},mTV:function(){return eG},mc4:function(){return V},mhS:function(){return F},mm_:function(){return o},n9L:function(){return tY},nhH:function(){return tD},nr8:function(){return tw},o0g:function(){return tt},o2y:function(){return P},oFR:function(){return tC},oHH:function(){return ee},oT6:function(){return u},p2w:function(){return tI},p4S:function(){return Y},pe_:function(){return te},q1x:function(){return eg},q2K:function(){return eK},q8u:function(){return ej},qCd:function(){return eB},qIC:function(){return eD},qWM:function(){return e5},qi_:function(){return em},qkr:function(){return tl},qw7:function(){return f},r7n:function(){return eI},s1s:function(){return tX},sEM:function(){return tq},sHE:function(){return ep},sJF:function(){return c},sL$:function(){return K},usg:function(){return t6},uv1:function(){return e2},vFR:function(){return eH},vtC:function(){return eS},vwp:function(){return el},w3H:function(){return tP},w6g:function(){return eO},wUP:function(){return O},wYB:function(){return tS},wYn:function(){return eJ},we_:function(){return e8},wm:function(){return B},wx7:function(){return tZ},x12:function(){return D},xJR:function(){return ts},xQA:function(){return ty},xnO:function(){return T},y7R:function(){return q},yQU:function(){return e1},yj2:function(){return R},zbQ:function(){return tp},zvY:function(){return C},zws:function(){return k}});let r="Abs",i="Acos",a="Acosh",o="Add",s="AddN",u="All",l="Any",c="ArgMax",d="ArgMin",h="Asin",f="Asinh",p="Atan",m="Atanh",g="Atan2",x="AvgPool",b="AvgPoolGrad",y="AvgPool3D",v="AvgPool3DGrad",w="BatchMatMul",k="BatchToSpaceND",C="Bincount",I="BitwiseAnd",$="BroadcastTo",S="BroadcastArgs",E="Cast",_="Ceil",T="ClipByValue",N="Complex",R="ComplexAbs",A="Concat",F="Conv2D",O="Conv2DBackpropFilter",B="Conv2DBackpropInput",D="Conv3D",P="Conv3DBackpropFilterV2",M="Conv3DBackpropInputV2",V="Cos",L="Cosh",W="Cumprod",G="Cumsum",U="CropAndResize",z="DenseBincount",X="DepthToSpace",H="DepthwiseConv2dNative",K="DepthwiseConv2dNativeBackpropFilter",q="DepthwiseConv2dNativeBackpropInput",j="Diag",Y="Dilation2D",Q="Dilation2DBackpropInput",Z="Dilation2DBackpropFilter",J="Draw",ee="RealDiv",et="Einsum",en="Elu",er="EluGrad",ei="Erf",ea="Equal",eo="Exp",es="ExpandDims",eu="Expm1",el="FFT",ec="Fill",ed="FlipLeftRight",eh="Floor",ef="FloorDiv",ep="FusedBatchNorm",em="GatherV2",eg="GatherNd",ex="Greater",eb="GreaterEqual",ey="Identity",ev="IFFT",ew="Imag",ek="IsFinite",eC="IsInf",eI="IsNan",e$="LeakyRelu",eS="Less",eE="LessEqual",e_="LinSpace",eT="Log",eN="Log1p",eR="LogicalAnd",eA="LogicalNot",eF="LogicalOr",eO="LogicalXor",eB="LogSoftmax",eD="LowerBound",eP="LRN",eM="LRNGrad",eV="MatrixBandPart",eL="Max",eW="Maximum",eG="MaxPool",eU="MaxPoolGrad",ez="MaxPool3D",eX="MaxPool3DGrad",eH="MaxPoolWithArgmax",eK="Mean",eq="Min",ej="Minimum",eY="MirrorPad",eQ="Mod",eZ="Multinomial",eJ="Multiply",e0="Neg",e1="NotEqual",e2="NonMaxSuppressionV3",e3="NonMaxSuppressionV4",e4="NonMaxSuppressionV5",e5="OnesLike",e8="OneHot",e9="Pack",e6="PadV2",e7="Pool",te="Pow",tt="Prelu",tn="Prod",tr="RaggedGather",ti="RaggedRange",ta="RaggedTensorToTensor",to="Range",ts="Real",tu="Reciprocal",tl="Relu",tc="Reshape",td="ResizeNearestNeighbor",th="ResizeNearestNeighborGrad",tf="ResizeBilinear",tp="ResizeBilinearGrad",tm="Relu6",tg="Reverse",tx="Round",tb="Rsqrt",ty="ScatterNd",tv="TensorScatterUpdate",tw="SearchSorted",tk="Select",tC="Selu",tI="Slice",t$="Sin",tS="Sinh",tE="Sign",t_="Sigmoid",tT="Softplus",tN="Sqrt",tR="Sum",tA="SpaceToBatchND",tF="SplitV",tO="Softmax",tB="SparseFillEmptyRows",tD="SparseReshape",tP="SparseSegmentMean",tM="SparseSegmentSum",tV="SparseToDense",tL="SquaredDifference",tW="Square",tG="StaticRegexReplace",tU="StridedSlice",tz="StringNGrams",tX="StringSplit",tH="StringToHashBucketFast",tK="Sub",tq="Tan",tj="Tanh",tY="Tile",tQ="TopK",tZ="Transform",tJ="Transpose",t0="Unique",t1="Unpack",t2="UnsortedSegmentSum",t3="UpperBound",t4="ZerosLike",t5="Step",t8="FromPixels",t9="RotateWithOffset",t6="_FusedMatMul",t7="FusedConv2D",ne="FusedDepthwiseConv2D"},77413:function(e,t,n){"use strict";n.d(t,{Li:function(){return h},T3:function(){return m},bt:function(){return p},nE:function(){return f},pI:function(){return u},tr:function(){return c},uk:function(){return l},wC:function(){return d}});var r=n(3845),i=n(16588),a=n(45641);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o=(0,i.R)("kernelRegistry",()=>new Map),s=(0,i.R)("gradRegistry",()=>new Map);function u(e,t){let n=g(e,t);return o.get(n)}function l(e){return s.get(e)}function c(e){let t=o.entries(),n=[];for(;;){let{done:r,value:i}=t.next();if(r)break;let[a,o]=i,[s]=a.split("_");s===e&&n.push(o)}return n}function d(e){let{kernelName:t,backendName:n}=e,r=g(t,n);o.has(r)&&a.Z(`The kernel '${t}' for backend '${n}' is already registered`),o.set(r,e)}function h(e){let{kernelName:t}=e;s.has(t)&&(0,r.OB)().getBool("DEBUG")&&a.Z(`Overriding the gradient for '${t}'`),s.set(t,e)}function f(e,t){let n=g(e,t);if(!o.has(n))throw Error(`The kernel '${e}' for backend '${t}' is not registered`);o.delete(n)}function p(e){if(!s.has(e))throw Error(`The gradient '${e}' for backend is not registered`);s.delete(e)}function m(e,t){c(e).forEach(e=>{d(Object.assign({},e,{backendName:t}))})}function g(e,t){return`${t}_${e}`}},45641:function(e,t,n){"use strict";n.d(t,{Z:function(){return i},c:function(){return a}});var r=n(3845);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(...e){(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||console.warn(...e)}function a(...e){(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||console.log(...e)}},5273:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({abs_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","abs");return"complex64"===t.dtype?r.BV.runKernel(i.yj2,{x:t}):r.BV.runKernel(i.SYM,{x:t})}})},90514:function(e,t,n){"use strict";n.d(t,{K:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({acos_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","acos");return r.BV.runKernel(i.VGw,{x:t})}})},28246:function(e,t,n){"use strict";n.d(t,{_:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({acosh_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","acosh");return r.BV.runKernel(i.SpW,{x:t})}})},28796:function(e,t,n){"use strict";n.d(t,{I:function(){return s}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950);let s=(0,n(73080).op)({add_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","add"),s=(0,o._1)(t,"b","add");[n,s]=(0,a.makeTypesMatch)(n,s);let u={a:n,b:s};return r.BV.runKernel(i.mm_,u)}})},48172:function(e,t,n){"use strict";n.d(t,{$:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({all_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=null,n=!1){let o=(0,a._1)(e,"x","all","bool");return r.BV.runKernel(i.oT6,{x:o},{axis:t,keepDims:n})}})},4541:function(e,t,n){"use strict";n.d(t,{Y:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({any_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=null,n=!1){let o=(0,a._1)(e,"x","any","bool");return r.BV.runKernel(i.IKK,{x:o},{axis:t,keepDims:n})}})},89487:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({argMax_:/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=0){let n=(0,a._1)(e,"x","argMax");return r.BV.runKernel(i.sJF,{x:n},{axis:t})}})},80099:function(e,t,n){"use strict";n.d(t,{v:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({argMin_:/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=0){let n=(0,a._1)(e,"x","argMin");return r.BV.runKernel(i.aJk,{x:n},{axis:t})}})},73978:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({asin_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","asin");return r.BV.runKernel(i.M2y,{x:t})}})},64277:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({asinh_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","asinh");return r.BV.runKernel(i.qw7,{x:t})}})},97410:function(e,t,n){"use strict";n.d(t,{z:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({atan_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","atan");return r.BV.runKernel(i.jMg,{x:t})}})},51562:function(e,t,n){"use strict";n.d(t,{f:function(){return s}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950);let s=(0,n(73080).op)({atan2_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","atan2"),s=(0,o._1)(t,"b","atan2");[n,s]=(0,a.makeTypesMatch)(n,s);let u={a:n,b:s};return r.BV.runKernel(i.QCc,u)}})},98813:function(e,t,n){"use strict";n.d(t,{C:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({atanh_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","atanh");return r.BV.runKernel(i.Oyi,{x:t})}})},4121:function(e,t,n){"use strict";n.d(t,{w:function(){return d}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143),s=n(42460),u=n(72235),l=n(73080),c=n(70934);let d=(0,l.op)({avgPool_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,l,d){let h=(0,a._1)(e,"x","avgPool","float32");o.hu(u.jT(n,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`);let f=h,p=!1;3===h.rank&&(p=!0,f=(0,c.X)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),o.hu(4===f.rank,()=>`Error in avgPool: x must be rank 4 but got rank ${f.rank}.`),u.m("avgPool",l,d);let m={x:f},g=r.BV.runKernel(i.JhU,m,{filterSize:t,strides:n,pad:l,dimRoundingMode:d});return(g=(0,s.p)(g,h.dtype),p)?(0,c.X)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},63584:function(e,t,n){"use strict";n.d(t,{LJ:function(){return c},Q3:function(){return l},Vh:function(){return a},YB:function(){return i},kz:function(){return o},lB:function(){return u},rv:function(){return s},sY:function(){return d}});var r=n(31143);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function a(e,t,n){let r=e.length+t.length,i=[],a=0,o=0;for(let s=0;s<r;s++)-1===n.indexOf(s)?i.push(e[a++]):i.push(t[o++]);return i}function o(e,t){let n=[],r=e.length;for(let i=0;i<r;i++)-1===t.indexOf(i)&&n.push(e[i]);return[n,t.map(t=>e[t])]}function s(e,t){return a(e,t.map(e=>1),t)}function u(e,t,n){r.hu(i(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function l(e,t){if(i(e,t))return null;let n=[];for(let r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach(e=>n.push(e)),n}function c(e){return e.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function d(e,t){let n=[];for(let r=t-e;r<t;++r)n.push(r);return n}},85860:function(e,t,n){"use strict";n.d(t,{E:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143);let s=(0,n(73080).op)({batchToSpaceND_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let s=(0,a._1)(e,"x","batchToSpaceND"),u=t.reduce((e,t)=>e*t);return o.hu(s.rank>=1+t.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${t.length}`),o.hu(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),o.hu(s.shape[0]%u==0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${u}`),r.BV.runKernel(i.zws,{x:s},{blockShape:t,crops:n})}})},95837:function(e,t,n){"use strict";n.d(t,{t:function(){return u}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143),s=n(70934);let u=(0,n(73080).op)({batchNorm_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,u,l,c){let d,h;null==c&&(c=.001);let f=(0,a._1)(e,"x","batchNorm"),p=(0,a._1)(t,"mean","batchNorm"),m=(0,a._1)(n,"variance","batchNorm");null!=l&&(d=(0,a._1)(l,"scale","batchNorm")),null!=u&&(h=(0,a._1)(u,"offset","batchNorm")),o.hu(p.rank===m.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),o.hu(null==h||p.rank===h.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),o.hu(null==d||p.rank===d.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let g={x:0===f.rank||1===f.rank?(0,s.X)(f,[1,1,1,f.size]):2===f.rank?(0,s.X)(f,[1,1,f.shape[0],f.shape[1]]):3===f.rank?(0,s.X)(f,[1,f.shape[0],f.shape[1],f.shape[2]]):f,scale:d,offset:h,mean:p,variance:m},x={varianceEpsilon:c},b=r.BV.runKernel(i.sHE,g,x);return(0,s.X)(b,f.shape)}})},69580:function(e,t,n){"use strict";n.d(t,{U:function(){return c}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143),s=n(92932),u=n(73080),l=n(70934);let c=(0,u.op)({broadcastTo_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,a._1)(e,"broadcastTo","x"),u=n.shape;if((0,o.Mu)(t),t.length<n.rank)throw Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){let e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=(0,l.X)(n,e)}let c=n.shape,d=Array.from(t);for(let e=t.length-1;e>=0;e--)if(c[e]===t[e])d[e]=1;else if(1!==n.shape[e])throw Error(`broadcastTo(): [${u}] cannot be broadcast to [${t}].`);if(0===d.map((e,t)=>e>1?t:-1).filter(e=>e>=0).length)return(0,s.d)(n);let h={x:n};return r.BV.runKernel(i.n9L,h,{reps:d})}})},87355:function(e,t,n){"use strict";/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r(e,t){let n=e.length,r=[];for(let i=0;i<n;i++){let a=n-1-i,o=e[a]||1;(t[t.length-1-i]||1)>1&&1===o&&r.unshift(a)}return r}function i(e,t){let n=[];for(let r=0;r<t.length;r++){let i=e[e.length-r-1],a=t.length-r-1,o=t[a];(null==i||1===i&&o>1)&&n.unshift(a)}return n}function a(e,t){let n=Math.max(e.length,t.length),r=Array(n);for(let i=0;i<n;i++){let a=e[e.length-i-1];null==a&&(a=1);let o=t[t.length-i-1];if(null==o&&(o=1),1===a)r[n-i-1]=o;else if(1===o)r[n-i-1]=a;else if(a!==o)throw Error(`Operands could not be broadcast together with shapes ${e} and ${t}.`);else r[n-i-1]=a}return r}n.r(t),n.d(t,{assertAndGetBroadcastShape:function(){return a},getBroadcastDims:function(){return r},getReductionAxes:function(){return i}})},84171:function(e,t,n){"use strict";n.d(t,{f:function(){return a}});var r=n(85013),i=n(31143);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(e,t="float32",n){return t=t||"float32",i.Mu(e),new r.YD(e,t,n)}},42460:function(e,t,n){"use strict";n.d(t,{p:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143);let s=(0,n(73080).op)({cast_:/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,a._1)(e,"x","cast");if(!o.LP(t))throw Error(`Failed to cast to unknown dtype ${t}`);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw Error("Only strings can be casted to strings");return r.BV.runKernel(i.RFZ,{x:n},{dtype:t})}})},37003:function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({ceil_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","ceil","float32");return r.BV.runKernel(i.gJX,{x:t})}})},24737:function(e,t,n){"use strict";n.d(t,{i:function(){return u}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143),s=n(17851);let u=(0,n(73080).op)({clipByValue_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let u=(0,a._1)(e,"x","clipByValue");return(o.hu(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)?(0,s.h)(u.shape,t,u.dtype):r.BV.runKernel(i.xnO,{x:u},{clipValueMin:t,clipValueMax:n})}})},92932:function(e,t,n){"use strict";n.d(t,{d:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({clone_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","clone","string_or_numeric");return r.BV.runKernel(i.iJz,{x:t})}})},42812:function(e,t,n){"use strict";n.d(t,{P:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143);let s=(0,n(73080).op)({complex_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,a._1)(e,"real","complex"),s=(0,a._1)(t,"imag","complex");return o.k5(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`),r.BV.runKernel(i.Zz9,{real:n,imag:s})}})},66598:function(e,t,n){"use strict";n.d(t,{z:function(){return u}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143),s=n(92932);let u=(0,n(73080).op)({concat_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=0){(0,o.hu)(e.length>=1,()=>"Pass at least one tensor to concat");let n=(0,a.sI)(e,"tensors","concat","string_or_numeric");return("complex64"===n[0].dtype&&n.forEach(e=>{if("complex64"!==e.dtype)throw Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${e.dtype}. `)}),1===n.length)?(0,s.d)(n[0]):r.BV.runKernel(i.Eh3,n,{axis:t})}})},77620:function(e,t,n){"use strict";n.d(t,{P:function(){return l}});var r=n(34950),i=n(31143),a=n(7289),o=n(72235),s=n(73080),u=n(70934);let l=(0,s.op)({conv1d_:function(e,t,n,s,l="NWC",c=1,d){let h=(0,r._1)(e,"x","conv1d"),f=(0,r._1)(t,"filter","conv1d"),p=h,m=!1;2===h.rank&&(m=!0,p=(0,u.X)(h,[1,h.shape[0],h.shape[1]])),i.hu(3===p.rank,()=>`Error in conv1d: input must be rank 3, but got rank ${p.rank}.`),i.hu(3===f.rank,()=>`Error in conv1d: filter must be rank 3, but got rank ${f.rank}.`),o.m("conv1d",s,d),i.hu(p.shape[2]===f.shape[1],()=>`Error in conv1d: depth of input (${p.shape[2]}) must match input depth for filter ${f.shape[1]}.`),i.hu(o.jT(n,c),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${c}'`),i.hu(o.U3(c),()=>"Error in conv1D: Dilated rates should be larger than 0."),i.hu(o.U3(n),()=>"Error in conv1D: Stride should be larger than 0."),i.hu("NWC"===l,()=>`Error in conv1d: got dataFormat of ${l} but only NWC is currently supported.`);let g=(0,u.X)(f,[1,f.shape[0],f.shape[1],f.shape[2]]),x=(0,u.X)(p,[p.shape[0],1,p.shape[1],p.shape[2]]),b=(0,a.T)(x,g,[1,n],s,"NHWC",[1,c],d);return m?(0,u.X)(b,[b.shape[2],b.shape[3]]):(0,u.X)(b,[b.shape[0],b.shape[2],b.shape[3]])}})},7289:function(e,t,n){"use strict";n.d(t,{T:function(){return c}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143),s=n(72235),u=n(73080),l=n(70934);let c=(0,u.op)({conv2d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,u,c="NHWC",d=[1,1],h){let f=(0,a._1)(e,"x","conv2d","float32"),p=(0,a._1)(t,"filter","conv2d","float32"),m=f,g=!1;3===f.rank&&(g=!0,m=(0,l.X)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),o.hu(4===m.rank,()=>`Error in conv2d: input must be rank 4, but got rank ${m.rank}.`),o.hu(4===p.rank,()=>`Error in conv2d: filter must be rank 4, but got rank ${p.rank}.`),s.m("conv2d",u,h);let x="NHWC"===c?m.shape[3]:m.shape[1];o.hu(x===p.shape[2],()=>`Error in conv2d: depth of input (${x}) must match input depth for filter ${p.shape[2]}.`),o.hu(s.jT(n,d),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${d}'`),o.hu(s.U3(d),()=>"Error in conv2D: Dilated rates should be larger than 0."),o.hu(s.U3(n),()=>"Error in conv2D: Strides should be larger than 0.");let b={x:m,filter:p},y=r.BV.runKernel(i.mhS,b,{strides:n,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h});return g?(0,l.X)(y,[y.shape[1],y.shape[2],y.shape[3]]):y}})},65714:function(e,t,n){"use strict";n.d(t,{p:function(){return l}});var r=n(58520),i=n(89052),a=n(31143),o=n(72235),s=n(73080),u=n(70934);let l=(0,s.op)({conv2DBackpropFilter_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,s,l,c="NHWC",d){let h=e;3===e.rank&&(h=(0,u.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let f=t;3===f.rank&&(f=(0,u.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]])),a.hu(4===h.rank,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${h.shape}.`),a.hu(4===f.rank,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${f.shape}.`),a.hu(4===n.length,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);let p="NHWC"===c?h.shape[3]:h.shape[1],m="NHWC"===c?f.shape[3]:f.shape[1];a.hu(p===n[2],()=>`Error in conv2dDerFilter: depth of input ${p}) must match input depth in filter (${n[2]}.`),a.hu(m===n[3],()=>`Error in conv2dDerFilter: depth of dy (${m}) must match output depth for filter (${n[3]}).`),o.m("conv2dDerFilter",l,d);let g={x:h,dy:f};return r.BV.runKernel(i.wUP,g,{strides:s,pad:l,dataFormat:c,dimRoundingMode:d,filterShape:n})}})},43447:function(e,t,n){"use strict";n.d(t,{_:function(){return l}});var r=n(58520),i=n(89052),a=n(31143),o=n(72235),s=n(73080),u=n(70934);let l=(0,s.op)({conv2DBackpropInput_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,s,l,c="NHWC",d){a.hu(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let h=e,f=t,p=!1;3===t.rank&&(p=!0,f=(0,u.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]),h=[1,e[0],e[1],e[2]]),a.hu(4===h.length,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${h.length}.`),a.hu(4===f.rank,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${f.rank}`),a.hu(4===n.rank,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);let m="NHWC"===c?h[3]:h[1],g="NHWC"===c?f.shape[3]:f.shape[1];a.hu(m===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${m}) must match input depth for filter ${n.shape[2]}.`),a.hu(g===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${g}) must match output depth for filter ${n.shape[3]}.`),o.m("conv2dDerInput",l,d);let x={dy:f,filter:n},b={strides:s,pad:l,dataFormat:c,dimRoundingMode:d,inputShape:h},y=r.BV.runKernel(i.wm,x,b);return p?(0,u.X)(y,[y.shape[1],y.shape[2],y.shape[3]]):y}})},27294:function(e,t,n){"use strict";n.d(t,{b:function(){return a}});var r=n(34950),i=n(43447);let a=(0,n(73080).op)({conv2dTranspose_:function(e,t,n,a,o,s){let u=(0,r._1)(e,"x","conv2dTranspose"),l=(0,r._1)(t,"filter","conv2dTranspose");return(0,i._)(n,u,l,a,o,"NHWC",s)}})},50375:function(e,t,n){"use strict";n.d(t,{_:function(){return u}});var r=n(58520),i=n(89052),a=n(31143),o=n(73080),s=n(70934);let u=(0,o.op)({conv3DBackpropInput_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,o,u){a.hu(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let l=e,c=t,d=!1;4===t.rank&&(d=!0,c=(0,s.X)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),l=[1,e[0],e[1],e[2],e[3]]);let h=l[4],f=c.shape[4];a.hu(5===l.length,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${l.length}.`),a.hu(5===c.rank,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${c.rank}`),a.hu(5===n.rank,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),a.hu(h===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${h}) must match input depth for filter ${n.shape[3]}.`),a.hu(f===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${f}) must match output depth for filter ${n.shape[4]}.`);let p={dy:c,filter:n},m={pad:u,strides:o,inputShape:l},g=r.BV.runKernel(i.ik2,p,m);return d?(0,s.X)(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}})},72235:function(e,t,n){"use strict";n.d(t,{I0:function(){return p},Ix:function(){return s},Rf:function(){return i},U3:function(){return g},Xw:function(){return a},aO:function(){return l},jT:function(){return m},jw:function(){return u},m:function(){return b},pl:function(){return o},sl:function(){return x}});var r=n(31143);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i(e,t,n,r,i="NHWC",a){let o=[...t,e[3]];return s(e,o,n,a,r,null,null,x(i))}function a(e,t,n,r,i,a,o="channelsLast"){let u;let[l,d]=c(t);if("channelsLast"===o)u=[l,d,e[3],e[3]];else if("channelsFirst"===o)u=[l,d,e[1],e[1]];else throw Error(`Unknown dataFormat ${o}`);return s(e,u,n,r,i,a,!1,o)}function o(e,t,n,r,i,a,o="NDHWC"){let s,l;let[c,h,f]=d(t);if("NDHWC"===o)l="channelsLast",s=[c,h,f,e[4],e[4]];else if("NCDHW"===o)l="channelsFirst",s=[c,h,f,e[1],e[1]];else throw Error(`Unknown dataFormat ${o}`);return u(e,s,n,r,i,!1,l,a)}function s(e,t,n,r,i,a,o=!1,s="channelsLast"){let u,[d,p,m,g]=[-1,-1,-1,-1];if("channelsLast"===s)[d,p,m,g]=e;else if("channelsFirst"===s)[d,g,p,m]=e;else throw Error(`Unknown dataFormat ${s}`);let[x,b,,y]=t,[v,w]=c(n),[k,C]=c(r),I=h(x,k),$=h(b,C),{padInfo:S,outHeight:E,outWidth:_}=function(e,t,n,r,i,a,o,s,u){let c,d,h;if("number"==typeof e){let i=0===e?"VALID":"NUMBER";c={top:e,bottom:e,left:e,right:e,type:i};let o=function(e,t,n,r,i){null==r&&(r=l(e,t,n));let a=e[0],o=e[1];return[f((a-t+2*r)/n+1,i),f((o-t+2*r)/n+1,i)]}([t,n],a,r,e,s);d=o[0],h=o[1]}else if("same"===e){let e=Math.max(0,((d=Math.ceil(t/r))-1)*r+a-t),s=Math.max(0,((h=Math.ceil(n/i))-1)*i+o-n),u=Math.floor(e/2),l=Math.floor(s/2);c={top:u,bottom:e-u,left:l,right:s-l,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},d=Math.ceil((t-a+1)/r),h=Math.ceil((n-o+1)/i);else if("object"==typeof e){let l="channelsLast"===u?e[1][0]:e[2][0],p="channelsLast"===u?e[1][1]:e[2][1],m="channelsLast"===u?e[2][0]:e[3][0],g="channelsLast"===u?e[2][1]:e[3][1];c={top:l,bottom:p,left:m,right:g,type:0===l&&0===p&&0===m&&0===g?"VALID":"EXPLICIT"},d=f((t-a+l+p)/r+1,s),h=f((n-o+m+g)/i+1,s)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:c,outHeight:d,outWidth:h}}(i,p,m,v,w,I,$,a,s),T=o?y*g:y;return"channelsFirst"===s?u=[d,T,E,_]:"channelsLast"===s&&(u=[d,E,_,T]),{batchSize:d,dataFormat:s,inHeight:p,inWidth:m,inChannels:g,outHeight:E,outWidth:_,outChannels:T,padInfo:S,strideHeight:v,strideWidth:w,filterHeight:x,filterWidth:b,effectiveFilterHeight:I,effectiveFilterWidth:$,dilationHeight:k,dilationWidth:C,inShape:e,outShape:u,filterShape:t}}function u(e,t,n,r,i,a=!1,o="channelsLast",s){let u,[c,p,m,g,x]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[c,p,m,g,x]=e;else if("channelsFirst"===o)[c,x,p,m,g]=e;else throw Error(`Unknown dataFormat ${o}`);let[b,y,v,,w]=t,[k,C,I]=d(n),[$,S,E]=d(r),_=h(b,$),T=h(y,S),N=h(v,E),{padInfo:R,outDepth:A,outHeight:F,outWidth:O}=function(e,t,n,r,i,a,o,s,u,c,d){let h,p,m,g;if("valid"===e&&(e=0),"number"==typeof e){let x=0===e?"VALID":"NUMBER";h={top:e,bottom:e,left:e,right:e,front:e,back:e,type:x};let b=function(e,t,n,r,i,a){null==i&&(i=l(e,t[0],r[0]));let o=[0,0,0,1];for(let n=0;n<3;n++)e[n]+2*i>=t[n]&&(o[n]=f((e[n]-t[n]+2*i)/r[n]+1,a));return o}([t,n,r,1],[s,u,c],0,[i,a,o],e,d);p=b[0],m=b[1],g=b[2]}else if("same"===e){let e=((p=Math.ceil(t/i))-1)*i+s-t,l=((m=Math.ceil(n/a))-1)*a+u-n,d=((g=Math.ceil(r/o))-1)*o+c-r,f=Math.floor(e/2),x=Math.floor(l/2),b=Math.floor(d/2);h={top:x,bottom:l-x,left:b,right:d-b,front:f,back:e-f,type:"SAME"}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:h,outDepth:p,outHeight:m,outWidth:g}}(i,p,m,g,k,C,I,_,T,N,s),B=a?w*x:w;return"channelsFirst"===o?u=[c,B,A,F,O]:"channelsLast"===o&&(u=[c,A,F,O,B]),{batchSize:c,dataFormat:o,inDepth:p,inHeight:m,inWidth:g,inChannels:x,outDepth:A,outHeight:F,outWidth:O,outChannels:B,padInfo:R,strideDepth:k,strideHeight:C,strideWidth:I,filterDepth:b,filterHeight:y,filterWidth:v,effectiveFilterDepth:_,effectiveFilterHeight:T,effectiveFilterWidth:N,dilationDepth:$,dilationHeight:S,dilationWidth:E,inShape:e,outShape:u,filterShape:t}}function l(e,t,n,r=1){let i=h(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function c(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function d(e){return"number"==typeof e?[e,e,e]:e}function h(e,t){return t<=1?e:e+(e-1)*(t-1)}function f(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw Error(`Unknown roundingMode ${t}`)}}function p(e){let[t,n,r]=c(e);return 1===t&&1===n&&1===r}function m(e,t){return p(e)||p(t)}function g(e){return c(e).every(e=>e>0)}function x(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw Error(`Unknown dataFormat ${e}`)}function b(e,t,n){if(null!=n){if("string"==typeof t)throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if("number"==typeof t)r.hu(r.GN(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if("object"==typeof t)t.forEach(t=>{t.forEach(t=>{r.hu(r.GN(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}},66292:function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({cos_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","cos","float32");return r.BV.runKernel(i.mc4,{x:t})}})},45094:function(e,t,n){"use strict";n.d(t,{f:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({cosh_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","cosh","float32");return r.BV.runKernel(i.TR1,{x:t})}})},96951:function(e,t,n){"use strict";n.d(t,{$:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({cumprod_:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=0,n=!1,o=!1){let s=(0,a._1)(e,"x","cumprod");return r.BV.runKernel(i.Byc,{x:s},{axis:t,exclusive:n,reverse:o})}})},82062:function(e,t,n){"use strict";n.d(t,{z:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({cumsum_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=0,n=!1,o=!1){let s=(0,a._1)(e,"x","cumsum");return r.BV.runKernel(i.iHb,{x:s},{axis:t,exclusive:n,reverse:o})}})},42580:function(e,t,n){"use strict";n.d(t,{n:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143);let s=(0,n(73080).op)({depthToSpace_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n="NHWC"){let s=(0,a._1)(e,"x","depthToSpace","float32"),u="NHWC"===n?s.shape[1]:s.shape[2],l="NHWC"===n?s.shape[2]:s.shape[3],c="NHWC"===n?s.shape[3]:s.shape[1];return o.hu(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),o.hu(u*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${u} and ${t}  for depthToSpace with input shape
    ${s.shape}`),o.hu(l*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${l} and ${t} for depthToSpace with input shape
        ${s.shape}`),o.hu(c%(t*t)==0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${c} for depthToSpace with input shape ${s.shape}`),r.BV.runKernel(i.T0n,{x:s},{blockSize:t,dataFormat:n})}})},86075:function(e,t,n){"use strict";n.d(t,{B:function(){return c}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143),s=n(72235),u=n(73080),l=n(70934);let c=(0,u.op)({depthwiseConv2d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,u,c="NHWC",d=[1,1],h){let f=(0,a._1)(e,"x","depthwiseConv2d","float32"),p=(0,a._1)(t,"filter","depthwiseConv2d","float32"),m=f,g=!1;3===f.rank&&(g=!0,m=(0,l.X)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),o.hu(4===m.rank,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${m.rank}.`),o.hu(4===p.rank,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`);let x="NHWC"===c?m.shape[3]:m.shape[1];o.hu(x===p.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${x}) must match the inChannels dimension in filter ${p.shape[2]}.`),s.m("depthwiseConv2d",u,h);let b={x:m,filter:p},y=r.BV.runKernel(i.cie,b,{strides:n,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h});return g?(0,l.X)(y,[y.shape[1],y.shape[2],y.shape[3]]):y}})},91224:function(e,t,n){"use strict";n.d(t,{z:function(){return s}});var r=n(58520),i=n(89052),a=n(73080),o=n(70934);let s=(0,a.op)({depthwiseConv2dNativeBackpropFilter_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,a,s,u=[1,1],l){let c=e;3===e.rank&&(c=(0,o.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let d=t;3===d.rank&&(d=(0,o.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let h={x:c,dy:d};return r.BV.runKernel(i.sL$,h,{strides:a,pad:s,dimRoundingMode:l,dilations:u,filterShape:n})}})},15187:function(e,t,n){"use strict";n.d(t,{v:function(){return s}});var r=n(58520),i=n(89052),a=n(73080),o=n(70934);let s=(0,a.op)({depthwiseConv2dNativeBackpropInput_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,a,s,u=[1,1],l){let c=t,d=!1;3===t.rank&&(d=!0,c=(0,o.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let h={dy:c,filter:n},f=r.BV.runKernel(i.y7R,h,{strides:a,pad:s,dimRoundingMode:l,dilations:u,inputShape:e});return d?(0,o.X)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}})},82795:function(e,t,n){"use strict";n.d(t,{W:function(){return l}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143),s=n(73080),u=n(70934);let l=(0,s.op)({dilation2d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,s,l=[1,1],c="NHWC"){let d=(0,a._1)(e,"x","dilation2d"),h=(0,a._1)(t,"filter","dilation2d");o.hu(3===d.rank||4===d.rank,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${d.rank}.`),o.hu(3===h.rank,()=>`Error in dilation2d: filter must be rank 3, but got rank ${h.rank}.`),o.hu("NHWC"===c,()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${c}`);let f=d,p=!1;3===d.rank&&(f=(0,u.X)(d,[1,d.shape[0],d.shape[1],d.shape[2]]),p=!0),o.hu(f.shape[3]===h.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${f.shape[3]} vs ${h.shape[2]}`);let m={x:f,filter:h},g=r.BV.runKernel(i.p4S,m,{strides:n,pad:s,dilations:l});return p?(0,u.X)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},69750:function(e,t,n){"use strict";n.d(t,{h:function(){return u}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950),s=n(27873);let u=(0,n(73080).op)({div_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","div"),u=(0,o._1)(t,"b","div");if([n,u]=(0,a.makeTypesMatch)(n,u),"int32"===n.dtype&&"int32"===u.dtype)return(0,s.q)(n,u);let l={a:n,b:u};return r.BV.runKernel(i.oHH,l,{})}})},76532:function(e,t,n){"use strict";n.d(t,{N:function(){return c}});var r=n(66484),i=n(34950),a=n(69750),o=n(31998),s=n(73080),u=n(9670),l=n(33113);let c=(0,s.op)({divNoNan_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,i._1)(e,"a","div"),s=(0,i._1)(t,"b","div");[n,s]=(0,r.makeTypesMatch)(n,s);let c=(0,a.h)(n,s),d=(0,l.P)(c),h=(0,o.D)(s,d);return(0,u.a)(h,d,c)}})},27397:function(e,t,n){"use strict";n.d(t,{A:function(){return u}});var r=n(34950),i=n(31143),a=n(33229),o=n(73080),s=n(70934);let u=(0,o.op)({dot_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,r._1)(e,"t1","dot"),o=(0,r._1)(t,"t2","dot");i.hu((1===n.rank||2===n.rank)&&(1===o.rank||2===o.rank),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${o.rank}.`);let u=1===n.rank?n.size:n.shape[1],l=1===o.rank?o.size:o.shape[0];if(i.hu(u===l,()=>`Error in dot: inner dimensions of inputs must match, but got ${u} and ${l}.`),1===n.rank&&1===o.rank){let e=(0,s.X)(n,[1,-1]),t=(0,s.X)(o,[-1,1]),r=(0,a.O)(e,t);return(0,s.X)(r,[])}if(1===n.rank&&2===o.rank){let e=(0,s.X)(n,[1,-1]),t=(0,s.X)(o,[o.shape[0],o.shape[1]]),r=(0,a.O)(e,t);return(0,s.X)(r,[r.size])}if(2===n.rank&&1===o.rank){let e=(0,s.X)(o,[-1,1]),t=(0,a.O)(n,e);return(0,s.X)(t,[t.size])}{let e=(0,s.X)(o,[o.shape[0],o.shape[1]]);return(0,a.O)(n,e)}}})},36394:function(e,t,n){"use strict";n.d(t,{p:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({elu_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","elu","float32");return r.BV.runKernel(i.SX0,{x:t})}})},31998:function(e,t,n){"use strict";n.d(t,{D:function(){return u}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950),s=n(87355);let u=(0,n(73080).op)({equal_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","equal","string_or_numeric"),u=(0,o._1)(t,"b","equal","string_or_numeric");[n,u]=(0,a.makeTypesMatch)(n,u),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);let l={a:n,b:u};return r.BV.runKernel(i.hdR,l)}})},30886:function(e,t,n){"use strict";n.d(t,{q:function(){return u}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143),s=n(42460);let u=(0,n(73080).op)({erf_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","erf");o.hu("int32"===t.dtype||"float32"===t.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===t.dtype&&(t=(0,s.p)(t,"float32"));let n={x:t};return r.BV.runKernel(i.Omj,n)}})},56237:function(e,t,n){"use strict";n.d(t,{d:function(){return i}});var r=n(59181);let i=(0,n(73080).op)({euclideanNorm_:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=null,n=!1){return(0,r.K)(e,"euclidean",t,n)}})},96197:function(e,t,n){"use strict";n.d(t,{Q:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({exp_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","exp");return r.BV.runKernel(i.NEP,{x:t})}})},68569:function(e,t,n){"use strict";n.d(t,{d:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143);let s=(0,n(73080).op)({expandDims_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=0){let n=(0,a._1)(e,"x","expandDims","string_or_numeric");return o.hu(t<=n.rank,()=>"Axis must be <= rank of the tensor"),r.BV.runKernel(i.YFo,{input:n},{dim:t})}})},76074:function(e,t,n){"use strict";n.d(t,{t:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({expm1_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","expm1");return r.BV.runKernel(i.Y0y,{x:t})}})},17851:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var r=n(58520),i=n(89052),a=n(31143);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o(e,t,n){(0,a.Mu)(e),n=n||(0,a.D2)(t);let o={shape:e,value:t,dtype:n};return r.BV.runKernel(i.deh,{},o)}},62114:function(e,t,n){"use strict";n.d(t,{G:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({floor_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","floor","float32");return r.BV.runKernel(i.OR,{x:t})}})},27873:function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950);let s=(0,n(73080).op)({floorDiv_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","floorDiv"),s=(0,o._1)(t,"b","floorDiv");[n,s]=(0,a.makeTypesMatch)(n,s);let u={a:n,b:s};return r.BV.runKernel(i.jeX,u)}})},78984:function(e,t,n){"use strict";n.d(t,{Fr:function(){return p},QH:function(){return g},pf:function(){return m},uy:function(){return x}});var r=n(87355),i=n(36394),a=n(3725),o=n(74644),s=n(55676),u=n(71579),l=n(18820),c=n(70934),d=n(51417),h=n(26449),f=n(43174);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return(0,o.d)(e,(0,h.N)(t));throw Error(`Cannot compute gradient for fused activation ${n}.`)}function m(e,t){let n=t,i=r.getReductionAxes(e.shape,t.shape);return i.length>0&&(n=(0,f.S)(n,i)),(0,c.X)(n,e.shape)}function g(e,t,n,r){if("linear"===t)return e;if("relu"===t)return(0,u.U)(e);if("elu"===t)return(0,i.p)(e);if("relu6"===t)return(0,l.b)(e);if("prelu"===t)return(0,s.A)(e,n);if("leakyrelu"===t)return(0,a.h)(e,r);if("sigmoid"===t)return(0,d.X)(e);throw Error(`Unknown fused activation ${t}.`)}let x=(e,t)=>!(e>0)||"linear"===t},85134:function(e,t,n){"use strict";n.d(t,{I:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({gather_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n=0,o=0){let s=(0,a._1)(e,"x","gather"),u=(0,a._1)(t,"indices","gather","int32");return r.BV.runKernel(i.qi_,{x:s,indices:u},{axis:n,batchDims:o})}})},23553:function(e,t,n){"use strict";n.d(t,{p:function(){return u}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950),s=n(87355);let u=(0,n(73080).op)({greater_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","greater","string_or_numeric"),u=(0,o._1)(t,"b","greater","string_or_numeric");[n,u]=(0,a.makeTypesMatch)(n,u),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);let l={a:n,b:u};return r.BV.runKernel(i.iZT,l)}})},8939:function(e,t,n){"use strict";n.d(t,{b:function(){return u}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950),s=n(87355);let u=(0,n(73080).op)({greaterEqual_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","greaterEqual","string_or_numeric"),u=(0,o._1)(t,"b","greaterEqual","string_or_numeric");[n,u]=(0,a.makeTypesMatch)(n,u),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);let l={a:n,b:u};return r.BV.runKernel(i.Acj,l)}})},97318:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({imag_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"input","imag");return r.BV.runKernel(i.J_u,{input:t})}})},57554:function(e,t,n){"use strict";n.d(t,{I:function(){return l}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143),s=n(73080),u=n(70934);let l=(0,s.op)({resizeBilinear_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n=!1,s=!1){let l=(0,a._1)(e,"images","resizeBilinear");o.hu(3===l.rank||4===l.rank,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${l.rank}.`),o.hu(2===t.length,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),o.hu(!1===s||!1===n,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let c=l,d=!1;3===l.rank&&(d=!0,c=(0,u.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));let[]=t,h={images:c},f=r.BV.runKernel(i._Yw,h,{alignCorners:n,halfPixelCenters:s,size:t});return d?(0,u.X)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}})},37875:function(e,t,n){"use strict";n.d(t,{j:function(){return l}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143),s=n(73080),u=n(70934);let l=(0,s.op)({resizeNearestNeighbor_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n=!1,s=!1){let l=(0,a._1)(e,"images","resizeNearestNeighbor");o.hu(3===l.rank||4===l.rank,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${l.rank}.`),o.hu(2===t.length,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),o.hu("float32"===l.dtype||"int32"===l.dtype,()=>"`images` must have `int32` or `float32` as dtype"),o.hu(!1===s||!1===n,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let c=l,d=!1;3===l.rank&&(d=!0,c=(0,u.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));let[]=t,h={images:c},f=r.BV.runKernel(i.dpD,h,{alignCorners:n,halfPixelCenters:s,size:t});return d?(0,u.X)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}})},73274:function(e,t,n){"use strict";n.d(t,{x:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({isFinite_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","isFinite");return r.BV.runKernel(i.avt,{x:t})}})},72576:function(e,t,n){"use strict";n.d(t,{U:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({isInf_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","isInf");return r.BV.runKernel(i.iWB,{x:t})}})},93141:function(e,t,n){"use strict";n.d(t,{i:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({isNaN_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","isNaN");return r.BV.runKernel(i.r7n,{x:t})}})},3725:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({leakyRelu_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=.2){let n=(0,a._1)(e,"x","leakyRelu");return r.BV.runKernel(i.J$2,{x:n},{alpha:t})}})},94562:function(e,t,n){"use strict";n.d(t,{d:function(){return u}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950),s=n(87355);let u=(0,n(73080).op)({less_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","less","string_or_numeric"),u=(0,o._1)(t,"b","less","string_or_numeric");[n,u]=(0,a.makeTypesMatch)(n,u),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);let l={a:n,b:u};return r.BV.runKernel(i.vtC,l)}})},91073:function(e,t,n){"use strict";n.d(t,{z:function(){return u}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950),s=n(87355);let u=(0,n(73080).op)({lessEqual_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","lessEqual","string_or_numeric"),u=(0,o._1)(t,"b","lessEqual","string_or_numeric");[n,u]=(0,a.makeTypesMatch)(n,u),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);let l={a:n,b:u};return r.BV.runKernel(i.CAk,l)}})},56382:function(e,t,n){"use strict";n.d(t,{G:function(){return l}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143),s=n(73080),u=n(70934);let l=(0,s.op)({localResponseNormalization_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=5,n=1,s=1,l=.5){let c=(0,a._1)(e,"x","localResponseNormalization");o.hu(4===c.rank||3===c.rank,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${c.rank}.`),o.hu(o.GN(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let d=c,h=!1;3===c.rank&&(h=!0,d=(0,u.X)(c,[1,c.shape[0],c.shape[1],c.shape[2]]));let f={x:d},p=r.BV.runKernel(i.eZ0,f,{depthRadius:t,bias:n,alpha:s,beta:l});return h?(0,u.X)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},60041:function(e,t,n){"use strict";n.d(t,{c:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({log_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","log","float32");return r.BV.runKernel(i.ZbH,{x:t})}})},35135:function(e,t,n){"use strict";n.d(t,{K:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({log1p_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","log1p");return r.BV.runKernel(i.kU,{x:t})}})},54076:function(e,t,n){"use strict";n.d(t,{e:function(){return c}});var r=n(56426),i=n(34950),a=n(74644),o=n(44591),s=n(73080),u=n(51417),l=n(341);let c=(0,s.op)({logSigmoid_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,i._1)(e,"x","logSigmoid");return(0,r.cb)(e=>({value:(0,o.W)((0,l.W)((0,o.W)(e))),gradFunc:t=>(0,a.d)(t,(0,u.X)((0,o.W)(e)))}))(t)}})},63190:function(e,t,n){"use strict";n.d(t,{C:function(){return f}});var r=n(56426),i=n(34950),a=n(42460),o=n(96197),s=n(60041),u=n(1408),l=n(74644),c=n(73080),d=n(67435),h=n(43174);let f=(0,c.op)({logSoftmax_:/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=-1){let n=(0,i._1)(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return(0,r.cb)((e,n)=>{let r=(0,u.F)(e,t,!0),i=(0,d.l)(e,r),c=(0,d.l)((0,a.p)(i,"float32"),(0,s.c)((0,h.S)((0,o.Q)(i),t,!0)));return n([c]),{value:c,gradFunc:(e,n)=>{let[r]=n,i=(0,o.Q)(r);return(0,d.l)(e,(0,l.d)((0,h.S)(e,t,!0),i))}}})(n)}})},89927:function(e,t,n){"use strict";n.d(t,{l:function(){return p}});var r=n(34950),i=n(31143),a=n(28796),o=n(63584),s=n(96197),u=n(60041),l=n(1408),c=n(73080),d=n(70934),h=n(67435),f=n(43174);let p=(0,c.op)({logSumExp_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=null,n=!1){let c=(0,r._1)(e,"x","logSumExp"),p=(0,i.EC)(t,c.shape),m=(0,l.F)(c,p,!0),g=(0,h.l)(c,m),x=(0,s.Q)(g),b=(0,f.S)(x,p),y=(0,u.c)(b),v=(0,a.I)((0,d.X)(m,y.shape),y);if(n){let e=(0,o.rv)(v.shape,p);return(0,d.X)(v,e)}return v}})},72936:function(e,t,n){"use strict";n.d(t,{H:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(87355);let s=(0,n(73080).op)({logicalAnd_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,a._1)(e,"a","logicalAnd","bool"),s=(0,a._1)(t,"b","logicalAnd","bool");return(0,o.assertAndGetBroadcastShape)(n.shape,s.shape),r.BV.runKernel(i.PYm,{a:n,b:s})}})},70438:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({logicalNot_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","logicalNot","bool");return r.BV.runKernel(i.VfG,{x:t})}})},6556:function(e,t,n){"use strict";n.d(t,{K:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(87355);let s=(0,n(73080).op)({logicalOr_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,a._1)(e,"a","logicalOr","bool"),s=(0,a._1)(t,"b","logicalOr","bool");return(0,o.assertAndGetBroadcastShape)(n.shape,s.shape),r.BV.runKernel(i.MZg,{a:n,b:s})}})},15286:function(e,t,n){"use strict";n.d(t,{e:function(){return u}});var r=n(34950),i=n(87355),a=n(72936),o=n(70438),s=n(6556);let u=(0,n(73080).op)({logicalXor_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,r._1)(e,"a","logicalXor","bool"),u=(0,r._1)(t,"b","logicalXor","bool");return(0,i.assertAndGetBroadcastShape)(n.shape,u.shape),(0,a.H)((0,s.K)(e,t),(0,o.h)((0,a.H)(e,t)))}})},33671:function(e,t,n){"use strict";var r,i;n.d(t,{I:function(){return r}}),(i=r||(r={}))[i.NONE=0]="NONE",i[i.MEAN=1]="MEAN",i[i.SUM=2]="SUM",i[i.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"},33229:function(e,t,n){"use strict";n.d(t,{O:function(){return s}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950);let s=(0,n(73080).op)({matMul_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n=!1,s=!1){let u=(0,o._1)(e,"a","matMul"),l=(0,o._1)(t,"b","matMul");[u,l]=(0,a.makeTypesMatch)(u,l);let c={a:u,b:l};return r.BV.runKernel(i.XLW,c,{transposeA:n,transposeB:s})}})},1408:function(e,t,n){"use strict";n.d(t,{F:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({max_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=null,n=!1){let o=(0,a._1)(e,"x","max");return r.BV.runKernel(i.YoZ,{x:o},{reductionIndices:t,keepDims:n})}})},11e3:function(e,t,n){"use strict";n.d(t,{_:function(){return c}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143),s=n(72235),u=n(73080),l=n(70934);let c=(0,u.op)({maxPool_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,u,c){let d=(0,a._1)(e,"x","maxPool"),h=d,f=!1;3===d.rank&&(f=!0,h=(0,l.X)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),o.hu(4===h.rank,()=>`Error in maxPool: input must be rank 4 but got rank ${h.rank}.`),o.hu(s.jT(n,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`),s.m("maxPool",u,c);let p={x:h},m=r.BV.runKernel(i.mTV,p,{filterSize:t,strides:n,pad:u,dimRoundingMode:c});return f?(0,l.X)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},41725:function(e,t,n){"use strict";n.d(t,{g:function(){return l}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950),s=n(87355),u=n(42460);let l=(0,n(73080).op)({maximum_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","maximum"),l=(0,o._1)(t,"b","maximum");[n,l]=(0,a.makeTypesMatch)(n,l),"bool"===n.dtype&&(n=(0,u.p)(n,"int32"),l=(0,u.p)(l,"int32")),(0,s.assertAndGetBroadcastShape)(n.shape,l.shape);let c={a:n,b:l};return r.BV.runKernel(i.BMI,c)}})},35968:function(e,t,n){"use strict";n.d(t,{J:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({mean_:/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=null,n=!1){let o=(0,a._1)(e,"x","mean");return r.BV.runKernel(i.q2K,{x:o},{axis:t,keepDims:n})}})},91571:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({min_:/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=null,n=!1){let o=(0,a._1)(e,"x","min");return r.BV.runKernel(i.c17,{x:o},{axis:t,keepDims:n})}})},64367:function(e,t,n){"use strict";n.d(t,{L:function(){return l}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950),s=n(87355),u=n(42460);let l=(0,n(73080).op)({minimum_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","minimum"),l=(0,o._1)(t,"b","minimum");[n,l]=(0,a.makeTypesMatch)(n,l),"bool"===n.dtype&&(n=(0,u.p)(n,"int32"),l=(0,u.p)(l,"int32")),(0,s.assertAndGetBroadcastShape)(n.shape,l.shape);let c={a:n,b:l};return r.BV.runKernel(i.q8u,c)}})},23674:function(e,t,n){"use strict";n.d(t,{V:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143);let s=(0,n(73080).op)({mirrorPad_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){o.hu("reflect"===n||"symmetric"===n,()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);let s=(0,a._1)(e,"x","mirrorPad");if(0===s.rank)throw Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");o.hu(t.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${t.length}.`);let u="reflect"===n?1:0;for(let e=0;e<s.rank;e++)o.hu(2===t[e].length,()=>"Invalid number of paddings. Must be length of 2 each."),o.hu(t[e][0]>=0&&t[e][0]<=s.shape[e]-u&&t[e][1]>=0&&t[e][1]<=s.shape[e]-u,()=>`Padding in dimension ${e} cannot be greater than or equal to ${s.shape[e]-u} or less than 0 for input of shape ${s.shape}`);return r.BV.runKernel(i.jQs,{x:s},{paddings:t,mode:n})}})},9965:function(e,t,n){"use strict";n.d(t,{w:function(){return s}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950);let s=(0,n(73080).op)({mod_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","mod"),s=(0,o._1)(t,"b","mod");[n,s]=(0,a.makeTypesMatch)(n,s);let u={a:n,b:s};return r.BV.runKernel(i.Vbg,u)}})},74644:function(e,t,n){"use strict";n.d(t,{d:function(){return s}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950);let s=(0,n(73080).op)({mul_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","mul"),s=(0,o._1)(t,"b","mul");[n,s]=(0,a.makeTypesMatch)(n,s);let u={a:n,b:s};return r.BV.runKernel(i.wYn,u)}})},44591:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({neg_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","neg");return r.BV.runKernel(i.kuV,{x:t})}})},59181:function(e,t,n){"use strict";n.d(t,{K:function(){return g}});var r=n(34950),i=n(31143),a=n(5273),o=n(63584),s=n(1408),u=n(91571),l=n(73080),c=n(52952),d=n(70934),h=n(86008),f=n(13681),p=n(97888),m=n(43174);let g=(0,l.op)({norm_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t="euclidean",n=null,l=!1){let g=function e(t,n,r=null){if(0===t.rank)return(0,a.W)(t);if(1!==t.rank&&null===r)return e((0,d.X)(t,[-1]),n,r);if(1===t.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return(0,m.S)((0,a.W)(t),r);if(n===1/0)return(0,s.F)((0,a.W)(t),r);if(n===-1/0)return(0,u.V)((0,a.W)(t),r);if("euclidean"===n||2===n)return(0,f._)((0,m.S)((0,c.s)((0,a.W)(t),(0,h.i)(2,"int32")),r));throw Error(`Error in norm: invalid ord value: ${n}`)}if(Array.isArray(r)&&2===r.length){if(1===n)return(0,s.F)((0,m.S)((0,a.W)(t),r[0]),r[1]-1);if(n===1/0)return(0,s.F)((0,m.S)((0,a.W)(t),r[1]),r[0]);if(n===-1/0)return(0,u.V)((0,m.S)((0,a.W)(t),r[1]),r[0]);if("fro"===n||"euclidean"===n)return(0,f._)((0,m.S)((0,p.h)(t),r));throw Error(`Error in norm: invalid ord value: ${n}`)}throw Error(`Error in norm: invalid axis: ${r}`)}(e=(0,r._1)(e,"x","norm"),t,n),x=g.shape;if(l){let t=(0,i.EC)(n,e.shape);x=o.rv(g.shape,t)}return(0,d.X)(g,x)}})},79818:function(e,t,n){"use strict";n.d(t,{Q:function(){return u}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950),s=n(87355);let u=(0,n(73080).op)({notEqual_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","notEqual","string_or_numeric"),u=(0,o._1)(t,"b","notEqual","string_or_numeric");[n,u]=(0,a.makeTypesMatch)(n,u),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);let l={a:n,b:u};return r.BV.runKernel(i.yQU,l)}})},3885:function(e,t,n){"use strict";n.d(t,{l:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({oneHot_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n=1,o=0,s="int32"){if(t<2)throw Error(`Error in oneHot: depth must be >=2, but it is ${t}`);let u=(0,a._1)(e,"indices","oneHot","int32");return r.BV.runKernel(i.we_,{indices:u},{dtype:s,depth:t,onValue:n,offValue:o})}})},93311:function(e,t,n){"use strict";n.d(t,{i:function(){return(/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e(t,n="float32"){if((0,i.Mu)(t),"complex64"===n){let n=e(t,"float32"),r=(0,o.l)(t,"float32");return(0,a.P)(n,r)}let s=(0,i.p8)((0,i.NA)(t),n);return r.BV.makeTensor(s,t,n)})}});var r=n(58520),i=n(31143),a=n(42812),o=n(71647)},72102:function(e,t,n){"use strict";n.d(t,{J:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({onesLike_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","onesLike");return r.BV.runKernel(i.qWM,{x:t})}})},73080:function(e,t,n){"use strict";n.d(t,{op:function(){return o},z:function(){return a}});var r=n(58520),i=n(31143);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let a="__op";function o(e){let t=Object.keys(e);if(1!==t.length)throw Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0],o=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));let s=(...e)=>{r.BV.startScope(n);try{let t=o(...e);return(0,i.tI)(t)&&console.error("Cannot return a Promise inside of tidy."),r.BV.endScope(t),t}catch(e){throw r.BV.endScope(null),e}};return Object.defineProperty(s,"name",{value:n+=a,configurable:!0}),s}},82487:function(e,t,n){"use strict";n.d(t,{zvA:function(){return h.z},WnP:function(){return i.W},Khb:function(){return a.K},__u:function(){return o._},IHx:function(){return s.I},QBD:function(){return f},$6P:function(){return p.$},YjB:function(){return m.Y},NqF:function(){return g.N},vHJ:function(){return x.v},ZRM:function(){return b.Z},VfV:function(){return y.V},z4N:function(){return v.z},fvJ:function(){return w.f},C80:function(){return k.C},wS1:function(){return C.w},uR5:function(){return E},zEQ:function(){return O},tgs:function(){return D.t},Dxk:function(){return P},JY5:function(){return M},p3b:function(){return V},E4h:function(){return B.E},yE8:function(){return L},ycw:function(){return W},anm:function(){return nO},XsQ:function(){return G},UFq:function(){return U.U},f3b:function(){return z.f},pju:function(){return I.p},mDi:function(){return X.m},iUl:function(){return H.i},d9v:function(){return K.d},PYB:function(){return q.P},zoF:function(){return _.z},gME:function(){return j},Izb:function(){return Y},MNy:function(){return Q},ZaL:function(){return Z},PAt:function(){return J.P},Tek:function(){return ee.T},bc:function(){return et.b},pdZ:function(){return en},$QV:function(){return ei},mCk:function(){return ea.m},f9Y:function(){return eo.f},mew:function(){return nz},$Gn:function(){return es.$},zbp:function(){return eu.z},ppE:function(){return el},nTT:function(){return ec.n},B10:function(){return ed.B},Ka3:function(){return eh},WmZ:function(){return ef.W},hiC:function(){return ep.h},NTj:function(){return em.N},AKD:function(){return eg.A},rvX:function(){return nG},WYO:function(){return ex},pyx:function(){return eb.p},GRh:function(){return nU},EDe:function(){return ey},DgJ:function(){return ev.D},qNN:function(){return ew.q},d2q:function(){return ek.d},Qqt:function(){return eC.Q},dt4:function(){return eI.d},t$B:function(){return e$.t},iyy:function(){return eE},kp_:function(){return t7.k},hlL:function(){return e_.h},GWj:function(){return eT.G},qPi:function(){return eN.q},imm:function(){return r},Iqj:function(){return eR.I},dbB:function(){return nW},pjt:function(){return eA.p},brS:function(){return eF.b},Sxn:function(){return ne.S},asL:function(){return eO.a},BHj:function(){return rM},V3u:function(){return nX},wx0:function(){return nt.w},xVT:function(){return eB.x},UWc:function(){return eD.U},i2d:function(){return eP.i},hi7:function(){return eM.h},d9m:function(){return eV.d},zN1:function(){return eL.z},$r2:function(){return rV},SX3:function(){return eW},G9k:function(){return eG.G},cM7:function(){return eU.c},Krr:function(){return ez.K},e_t:function(){return eX.e},CmS:function(){return eH.C},l_t:function(){return eK.l},HvI:function(){return eq.H},hJK:function(){return ej.h},K5V:function(){return eY.K},egP:function(){return eQ.e},MB5:function(){return rL},eab:function(){return eJ},OI3:function(){return T.O},Fp7:function(){return e0.F},_sB:function(){return e1._},YQQ:function(){return e2},Ip$:function(){return e3},gWQ:function(){return e4.g},J69:function(){return e5.J},ry_:function(){return e6},VV$:function(){return e7.V},LTh:function(){return te.L},VdP:function(){return tt.V},wQq:function(){return tn.w},Gi7:function(){return to},p_:function(){return nM},dC7:function(){return N.d},rq4:function(){return ts},SJ_:function(){return tu},W76:function(){return tl.W},KOy:function(){return nD.K},Quu:function(){return tc.Q},lfX:function(){return td.l},iUs:function(){return e8.i},JpU:function(){return th.J},op:function(){return h.op},N2O:function(){return tf},vku:function(){return tp.v},pNR:function(){return tm},koy:function(){return tg},t1L:function(){return tx},lGY:function(){return tb},d_R:function(){return ty.d},sQ3:function(){return tv.s},AL3:function(){return tw.A},S0v:function(){return tk.S},WVs:function(){return tC.W},$gW:function(){return tI},VT$:function(){return t$},N89:function(){return tS},TN_:function(){return tE},wzB:function(){return tA},nGf:function(){return tF},ruB:function(){return tO},LGj:function(){return tB},pe5:function(){return tD},w6H:function(){return tP},kwC:function(){return tM.k},M25:function(){return tV.M},UYe:function(){return tL.U},btT:function(){return tW.b},XLQ:function(){return S.X},GYS:function(){return tG.G},SDf:function(){return tU},diP:function(){return tz},sx7:function(){return tX},mG2:function(){return tH},QEs:function(){return nn.Q},NMM:function(){return tK.N},bp0:function(){return tq.b},iD$:function(){return tj.i},snQ:function(){return nV},zcT:function(){return eZ},U8D:function(){return tY.U},U_I:function(){return tQ.U},ODp:function(){return tZ},XD2:function(){return R.X},Xxe:function(){return tJ.X},tdS:function(){return rP},O$l:function(){return t0.O},R_K:function(){return t1.R},tPi:function(){return A.t},jZU:function(){return t2},SmN:function(){return t3},CnO:function(){return t4},p0P:function(){return t5},XAC:function(){return t8.X},Wvh:function(){return t9.W},fBT:function(){return t6.f},rVs:function(){return rW},ers:function(){return nL},uN7:function(){return rD},Vl2:function(){return nr.V},_b3:function(){return ni._},h62:function(){return ti.h},$i:function(){return na.$},L9e:function(){return no.L},knu:function(){return ns.k},Nbs:function(){return nu.N},NXj:function(){return nl.N},Z_8:function(){return rG},luU:function(){return ta.l},Smz:function(){return nc.S},ORZ:function(){return nd.O},AEp:function(){return F.A},XeE:function(){return nh.X},RRF:function(){return np},odF:function(){return nm},wOQ:function(){return ng.w},yXz:function(){return nx},Bfx:function(){return nb},xZs:function(){return ny},Pg0:function(){return nw},Gg6:function(){return eS.G},hg7:function(){return nk.h},p4s:function(){return nB.p},Xu6:function(){return nC},Two:function(){return nI.T},pUJ:function(){return n$.p},HHK:function(){return nS.H},GaM:function(){return nE},VD$:function(){return n_},arb:function(){return nT.a},itS:function(){return nR},lls:function(){return nA.l},P84:function(){return nF.P}});var r={};n.r(r),n.d(r,{conv2d:function(){return nQ},depthwiseConv2d:function(){return n0},matMul:function(){return n1}});var i=n(5273),a=n(90514),o=n(28246),s=n(28796),u=n(58520),l=n(89052),c=n(34950),d=n(31143),h=n(73080);let f=(0,h.op)({addN_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){d.hu(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),d.hu(e.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`);let t=e.map((e,t)=>(0,c._1)(e,`tensors${t}`,"addN")),n=t[0];return t.forEach(e=>{if(e.dtype!==n.dtype)throw Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(e=>{if(!d.cO(e.shape,n.shape))throw Error("All tensors passed to tf.addN() must have the same shape")}),u.BV.runKernel(l.Xze,t)}});var p=n(48172),m=n(4541),g=n(89487),x=n(80099),b=n(73978),y=n(64277),v=n(97410),w=n(51562),k=n(98813),C=n(4121),I=n(42460),$=n(72235),S=n(70934);let E=(0,h.op)({avgPool3d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r,i,a="NDHWC"){let o=(0,c._1)(e,"x","avgPool3d","float32"),s=o,h=!1;4===o.rank&&(h=!0,s=(0,S.X)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),d.hu(5===s.rank,()=>`Error in avgPool3d: x must be rank 5 but got rank ${s.rank}.`),d.hu("NDHWC"===a,()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),d.hu("number"==typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),(0,$.m)("avgPool3d",r,i);let f={x:s},p=u.BV.runKernel(l._k9,f,{filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:a});return(p=(0,I.p)(p,s.dtype),h)?(0,S.X)(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}});var _=n(66598),T=n(33229),N=n(74644),R=n(51417),A=n(92959),F=n(30460);let O=(0,h.op)({basicLSTMCell_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r,i,a){let o=(0,c._1)(e,"forgetBias","basicLSTMCell"),u=(0,c._1)(t,"lstmKernel","basicLSTMCell"),l=(0,c._1)(n,"lstmBias","basicLSTMCell"),d=(0,c._1)(r,"data","basicLSTMCell"),h=(0,c._1)(i,"c","basicLSTMCell"),f=(0,c._1)(a,"h","basicLSTMCell"),p=(0,_.z)([d,f],1),m=(0,T.O)(p,u),g=(0,s.I)(m,l),x=g.shape[0],b=g.shape[1]/4,y=[x,b],v=(0,A.t)(g,[0,0],y),w=(0,A.t)(g,[0,b],y),k=(0,A.t)(g,[0,2*b],y),C=(0,A.t)(g,[0,3*b],y),I=(0,s.I)((0,N.d)((0,R.X)(v),(0,F.A)(w)),(0,N.d)(h,(0,R.X)((0,s.I)(o,k)))),$=(0,N.d)((0,F.A)(I),(0,R.X)(C));return[I,$]}});var B=n(85860),D=n(95837);let P=(0,h.op)({batchNorm2d_:function(e,t,n,r,i,a){let o,s;let u=(0,c._1)(e,"x","batchNorm"),l=(0,c._1)(t,"mean","batchNorm"),h=(0,c._1)(n,"variance","batchNorm");return null!=i&&(o=(0,c._1)(i,"scale","batchNorm")),null!=r&&(s=(0,c._1)(r,"offset","batchNorm")),d.hu(2===u.rank,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${u.rank}.`),d.hu(2===l.rank||1===l.rank,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${l.rank}.`),d.hu(2===h.rank||1===h.rank,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${h.rank}.`),null!=o&&d.hu(2===o.rank||1===o.rank,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${o.rank}.`),null!=s&&d.hu(2===s.rank||1===s.rank,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${s.rank}.`),(0,D.t)(u,l,h,s,o,a)}}),M=(0,h.op)({batchNorm3d_:function(e,t,n,r,i,a){let o,s;let u=(0,c._1)(e,"x","batchNorm"),l=(0,c._1)(t,"mean","batchNorm"),h=(0,c._1)(n,"variance","batchNorm");return null!=i&&(o=(0,c._1)(i,"scale","batchNorm")),null!=r&&(s=(0,c._1)(r,"offset","batchNorm")),d.hu(3===u.rank,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${u.rank}.`),d.hu(3===l.rank||1===l.rank,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${l.rank}.`),d.hu(3===h.rank||1===h.rank,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${h.rank}.`),null!=o&&d.hu(3===o.rank||1===o.rank,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${o.rank}.`),null!=s&&d.hu(3===s.rank||1===s.rank,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${s.rank}.`),(0,D.t)(u,l,h,s,o,a)}}),V=(0,h.op)({batchNorm4d_:function(e,t,n,r,i,a){let o,s;let u=(0,c._1)(e,"x","batchNorm"),l=(0,c._1)(t,"mean","batchNorm"),h=(0,c._1)(n,"variance","batchNorm");return null!=i&&(o=(0,c._1)(i,"scale","batchNorm")),null!=r&&(s=(0,c._1)(r,"offset","batchNorm")),d.hu(4===u.rank,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${u.rank}.`),d.hu(4===l.rank||1===l.rank,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${l.rank}.`),d.hu(4===h.rank||1===h.rank,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${h.rank}.`),null!=o&&d.hu(4===o.rank||1===o.rank,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${o.rank}.`),null!=s&&d.hu(4===s.rank||1===s.rank,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${s.rank}.`),(0,D.t)(u,l,h,s,o,a)}}),L=(0,h.op)({bincount_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let r=(0,c._1)(e,"x","bincount"),i=(0,c._1)(t,"weights","bincount");return d.hu("int32"===r.dtype,()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),d.hu(n>=0,()=>`size must be non-negative, but got ${n}.`),d.hu(i.size===r.size||0===i.size,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`),u.BV.runKernel(l.zvY,{x:r,weights:i},{size:n})}}),W=(0,h.op)({bitwiseAnd_:/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,c._1)(e,"x","bitwiseAnd"),r=(0,c._1)(t,"y","bitwiseAnd");if(!(0,d.cO)(n.shape,r.shape))throw Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if("int32"!==n.dtype||"int32"!==r.dtype)throw Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);return u.BV.runKernel(l.hCO,{a:n,b:r})}}),G=(0,h.op)({broadcastArgs_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,c._1)(e,"s0","broadcastArgs","int32"),r=(0,c._1)(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(1!==r.rank)throw Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);return u.BV.runKernel(l.eEB,{s0:n,s1:r})}});var U=n(69580),z=n(84171),X=n(37003),H=n(24737),K=n(92932),q=n(42812);let j=(0,h.op)({concat1d_:function(e){return(0,_.z)(e,0)}}),Y=(0,h.op)({concat2d_:function(e,t){return(0,_.z)(e,t)}}),Q=(0,h.op)({concat3d_:function(e,t){return(0,_.z)(e,t)}}),Z=(0,h.op)({concat4d_:function(e,t){return(0,_.z)(e,t)}});var J=n(77620),ee=n(7289),et=n(27294);let en=(0,h.op)({conv3d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r,i="NDHWC",a=[1,1,1]){let o=(0,c._1)(e,"x","conv3d"),s=(0,c._1)(t,"filter","conv3d"),h=o,f=!1;4===o.rank&&(f=!0,h=(0,S.X)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),d.hu(5===h.rank,()=>`Error in conv3d: input must be rank 5, but got rank ${h.rank}.`),d.hu(5===s.rank,()=>`Error in conv3d: filter must be rank 5, but got rank ${s.rank}.`),d.hu(h.shape[4]===s.shape[3],()=>`Error in conv3d: depth of input (${h.shape[4]}) must match input depth for filter ${s.shape[3]}.`),d.hu((0,$.jT)(n,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),d.hu("NDHWC"===i,()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`),d.hu((0,$.U3)(a),()=>"Error in conv3D: Dilated rates should be larger than 0."),d.hu((0,$.U3)(n),()=>"Error in conv3D: Strides should be larger than 0.");let p={x:h,filter:s},m=u.BV.runKernel(l.x12,p,{strides:n,pad:r,dataFormat:i,dilations:a});return f?(0,S.X)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}});var er=n(50375);let ei=(0,h.op)({conv3dTranspose_:function(e,t,n,r,i){let a=(0,c._1)(e,"x","conv3dTranspose"),o=(0,c._1)(t,"filter","conv3dTranspose");return(0,er._)(n,a,o,r,i)}});var ea=n(66292),eo=n(45094),es=n(96951),eu=n(82062);let el=(0,h.op)({denseBincount_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r=!1){let i=(0,c._1)(e,"x","denseBincount"),a=(0,c._1)(t,"weights","denseBincount");return d.hu("int32"===i.dtype,()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),d.hu(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),d.hu(n>=0,()=>`size must be non-negative, but got ${n}.`),d.hu(a.size===i.size||0===a.size,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${a.shape}.`),u.BV.runKernel(l.QRR,{x:i,weights:a},{size:n,binaryOutput:r})}});var ec=n(42580),ed=n(86075);let eh=(0,h.op)({diag_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,c._1)(e,"x","diag");return u.BV.runKernel(l.$w,{x:t})}});var ef=n(82795),ep=n(69750),em=n(76532),eg=n(27397);let ex=(0,h.op)({einsum_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,...t){let n=t.map((e,t)=>(0,c._1)(e,`tensors${t}`,"einsum"));return u.BV.runKernel(l.$g6,n,{equation:e})}});var eb=n(36394);let ey=(0,h.op)({ensureShape_:/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,c._1)(e,"x","ensureShape","string_or_numeric");if(!(0,d.DK)(n.shape,t))throw Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${t}`);return e}});var ev=n(31998),ew=n(30886),ek=n(56237),eC=n(96197),eI=n(68569),e$=n(76074),eS=n(3490);let eE=(0,h.op)({eye_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r="float32"){null==t&&(t=e);let i=(0,z.f)([e,t],r),a=e<=t?e:t;for(let e=0;e<a;++e)i.set(1,e,e);let o=(0,S.X)(i.toTensor(),[e,t]);if(null==n)return o;if(1===n.length)return(0,eS.G)((0,eI.d)(o,0),[n[0],1,1]);if(2===n.length)return(0,eS.G)((0,eI.d)((0,eI.d)(o,0),0),[n[0],n[1],1,1]);if(3===n.length)return(0,eS.G)((0,eI.d)((0,eI.d)((0,eI.d)(o,0),0),0),[n[0],n[1],n[2],1,1]);throw Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}});var e_=n(17851),eT=n(62114),eN=n(27873),eR=n(85134),eA=n(23553),eF=n(8939),eO=n(97318),eB=n(73274),eD=n(72576),eP=n(93141),eM=n(3725),eV=n(94562),eL=n(91073);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eW(e,t,n){if(n<=0)throw Error("The number of values should be positive.");return u.BV.runKernel(l.e7N,{},{start:e,stop:t,num:n})}var eG=n(56382),eU=n(60041),ez=n(35135),eX=n(54076),eH=n(63190),eK=n(89927),eq=n(72936),ej=n(70438),eY=n(6556),eQ=n(15286);let eZ=(0,h.op)({searchSorted_:function(e,t,n="left"){let r=(0,c._1)(e,"sortedSequence","searchSorted"),i=(0,c._1)(t,"values","searchSorted"),a=r.shape[r.shape.length-1],o=i.shape[i.shape.length-1],s=(0,S.X)(r,[-1,a]),h=(0,S.X)(i,[-1,o]);if(s.rank<2)throw Error("Sorted input argument must be at least 2-dimensional");if(s.shape[0]!==h.shape[0])throw Error("Leading dimension of 'sortedSequence' and 'values' must match.");if((0,d.NA)(h.shape)>=2147483648)throw Error("values tensor size must less than 2147483648");if(s.shape[1]>=2147483648)throw Error(`trailing dim_size must less than 2147483648 for int32 output type, was ${s.shape[1]}`);return u.BV.runKernel(l.nr8,{sortedSequence:s,values:h},{side:n})}});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eJ(e,t){return eZ(e,t,"left")}var e0=n(1408),e1=n(11e3);let e2=(0,h.op)({maxPool3d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=[1,1,1],n,r,i,a="NDHWC"){let o=(0,c._1)(e,"x","maxPool3d"),s=o,h=!1;4===o.rank&&(h=!0,s=(0,S.X)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),d.hu(5===s.rank,()=>`Error in maxPool3d: x must be rank 5 but got rank ${s.rank}.`),d.hu("NDHWC"===a,()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),(0,$.m)("maxPool3d",r,i);let f={x:s},p=u.BV.runKernel(l.OAf,f,{filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:a});return h?(0,S.X)(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),e3=(0,h.op)({maxPoolWithArgmax_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r,i=!1){let a=(0,c._1)(e,"x","maxPoolWithArgmax"),o=u.BV.runKernel(l.vFR,{x:a},{filterSize:t,strides:n,pad:r,includeBatchInIndex:i});return{result:o[0],indexes:o[1]}}});var e4=n(41725),e5=n(35968),e8=n(93311),e9=n(85013);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e6(e,t,{indexing:n="xy"}={}){if("xy"!==n&&"ij"!==n)throw TypeError(`${n} is not a valid third argument to meshgrid`);if(void 0===e)return[];let r=(0,c._1)(e,"x","meshgrid",e instanceof e9.es?e.dtype:"float32");if(void 0===t)return[r];let i=(0,c._1)(t,"y","meshgrid",t instanceof e9.es?t.dtype:"float32"),a=(0,d.NA)(r.shape),o=(0,d.NA)(i.shape);return"xy"===n?(r=(0,S.X)(r,[1,-1]),i=(0,S.X)(i,[-1,1]),[(0,T.O)((0,e8.i)([o,1],r.dtype),r),(0,T.O)(i,(0,e8.i)([1,a],i.dtype))]):(r=(0,S.X)(r,[-1,1]),i=(0,S.X)(i,[1,-1]),[(0,T.O)(r,(0,e8.i)([1,o],r.dtype)),(0,T.O)((0,e8.i)([a,1],i.dtype),i)])}var e7=n(91571),te=n(64367),tt=n(23674),tn=n(9965),tr=n(63584),ti=n(97888),ta=n(67435);let to=(0,h.op)({moments_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=null,n=!1){e=(0,c._1)(e,"x","moments");let r=(0,d.EC)(t,e.shape),i=(0,e5.J)(e,r,n),a=i.shape;n||(a=(0,tr.rv)(i.shape,r));let o=(0,ti.h)((0,ta.l)((0,I.p)(e,"float32"),(0,S.X)(i,a)));return{mean:i,variance:(0,e5.J)(o,r,n)}}}),ts=(0,h.op)({multiRNNCell_:function(e,t,n,r){let i=(0,c._1)(t,"data","multiRNNCell"),a=(0,c.sI)(n,"c","multiRNNCell"),o=(0,c.sI)(r,"h","multiRNNCell"),s=i,u=[];for(let t=0;t<e.length;t++){let n=e[t](s,a[t],o[t]);u.push(n[0]),u.push(n[1]),s=n[1]}let l=[],d=[];for(let e=0;e<u.length;e+=2)l.push(u[e]),d.push(u[e+1]);return[l,d]}}),tu=(0,h.op)({multinomial_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r=!1){let i=(0,c._1)(e,"logits","multinomial"),a=i.size,o=i.rank;if(a<2)throw Error(`Error in multinomial: you need at least 2 outcomes, but got ${a}.`);if(o>2)throw Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();let s=1===o?(0,S.X)(i,[1,-1]):i,d={numSamples:t,seed:n,normalized:r},h=u.BV.runKernel(l.NZg,{logits:s},d);return 1===o?(0,S.X)(h,[h.size]):h}});var tl=n(44591),tc=n(79818),td=n(3885),th=n(72102);let tf=(0,h.op)({outerProduct_:function(e,t){let n=(0,c._1)(e,"v1","outerProduct"),r=(0,c._1)(t,"v2","outerProduct");d.hu(1===n.rank&&1===r.rank,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);let i=(0,S.X)(n,[-1,1]),a=(0,S.X)(r,[1,-1]);return(0,T.O)(i,a)}});var tp=n(9434);let tm=(0,h.op)({pad1d_:function(e,t,n=0){return(0,d.hu)(2===t.length,()=>"Invalid number of paddings. Must be length of 2."),(0,tp.v)(e,[t],n)}}),tg=(0,h.op)({pad2d_:function(e,t,n=0){return(0,d.hu)(2===t.length&&2===t[0].length&&2===t[1].length,()=>"Invalid number of paddings. Must be length of 2 each."),(0,tp.v)(e,t,n)}}),tx=(0,h.op)({pad3d_:function(e,t,n=0){return(0,d.hu)(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,()=>"Invalid number of paddings. Must be length of 2 each."),(0,tp.v)(e,t,n)}}),tb=(0,h.op)({pad4d_:function(e,t,n=0){return(0,d.hu)(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,()=>"Invalid number of paddings. Must be length of 2 each."),(0,tp.v)(e,t,n)}});var ty=n(41525),tv=n(52952),tw=n(55676),tk=n(44410),tC=n(63885);let tI=(0,h.op)({raggedGather_:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r){let i=e.map((e,t)=>(0,c._1)(e,`tensors${t}`,"raggedGather","int32")),a=(0,c._1)(t,"paramsDenseValues","raggedGather"),o=(0,c._1)(n,"indices","raggedGather","int32"),s=u.BV.runKernel(l.dDz,{paramsNestedSplits:i,paramsDenseValues:a,indices:o},{outputRaggedRank:r});return{outputNestedSplits:s.slice(0,s.length-1),outputDenseValues:s[s.length-1]}}}),t$=(0,h.op)({raggedRange_:/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let r=(0,c._1)(e,"starts","raggedRange"),i=(0,c._1)(t,"limits","raggedRange",r.dtype),a=(0,c._1)(n,"deltas","raggedRange",r.dtype),o=u.BV.runKernel(l.CQl,{starts:r,limits:i,deltas:a});return{rtNestedSplits:o[0],rtDenseValues:o[1]}}}),tS=(0,h.op)({raggedTensorToTensor_:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r,i){let a=(0,c._1)(e,"shape","raggedTensorToTensor","int32"),o=(0,c._1)(t,"values","raggedTensorToTensor"),s=(0,c._1)(n,"defaultValue","raggedTensorToTensor",o.dtype),d=r.map((e,t)=>(0,c._1)(e,`tensors${t}`,"raggedTensorToTensor","int32"));return u.BV.runKernel(l.BiW,{shape:a,values:o,defaultValue:s,rowPartitionTensors:d},{rowPartitionTypes:i})}}),tE=(0,h.op)({rand_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){(0,d.Mu)(e);let r=(0,d.NA)(e),i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else if("bool"===n)i=new Uint8Array(r);else throw Error(`Unknown data type ${n}`);for(let e=0;e<r;e++)i[e]=t();return u.BV.makeTensor(i,e,n)}});var t_=n(15661);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tT{constructor(e,t,n,r,i){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);let a=i||Math.random();this.random=t_.alea(a.toString())}nextValue(){let e,t;if(!isNaN(this.nextVal)){let e=this.nextVal;return this.nextVal=NaN,e}let n=!1;for(;!n;){let r,i,a;do a=(r=2*this.random()-1)*r+(i=2*this.random()-1)*i;while(a>=1||0===a);let o=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*r*o,t=this.mean+this.stdDev*i*o,(!this.truncated||this.isValidTruncated(e))&&(n=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class tN{constructor(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;let i=r||Math.random();this.randu=t_.alea(i.toString()),this.randn=new tT(0,1,n,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,r,i,a;for(;;){do r=this.randn.nextValue(),a=1+this.c*r;while(a<=0);if(a*=a*a,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-a+Math.log(a)),(i=this.randu())<t||Math.log(i)<n)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(e){return"float32"===this.dtype?e:Math.round(e)}}class tR{constructor(e=0,t=1,n,r){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=t_.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}let tA=(0,h.op)({randomGamma_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n=1,r="float32",i){if((0,d.Mu)(e),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw Error(`Unsupported data type ${r}`);let a=new tN(t,n,r,i),o=(0,z.f)(e,r);for(let e=0;e<o.values.length;e++)o.values[e]=a.nextValue();return o.toTensor()}}),tF=(0,h.op)({randomNormal_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=0,n=1,r,i){if((0,d.Mu)(e),null!=r&&"bool"===r)throw Error(`Unsupported data type ${r}`);let a=new tT(t,n,r,!1,i),o=(0,z.f)(e,r);for(let e=0;e<o.values.length;e++)o.values[e]=a.nextValue();return o.toTensor()}}),tO=(0,h.op)({randomStandardNormal_:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){if(null!=t&&"bool"===t)throw Error(`Unsupported data type ${t}`);return tF(e,0,1,t,n)}}),tB=(0,h.op)({randomUniform_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=0,n=1,r="float32",i){(0,d.Mu)(e);let a=(0,z.f)(e,r),o=new tR(t,n,null,i);for(let e=0;e<a.values.length;e++)a.values[e]=o.nextValue();return a.toTensor()}}),tD=(0,h.op)({randomUniformInt_:/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r){return tB(e,t,n,"int32",r)}});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tP(e,t,n=1,r="float32"){if(0===n)throw Error("Cannot have a step of zero");return u.BV.runKernel(l.e6w,{},{start:e,stop:t,step:n,dtype:r})}var tM=n(77860),tV=n(49599),tL=n(71579),tW=n(18820),tG=n(28258);let tU=(0,h.op)({reverse1d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,c._1)(e,"x","reverse");return d.hu(1===t.rank,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),(0,tG.G)(t,0)}}),tz=(0,h.op)({reverse2d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,c._1)(e,"x","reverse");return d.hu(2===n.rank,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),(0,tG.G)(n,t)}}),tX=(0,h.op)({reverse3d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,c._1)(e,"x","reverse");return d.hu(3===n.rank,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),(0,tG.G)(n,t)}}),tH=(0,h.op)({reverse4d_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,c._1)(e,"x","reverse");return d.hu(4===n.rank,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),(0,tG.G)(n,t)}});var tK=n(11514),tq=n(74045),tj=n(86008),tY=n(18044),tQ=n(43758);let tZ=/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function(e,t){let n=(0,c._1)(e,"x","setdiff1d"),r=(0,c._1)(t,"y","setdiff1d");d.hu(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),d.hu(1===n.rank,()=>`x should be 1D tensor, but got x (${n.shape}).`),d.hu(1===r.rank,()=>`y should be 1D tensor, but got y (${r.shape}).`);let i=await n.data(),a=new Set(await r.data()),o=0;for(let e=0;e<i.length;e++)!a.has(i[e])&&o++;let s=new e9.YD([o],n.dtype),u=new e9.YD([o],"int32");for(let e=0,t=0;e<i.length;e++)!a.has(i[e])&&(s.values[t]=i[e],u.values[t]=e,t++);return[s.toTensor(),u.toTensor()]};var tJ=n(85582),t0=n(74449),t1=n(49407);let t2=(0,h.op)({slice1d_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let r=(0,c._1)(e,"x","slice1d");return d.hu(1===r.rank,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),(0,A.t)(r,[t],[n])}}),t3=(0,h.op)({slice2d_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let r=(0,c._1)(e,"x","slice2d");return d.hu(2===r.rank,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),(0,A.t)(r,t,n)}}),t4=(0,h.op)({slice3d_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let r=(0,c._1)(e,"x","slice3d");return d.hu(3===r.rank,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),(0,A.t)(r,t,n)}}),t5=(0,h.op)({slice4d_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let r=(0,c._1)(e,"x","slice4d");return d.hu(4===r.rank,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),(0,A.t)(r,t,n)}});var t8=n(36486),t9=n(341),t6=n(68644),t7=n(14137),ne=n(58695),nt=n(1582),nn=n(2196),nr=n(394),ni=n(13681),na=n(32765),no=n(53953),ns=n(1495),nu=n(26449),nl=n(61396),nc=n(43174),nd=n(45182),nh=n(4194),nf=n(60588);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function np(e,t){(0,d.Cq)(e);let n=(0,c.C)(e,t);if(1!==n.length)throw Error("tensor1d() requires values to be a flat/TypedArray");return(0,nf.H)(e,null,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nm(e,t,n){if((0,d.Cq)(e),null!=t&&2!==t.length)throw Error("tensor2d() requires shape to have two numbers");let r=(0,c.C)(e,n);if(2!==r.length&&1!==r.length)throw Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return(0,nf.H)(e,t,r,n)}var ng=n(24395);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nx(e,t,n){if((0,d.Cq)(e),null!=t&&4!==t.length)throw Error("tensor4d() requires shape to have four numbers");let r=(0,c.C)(e,n);if(4!==r.length&&1!==r.length)throw Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw Error("tensor4d() requires shape to be provided when `values` are a flat array");return(0,nf.H)(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nb(e,t,n){if((0,d.Cq)(e),null!=t&&5!==t.length)throw Error("tensor5d() requires shape to have five numbers");let r=(0,c.C)(e,n);if(5!==r.length&&1!==r.length)throw Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw Error("tensor5d() requires shape to be provided when `values` are a flat array");return(0,nf.H)(e,t,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ny(e,t,n){if((0,d.Cq)(e),null!=t&&6!==t.length)throw Error("tensor6d() requires shape to have six numbers");let r=(0,c.C)(e,n);if(6!==r.length&&1!==r.length)throw Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,(0,nf.H)(e,t,r,n)}var nv=n(35900);let nw=(0,h.op)({tensorScatterUpdate_:/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let r=(0,c._1)(e,"tensor","tensorScatterupdate"),i=(0,c._1)(t,"indices","tensorScatterupdate","int32"),a=(0,c._1)(n,"updates","tensorScatterupdate");if(nv.validateInput(a,i,r.shape),r.dtype!==a.dtype)throw Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${a.dtype}.`);return u.BV.runKernel(l.SIB,{tensor:r,indices:i,updates:a},{})}});var nk=n(59466);let nC=(0,h.op)({truncatedNormal_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=0,n=1,r,i){if((0,d.Mu)(e),null!=r&&"bool"===r)throw Error("Unsupported data type $ { dtype }");let a=new tT(t,n,r,!0,i),o=(0,z.f)(e,r);for(let e=0;e<o.values.length;e++)o.values[e]=a.nextValue();return o.toTensor()}});var nI=n(30502),n$=n(1818),nS=n(89501);/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nE(e,t){return eZ(e,t,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n_(e,t=!0,n,r){return u.BV.makeVariable(e,t,n,r)}var nT=n(9670),nN=n(35736);let nR=/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function(e){let t=(0,c._1)(e,"condition","whereAsync","bool"),n=await t.data(),r=(0,nN.Z)(t.shape,n);return e!==t&&t.dispose(),r};var nA=n(71647),nF=n(33113);let nO=/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function(e,t,n){let r=(0,c._1)(e,"tensor","boolMask"),i=(0,c._1)(t,"mask","boolMask","bool"),a=null==n?0:n,o=i.rank,s=r.shape;d.hu(o>0,()=>"mask cannot be scalar"),d.k5(s.slice(a,a+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let e=a;e<a+o;e++)u*=s[e];let l=s.slice(0,a).concat([u],s.slice(a+o)),h=(0,S.X)(r,l),f=(0,S.X)(i,[-1]),p=await nR(f),m=(0,no.L)(p,[1]),g=(0,eR.I)(h,m,a);return e!==r&&r.dispose(),t!==i&&i.dispose(),m.dispose(),h.dispose(),f.dispose(),p.dispose(),g};var nB=n(33072),nD=n(59181),nP=n(66484);let nM=(0,h.op)({movingAverage_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r,i=!0){let a=(0,c._1)(e,"v","movingAverage"),o=(0,c._1)(t,"x","movingAverage"),u=(0,c._1)(n,"decay","movingAverage");(0,nP.assertTypesMatch)(a,o),d.hu(d.cO(a.shape,o.shape),()=>"Shape mismatch in v and x");let l=(0,tj.i)(1),h=(0,ta.l)(l,u),f=(0,N.d)((0,ta.l)(o,a),h);if(i){d.hu(null!=r,()=>"When using zeroDebias: true, step is required.");let e=(0,c._1)(r,"step","movingAverage");f=(0,ep.h)(f,(0,ta.l)(l,(0,tv.s)(u,e)))}return(0,s.I)(a,f)}}),nV=(0,h.op)({scatterND_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){(0,d.Mu)(n);let r=(0,c._1)(e,"indices","scatterND","int32"),i=(0,c._1)(t,"updates","scatterND");return nv.validateInput(i,r,n),u.BV.runKernel(l.xQA,{indices:r,updates:i},{shape:n})}}),nL=(0,h.op)({sparseToDense_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r=0){(0,d.Mu)(n);let i=(0,c._1)(e,"sparseIndices","sparseToDense","int32"),a=(0,c._1)(t,"sparseValues","sparseToDense","string_or_numeric"),o=(0,c._1)(r,"defaultValue","sparseToDense",a.dtype);return!function(e,t,n,r){if("int32"!==e.dtype)throw Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);let i=e.rank>0?e.shape[0]:1,a=e.rank>1?e.shape[1]:1;if(n.length!==a)throw Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${a}.`);let o=t.size;if(!(0===t.rank||1===t.rank&&o===i))throw Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${i}]`);if(t.dtype!==r.dtype)throw Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,o),u.BV.runKernel(l.D2d,{sparseIndices:i,sparseValues:a,defaultValue:o},{outputShape:n})}}),nW=(0,h.op)({gatherND_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,c._1)(t,"indices","gatherND","int32"),r=(0,c._1)(e,"x","gatherND","string_or_numeric");return u.BV.runKernel(l.q1x,{params:r,indices:n})}}),nG=(0,h.op)({dropout_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r){let i=(0,c._1)(e,"x","dropout");if(d.hu("float32"===i.dtype,()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),d.hu(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),0===t)return e instanceof e9.es?i.clone():i;let a=/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){if(null==t)return e.shape.slice();if(d.cO(e.shape,t))return t;if(e.shape.length===t.length){let n=[];for(let r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(i,n),o=1-t,u=(0,ep.h)((0,eT.G)((0,s.I)(tB(a,0,1,"float32",r),o)),o);return(0,N.d)(i,u)}});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nU(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function nz(e,t,n){let r=1-e%2,i=new Float32Array(e);for(let a=0;a<e;++a){let o=2*Math.PI*a/(e+r-1);i[a]=t-n*Math.cos(o)}return np(i,"float32")}let nX=/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function(e,t,n=1){let r=(0,c._1)(e,"predictions","inTopK"),i=(0,c._1)(t,"targets","inTopK");(0,d.hu)(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),(0,d.hu)(r.rank-1===i.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${i.rank}`),(0,d.k5)(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");let a=r.shape[r.shape.length-1];(0,d.hu)(n>0&&n<=a,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${a}), but got ${n}`);let o=await r.data(),s=await i.data(),[u,l]=[o.length/a,a],h=(0,d.WP)("bool",u);for(let e=0;e<u;e++){let t=e*l,r=o.subarray(t,t+l),i=[];for(let e=0;e<r.length;e++)i.push({value:r[e],index:e});i.sort((e,t)=>t.value-e.value),h[e]=0;for(let t=0;t<n;t++)if(i[t].index===s[e]){h[e]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),(0,nh.X)(h,i.shape,"bool")};var nH=n(56426),nK=n(87355),nq=n(65714),nj=n(43447),nY=n(78984);let nQ=(0,h.op)({fusedConv2d_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:o,bias:h,activation:f="linear",preluActivationWeights:p,leakyreluAlpha:m}){let g,x;if(f=f||"linear",!1===(0,nY.uy)(u.BV.state.gradientDepth,f)){d.hu("NHWC"===i,()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let u=(0,ee.T)(e,t,n,r,i,a,o);return null!=h&&(u=(0,s.I)(u,h)),(0,nY.QH)(u,f,p,m)}let b=(0,c._1)(e,"x","conv2d","float32"),y=(0,c._1)(t,"filter","conv2d","float32"),v=b,w=!1;3===b.rank&&(w=!0,v=(0,S.X)(b,[1,b.shape[0],b.shape[1],b.shape[2]])),d.hu(4===v.rank,()=>`Error in fused conv2d: input must be rank 4, but got rank ${v.rank}.`),d.hu(4===y.rank,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${y.rank}.`),$.m("fused conv2d",r,o);let k="NHWC"===i?v.shape[3]:v.shape[1];d.hu(y.shape[2]===k,()=>`Error in conv2d: depth of input (${k}) must match input depth for filter ${y.shape[2]}.`),d.hu($.jT(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);let C=$.Ix(v.shape,y.shape,n,a,r,o);if(null!=h&&(g=(0,c._1)(h,"bias","fused conv2d"),[g]=(0,nP.makeTypesMatch)(g,b),"NHWC"===i?nK.assertAndGetBroadcastShape(C.outShape,g.shape):(d.hu(g.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`),d.hu(0===g.shape.length||g.shape[0]===C.outChannels||1===g.shape[0],()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${C.outChannels})`))),null!=p){let e=p.shape;if(d.hu(e.length<=1||3===e.length,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${e.length}.`),1===e.length)d.hu(1===e[0]||e[0]===C.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the number of output channels (${C.outChannels}).`);else if(3===e.length)try{nK.assertAndGetBroadcastShape(e,C.outShape)}catch(t){throw Error(`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the output shape of the conv2d (${C.outShape}).`)}x=(0,c._1)(p,"prelu weights","fused conv2d")}let I=(e,t)=>{d.hu("NHWC"===i,()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);let[o,s,u,l]=t,c=(0,nY.Fr)(e,u,f);d.hu($.I0(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);let h=[(0,nj._)(s.shape,c,o,n,r),(0,nq.p)(s,c,o.shape,n,r)];if(null!=l){let e=(0,nY.pf)(l,c);h.push(e)}return h},E={x:v,filter:y,bias:g,preluActivationWeights:x},_={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o,activation:f,leakyreluAlpha:m};return null==h?(0,nH.cb)((e,t,n)=>{let r=u.BV.runKernel(l._V0,E,_);return n([t,e,r]),w&&(r=(0,S.X)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:I}})(v,y):(0,nH.cb)((e,t,n,r)=>{let i=u.BV.runKernel(l._V0,E,_);return r([t,e,i,n]),w&&(i=(0,S.X)(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:I}})(v,y,g)}});var nZ=n(91224),nJ=n(15187);let n0=(0,h.op)({fusedDepthwiseConv2d_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:o,bias:h,activation:f="linear",preluActivationWeights:p,leakyreluAlpha:m}){let g,x;if(!1===(0,nY.uy)(u.BV.state.gradientDepth,f)){let u=(0,ed.B)(e,t,n,r,i,a,o);return null!=h&&(u=(0,s.I)(u,h)),(0,nY.QH)(u,f,p,m)}let b=(0,c._1)(e,"x","depthwiseConv2d","float32"),y=(0,c._1)(t,"filter","depthwiseConv2d","float32"),v=b,w=!1;3===b.rank&&(w=!0,v=(0,S.X)(b,[1,b.shape[0],b.shape[1],b.shape[2]])),d.hu(4===v.rank,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${v.rank}.`),d.hu(4===y.rank,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${y.rank}.`),d.hu(v.shape[3]===y.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${v.shape[3]}) must match the inChannels dimension in filter ${y.shape[2]}.`),null==a&&(a=[1,1]),d.hu($.jT(n,a),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),$.m("fused depthwiseConv2d",r,o);let k=$.Ix(v.shape,y.shape,n,a,r,o,!0);null!=h&&(g=(0,c._1)(h,"bias","fused conv2d"),[g]=(0,nP.makeTypesMatch)(g,b),nK.assertAndGetBroadcastShape(k.outShape,g.shape)),null!=p&&(x=(0,c._1)(p,"prelu weights","fused depthwiseConv2d"));let C=(e,t)=>{d.hu($.I0(a),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);let[i,s,u,l]=t,c=(0,nY.Fr)(e,u,f),h=(0,nJ.v)(s.shape,c,i,n,r,a,o),p=(0,nZ.z)(s,c,i.shape,n,r,a,o);return null!=l?[h,p,(0,nY.pf)(g,c)]:[h,p]},I={x:v,filter:y,bias:g,preluActivationWeights:x},E={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o,activation:f,leakyreluAlpha:m};return null==h?(0,nH.cb)((e,t,n)=>{let r=u.BV.runKernel(l.luS,I,E);return n([t,e,r]),w&&(r=(0,S.X)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:C}})(v,y):(0,nH.cb)((e,t,n,r)=>{let i=u.BV.runKernel(l.luS,I,E);return r([t,e,i,n]),w&&(i=(0,S.X)(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:C}})(v,y,g)}}),n1=(0,h.op)({fusedMatMul_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:i,activation:a="linear",preluActivationWeights:o,leakyreluAlpha:h=.2}){let f,p;if(!1===(0,nY.uy)(u.BV.state.gradientDepth,a)){let u=(0,T.O)(e,t,n,r);return null!=i&&(u=(0,s.I)(u,i)),(0,nY.QH)(u,a,o,h)}let m=(0,c._1)(e,"a","fused matMul"),g=(0,c._1)(t,"b","fused matMul");[m,g]=(0,nP.makeTypesMatch)(m,g);let x=n?m.shape[m.rank-2]:m.shape[m.rank-1],b=r?g.shape[g.rank-1]:g.shape[g.rank-2],y=n?m.shape[m.rank-1]:m.shape[m.rank-2],v=r?g.shape[g.rank-2]:g.shape[g.rank-1],w=m.shape.slice(0,-2),k=g.shape.slice(0,-2),C=d.NA(w),I=d.NA(k);d.hu(x===b,()=>`Error in fused matMul: inner shapes (${x}) and (${b}) of Tensors with shapes ${m.shape} and ${g.shape} and transposeA=${n} and transposeB=${r} must match.`);let $=nK.assertAndGetBroadcastShape(m.shape.slice(0,-2),g.shape.slice(0,-2)).concat([y,v]),E=n?(0,S.X)(m,[C,x,y]):(0,S.X)(m,[C,y,x]),_=r?(0,S.X)(g,[I,v,b]):(0,S.X)(g,[I,b,v]);null!=i&&(f=(0,c._1)(i,"bias","fused matMul"),[f]=(0,nP.makeTypesMatch)(f,m),nK.assertAndGetBroadcastShape($,f.shape)),null!=o&&(p=(0,c._1)(o,"prelu weights","fused matMul"));let N=(e,t)=>{let o,s;let[u,l,c,d]=t,h=(0,nY.Fr)((0,S.X)(e,c.shape),c,a);return(n||r?!n&&r?(o=(0,T.O)(h,l,!1,!1),s=(0,T.O)(h,u,!0,!1)):n&&!r?(o=(0,T.O)(l,h,!1,!0),s=(0,T.O)(u,h,!1,!1)):(o=(0,T.O)(l,h,!0,!0),s=(0,T.O)(h,u,!0,!0)):(o=(0,T.O)(h,l,!1,!0),s=(0,T.O)(u,h,!0,!1)),null!=i)?[o,s,(0,nY.pf)(d,h)]:[o,s]},R={a:E,b:_,bias:f,preluActivationWeights:p},A={transposeA:n,transposeB:r,activation:a,leakyreluAlpha:h};return null==i?(0,nH.cb)((e,t,n)=>{let r=u.BV.runKernel(l.usg,R,A);return n([e,t,r]),{value:(0,S.X)(r,$),gradFunc:N}})(E,_):(0,nH.cb)((e,t,n,r)=>{let i=u.BV.runKernel(l.usg,R,A);return r([e,t,i,n]),{value:(0,S.X)(i,$),gradFunc:N}})(E,_,f)}}),n2=(0,h.op)({hammingWindow_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){return nz(e,.54,.46)}}),n3=(0,h.op)({hannWindow_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){return nz(e,.5,.5)}}),n4=(0,h.op)({frame_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r=!1,i=0){let a=0,o=[];for(;a+t<=e.size;)o.push((0,A.t)(e,a,t)),a+=n;if(r)for(;a<e.size;){let r=a+t-e.size,s=(0,_.z)([(0,A.t)(e,a,t-r),(0,e_.h)([r],i)]);o.push(s),a+=n}return 0===o.length?nm([],[0,t]):(0,S.X)((0,_.z)(o),[o.length,t])}}),n5=(0,h.op)({stft_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r,i=n3){null==r&&(r=nU(t));let a=n4(e,t,n),o=(0,N.d)(a,i(t));return(0,nn.Q)(o,r)}}),n8=(0,h.op)({cropAndResize_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r,i="bilinear",a=0){let o=(0,c._1)(e,"image","cropAndResize"),s=(0,c._1)(t,"boxes","cropAndResize","float32"),h=(0,c._1)(n,"boxInd","cropAndResize","int32"),f=s.shape[0];return d.hu(4===o.rank,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),d.hu(2===s.rank&&4===s.shape[1],()=>`Error in cropAndResize: boxes must be have size [${f},4] but had shape ${s.shape}.`),d.hu(1===h.rank&&h.shape[0]===f,()=>`Error in cropAndResize: boxInd must be have size [${f}] but had shape ${s.shape}.`),d.hu(2===r.length,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),d.hu(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),d.hu("bilinear"===i||"nearest"===i,()=>`method must be bilinear or nearest, but was ${i}`),u.BV.runKernel(l.VcC,{image:o,boxes:s,boxInd:h},{method:i,extrapolationValue:a,cropSize:r})}}),n9=(0,h.op)({flipLeftRight_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,c._1)(e,"image","flipLeftRight","float32");return d.hu(4===t.rank,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`),u.BV.runKernel(l.Uyb,{image:t},{})}}),n6=(0,h.op)({grayscaleToRGB_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,c._1)(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];d.hu(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),d.hu(1===r,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);let i=Array(t.rank);return i.fill(1,0,n),i[n]=3,(0,eS.G)(t,i)}}),n7=(0,h.op)({rgbToGrayscale_:/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t;let n=(0,c._1)(e,"image","RGBToGrayscale"),r=n.rank-1,i=n.shape[r];d.hu(n.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${n.rank}.`),d.hu(3===i,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${i}.`);let a=n.dtype,o=(0,I.p)(n,"float32"),s=np([.2989,.587,.114]);switch(n.rank){case 2:t=ex("ij,j->i",o,s);break;case 3:t=ex("ijk,k->ij",o,s);break;case 4:t=ex("ijkl,l->ijk",o,s);break;case 5:t=ex("ijklm,m->ijkl",o,s);break;case 6:t=ex("ijklmn,n->ijklm",o,s);break;default:throw Error("Not a valid tensor rank.")}return t=(0,eI.d)(t,-1),(0,I.p)(t,a)}}),re=(0,h.op)({rotateWithOffset_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n=0,r=.5){let i=(0,c._1)(e,"image","rotateWithOffset","float32");return d.hu(4===i.rank,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`),u.BV.runKernel(l.b9H,{image:i},{radians:t,fillValue:n,center:r})}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rt(e,t,n,r,i,a){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==a&&(a=0);let o=e.shape[0];return n=Math.min(n,o),d.hu(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),d.hu(2===e.rank,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),d.hu(4===e.shape[1],()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),d.hu(1===t.rank,()=>"scores must be a 1D tensor"),d.hu(t.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${t.shape[0]}`),d.hu(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}let rn=(0,h.op)({nonMaxSuppression_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){let a=(0,c._1)(e,"boxes","nonMaxSuppression","float32"),o=(0,c._1)(t,"scores","nonMaxSuppression","float32"),s=rt(a,o,n,r,i),d={maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:i=s.scoreThreshold};return u.BV.runKernel(l.uv1,{boxes:a,scores:o},d)}});var rr=n(69154);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function ri(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){let a=(0,c._1)(e,"boxes","nonMaxSuppressionAsync"),o=(0,c._1)(t,"scores","nonMaxSuppressionAsync"),s=rt(a,o,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;let u=await Promise.all([a.data(),o.data()]),l=u[0],d=u[1],{selectedIndices:h}=(0,rr.GP)(l,d,n,r,i);return a!==e&&a.dispose(),o!==t&&o.dispose(),np(h,"int32")}let ra=(0,h.op)({nonMaxSuppressionWithScore_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,a=0){let o=(0,c._1)(e,"boxes","nonMaxSuppression"),s=(0,c._1)(t,"scores","nonMaxSuppression"),d=rt(o,s,n,r,i,a);n=d.maxOutputSize,r=d.iouThreshold;let h={maxOutputSize:n,iouThreshold:r,scoreThreshold:i=d.scoreThreshold,softNmsSigma:a=d.softNmsSigma},f=u.BV.runKernel(l.W0H,{boxes:o,scores:s},h);return{selectedIndices:f[0],selectedScores:f[1]}}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function ro(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,a=0){let o=(0,c._1)(e,"boxes","nonMaxSuppressionAsync"),s=(0,c._1)(t,"scores","nonMaxSuppressionAsync"),u=rt(o,s,n,r,i,a);n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,a=u.softNmsSigma;let l=await Promise.all([o.data(),s.data()]),d=l[0],h=l[1],{selectedIndices:f,selectedScores:p}=(0,rr.pA)(d,h,n,r,i,a);return o!==e&&o.dispose(),s!==t&&s.dispose(),{selectedIndices:np(f,"int32"),selectedScores:np(p)}}let rs=(0,h.op)({nonMaxSuppressionPadded_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,a=!1){let o=(0,c._1)(e,"boxes","nonMaxSuppression"),s=(0,c._1)(t,"scores","nonMaxSuppression"),d=rt(o,s,n,r,i,null),h=d.maxOutputSize,f=d.iouThreshold,p=d.scoreThreshold,m=u.BV.runKernel(l.cye,{boxes:o,scores:s},{maxOutputSize:h,iouThreshold:f,scoreThreshold:p,padToMaxOutputSize:a});return{selectedIndices:m[0],validOutputs:m[1]}}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function ru(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,a=!1){let o=(0,c._1)(e,"boxes","nonMaxSuppressionAsync"),s=(0,c._1)(t,"scores","nonMaxSuppressionAsync"),u=rt(o,s,n,r,i,null),l=u.maxOutputSize,d=u.iouThreshold,h=u.scoreThreshold,[f,p]=await Promise.all([o.data(),s.data()]),{selectedIndices:m,validOutputs:g}=(0,rr.qP)(f,p,l,d,h,a);return o!==e&&o.dispose(),s!==t&&s.dispose(),{selectedIndices:np(m,"int32"),validOutputs:(0,tj.i)(g,"int32")}}var rl=n(57554),rc=n(37875);let rd=(0,h.op)({threshold_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t="binary",n=!1,r=.5){let i,a,o,u;let l=(0,c._1)(e,"image","threshold"),h=l.shape[0]*l.shape[1],f=(0,N.d)(np([r]),255);if(d.hu(3===l.rank,()=>`Error in threshold: image must be rank 3,but got rank ${l.rank}.`),d.hu(3===l.shape[2]||1===l.shape[2],()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${l.shape[2]}.`),d.hu("int32"===l.dtype||"float32"===l.dtype,()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${l.dtype}.`),d.hu("otsu"===t||"binary"===t,()=>`Method must be binary or otsu, but was ${t}`),3===l.shape[2]){[i,a,o]=(0,nr.V)(l,[1,1,1],-1);let e=(0,N.d)(i,.2989),t=(0,N.d)(a,.587),n=(0,N.d)(o,.114);u=(0,s.I)((0,s.I)(e,t),n)}else u=e;"otsu"===t&&(f=function(e,t){let n,r,i,a,o,u,l=np([-1]),c=np([0]),d=np([0]);for(let h=0;h<e.size-1;h++){n=(0,A.t)(e,0,h+1),r=(0,A.t)(e,h+1),o=(0,ep.h)((0,nc.S)(n),t),u=(0,ep.h)((0,nc.S)(r),t);let f=(0,nc.S)((0,N.d)(n,tP(0,n.size)));i=(0,ep.h)(f,(0,nc.S)(n));let p=(0,e_.h)(r.shape,n.size),m=(0,s.I)(tP(0,r.size),p),g=(0,N.d)(r,m);a=(0,ep.h)((0,nc.S)(g),(0,nc.S)(r));let x=(0,ta.l)(i,a),b=(0,ta.l)(i,a),y=(0,N.d)(o,u);d=(0,N.d)((0,N.d)(y,x),b);let v=(0,eA.p)(d,c);c=(0,nT.a)(v,d,c),l=(0,nT.a)(v,np([h]),l)}return l}(L((0,I.p)((0,tK.N)(u),"int32"),(0,nh.X)([]),256),h));let p=n?(0,eL.z)(u,f):(0,eA.p)(u,f);return(0,I.p)((0,N.d)(p,255),"int32")}}),rh=(0,h.op)({transform_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n="nearest",r="constant",i=0,a){let o=(0,c._1)(e,"image","transform","float32"),s=(0,c._1)(t,"transforms","transform","float32");return d.hu(4===o.rank,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),d.hu(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),d.hu(null==a||2===a.length,()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`),u.BV.runKernel(l.wx7,{image:o,transforms:s},{interpolation:n,fillMode:r,fillValue:i,outputShape:a})}}),rf=(0,h.op)({bandPart_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let r,i;let a=(0,c._1)(e,"a","bandPart");(0,d.hu)(a.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${a.rank}.`);let o=a.shape,[s,u]=a.shape.slice(-2);"number"==typeof t?((0,d.hu)(t%1==0,()=>`bandPart(): numLower must be an integer, got ${t}.`),(0,d.hu)(t<=s,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${s}).`),r=(0,c._1)(t<0?s:t,"numLower","bandPart")):((0,d.hu)("int32"===t.dtype,()=>"bandPart(): numLower's dtype must be an int32."),r=(0,nT.a)((0,eV.d)(t,0),s,(0,te.L)(t,s))),"number"==typeof n?((0,d.hu)(n%1==0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),(0,d.hu)(n<=u,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${u}).`),i=(0,c._1)(n<0?u:n,"numUpper","bandPart")):((0,d.hu)("int32"===n.dtype,()=>"bandPart(): numUpper's dtype must be an int32."),i=(0,nT.a)((0,eV.d)(n,0),u,(0,te.L)(n,u)));let l=(0,S.X)(tP(0,s,1,"int32"),[-1,1]),h=tP(0,u,1,"int32"),f=(0,ta.l)(l,h),p=(0,eq.H)((0,eL.z)(f,r),(0,eF.b)(f,(0,tl.W)(i))),m=(0,nA.l)([s,u],a.dtype);return(0,S.X)((0,ns.k)((0,nS.H)((0,S.X)(a,[-1,s,u])).map(e=>(0,nT.a)(p,e,m))),o)}}),rp=(0,h.op)({gramSchmidt_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t;if(Array.isArray(e)){t=!1,(0,d.hu)(null!=e&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");let n=e[0].shape[0];for(let t=1;t<e.length;++t)(0,d.hu)(e[t].shape[0]===n,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[t].shape[0]} vs. ${n})`)}else t=!0,e=(0,nr.V)(e,e.shape[0],0).map(e=>(0,no.L)(e,[0]));(0,d.hu)(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);let n=[],r=e;for(let t=0;t<e.length;++t)n.push(u.BV.tidy(()=>{let e=r[t];if(t>0)for(let r=0;r<t;++r){let t=(0,N.d)((0,nc.S)((0,N.d)(n[r],e)),n[r]);e=(0,ta.l)(e,t)}return(0,ep.h)(e,(0,nD.K)(e,"euclidean"))}));return t?(0,ns.k)(n,0):n}});var rm=n(65139);function rg(e,t=!1){return u.BV.tidy(()=>{(0,d.hu)(2===e.shape.length,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);let n=e.shape[0],r=e.shape[1],i=eE(n),a=(0,K.d)(e),o=nm([[1]],[1,1]),s=(0,K.d)(o),l=n>=r?r:n;for(let e=0;e<l;++e){let t=a,l=s,c=i;[s,a,i]=u.BV.tidy(()=>{let t=(0,A.t)(a,[e,e],[n-e,1]),u=(0,nD.K)(t),l=(0,A.t)(a,[e,e],[1,1]),c=(0,nT.a)((0,eA.p)(l,0),nm([[-1]]),nm([[1]])),d=(0,ta.l)(l,(0,N.d)(c,u)),h=(0,ep.h)(t,d);s=1===h.shape[0]?(0,K.d)(o):(0,_.z)([o,(0,A.t)(h,[1,0],[h.shape[0]-1,h.shape[1]])],0);let f=(0,tl.W)((0,ep.h)((0,T.O)(c,d),u)),p=(0,A.t)(a,[e,0],[n-e,r]),m=(0,N.d)(f,s),g=(0,nB.p)(s);if(0===e)a=(0,ta.l)(p,(0,T.O)(m,(0,T.O)(g,p)));else{let t=(0,ta.l)(p,(0,T.O)(m,(0,T.O)(g,p)));a=(0,_.z)([(0,A.t)(a,[0,0],[e,r]),t],0)}let x=(0,nB.p)(m),b=(0,A.t)(i,[0,e],[n,i.shape[1]-e]);if(0===e)i=(0,ta.l)(b,(0,T.O)((0,T.O)(b,s),x));else{let t=(0,ta.l)(b,(0,T.O)((0,T.O)(b,s),x));i=(0,_.z)([(0,A.t)(i,[0,0],[n,e]),t],1)}return[s,a,i]}),(0,rm.B9)([t,l,c])}return!t&&n>r&&(i=(0,A.t)(i,[0,0],[n,r]),a=(0,A.t)(a,[0,0],[r,r])),[i,a]})}let rx=(0,h.op)({qr_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=!1){if((0,d.hu)(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),2===e.rank)return rg(e,t);{let n=e.shape.slice(0,e.shape.length-2).reduce((e,t)=>e*t),r=(0,nS.H)((0,S.X)(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],a=[];return r.forEach(e=>{let[n,r]=rg(e,t);i.push(n),a.push(r)}),[(0,S.X)((0,ns.k)(i,0),e.shape),(0,S.X)((0,ns.k)(a,0),e.shape)]}}});var rb=n(33671);let ry=(0,h.op)({computeWeightedLoss_:function(e,t,n=rb.I.SUM_BY_NONZERO_WEIGHTS){let r=(0,c._1)(e,"losses","computeWeightedLoss"),i=null;null!=t&&(i=(0,c._1)(t,"weights","computeWeightedLoss"));let a=null==i?r:(0,N.d)(r,i);if(n===rb.I.NONE)return a;if(n===rb.I.SUM)return(0,nc.S)(a);if(n===rb.I.MEAN){if(null==i)return(0,e5.J)(a);{let e=r.size/i.size,t=(0,ep.h)((0,nc.S)(a),(0,nc.S)(i));return e>1?(0,ep.h)(t,(0,tj.i)(e)):t}}if(n===rb.I.SUM_BY_NONZERO_WEIGHTS){if(null==i)return(0,ep.h)((0,nc.S)(a),(0,tj.i)(r.size));{let e=(0,N.d)(i,(0,e8.i)(r.shape)),t=(0,I.p)((0,nc.S)((0,tc.Q)(e,(0,tj.i)(0))),"float32");return(0,ep.h)((0,nc.S)(a),t)}}throw Error(`Unknown reduction: ${n}`)}}),rv=(0,h.op)({absoluteDifference_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r=rb.I.SUM_BY_NONZERO_WEIGHTS){let a=(0,c._1)(e,"labels","absoluteDifference"),o=(0,c._1)(t,"predictions","absoluteDifference"),s=null;return null!=n&&(s=(0,c._1)(n,"weights","absoluteDifference")),(0,d.k5)(a.shape,o.shape,"Error in absoluteDifference: "),ry((0,i.W)((0,ta.l)(a,o)),s,r)}}),rw=(0,h.op)({cosineDistance_:function(e,t,n,r,i=rb.I.SUM_BY_NONZERO_WEIGHTS){let a=(0,c._1)(e,"labels","cosineDistance"),o=(0,c._1)(t,"predictions","cosineDistance"),s=null;null!=r&&(s=(0,c._1)(r,"weights","cosineDistance")),(0,d.k5)(a.shape,o.shape,"Error in cosineDistance: ");let u=(0,tj.i)(1);return ry((0,ta.l)(u,(0,nc.S)((0,N.d)(a,o),n,!0)),s,i)}}),rk=(0,h.op)({hingeLoss_:function(e,t,n,r=rb.I.SUM_BY_NONZERO_WEIGHTS){let i=(0,c._1)(e,"labels","hingeLoss"),a=(0,c._1)(t,"predictions","hingeLoss"),o=null;null!=n&&(o=(0,c._1)(n,"weights","hingeLoss")),(0,d.k5)(i.shape,a.shape,"Error in hingeLoss: ");let s=(0,tj.i)(1);return i=(0,ta.l)((0,N.d)((0,tj.i)(2),i),s),ry((0,tL.U)((0,ta.l)(s,(0,N.d)(i,a))),o,r)}}),rC=(0,h.op)({huberLoss_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r=1,a=rb.I.SUM_BY_NONZERO_WEIGHTS){let o=(0,c._1)(e,"labels","huberLoss"),u=(0,c._1)(t,"predictions","huberLoss"),l=null;null!=n&&(l=(0,c._1)(n,"weights","huberLoss")),(0,d.k5)(o.shape,u.shape,"Error in huberLoss: ");let h=(0,tj.i)(r),f=(0,i.W)((0,ta.l)(u,o)),p=(0,te.L)(f,h),m=(0,ta.l)(f,p);return ry((0,s.I)((0,N.d)((0,tj.i)(.5),(0,ti.h)(p)),(0,N.d)(h,m)),l,a)}}),rI=(0,h.op)({logLoss_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r=1e-7,i=rb.I.SUM_BY_NONZERO_WEIGHTS){let a=(0,c._1)(e,"labels","logLoss"),o=(0,c._1)(t,"predictions","logLoss"),u=null;null!=n&&(u=(0,c._1)(n,"weights","logLoss")),(0,d.k5)(a.shape,o.shape,"Error in logLoss: ");let l=(0,tj.i)(1),h=(0,tj.i)(r),f=(0,tl.W)((0,N.d)(a,(0,eU.c)((0,s.I)(o,h)))),p=(0,N.d)((0,ta.l)(l,a),(0,eU.c)((0,s.I)((0,ta.l)(l,o),h)));return ry((0,ta.l)(f,p),u,i)}}),r$=(0,h.op)({meanSquaredError_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r=rb.I.SUM_BY_NONZERO_WEIGHTS){let i=(0,c._1)(e,"labels","meanSquaredError"),a=(0,c._1)(t,"predictions","meanSquaredError"),o=null;return null!=n&&(o=(0,c._1)(n,"weights","meanSquaredError")),(0,d.k5)(i.shape,a.shape,"Error in meanSquaredError: "),ry((0,na.$)(i,a),o,r)}}),rS=(0,h.op)({sigmoidCrossEntropy_:function(e,t,n,r=0,a=rb.I.SUM_BY_NONZERO_WEIGHTS){let o=(0,c._1)(e,"multiClassLabels","sigmoidCrossEntropy"),u=(0,c._1)(t,"logits","sigmoidCrossEntropy"),l=null;if(null!=n&&(l=(0,c._1)(n,"weights","sigmoidCrossEntropy")),(0,d.k5)(o.shape,u.shape,"Error in sigmoidCrossEntropy: "),r>0){let e=(0,tj.i)(r),t=(0,tj.i)(1),n=(0,tj.i)(.5);o=(0,s.I)((0,N.d)(o,(0,ta.l)(t,e)),(0,N.d)(n,e))}return ry(/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,c._1)(e,"labels","sigmoidCrossEntropyWithLogits"),r=(0,c._1)(t,"logits","sigmoidCrossEntropyWithLogits");(0,d.k5)(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");let a=(0,tL.U)(r),o=(0,N.d)(r,n),u=(0,ez.K)((0,eC.Q)((0,tl.W)((0,i.W)(r))));return(0,s.I)((0,ta.l)(a,o),u)}(o,u),l,a)}}),rE=(0,h.op)({softmaxCrossEntropy_:function(e,t,n,r=0,i=rb.I.SUM_BY_NONZERO_WEIGHTS){let a=(0,c._1)(e,"onehotLabels","softmaxCrossEntropy"),o=(0,c._1)(t,"logits","softmaxCrossEntropy"),u=null;if(null!=n&&(u=(0,c._1)(n,"weights","softmaxCrossEntropy")),(0,d.k5)(a.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){let e=(0,tj.i)(r),t=(0,tj.i)(1),n=(0,tj.i)(a.shape[1]);a=(0,s.I)((0,N.d)(a,(0,ta.l)(t,e)),(0,ep.h)(e,n))}return ry(/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n=-1){if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return(0,nH.cb)((e,t,r)=>{let i=(0,eK.l)(t,[n],!0),a=(0,ta.l)((0,I.p)(t,"float32"),i);r([e,a]);let o=(0,tl.W)((0,N.d)(a,e));return{value:(0,nc.S)(o,[n]),gradFunc:(e,t)=>{let[r,i]=t,a=(0,tr.rv)(e.shape,[n]);return[(0,N.d)((0,S.X)(e,a),(0,ta.l)((0,I.p)(r,"float32"),(0,eC.Q)(i))),(0,N.d)((0,S.X)(e,a),(0,ta.l)((0,eC.Q)(i),(0,I.p)(r,"float32")))]}}})(e,t)}(a,o),u,i)}}),r_=(0,h.op)({sparseFillEmptyRows_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r){let i=(0,c._1)(e,"indices","sparseFillEmptyRows","int32"),a=(0,c._1)(t,"values","sparseFillEmptyRows"),o=(0,c._1)(n,"denseShape","sparseFillEmptyRows","int32"),s=(0,c._1)(r,"defaultValue","sparseFillEmptyRows",a.dtype);if(2!==i.rank)throw Error(`Indices should be Tensor2D but received shape
        ${i.shape}`);if(1!==a.rank)throw Error(`Values should be Tensor1D but received shape ${a.shape}`);if(1!==o.rank)throw Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(0!==s.rank)throw Error(`Default value should be a scalar but received shape ${s.shape}`);let d=u.BV.runKernel(l.O3z,{indices:i,values:a,denseShape:o,defaultValue:s});return{outputIndices:d[0],outputValues:d[1],emptyRowIndicator:d[2],reverseIndexMap:d[3]}}}),rT=(0,h.op)({sparseReshape_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let r=(0,c._1)(e,"inputIndices","sparseReshape","int32"),i=(0,c._1)(t,"inputShape","sparseReshape","int32"),a=(0,c._1)(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(1!==i.rank)throw Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(1!==a.rank)throw Error(`New shape should be Tensor1D but received shape ${a.shape}`);let o=u.BV.runKernel(l.nhH,{inputIndices:r,inputShape:i,newShape:a});return{outputIndices:o[0],outputShape:o[1]}}}),rN=(0,h.op)({sparseSegmentMean_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let r=(0,c._1)(e,"data","sparseSegmentMean"),i=(0,c._1)(t,"indices","sparseSegmentMean","int32"),a=(0,c._1)(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw Error(`Indices should be Tensor1D but received shape
          ${i.shape}`);if(1!==a.rank)throw Error(`Segment ids should be Tensor1D but received shape
          ${a.shape}`);return u.BV.runKernel(l.w3H,{data:r,indices:i,segmentIds:a})}}),rR=(0,h.op)({sparseSegmentSum_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let r=(0,c._1)(e,"data","sparseSegmentSum"),i=(0,c._1)(t,"indices","sparseSegmentSum","int32"),a=(0,c._1)(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw Error(`Indices should be Tensor1D but received shape
         ${i.shape}`);if(1!==a.rank)throw Error(`Segment ids should be Tensor1D but received shape
         ${a.shape}`);return u.BV.runKernel(l.ZjV,{data:r,indices:i,segmentIds:a})}}),rA=(0,h.op)({stringNGrams_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r,i,a,o,s){let d=(0,c._1)(e,"data","stringNGrams","string");if("string"!==d.dtype)throw Error("Data must be of datatype string");if(1!==d.shape.length)throw Error(`Data must be a vector, saw: ${d.shape}`);let h=(0,c._1)(t,"dataSplits","stringNGrams");if("int32"!==h.dtype)throw Error("Data splits must be of datatype int32");let f=u.BV.runKernel(l._JP,{data:d,dataSplits:h},{separator:n,nGramWidths:r,leftPad:i,rightPad:a,padWidth:o,preserveShortSequences:s});return{nGrams:f[0],nGramsSplits:f[1]}}}),rF=(0,h.op)({stringSplit_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n=!0){let r=(0,c._1)(e,"input","stringSplit","string"),i=(0,c._1)(t,"delimiter","stringSplit","string");if(1!==r.rank)throw Error(`Input should be Tensor1D but received shape ${r.shape}`);if(0!==i.rank)throw Error(`Delimiter should be a scalar but received shape ${i.shape}`);let a=u.BV.runKernel(l.s1s,{input:r,delimiter:i},{skipEmpty:n});return{indices:a[0],values:a[1],shape:a[2]}}}),rO=(0,h.op)({stringToHashBucketFast_:/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,c._1)(e,"input","stringToHashBucketFast","string");if(t<=0)throw Error("Number of buckets must be at least 1");return u.BV.runKernel(l.XkS,{input:n},{numBuckets:t})}}),rB=(0,h.op)({staticRegexReplace_:/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,r=!0){let i=(0,c._1)(e,"input","staticRegexReplace","string");return u.BV.runKernel(l.e0R,{x:i},{pattern:t,rewrite:n,replaceGlobal:r})}}),rD={fft:t7.k,ifft:ne.S,rfft:nn.Q,irfft:nt.w},rP={hammingWindow:n2,hannWindow:n3,frame:n4,stft:n5},rM={flipLeftRight:n9,grayscaleToRGB:n6,resizeNearestNeighbor:rc.j,resizeBilinear:rl.I,rgbToGrayscale:n7,rotateWithOffset:re,cropAndResize:n8,nonMaxSuppression:rn,nonMaxSuppressionAsync:ri,nonMaxSuppressionWithScore:ra,nonMaxSuppressionWithScoreAsync:ro,nonMaxSuppressionPadded:rs,nonMaxSuppressionPaddedAsync:ru,threshold:rd,transform:rh},rV={bandPart:rf,gramSchmidt:rp,qr:rx},rL={absoluteDifference:rv,computeWeightedLoss:ry,cosineDistance:rw,hingeLoss:rk,huberLoss:rC,logLoss:rI,meanSquaredError:r$,sigmoidCrossEntropy:rS,softmaxCrossEntropy:rE},rW={sparseFillEmptyRows:r_,sparseReshape:rT,sparseSegmentMean:rN,sparseSegmentSum:rR},rG={stringNGrams:rA,stringSplit:rF,stringToHashBucketFast:rO,staticRegexReplace:rB}},9434:function(e,t,n){"use strict";n.d(t,{v:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({pad_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n=0){let o=(0,a._1)(e,"x","pad");if(0===o.rank)throw Error("pad(scalar) is not defined. Pass non-scalar to pad");return r.BV.runKernel(i.lyA,{x:o},{paddings:t,constantValue:n})}})},41525:function(e,t,n){"use strict";n.d(t,{d:function(){return h}});var r=n(34950),i=n(31143),a=n(4121),o=n(85860),s=n(72235),u=n(11e3),l=n(73080),c=n(70934),d=n(68644);let h=(0,l.op)({pool_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,l,h,f,p){let m;null==h&&(h=[1,1]),null==f&&(f=1),0===l&&(l="valid");let g=(0,r._1)(e,"x","maxPool"),x=g,b=!1;3===g.rank&&(b=!0,x=(0,c.X)(g,[1,g.shape[0],g.shape[1],g.shape[2]])),i.hu(s.jT(f,h),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${f} and dilations '${h}'`);let y=s.Xw(x.shape,t,f,h,l),v=[y.dilationHeight,y.dilationWidth];m="same"===l?function(e,t){let n=e.map((e,n)=>e+(e-1)*(t[n]-1)).map(e=>e-1),r=n.map(e=>Math.floor(e/2)),i=n.map((e,t)=>e-r[t]);return n.map((e,t)=>[r[t],i[t]])}([y.filterHeight,y.filterWidth],v):[[0,0],[0,0]];let w=1===v[0]&&1===v[1],[k,C]=function(e,t,n){let r=n.map(e=>e[0]),i=n.map(e=>e[1]),a=e.concat(r,i),o=t.map((e,t)=>(e-a[t]%e)%e),s=i.map((e,t)=>e+o[t]);return[t.map((e,t)=>[r[t],s[t]]),t.map((e,t)=>[0,o[t]])]}([y.inHeight,y.inWidth],v,m),I=w?l:"valid",$=w?x:(0,d.f)(x,v,k),S=("avg"===n?()=>(0,a.w)($,t,f,I,p):()=>(0,u._)($,t,f,I,p))(),E=w?S:(0,o.E)(S,v,C);return b?(0,c.X)(E,[E.shape[1],E.shape[2],E.shape[3]]):E}})},52952:function(e,t,n){"use strict";n.d(t,{s:function(){return s}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950);let s=(0,n(73080).op)({pow_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"base","pow"),s=(0,o._1)(t,"exp","pow");[n,s]=(0,a.makeTypesMatch)(n,s);let u={a:n,b:s};return r.BV.runKernel(i.pe_,u)}})},55676:function(e,t,n){"use strict";n.d(t,{A:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({prelu_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,a._1)(e,"x","prelu"),o=(0,a._1)(t,"alpha","prelu");return r.BV.runKernel(i.o0g,{x:n,alpha:o})}})},44410:function(e,t,n){"use strict";/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r(e,t=!1){console.log(e.toString(t))}n.d(t,{S:function(){return r}})},63885:function(e,t,n){"use strict";n.d(t,{W:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(42460);let s=(0,n(73080).op)({prod_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=null,n=!1){let s=(0,a._1)(e,"x","prod");"bool"===s.dtype&&(s=(0,o.p)(s,"int32"));let u={x:s};return r.BV.runKernel(i.DlI,u,{axis:t,keepDims:n})}})},77860:function(e,t,n){"use strict";n.d(t,{k:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({real_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"input","real");return r.BV.runKernel(i.xJR,{input:t})}})},49599:function(e,t,n){"use strict";n.d(t,{M:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({reciprocal_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","reciprocal");return r.BV.runKernel(i.$HU,{x:t})}})},71579:function(e,t,n){"use strict";n.d(t,{U:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({relu_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","relu");return r.BV.runKernel(i.qkr,{x:t})}})},18820:function(e,t,n){"use strict";n.d(t,{b:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({relu6_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","relu6");return r.BV.runKernel(i.SbG,{x:t})}})},70934:function(e,t,n){"use strict";n.d(t,{X:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({reshape_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,a._1)(e,"x","reshape","string_or_numeric");return r.BV.runKernel(i.HZH,{x:n},{shape:t})}})},28258:function(e,t,n){"use strict";n.d(t,{G:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({reverse_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,a._1)(e,"x","reverse");return r.BV.runKernel(i.mKl,{x:n},{dims:t})}})},11514:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({round_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","round");return r.BV.runKernel(i.e07,{x:t})}})},74045:function(e,t,n){"use strict";n.d(t,{b:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({rsqrt_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","rsqrt","float32");return r.BV.runKernel(i.bV0,{x:t})}})},86008:function(e,t,n){"use strict";n.d(t,{i:function(){return a}});var r=n(3165),i=n(60588);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(e,t){if(((0,r.isTypedArray)(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&(0,r.isTypedArray)(e)&&!(e instanceof Uint8Array))throw Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return(0,i.H)(e,[],[],t)}},35900:function(e,t,n){"use strict";n.r(t),n.d(t,{calculateShapes:function(){return o},validateInput:function(){return a},validateUpdateShape:function(){return i}});var r=n(31143);function i(e,t,n){let r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw Error(a+` update.rank < ${i}. `);if(e.length<r+(n.rank-i))throw Error(a+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+e.length-r)throw Error(a+` update.rank != ${i+e.length-r}`);for(let e=0;e<i;++e)if(n.shape[e]!==t.shape[e])throw Error(a+` updates.shape[${e}] (${n.shape[e]}) != indices.shape[${e}] (${t.shape[e]}).`);for(let t=0;t<n.rank-i;++t)if(n.shape[t+i]!==e[t+r])throw Error(a+` updates.shape[${t+i}] (${n.shape[t+i]}) != shape[${t+i}] (${e[t+i]})`)}function a(e,t,n){if(t.rank<1)throw Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if("int32"!==t.dtype)throw Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(0===n.length){if(0===t.size)throw Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(0===e.size)throw Error(`Updates specified for empty output. updates shape: ${e.shape}`)}i(n,t,e)}function o(e,t,n){let i=t.shape.length,a=i>1?t.shape[i-1]:1,o=n.length,s=1;for(let e=a;e<o;++e)s*=n[e];let u=a<1?1:a,l=(0,r.NA)(t.shape)/u,c=[...(0,r.e3)(n.slice(0,a)),1];return{sliceRank:a,numUpdates:l,sliceSize:s,strides:c,outputSize:(0,r.NA)(n)}}},18044:function(e,t,n){"use strict";n.d(t,{U:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({selu_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","selu");return r.BV.runKernel(i.oFR,{x:t})}})},35437:function(e,t,n){"use strict";n.d(t,{$:function(){return i},y:function(){return r}});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let r=1.7580993408473768,i=1.0507009873554805},43758:function(e,t,n){"use strict";n.d(t,{U:function(){return l}});var r=n(34950),i=n(31143),a=n(7289),o=n(86075),s=n(73080),u=n(70934);let l=(0,s.op)({separableConv2d_:function(e,t,n,s,l,c=[1,1],d="NHWC"){let h=(0,r._1)(e,"x","separableConv2d"),f=(0,r._1)(t,"depthwiseFilter","separableConv2d"),p=(0,r._1)(n,"pointwiseFilter","separableConv2d"),m=h,g=!1;if(3===h.rank&&(g=!0,m=(0,u.X)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),"NCHW"===d)throw Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");i.hu(4===m.rank,()=>`Error in separableConv2d: input must be rank 4, but got rank ${m.rank}.`),i.hu(4===f.rank,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${f.rank}.`),i.hu(4===p.rank,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${f.rank}.`),i.hu(1===p.shape[0],()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${p.shape[0]}.`),i.hu(1===p.shape[1],()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${p.shape[1]}.`);let x=f.shape[2],b=f.shape[3];i.hu(p.shape[2]===x*b,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${x*b}, but got ${p.shape[2]}.`);let y=(0,o.B)(m,f,s,l,d,c),v=(0,a.T)(y,p,1,"valid",d);return g?(0,u.X)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},51417:function(e,t,n){"use strict";n.d(t,{X:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({sigmoid_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","sigmoid","float32");return r.BV.runKernel(i.a5O,{x:t})}})},85582:function(e,t,n){"use strict";n.d(t,{X:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({sign_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","sign");return r.BV.runKernel(i.i5y,{x:t})}})},74449:function(e,t,n){"use strict";n.d(t,{O:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({sin_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","sin","float32");return r.BV.runKernel(i.RQH,{x:t})}})},49407:function(e,t,n){"use strict";n.d(t,{R:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({sinh_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","sinh");return r.BV.runKernel(i.wYB,{x:t})}})},92959:function(e,t,n){"use strict";n.d(t,{t:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({slice_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let o=(0,a._1)(e,"x","slice","string_or_numeric");if(0===o.rank)throw Error("Slicing scalar is not possible");return r.BV.runKernel(i.p2w,{x:o},{begin:t,size:n})}})},74021:function(e,t,n){"use strict";n.r(t),n.d(t,{assertParamsValid:function(){return i},computeFlatOffset:function(){return g},computeOutShape:function(){return o},getNormalizedAxes:function(){return l},isSliceContinous:function(){return m},maskToAxes:function(){return a},parseSliceParams:function(){return x},sliceInfo:function(){return b},startForAxis:function(){return f},startIndicesWithElidedDims:function(){return c},stopForAxis:function(){return p},stopIndicesWithElidedDims:function(){return d},stridesForAxis:function(){return h},stridesWithElidedDims:function(){return s}});var r=n(31143);function i(e,t,n){let i=e.shape.length;r.hu(i===t.length,()=>`Error in slice${i}D: Length of begin ${t} must match the rank of the array (${i}).`),r.hu(i===n.length,()=>`Error in slice${i}D: Length of size ${n} must match the rank of the array (${i}).`);for(let a=0;a<i;++a)r.hu(t[a]+n[a]<=e.shape[a],()=>`Error in slice${i}D: begin[${a}] + size[${a}] (${t[a]+n[a]}) would overflow input.shape[${a}] (${e.shape[a]})`)}function a(e){let t=[],n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t}function o(e,t,n){let r=[];for(let i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function s(e,t,n,r){let i=[...e];for(let e=i.length;e<r.length;e++)i.push(1);for(let e=0;e<n;e++)0===e?i[t]=1:(i.splice(t,0,1),i.pop());return i}function u(e,t){let n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function l(e,t,n,r,i,a,o,u,l){let m=e.length,g=Array(m),x=Array(m),b=Array(m);if(t.length&&n>0){let l=t[0],h=n+1;g=c(o,l,h,r,e),x=d(u,l,h,i,e),b=s(a,l,h,e)}else for(let t=0;t<m;t++)g[t]=f(o,r,a,e,t,l),x[t]=p(u,i,a,e,t,l),b[t]=h(a,t,l);return{begin:g,end:x,strides:b}}function c(e,t,n,r,i){let a=[...i],o=u(n,t);for(let i=0;i<a.length;i++)if(o.indexOf(i)>-1)a[i]=0;else{var s;let o=(s=i)<=t?s:s-(n-1),u=r[o];e&1<<o&&(u=0),a[i]=u}return a}function d(e,t,n,i,a){let o=[...a],s=u(n,t);for(let r=0;r<o.length;r++)if(s.indexOf(r)>-1)o[r]=Number.MAX_SAFE_INTEGER;else{var l;let a=(l=r)<=t?l:l-(n-1),s=i[a];e&1<<a&&(s=Number.MAX_SAFE_INTEGER),o[r]=s}for(let e=0;e<o.length;e++){let t=a[e];o[e]<0&&(o[e]+=t),o[e]=r.uZ(0,o[e],a[e])}return o}function h(e,t,n){let r=e[t];return(n&1<<t||null==r)&&(r=1),r}function f(e,t,n,i,a,o){let s=t[a],u=n[a]||1;(e&1<<a||o&1<<a||null==s)&&(s=u>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);let l=i[a];return s<0&&(s+=l),s=r.uZ(0,s,l-1)}function p(e,t,n,i,a,o){let s=t[a],u=n[a]||1;(e&1<<a||o&1<<a||null==s)&&(s=u>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);let l=i[a];return s<0&&(s+=l),s=u>0?r.uZ(0,s,l):r.uZ(-1,s,l-1)}function m(e,t,n){let r=n.length;for(let e=0;e<n.length;e++)if(n[e]>1){r=e;break}for(let i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function g(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function x(e,t,n){let i,a;let o=e.shape.length;return(i="number"==typeof t?[t,...Array(o-1).fill(0)]:t.length<o?t.concat(Array(o-t.length).fill(0)):t.slice()).forEach(e=>{r.hu(-1!==e,()=>"slice() does not support negative begin indexing.")}),a=(a=null==n?Array(o).fill(-1):"number"==typeof n?[n,...Array(o-1).fill(-1)]:n.length<o?n.concat(Array(o-n.length).fill(-1)):n).map((t,n)=>t>=0?t:(r.hu(-1===t,()=>`Negative size values should be exactly -1 but got ${t} for the slice() size at index ${n}.`),e.shape[n]-i[n])),[i,a]}function b(e,t,n,r,i,a,o,s,u){let l;if(null==r?(l=Array(t.length)).fill(1):l=r,null!=o&&(o&o-1)!=0)throw Error("Multiple ellipses in slice is not allowed.");let c=!1,d={dims:l.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:l.slice(),beginMask:i,endMask:a,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u};for(let e=0;e<d.dims;e++)c&&(1<<e&s)!=0&&d.numAddAxisAfterEllipsis++,1<<e&o&&(c=!0);!c&&(d.ellipsisMask|=1<<d.dims,d.dims++);let h={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=Array(t.dims),t.end=Array(t.dims),t.strides=Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){let i=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<i;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(-2),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(-1),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(d,h);let f=!0,p=!0,m=!0,g=[],x=[];for(let t=0;t<e.length;++t){let n;if(0===h.strides[t])throw Error(`strides[${t}] must be non-zero`);let r=!!(h.shrinkAxisMask&1<<t),i=e[t];if(-1===i){g.push(r?1:-1);continue}let a=[h.beginMask&1<<t,h.endMask&1<<t],o=[h.strides[t]>0?0:-1,h.strides[t]>0?i:i-1];if(r&&h.strides[t]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&1===h.strides[t];let s=!!(h.beginMask&1<<t&&h.endMask&1<<t);if(h.beginValid&&h.endValid){if(r){let e=h.begin[t]<0?i+h.begin[t]:h.begin[t];if(h.begin[t]=e,h.end[t]=h.begin[t]+1,e<0||e>=i)throw Error(`slice index ${h.begin[t]} of dimension ${t} out of bounds.`)}else h.begin[t]=y(h.begin[t],0,h.strides[t],i,a,o),h.end[t]=y(h.end[t],1,h.strides[t],i,a,o);let e=1===h.strides[t]&&0===h.begin[t]&&h.end[t]===i;f=f&&e,p=p&&(0===t&&1===h.strides[t]||e)}else f=f&&1===h.strides[t]&&s,p=p&&(0===t&&1===h.strides[t]||s);let u=!1;if(h.beginValid&&h.endValid?(n=h.end[t]-h.begin[t],u=!0):r?(n=1,u=!0):s&&i>=0&&(n=h.strides[t]<0?-i:i,u=!0),u){let e;e=0===n||n<0!=h.strides[t]<0?0:Math.trunc(n/h.strides[t])+(n%h.strides[t]!=0?1:0),g.push(e)}else g.push(-1)}for(let e=0;e<h.finalShapeGatherIndices.length;++e){let t=h.finalShapeGatherIndices[e];t>=0?x.push(g[t]):-2===t&&x.push(1)}return{finalShapeSparse:x.filter((e,t)=>-2!==h.finalShapeGatherIndices[t]),finalShape:x,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function y(e,t,n,r,i,a){if(i[t])return n>0?a[t]:a[t+1&1];{let t=e<0?r+e:e;return t<a[0]?a[0]:t>a[1]?a[1]:t}}},36486:function(e,t,n){"use strict";n.d(t,{X:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({softmax_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=-1){let n=(0,a._1)(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);let o={dim:t};return r.BV.runKernel(i.Gcp,{logits:n},o)}})},341:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({softplus_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","softplus");return r.BV.runKernel(i.MRv,{x:t})}})},68644:function(e,t,n){"use strict";n.d(t,{f:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143);let s=(0,n(73080).op)({spaceToBatchND_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let s=(0,a._1)(e,"x","spaceToBatchND");return o.hu(s.rank>=1+t.length,()=>`input rank ${s.rank} should be > than [blockShape] ${t.length}`),o.hu(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),o.hu(s.shape.reduce((e,r,i)=>i>0&&i<=t.length?e&&(r+n[i-1][0]+n[i-1][1])%t[i-1]==0:e,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`),r.BV.runKernel(i.TQc,{x:s},{blockShape:t,paddings:n})}})},14137:function(e,t,n){"use strict";n.d(t,{k:function(){return o}});var r=n(58520),i=n(89052),a=n(31143);let o=(0,n(73080).op)({fft_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){return(0,a.hu)("complex64"===e.dtype,()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`),r.BV.runKernel(i.vwp,{input:e})}})},58695:function(e,t,n){"use strict";n.d(t,{S:function(){return o}});var r=n(58520),i=n(89052),a=n(31143);let o=(0,n(73080).op)({ifft_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){return(0,a.hu)("complex64"===e.dtype,()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`),r.BV.runKernel(i.Qg5,{input:e})}})},1582:function(e,t,n){"use strict";n.d(t,{w:function(){return p}});var r=n(42812),i=n(66598),a=n(97318),o=n(74644),s=n(73080),u=n(77860),l=n(70934),c=n(28258),d=n(86008),h=n(92959),f=n(58695);let p=(0,s.op)({irfft_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t;let n=e.shape[e.shape.length-1],s=e.size/n;if(n<=2){let r=(0,l.X)(e,[s,n]);t=(0,f.S)(r)}else{let p=[s,2*(n-1)],m=(0,l.X)((0,u.k)(e),[s,n]),g=(0,l.X)((0,a.a)(e),[s,n]),x=(0,c.G)((0,h.t)(m,[0,1],[s,n-2]),1),b=(0,o.d)((0,c.G)((0,h.t)(g,[0,1],[s,n-2]),1),(0,d.i)(-1)),y=(0,i.z)([m,x],1),v=(0,i.z)([g,b],1),w=(0,l.X)((0,r.P)(y,v),[p[0],p[1]]);t=(0,f.S)(w)}if(t=(0,u.k)(t),3===e.rank&&0!==e.shape[0]){let n=t,r=e.shape[0];t=(0,l.X)(t,[r,t.shape[0]/r,t.shape[1]]),n.dispose()}return t}})},2196:function(e,t,n){"use strict";n.d(t,{Q:function(){return m}});var r=n(31143),i=n(42812),a=n(66598),o=n(97318),s=n(73080),u=n(77860),l=n(70934),c=n(92959),d=n(394),h=n(71647),f=n(33113),p=n(14137);let m=(0,s.op)({rfft_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n;(0,r.hu)("float32"===e.dtype,()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let s=e.shape[e.shape.length-1],m=e.size/s;if(null!=t&&t<s){let r=e.shape.map(e=>0),i=e.shape.map(e=>e);i[e.shape.length-1]=t,n=(0,c.t)(e,r,i),s=t}else if(null!=t&&t>s){let r=e.shape.map(e=>e);r[e.shape.length-1]=t-s,n=(0,a.z)([e,(0,h.l)(r)],e.shape.length-1),s=t}else n=e;let g=(0,f.P)(n),x=(0,l.X)((0,i.P)(n,g),[m,s]),b=(0,p.k)(x),y=Math.floor(s/2)+1,v=(0,u.k)(b),w=(0,o.a)(b),k=(0,d.V)(v,[y,s-y],v.shape.length-1),C=(0,d.V)(w,[y,s-y],w.shape.length-1),I=n.shape.slice();return I[n.shape.length-1]=y,(0,l.X)((0,i.P)(k[0],C[0]),I)}})},394:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({split_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n=0){let o=(0,a._1)(e,"x","split");return r.BV.runKernel(i.L8s,{x:o},{numOrSizeSplits:t,axis:n})}})},13681:function(e,t,n){"use strict";n.d(t,{_:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({sqrt_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","sqrt","float32");return r.BV.runKernel(i.FKq,{x:t})}})},97888:function(e,t,n){"use strict";n.d(t,{h:function(){return a}});var r=n(58520),i=n(34950);let a=(0,n(73080).op)({square_:/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,i._1)(e,"x","square");return r.BV.runKernel("Square",{x:t},{})}})},32765:function(e,t,n){"use strict";n.d(t,{$:function(){return u}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950),s=n(87355);let u=(0,n(73080).op)({squaredDifference_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","squaredDifference"),u=(0,o._1)(t,"b","squaredDifference");[n,u]=(0,a.makeTypesMatch)(n,u),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);let l={a:n,b:u};return r.BV.runKernel(i._tC,l,{})}})},53953:function(e,t,n){"use strict";n.d(t,{L:function(){return s}});var r=n(34950),i=n(31143),a=n(73080),o=n(70934);let s=(0,a.op)({squeeze_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,r._1)(e,"x","squeeze","string_or_numeric");return(0,o.X)(n,(0,i.bp)(n.shape,t).newShape)}})},1495:function(e,t,n){"use strict";n.d(t,{k:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143);let s=(0,n(73080).op)({stack_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=0){let n=(0,a.sI)(e,"tensors","stack","string_or_numeric");return o.hu(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&o.hu(t<=n[0].rank,()=>"Axis must be <= rank of the tensor"),r.BV.runKernel(i.QiL,n,{axis:t})}})},26449:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({step_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=0){let n=(0,a._1)(e,"x","step");return r.BV.runKernel(i.h8e,{x:n},{alpha:t})}})},61396:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({stridedSlice_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n,o,s=0,u=0,l=0,c=0,d=0){let h=(0,a._1)(e,"x","stridedSlice","string_or_numeric");return r.BV.runKernel(i.jQk,{x:h},{begin:t,end:n,strides:o,beginMask:s,endMask:u,ellipsisMask:l,newAxisMask:c,shrinkAxisMask:d})}})},67435:function(e,t,n){"use strict";n.d(t,{l:function(){return s}});var r=n(58520),i=n(89052),a=n(66484),o=n(34950);let s=(0,n(73080).op)({sub_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,o._1)(e,"a","sub"),s=(0,o._1)(t,"b","sub");[n,s]=(0,a.makeTypesMatch)(n,s);let u={a:n,b:s};return r.BV.runKernel(i.Tr8,u)}})},43174:function(e,t,n){"use strict";n.d(t,{S:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(42460);let s=(0,n(73080).op)({sum_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=null,n=!1){let s=(0,a._1)(e,"x","sum");"bool"===s.dtype&&(s=(0,o.p)(s,"int32"));let u={x:s};return r.BV.runKernel(i.GBy,u,{axis:t,keepDims:n})}})},45182:function(e,t,n){"use strict";n.d(t,{O:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({tan_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","tan","float32");return r.BV.runKernel(i.sEM,{x:t})}})},30460:function(e,t,n){"use strict";n.d(t,{A:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({tanh_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","tanh","float32");return r.BV.runKernel(i.MIZ,{x:t})}})},4194:function(e,t,n){"use strict";n.d(t,{X:function(){return a}});var r=n(34950),i=n(60588);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(e,t,n){let a=(0,r.C)(e,n);return(0,i.H)(e,t,a,n)}},24395:function(e,t,n){"use strict";n.d(t,{w:function(){return o}});var r=n(34950),i=n(31143),a=n(60588);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o(e,t,n){if((0,i.Cq)(e),null!=t&&3!==t.length)throw Error("tensor3d() requires shape to have three numbers");let o=(0,r.C)(e,n);if(3!==o.length&&1!==o.length)throw Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===o.length&&null==t)throw Error("tensor3d() requires shape to be provided when `values` are a flat array");return(0,a.H)(e,t,o,n)}},60588:function(e,t,n){"use strict";n.d(t,{H:function(){return s}});var r=n(58520),i=n(77297),a=n(31143),o=n(3165);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s(e,t,n,s){if(null==s)s=(0,a.D2)(e);else if("complex64"===s)throw Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if((0,i.$F)(e)||(0,i.Oq)(e)){if("float32"!==s&&"int32"!==s)throw Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return r.BV.backend.createTensorFromGPUData(e,t||n,s)}if(!(0,o.isTypedArray)(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){(0,a.Mu)(t);let e=(0,a.NA)(t),r=(0,a.NA)(n);(0,a.hu)(e===r,()=>`Based on the provided shape, [${t}], the tensor should have ${e} values but has ${r}`);for(let e=0;e<n.length;++e){let r=n[e],i=e!==n.length-1||r!==(0,a.NA)(t.slice(e));(0,a.hu)(n[e]===t[e]||!i,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return(0,o.isTypedArray)(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==s?(0,o.toTypedArray)(e,s):(0,o.flatten)(e,[],!0),r.BV.makeTensor(e,t,s)}},3490:function(e,t,n){"use strict";n.d(t,{G:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143);let s=(0,n(73080).op)({tile_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t){let n=(0,a._1)(e,"x","tile","string_or_numeric");return o.hu(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`),r.BV.runKernel(i.n9L,{x:n},{reps:t})}})},59466:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({topk_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=1,n=!0){let o=(0,a._1)(e,"x","topk");if(0===o.rank)throw Error("topk() expects the input to be of rank 1 or higher");let s=o.shape[o.shape.length-1];if(t<0)throw Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>s)throw Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${t}`);let[u,l]=r.BV.runKernel(i.cWu,{x:o},{k:t,sorted:n});return{values:u,indices:l}}})},33072:function(e,t,n){"use strict";n.d(t,{p:function(){return f}});var r=n(58520),i=n(65139),a=n(89052),o=n(34950),s=n(31143),u=n(42812),l=n(97318),c=n(44591),d=n(73080),h=n(77860);let f=(0,d.op)({transpose_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let d=(0,o._1)(e,"x","transpose");if(null==t&&(t=d.shape.map((e,t)=>t).reverse()),s.hu(d.rank===t.length,()=>`Error in transpose: rank of input ${d.rank} must match length of perm ${t}.`),t.forEach(e=>{s.hu(e>=0&&e<d.rank,()=>`All entries in 'perm' must be between 0 and ${d.rank-1} but got ${t}`)}),d.rank<=1)return d.clone();let f={perm:t};return"complex64"===d.dtype?(0,i.lu)(()=>{let e=(0,h.k)(d),t=(0,l.a)(d);return e=r.BV.runKernel(a.G3Y,{x:e},f),t=r.BV.runKernel(a.G3Y,{x:t},f),n&&(t=(0,c.W)(t)),(0,u.P)(e,t)}):r.BV.runKernel(a.G3Y,{x:d},f)}})},30502:function(e,t,n){"use strict";n.d(t,{T:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143);let s=(0,n(73080).op)({unique_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=0){let n=(0,a._1)(e,"x","unique","string_or_numeric");(0,o.hu)(n.rank>0,()=>"The input tensor must be at least 1D");let[s,u]=r.BV.runKernel(i.kpP,{x:n},{axis:t});return{values:s,indices:u}}})},1818:function(e,t,n){"use strict";n.d(t,{p:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143);let s=(0,n(73080).op)({unsortedSegmentSum_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let s=(0,a._1)(e,"x","unsortedSegmentSum"),u=(0,a._1)(t,"segmentIds","unsortedSegmentSum","int32");return(0,o.hu)((0,o.GN)(n),()=>"numSegments must be of dtype int"),r.BV.runKernel(i.Qvg,{x:s,segmentIds:u},{numSegments:n})}})},89501:function(e,t,n){"use strict";n.d(t,{H:function(){return s}});var r=n(58520),i=n(89052),a=n(34950),o=n(31143);let s=(0,n(73080).op)({unstack_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t=0){let n=(0,a._1)(e,"x","unstack","string_or_numeric");return o.hu(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`),r.BV.runKernel(i.ToN,{value:n},{axis:t})}})},9670:function(e,t,n){"use strict";n.d(t,{a:function(){return u}});var r=n(58520),i=n(89052),a=n(34950),o=n(69580),s=n(87355);let u=(0,n(73080).op)({where_:/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e,t,n){let u=(0,a._1)(t,"a","where"),l=(0,a._1)(n,"b","where"),c=(0,a._1)(e,"condition","where","bool"),d=(0,s.assertAndGetBroadcastShape)((0,s.assertAndGetBroadcastShape)(c.shape,u.shape),l.shape),h=(0,o.U)(c,d),f=(0,o.U)(u,d),p=(0,o.U)(l,d);return r.BV.runKernel(i.PhF,{condition:h,t:f,e:p})}})},71647:function(e,t,n){"use strict";n.d(t,{l:function(){return(/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e(t,n="float32"){if((0,i.Mu)(t),"complex64"===n){let n=e(t,"float32"),r=e(t,"float32");return(0,a.P)(n,r)}let o=(0,i.wT)((0,i.NA)(t),n);return r.BV.makeTensor(o,t,n)})}});var r=n(58520),i=n(31143),a=n(42812)},33113:function(e,t,n){"use strict";n.d(t,{P:function(){return o}});var r=n(58520),i=n(89052),a=n(34950);let o=(0,n(73080).op)({zerosLike_:/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function(e){let t=(0,a._1)(e,"x","zerosLike");return r.BV.runKernel(i.RuY,{x:t})}})},41424:function(e,t,n){"use strict";/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}n.d(t,{j:function(){return r}})},85013:function(e,t,n){"use strict";n.d(t,{es:function(){return m},YD:function(){return l},_w:function(){return x},t3:function(){return g},FZ:function(){return p},Vp:function(){return f},Vi:function(){return h}});var r=n(16588),i=n(31143);function a(e,t,n){let r;return r=Array.isArray(e)?`${parseFloat(e[0].toFixed(7))} + ${parseFloat(e[1].toFixed(7))}j`:(0,i.HD)(e)?`'${e}'`:"bool"===n?o(e):parseFloat(e.toFixed(7)).toString(),(0,i.oj)(r,t)}function o(e){return 0===e?"false":"true"}function s(e){let t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var u=n(3165);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=i.NA(e),null!=n){let e=n.length;i.hu(e===this.size,()=>`Length of values '${e}' does not match the size inferred by the shape '${this.size}'.`)}if("complex64"===t)throw Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||i.rQ(t,this.size),this.strides=(0,i.e3)(e)}set(e,...t){0===t.length&&(t=[0]),i.hu(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);let n=this.locToIndex(t);this.values[n]=e}get(...e){0===e.length&&(e=[0]);let t=0;for(let n of e){if(n<0||n>=this.shape[t])throw Error(`Requested out of range element at ${e}.   Buffer shape=${this.shape}`);t++}let n=e[e.length-1];for(let t=0;t<e.length-1;++t)n+=this.strides[t]*e[t];return this.values[n]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];let t=Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return c().makeTensor(this.values,this.shape,this.dtype)}}let c=null,d=null;function h(e){c=e}function f(e){d=e}function p(e){}class m{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=i.NA(e),this.strides=(0,i.e3)(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){let e=await this.data();return d.buffer(this.shape,this.dtype,e)}bufferSync(){return d.buffer(this.shape,this.dtype,this.dataSync())}async array(){let e=await this.data();return(0,i.GX)(this.shape,e,"complex64"===this.dtype)}arraySync(){return(0,i.GX)(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();let e=c().read(this.dataId);if("string"===this.dtype){let t=await e;try{return t.map(e=>u.decodeString(e))}catch(e){throw Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),c().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();let e=c().readSync(this.dataId);if("string"===this.dtype)try{return e.map(e=>u.decodeString(e))}catch(e){throw Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();let e=await c().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),c().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw Error("Tensor is disposed.")}print(e=!1){return d.print(this,e)}clone(){return this.throwIfDisposed(),d.clone(this)}toString(e=!1){return function(e,t,n,r){let u=(0,i.e3)(t),l=function(e,t,n,r){let o=(0,i.NA)(t),u=r[r.length-1],l=Array(u).fill(0),c=t.length,d="complex64"===n?s(e):e;if(c>1)for(let e=0;e<o/u;e++){let t=e*u;for(let e=0;e<u;e++)l[e]=Math.max(l[e],a(d[t+e],0,n).length)}return l}(e,t,n,u),c=t.length,d=function e(t,n,r,i,u,l=!0){let c="complex64"===r?2:1,d=n[0],h=n.length;if(0===h)return"complex64"===r?[a(s(t)[0],0,r)]:"bool"===r?[o(t[0])]:[t[0].toString()];if(1===h){if(d>20){let e=Array.from(t.slice(0,3*c)),n=Array.from(t.slice((d-3)*c,d*c));return"complex64"===r&&(e=s(e),n=s(n)),["["+e.map((e,t)=>a(e,u[t],r)).join(", ")+", ..., "+n.map((e,t)=>a(e,u[d-3+t],r)).join(", ")+"]"]}return["["+("complex64"===r?s(t):Array.from(t)).map((e,t)=>a(e,u[t],r)).join(", ")+"]"]}let f=n.slice(1),p=i.slice(1),m=i[0]*c,g=[];if(d>20){for(let n=0;n<3;n++){let i=n*m,a=i+m;g.push(...e(t.slice(i,a),f,r,p,u,!1))}g.push("...");for(let n=d-3;n<d;n++){let i=n*m,a=i+m;g.push(...e(t.slice(i,a),f,r,p,u,n===d-1))}}else for(let n=0;n<d;n++){let i=n*m,a=i+m;g.push(...e(t.slice(i,a),f,r,p,u,n===d-1))}let x=2===h?",":"";g[0]="["+(d>0?g[0]+x:"");for(let e=1;e<g.length-1;e++)g[e]=" "+g[e]+x;let b=",\n";for(let e=2;e<h;e++)b+="\n";return g[g.length-1]=" "+g[g.length-1]+"]"+(l?"":b),g}(e,t,n,u,l),h=["Tensor"];return r&&(h.push(`  dtype: ${n}`),h.push(`  rank: ${c}`),h.push(`  shape: [${t}]`),h.push("  values:")),h.push(d.map(e=>"    "+e).join("\n")),h.join("\n")}(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),d.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),c().makeVariable(this,e,t,n)}}function g(){return(0,r.R)("Tensor",()=>m)}Object.defineProperty(m,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),g();class x extends m{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!i.cO(e.shape,this.shape))throw Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);c().disposeTensor(this),this.dataId=e.dataId,c().incRef(this,null)}dispose(){c().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(x,Symbol.hasInstance,{value:e=>e instanceof m&&null!=e.assign&&e.assign instanceof Function})},66484:function(e,t,n){"use strict";n.r(t),n.d(t,{assertTypesMatch:function(){return s},getTensorsInContainer:function(){return l},isTensorInList:function(){return u},makeTypesMatch:function(){return o}});var r=n(85013),i=n(77297),a=n(31143);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o(e,t){if(e.dtype===t.dtype)return[e,t];let n=(0,i.x8)(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function s(e,t){(0,a.hu)(e.dtype===t.dtype,()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`)}function u(e,t){return t.some(t=>t.id===e.id)}function l(e){let t=[];return function e(t,n,i){if(null!=t){if(t instanceof r.es){n.push(t);return}if(Array.isArray(t)||"object"==typeof t)for(let r in t){let a=t[r];i.has(a)||(i.add(a),e(a,n,i))}}}(e,t,new Set),t}},34950:function(e,t,n){"use strict";n.d(t,{C:function(){return l},_1:function(){return d},sI:function(){return h}});var r=n(58520),i=n(3845),a=n(85013),o=n(77297),s=n(3165),u=n(31143);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l(e,t){let n=e;if((0,s.isTypedArray)(e))return"string"===t?[]:[e.length];if((0,o.Oq)(e)){let t=e.channels||"RGBA";return[e.height,e.width*t.length]}if((0,o.$F)(e))return[e.buffer.size/(null==t?4:(0,u.bT)(t))];if(!Array.isArray(e))return[];let r=[];for(;Array.isArray(n)||(0,s.isTypedArray)(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&(0,i.OB)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function e(t,n,r){if(r=r||[],!Array.isArray(t)&&!(0,s.isTypedArray)(t)){(0,u.hu)(0===n.length,()=>`Element arr[${r.join("][")}] is a primitive, but should be an array/TypedArray of ${n[0]} elements`);return}(0,u.hu)(n.length>0,()=>`Element arr[${r.join("][")}] should be a primitive, but is an array of ${t.length} elements`),(0,u.hu)(t.length===n[0],()=>`Element arr[${r.join("][")}] should have ${n[0]} elements, but has ${t.length} elements`);let i=n.slice(1);for(let n=0;n<t.length;++n)e(t[n],i,r.concat(n))}(e,r,[]),r}function c(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function d(e,t,n,i="numeric"){if(e instanceof(0,a.t3)())return c(i,e.dtype,t,n),e;let o=(0,u.D2)(e);if("string"!==o&&["bool","int32","float32"].indexOf(i)>=0&&(o=i),c(i,o,t,n),null==e||!(0,s.isTypedArray)(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){let r=null==e?"null":e.constructor.name;throw Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${r}'`)}let d=l(e,o);(0,s.isTypedArray)(e)||Array.isArray(e)||(e=[e]);let h="string"!==o?(0,s.toTypedArray)(e,o):(0,s.flatten)(e,[],!0);return r.BV.makeTensor(h,d,o)}function h(e,t,n,r="numeric"){if(!Array.isArray(e))throw Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((e,i)=>d(e,`${t}[${i}]`,n,r))}},77297:function(e,t,n){"use strict";var r,i,a,o,s,u,l,c,d,h;n.d(t,{$F:function(){return x},Oq:function(){return g},x8:function(){return p},yw:function(){return r},z4:function(){return m}}),(u=r||(r={})).R0="R0",u.R1="R1",u.R2="R2",u.R3="R3",u.R4="R4",u.R5="R5",u.R6="R6",(l=i||(i={})).float32="float32",l.int32="int32",l.bool="int32",l.complex64="complex64",(c=a||(a={})).float32="float32",c.int32="int32",c.bool="bool",c.complex64="complex64",(d=o||(o={})).float32="float32",d.int32="float32",d.bool="float32",d.complex64="complex64",(h=s||(s={})).float32="complex64",h.int32="complex64",h.bool="complex64",h.complex64="complex64";let f={float32:o,int32:i,bool:a,complex64:s};function p(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw Error(`Can not upcast ${e} with ${t}`)}return f[e][t]}function m(e){return p(e,"int32")}function g(e){return null!=e&&"object"==typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function x(e){return"undefined"!=typeof GPUBuffer&&null!=e&&"object"==typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}},3165:function(e,t,n){"use strict";n.r(t),n.d(t,{arraysEqual:function(){return a.cO},arraysEqualWithNull:function(){return a.DK},assert:function(){return a.hu},assertNonNegativeIntegerDimensions:function(){return a.Mu},assertNonNull:function(){return a.Cq},assertShapesMatch:function(){return a.k5},bytesFromStringArray:function(){return a.Ub},bytesPerElement:function(){return a.bT},checkConversionForErrors:function(){return a.D5},clamp:function(){return a.uZ},computeStrides:function(){return a.e3},convertBackendValuesAndArrayBuffer:function(){return a.KS},createScalarValue:function(){return y},createShuffledIndices:function(){return a.U$},decodeString:function(){return I},distSquared:function(){return a.E7},encodeString:function(){return C},fetch:function(){return k},fingerPrint64:function(){return b},flatten:function(){return S},getArrayFromDType:function(){return a.rQ},getTypedArrayFromDType:function(){return a.WP},hasEncodingLoss:function(){return a.QB},hexToLong:function(){return u},indexToLoc:function(){return a.NE},inferDtype:function(){return a.D2},inferFromImplicitShape:function(){return a.JZ},isBoolean:function(){return a.jn},isFunction:function(){return a.mf},isInt:function(){return a.GN},isNumber:function(){return a.hj},isPromise:function(){return a.tI},isScalarShape:function(){return a.xH},isString:function(){return a.HD},isTypedArray:function(){return $},isValidDtype:function(){return a.LP},locToIndex:function(){return a.qy},makeOnesTypedArray:function(){return a.p8},makeZerosNestedTypedArray:function(){return a.l6},makeZerosTypedArray:function(){return a.wT},nearestDivisor:function(){return a.jP},nearestLargerEven:function(){return a.nY},now:function(){return w},parseAxisParam:function(){return a.EC},randUniform:function(){return a.bj},repeatedTry:function(){return a.WD},rightPad:function(){return a.oj},shuffle:function(){return a.TV},shuffleCombo:function(){return a.d7},sizeFromShape:function(){return a.NA},sizeToSquarishShape:function(){return a.YP},squeezeShape:function(){return a.bp},sum:function(){return a.Sm},swap:function(){return a.LF},tanh:function(){return a.AE},toNestedArray:function(){return a.GX},toTypedArray:function(){return v}});var r=n(3845),i=n(41424),a=n(31143),o=n(51627);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let s=n.n(o)()||o;function u(e){return s.fromString(e,!0,16)}let l=u("c3a5c85c97cb3127"),c=u("b492b66fbe98f273"),d=u("9ae16a3b2f90404f");function h(e){return e.xor(e.shru(47))}function f(e,t,n){let r=e.slice(t,t+n);return s.fromBytes(Array.from(r),!0,!0)}function p(e,t){return f(e,t,8)}function m(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function g(e,t,n=u("9ddfea08eb382d69")){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let i=t.xor(r).mul(n);return(i=i.xor(i.shru(47))).mul(n)}function x(e,t,n,r){return function(e,t,n,r,i,a){i=i.add(e),a=m(a.add(i).add(r),21);let o=i;return i=(i=i.add(t)).add(n),a=a.add(m(i,44)),[i.add(r),a.add(o)]}(p(e,t),p(e,t+8),p(e,t+16),p(e,t+24),n,r)}function b(e,t=e.length){let n=s.fromNumber(81,!0);if(t<=32)return t<=16?function(e,t=e.length){if(t>=8){let n=d.add(2*t),r=p(e,0).add(d),i=p(e,t-8);return g(m(i,37).mul(n).add(r),m(r,25).add(i).mul(n),n)}if(t>=4){let n=d.add(2*t);return g(f(e,0,4).shl(3).add(t),f(e,t-4,4),n)}if(t>0){let n=e[0],r=e[t>>1],i=e[t-1];return h(d.mul(n+(r<<8)).xor(l.mul(t+(i<<2)))).mul(d)}return d}(e,t):function(e,t=e.length){let n=d.add(2*t),r=p(e,0).mul(c),i=p(e,8),a=p(e,t-8).mul(n),o=p(e,t-16).mul(d);return g(m(r.add(i),43).add(m(a,30)).add(o),r.add(m(i.add(d),18)).add(a),n)}(e,t);if(t<=64)return function(e,t=e.length){let n=d.add(2*t),r=p(e,0).mul(d),i=p(e,8),a=p(e,t-8).mul(n),o=p(e,t-16).mul(d),s=m(r.add(i),43).add(m(a,30)).add(o),u=g(s,r.add(m(i.add(d),18)).add(a),n),l=p(e,16).mul(n),c=p(e,24),h=s.add(p(e,t-32)).mul(n),f=u.add(p(e,t-24)).mul(n);return g(m(l.add(c),43).add(m(h,30)).add(f),l.add(m(c.add(r),18)).add(h),n)}(e,t);let r=n,i=n.mul(c).add(113),a=h(i.mul(d).add(113)).mul(d),o=[s.UZERO,s.UZERO],u=[s.UZERO,s.UZERO];r=r.mul(d).add(p(e,0));let b=0,y=(t-1>>6)*64;do r=m(r.add(i).add(o[0]).add(p(e,b+8)),37).mul(c),i=m(i.add(o[1]).add(p(e,b+48)),42).mul(c),r=r.xor(u[1]),i=i.add(o[0]).add(p(e,b+40)),a=m(a.add(u[0]),33).mul(c),o=x(e,b,o[1].mul(c),r.add(u[0])),u=x(e,b+32,a.add(u[1]),i.add(p(e,b+16))),[a,r]=[r,a],b+=64;while(b!==y);let v=c.add(a.and(255).shl(1));return b=y+(t-1&63)-63,u[0]=u[0].add(t-1&63),o[0]=o[0].add(u[0]),u[0]=u[0].add(o[0]),r=m(r.add(i).add(o[0]).add(p(e,b+8)),37).mul(v),i=m(i.add(o[1]).add(p(e,b+48)),42).mul(v),r=r.xor(u[1].mul(9)),i=i.add(o[0].mul(9).add(p(e,b+40))),a=m(a.add(u[0]),33).mul(v),o=x(e,b,o[1].mul(v),r.add(u[0])),u=x(e,b+32,a.add(u[1]),i.add(p(e,b+16))),[a,r]=[r,a],g(g(o[0],u[0],v).add(h(i).mul(l)).add(a),g(o[1],u[1],v).add(r),v)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y(e,t){return"string"===t?C(e):v([e],t)}function v(e,t){var n;if("string"===t)throw Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=S(e)),(0,r.OB)().getBool("DEBUG")&&a.D5(e,t),(n=e)instanceof Float32Array&&"float32"===t||n instanceof Int32Array&&"int32"===t||n instanceof Uint8Array&&"bool"===t)return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){let t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)0!==Math.round(e[n])&&(t[n]=1);return t}throw Error(`Unknown data type ${t}`)}function w(){return(0,r.OB)().platform.now()}function k(e,t){return(0,r.OB)().platform.fetch(e,t)}function C(e,t="utf-8"){return t=t||"utf-8",(0,r.OB)().platform.encode(e,t)}function I(e,t="utf-8"){return t=t||"utf-8",(0,r.OB)().platform.decode(e,t)}function $(e){return null!=(0,r.OB)().platform.isTypedArray?(0,r.OB)().platform.isTypedArray(e):(0,i.j)(e)}function S(e,t=[],n=!1){if(null==t&&(t=[]),"boolean"==typeof e||"number"==typeof e||"string"==typeof e||a.tI(e)||null==e||$(e)&&n)t.push(e);else if(Array.isArray(e)||$(e))for(let r=0;r<e.length;++r)S(e[r],t,n);else{let r=-1;for(let t of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(t)&&(r=Math.max(r,Number(t)));for(let i=0;i<=r;i++)S(e[i],t,n)}return t}},31143:function(e,t,n){"use strict";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,s(e,--t,n)}function i(e,t){if(e.length!==t.length)throw Error(`Array sizes must match to be shuffled together First array length was ${e.length}Second array length was ${t.length}`);let n=e.length,r=0;for(;n>0;)r=Math.random()*n|0,s(e,--n,r),s(t,n,r)}function a(e,t,n){return Math.max(e,Math.min(t,n))}function o(e){return e%2==0?e:e+1}function s(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function u(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function l(e,t){let n=Math.random();return t*n+(1-n)*e}function c(e,t){let n=0;for(let r=0;r<e.length;r++){let i=Number(e[r])-Number(t[r]);n+=i*i}return n}function d(e,t){if(!e)throw Error("string"==typeof t?t:t())}function h(e,t,n=""){d(x(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function f(e){d(null!=e,()=>"The input to the tensor constructor must be a non-null value.")}function p(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function m(e){return 0===e.length}function g(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(null!==e[n]&&null!==t[n]&&e[n]!==t[n])return!1;return!0}function x(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function b(e){return e%1==0}function y(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return -1;{let t=Math.exp(2*e);return(t-1)/(t+1)}}function v(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function w(e){let t=new Uint32Array(e);for(let n=0;n<e;++n)t[n]=n;return r(t),t}function k(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function C(e,t=e=>0,n,r){return new Promise((i,a)=>{let o=0,s=()=>{if(e()){i();return}let u=t(++o);if(null!=n&&o>=n){a();return}null!=r?r(s,u):setTimeout(s,u)};s()})}function I(e,t){let n=1,r=-1;for(let t=0;t<e.length;++t)if(e[t]>=0)n*=e[t];else if(-1===e[t]){if(-1!==r)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${t}`);r=t}else if(e[t]<0)throw Error(`Shapes can not be < 0. Found ${e[t]} at dim ${t}`);if(-1===r){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(0===n)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!=0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);let i=e.slice();return i[r]=t/n,i}function $(e,t){let n=t.length;return d((e=null==e?t.map((e,t)=>t):[].concat(e)).every(e=>e>=-n&&e<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),d(e.every(e=>b(e)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(e=>e<0?n+e:e)}function S(e,t){let n=[],r=[],i=null!=t&&Array.isArray(t)&&0===t.length,a=null==t||i?null:$(t,e).sort(),o=0;for(let t=0;t<e.length;++t){if(null!=a){if(a[o]===t&&1!==e[t])throw Error(`Can't squeeze axis ${t} since its dim '${e[t]}' is not 1`);(null==a[o]||a[o]>t)&&1===e[t]&&(n.push(e[t]),r.push(t)),a[o]<=t&&o++}1!==e[t]&&(n.push(e[t]),r.push(t))}return{newShape:n,keptDims:r}}function E(e,t){return _(e,t)}function _(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else if("string"===e)n=Array(t);else throw Error(`Unknown data type ${e}`);return n}function T(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function N(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function R(e,t){return"complex64"!==t&&("float32"!==t||"complex64"===e)&&("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)}function A(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw Error(`Unknown dtype ${e}`)}function F(e){if(null==e)return 0;let t=0;return e.forEach(e=>t+=e.length),t}function O(e){return"string"==typeof e||e instanceof String}function B(e){return"boolean"==typeof e}function D(e){return"number"==typeof e}function P(e){return!!(e&&e.constructor&&e.call&&e.apply)}function M(e,t){for(let n=t;n<e;++n)if(e%n==0)return n;return e}function V(e){let t=e.length;if(t<2)return[];let n=Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function L(e,t,n=!1){if(0===e.length)return t[0];let r=e.reduce((e,t)=>e*t)*(n?2:1);if(0===r)return[];if(r!==t.length)throw Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return function e(t,n,r,i=!1){let a=[];if(1===n.length){let e=n[0]*(i?2:1);for(let n=0;n<e;n++)a[n]=r[t+n]}else{let o=n[0],s=n.slice(1),u=s.reduce((e,t)=>e*t)*(i?2:1);for(let n=0;n<o;n++)a[n]=e(t+n*u,s,r,i)}return a}(0,e,t,n)}function W(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw Error(`Unknown dtype ${t}`)}function G(e,t){let n=U(e,t);for(let e=0;e<n.length;e++)n[e]=1;return n}function U(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw Error(`Unknown data type ${t}`)}function z(e,t){let n=e.reduce((e,t)=>e*t,1);if(null==t||"float32"===t)return L(e,new Float32Array(n));if("int32"===t)return L(e,new Int32Array(n));if("bool"===t)return L(e,new Uint8Array(n));throw Error(`Unknown data type ${t}`)}function X(e){e.forEach(t=>{d(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function H(e,t,n){if(0===t)return 0;if(1===t)return e[0];let r=e[e.length-1];for(let t=0;t<e.length-1;++t)r+=n[t]*e[t];return r}function K(e,t,n){if(0===t)return[];if(1===t)return[e];let r=Array(t);for(let t=0;t<r.length-1;++t)r[t]=Math.floor(e/n[t]),e-=r[t]*n[t];return r[r.length-1]=e,r}function q(e){return e&&e.then&&"function"==typeof e.then}n.d(t,{AE:function(){return y},Cq:function(){return f},D2:function(){return function e(t){if(Array.isArray(t))return e(t[0]);if(t instanceof Float32Array);else if(t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray)return"int32";else if(D(t));else if(O(t))return"string";else if(B(t))return"bool";return"float32"}},D5:function(){return T},DK:function(){return g},E7:function(){return c},EC:function(){return $},GN:function(){return b},GX:function(){return L},HD:function(){return O},JZ:function(){return I},KS:function(){return W},LF:function(){return s},LP:function(){return N},Mu:function(){return X},NA:function(){return p},NE:function(){return K},QB:function(){return R},Sm:function(){return u},TV:function(){return r},U$:function(){return w},Ub:function(){return F},WD:function(){return C},WP:function(){return E},YP:function(){return v},bT:function(){return A},bj:function(){return l},bp:function(){return S},cO:function(){return x},d7:function(){return i},e3:function(){return V},hj:function(){return D},hu:function(){return d},jP:function(){return M},jn:function(){return B},k5:function(){return h},l6:function(){return z},mf:function(){return P},nY:function(){return o},oj:function(){return k},p8:function(){return G},qy:function(){return H},rQ:function(){return _},tI:function(){return q},uZ:function(){return a},wT:function(){return U},xH:function(){return m}})},51627:function(e){e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var i={},a={};function o(e,t){var n,r,o;return t?(e>>>=0,(o=0<=e&&e<256)&&(r=a[e]))?r:(n=u(e,(0|e)<0?-1:0,!0),o&&(a[e]=n),n):(e|=0,(o=-128<=e&&e<128)&&(r=i[e]))?r:(n=u(e,e<0?-1:0,!1),o&&(i[e]=n),n)}function s(e,t){if(isNaN(e))return t?x:g;if(t){if(e<0)return x;if(e>=f)return k}else{if(e<=-p)return C;if(e+1>=p)return w}return e<0?s(-e,t).neg():u(e%h|0,e/h|0,t)}function u(e,t,r){return new n(e,t,r)}n.fromInt=o,n.fromNumber=s,n.fromBits=u;var l=Math.pow;function c(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return c(e.substring(1),t,n).neg();for(var r,i=s(l(n,8)),a=g,o=0;o<e.length;o+=8){var u=Math.min(8,e.length-o),d=parseInt(e.substring(o,o+u),n);if(u<8){var h=s(l(n,u));a=a.mul(h).add(s(d))}else a=(a=a.mul(i)).add(s(d))}return a.unsigned=t,a}function d(e,t){return"number"==typeof e?s(e,t):"string"==typeof e?c(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}n.fromString=c,n.fromValue=d;var h=4294967296,f=18446744073709552e3,p=0x7fffffffffffffff,m=o(16777216),g=o(0);n.ZERO=g;var x=o(0,!0);n.UZERO=x;var b=o(1);n.ONE=b;var y=o(1,!0);n.UONE=y;var v=o(-1);n.NEG_ONE=v;var w=u(-1,2147483647,!1);n.MAX_VALUE=w;var k=u(-1,-1,!0);n.MAX_UNSIGNED_VALUE=k;var C=u(0,-2147483648,!1);n.MIN_VALUE=C;var I=n.prototype;I.toInt=function(){return this.unsigned?this.low>>>0:this.low},I.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},I.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(!this.eq(C))return"-"+this.neg().toString(e);var t=s(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}for(var i=s(l(e,6),this.unsigned),a=this,o="";;){var u=a.div(i),c=(a.sub(u.mul(i)).toInt()>>>0).toString(e);if((a=u).isZero())return c+o;for(;c.length<6;)c="0"+c;o=""+c+o}},I.getHighBits=function(){return this.high},I.getHighBitsUnsigned=function(){return this.high>>>0},I.getLowBits=function(){return this.low},I.getLowBitsUnsigned=function(){return this.low>>>0},I.getNumBitsAbs=function(){if(this.isNegative())return this.eq(C)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return 0!=this.high?t+33:t+1},I.isZero=function(){return 0===this.high&&0===this.low},I.eqz=I.isZero,I.isNegative=function(){return!this.unsigned&&this.high<0},I.isPositive=function(){return this.unsigned||this.high>=0},I.isOdd=function(){return(1&this.low)==1},I.isEven=function(){return(1&this.low)==0},I.equals=function(e){return r(e)||(e=d(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},I.eq=I.equals,I.notEquals=function(e){return!this.eq(e)},I.neq=I.notEquals,I.ne=I.notEquals,I.lessThan=function(e){return 0>this.comp(e)},I.lt=I.lessThan,I.lessThanOrEqual=function(e){return 0>=this.comp(e)},I.lte=I.lessThanOrEqual,I.le=I.lessThanOrEqual,I.greaterThan=function(e){return this.comp(e)>0},I.gt=I.greaterThan,I.greaterThanOrEqual=function(e){return this.comp(e)>=0},I.gte=I.greaterThanOrEqual,I.ge=I.greaterThanOrEqual,I.compare=function(e){if(r(e)||(e=d(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},I.comp=I.compare,I.negate=function(){return!this.unsigned&&this.eq(C)?C:this.not().add(b)},I.neg=I.negate,I.add=function(e){r(e)||(e=d(e));var t,n,i=this.high>>>16,a=65535&this.high,o=this.low>>>16,s=65535&this.low,l=e.high>>>16,c=65535&e.high,h=e.low>>>16,f=65535&e.low,p=0,m=0;return t=0+((n=0+(s+f))>>>16),n&=65535,t+=o+h,m+=t>>>16,t&=65535,m+=a+c,p+=m>>>16,m&=65535,p+=i+l,u(t<<16|n,(p&=65535)<<16|m,this.unsigned)},I.subtract=function(e){return r(e)||(e=d(e)),this.add(e.neg())},I.sub=I.subtract,I.multiply=function(e){if(this.isZero())return g;if(r(e)||(e=d(e)),t)return u(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(C))return e.isOdd()?C:g;if(e.eq(C))return this.isOdd()?C:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return s(this.toNumber()*e.toNumber(),this.unsigned);var n,i,a=this.high>>>16,o=65535&this.high,l=this.low>>>16,c=65535&this.low,h=e.high>>>16,f=65535&e.high,p=e.low>>>16,x=65535&e.low,b=0,y=0;return n=0+((i=0+c*x)>>>16),i&=65535,n+=l*x,y+=n>>>16,n&=65535,n+=c*p,y+=n>>>16,n&=65535,y+=o*x,b+=y>>>16,y&=65535,y+=l*p,b+=y>>>16,y&=65535,y+=c*f,b+=y>>>16,y&=65535,b+=a*x+o*p+l*f+c*h,u(n<<16|i,(b&=65535)<<16|y,this.unsigned)},I.mul=I.multiply,I.divide=function(e){if(r(e)||(e=d(e)),e.isZero())throw Error("division by zero");if(t){var n,i,a;return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?x:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return x;if(e.gt(this.shru(1)))return y;a=x}else{if(this.eq(C))return e.eq(b)||e.eq(v)?C:e.eq(C)?b:(n=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?b:v:(i=this.sub(e.mul(n)),a=n.add(i.div(e)));if(e.eq(C))return this.unsigned?x:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();a=g}for(i=this;i.gte(e);){for(var o=Math.ceil(Math.log(n=Math.max(1,Math.floor(i.toNumber()/e.toNumber())))/Math.LN2),c=o<=48?1:l(2,o-48),h=s(n),f=h.mul(e);f.isNegative()||f.gt(i);)n-=c,f=(h=s(n,this.unsigned)).mul(e);h.isZero()&&(h=b),a=a.add(h),i=i.sub(f)}return a},I.div=I.divide,I.modulo=function(e){return(r(e)||(e=d(e)),t)?u((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},I.mod=I.modulo,I.rem=I.modulo,I.not=function(){return u(~this.low,~this.high,this.unsigned)},I.and=function(e){return r(e)||(e=d(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},I.or=function(e){return r(e)||(e=d(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},I.xor=function(e){return r(e)||(e=d(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},I.shiftLeft=function(e){return(r(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},I.shl=I.shiftLeft,I.shiftRight=function(e){return(r(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},I.shr=I.shiftRight,I.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):32===e?u(t,0,this.unsigned):u(t>>>e-32,0,this.unsigned)},I.shru=I.shiftRightUnsigned,I.shr_u=I.shiftRightUnsigned,I.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},I.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},I.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},I.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},I.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},15661:function(e,t,n){var r=n(73202),i=n(4380),a=n(2755),o=n(48256),s=n(93893),u=n(75734),l=n(16905);l.alea=r,l.xor128=i,l.xorwow=a,l.xorshift7=o,l.xor4096=s,l.tychei=u,e.exports=l},73202:function(e,t,n){var r;!function(e,i,a){function o(e){var t,n=this,r=(t=4022871197,function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));t=r>>>0,r-=t,r*=t,t=r>>>0,r-=t,t+=4294967296*r}return(t>>>0)*23283064365386963e-26});n.next=function(){var e=2091639*n.s0+23283064365386963e-26*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1)}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new o(e),r=t&&t.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+(2097152*i()|0)*11102230246251565e-32},i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n.amdD&&n.amdO?void 0!==(r=(function(){return u}).call(t,n,t,i))&&(i.exports=r):this.alea=u}(0,e=n.nmd(e),n.amdD)},75734:function(e,t,n){var r;!function(e,i,a){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,i=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152;while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n.amdD&&n.amdO?void 0!==(r=(function(){return u}).call(t,n,t,i))&&(i.exports=r):this.tychei=u}(0,e=n.nmd(e),n.amdD)},4380:function(e,t,n){var r;!function(e,i,a){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new o(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152;while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n.amdD&&n.amdO?void 0!==(r=(function(){return u}).call(t,n,t,i))&&(i.exports=r):this.xor128=u}(0,e=n.nmd(e),n.amdD)},93893:function(e,t,n){var r;!function(e,i,a){function o(e){var t=this;t.next=function(){var e,n,r=t.w,i=t.X,a=t.i;return t.w=r=r+1640531527|0,n=i[a+34&127],e=i[a=a+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=i[a]=n^e,t.i=a,n+(r^r>>>16)|0},function(e,t){var n,r,i,a,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),i=0,a=-32;a<u;++a)t&&(r^=t.charCodeAt((a+32)%t.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,i=0==(n=s[127&a]^=r+o)?i+1:0);for(i>=128&&(s[127&(t&&t.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;e.w=o,e.X=s,e.i=i}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152;while(0===e);return e},i.int32=n.next,i.quick=i,r&&(r.X&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n.amdD&&n.amdO?void 0!==(r=(function(){return u}).call(t,n,t,i))&&(i.exports=r):this.xor4096=u}(0,e=n.nmd(e),n.amdD)},48256:function(e,t,n){var r;!function(e,i,a){function o(e){var t=this;t.next=function(){var e,n,r=t.x,i=t.i;return e=r[i],e^=e>>>7,n=e^e<<24^((e=r[i+1&7])^e>>>10)^((e=r[i+3&7])^e>>>3)^((e=r[i+4&7])^e<<7),e=r[i+7&7],e^=e<<13,n^=e^e<<9,r[i]=n,t.i=i+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(n=0,t=""+t;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152;while(0===e);return e},i.int32=n.next,i.quick=i,r&&(r.x&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n.amdD&&n.amdO?void 0!==(r=(function(){return u}).call(t,n,t,i))&&(i.exports=r):this.xorshift7=u}(0,e=n.nmd(e),n.amdD)},2755:function(e,t,n){var r;!function(e,i,a){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^(e^e<<1))|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152;while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n.amdD&&n.amdO?void 0!==(r=(function(){return u}).call(t,n,t,i))&&(i.exports=r):this.xorwow=u}(0,e=n.nmd(e),n.amdD)},16905:function(e,t,n){var r;!function(i,a,o){var s,u=o.pow(256,6),l=o.pow(2,52),c=2*l;function d(e,t,n){var r=[],d=p(function e(t,n){var r,i=[],a=typeof t;if(n&&"object"==a)for(r in t)try{i.push(e(t[r],n-1))}catch(e){}return i.length?i:"string"==a?t:t+"\0"}((t=!0==t?{entropy:!0}:t||{}).entropy?[e,m(a)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(256):(e=new Uint8Array(256),(i.crypto||i.msCrypto).getRandomValues(e)),m(e)}catch(e){var t=i.navigator,n=t&&t.plugins;return[+new Date,i,n,i.screen,m(a)]}}():e,3),r),g=new h(r),x=function(){for(var e=g.g(6),t=u,n=0;e<l;)e=(e+n)*256,t*=256,n=g.g(1);for(;e>=c;)e/=2,t/=2,n>>>=1;return(e+n)/t};return x.int32=function(){return 0|g.g(4)},x.quick=function(){return g.g(4)/4294967296},x.double=x,p(m(g.S),a),(t.pass||n||function(e,t,n,r){return(r&&(r.S&&f(r,g),e.state=function(){return f(g,{})}),n)?(o.random=e,t):e})(x,d,"global"in t?t.global:this==o,t.state)}function h(e){var t,n=e.length,r=this,i=0,a=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);i<256;)o[i]=i++;for(i=0;i<256;i++)o[i]=o[a=255&a+e[i%n]+(t=o[i])],o[a]=t;(r.g=function(e){for(var t,n=0,i=r.i,a=r.j,o=r.S;e--;)t=o[i=255&i+1],n=256*n+o[255&(o[i]=o[a=255&a+t])+(o[a]=t)];return r.i=i,r.j=a,n})(256)}function f(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function p(e,t){for(var n,r=e+"",i=0;i<r.length;)t[255&i]=255&(n^=19*t[255&i])+r.charCodeAt(i++);return m(t)}function m(e){return String.fromCharCode.apply(0,e)}if(p(o.random(),a),e.exports){e.exports=d;try{s=n(75042)}catch(e){}}else void 0!==(r=(function(){return d}).call(t,n,t,e))&&(e.exports=r)}("undefined"!=typeof self?self:this,[],Math)}}]);