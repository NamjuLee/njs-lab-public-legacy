"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[50673],{50673:function(t,e,s){s.r(e),s.d(e,{Solution:function(){return C}});var i=s(8483);class h{MouseDown(t,e){this.m.x=t,this.m.y=e,this.capture=this.FindNode(t,e)}MouseLeftClick(t,e){let s=this.AddNode(t,e),i=this.FindCloseNode(s);i&&this.AddEdge(s,i)}MouseMove(t,e){this.m.x=t,this.m.y=e}MouseDrag(t,e){this.capture&&(this.capture.v.x=t,this.capture.v.y=e)}AddNode(t,e){let s=new o(new i.h9(t,e),i.h9.Zero(),2);return this.nodes.push(s),s}AddEdge(t,e){let s=new n(t,e);return this.edges.push(s),s}FindCloseNode(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15e4,s=-1;for(let i=0;i<this.nodes.length;++i)if(this.nodes[i]!==t){let h=this.nodes[i].v.Distance(t.v);h<e&&(e=h,s=i)}if(-1!==s)return this.nodes[s]}FindNode(t,e){this.m.x=t,this.m.y=e;for(let t=0;t<this.nodes.length;++t)if(10>this.nodes[t].v.Distance(this.m))return this.capture=this.nodes[t],this.nodes[t];this.capture=void 0}Move(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-.3,h=arguments.length>3?arguments[3]:void 0;for(let n=0;n<this.nodes.length;++n){let o=this.nodes[n];o.f.x*=s,o.f.y*=s,o.f.z*=s;let a=new i.h9(t.x-o.v.x,t.y-o.v.y,t.z-o.v.z),d=a.Length();a.Unitize();let l=a.x*Math.exp(-.001*d*d)*10.1,r=a.y*Math.exp(-.001*d*d)*10.1,c=a.z*Math.exp(-.001*d*d)*10.1;isNaN(l)||(o.f.x=l,o.f.y=r,o.f.z=c),o.Move(h,e)}for(let t=0;t<this.edges.length;++t)this.edges[t].ApplySpringForce();for(let t=0;t<this.nodes.length;++t)this.nodes[t].CheckLine(this.edges);for(let t=0;t<this.nodes.length;++t)this.nodes[t].Move(h,e)}Render(t){this.Move(this.m,.9,0,.1),t.strokeStyle="#000ff0",t.lineWidth=1;for(let e=0;e<this.edges.length;++e)t.beginPath(),t.moveTo(this.edges[e].n0.v.x,this.edges[e].n0.v.y),t.lineTo(this.edges[e].n1.v.x,this.edges[e].n1.v.y),t.closePath(),t.stroke();t.fillStyle="#0000ff";for(let e=0;e<this.nodes.length;++e)t.beginPath(),t.arc(this.nodes[e].v.x,this.nodes[e].v.y,5*this.nodes[e].m,0,2*Math.PI),t.closePath(),t.fill()}constructor(){this.nodes=[],this.edges=[],this.capture=void 0,this.m=new i.h9(500,500),this.AddNode(50,50),this.AddNode(100,100),this.AddNode(100,50),this.AddEdge(this.nodes[0],this.nodes[1]),this.AddEdge(this.nodes[1],this.nodes[2]),this.AddEdge(this.nodes[2],this.nodes[0])}}class n{ApplySpringForce(){let t=new i.h9(this.n1.v.x-this.n0.v.x,this.n1.v.y-this.n0.v.y,this.n1.v.z-this.n0.v.z),e=t.Length();t.Unitize(),this.n0.f.x+=t.x*(e-this.targetLength)*this.SpringConstant,this.n0.f.y+=t.y*(e-this.targetLength)*this.SpringConstant,this.n0.f.z+=t.z*(e-this.targetLength)*this.SpringConstant,this.n1.f.x-=t.x*(e-this.targetLength)*this.SpringConstant,this.n1.f.y-=t.y*(e-this.targetLength)*this.SpringConstant,this.n1.f.z-=t.z*(e-this.targetLength)*this.SpringConstant}constructor(t,e){this.targetLength=1.05,this.SpringConstant=10.5,this.n0=t,this.n1=e;let s=this.n0.v.Distance(this.n1.v)-10;this.targetLength=s<50?60:s}}class o{Move(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.99;this.fixed||(this.u.x*=e,this.u.y*=e,this.u.z*=e,this.u.x+=this.f.x*(t/this.m),this.u.y+=this.f.y*(t/this.m),this.u.z+=this.f.z*(t/this.m),this.v.x+=this.u.x*t,this.v.y+=this.u.y*t,this.v.z+=this.u.z*t,this.needCompute=!0)}CheckLine(t){for(let e=0;e<t.length;++e){let s=t[e];if(s.n0!==this&&s.n1!==this){let t=this.PointCloseToLine(s.n0.v,s.n1.v,this.v);if(t[0]){let e=new i.h9(t[0],t[1]);if(5>e.Distance(this.v)){this.needCompute=!1,e.Unitize();let t=i.h9.Normalize(this.v),s=new i.h9(e.x-t.x,e.y-t.y,e.z-t.z);this.f=s}}}}}PointCloseToLine(t,e,s){let i=s.x-e.x,h=s.y-e.y,n=((t.x-e.x)*i+(t.y-e.y)*h)/(i*i+h*h);return[this.Lerp(e.x,s.x,n),this.Lerp(e.y,s.y,n)]}Lerp(t,e,s){return t+s*(e-t)}constructor(t,e,s=1){this.fixed=!1,this.needCompute=!0,this.m=1,this.v=t,this.u=e,this.f=i.h9.Origin(),this.m=s}}class a{InitCanvas(){let t=document.createElement("div");if(!t)return;this.divLocalMain=t,this.divLocalMain.style.display="flex",this.divLocalMain.style.width=this.width+"px",this.divLocalMain.style.height=this.height+"px",this.divLocalMain.style.margin="10px",this.divLocalMain.style.padding="10px",this.host.append(t);let e=document.createElement("div");if(!e)return;this.divCanvas=e,this.divLocalMain.append(e);let s=document.createElement("canvas");if(s){this.canvas=s,this.divCanvas.append(this.canvas),this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.backgroundColor="#aaaaaa";let t=this.canvas.getContext("2d");t&&(this.ctx=t,this.InitUI(),this.Init())}}InitUI(){let t=document.createElement("div");if(!t)return;this.divUI=t,this.divLocalMain.append(t),this.divUI.style.marginLeft="10px",this.divUI.style.width="100%";let e=document.createElement("button");e.textContent="reset",e.onclick=()=>{this.graphSystem.InitGraph()},this.divUI.append(e);let s=document.createElement("p");s&&(this.divUI.append(s),s.style.width="max-content",s.innerHTML="1. clikc on canvas to populate a node! <br> ",s.innerHTML+="2. drag a node to move! <br> ")}Init(){this.ctx.translate(.5*this.ctx.canvas.width,.5*this.ctx.canvas.height),this.ctx.scale(1,1),this.EventBind(),this.Loop()}EventBind(){this.canvas.onclick=t=>{this.prevent=!1,this.timer=setTimeout(()=>{if(!this.prevent){if(!this.click)return;this.MouseClick(t)}this.prevent=!1},this.delay)},this.canvas.ondblclick=t=>{clearTimeout(this.timer),this.prevent=!0,this.MouseDoubleClick(t)},this.canvas.addEventListener("wheel",t=>this.MouseWheel(t,t.deltaY)),this.canvas.onmousedown=t=>{this.click=!0,this.pressed=!0,this.MouseDown(t)},this.canvas.onmouseup=t=>{this.pressed=!1,this.MouseUp(t)},this.canvas.onmousemove=t=>{this.pressed&&(this.click=!1,this.MouseDrag(t)),this.MouseMove(t)},window.onresize=t=>this.Resize(t)}Resize(t){}Loop(){requestAnimationFrame(()=>{this.Loop()}),this.ctx.clearRect(-10,-10,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.fillStyle="#dddddd",this.ctx.beginPath(),this.ctx.rect(-500,-500,1e3,1e3),this.ctx.closePath(),this.ctx.fill(),this.Render(this.ctx)}Render(t){}MouseClick(t){}MouseDoubleClick(t){}MouseDown(t){}MouseUp(t){}MouseMove(t){}MouseDrag(t){}MouseWheel(t,e){}constructor(t,e=400,s=300){this.click=!1,this.pressed=!1,this.prevent=!1,this.delay=500,this.down=!1,this.t=0,this.graphSystem=t,this.width=e,this.height=s;let i=document.getElementById(t.id);if(!i)return;this.host=i,this.InitCanvas()}}class d{Init(){this.CanvasCore.Render=t=>this.Render(t),this.CanvasCore.MouseDown=t=>this.MouseDown(t),this.CanvasCore.MouseClick=t=>this.MouseClick(t),this.CanvasCore.MouseDoubleClick=t=>this.MouseDoubleClick(t),this.CanvasCore.MouseUp=t=>this.MouseUp(t),this.CanvasCore.MouseMove=t=>this.MouseMove(t),this.CanvasCore.MouseDrag=t=>this.MouseDrag(t)}InitGraph(){this.graph=new h}Render(t){this.graph.Render(t),t.fillStyle="rgba(255, 0, 0, 0.9)",t.beginPath(),t.arc(this.m.x,this.m.y,2.5,0,2*Math.PI),t.closePath(),t.fill()}Grid(t){for(let e=-10;e<10;++e)for(let s=-10;s<10;++s)t.beginPath(),t.fillStyle="rgba(255, 0, 0, 0.9)",t.arc(e,s,.05,0,2*Math.PI),t.closePath(),t.fill()}mouseRemap(t){this.m.x=t.offsetX-.5*this.CanvasCore.canvas.width,this.m.y=t.offsetY-.5*this.CanvasCore.canvas.height}MouseDown(t){this.mouseRemap(t),this.graph.MouseDown(this.m.x,this.m.y)}MouseUp(t){this.mouseRemap(t)}MouseMove(t){this.mouseRemap(t),this.graph.MouseMove(this.m.x,this.m.y)}MouseDrag(t){this.mouseRemap(t),this.graph.MouseDrag(this.m.x,this.m.y)}MouseClick(t){this.mouseRemap(t),this.graph.MouseLeftClick(this.m.x,this.m.y)}MouseDoubleClick(t){this.mouseRemap(t)}constructor(t){this.t=.9,this.m=new i.h9(0,0,0),this.id=t,this.CanvasCore=new a(this),this.Init(),this.InitGraph()}}class l{UpdateLength(t){for(let e=0;e<this.edges.length;++e)this.edges[e].targetLength=t}MouseDown(t,e){this.m.x=t,this.m.y=e,this.capture=this.FindNode(t,e)}MouseLeftClick(t,e){let s=this.AddNode(t,e),i=this.FindCloseNode(s);i&&this.AddEdge(s,i)}MouseMove(t,e){this.m.x=t,this.m.y=e}MouseDrag(t,e){this.capture&&(this.capture.v.x=t,this.capture.v.y=e)}AddNode(t,e){let s=new c(new i.h9(t,e),i.h9.Zero(),2);return this.nodes.push(s),s}AddEdge(t,e){let s=new r(t,e);return this.edges.push(s),s}FindCloseNode(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15e4,s=-1;for(let i=0;i<this.nodes.length;++i)if(this.nodes[i]!==t){let h=this.nodes[i].v.Distance(t.v);h<e&&(e=h,s=i)}if(-1!==s)return this.nodes[s]}FindNode(t,e){this.m.x=t,this.m.y=e;for(let t=0;t<this.nodes.length;++t)if(10>this.nodes[t].v.Distance(this.m))return this.capture=this.nodes[t],this.nodes[t];this.capture=void 0}Move(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-.3,h=arguments.length>3?arguments[3]:void 0;for(let n=0;n<this.nodes.length;++n){let o=this.nodes[n];o.f.x*=s,o.f.y*=s,o.f.z*=s;let a=new i.h9(t.x-o.v.x,t.y-o.v.y,t.z-o.v.z),d=a.Length();a.Unitize();let l=a.x*Math.exp(-.001*d*d)*10.1,r=a.y*Math.exp(-.001*d*d)*10.1,c=a.z*Math.exp(-.001*d*d)*10.1;isNaN(l)||(o.f.x=l,o.f.y=r,o.f.z=c),o.Move(h,e)}for(let t=0;t<this.edges.length;++t)this.edges[t].ApplySpringForce();for(let t=0;t<this.nodes.length;++t)this.nodes[t].CheckLine(this.edges);for(let t=0;t<this.nodes.length;++t)this.nodes[t].Move(h,e)}Render(t){this.Move(this.m,.9,0,.1),t.strokeStyle="#000ff0",t.lineWidth=1;for(let e=0;e<this.edges.length;++e)t.beginPath(),t.moveTo(this.edges[e].n0.v.x,this.edges[e].n0.v.y),t.lineTo(this.edges[e].n1.v.x,this.edges[e].n1.v.y),t.closePath(),t.stroke();t.fillStyle="#0000ff";for(let e=0;e<this.nodes.length;++e)t.beginPath(),t.arc(this.nodes[e].v.x,this.nodes[e].v.y,5*this.nodes[e].m,0,2*Math.PI),t.closePath(),t.fill()}constructor(){this.nodes=[],this.edges=[],this.capture=void 0,this.m=new i.h9(500,500),this.AddNode(50,50),this.AddNode(100,100),this.AddNode(100,50),this.AddEdge(this.nodes[0],this.nodes[1]),this.AddEdge(this.nodes[1],this.nodes[2]),this.AddEdge(this.nodes[2],this.nodes[0])}}class r{ApplySpringForce(){let t=new i.h9(this.n1.v.x-this.n0.v.x,this.n1.v.y-this.n0.v.y,this.n1.v.z-this.n0.v.z),e=t.Length();t.Unitize(),this.n0.f.x+=t.x*(e-this.targetLength)*this.SpringConstant,this.n0.f.y+=t.y*(e-this.targetLength)*this.SpringConstant,this.n0.f.z+=t.z*(e-this.targetLength)*this.SpringConstant,this.n1.f.x-=t.x*(e-this.targetLength)*this.SpringConstant,this.n1.f.y-=t.y*(e-this.targetLength)*this.SpringConstant,this.n1.f.z-=t.z*(e-this.targetLength)*this.SpringConstant}constructor(t,e){this.targetLength=1.05,this.SpringConstant=10.5,this.n0=t,this.n1=e;let s=this.n0.v.Distance(this.n1.v)-10;this.targetLength=s<50?60:s}}class c{Move(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.99;this.fixed||(this.u.x*=e,this.u.y*=e,this.u.z*=e,this.u.x+=this.f.x*(t/this.m),this.u.y+=this.f.y*(t/this.m),this.u.z+=this.f.z*(t/this.m),this.v.x+=this.u.x*t,this.v.y+=this.u.y*t,this.v.z+=this.u.z*t,this.needCompute=!0)}CheckLine(t){for(let e=0;e<t.length;++e){let s=t[e];if(s.n0!==this&&s.n1!==this){let t=this.PointCloseToLine(s.n0.v,s.n1.v,this.v);if(t[0]){let e=new i.h9(t[0],t[1]);if(5>e.Distance(this.v)){this.needCompute=!1,e.Unitize();let t=i.h9.Normalize(this.v),s=new i.h9(e.x-t.x,e.y-t.y,e.z-t.z);this.f=s}}}}}PointCloseToLine(t,e,s){let i=s.x-e.x,h=s.y-e.y,n=((t.x-e.x)*i+(t.y-e.y)*h)/(i*i+h*h);return[this.Lerp(e.x,s.x,n),this.Lerp(e.y,s.y,n)]}Lerp(t,e,s){return t+s*(e-t)}constructor(t,e,s=1){this.fixed=!1,this.needCompute=!0,this.m=1,this.v=t,this.u=e,this.f=i.h9.Origin(),this.m=s}}class v{InitCanvas(){let t=document.createElement("div");if(!t)return;this.divLocalMain=t,this.divLocalMain.style.display="flex",this.divLocalMain.style.width=this.width+"px",this.divLocalMain.style.height=this.height+"px",this.divLocalMain.style.margin="10px",this.divLocalMain.style.padding="10px",this.host.append(t);let e=document.createElement("div");if(!e)return;this.divCanvas=e,this.divLocalMain.append(e);let s=document.createElement("canvas");if(s){this.canvas=s,this.divCanvas.append(this.canvas),this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.backgroundColor="#aaaaaa";let t=this.canvas.getContext("2d");t&&(this.ctx=t,this.InitUI(),this.Init())}}InitUI(){let t=document.createElement("div");if(!t)return;this.divUI=t,this.divLocalMain.append(t),this.divUI.style.marginLeft="10px",this.divUI.style.width="100%";let e=document.createElement("button");e.textContent="reset",e.onclick=()=>{this.graphSystem.InitGraph()},this.divUI.append(e);let s=document.createElement("p");if(!s)return;this.divUI.append(s),s.textContent="length";let i=document.createElement("input");i.oninput=()=>{let t=+i.value;this.graphSystem.graph.UpdateLength(t)},i.type="range",i.min="10",i.max="100.0",i.value="10",this.divUI.append(i),(s=document.createElement("p"))&&(this.divUI.append(s),s.innerHTML="1. clikc on canvas to populate a node! <br> ",s.innerHTML+="2. drag a node to move! <br> ")}Init(){this.ctx.translate(.5*this.ctx.canvas.width,.5*this.ctx.canvas.height),this.ctx.scale(1,1),this.EventBind(),this.Loop()}EventBind(){this.canvas.onclick=t=>{this.prevent=!1,this.timer=setTimeout(()=>{if(!this.prevent){if(!this.click)return;this.MouseClick(t)}this.prevent=!1},this.delay)},this.canvas.ondblclick=t=>{clearTimeout(this.timer),this.prevent=!0,this.MouseDoubleClick(t)},this.canvas.addEventListener("wheel",t=>this.MouseWheel(t,t.deltaY)),this.canvas.onmousedown=t=>{this.click=!0,this.pressed=!0,this.MouseDown(t)},this.canvas.onmouseup=t=>{this.pressed=!1,this.MouseUp(t)},this.canvas.onmousemove=t=>{this.pressed&&(this.click=!1,this.MouseDrag(t)),this.MouseMove(t)},window.onresize=t=>this.Resize(t)}Resize(t){}Loop(){requestAnimationFrame(()=>{this.Loop()}),this.ctx.clearRect(-10,-10,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.fillStyle="#dddddd",this.ctx.beginPath(),this.ctx.rect(-500,-500,1e3,1e3),this.ctx.closePath(),this.ctx.fill(),this.Render(this.ctx)}Render(t){}MouseClick(t){}MouseDoubleClick(t){}MouseDown(t){}MouseUp(t){}MouseMove(t){}MouseDrag(t){}MouseWheel(t,e){}constructor(t,e=400,s=300){this.click=!1,this.pressed=!1,this.prevent=!1,this.delay=500,this.down=!1,this.t=0,this.graphSystem=t,this.width=e,this.height=s;let i=document.getElementById(t.id);if(!i)return;this.host=i,this.InitCanvas()}}class u{Init(){this.CanvasCore.Render=t=>this.Render(t),this.CanvasCore.MouseDown=t=>this.MouseDown(t),this.CanvasCore.MouseClick=t=>this.MouseClick(t),this.CanvasCore.MouseDoubleClick=t=>this.MouseDoubleClick(t),this.CanvasCore.MouseUp=t=>this.MouseUp(t),this.CanvasCore.MouseMove=t=>this.MouseMove(t),this.CanvasCore.MouseDrag=t=>this.MouseDrag(t)}InitGraph(){this.graph=new l}Render(t){this.graph.Render(t),t.fillStyle="rgba(255, 0, 0, 0.9)",t.beginPath(),t.arc(this.m.x,this.m.y,2.5,0,2*Math.PI),t.closePath(),t.fill()}Grid(t){for(let e=-10;e<10;++e)for(let s=-10;s<10;++s)t.beginPath(),t.fillStyle="rgba(255, 0, 0, 0.9)",t.arc(e,s,.05,0,2*Math.PI),t.closePath(),t.fill()}mouseRemap(t){this.m.x=t.offsetX-.5*this.CanvasCore.canvas.width,this.m.y=t.offsetY-.5*this.CanvasCore.canvas.height}MouseDown(t){this.mouseRemap(t),this.graph.MouseDown(this.m.x,this.m.y)}MouseUp(t){this.mouseRemap(t)}MouseMove(t){this.mouseRemap(t),this.graph.MouseMove(this.m.x,this.m.y)}MouseDrag(t){this.mouseRemap(t),this.graph.MouseDrag(this.m.x,this.m.y)}MouseClick(t){this.mouseRemap(t),this.graph.MouseLeftClick(this.m.x,this.m.y)}MouseDoubleClick(t){console.log("d click")}constructor(t){this.t=.9,this.m=new i.h9(0,0,0),this.id=t,this.CanvasCore=new v(this),this.Init(),this.InitGraph()}}class g{UpdateLength(t){for(let e=0;e<this.edges.length;++e)this.edges[e].targetLength=t}MouseDown(t,e){this.m.x=t,this.m.y=e,this.capture=this.FindNode(t,e)}MouseLeftClick(t,e){let s=this.AddNode(t,e),i=this.FindCloseNode(s);i&&this.AddEdge(s,i)}MouseMove(t,e){this.m.x=t,this.m.y=e}MouseDrag(t,e){this.capture&&(this.capture.v.x=t,this.capture.v.y=e)}AddNode(t,e){let s=new m(new i.h9(t,e),i.h9.Zero(),2);return this.nodes.push(s),s}AddEdge(t,e){let s=new p(t,e);return this.edges.push(s),s}FindCloseNode(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15e4,s=-1;for(let i=0;i<this.nodes.length;++i)if(this.nodes[i]!==t){let h=this.nodes[i].v.Distance(t.v);h<e&&(e=h,s=i)}if(-1!==s)return this.nodes[s]}FindNode(t,e){this.m.x=t,this.m.y=e;for(let t=0;t<this.nodes.length;++t)if(10>this.nodes[t].v.Distance(this.m))return this.capture=this.nodes[t],console.log(this.capture.colNodes),this.nodes[t];this.capture=void 0}Move(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-.3,h=arguments.length>3?arguments[3]:void 0;for(let e=0;e<this.nodes.length;++e){let h=this.nodes[e];h.f.x*=s,h.f.y*=s,h.f.z*=s;let n=new i.h9(t.x-h.v.x,t.y-h.v.y,t.z-h.v.z),o=n.Length();n.Unitize();let a=n.x*Math.exp(-.001*o*o)*10.1,d=n.y*Math.exp(-.001*o*o)*10.1,l=n.z*Math.exp(-.001*o*o)*10.1;isNaN(a)||(h.f.x=a,h.f.y=d,h.f.z=l)}for(let t=0;t<this.edges.length;++t)this.edges[t].ApplySpringForce();for(let t=0;t<this.nodes.length;++t)this.nodes[t].CheckLine(this.edges);for(let t=0;t<this.nodes.length;++t)this.nodes[t].isCol=!1;for(let t=0;t<this.nodes.length;++t){let e=this.nodes[t];for(let t=0;t<this.nodes.length;++t){let s=this.nodes[t];if(e!==s&&40>e.v.Distance(s.v)){let t=i.h9.Sub(e.u,s.u),h=i.h9.Normalize(t),n=i.h9.Scale(h,1);if(e.u=i.h9.Add(e.u,n),e.isCol=!0,this.historyTimer+=.1,this.historyTimer>5){e.colNodes.push(s),this.historyTimer=0,this.collisionTrajectory.push(new i.h9(e.v.x,e.v.y,(Math.random()+3)*3));let t=Math.random();t<.3?this.collisionTrajectory.push(new i.h9(100,0,0)):.3<t&&t<.6?this.collisionTrajectory.push(new i.h9(0,100,0)):this.collisionTrajectory.push(new i.h9(0,0,100))}}}}for(let t=0;t<this.nodes.length;++t)this.nodes[t].Move(h,e)}Render(t){for(let e=0;e<this.collisionTrajectory.length;e+=2){let s=this.collisionTrajectory[e],i=this.collisionTrajectory[e+1];t.beginPath(),t.fillStyle="rgba(".concat(i.x,", ").concat(i.y,", ").concat(i.z,", 0.1)"),t.arc(s.x,s.y,s.z,0,2*Math.PI),t.closePath(),t.fill()}this.Move(this.m,.9,0,.1),t.strokeStyle="#000ff0",t.lineWidth=1;for(let e=0;e<this.edges.length;++e)t.beginPath(),i.h9.Distance(this.edges[e].n0.v,this.edges[e].n1.v)<this.edges[e].targetLength-5&&(t.strokeStyle="#ff0000",this.edges[e].n0.isShort=!0,this.edges[e].n1.isShort=!0),t.moveTo(this.edges[e].n0.v.x,this.edges[e].n0.v.y),t.lineTo(this.edges[e].n1.v.x,this.edges[e].n1.v.y),t.closePath(),t.stroke();t.fillStyle="#0000ff";for(let e=0;e<this.nodes.length;++e)t.beginPath(),this.nodes[e].isShort&&(t.fillStyle="#fff000",this.nodes[e].isShort=!1),t.arc(this.nodes[e].v.x,this.nodes[e].v.y,5*this.nodes[e].m,0,2*Math.PI),t.closePath(),t.fill(),t.beginPath(),t.arc(this.nodes[e].v.x,this.nodes[e].v.y,20,0,2*Math.PI),t.closePath(),this.nodes[e].isCol?(t.lineWidth=4.5,t.strokeStyle="#ff0000"):(t.lineWidth=1,t.strokeStyle="#000000"),t.stroke()}constructor(){this.nodes=[],this.edges=[],this.capture=void 0,this.historyTimer=0,this.collisionTrajectory=[],this.m=new i.h9(500,500),this.AddNode(50,50),this.AddNode(100,100),this.AddNode(100,50),this.AddEdge(this.nodes[0],this.nodes[1]),this.AddEdge(this.nodes[1],this.nodes[2]),this.AddEdge(this.nodes[2],this.nodes[0])}}class p{ApplySpringForce(){let t=new i.h9(this.n1.v.x-this.n0.v.x,this.n1.v.y-this.n0.v.y,this.n1.v.z-this.n0.v.z),e=t.Length();t.Unitize(),this.n0.f.x+=t.x*(e-this.targetLength)*this.SpringConstant,this.n0.f.y+=t.y*(e-this.targetLength)*this.SpringConstant,this.n0.f.z+=t.z*(e-this.targetLength)*this.SpringConstant,this.n1.f.x-=t.x*(e-this.targetLength)*this.SpringConstant,this.n1.f.y-=t.y*(e-this.targetLength)*this.SpringConstant,this.n1.f.z-=t.z*(e-this.targetLength)*this.SpringConstant}constructor(t,e){this.targetLength=1.05,this.SpringConstant=10.5,this.n0=t,this.n1=e;let s=this.n0.v.Distance(this.n1.v)-10;this.targetLength=s<50?60:s}}class m{Move(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.99;this.fixed||(this.u.x*=e,this.u.y*=e,this.u.z*=e,this.u.x+=this.f.x*(t/this.m),this.u.y+=this.f.y*(t/this.m),this.u.z+=this.f.z*(t/this.m),this.v.x+=this.u.x*t,this.v.y+=this.u.y*t,this.v.z+=this.u.z*t,this.needCompute=!0)}CheckLine(t){for(let e=0;e<t.length;++e){let s=t[e];if(s.n0!==this&&s.n1!==this){let t=this.PointCloseToLine(s.n0.v,s.n1.v,this.v);if(t[0]){let e=new i.h9(t[0],t[1]);if(5>e.Distance(this.v)){this.needCompute=!1,e.Unitize();let t=i.h9.Normalize(this.v),s=new i.h9(e.x-t.x,e.y-t.y,e.z-t.z);this.f=s}}}}}PointCloseToLine(t,e,s){let i=s.x-e.x,h=s.y-e.y,n=((t.x-e.x)*i+(t.y-e.y)*h)/(i*i+h*h);return[this.Lerp(e.x,s.x,n),this.Lerp(e.y,s.y,n)]}Lerp(t,e,s){return t+s*(e-t)}constructor(t,e,s=1){this.fixed=!1,this.needCompute=!0,this.m=1,this.isShort=!1,this.isCol=!1,this.colNodes=[],this.v=t,this.u=e,this.f=i.h9.Origin(),this.m=s}}class f{InitCanvas(){let t=document.createElement("div");if(!t)return;this.divLocalMain=t,this.divLocalMain.style.display="flex",this.divLocalMain.style.width=this.width+"px",this.divLocalMain.style.height=this.height+"px",this.divLocalMain.style.margin="10px",this.divLocalMain.style.padding="10px",this.host.append(t);let e=document.createElement("div");if(!e)return;this.divCanvas=e,this.divLocalMain.append(e);let s=document.createElement("canvas");if(s){this.canvas=s,this.divCanvas.append(this.canvas),this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.backgroundColor="#aaaaaa";let t=this.canvas.getContext("2d");t&&(this.ctx=t,this.InitUI(),this.Init())}}InitUI(){let t=document.createElement("div");if(!t)return;this.divUI=t,this.divLocalMain.append(t),this.divUI.style.marginLeft="10px",this.divUI.style.width="100%";let e=document.createElement("button");e.textContent="reset",e.onclick=()=>{this.graphSystem.InitGraph()},this.divUI.append(e);let s=document.createElement("p");if(!s)return;this.divUI.append(s),s.textContent="length";let i=document.createElement("input");i.oninput=()=>{let t=+i.value;this.graphSystem.graph.UpdateLength(t)},i.type="range",i.min="10",i.max="100.0",i.value="10",this.divUI.append(i),(s=document.createElement("p"))&&(this.divUI.append(s),s.innerHTML="1. clikc on canvas to populate a node! <br> ",s.innerHTML+="2. drag a node to move! <br> ")}Init(){this.ctx.translate(.5*this.ctx.canvas.width,.5*this.ctx.canvas.height),this.ctx.scale(1,1),this.EventBind(),this.Loop()}EventBind(){this.canvas.onclick=t=>{this.prevent=!1,this.timer=setTimeout(()=>{if(!this.prevent){if(!this.click)return;this.MouseClick(t)}this.prevent=!1},this.delay)},this.canvas.ondblclick=t=>{clearTimeout(this.timer),this.prevent=!0,this.MouseDoubleClick(t)},this.canvas.addEventListener("wheel",t=>this.MouseWheel(t,t.deltaY)),this.canvas.onmousedown=t=>{this.click=!0,this.pressed=!0,this.MouseDown(t)},this.canvas.onmouseup=t=>{this.pressed=!1,this.MouseUp(t)},this.canvas.onmousemove=t=>{this.pressed&&(this.click=!1,this.MouseDrag(t)),this.MouseMove(t)},window.onresize=t=>this.Resize(t)}Resize(t){}Loop(){requestAnimationFrame(()=>{this.Loop()}),this.ctx.clearRect(-10,-10,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.fillStyle="#dddddd",this.ctx.beginPath(),this.ctx.rect(-500,-500,1e3,1e3),this.ctx.closePath(),this.ctx.fill(),this.Render(this.ctx)}Render(t){}MouseClick(t){}MouseDoubleClick(t){}MouseDown(t){}MouseUp(t){}MouseMove(t){}MouseDrag(t){}MouseWheel(t,e){}constructor(t,e=400,s=300){this.click=!1,this.pressed=!1,this.prevent=!1,this.delay=500,this.down=!1,this.t=0,this.graphSystem=t,this.width=e,this.height=s;let i=document.getElementById(t.id);if(!i)return;this.host=i,this.InitCanvas()}}class y{Init(){this.CanvasCore.Render=t=>this.Render(t),this.CanvasCore.MouseDown=t=>this.MouseDown(t),this.CanvasCore.MouseClick=t=>this.MouseClick(t),this.CanvasCore.MouseDoubleClick=t=>this.MouseDoubleClick(t),this.CanvasCore.MouseUp=t=>this.MouseUp(t),this.CanvasCore.MouseMove=t=>this.MouseMove(t),this.CanvasCore.MouseDrag=t=>this.MouseDrag(t)}InitGraph(){this.graph=new g}Render(t){this.graph.Render(t),t.fillStyle="rgba(255, 0, 0, 0.9)",t.beginPath(),t.arc(this.m.x,this.m.y,2.5,0,2*Math.PI),t.closePath(),t.fill()}Grid(t){for(let e=-10;e<10;++e)for(let s=-10;s<10;++s)t.beginPath(),t.fillStyle="rgba(255, 0, 0, 0.9)",t.arc(e,s,.05,0,2*Math.PI),t.closePath(),t.fill()}mouseRemap(t){this.m.x=t.offsetX-.5*this.CanvasCore.canvas.width,this.m.y=t.offsetY-.5*this.CanvasCore.canvas.height}MouseDown(t){this.mouseRemap(t),this.graph.MouseDown(this.m.x,this.m.y)}MouseUp(t){this.mouseRemap(t)}MouseMove(t){this.mouseRemap(t),this.graph.MouseMove(this.m.x,this.m.y)}MouseDrag(t){this.mouseRemap(t),this.graph.MouseDrag(this.m.x,this.m.y)}MouseClick(t){this.mouseRemap(t),this.graph.MouseLeftClick(this.m.x,this.m.y)}MouseDoubleClick(t){this.mouseRemap(t),console.log("d click")}constructor(t){this.t=.9,this.m=new i.h9(0,0,0),this.id=t,this.CanvasCore=new f(this),this.Init(),this.InitGraph()}}class M{constructor(t){new d(t),new u(t),new y(t)}}class x{static Init(t){new x(t).Dummy()}Dummy(){}constructor(t="SandBox"){let e=document.getElementById(t);e&&(this.host=e,this.host.style.overflow="auto"),this.implementation=new M(t)}}class C{destroy(){try{for(;this.divHost&&this.divHost.lastElementChild;){let t=this.divHost.lastElementChild;this.divHost.removeChild(t)}}catch(t){console.error("Error removing child elements:",t)}}constructor(t,e=0){this.divHost=document.getElementById(t);let s=document.createElement("div");s.id="ngl3d",s.style.width="100%",s.style.height="100%",this.divHost.appendChild(s),x.Init(s.id)}}}}]);