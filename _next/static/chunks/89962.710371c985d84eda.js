"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[89962],{50023:function(e,t,i){i.d(t,{al:function(){return n}});var r,a=i(59382);function n(e,t){var i=new a.WT(2);return i[0]=e,i[1]=t,i}r=new a.WT(2),a.WT!=Float32Array&&(r[0]=0,r[1]=0)},89962:function(e,t,i){i.r(t),i.d(t,{App:function(){return X},Renderer:function(){return q},Solution:function(){return H}});var r,a,n,s,o=i(81519);i(31859);let u=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.format=void 0===e.format?navigator.gpu.getPreferredCanvasFormat():e.format,e.msaaCount=void 0===e.msaaCount?1:e.msaaCount,f.includes("does not support WebGPU"))throw f;let i=await navigator.gpu.requestAdapter(),r=await i.requestDevice(t),a=e.canvas.getContext("webgpu");window.devicePixelRatio;let n={width:e.canvas.width,height:e.canvas.height};return a.configure({device:r,format:e.format,alphaMode:"opaque",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),{device:r,context:a,format:e.format,size:n,background:{r:.009,g:.0125,b:.0164,a:1},msaaCount:e.msaaCount}},f=navigator.gpu?"Great, your current browser supports WebGPU!":"Your current browser does not support WebGPU! Make sure you are on a system \n    with WebGPU enabled.",c=function(e){let t,i=!(arguments.length>1)||void 0===arguments[1]||arguments[1];e.primitiveType=void 0===e.primitiveType?"triangle-list":e.primitiveType,e.cullMode=void 0===e.cullMode?"none":e.cullMode,e.isDepthStencil=void 0===e.isDepthStencil||e.isDepthStencil,e.vsEntry=void 0===e.vsEntry?"vs_main":e.vsEntry,e.fsEntry=void 0===e.fsEntry?"fs_main":e.fsEntry,e.shader&&(e.vsShader=e.shader,e.fsShader=e.shader),e.indexFormat=void 0===e.indexFormat?"uint32":e.indexFormat,e.primitiveType.includes("strip")&&(t=e.indexFormat);let r={layout:"auto",vertex:{module:e.init.device.createShaderModule({code:e.vsShader}),entryPoint:e.vsEntry,buffers:e.buffers},fragment:i?{module:e.init.device.createShaderModule({code:e.fsShader}),entryPoint:e.fsEntry,targets:[{format:e.init.format}]}:void 0,primitive:{topology:e.primitiveType,stripIndexFormat:t,cullMode:e.cullMode},multisample:{count:e.init.msaaCount}};return e.isDepthStencil&&(r.depthStencil={format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"}),r},l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=e.length,n=t.length,s=r.length,o=[];if(0===n)for(let t=0;t<a;t++){let i=4*parseInt(e[t].split("x")[1]),a=0===s?t:r[t];o.push({arrayStride:i,attributes:[{shaderLocation:a,format:e[t],offset:0}]})}else{let a=[];for(let i=0;i<n;i++){parseInt(e[i].split("x")[1]);let n=0===s?i:r[i];a.push({shaderLocation:n,format:e[i],offset:t[i]})}o=[{arrayStride:i,attributes:a}]}return o},h=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=e.init.msaaCount>1?e.textureView:e.init.context.getCurrentTexture().createView(),r=e.init.msaaCount>1?e.init.context.getCurrentTexture().createView():void 0;return{colorAttachments:t?[{view:i,resolveTarget:r,clearValue:e.init.background,loadOp:"clear",storeOp:"store"}]:[],depthStencilAttachment:e.depthView?{view:e.depthView,depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store"}:void 0}};(n=r||(r={}))[n.Uniform=0]="Uniform",n[n.Vertex=1]="Vertex",n[n.Index=2]="Index",n[n.Storage=3]="Storage",n[n.VertexStorage=4]="VertexStorage",n[n.IndexStorage=5]="IndexStorage",n[n.Indirect=6]="Indirect",n[n.IndirectStorage=7]="IndirectStorage",n[n.Read=8]="Read",n[n.Write=9]="Write";let d=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC;return 1===i?r=GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC:2===i?r=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC:3===i?r=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC:4===i?r=GPUBufferUsage.VERTEX|GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST:5===i?r=GPUBufferUsage.INDEX|GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST:6===i?r=GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST:7===i?r=GPUBufferUsage.INDIRECT|GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST:8===i?r=GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST:9===i&&(r=GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST),e.createBuffer({size:t,usage:r})},p=e=>Object.prototype.toString.call(e).split(/\W/)[2],v=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC;0===i?r=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC:3===i?r=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC:2===i?r=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC:4===i?r=GPUBufferUsage.VERTEX|GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST:5===i?r=GPUBufferUsage.INDEX|GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST:6===i?r=GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST:7===i?r=GPUBufferUsage.INDIRECT|GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST:8===i?r=GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST:9===i&&(r=GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST);let a=p(t);1===i&&a.includes("Uint")&&(r=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC);let n=e.createBuffer({size:t.byteLength,usage:r,mappedAtCreation:!0});return a.includes("Uint32")?new Uint32Array(n.getMappedRange()).set(t):a.includes("Uint16")?new Uint16Array(n.getMappedRange()).set(t):a.includes("Float64")?new Float64Array(n.getMappedRange()).set(t):new Float32Array(n.getMappedRange()).set(t),n.unmap(),n},g=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=[],n=i.length,s=r.length,o=n+s;for(let e=0;e<o;e++)e<n&&n>0?a.push({binding:e,resource:{buffer:i[e]}}):e>=n&&s>0&&a.push({binding:e,resource:r[e-n]});return e.createBindGroup({layout:t,entries:a})},m=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"depth24plus";return e.device.createTexture({size:e.size,format:t,sampleCount:e.msaaCount,usage:GPUTextureUsage.RENDER_ATTACHMENT})},U=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1,1],r=o.Ue();return o.Iu(r,r,e),o.lM(r,r,t[0]),o.uD(r,r,t[1]),o.jI(r,r,t[2]),o.bA(r,r,i),r},P=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[2,2,4],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,1,0],r=o.Ue();return o.zB(r,e,t,i),{viewMat:r,cameraOptions:{eye:e,center:t,zoomMax:1e3,zoomSpeed:2}}},x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=o.Ue();return o.G3(t,2*Math.PI/5,e,.1,1e3),t},B=(e,t)=>{let i=o.Ue();return o.Jp(i,t,e),i},w=e=>{let t=o.Ue();return o.U_(t,e),o.p4(t,t),t},C=e=>{let[t,i,r]=e.match(/\w\w/g).map(e=>parseInt(e,16)/255);return new Float32Array([t,i,r,1])};var G=i(49644);let y=e=>Math.sin(e),S=e=>Math.cos(e),M=(e,t,i,r)=>{let a=(e+t*S(r))*S(i),n=t*y(r),s=-(e+t*S(r))*y(i);return G.al(a,n,s)},T=(e,t,i,r)=>{let a,n,s,o;if(i<2||r<2)return;let u=[],f=[],c=.06283185200000001/r;for(let l=0;l<=i;l++){let h=2*l*3.1415926/i;for(let i=0;i<=r;i++){let l=2*i*3.1415926/r;a=M(e,t,h,l),u.push(a[0],a[1],a[2]),h-c>=0?(n=M(e,t,h-c,l),s=G.$X(G.Ue(),a,n)):(n=M(e,t,h+c,l),s=G.$X(G.Ue(),n,a)),l-c>=0?(n=M(e,t,h,l-c),o=G.$X(G.Ue(),a,n)):(n=M(e,t,h,l+c),o=G.$X(G.Ue(),n,a));let d=G.kC(G.Ue(),o,s);G.Fv(d,d),f.push(d[0],d[1],d[2])}}let l=r+1,h=[],d=[];for(let e=0;e<i;e++)for(let t=0;t<r;t++){let i=t+e*l,r=t+1+e*l,a=t+1+(e+1)*l,n=t+(e+1)*l;h.push(i,r,a,a,n,i),d.push(i,r,i,n)}return{positions:new Float32Array(u),normals:new Float32Array(f),indices:new Uint32Array(h),indices2:new Uint32Array(d)}},b=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=e/2,a=new Float32Array([r,r,r,r,r,-r,r,-r,r,r,-r,-r,-r,r,-r,-r,r,r,-r,-r,-r,-r,-r,r,-r,r,-r,r,r,-r,-r,r,r,r,r,r,-r,-r,r,r,-r,r,-r,-r,-r,r,-r,-r,-r,r,r,r,r,r,-r,-r,r,r,-r,r,r,r,-r,-r,r,-r,r,-r,-r,-r,-r,-r]),n=new Float32Array([1,1,1,1,1,0,1,0,1,1,0,0,0,1,0,0,1,1,0,0,0,0,0,1,0,1,0,1,1,0,0,1,1,1,1,1,0,0,1,1,0,1,0,0,0,1,0,0,0,1,1,1,1,1,0,0,1,1,0,1,1,1,0,0,1,0,1,0,0,0,0,0]),s=new Float32Array([1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1]);return{positions:a,colors:n,normals:s,uvs:new Float32Array([0,i,t,i,0,0,t,0,0,i,t,i,0,0,t,0,0,i,t,i,0,0,t,0,0,i,t,i,0,0,t,0,0,i,t,i,0,0,t,0,0,i,t,i,0,0,t,0]),indices:new Uint32Array([0,2,1,2,3,1,4,6,5,6,7,5,8,10,9,10,11,9,12,14,13,14,15,13,16,18,17,18,19,17,20,22,21,22,23,21]),indices2:new Uint32Array([8,9,9,11,11,10,10,8,14,15,15,13,13,12,12,14,11,13,9,15,8,14,10,12])}};class O{constructor(e){_(e)}}let R=async(e,t,i)=>{let a=c({init:e,vsShader:'export default "#define GLSLIFY 1\\n// vertex shader\\n@group(0) @binding(0) var<uniform> viewProjectMat: mat4x4f;\\n@group(0) @binding(1) var<storage> modelMat: array<mat4x4f>;\\n@group(0) @binding(2) var<storage> normalMat: array<mat4x4f>;\\n@group(0) @binding(3) var<uniform> lightProjectMat: mat4x4f;\\n@group(0) @binding(4) var<storage> colorVec: array<vec4f>;\\n\\nstruct Input {\\n    @builtin(instance_index) idx : u32,\\n    @location(0) position : vec4f,\\n    @location(1) normal : vec4f,\\n};\\n\\nstruct Output {\\n    @builtin(position) position: vec4f,\\n    @location(0) vPosition: vec4f,\\n    @location(1) vNormal: vec4f,\\n    @location(2) vShadowPos: vec4f,\\n    @location(3) vColor: vec4f,\\n};\\n\\n@vertex\\nfn vs_main(in:Input) -> Output {    \\n    var output: Output;     \\n    let modelMat = modelMat[in.idx];\\n    let normalMat = normalMat[in.idx];\\n\\n    let mPosition = modelMat * in.position; \\n    output.vPosition = mPosition;                  \\n    output.vNormal =  normalMat * in.normal;\\n    output.position = viewProjectMat * mPosition;     \\n    output.vColor = colorVec[in.idx];\\n\\n    let lightPosition = lightProjectMat * mPosition;\\n    output.vShadowPos = vec4(lightPosition.xy*vec2(0.5, -0.5) + vec2(0.5, 0.5), lightPosition.z, 1.0);\\n\\n    return output;\\n}";',fsShader:'export default "#define GLSLIFY 1\\nstruct LightUniforms {\\n    lightPosition: vec4f,\\n    eyePosition: vec4f,\\n    specularColor: vec4f,\\n};\\n@group(1) @binding(0) var<uniform> light : LightUniforms;\\n\\nstruct MaterialUniforms {\\n    ambient: f32,\\n    diffuse: f32,\\n    specular: f32,\\n    shininess: f32,\\n};\\n@group(1) @binding(1) var<uniform> material : MaterialUniforms;\\n@group(1) @binding(2) var shadowTexture: texture_depth_2d;\\n@group(1) @binding(3) var shadowSampler: sampler_comparison;\\n\\nstruct Input {\\n    @location(0) vPosition: vec4f,\\n    @location(1) vNormal: vec4f,\\n    @location(2) vShadowPos: vec4f,\\n    @location(3) vColor: vec4f,\\n};\\n\\nfn blinnPhong(N:vec3f, L:vec3f, V:vec3f) -> vec2f {\\n    let H = normalize(L + V);\\n    var diffuse = material.diffuse * max(dot(N, L), 0.0);\\n    diffuse += material.diffuse * max(dot(-N, L), 0.0);\\n    var specular = material.specular * pow(max(dot(N, H), 0.0), material.shininess);\\n    specular += material.specular * pow(max(dot(-N, H),0.0), material.shininess);\\n    return vec2(diffuse, specular);\\n}\\n\\n@fragment\\nfn fs_main(in:Input) ->  @location(0) vec4f {\\n    var N = normalize(in.vNormal.xyz);                \\n    let L = normalize(light.lightPosition.xyz - in.vPosition.xyz);     \\n    let V = normalize(light.eyePosition.xyz - in.vPosition.xyz);          \\n   \\n    let bp = blinnPhong(N, L, V);\\n\\n    var visibility = 0.0;\\n    let size = f32(textureDimensions(shadowTexture).x);\\n    let oneOverSize = 1.0/size;\\n    for (var y: i32 = -1 ; y <= 1 ; y = y + 1) {\\n        for (var x: i32 = -1 ; x <= 1 ; x = x + 1) {\\n            let offset = vec2(f32(x)*oneOverSize, f32(y)*oneOverSize);\\n            visibility += textureSampleCompare(\\n                shadowTexture, \\n                shadowSampler,\\n                in.vShadowPos.xy + offset, \\n                in.vShadowPos.z - 0.007 \\n            );\\n        }\\n    }\\n    visibility /= 0.9;       \\n    let finalColor = in.vColor * (material.ambient + visibility * bp[0]) + light.specularColor * bp[1]; \\n    return vec4(finalColor.rgb, 1.0);\\n}";',buffers:l(["float32x3","float32x3"])}),n=await e.device.createRenderPipelineAsync(a),s=c({init:e,vsShader:'export default "#define GLSLIFY 1\\n@group(0) @binding(0) var<storage> modelMat: array<mat4x4f>;\\n@group(0) @binding(1) var<uniform> lightProjectMat: mat4x4f;\\n\\nstruct Input {\\n    @builtin(instance_index) idx : u32,\\n    @location(0) position : vec4f,\\n    @location(1) normal: vec4f,\\n};\\n\\n@vertex\\nfn vs_main(in:Input) -> @builtin(position) vec4f {\\n    let mPosition = modelMat[in.idx] * in.position;\\n    return lightProjectMat * mPosition;\\n}";',buffers:l(["float32x3","float32x3"])},!1),o=await e.device.createRenderPipelineAsync(s),u=m(e),f=e.device.createTexture({size:[2048,2048],format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),h=t.cubeData,p=v(e.device,h.positions),U=v(e.device,h.normals),P=v(e.device,h.indices),x=t.torusData,B=v(e.device,x.positions),w=v(e.device,x.normals),C=v(e.device,x.indices),G=t.torusData2,y=v(e.device,G.positions),S=v(e.device,G.normals),M=v(e.device,G.indices),T=d(e.device,64),b=d(e.device,64*i,r.Storage),O=d(e.device,64*i,r.Storage),R=d(e.device,16*i,r.Storage),_=d(e.device,64),A=d(e.device,48),I=d(e.device,16),E=g(e.device,n.getBindGroupLayout(0),[T,b,O,_,R]),D=g(e.device,n.getBindGroupLayout(1),[A,I],[f.createView(),e.device.createSampler({compare:"less"})]),Y=g(e.device,o.getBindGroupLayout(0),[b,_]);return{pipelines:[n,o],vertexBuffers:[p,U,P,B,w,C,y,S,M],uniformBuffers:[T,b,O,_,R,A,I],uniformBindGroups:[E,D,Y],depthTextures:[u,f]}},_=async e=>{let t=document.createElement("canvas");t.width=e.clientWidth,t.height=e.clientHeight,e.appendChild(t);let i=await u({canvas:t}),r={cubeData:b(),torusData:T(1.5,.1,60,20),torusData2:T(.8,.3,20,10)},a=await R(i,r,3),n=P([0,10,20]),s=B(n.viewMat,x(i.size.width/i.size.height));i.device.queue.writeBuffer(a.uniformBuffers[0],0,s);let f=new Float32Array(n.cameraOptions.eye);i.device.queue.writeBuffer(a.uniformBuffers[5],16,f);let c=[],l=new Float32Array(48),h=new Float32Array(48),d=new Float32Array(12);{let e=G.al(0,-13,-20),t=G.al(0,0,0),i=G.al(30,.1,20),r=U(e,t,i),a=w(r);l.set(r,0),h.set(a,0),d.set([.5,.5,.7,1],0),c.push({translation:e,rotation:t,scale:i})}{let e=G.al(0,-5,-20),t=G.al(Math.PI/2,0,0),i=G.al(4,4,4),r=U(e,t,i),a=w(r);l.set(r,16),h.set(a,16),d.set([Math.random(),Math.random(),Math.random()],4),c.push({translation:e,rotation:t,scale:i})}{let e=G.al(0,-5,-20),t=G.al(Math.PI,0,0),i=G.al(4,4,4),r=U(e,t,i),a=w(r);l.set(r,16),h.set(a,16),d.set([Math.random(),Math.random(),Math.random()],4),c.push({translation:e,rotation:t,scale:i})}i.device.queue.writeBuffer(a.uniformBuffers[4],0,d);let p=o.Ue(),v=o.Ue(),g=G.al(0,100,0),m=performance.now(),y=()=>{let e=1*(performance.now()-m)/1e3;g[0]=50*Math.sin(e),g[2]=50*Math.cos(e),i.device.queue.writeBuffer(a.uniformBuffers[5],0,g),i.device.queue.writeBuffer(a.uniformBuffers[5],32,C("#ffffff")),i.device.queue.writeBuffer(a.uniformBuffers[6],0,new Float32Array([.4,.04,.4,30])),o.zB(p,g,[0,0,0],[0,1,0]),o.M5(v,-40,40,-40,40,-50,200),o.Jp(v,v,p),i.device.queue.writeBuffer(a.uniformBuffers[3],0,v);let t=c[1];t.translation[0]<-20||t.translation[0],t.translation[1]<-5||t.translation[1];let n=U(t.translation,t.rotation,t.scale),s=w(n);l.set(n,16),h.set(s,16),i.device.queue.writeBuffer(a.uniformBuffers[1],0,l),i.device.queue.writeBuffer(a.uniformBuffers[2],0,h),A(i,a,r,3),requestAnimationFrame(y)};y()},A=(e,t,i,r)=>{let a=e.device.createCommandEncoder(),n=h({init:e,depthView:t.depthTextures[1].createView()},!1),s=a.beginRenderPass(n);s.setPipeline(t.pipelines[1]),s.setBindGroup(0,t.uniformBindGroups[2]),s.setVertexBuffer(0,t.vertexBuffers[0]),s.setVertexBuffer(1,t.vertexBuffers[1]),s.setIndexBuffer(t.vertexBuffers[2],"uint32"),s.drawIndexed(i.cubeData.indices.length,1,0,0,0),s.setVertexBuffer(0,t.vertexBuffers[3]),s.setVertexBuffer(1,t.vertexBuffers[4]),s.setIndexBuffer(t.vertexBuffers[5],"uint32"),s.drawIndexed(i.torusData.indices.length,1,0,0,1),s.setVertexBuffer(0,t.vertexBuffers[6]),s.setVertexBuffer(1,t.vertexBuffers[7]),s.setIndexBuffer(t.vertexBuffers[8],"uint32"),s.drawIndexed(i.torusData2.indices.length,1,0,0,1),s.end(),n=h({init:e,depthView:t.depthTextures[0].createView()});let o=a.beginRenderPass(n);for(let e in o.setPipeline(t.pipelines[0]),o.setBindGroup(0,t.uniformBindGroups[0]),o.setBindGroup(1,t.uniformBindGroups[1]),i);o.setVertexBuffer(0,t.vertexBuffers[0]),o.setVertexBuffer(1,t.vertexBuffers[1]),o.setIndexBuffer(t.vertexBuffers[2],"uint32"),o.drawIndexed(i.cubeData.indices.length,1,0,0,0),o.setVertexBuffer(0,t.vertexBuffers[3]),o.setVertexBuffer(1,t.vertexBuffers[4]),o.setIndexBuffer(t.vertexBuffers[5],"uint32"),o.drawIndexed(i.torusData.indices.length,1,0,0,1),o.setVertexBuffer(0,t.vertexBuffers[6]),o.setVertexBuffer(1,t.vertexBuffers[7]),o.setIndexBuffer(t.vertexBuffers[8],"uint32"),o.drawIndexed(i.torusData2.indices.length,1,0,0,1),o.end(),e.device.queue.submit([a.finish()])};var I=i(50023);class E{zoom(e){}update(){o.zB(this.viewMatrix,this.eye,this.center,this.up),o.Jp(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix)}constructor(e=100,t=100,i=[2,2,4],r=[0,0,0],a=[0,1,0],n=5){this.viewMatrix=o.Ue(),this.projectionMatrix=o.Ue(),this.viewProjectionMatrix=o.Ue(),this.zoomMax=100,this.zoomSpeed=2,this.near=.01,this.far=1e4,this.mvpMatrix=o.Ue(),this.eye=G.al(0,0,0),this.center=G.al(0,0,0),this.up=G.al(0,1,0),this.type="camera",this.angleXY=Math.PI,this.angleZ=.25*Math.PI,this.distance=1,this.distance=n,this.width=e,this.height=t,this.respectRatio=e/t,this.eye=i,this.center=r,this.up=a}}class D extends E{init(){o.G3(this.projectionMatrix,2*Math.PI/5,this.respectRatio,this.near,this.far),this.update()}zoom(e){this.distance+=.01*e}constructor(e=100,t=100,i=[2,2,4],r=[0,0,0],a=[0,1,0],n=3){super(e,t,i,r,a,n),this.type="CameraPerspective",this.init()}}class Y extends E{init(){z(this.projectionMatrix,this.width,this.height,this.near,this.far,this.distance),this.angleXY=0,this.angleZ=0,this.update()}zoom(e){this.distance+=e+50/this.distance,this.distance<1e-6&&(this.distance=1e-6),this.distance>1e5&&(this.distance=1e5),z(this.projectionMatrix,this.width,this.height,this.near,this.far,this.distance)}constructor(e=100,t=100,i=[0,0,1],r=[0,0,0],a=[0,1,0],n=300.1){super(e,t,i,r,a,n),this.type="CameraOrth",this.init()}}let z=(e,t,i,r,a,n)=>(e[0]=2/t*n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2/i*n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=-2/(a-r),e[11]=0,e[12]=0,e[13]=0,e[14]=.1,e[15]=1,e);class V{update(){this.camera.update(),N(this.modelMatrix,this.translation,this.rotation),o.Jp(this.mvpMatrix,this.camera.viewProjectionMatrix,this.modelMatrix)}rotateZ(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.rotation[2]+=e,this.update()}translateX(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.translation[0]+=e,this.update()}get getMatrix(){return this.mvpMatrix}shiftCamera(){this.camera===this.cameraPerspective?this.camera=this.cameraOrth:this.camera=this.cameraPerspective,this.update()}moveCamera(e,t){this.camera===this.cameraPerspective?this.arcRotation(e,t):this.pan(e,t)}arcRotation(e,t){e*=-.01,t*=-.01,this.camera.angleXY+=e,this.camera.angleZ+=t,this.camera.eye[0]=this.camera.center[0]+Math.sin(this.camera.angleXY)*Math.cos(this.camera.angleZ)*this.camera.distance,this.camera.eye[1]=this.camera.center[1]+Math.cos(this.camera.angleXY)*Math.cos(this.camera.angleZ)*this.camera.distance,this.camera.eye[2]=this.camera.center[2]+Math.sin(this.camera.angleZ)*this.camera.distance,this.update()}zoomWheel(e){this.camera===this.cameraPerspective?(this.camera.zoom(e),this.arcRotation(0,0)):this.camera.zoom(e),this.update()}pan(e,t){this.camera.center[0]+=e/this.camera.distance,this.camera.center[1]-=t/this.camera.distance,this.camera.eye[0]+=e/this.camera.distance,this.camera.eye[1]-=t/this.camera.distance,this.update()}constructor(e){this.modelMatrix=o.Ue(),this.mvpMatrix=o.Ue(),this.rotation=G.al(0,0,0),this.translation=G.al(0,0,0),this.screen2=I.al(0,0),this.solution=e,this.canvas=e.canvas;let t=G.al(2.6451475620269775,3.130298137664795,2.864337205886841),i=G.al(0,0,0),r=G.al(0,0,1);this.cameraPerspective=new D(this.canvas.width,this.canvas.height,t,i,r),this.camera=this.cameraPerspective,this.arcRotation(0,0),this.cameraOrth=new Y(this.canvas.width,this.canvas.height),this.camera=this.cameraOrth,this.update()}}let N=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=o.Ue(),n=o.Ue(),s=o.Ue(),u=o.Ue(),f=o.Ue();o.vc(u,t),o.aC(a,i[0]),o.gT(n,i[1]),o.QO(s,i[2]),o.xJ(f,r),o.Jp(e,a,f),o.Jp(e,n,e),o.Jp(e,s,e),o.Jp(e,u,e)};(s=a||(a={})).PointList="point-list",s.LineList="line-list",s.LineStrip="line-strip",s.TriangleList="triangle-list",s.TriangleStrip="triangle-strip";class F{async initWebGPU(){this.init=await W({canvas:this.renderer.canvas}),this.device=this.init.device,this.ctx=this.init.context,this.format=this.init.format,this.msaaCount=this.init.msaaCount,this.background=this.init.background,this.size=this.init.size}destroy(){this.device.destroy()}constructor(e){this.PrimitiveTopology=a,this.renderer=e}}let L=navigator.gpu?"Great, your current browser supports WebGPU!":"Your current browser does not support WebGPU! Make sure you are on a system with WebGPU enabled.",W=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.format=void 0===e.format?navigator.gpu.getPreferredCanvasFormat():e.format,e.msaaCount=void 0===e.msaaCount?1:e.msaaCount,L.includes("does not support WebGPU"))throw L;let i=await navigator.gpu.requestAdapter(),r=await i.requestDevice(t),a=e.canvas.getContext("webgpu");e.canvas.clientWidth,e.canvas.clientHeight;let n={width:e.canvas.width,height:e.canvas.height};return a.configure({device:r,format:e.format,alphaMode:"opaque",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),{device:r,context:a,format:e.format,size:n,background:{r:.009,g:.0125,b:.0164,a:1},msaaCount:e.msaaCount}};class q{async init(){await this.webGPU.initWebGPU(),this.cameraController=new V(this),this.requestAni=requestAnimationFrame(this.loop)}drawing(){this.app.scene.render()}destroy(){for(this.webGPU.destroy(),cancelAnimationFrame(this.requestAni);this.app.divHost.lastElementChild;)this.app.divHost.removeChild(this.app.divHost.lastElementChild)}constructor(e){this.isAnimation=!0,this.loop=()=>{this.isAnimation&&(this.requestAni=requestAnimationFrame(this.loop)),this.drawing()},this.app=e,this.canvas=document.createElement("canvas"),this.canvas.width=this.app.divHost.clientWidth,this.canvas.height=this.app.divHost.clientHeight,this.app.divHost.appendChild(this.canvas),this.webGPU=new F(this)}}class X{async init(){}destroy(){}constructor(e){this.divHost=document.getElementById(e),new O(this.divHost),this.init()}}class H{destroy(){this.app.destroy()}constructor(e){this.app=new X(e)}}}}]);