"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91053],{46049:function(t,e,i){i.d(e,{h:function(){return n},z:function(){return a}});var r=i(81519);let a=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],n=r.Ue(),s=r.Ue(),o=r.Ue(),h=r.Ue(),u=r.Ue();r.vc(h,e),r.aC(n,i[0]),r.gT(s,i[1]),r.QO(o,i[2]),r.xJ(u,a),r.Jp(t,n,u),r.Jp(t,s,t),r.Jp(t,o,t),r.Jp(t,h,t)},n=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[2,2,4],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,1,0],n=r.Ue(),s=r.Ue(),o=r.Ue();return r.G3(s,2*Math.PI/5,t,.1,100),r.zB(n,e,i,a),r.Jp(o,s,n),{viewMatrix:n,projectionMatrix:s,viewProjectionMatrix:o,cameraOption:{eye:e,center:i,zoomMax:100,zoomSpeed:2}}}},91053:function(t,e,i){i.r(e),i.d(e,{Solution:function(){return d}});var r=i(49644),a=i(81519);let n=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST,r=t.createBuffer({size:e.byteLength,usage:i,mappedAtCreation:!0});return new Uint32Array(r.getMappedRange()).set(e),r.unmap(),r},s=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST,r=t.createBuffer({size:e.byteLength,usage:i,mappedAtCreation:!0});return new Float32Array(r.getMappedRange()).set(e),r.unmap(),r};var o=i(46049);let h=()=>({vertexData:new Float32Array([-1,-1,1,0,0,1,1,-1,1,1,0,1,1,1,1,1,1,1,-1,1,1,0,1,1,-1,-1,-1,0,0,0,1,-1,-1,1,0,0,1,1,-1,1,1,0,-1,1,-1,0,1,0]),indexData:new Uint32Array([0,1,2,2,3,0,1,5,6,6,2,1,4,7,6,6,5,4,0,3,7,7,4,0,3,2,6,6,7,3,0,4,5,5,1,0])}),u=i(31859),c="\n\nstruct Uniforms {\n    mvpMatrix : mat4x4<f32>,\n};\n@binding(0) @group(0) var<uniform> uniforms : Uniforms;\n\nstruct Output {\n    @builtin(position) Position : vec4<f32>,\n    @location(0) vColor : vec4<f32>,\n};\n\n@vertex\nfn vs_main(@location(0) pos: vec4<f32>, @location(1) color: vec4<f32>) -> Output {\n    var output: Output;\n    output.Position = uniforms.mvpMatrix * pos;\n    output.vColor = color;\n    return output;\n}\n\n// fragment shader\n\n @fragment\nfn fs_main(@location(0) vColor: vec4<f32>) -> @location(0) vec4<f32> {\n    return vColor;\n}\n";class d{async initWebGPU(){if(!navigator.gpu)throw Error("Not Support WebGPU");let t=await navigator.gpu.requestAdapter({powerPreference:"high-performance"});if(!t)throw Error("No Adapter Found");let e=await t.requestDevice();this.ctx=this.canvas.getContext("webgpu");let i=navigator.gpu.getPreferredCanvasFormat?navigator.gpu.getPreferredCanvasFormat():this.ctx.getPreferredFormat(t);window.devicePixelRatio,this.canvas.width=this.divHost.clientWidth,this.canvas.height=this.divHost.clientHeight,this.ctx.configure({device:e,format:i,alphaMode:"opaque"}),this.size={width:this.canvas.width,height:this.canvas.height},this.device=e,this.format=i,this.camera=new l(this),this.initPipeline(this.device,this.format)}async initPipeline(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let i=h();this.numberOfVertices=i.indexData.length,this.vertexBuffer=s(t,i.vertexData),this.colorBuffer=n(t,i.indexData),this.pipeline=t.createRenderPipeline({layout:"auto",vertex:{module:t.createShaderModule({code:c}),entryPoint:"vs_main",buffers:[{arrayStride:24,attributes:[{shaderLocation:0,format:"float32x3",offset:0},{shaderLocation:1,format:"float32x3",offset:12}]}]},fragment:{module:t.createShaderModule({code:c}),entryPoint:"fs_main",targets:[{format:this.format}]},primitive:{topology:"triangle-list"},depthStencil:{format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"}}),this.uniformBuffer=t.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.uniformBindGroup=t.createBindGroup({layout:this.pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.uniformBuffer,offset:0,size:64}}]}),this.textureView=this.ctx.getCurrentTexture().createView(),this.depthTexture=t.createTexture({size:[this.canvas.width,this.canvas.height,1],format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT}),this.renderPassDescription={colorAttachments:[{view:this.textureView,clearValue:{r:0,g:0,b:0,a:1},loadValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}],depthStencilAttachment:{view:this.depthTexture.createView(),depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store"}},this.requestAni=requestAnimationFrame(this.loop)}drawing(){this.camera.update(),this.device.queue.writeBuffer(this.uniformBuffer,0,this.camera.mvpMatrix),this.textureView=this.ctx.getCurrentTexture().createView(),this.renderPassDescription.colorAttachments[0].view=this.textureView;let t=this.device.createCommandEncoder(),e=t.beginRenderPass(this.renderPassDescription);e.setPipeline(this.pipeline),e.setVertexBuffer(0,this.vertexBuffer),e.setIndexBuffer(this.colorBuffer,"uint32"),e.setBindGroup(0,this.uniformBindGroup),e.drawIndexed(this.numberOfVertices),e.end(),this.device.queue.submit([t.finish()])}destroy(){for(this.device.destroy(),cancelAnimationFrame(this.requestAni);this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}constructor(t){this.isAnimation=!0,this.rotation=r.al(0,0,0),this.loop=()=>{this.isAnimation?(this.rotation[0]+=.01,this.rotation[1]+=.01,this.rotation[2]+=.01):this.rotation=[0,0,0],this.drawing(),this.isAnimation&&(this.requestAni=requestAnimationFrame(this.loop))},this.divHost=document.getElementById(t),this.canvas=document.createElement("canvas"),this.divHost.appendChild(this.canvas),this.initWebGPU()}}class l{update(){let t=this.vp.projectionMatrix;this.vMatrix=this.camera.matrix,a.Jp(this.vpMatrix,t,this.vMatrix),(0,o.z)(this.modelMatrix,this.translation,this.rotation),a.Jp(this.mvpMatrix,this.vpMatrix,this.modelMatrix)}constructor(t){this.rotation=r.al(0,0,0),this.translation=r.al(0,0,0),this.solution=t,this.canvas=t.canvas,this.modelMatrix=a.Ue(),this.mvpMatrix=a.Ue(),this.vMatrix=a.Ue(),this.vpMatrix=a.Ue(),this.vp=(0,o.h)(this.canvas.width/this.canvas.height),this.vpMatrix=this.vp.viewProjectionMatrix,this.camera=u(this.canvas,this.vp.cameraOption)}}}}]);