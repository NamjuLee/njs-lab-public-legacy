"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[61466],{9736:function(t,e,r){r.d(e,{L:function(){return i},v:function(){return n}});let n=15.5,i=1024},32412:function(t,e,r){r.d(e,{Ht:function(){return n},QS:function(){return o},jL:function(){return i}});let n=8388607,i=t=>t&n;function o(t,e){return((e?8388608:0)|t)>>>0}},66829:function(t,e,r){let n;r.d(e,{yu:function(){return k},XB:function(){return A},Qt:function(){return M},ri:function(){return H},oo:function(){return E},Pz:function(){return K},Ou:function(){return D},qH:function(){return C},xh:function(){return z},Kw:function(){return F},e5:function(){return O}});var i=r(86641);r(37180);var o=r(65223),s=r(44340),u=r(94605),a=r(20002),l=r(26158);let c=()=>o.Z.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");class d{constructor(){this._includedModules=new Map}include(t,e){this._includedModules.has(t)?this._includedModules.get(t):(this._includedModules.set(t,e),t(this.builder,e))}}class p extends d{constructor(){super(...arguments),this.vertex=new y,this.fragment=new y,this.attributes=new m,this.varyings=new v,this.extensions=new b,this.constants=new g}get fragmentUniforms(){return this.fragment.uniforms.entries}get builder(){return this}generate(t,e=!0){let r=this.extensions.generateSource(t),n=this.attributes.generateSource(t),i=this.varyings.generateSource(t),o="vertex"===t?this.vertex:this.fragment,s=o.uniforms.generateSource(),u=o.code.generateSource(),a="vertex"===t?_:function(t=!0){return`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
  precision highp sampler2D;
#else
  precision mediump float;
  precision mediump sampler2D;
#endif
${t?"out vec4 fragColor;":""}
`}(e),l=this.constants.generateSource().concat(o.constants.generateSource());return`${e?"#version 300 es":""}
${r.join("\n")}
${a}
${l.join("\n")}
${s.join("\n")}
${n.join("\n")}
${i.join("\n")}
${u.join("\n")}`}generateBindPass(t){let e=new Map;this.vertex.uniforms.entries.forEach(t=>{let r=t.bind[a.P.Pass];r&&e.set(t.name,r)}),this.fragment.uniforms.entries.forEach(t=>{let r=t.bind[a.P.Pass];r&&e.set(t.name,r)});let r=Array.from(e.values()),n=r.length;return(e,i)=>{for(let o=0;o<n;++o)r[o](t,e,i)}}generateBindDraw(t){let e=new Map;this.vertex.uniforms.entries.forEach(t=>{let r=t.bind[a.P.Draw];r&&e.set(t.name,r)}),this.fragment.uniforms.entries.forEach(t=>{let r=t.bind[a.P.Draw];r&&e.set(t.name,r)});let r=Array.from(e.values()),n=r.length;return(e,i,o)=>{for(let s=0;s<n;++s)r[s](t,e,i,o)}}}class h{constructor(){this._entries=new Map}add(...t){for(let e of t)this._add(e)}get(t){return this._entries.get(t)}_add(t){if(null!=t){if(this._entries.has(t.name)&&!this._entries.get(t.name).equals(t))throw new u.Z(`Duplicate uniform name ${t.name} for different uniform type`);this._entries.set(t.name,t)}else c().error(`Trying to add null Uniform from ${Error().stack}.`)}generateSource(){return Array.from(this._entries.values()).map(t=>null!=t.arraySize?`uniform ${t.type} ${t.name}[${t.arraySize}];`:`uniform ${t.type} ${t.name};`)}get entries(){return Array.from(this._entries.values())}}class f{constructor(){this._entries=[]}add(t){this._entries.push(t)}generateSource(){return this._entries}}class y extends d{constructor(){super(...arguments),this.uniforms=new h,this.code=new f,this.constants=new g}get builder(){return this}}class m{constructor(){this._entries=[]}add(t,e){this._entries.push([t,e])}generateSource(t){return"fragment"===t?[]:this._entries.map(t=>`in ${t[1]} ${t[0]};`)}}class v{constructor(){this._entries=new Map}add(t,e){this._entries.has(t)&&(0,l.hu)(this._entries.get(t)===e),this._entries.set(t,e)}generateSource(t){let e=[];return this._entries.forEach((r,n)=>e.push("vertex"===t?`out ${r} ${n};`:`in ${r} ${n};`)),e}}class b{constructor(){this._entries=new Set}add(t){this._entries.add(t)}generateSource(t){let e="vertex"===t?b.ALLOWLIST_VERTEX:b.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter(t=>e.includes(t)).map(t=>`#extension ${t} : enable`)}}b.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],b.ALLOWLIST_VERTEX=[];class g{constructor(){this._entries=new Set}add(t,e,r){let n="ERROR_CONSTRUCTOR_STRING";switch(e){case"float":n=g._numberToFloatStr(r);break;case"int":n=g._numberToIntStr(r);break;case"bool":n=r.toString();break;case"vec2":n=`vec2(${g._numberToFloatStr(r[0])},                            ${g._numberToFloatStr(r[1])})`;break;case"vec3":n=`vec3(${g._numberToFloatStr(r[0])},                            ${g._numberToFloatStr(r[1])},                            ${g._numberToFloatStr(r[2])})`;break;case"vec4":n=`vec4(${g._numberToFloatStr(r[0])},                            ${g._numberToFloatStr(r[1])},                            ${g._numberToFloatStr(r[2])},                            ${g._numberToFloatStr(r[3])})`;break;case"ivec2":n=`ivec2(${g._numberToIntStr(r[0])},                             ${g._numberToIntStr(r[1])})`;break;case"ivec3":n=`ivec3(${g._numberToIntStr(r[0])},                             ${g._numberToIntStr(r[1])},                             ${g._numberToIntStr(r[2])})`;break;case"ivec4":n=`ivec4(${g._numberToIntStr(r[0])},                             ${g._numberToIntStr(r[1])},                             ${g._numberToIntStr(r[2])},                             ${g._numberToIntStr(r[3])})`;break;case"mat2":case"mat3":case"mat4":n=`${e}(${Array.prototype.map.call(r,t=>g._numberToFloatStr(t)).join(", ")})`}return this._entries.add(`const ${e} ${t} = ${n};`),this}static _numberToIntStr(t){return t.toFixed(0)}static _numberToFloatStr(t){return Number.isInteger(t)?t.toFixed(1):t.toString()}generateSource(){return Array.from(this._entries)}}let _="precision highp float;\nprecision highp sampler2D;";var w=r(85495);function x(t,e,r){for(let n of e.split("\n"))if(n.trim().length){{let e="";null!=r&&(e+=`/*id:${r??"000"}*/   `),t.body+=e.padEnd(14)}t.body+=" ".repeat(t.indent)+n+"\n"}}class S{write(t){for(let e of t.rootOutputNodes())t.shouldPruneOutputNode(e)||(e.variableName=this._write(t,e.node));return t}_createVarName(t,e){let r="";return"boolean"!=typeof e&&"number"!=typeof e&&e.debugInfo.name&&(r=`${e.debugInfo.name}_`),`${r}v${t.varCount++}`}_write(t,e,r=!1){if("number"==typeof e||"boolean"==typeof e)return e.toString();let n=t.getEmit(e);if(n)return n;switch(e.shaderType){case"scope-node":n=this._writeScopeNode(t,e);break;case"primitive-node":n=this._writePrimitiveNode(t,e,r);break;case"function-node":n=this._writeFunctionNode(t,e);break;case"property-access-node":n=this._writePropertyAccessNode(t,e);break;case"text-node":n=e.text;break;case"block-node":n=this._writeBlockNode(t,e);break;case"condition-node":n=this._writeConditionNode(t,e)}return t.setEmit(e,n),n}_writeScopeNode(t,e){let r=new e.child.constructor;r.setDebugName(e.debugInfo.name);let n=this._write(t,r,!0);return x(t,`{ /*ScopeStart: ${e.uid} ${e.debugInfo.name}*/`),t.indent+=2,x(t,`${n} = ${this._write(t,e.child)};`),t.indent-=2,x(t,`} /*ScopeEnd: ${e.uid} ${e.debugInfo.name}*/`),n}_writeConditionNode(t,e){let r=new e.ifTrue.constructor,n=this._write(t,r,!0);x(t,`if (${this._write(t,e.condition)}) {`),t.indent+=2;let i=t.createSubgraphContext(),o=this._write(i,e.ifTrue);if(t.body+=i.body,o&&x(t,`${n} = ${o};`),t.indent-=2,x(t,"}"),e.ifFalse){x(t,"else {"),t.indent+=2;let r=t.createSubgraphContext(),i=this._write(r,e.ifFalse);t.body+=r.body,i&&x(t,`${n} = ${i};`),t.indent-=2,x(t,"}")}return n}_writeBlockNode(t,e){let{captureList:r,generator:n,returnType:i}=e,o={};for(let e in r){if(!r[e])continue;let n=this._write(t,r[e]);o[e]=n}let s=new i,u=this._write(t,s,!0);if(o.out=u,e.subgraph){let r=t.createSubgraphContext(),n=this._write(r,e.subgraph.child),i=r.body;o.subgraph={varName:n,body:i}}let a=n(o);return x(t,"{\n"),t.indent+=2,x(t,a),t.indent-=2,x(t,"}\n"),u}_writePropertyAccessNode(t,e){let r=this._write(t,e.target);return"string"==typeof e.property&&e.property.includes("[")?`${r}${e.property}`:"string"!=typeof e.property?`${r}[${this._write(t,e.property)}]`:`${r}.${e.property}`}_writeFunctionNode(t,e){let r=e.returnType.type;if(e.isInfix){let[n,i]=e.children.map(e=>this._write(t,e)),o=this._createVarName(t,e);return x(t,`${r.padEnd(5)} ${o} = ${n} ${e.token} ${i};`,e.uid),o}let n=e.children.map(e=>this._write(t,e)).join(", "),i=this._createVarName(t,e);return x(t,`${r.padEnd(5)} ${i} = ${e.token}(${n});`,e.uid),i}_writePrimitiveNode(t,e,r=!1){let n=t.getInput(e);if(n)return n.isUsed=!0,n.variableName;let i=1===e.children.length&&e.children[0]?.type===e.type;if(e.isImplicit||i)return this._write(t,e.children[0]);let o=this._createVarName(t,e);if(r)return x(t,`${e.type.padEnd(5)} ${o};`,e.uid),o;let s=!e.debugInfo.name&&!e.isMutable;if(s&&"float"===e.type&&"number"==typeof e.children[0])return Number.isInteger(e.children[0])?e.children[0].toFixed(1):e.children[0].toString();if(s&&"int"===e.type&&"number"==typeof e.children[0]&&Number.isInteger(e.children[0]))return e.children[0].toString();let u=e.children.map(e=>this._write(t,e)).join(", ");return"array"===e.type?(x(t,`${e.type.padEnd(5)} ${o} = [${u}];`,e.uid),o):s?`${e.type}(${u})`:(x(t,`${e.type.padEnd(5)} ${o} = ${e.type}(${u});`,e.uid),o)}}var V=r(41648);class T{constructor(t,e,r){this.variableName=t,this.variableInputType=e,this.node=r,this.type="shader-input",this.isUsed=!1}clone(){return new T(this.variableName,this.variableInputType,(0,V.UV)(this.node))}}class I{constructor(t,e,r){this.outVariableName=t,this.outVariableType=e,this.node=r,this.type="shader-output"}clone(){let t=new I(this.outVariableName,this.outVariableType,(0,V.UV)(this.node));return t.variableName=this.variableName,t}}class ${static createVertex(t,e,r,n,i,o){let s=[];for(let e in t){let n=t[e],i=r.get(e);i?s.push(new T(i,"builtin",n)):s.push(new T("a_"+e,"attribute",n))}for(let t of n){let e=t.uniformHydrated;s.push(new T(t.uniformName,"uniform",e))}let u=[];for(let t in e){let r=e[t];"glPosition"===t?u.push(new I("gl_Position","builtin",r)):"glPointSize"===t?u.push(new I("gl_PointSize","builtin",r)):u.push(new I("v_"+t,"varying",r))}return new $(s,u,i,o)}static createFragment(t,e,r,n,i,o){let s=[],u=Array.from(i.rootOutputNodes());for(let e in t){let n=t[e],i=r.get(e);if(i){s.push(new T(i,"builtin",n));continue}let o=u.find(t=>t.node===n);o&&s.push(new T(o.outVariableName,o.outVariableType,n))}for(let t of n){let e=t.uniformHydrated;s.push(new T(t.uniformName,"uniform",e))}let a=[];for(let t in e){let n=e[t],i=r.get(t);if("discard"===t)a.push(new I(null,"discard",n));else{if(!i)throw Error(`Member ${t} in shader fragment output shoule be tagged as builtin`);a.push(new I(i,"builtin",n))}}return new $(s,a,o)}constructor(t,e,r,n){for(let e of(this.type="shader-graph-context",this.indent=0,this.body="",this.varCount=0,this._inputShaderTypesByNodeUid=new Map,this._nodeEmitMap=new Map,t))this._inputShaderTypesByNodeUid.set(e.node.uid,e);this._outputShaderTypes=e,this._transformFeedbackBindings=r,this._transformFeedbackNames=new Set(r.map(t=>"v_"+t.propertyKey)),this._usedInFragmentShader=n}shouldPruneOutputNode(t){return!!this._usedInFragmentShader&&"builtin"!==t.outVariableType&&!this._transformFeedbackNames.has(t.outVariableName)&&!this._usedInFragmentShader.has(t.node.uid)}setEmit(t,e){this._nodeEmitMap.set(t.uid,e)}getEmit(t){return this._nodeEmitMap.get(t.uid)}inputs(){return this._inputShaderTypesByNodeUid.values()}getInput(t){return this._inputShaderTypesByNodeUid.get(t.uid)}*rootOutputNodes(){for(let t of this._outputShaderTypes)yield t}*nodes(){let t=[];for(let e of this._outputShaderTypes.values())t.push(e.node);for(;t.length;){let e=t.pop();"number"!=typeof e&&"boolean"!=typeof e&&t.push(...e.children.filter(Boolean)),yield e}}*nodesOfTypeOrFunction(){for(let t of this.nodes())"number"!=typeof t&&"boolean"!=typeof t&&(yield t)}createSubgraphContext(){let t=this.clone();return t.body="",t.indent=this.indent+2,t._nodeEmitMap=new Map(this._nodeEmitMap),t}clone(){let t=new $([],this._outputShaderTypes,this._transformFeedbackBindings,this._usedInFragmentShader);return t._inputShaderTypesByNodeUid=this._inputShaderTypesByNodeUid,t.indent=this.indent,t.body=this.body,t.varCount=this.varCount,t._nodeEmitMap=this._nodeEmitMap,t}insertVertexShader(t){for(let e of(t.vertex.code.add(""),this._insertInputs(t,"vertex"),t.vertex.code.add(""),t.vertex.code.add("// OUTPUTS: "),t.vertex.code.add("// --------------------------------------------------------- "),this.rootOutputNodes())){let r="builtin"===e.outVariableType;this.shouldPruneOutputNode(e)||(r?t.vertex.code.add(`// ${e.outVariableType.padEnd(7)} ${e.node.type.padEnd(9)} ${e.outVariableName};`):t.vertex.code.add(`${e.outVariableType.padEnd(10)} ${e.node.type.padEnd(9)} ${e.outVariableName};`))}for(let e of(t.vertex.code.add(""),t.vertex.code.add("void main() {"),t.vertex.code.add("  "+this.body.split("\n").join("\n  ")),this.rootOutputNodes()))this.shouldPruneOutputNode(e)||t.vertex.code.add(`  ${e.outVariableName} = ${e.variableName};`);t.vertex.code.add("}")}insertFragmentShader(t){for(let e of(this._insertInputs(t,"fragment"),t.fragment.code.add(""),t.fragment.code.add("void main() {"),t.fragment.code.add("  "+this.body.split("\n").join("\n  ")),this.rootOutputNodes()))"discard"===e.outVariableType?(t.fragment.code.add("  // TODO: Should ensure codegen for discard appears first in fragment shader"),t.fragment.code.add(`  if (${e.variableName}) {`),t.fragment.code.add("    discard;"),t.fragment.code.add("  }"),t.fragment.code.add("  ")):t.fragment.code.add(`  ${e.outVariableName} = ${e.variableName};`);t.fragment.code.add("}")}_insertInputs(t,e){for(let r of(t[e].code.add("// INPUTS: "),t[e].code.add("// --------------------------------------------------------- "),this.inputs()))r.isUsed&&"builtin"!==r.variableInputType&&("array"===r.node.type?t[e].code.add(`${r.variableInputType.padEnd(10)} ${r.node.elementType.type.padEnd(9)} ${r.variableName}[${r.node.size}];`):t[e].code.add(`${r.variableInputType.padEnd(10)} ${r.node.type.padEnd(9)} ${r.variableName};`))}}var U=r(17490);function N(t,e,r){let n=t.constructor[e]??[];t.constructor.hasOwnProperty(e)||Object.defineProperty(t.constructor,e,{value:n.slice()}),t.constructor[e].push(r)}function z(t,e){return(r,n)=>{N(r,"locations",{typeCtor:e,propertyKey:n,parameterIndex:null,index:t})}}let C=t=>(e,r,n)=>{N(e,"inputs",{inputCtor:t,propertyKey:r,parameterIndex:n})},O=t=>(e,r)=>{N(e,"uniforms",{typeCtor:t,propertyKey:r})},F=t=>(e,r)=>{N(e,"options",{typeCtor:t,propertyKey:r})},D=(t,e)=>{N(t,"defines",{propertyKey:e})},P=(t,e)=>(r,n)=>{r.constructor.builtins.push({builtin:t,propertyKey:n,typeCtor:e})};class K{}K.builtins=[],(0,i._)([P("gl_VertexID",w.J7)],K.prototype,"glVertexID",void 0);class k{}class A{}A.builtins=[],(0,i._)([P("gl_FragCoord",w.T8)],A.prototype,"glFragCoord",void 0),(0,i._)([P("gl_PointCoord",w.Sg)],A.prototype,"glPointCoord",void 0);class M{}(0,i._)([(n="gl_FragColor",(t,e)=>{N(t,"builtins",{builtin:n,propertyKey:e})})],M.prototype,"glFragColor",void 0);class E{constructor(){this.type="uniform-group"}get _uniforms(){return this.constructor.uniforms??[]}}class H{constructor(){this.logShader=!1,this.computeAttributes={}}get vertexInput(){let t=this._shaderModuleClass.inputs.findLast(t=>"vertex"===t.propertyKey&&0===t.parameterIndex);if(!t)throw Error("Unable to find vertex input parameter");return t}get computeInput(){return this._shaderModuleClass.inputs.findLast(t=>"vertex"===t.propertyKey&&1===t.parameterIndex)}get fragmentInput(){let t=this._shaderModuleClass.inputs.findLast(t=>"fragment"===t.propertyKey);if(!t)throw Error("Unable to find fragment input parameter");return t}get transformFeedbackBindings(){return this.fragmentInput.inputCtor.transformFeedbackBindings??[]}get locations(){return[...this.vertexInput.inputCtor.locations,...this.computeInput?.inputCtor.locations??[]]}get locationsMap(){let t=new Map,e=new Set;for(let r of this.locations)e.has(r.index)?o.Z.getLogger("esri.views.2d.engine.webgl.shaderGraph.GraphShaderModule").warnOnce("mapview-rendering",`Unable to assigned attribute ${r.propertyKey} to ${r.index}. Index already in use`,{locationsMap:t}):(t.set(r.propertyKey,r.index),e.add(r.index));return t}get locationInfo(){if(!this._locationInfo){let t=this.locationsMap,e=Array.from(t.entries()).map(([t,e])=>`${t}.${e}`).join("."),r=(0,s.hP)(e),n=this.computeAttributes;this._locationInfo={hash:r,locations:t,computeAttributeMap:n}}return this._locationInfo}get renamedLocationsMap(){let t=new Map;for(let e of this.locations)t.set("a_"+e.propertyKey,e.index);return t}get optionPropertyKeys(){if(!this._optionPropertyKeys){let t=new Set;for(let e of this._options)t.add(e.propertyKey);this._optionPropertyKeys=t}return this._optionPropertyKeys}get _shaderModuleClass(){return this.constructor}get _defines(){return this._shaderModuleClass.defines??[]}get _options(){return this._shaderModuleClass.options??[]}get _uniforms(){return this._shaderModuleClass.uniforms??[]}getProgram(t,e,r,n){try{let{vertex:i,fragment:o,uniformBindings:s}=this._generateShaders(t,e,r,n);return new U.X(i,o,this.renamedLocationsMap,this.locationInfo,s,this.transformFeedbackBindings)}catch(t){return new U.X("","",this.renamedLocationsMap,this.locationInfo,[],this.transformFeedbackBindings)}}getDebugUniformClassInfo(t){let e=this._options.find(e=>e.propertyKey===t);if(e)return{type:"option",className:e.typeCtor};let r=this._uniforms.find(e=>e.propertyKey===t);if(!r)throw Error(`Unable to find uniform class type for property: ${t}`);return{type:"required",className:r.typeCtor}}getShaderKey(t,e,r,n){let i=Object.keys(t).map(e=>`${e}.${t[e]}`).join("."),o=Object.keys(r).map(t=>`${t}.${r[t]}`).join("."),s=Object.keys(n).map(t=>`${t}.${n[t]}`).join("."),u=Object.keys(e).filter(t=>this.optionPropertyKeys.has(t)&&e[t]).join(".");return`${this.constructor.name}.${i}.${o}.${s}.${u}`}_generateShaders(t,e,r,n){let i=[];this._setDefines(r),this._setOptionalUniforms(i,e),this._setRequiredUniforms(i);let o=this._hydrateVertexInput(n),s=this._injectPackPrecisionFactor(o,t),u=this._hydrateComputeInput(),a=u&&this._injectComputePackPrecisionFactor(u,t),l=this.vertex(s,a),c=this._hydrateFragmentInput(l),d=this.fragment(c),p=new Set;for(let t in d){let e=d[t];(0,V.Q0)(p,e)}let h=this._getVertexInputBuiltins(),f=$.createVertex({...o,...u},l,h,i,this.transformFeedbackBindings,p);(new S).write(f);let y=this._getFragmentInputBuiltins(d);y.set("glPointCoord","gl_PointCoord");let m=$.createFragment(c,d,y,i,f,this.transformFeedbackBindings);(new S).write(m);let v=this._createShaderBuilder(f,m),b=v.generate("vertex",!1),g=v.generate("fragment",!1);return this.logShader&&(console.log(b),console.log(g)),{vertex:b,fragment:g,uniformBindings:i}}_setDefines(t){for(let e in t)this[e]=t[e]}_setOptionalUniforms(t,e){for(let r of this._options)e[r.propertyKey]?this[r.propertyKey]=this._hydrateUniformGroup(t,r):this[r.propertyKey]=null}_setRequiredUniforms(t){for(let e of this._uniforms)this[e.propertyKey]=this._hydrateUniformGroup(t,e)}_hydrateUniformGroup(t,e){let r=new e.typeCtor;for(let n of r._uniforms??[]){let i=new n.typeCtor,o=`u_${e.propertyKey}_${n.propertyKey}`,s=i.type,u=[e.propertyKey,n.propertyKey].join(".");"type"in n.typeCtor&&"array"===n.typeCtor.type?t.push({shaderModulePath:u,uniformName:o,uniformType:s,uniformArrayLength:i.size,uniformArrayElementType:i.elementType.type,uniformHydrated:i}):t.push({shaderModulePath:u,uniformName:o,uniformType:s,uniformHydrated:i}),r[n.propertyKey]=i}return r}_hydrateVertexInput(t){let e=this.vertexInput.inputCtor,r=e.locations.reduce((e,r)=>!1===t[r.propertyKey]?e:{...e,[r.propertyKey]:new r.typeCtor},{});for(let{propertyKey:t,typeCtor:n}of e.builtins){let e=new n;r[t]=e}return r}_hydrateComputeInput(){return null==this.computeInput?null:this.computeInput.inputCtor.locations.reduce((t,e)=>({...t,[e.propertyKey]:new e.typeCtor}),{})}_injectPackPrecisionFactor(t,e){let r={};for(let n in t){let i=t[n],o=e[n];if(o){if("float"!==i.type&&"vec2"!==i.type&&"vec3"!==i.type&&"vec4"!==i.type)throw Error(`InternalError: packPrecisionFactor requires GenType, but found ${i.type}`);r[n]=i.divide(new w.bv(o))}else r[n]=i}return r}_injectComputePackPrecisionFactor(t,e){let r={},n=new Map;for(let t in this.computeAttributes)for(let e of this.computeAttributes[t]??[])n.set(e,t);for(let i in t){let o=t[i],s=n.get(i);if(!s)continue;let u=e[s];if(u){if("float"!==o.type&&"vec2"!==o.type&&"vec3"!==o.type&&"vec4"!==o.type)throw Error(`InternalError: packPrecisionFactor requires GenType, but found ${o.type}`);r[i]=o.divide(new w.bv(u))}else r[i]=o}return r}_hydrateFragmentInput(t){let e={};for(let r in t)e[r]=t[r];for(let{propertyKey:t,typeCtor:r}of A.builtins){let n=new r;e[t]=n}return e}_getVertexInputBuiltins(){let t=this.vertexInput.inputCtor,e=new Map;for(let{builtin:r,propertyKey:n}of t.builtins)e.set(n,r);return e}_getFragmentInputBuiltins(t){let e=t.constructor,r=new Map;for(let t of e.builtins??[])r.set(t.propertyKey,t.builtin);return r}_createShaderBuilder(t,e){let r=new p;return this._insertDebugInfo(r),t.insertVertexShader(r),e.insertFragmentShader(r),r}_insertDebugInfo(t){for(let e of(t.vertex.code.add("// DEFINES: "),t.vertex.code.add("// --------------------------------------------------------- "),this._defines))this[e.propertyKey]?t.vertex.code.add(`//   ${e.propertyKey}: true`):t.vertex.code.add(`//   ${e.propertyKey}: false`);for(let e of(t.vertex.code.add(""),t.vertex.code.add("// OPTIONS: "),t.vertex.code.add("// --------------------------------------------------------- "),this._options))this[e.propertyKey]?t.vertex.code.add(`//   ${e.propertyKey}: true`):t.vertex.code.add(`//   ${e.propertyKey}: false`)}}},41648:function(t,e,r){function n(t,e){let r=[];for(r.push(e);r.length;){let e=r.pop();if("object"==typeof e&&!t.has(e.uid))for(let n of(t.add(e.uid),e.children))r.push(n)}}r.d(e,{Q0:function(){return n},UV:function(){return o},Yo:function(){return l},Ys:function(){return d},h9:function(){return s},lJ:function(){return c},rK:function(){return a}});class i{constructor(){this.uid=i.NodeCount++,this._debugName=null,this._isMutable=!1,this.isImplicit=!1}get isMutable(){return this._isMutable}setMutable(){return this._isMutable=!0,this}setDebugName(t){return t=t.split(" ").map((t,e)=>e>0?t.charAt(0).toUpperCase()+t.slice(1):t).join(""),this._debugName=t,this.isImplicit&&this.children[0]instanceof i&&this.children[0].setDebugName(t),this}get debugInfo(){return{name:this._debugName??""}}cloneInto(t){t._debugName=this._debugName,t._isMutable=this._isMutable,t.isImplicit=this.isImplicit,t.uid=this.uid}}function o(t){return"object"==typeof t?t.clone():t}i.NodeCount=0;class s extends i{constructor(){super(...arguments),this.shaderType="primitive-node"}}class u extends i{constructor(t){super(),this.child=t,this.shaderType="scope-node"}get children(){return[this.child]}clone(){let t=new u(o(this.child));return this.cloneInto(t),t}}class a extends i{constructor(t,e,r){super(),this.property=t,this.target=e,this.returnType=r,this.shaderType="property-access-node"}get children(){let t=[this.target];return"string"!=typeof this.property&&t.push(this.property),t}clone(){let t=new a(this.property,o(this.target),this.returnType);return this.cloneInto(t),t}}class l extends i{constructor(t,e,r){super(),this.condition=t,this.ifTrue=e,this.ifFalse=r,this.shaderType="condition-node"}get children(){return[this.condition,this.ifTrue,this.ifFalse]}clone(){let t=o(this.ifTrue),e=this.ifFalse?o(this.ifFalse):null,r=new l(this.condition,t,e);return this.cloneInto(r),r}}class c extends i{constructor(t,e,r,n){super(),this.captureList=t,this.returnType=e,this.generator=n,this.shaderType="block-node",r&&(this.subgraph=new u(r))}get children(){return Object.keys(this.captureList).map(t=>this.captureList[t]).concat(this.subgraph??[])}clone(){let t={};for(let e in this.captureList)t[e]=o(this.captureList[e]);let e=new c(t,this.returnType,this.subgraph?o(this.subgraph.child):this.subgraph,this.generator);return this.cloneInto(e),e}}class d extends i{constructor(t,e,r,n,i,o=!1){super(),this.token=t,this._children=e,this.isInfix=r,this.isPropertyAccess=n,this.returnType=i,this.isTernary=o,this.shaderType="function-node"}get children(){return this._children}clone(){let t=new d(this.token,this._children.map(o),this.isInfix,this.isPropertyAccess,this.returnType,this.isTernary);return this.cloneInto(t),t}}},85495:function(t,e,r){r.d(e,{AK:function(){return tT},AO:function(){return T},CD:function(){return tC},CW:function(){return tK},Dg:function(){return tl},Eg:function(){return x},Fp:function(){return tN},Fv:function(){return tF},GW:function(){return tI},Iz:function(){return th},J7:function(){return K},K4:function(){return j},KJ:function(){return tn},Nb:function(){return tk},O$:function(){return tP},Qj:function(){return tp},R3:function(){return B},Sg:function(){return V},T8:function(){return I},TE:function(){return tV},Tu:function(){return H},VV:function(){return tz},Wn:function(){return tb},ZI:function(){return t$},bv:function(){return S},e$:function(){return q},ff:function(){return tD},fz:function(){return W},hx:function(){return tc},ig:function(){return tA},kE:function(){return tU},ln:function(){return td},mC:function(){return tS},mD:function(){return tw},or:function(){return tm},r7:function(){return ty},tS:function(){return tf},tW:function(){return C},tk:function(){return te},uZ:function(){return tx},v8:function(){return w},vh:function(){return G},wO:function(){return Z},wQ:function(){return tO},wV:function(){return ti},xD:function(){return tv},yb:function(){return R}});var n,i,o,s,u,a,l,c,d,p,h,f,y,m,v=r(86641),b=r(41648);function g(t){return new Proxy(t,{construct:(t,e,r)=>(function t(e){return new Proxy(e,{get(r,n){if("constructor"===n)return new Proxy(r.constructor,{construct:(e,r,n)=>t(new e(...r))});if(n in r)return r[n];if("string"==typeof n){let t=function(t){for(let e of[["float","vec2","vec3","vec4"],["int","ivec2","ivec3","ivec4"],["uint","uvec2","uvec3","uvec4"],["bool","bvec2","bvec3","bvec4"]])if(e.includes(t))return e.map(t=>L[t]);throw Error("Unable to find type family")}(e.type);return J(e,n,t[n.length-1])}}})})(new t(...e))})}class _ extends Error{}let w=n=class extends b.h9{constructor(t,e){super(),this.elementType=t,this.size=e,this.children=[],this.type="array"}clone(){let t=new n(this.elementType,this.size);return super.cloneInto(t),t}get(t){if("number"==typeof t){let e=new K(t);return e.isImplicit=!0,J(this,e,this.elementType.constructor)}return J(this,t,this.elementType.constructor)}last(){return this.get(this.size-1)}first(){return this.get(0)}findIndex(t,e,r){return function(t,e,r=0,n=t.size){let i=new K(r).setMutable().setDebugName("FindIndexIterator"),o=e(t.get(i)).setDebugName("FindIndexPredicate");return tr({iter:i},K,o,({out:t,iter:e,subgraph:r})=>`
${t} = -1;

for (; ${e} < ${n}; ${e}++) {

${r.body}

  if (${r.varName}) {
    ${t} = ${e};
    break;
  }

}
`).setDebugName("FindIndexBlock")}(this,t,e,r)}glslFindIndex(t,e,r){return function(t,e,r=0,n=t.size){return tr({array:t},K,null,({out:t,array:i})=>`
${t} = -1;
for (int i = ${r}; i < ${n}; i++) {
  bool condition;
  ${e({array:i,i:"i",out:"condition"})}
  if (condition) {
    ${t} = i;
    break;
  }
}
`).setDebugName("GlslFindIndexBlock")}(this,t,e,r)}static ofType(t,e){return new Proxy(n,{construct:(r,i)=>new n(new t,e)})}};w.type="array",w=n=(0,v._)([function(t){return new Proxy(t,{construct:(t,e,r)=>{var n;return new Proxy(n=new t(...e),{get(t,e){if(e in t)return t[e];if("string"==typeof e){let t=parseInt(e,10);if(!isNaN(t))return J(n,`[${t}]`,n.elementType.constructor)}}})}})}],w);class x extends b.h9{constructor(){super(...arguments),this.type="sampler2D",this.children=[]}clone(){let t=new x;return t.children=this.children.map(b.UV),super.cloneInto(t),t}}x.type="sampler2D";class S extends b.h9{constructor(t){super(),this.type="float",this.children=[t]}clone(){let t=new S((0,b.UV)(this.children[0]));return super.cloneInto(t),t}multiply(t){return to(this,"number"==typeof t?D(t,S):t)}divide(t){return ts(this,"number"==typeof t?D(t,S):t)}add(t){return tu(this,"number"==typeof t?D(t,S):t)}subtract(t){return ta(this,"number"==typeof t?D(t,S):t)}}S.type="float";let V=i=class extends b.h9{constructor(t,e){super(),this.type="vec2",this.children=[t,e].filter(t=>null!=t)}clone(){let t=new i((0,b.UV)(this.children[0]),(0,b.UV)(this.children[1]));return super.cloneInto(t),t}get 0(){return J(this,"[0]",S)}get 1(){return J(this,"[1]",S)}get 2(){throw new _}get 3(){throw new _}multiply(t){return to(this,"number"==typeof t?D(t,S):t)}divide(t){return ts(this,"number"==typeof t?D(t,S):t)}add(t){return tu(this,"number"==typeof t?D(t,S):t)}subtract(t){return ta(this,"number"==typeof t?D(t,S):t)}};V.type="vec2",V=i=(0,v._)([g],V);let T=o=class extends b.h9{constructor(t,e,r){super(),this.type="vec3",this.children=[t,e,r].filter(t=>null!=t)}get 0(){return J(this,"[0]",S)}get 1(){return J(this,"[1]",S)}get 2(){return J(this,"[2]",S)}get 3(){throw new _}clone(){let t=new o((0,b.UV)(this.children[0]),(0,b.UV)(this.children[1]),(0,b.UV)(this.children[2]));return super.cloneInto(t),t}multiply(t){return to(this,"number"==typeof t?D(t,S):t)}divide(t){return ts(this,"number"==typeof t?D(t,S):t)}add(t){return tu(this,"number"==typeof t?D(t,S):t)}subtract(t){return ta(this,"number"==typeof t?D(t,S):t)}};T.type="vec3",T=o=(0,v._)([g],T);let I=s=class extends b.h9{constructor(t,e,r,n){super(),this.type="vec4",this.children=[t,e,r,n].filter(t=>null!=t)}clone(){let t=new s((0,b.UV)(this.children[0]),(0,b.UV)(this.children[1]),(0,b.UV)(this.children[2]),(0,b.UV)(this.children[3]));return super.cloneInto(t),t}get 0(){return J(this,"[0]",S)}get 1(){return J(this,"[1]",S)}get 2(){return J(this,"[2]",S)}get 3(){return J(this,"[3]",S)}multiply(t){return to(this,"number"==typeof t?D(t,S):t)}divide(t){return ts(this,"number"==typeof t?D(t,S):t)}add(t){return tu(this,"number"==typeof t?D(t,S):t)}subtract(t){return ta(this,"number"==typeof t?D(t,S):t)}};I.type="vec4",I=s=(0,v._)([g],I);let $=u=class extends b.h9{constructor(t){super(),this.type="uint",this.children=[t]}clone(){let t=new u((0,b.UV)(this.children[0]));return super.cloneInto(t),t}};$.type="uint",$=u=(0,v._)([g],$);let U=a=class extends b.h9{constructor(t,e){super(),this.type="uvec2",this.children=[t,e].filter(t=>null!=t)}clone(){let t=new a((0,b.UV)(this.children[0]),(0,b.UV)(this.children[1]));return super.cloneInto(t),t}};U.type="uvec2",U=a=(0,v._)([g],U);let N=l=class extends b.h9{constructor(t,e,r){super(),this.type="uvec3",this.children=[t,e,r].filter(t=>null!=t)}clone(){let t=new l((0,b.UV)(this.children[0]),(0,b.UV)(this.children[1]),(0,b.UV)(this.children[2]));return super.cloneInto(t),t}};N.type="uvec3",N=l=(0,v._)([g],N);let z=c=class extends b.h9{constructor(t,e,r,n){super(),this.type="uvec4",this.children=[t,e,r,n].filter(t=>null!=t)}clone(){let t=new c((0,b.UV)(this.children[0]),(0,b.UV)(this.children[1]),(0,b.UV)(this.children[2]),(0,b.UV)(this.children[3]));return super.cloneInto(t),t}};z.type="uvec4",z=c=(0,v._)([g],z);class C extends b.h9{constructor(t){super(),this.type="bool",this.children=[t]}and(t){return tv(this,t)}or(t){return tm(this,t)}clone(){let t=new C((0,b.UV)(this.children[0]));return super.cloneInto(t),t}}C.type="bool";let O=d=class extends b.h9{constructor(t,e){super(),this.type="bvec2",this.children=[t,e].filter(t=>null!=t)}all(){return tg(this)}any(){return t_(this)}clone(){let t=new d((0,b.UV)(this.children[0]),(0,b.UV)(this.children[1]));return super.cloneInto(t),t}};O.type="bvec2",O=d=(0,v._)([g],O);let F=p=class extends b.h9{constructor(t,e,r){super(),this.type="bvec3",this.children=[t,e,r].filter(t=>null!=t)}all(){return tg(this)}any(){return t_(this)}clone(){let t=new p((0,b.UV)(this.children[0]),(0,b.UV)(this.children[1]),(0,b.UV)(this.children[2]));return super.cloneInto(t),t}};function D(t,e){return"number"==typeof t?new e(t):t}F.type="bvec3",F=p=(0,v._)([g],F);let P=h=class extends b.h9{constructor(t,e,r,n){super(),this.type="bvec4",this.children=[t,e,r,n].filter(t=>null!=t)}all(){return tg(this)}any(){return t_(this)}clone(){let t=new h((0,b.UV)(this.children[0]),(0,b.UV)(this.children[1]),(0,b.UV)(this.children[2]),(0,b.UV)(this.children[3]));return super.cloneInto(t),t}};P.type="bvec4",P=h=(0,v._)([g],P);class K extends b.h9{constructor(t){super(),this.type="int",this.children=[t]}multiply(t){return to(this,D(t,K))}add(t){return tu(this,D(t,K))}subtract(t){return ta(this,D(t,K))}divide(t){return ts(this,D(t,K))}clone(){let t=new K((0,b.UV)(this.children[0]));return super.cloneInto(t),t}}K.type="int";let k=f=class extends b.h9{constructor(t,e){super(),this.type="ivec2",this.children=[t,e].filter(t=>null!=t)}clone(){let t=new f((0,b.UV)(this.children[0]),(0,b.UV)(this.children[1]));return super.cloneInto(t),t}};k.type="ivec2",k=f=(0,v._)([g],k);let A=y=class extends b.h9{constructor(t,e,r){super(),this.type="ivec3",this.children=[t,e,r].filter(t=>null!=t)}clone(){let t=new y((0,b.UV)(this.children[0]),(0,b.UV)(this.children[1]),(0,b.UV)(this.children[2]));return super.cloneInto(t),t}};A.type="ivec3",A=y=(0,v._)([g],A);let M=m=class extends b.h9{constructor(t,e,r,n){super(),this.type="ivec4",this.children=[t,e,r,n].filter(t=>null!=t)}clone(){let t=new m((0,b.UV)(this.children[0]),(0,b.UV)(this.children[1]),(0,b.UV)(this.children[2]),(0,b.UV)(this.children[3]));return super.cloneInto(t),t}};M.type="ivec4",M=m=(0,v._)([g],M);class E extends b.h9{constructor(t,e,r,n){super(),this.type="mat2",this.children=[t,e,r,n]}clone(){let t=new E((0,b.UV)(this.children[0]),(0,b.UV)(this.children[1]),(0,b.UV)(this.children[2]),(0,b.UV)(this.children[3]));return super.cloneInto(t),t}}E.type="mat2";class H extends b.h9{static identity(){return new H(1,0,0,0,1,0,0,0,1)}static fromRotation(t){let e=tP(t),r=tS(t);return new H(r,e,0,te(e),r,0,0,0,1)}constructor(t,e,r,n,i,o,s,u,a){super(),this.type="mat3",this.children=[t,e,r,n,i,o,s,u,a]}add(t){return tu(this,t)}multiply(t){return to(this,t)}clone(){let t=new H((0,b.UV)(this.children[0]),(0,b.UV)(this.children[1]),(0,b.UV)(this.children[2]),(0,b.UV)(this.children[3]),(0,b.UV)(this.children[4]),(0,b.UV)(this.children[5]),(0,b.UV)(this.children[6]),(0,b.UV)(this.children[7]),(0,b.UV)(this.children[8]));return super.cloneInto(t),t}}H.type="mat3";class R extends b.h9{static identity(){return new R(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}constructor(t,e,r,n,i,o,s,u,a,l,c,d,p,h,f,y){super(),this.type="mat4",this.children=[t,e,r,n,i,o,s,u,a,l,c,d,p,h,f,y]}static fromColumns(t,e,r,n){return new R(t.x,t.y,t.z,t.w,e.x,e.y,e.z,e.w,r.x,r.y,r.z,r.w,n.x,n.y,n.z,n.w)}multiply(t){return to(this,t)}clone(){let t=new R((0,b.UV)(this.children[0]),(0,b.UV)(this.children[1]),(0,b.UV)(this.children[2]),(0,b.UV)(this.children[3]),(0,b.UV)(this.children[4]),(0,b.UV)(this.children[5]),(0,b.UV)(this.children[6]),(0,b.UV)(this.children[7]),(0,b.UV)(this.children[8]),(0,b.UV)(this.children[9]),(0,b.UV)(this.children[10]),(0,b.UV)(this.children[11]),(0,b.UV)(this.children[12]),(0,b.UV)(this.children[13]),(0,b.UV)(this.children[14]),(0,b.UV)(this.children[15]));return super.cloneInto(t),t}}R.type="mat4";let L={float:S,vec2:V,vec3:T,vec4:I,int:K,ivec2:k,ivec3:A,ivec4:M,uint:$,uvec2:U,uvec3:N,uvec4:z,bool:C,bvec2:O,bvec3:F,bvec4:P},q=(...t)=>new K(...t),W=(...t)=>new S(...t),j=(...t)=>new V(...t),B=(...t)=>new T(...t),G=(...t)=>new I(...t),Z=(...t)=>new H(...t);function J(t,e,r){let n=new r(new b.rK(e,t,r));return n.isImplicit=!0,n}function Y(t,e,r,n=null){if(n){let i=new n,o=new n(new b.Ys(t,[e,r],!0,!1,i));return o.isImplicit=!0,o}if("float"===e.type||"int"===e.type){let n=new r.constructor(new b.Ys(t,[e,r],!0,!1,r.constructor));return n.isImplicit=!0,n}if(("mat2"===e.type||"mat3"===e.type||"mat4"===e.type)&&"float"!==r.type){let n=new r.constructor(new b.Ys(t,[e,r],!0,!1,r.constructor));return n.isImplicit=!0,n}let i=new e.constructor(new b.Ys(t,[e,r],!0,!1,e.constructor));return i.isImplicit=!0,i}function Q(t,e,r=e.constructor){let n=new r(new b.Ys(t,[e],!1,!1,r));return n.isImplicit=!0,n}function X(t,e,r,n=e.constructor){let i=new n(new b.Ys(t,[e,r],!1,!1,n));return i.isImplicit=!0,i}function tt(t,e,r,n,i=e.constructor){let o=new i(new b.Ys(t,[e,r,n],!1,!1,i));return o.isImplicit=!0,o}function te(t){return to(t,W(-1))}function tr(t,e,r,n){return new e(new b.lJ(t,e,r,n))}function tn(t,e,r){let n="function"==typeof e?e():e,i="function"==typeof r?r():r,o=new n.constructor(new b.Yo(t,n,i));return o.isImplicit=!0,o}function ti(...t){let e=t.map(([t,e])=>"function"==typeof e?[t,e()]:[t,e]),r=e[0][1].constructor,n=e.findIndex(t=>!0===t[0]);if(-1===n)throw Error("A cond must have a fallthrough case with `true`/; ");let i=e.slice(0,n),o=e[n][1],s=new r(i.reduceRight((t,e)=>tn(e[0],e[1],t),o));return s.isImplicit=!0,s}function to(t,e){return Y("*",t,e)}function ts(t,e){return Y("/",t,e)}function tu(t,e){return Y("+",t,e)}function ta(t,e){return Y("-",t,e)}function tl(t,e){return Y(">>",t,e)}function tc(t,e){return Y("&",t,e)}function td(t,e){return Y("==",t,e,C)}function tp(t,e){return Y("<",t,e,C)}function th(t,e){return Y("<=",t,e,C)}function tf(t,e){return Y(">",t,e,C)}function ty(t,e){return Y(">=",t,e,C)}function tm(...t){return t.length<=1?t[0]:t.slice(1).reduce((t,e)=>Y("||",t,e,C),t[0])}function tv(...t){return t.length<=1?t[0]:t.slice(1).reduce((t,e)=>Y("&&",t,e,C),t[0])}function tb(t){return Q("abs",t)}function tg(t){return Q("all",t,C)}function t_(t){return Q("any",t,C)}function tw(t){return Q("ceil",t)}function tx(t,e,r){return tt("clamp",t,e,r,t.constructor)}function tS(t){return Q("cos",t)}function tV(t,e){return X("distance",t,e,S)}function tT(t,e){return X("dot",t,e,S)}function tI(t){return Q("floor",t)}function t$(t){return Q("fract",t)}function tU(t){return Q("length",t,S)}function tN(t,e){return X("max",t,e)}function tz(t,e){return X("min",t,e)}function tC(t,e,r){return tt("mix",t,e,r)}function tO(t,e){return X("mod",t,e)}function tF(t){return Q("normalize",t)}function tD(t){return"bool"===t.type?Q("!",t):Q("not",t)}function tP(t){return Q("sin",t)}function tK(t,e,r){return tt("smoothstep",t,e,r)}function tk(t,e){return X("step",t,e,e.constructor)}function tA(t,e){return X("texture2D",t,e,I)}},31408:function(t,e,r){var n,i;r.d(e,{t:function(){return n}}),(i=n||(n={}))[i.Fill=0]="Fill",i[i.PatternFill=1]="PatternFill",i[i.ComplexFill=2]="ComplexFill",i[i.OutlineFill=3]="OutlineFill",i[i.PatternOutlineFill=4]="PatternOutlineFill",i[i.ComplexOutlineFill=5]="ComplexOutlineFill",i[i.Marker=6]="Marker",i[i.PieChart=7]="PieChart",i[i.Line=8]="Line",i[i.TexturedLine=9]="TexturedLine",i[i.Text=10]="Text",i[i.Label=11]="Label",i[i.Heatmap=12]="Heatmap",i[i.DotDensity=13]="DotDensity",i[i.Test=14]="Test"},89119:function(t,e,r){r.d(e,{m:function(){return n}});let n={bitset:{isSDF:0,isMapAligned:1,scaleSymbolsProportionally:2,overrideOutlineColor:3,colorLocked:4}}},59182:function(t,e,r){r.d(e,{Ie:function(){return m},RS:function(){return f},fz:function(){return y},HN:function(){return h}});var n=r(86641),i=r(7078),o=r(66829),s=r(85495),u=r(37180),a=r(89049);class l extends o.oo{getVisualVariableData(t){if(!this._vvData){let e=this.getAttributeDataCoords(t);this._vvData=(0,s.ig)(this.visualVariableData,e).setDebugName("storage2")}return this._vvData}getAttributeDataCoords(t){if(!this._uv){let e=(0,a.Wv)(t),r=this.size,n=(0,s.e$)(e.x),i=(0,s.e$)(e.y).multiply((0,s.e$)(256)),o=(0,s.e$)(e.z).multiply((0,s.e$)(256)).multiply((0,s.e$)(256)),u=(0,s.fz)(n.add(i).add(o)),l=(0,s.wQ)(u,r),c=u.subtract(l).divide(r);this._uv=new s.Sg(l,c).add(.5).divide(r)}return this._uv}getFilterData(t){let e=this.getAttributeDataCoords(t);return(0,s.ig)(this.filterFlags,e).setDebugName("storage0")}getAnimationData(t){let e=this.getAttributeDataCoords(t);return(0,s.ig)(this.animation,e).setDebugName("storage1")}getVVData(t){return this.getVisualVariableData(t)}getDataDrivenData0(t){let e=this.getAttributeDataCoords(t);return(0,s.ig)(this.dataDriven0,e).setDebugName("storage30")}getDataDrivenData1(t){let e=this.getAttributeDataCoords(t);return(0,s.ig)(this.dataDriven1,e).setDebugName("storage31")}getDataDrivenData2(t){let e=this.getAttributeDataCoords(t);return(0,s.ig)(this.dataDriven2,e).setDebugName("storage32")}getGPGPUData(t){let e=this.getAttributeDataCoords(t);return(0,s.ig)(this.gpgpu,e).setDebugName("storage4")}getFilterFlags(t){return(0,u.Z)("webgl-ignores-sampler-precision")?(0,s.mD)(this.getFilterData(t).x.multiply((0,s.fz)(255))):this.getFilterData(t).x.multiply((0,s.fz)(255))}getAnimationValue(t){return this.getAnimationData(t).x}getSizeValue(t){return this.getVisualVariableData(t).x}getColorValue(t){return this.getVisualVariableData(t).y}getOpacityValue(t){return this.getVisualVariableData(t).z}getRotationValue(t){return this.getVisualVariableData(t).w}}(0,n._)([(0,o.e5)(s.Eg)],l.prototype,"filterFlags",void 0),(0,n._)([(0,o.e5)(s.Eg)],l.prototype,"animation",void 0),(0,n._)([(0,o.e5)(s.Eg)],l.prototype,"gpgpu",void 0),(0,n._)([(0,o.e5)(s.Eg)],l.prototype,"visualVariableData",void 0),(0,n._)([(0,o.e5)(s.Eg)],l.prototype,"dataDriven0",void 0),(0,n._)([(0,o.e5)(s.Eg)],l.prototype,"dataDriven1",void 0),(0,n._)([(0,o.e5)(s.Eg)],l.prototype,"dataDriven2",void 0),(0,n._)([(0,o.e5)(s.bv)],l.prototype,"size",void 0);class c extends o.oo{}(0,n._)([(0,o.e5)(s.bv)],c.prototype,"activeReasons",void 0),(0,n._)([(0,o.e5)(s.bv)],c.prototype,"highlightAll",void 0);class d extends o.oo{}(0,n._)([(0,o.e5)(s.Sg)],d.prototype,"position",void 0),(0,n._)([(0,o.e5)(s.bv)],d.prototype,"distance",void 0),(0,n._)([(0,o.e5)(s.bv)],d.prototype,"smallSymbolDistance",void 0),(0,n._)([(0,o.e5)(s.bv)],d.prototype,"smallSymbolSizeThreshold",void 0);var p=r(59284);class h extends o.Pz{}(0,n._)([(0,o.xh)(0,s.AO)],h.prototype,"id",void 0),(0,n._)([(0,o.xh)(1,s.bv)],h.prototype,"bitset",void 0),(0,n._)([(0,o.xh)(2,s.Sg)],h.prototype,"pos",void 0);class f extends o.yu{}(0,n._)([(0,o.xh)(14,s.Sg)],f.prototype,"nextPos1",void 0),(0,n._)([(0,o.xh)(15,s.Sg)],f.prototype,"nextPos2",void 0);class y extends o.XB{}class m extends o.ri{clip(t,e){let r=new s.bv(0),n=this.storage.getFilterFlags(t);if(r=r.add((0,s.fz)(2).multiply((0,s.fz)(1).subtract((0,a.bG)(n,0)))),this.inside?r=r.add((0,s.fz)(2).multiply((0,s.fz)(1).subtract((0,a.bG)(n,1)))):this.outside?r=r.add((0,s.fz)(2).multiply((0,a.bG)(n,1))):this.highlight&&(r=r.add((0,s.fz)(2).multiply((0,s.fz)(1).subtract(this._checkHighlight(n))))),null!=e){let t=new s.bv(1).subtract((0,s.Nb)(e.x,this.view.currentZoom)),n=(0,s.Nb)(e.y,this.view.currentZoom);r=r.add(new s.bv(2).multiply(t.add(n)))}return r}getFragmentOutput(t,e,r=new s.bv(1/255)){let n=new o.Qt;return n.glFragColor=this._maybeWriteHittest(e)??this._maybeHighlight(t,r)??t,n}_maybeHighlight(t,e){return this.highlight?new s.T8(t.rgb,(0,s.Nb)(e,t.a)):null}_checkHighlight(t){let e=this._checkHighlightBit(t,0);for(let r=1;r<i.Oo.length;r++)e=e.add(this._checkHighlightBit(t,r));return(0,s.Nb)(new s.bv(.1),e.add(this.highlight.highlightAll))}_checkHighlightBit(t,e){return(0,a.hG)(t,e).multiply((0,a.qD)(this.highlight.activeReasons,e))}maybeRunHittest(t,e,r){if(null==this.hittestRequest)return null;let n=this.hittest(t,e,r),i=(0,s.KJ)((0,s.tS)(n,this.hittestRequest.distance),new s.bv(2),new s.bv(0)),o=this.storage.getAttributeDataCoords(t.id),u=(0,a.pK)(o);i=i.add(this.clip(t.id,t.zoomRange));let l=new s.T8(new s.bv(1/255),0,0,0);return{glPointSize:new s.bv(1),glPosition:new s.T8(u,i,1),color:l}}_maybeWriteHittest(t){return null!=this.hittestRequest?t.color:null}}(0,n._)([o.Ou],m.prototype,"inside",void 0),(0,n._)([o.Ou],m.prototype,"outside",void 0),(0,n._)([(0,o.Kw)(c)],m.prototype,"highlight",void 0),(0,n._)([(0,o.e5)(l)],m.prototype,"storage",void 0),(0,n._)([(0,o.e5)(p.C)],m.prototype,"view",void 0),(0,n._)([(0,o.Kw)(d)],m.prototype,"hittestRequest",void 0)},91610:function(t,e,r){r.d(e,{LU:function(){return m},Oh:function(){return y},YW:function(){return f}});var n=r(86641),i=r(66829),o=r(85495),s=r(59182),u=r(62415),a=r(50721),l=r(51515),c=r(44672),d=r(89049);class p extends a.F{}(0,n._)([(0,i.xh)(5,o.T8)],p.prototype,"tlbr",void 0),(0,n._)([(0,i.xh)(6,o.bv)],p.prototype,"width",void 0),(0,n._)([(0,i.xh)(7,o.bv)],p.prototype,"height",void 0),(0,n._)([(0,i.xh)(8,o.Sg)],p.prototype,"offset",void 0),(0,n._)([(0,i.xh)(9,o.Sg)],p.prototype,"scale",void 0),(0,n._)([(0,i.xh)(10,o.bv)],p.prototype,"angle",void 0);class h extends s.fz{}function f(t,e){let r=t.view.requiredZoomFactor,n=new o.Sg(e.width,e.height),i=n.multiply(e.scale).multiply(r),s=e.angle.multiply(u.e4),a=(0,o.O$)(s),l=(0,o.mC)(s),c=function(t,e,r,n,i){let s=(0,o.ln)((0,d.qD)(i,u.Ux),(0,o.fz)(1)),a=(0,d.JH)(new o.T8(t,0));return(0,o.KJ)(s,(0,o.wO)(n.divide(e.x),r.divide(e.y),0,(0,o.tk)(r.divide(e.x)),n.divide(e.y),0,(0,d.TN)((0,o.K4)(a,0)),(0,d.TN)((0,o.K4)(0,a)),1),(0,o.wO)(n.divide(e.x),r.divide(e.y),0,(0,o.tk)(r.divide(e.x)),n.divide(e.y),0,0,0,1))}(e.id,i,a,l,e.bitset),p=t.localTileOffset.getPatternOffsetAtTileOrigin(n,a,l),h=r.multiply(e.scale).multiply(e.offset.subtract(p)).divide(i),f=new o.AO(e.pos,1),y=c.multiply(f).xy.subtract(h),m=e.tlbr.divide(t.mosaicInfo.size.xyxy),v=(0,d.qD)(e.bitset,u.GS);return null!=t.visualVariableColor&&(v=(0,o.KJ)((0,d.In)(t.storage.getColorValue(e.id)),new o.bv(0),v)),{tileTextureCoord:y,tlbr:m,sampleAlphaOnly:v}}function y(t,e){let r=(0,o.wQ)(e.tileTextureCoord,new o.bv(1)),n=(0,o.CD)(e.tlbr.xy,e.tlbr.zw,r),i=(0,o.ig)(t.mosaicInfo.texture,n);return i=(0,o.KJ)((0,o.tS)(e.sampleAlphaOnly,new o.bv(.5)),i.aaaa,i),e.color.multiply(i)}class m extends a.C{vertex(t,e){return{...super.vertex(t,e),...f(this,t)}}fragment(t){let e=y(this,t);return this.getFragmentOutput(e,t,new o.bv(0))}}(0,n._)([(0,i.e5)(c.N)],m.prototype,"mosaicInfo",void 0),(0,n._)([(0,i.e5)(l.H)],m.prototype,"localTileOffset",void 0),(0,n._)([(0,n.a)(0,(0,i.qH)(p)),(0,n.a)(1,(0,i.qH)(s.RS))],m.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,i.qH)(h))],m.prototype,"fragment",null)},13788:function(t,e,r){r.d(e,{$1:function(){return f},NS:function(){return y},Nz:function(){return b}});var n=r(86641),i=r(66829),o=r(85495),s=r(59182),u=r(91610),a=r(84372),l=r(99003),c=r(51515),d=r(44672),p=r(60052),h=r(37240);let f=16,y=128;class m extends s.HN{}(0,n._)([(0,i.xh)(3,o.T8)],m.prototype,"color",void 0),(0,n._)([(0,i.xh)(4,o.T8)],m.prototype,"tlbr",void 0),(0,n._)([(0,i.xh)(5,o.bv)],m.prototype,"angle",void 0),(0,n._)([(0,i.xh)(6,o.bv)],m.prototype,"aux1",void 0),(0,n._)([(0,i.xh)(7,o.bv)],m.prototype,"aux2",void 0),(0,n._)([(0,i.xh)(8,o.Sg)],m.prototype,"aux3",void 0),(0,n._)([(0,i.xh)(9,o.Sg)],m.prototype,"aux4",void 0),(0,n._)([(0,i.xh)(10,o.Sg)],m.prototype,"zoomRange",void 0);class v extends h.K7{}class b extends p.VV{vertex(t,e){let{aux1:r,aux2:n,aux3:i,aux4:s}=t,a={...t,width:r,height:n,offset:i,scale:s.multiply(.0625)},l={...t,halfWidth:r,referenceHalfWidth:n,offset:i,normal:s.subtract(y).multiply(.0625)},c=(0,p.R0)(this,l),d=(0,u.YW)(this,a),h=(0,o.tS)(c.isOutline,new o.bv(.5));return{...c,...d,...this.maybeRunHittest(t,e,h)}}fragment(t){let{isOutline:e}=t,r=(0,o.tS)(e,new o.bv(.5)),n=(0,l.zj)(t,this.antialiasingControls.blur),i=(0,u.Oh)(this,t),s=(0,o.KJ)(r,n,i),a=(0,o.KJ)(r,new o.bv(1/255),new o.bv(0));return this.getFragmentOutput(s,t,a)}hittest(t,e,r){return(0,o.KJ)(r,(0,a.Oz)(this.hittestRequest),(0,a.CC)(this,t,e))}}(0,n._)([(0,i.e5)(d.N)],b.prototype,"mosaicInfo",void 0),(0,n._)([(0,i.e5)(c.H)],b.prototype,"localTileOffset",void 0),(0,n._)([(0,n.a)(0,(0,i.qH)(m)),(0,n.a)(1,(0,i.qH)(s.RS))],b.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,i.qH)(v))],b.prototype,"fragment",null)},50721:function(t,e,r){r.d(e,{C:function(){return p},F:function(){return d}});var n=r(86641),i=r(66829),o=r(85495),s=r(59182),u=r(84372),a=r(71701),l=r(77202),c=r(23783);class d extends s.HN{}(0,n._)([(0,i.xh)(3,o.T8)],d.prototype,"color",void 0),(0,n._)([(0,i.xh)(4,o.Sg)],d.prototype,"zoomRange",void 0);class p extends s.Ie{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}vertex(t,e){let r=(0,c.sY)(this,t.id),n=(0,c.Zt)(this,t.id,t.color).multiply(r),i=this.view.displayViewScreenMat3.multiply(new o.AO(t.pos.xy,1)),s=this.clip(t.id,t.zoomRange);return{glPosition:new o.T8(i.xy,s,1),color:n,...this.maybeRunHittest(t,e,null)}}fragment(t){return this.getFragmentOutput(t.color,t,new o.bv(0))}hittest(t,e){return(0,u.CC)(this,t,e)}}(0,n._)([(0,i.Kw)(a.W)],p.prototype,"visualVariableColor",void 0),(0,n._)([(0,i.Kw)(l.V)],p.prototype,"visualVariableOpacity",void 0),(0,n._)([(0,n.a)(0,(0,i.qH)(d)),(0,n.a)(1,(0,i.qH)(s.RS))],p.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,i.qH)(s.fz))],p.prototype,"fragment",null)},99003:function(t,e,r){r.d(e,{Pf:function(){return S},Wc:function(){return _},b$:function(){return b},fc:function(){return v},tp:function(){return m},uY:function(){return w},zj:function(){return x}});var n=r(86641),i=r(66829),o=r(85495),s=r(59182),u=r(62415),a=r(84372),l=r(71701),c=r(77202),d=r(18673),p=r(39299),h=r(19581),f=r(56703),y=r(23783);class m extends s.HN{}(0,n._)([(0,i.xh)(3,o.T8)],m.prototype,"color",void 0),(0,n._)([(0,i.xh)(4,o.Sg)],m.prototype,"offset",void 0),(0,n._)([(0,i.xh)(5,o.Sg)],m.prototype,"normal",void 0),(0,n._)([(0,i.xh)(6,o.bv)],m.prototype,"halfWidth",void 0),(0,n._)([(0,i.xh)(7,o.bv)],m.prototype,"referenceHalfWidth",void 0),(0,n._)([(0,i.xh)(8,o.Sg)],m.prototype,"zoomRange",void 0);class v extends s.fz{}class b extends i.oo{}function g(t){return(0,o.Fp)(new o.bv(u.Ay).multiply((0,o.Nb)(t,new o.bv(u.xp))),new o.bv(1))}function _(t,e){let{halfWidth:r,normal:n}=t,i=g(r),s=(0,o.kE)(n).multiply(r);return(0,o.uZ)(i.multiply(r.subtract(s)).divide(e.add(i).subtract(new o.bv(1))),new o.bv(0),new o.bv(1))}function w(t,e){let{id:r,offset:n,pos:i,normal:s,zoomRange:a}=e,{displayViewScreenMat3:l,displayViewMat3:c}=t.view,d=(0,y.Zt)(t,r,e.color),p=(0,y.sY)(t,r),h=function(t,e){let{id:r,halfWidth:n,referenceHalfWidth:i}=e;if((0,y.lA)(t)){let e=new o.bv(2).multiply(i),s=(0,y.Vm)(t,r,e);return new o.bv(.5).multiply(n.divide((0,o.Fp)(i,new o.bv(u.Ho)))).multiply(s)}return n}(t,e),f=new o.bv(.5).multiply(t.antialiasingControls.antialiasing),m=(0,o.Fp)(h.add(f),new o.bv(.45)).add(new o.bv(.1).multiply(f)),v=g(m).multiply(m).multiply(n),b=c.multiply(new o.AO(v,new o.bv(0))),_=l.multiply(new o.AO(i,new o.bv(1))).add(b),w=new o.bv(2).multiply((0,o.Nb)(h,new o.bv(0))).add(t.clip(r,a)),x=new o.T8(_.xy,w,1);return{color:d,opacity:p,halfWidth:m,normal:s,scaledOffset:v,scaledHalfWidth:h,glPosition:new o.T8(x.xy,w,1)}}function x(t,e){let{opacity:r,color:n}=t,i=_(t,e);return r.multiply(n).multiply(i)}(0,n._)([(0,i.e5)(o.bv)],b.prototype,"antialiasing",void 0),(0,n._)([(0,i.e5)(o.bv)],b.prototype,"blur",void 0);class S extends s.Ie{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}vertex(t,e){let r=w(this,t);return{...r,...this.maybeRunHittest(t,e,r.halfWidth)}}fragment(t){let e=x(t,this.antialiasingControls.blur);return this.getFragmentOutput(e,t)}hittest(t,e,r){let{viewMat3:n,tileMat3:i}=this.view,s=n.multiply(i),u=s.multiply(new o.AO(t.pos,1)),l=s.multiply(new o.AO(e.nextPos1,1)),c=s.multiply(new o.AO(e.nextPos2,1)),{distance:d,smallSymbolDistance:p,smallSymbolSizeThreshold:h}=this.hittestRequest,f=(0,o.Nb)(r,h.multiply(.5)).multiply(d.subtract(p)),y=this.hittestRequest.position;return(0,o.VV)((0,a.bA)(y,u.xy,l.xy),(0,a.bA)(y,u.xy,c.xy)).subtract(r).add(f)}}(0,n._)([(0,i.e5)(b)],S.prototype,"antialiasingControls",void 0),(0,n._)([(0,i.Kw)(l.W)],S.prototype,"visualVariableColor",void 0),(0,n._)([(0,i.Kw)(c.V)],S.prototype,"visualVariableOpacity",void 0),(0,n._)([(0,i.Kw)(d.k)],S.prototype,"visualVariableSizeMinMaxValue",void 0),(0,n._)([(0,i.Kw)(p.U)],S.prototype,"visualVariableSizeScaleStops",void 0),(0,n._)([(0,i.Kw)(h.W)],S.prototype,"visualVariableSizeStops",void 0),(0,n._)([(0,i.Kw)(f.V)],S.prototype,"visualVariableSizeUnitValue",void 0),(0,n._)([(0,n.a)(0,(0,i.qH)(m)),(0,n.a)(1,(0,i.qH)(s.RS))],S.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,i.qH)(v))],S.prototype,"fragment",null)},51515:function(t,e,r){r.d(e,{H:function(){return u}});var n=r(86641),i=r(66829),o=r(85495),s=r(62415);class u extends i.oo{getPatternOffsetAtTileOrigin(t,e=new o.bv(0),r=new o.bv(1)){let n=new o.Sg(s.ad).divide(t),i=t.multiply((0,o.ZI)(this.maxIntsToLocalOrigin.multiply(n))).add(this.tileOffsetFromLocalOrigin).subtract(new o.bv(.5).multiply(t));return i=new o.Sg(i.x.multiply(r).subtract(i.y.multiply(e)),i.x.multiply(e).add(i.y.multiply(r))),(0,o.wQ)(i,t)}}(0,n._)([(0,i.e5)(o.Sg)],u.prototype,"tileOffsetFromLocalOrigin",void 0),(0,n._)([(0,i.e5)(o.Sg)],u.prototype,"maxIntsToLocalOrigin",void 0)},44672:function(t,e,r){r.d(e,{N:function(){return s}});var n=r(86641),i=r(66829),o=r(85495);class s extends i.oo{}(0,n._)([(0,i.e5)(o.Sg)],s.prototype,"size",void 0),(0,n._)([(0,i.e5)(o.Eg)],s.prototype,"texture",void 0)},60052:function(t,e,r){r.d(e,{N8:function(){return b},R0:function(){return _},VV:function(){return w},jt:function(){return g},py:function(){return x}});var n=r(86641),i=r(66829),o=r(85495),s=r(59182),u=r(62415),a=r(84372),l=r(99003),c=r(89049),d=r(71701),p=r(77202),h=r(18673),f=r(39299),y=r(19581),m=r(56703),v=r(23783);class b extends s.HN{}(0,n._)([(0,i.xh)(3,o.Sg)],b.prototype,"offset",void 0),(0,n._)([(0,i.xh)(4,o.T8)],b.prototype,"color",void 0),(0,n._)([(0,i.xh)(5,o.Sg)],b.prototype,"normal",void 0),(0,n._)([(0,i.xh)(6,o.bv)],b.prototype,"halfWidth",void 0),(0,n._)([(0,i.xh)(7,o.bv)],b.prototype,"referenceHalfWidth",void 0),(0,n._)([(0,i.xh)(8,o.Sg)],b.prototype,"zoomRange",void 0);class g extends l.fc{}function _(t,e,r){let{id:n,bitset:i}=e,s=(0,c.qD)(i,u.WD),a=(0,o.tS)(s,new o.bv(.5)),d=(0,l.uY)(t,e),p=(0,o.KJ)(a,d.halfWidth,new o.bv(0)),h=(0,v.sY)(t,n),f=(0,v.Zt)(t,n,e.color),y=(0,o.KJ)(a,e.color,f.multiply(h)),m=t.view.displayViewScreenMat3.multiply(new o.AO(e.pos.xy,1)),b=t.clip(e.id),g=new o.T8(m.xy,b,1),_=(0,o.KJ)(a,d.glPosition,g),w=r&&t.maybeRunHittest(e,r,a);return{isOutline:s,color:y,opacity:new o.bv(1),halfWidth:p,normal:d.normal,glPosition:_,...w}}class w extends s.Ie{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}}(0,n._)([(0,i.e5)(l.b$)],w.prototype,"antialiasingControls",void 0),(0,n._)([(0,i.Kw)(d.W)],w.prototype,"visualVariableColor",void 0),(0,n._)([(0,i.Kw)(p.V)],w.prototype,"visualVariableOpacity",void 0),(0,n._)([(0,i.Kw)(h.k)],w.prototype,"visualVariableSizeMinMaxValue",void 0),(0,n._)([(0,i.Kw)(f.U)],w.prototype,"visualVariableSizeScaleStops",void 0),(0,n._)([(0,i.Kw)(y.W)],w.prototype,"visualVariableSizeStops",void 0),(0,n._)([(0,i.Kw)(m.V)],w.prototype,"visualVariableSizeUnitValue",void 0);class x extends w{vertex(t,e){return _(this,t,e)}fragment(t){let{color:e,isOutline:r}=t,n=(0,o.tS)(r,new o.bv(.5)),i=(0,l.zj)(t,this.antialiasingControls.blur),s=(0,o.KJ)(n,i,e),u=(0,o.KJ)(n,new o.bv(1/255),new o.bv(0));return this.getFragmentOutput(s,t,u)}hittest(t,e,r){return(0,o.KJ)(r,(0,a.Oz)(this.hittestRequest),(0,a.CC)(this,t,e))}}(0,n._)([(0,n.a)(0,(0,i.qH)(b)),(0,n.a)(1,(0,i.qH)(s.RS))],x.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,i.qH)(g))],x.prototype,"fragment",null)},57669:function(t,e,r){r.d(e,{DS:function(){return h},Qp:function(){return p},lA:function(){return f}});var n=r(86641),i=r(66829),o=r(85495),s=r(59182),u=r(50721),a=r(51515),l=r(44672);class c extends u.F{}(0,n._)([(0,i.xh)(5,o.T8)],c.prototype,"tlbr",void 0),(0,n._)([(0,i.xh)(6,o.bv)],c.prototype,"inverseRasterizationScale",void 0);class d extends s.fz{}function p(t,e){let r=e.tlbr.xy,n=e.tlbr.zw,i=n.x.subtract(r.x),s=r.y.subtract(n.y),u=new o.Sg(i,s).multiply(e.inverseRasterizationScale),a=u.multiply(t.view.requiredZoomFactor),l=function(t){let e=new o.bv(1),r=new o.bv(0);return new o.Tu(e.divide(t.x),r.divide(t.y),0,(0,o.tk)(r.divide(t.x)),e.divide(t.y),0,0,0,1)}(a),c=t.localTileOffset.getPatternOffsetAtTileOrigin(u).divide(a),d=new o.AO(e.pos,1);return{tileTextureCoord:l.multiply(d).xy.subtract(c),tlbr:e.tlbr.divide(t.mosaicInfo.size.xyxy)}}function h(t,e){let r=(0,o.wQ)(t.tileTextureCoord,new o.bv(1)),n=(0,o.CD)(t.tlbr.xy,t.tlbr.zw,r),i=(0,o.ig)(e.texture,n);return t.color.multiply(i)}class f extends u.C{vertex(t,e){return{...super.vertex(t,e),...p(this,t)}}fragment(t){let e=h(t,this.mosaicInfo);return this.getFragmentOutput(e,t,new o.bv(0))}}(0,n._)([(0,i.e5)(l.N)],f.prototype,"mosaicInfo",void 0),(0,n._)([(0,i.e5)(a.H)],f.prototype,"localTileOffset",void 0),(0,n._)([(0,n.a)(0,(0,i.qH)(c)),(0,n.a)(1,(0,i.qH)(s.RS))],f.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,i.qH)(d))],f.prototype,"fragment",null)},37240:function(t,e,r){r.d(e,{K7:function(){return h},Zd:function(){return f}});var n=r(86641),i=r(66829),o=r(85495),s=r(59182),u=r(99003),a=r(51515),l=r(44672),c=r(60052),d=r(57669);class p extends c.N8{}(0,n._)([(0,i.xh)(9,o.T8)],p.prototype,"tlbr",void 0),(0,n._)([(0,i.xh)(10,o.bv)],p.prototype,"inverseRasterizationScale",void 0);class h extends c.jt{}class f extends c.py{vertex(t,e){return{...(0,c.R0)(this,t,e),...(0,d.Qp)(this,t)}}fragment(t){let{isOutline:e}=t,r=(0,o.tS)(e,new o.bv(.5)),n=(0,u.zj)(t,this.antialiasingControls.blur),i=(0,d.DS)(t,this.mosaicInfo),s=(0,o.KJ)(r,n,i),a=(0,o.KJ)(r,new o.bv(1/255),new o.bv(0));return this.getFragmentOutput(s,t,a)}}(0,n._)([(0,i.e5)(l.N)],f.prototype,"mosaicInfo",void 0),(0,n._)([(0,i.e5)(a.H)],f.prototype,"localTileOffset",void 0),(0,n._)([(0,n.a)(0,(0,i.qH)(p)),(0,n.a)(1,(0,i.qH)(s.RS))],f.prototype,"vertex",null),(0,n._)([(0,n.a)(0,(0,i.qH)(h))],f.prototype,"fragment",null)},59284:function(t,e,r){r.d(e,{C:function(){return s}});var n=r(86641),i=r(66829),o=r(85495);class s extends i.oo{}(0,n._)([(0,i.e5)(o.Tu)],s.prototype,"displayViewScreenMat3",void 0),(0,n._)([(0,i.e5)(o.Tu)],s.prototype,"displayViewMat3",void 0),(0,n._)([(0,i.e5)(o.Tu)],s.prototype,"displayMat3",void 0),(0,n._)([(0,i.e5)(o.Tu)],s.prototype,"viewMat3",void 0),(0,n._)([(0,i.e5)(o.Tu)],s.prototype,"tileMat3",void 0),(0,n._)([(0,i.e5)(o.bv)],s.prototype,"displayZoomFactor",void 0),(0,n._)([(0,i.e5)(o.bv)],s.prototype,"requiredZoomFactor",void 0),(0,n._)([(0,i.e5)(o.Sg)],s.prototype,"tileOffset",void 0),(0,n._)([(0,i.e5)(o.bv)],s.prototype,"currentScale",void 0),(0,n._)([(0,i.e5)(o.bv)],s.prototype,"currentZoom",void 0),(0,n._)([(0,i.e5)(o.bv)],s.prototype,"metersPerSRUnit",void 0),(0,n._)([(0,i.e5)(o.bv)],s.prototype,"rotation",void 0),(0,n._)([(0,i.e5)(o.bv)],s.prototype,"pixelRatio",void 0)},71701:function(t,e,r){r.d(e,{W:function(){return u}});var n=r(86641),i=r(66829),o=r(85495),s=r(89049);class u extends i.oo{getColor(t,e,r){return(0,o.wV)([(0,o.or)((0,s.In)(t),r),e],[(0,o.Iz)(t,this.values.first()),this.colors.first()],[(0,o.r7)(t,this.values.last()),this.colors.last()],[!0,()=>{let e=this.values.findIndex(e=>(0,o.tS)(e,t)),r=this.values.get(e),n=e.subtract(1),i=this.values.get(n),s=t.subtract(i).divide(r.subtract(i));return(0,o.CD)(this.colors.get(n),this.colors.get(e),s)}])}}(0,n._)([(0,i.e5)(o.v8.ofType(o.T8,8))],u.prototype,"colors",void 0),(0,n._)([(0,i.e5)(o.v8.ofType(o.bv,8))],u.prototype,"values",void 0)},77202:function(t,e,r){r.d(e,{V:function(){return u}});var n=r(86641),i=r(66829),o=r(85495),s=r(89049);class u extends i.oo{getOpacity(t){return(0,o.wV)([(0,s.In)(t),new o.bv(1)],[(0,o.Iz)(t,this.opacityValues.first()),this.opacities.first()],[(0,o.r7)(t,this.opacityValues.last()),this.opacities.last()],[!0,()=>{let e=this.opacityValues.findIndex(e=>(0,o.tS)(e,t)),r=this.opacityValues.get(e),n=e.subtract(1),i=this.opacityValues.get(n),s=t.subtract(i).divide(r.subtract(i));return(0,o.CD)(this.opacities.get(n),this.opacities.get(e),s)}])}}(0,n._)([(0,i.e5)(o.v8.ofType(o.bv,8))],u.prototype,"opacities",void 0),(0,n._)([(0,i.e5)(o.v8.ofType(o.bv,8))],u.prototype,"opacityValues",void 0)},18673:function(t,e,r){r.d(e,{k:function(){return u}});var n=r(86641),i=r(66829),o=r(85495),s=r(89049);class u extends i.oo{getSize(t,e){let r=this.minMaxValueAndSize.xy,n=this.minMaxValueAndSize.zw;return(0,o.KJ)((0,s.In)(t),e,()=>{let e=t.subtract(r.x).divide(r.y.subtract(r.x)),i=(0,o.uZ)(e,new o.bv(0),new o.bv(1));return n.x.add(i.multiply(n.y.subtract(n.x)))})}}(0,n._)([(0,i.e5)(o.T8)],u.prototype,"minMaxValueAndSize",void 0)},39299:function(t,e,r){r.d(e,{U:function(){return s}});var n=r(86641),i=r(66829),o=r(85495);class s extends i.oo{getSizeForViewScale(t){return(0,o.wV)([(0,o.Iz)(t,this.values.first()),this.sizes.first()],[(0,o.r7)(t,this.values.last()),this.sizes.last()],[!0,()=>{let e=this.values.findIndex(e=>(0,o.tS)(e,t)),r=this.values.get(e),n=e.subtract(1),i=this.values.get(n),s=t.subtract(i).divide(r.subtract(i));return(0,o.CD)(this.sizes.get(n),this.sizes.get(e),s)}])}}(0,n._)([(0,i.e5)(o.v8.ofType(o.bv,8))],s.prototype,"sizes",void 0),(0,n._)([(0,i.e5)(o.v8.ofType(o.bv,8))],s.prototype,"values",void 0)},19581:function(t,e,r){r.d(e,{W:function(){return u}});var n=r(86641),i=r(66829),o=r(85495),s=r(89049);class u extends i.oo{getSize(t,e){let r=(0,o.wV)([(0,s.In)(t),e],[(0,o.Iz)(t,this.values.first()),this.sizes.first()],[(0,o.r7)(t,this.values.last()),this.sizes.last()],[!0,()=>{let e=this.values.findIndex(e=>(0,o.tS)(e,t)),r=this.values.get(e),n=e.subtract(1),i=this.values.get(n),s=t.subtract(i).divide(r.subtract(i));return(0,o.CD)(this.sizes.get(n),this.sizes.get(e),s)}]);return(0,o.KJ)((0,s.In)(r),e,r)}}(0,n._)([(0,i.e5)(o.v8.ofType(o.bv,8))],u.prototype,"sizes",void 0),(0,n._)([(0,i.e5)(o.v8.ofType(o.bv,8))],u.prototype,"values",void 0)},56703:function(t,e,r){r.d(e,{V:function(){return u}});var n=r(86641),i=r(66829),o=r(85495),s=r(89049);class u extends i.oo{getSize(t,e){return(0,o.KJ)((0,s.In)(t),e,t.multiply(this.unitValueToPixelsRatio))}}(0,n._)([(0,i.e5)(o.bv)],u.prototype,"unitValueToPixelsRatio",void 0)},62415:function(t,e,r){var n,i;r.d(e,{$r:function(){return w},Ay:function(){return a},B7:function(){return g},GS:function(){return y},Ho:function(){return p},Ke:function(){return d},MO:function(){return n},T5:function(){return h},Ux:function(){return v},V_:function(){return c},WD:function(){return m},Wq:function(){return b},ad:function(){return x},e4:function(){return s},k9:function(){return f},mL:function(){return _},nF:function(){return o},nU:function(){return u},xp:function(){return l}}),(i=n||(n={}))[i.Geographic=0]="Geographic",i[i.Arithmatic=1]="Arithmatic";let o=3.14159265359/180,s=3.14159265359/128,u=1,a=1.1,l=1,c=24,d=8,p=1e-5,h=.05,f=1e-30,y=4,m=0,v=2,b=2,g=3,_=0,w=3,x=16777216},84372:function(t,e,r){r.d(e,{CC:function(){return d},Oz:function(){return c},P0:function(){return l},XM:function(){return p},bA:function(){return s},hF:function(){return a},lD:function(){return u}});var n=r(85495),i=r(62415),o=r(89049);function s(t,e,r){var i;let o=r.subtract(e),s=(i=t.subtract(e),(0,n.AK)(i,(0,n.Fv)(o))),u=(0,n.uZ)(s.divide((0,n.kE)(o)),new n.bv(0),new n.bv(1));return(0,n.TE)(t,e.add(u.multiply(r.subtract(e))))}function u(t){let e=(0,n.Wn)(t);return(0,n.Nb)(e.x.add(e.y).add(e.z),new n.bv(1.05))}function a(t,e,r,i){let o=new n.Tu(r.x.multiply(i.y).subtract(i.x.multiply(r.y)),i.x.multiply(e.y).subtract(e.x.multiply(i.y)),e.x.multiply(r.y).subtract(r.x.multiply(e.y)),r.y.subtract(i.y),i.y.subtract(e.y),e.y.subtract(r.y),i.x.subtract(r.x),e.x.subtract(i.x),r.x.subtract(e.x)),s=e.x.multiply(r.y.subtract(i.y)),u=r.x.multiply(i.y.subtract(e.y)),a=i.x.multiply(e.y.subtract(r.y)),l=s.add(u).add(a);return new n.bv(1).divide(l).multiply(o.multiply(new n.AO(1,t)))}function l(t,e,r,l){var c;let d=r.subtract(e),p=l.subtract(e),h=(0,o.xQ)(d,p),f=(0,n.xD)((0,n.Qj)(h,new n.bv(i.T5)),(0,n.tS)(h,new n.bv(-i.T5)));return(0,n.wV)([(0,n.xD)((0,n.ff)(f),(c=t.xy,(0,n.ln)(u(a(c,e,r,l)),new n.bv(1)))),new n.bv(-1)],[!0,()=>{let i=s(t,e,r),o=s(t,r,l),u=s(t,l,e);return(0,n.VV)((0,n.VV)(i,o),u)}])}function c(t){return t.distance.add(1)}function d(t,e,r){let{viewMat3:i,tileMat3:o}=t.view,s=i.multiply(o),u=s.multiply(new n.AO(e.pos,1)),a=s.multiply(new n.AO(r.nextPos1,1)),c=s.multiply(new n.AO(r.nextPos2,1));return l(t.hittestRequest.position,u.xy,a.xy,c.xy)}function p(t,e,r){return(0,n.TE)(t,r).subtract(e)}},89049:function(t,e,r){r.d(e,{In:function(){return u},JH:function(){return y},TN:function(){return s},Wv:function(){return f},X3:function(){return m},bG:function(){return p},h7:function(){return d},hG:function(){return h},pK:function(){return l},qD:function(){return c},xQ:function(){return a}});var n=r(7078),i=r(85495),o=r(62415);function s(t){let e=(0,i.fz)(12.9898),r=(0,i.fz)(78.233),n=(0,i.fz)(43758.5453),o=(0,i.AK)(t,(0,i.K4)(e,r)),s=(0,i.wQ)(o,(0,i.fz)(3.14));return(0,i.ZI)((0,i.O$)(s).multiply(n))}function u(t){return(0,i.ln)(t,(0,i.fz)(o.k9))}function a(t,e){return t.x.multiply(e.y).subtract(e.x.multiply(t.y))}function l(t){return t.multiply(2).subtract(1)}function c(t,e){let r=(0,i.fz)(2**e);return(0,i.wQ)((0,i.GW)(t.divide(r)),(0,i.fz)(2))}function d(t,e){return(0,i.tS)(c(t,e),(0,i.fz)(.5))}function p(t,e){return c(t,e+n.Oo.length)}function h(t,e){return c(t,e)}function f(t){let e=c(t.z,7),r=(0,i.fz)(1).subtract(e),n=t.xyz.subtract((0,i.R3)(0,0,(0,i.fz)(128)));return r.multiply(t).add(e.multiply(n))}function y(t){let e=(0,i.vh)(255/256,255/65536,255/16777216,255/4294967296);return(0,i.AK)(t,e)}function m(t){return(0,i.Fp)((0,i.Fp)((0,i.Fp)(t.x,t.y),t.z),t.w)}},23783:function(t,e,r){r.d(e,{H8:function(){return a},Vm:function(){return o},Zt:function(){return s},lA:function(){return i},sY:function(){return u}});var n=r(85495);function i(t){return null!=t.visualVariableSizeMinMaxValue||null!=t.visualVariableSizeScaleStops||null!=t.visualVariableSizeStops||null!=t.visualVariableSizeUnitValue}function o(t,e,r){if(i(t)){let n=t.storage.getSizeValue(e);return t.visualVariableSizeMinMaxValue?.getSize(n,r)??t.visualVariableSizeScaleStops?.getSizeForViewScale(t.view.currentScale)??t.visualVariableSizeStops?.getSize(n,r)??t.visualVariableSizeUnitValue?.getSize(n,r)}return r}function s(t,e,r,i=new n.tW(!1)){if(null==t.visualVariableColor)return r;let o=t.storage.getColorValue(e);return t.visualVariableColor.getColor(o,r,i)}function u(t,e){if(null==t.visualVariableOpacity)return new n.bv(1);let r=t.storage.getOpacityValue(e);return t.visualVariableOpacity.getOpacity(r)}function a(t,e){if(null==t.visualVariableRotation)return n.Tu.identity();let r=t.storage.getRotationValue(e);return t.visualVariableRotation.getVVRotationMat3(r)}},17490:function(t,e,r){r.d(e,{X:function(){return c}});var n=r(94605),i=r(65223),o=r(49119);r(3457),r(37180),r(39972),r(71193),r(59546);var s=r(73499);r(36230),r(15809);var u=r(94690);let a=()=>i.Z.getLogger("esri.views.2d.engine.webgl.shaderGraph.typed.TypedShaderProgram");function l(t,e,r){let i=e.length;if(i!==r){let o=new n.Z("Invalid Uniform",`Invalid length, expected ${r} but got ${i}`,{uniformName:t,values:e});a().errorOnce(o)}}class c{constructor(t,e,r,n,i,o){this._program=null,this._vao=null,this._temporaryTextures=[],this.vertexShader=t,this.fragmentShader=e,this._locations=r,this._locationInfo=n,this._uniformBindings=i,this._transformFeedbackBindings=o}destroy(){this._program&&this._program.dispose(),this.cleanupTemporaryTextures()}get locations(){return this._locations}get locationInfo(){return this._locationInfo}setUniforms(t){this._uniforms=t}cleanupTemporaryTextures(){for(let t of this._temporaryTextures)t.dispose();this._temporaryTextures=[]}bind(t){let e=this._uniforms;if(!this._program){let e=new Map;for(let[t,r]of this._locations)e.set(t,r);let r=[];for(let t of this._transformFeedbackBindings??[]){let{index:e,propertyKey:n}=t;r[e]=`v_${n}`}this._program=new s.$(t,this.vertexShader,this.fragmentShader,e,new Map,r)}let r=this._program;for(let n of(t.useProgram(r),this._uniformBindings)){let{shaderModulePath:i,uniformName:s,uniformType:a,uniformArrayLength:c}=n,d=(0,o.hS)(i,e);if(null==d){if("sampler2D"===a)continue;throw Error(`Failed to find uniform value for ${i}`)}switch("array"===a?n.uniformArrayElementType:a){case"sampler2D":{let{unit:e,texture:n}=d;if(r.setUniform1i(s,e),"type"in n)t.bindTexture(n,e);else{let r=(0,u.cU)(t,n.descriptor,n.data);t.bindTexture(r,e)}break}case"int":if(!c){r.setUniform1i(s,d);break}l(n.uniformName,d,c),r.setUniform1iv(s,d);break;case"float":if(!c){r.setUniform1f(s,d);break}l(n.uniformName,d,c),r.setUniform1fv(s,d);break;case"vec2":if(!c){r.setUniform2f(s,d[0],d[1]);break}l(n.uniformName,d,c),r.setUniform2fv(s,d.flat());break;case"vec3":if(!c){r.setUniform3f(s,d[0],d[1],d[2]);break}l(n.uniformName,d,c),r.setUniform3fv(s,d.flat());break;case"vec4":if(!c){r.setUniform4f(s,d[0],d[1],d[2],d[3]);break}l(n.uniformName,d,c),r.setUniform4fv(s,d.flat());break;case"mat3":r.setUniformMatrix3fv(s,d.flat());break;case"mat4":r.setUniformMatrix4fv(s,d.flat());break;default:throw Error(`Unable to set uniform for type ${a}`)}}}}},44973:function(t,e,r){r.d(e,{x:function(){return d}});var n=r(86641),i=r(94761),o=r(37180),s=r(9465),u=r(20128),a=r(89312);r(65223),r(3457);var l=r(64186),c=r(66789);let d=class extends i.Z{constructor(t){super(t),this.debugName="",this._updatingHandles=new c.R,this._idToUpdatingState=new s.Z}get updating(){let t=this._updatingHandles.updating||Array.from(this._idToUpdatingState.values()).some(t=>t);if((0,o.Z)("esri-2d-log-updating")){let e=Array.from(this._idToUpdatingState.entries()).map(([t,e])=>`-> ${t}: ${e}`).join("\n");console.log(`${this.debugName}: Updating: ${t}
-> Handles: ${this._updatingHandles.updating}
${e}`)}return t}addUpdateTracking(t,e){let r=(0,u.YP)(()=>e.updating,e=>this._idToUpdatingState.set(t,e),{sync:!0});this.addHandles(r)}addPromise(t){return this._updatingHandles.addPromise(t)}};(0,n._)([(0,a.Cb)({constructOnly:!0})],d.prototype,"debugName",void 0),(0,n._)([(0,a.Cb)({readOnly:!0})],d.prototype,"updating",null),d=(0,n._)([(0,l.j)("esri.views.2d.layers.support.UpdateTracking2D")],d)},20002:function(t,e,r){var n,i;r.d(e,{P:function(){return n}}),(i=n||(n={}))[i.Pass=0]="Pass",i[i.Draw=1]="Draw"},26158:function(t,e,r){r.d(e,{hu:function(){return i},yK:function(){return o}}),r(24168),r(91870),(0,r(40465).Ue)();class n{constructor(t){this.message=t}toString(){return`AssertException: ${this.message}`}}function i(t,e){if(!t){let t=Error(e=e||"Assertion").stack;throw new n(`${e} at ${t}`)}}function o(t,e,r,n){let i,o=(r[0]-t[0])/e[0],s=(n[0]-t[0])/e[0];o>s&&(i=o,o=s,s=i);let u=(r[1]-t[1])/e[1],a=(n[1]-t[1])/e[1];if(u>a&&(i=u,u=a,a=i),o>a||u>s)return!1;u>o&&(o=u),a<s&&(s=a);let l=(r[2]-t[2])/e[2],c=(n[2]-t[2])/e[2];return l>c&&(i=l,l=c,c=i),!(o>c||l>s)&&(c<s&&(s=c),!(s<0))}}}]);