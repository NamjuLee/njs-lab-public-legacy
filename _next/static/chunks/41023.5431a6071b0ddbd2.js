"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[41023],{41023:function(e,a,r){r.r(a),r.d(a,{fromUrl:function(){return d}});var t=r(94605),n=r(72659),l=r(96922),i=r(9744),s=r(3770),o=r(24243),u=r(27761),y=r(62709);let c={FeatureLayer:!0,SceneLayer:!0};async function d(e){let{properties:a,url:t}=e,n={...a,url:t},l=await h(t,a?.customParameters),{Constructor:i,layerId:s,sourceJSON:o,parsedUrl:u,layers:y,tables:c}=l;if(y.length+c.length===0)return null!=s&&(n.layerId=s),null!=o&&(n.sourceJSON=o),new i(n);let d=new(await Promise.all([r.e(55894),r.e(7786)]).then(r.bind(r,7786))).default({title:u.title});return await w(d,l,n),d}function f(e,a){return e?e.find(({id:e})=>e===a):null}function m(e,a,r,t,n){let l={...n,layerId:a};return null!=e&&(l.url=e),null!=r&&(l.sourceJSON=r),"sublayerTitleMode"in t.prototype&&(l.sublayerTitleMode="service-name"),new t(l)}async function w(e,a,r){let t=a.sublayerConstructorProvider;for(let{id:n,serverUrl:l}of a.layers){let i=f(a.sublayerInfos,n),s=m(l,n,i,(i&&t?.(i))??a.Constructor,r);e.add(s)}if(a.tables.length){let t=await L("FeatureLayer");a.tables.forEach(({id:n,serverUrl:l})=>{let i=m(l,n,f(a.tableInfos,n),t,r);e.tables.add(i)})}}async function h(e,a){let r,n=(0,l.Qc)(e);if(null==n&&(n=await p(e,a)),null==n)throw new t.Z("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:e});let{serverType:i,sublayer:u}=n,d="FeatureServer"===i,f="SceneServer"===i,m={parsedUrl:n,Constructor:null,layerId:d||f?u??void 0:void 0,layers:[],tables:[]};switch(i){case"MapServer":if(null!=u){let{type:n}=await (0,y.T)(e,{customParameters:a});switch(r="FeatureLayer",n){case"Catalog Layer":r="CatalogLayer";break;case"Catalog Dynamic Group Layer":throw new t.Z("arcgis-layers:unsupported",`fromUrl() not supported for "${n}" layers`)}}else r=await P(e,a)?"TileLayer":"MapImageLayer";break;case"ImageServer":{let{tileInfo:t,cacheType:n}=await (0,y.T)(e,{customParameters:a});r=t?"LERC"!==t?.format?.toUpperCase()||n&&"elevation"!==n.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer";break}case"SceneServer":{let e=await (0,y.T)(n.url.path,{customParameters:a});if(r="SceneLayer",e){let a=e?.layers;if("Voxel"===e?.layerType)r="VoxelLayer";else if(a?.length){let e=a[0]?.layerType;null!=e&&null!=o.fb[e]&&(r=o.fb[e])}}break}case"3DTilesServer":throw new t.Z("arcgis-layers:unsupported","fromUrl() not supported for 3DTiles layers");case"FeatureServer":if(r="FeatureLayer",null!=u){let t=await (0,y.T)(e,{customParameters:a});m.sourceJSON=t,r=(0,s.W)(t.type)}break;default:r=({FeatureServer:"FeatureLayer",KnowledgeGraphServer:"KnowledgeGraphLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer",VideoServer:"VideoLayer"})[i]}if(c[r]&&null==u){let t=await v(e,i,a);if(d&&(m.sublayerInfos=t.layerInfos,m.tableInfos=t.tableInfos),1!==t.layers.length+t.tables.length)m.layers=t.layers,m.tables=t.tables,d&&t.layerInfos?.length&&(m.sublayerConstructorProvider=await g(t.layerInfos));else if(d||f){let e=t.layerInfos?.[0]??t.tableInfos?.[0];if(m.layerId=t.layers[0]?.id??t.tables[0]?.id,m.sourceJSON=e,d){let a=e?.type;r=(0,s.W)(a)}}}return m.Constructor=await L(r),m}async function p(e,a){let r=await (0,y.T)(e,{customParameters:a}),t=null,i=null,s=r.type;if("Feature Layer"===s||"Table"===s?(t="FeatureServer",i=r.id??null):"indexedVector"===s?t="VectorTileServer":r.hasOwnProperty("mapName")?t="MapServer":r.hasOwnProperty("bandCount")&&r.hasOwnProperty("pixelSizeX")?t="ImageServer":r.hasOwnProperty("maxRecordCount")&&r.hasOwnProperty("allowGeometryUpdates")?t="FeatureServer":r.hasOwnProperty("streamUrls")?t="StreamServer":b(r)?(t="SceneServer",i=r.id):r.hasOwnProperty("layers")&&b(r.layers?.[0])&&(t="SceneServer"),!t)return null;let o=null!=i?(0,l.DR)(e):null;return{title:null!=o&&r.name||(0,n.vt)(e),serverType:t,sublayer:i,url:{path:null!=o?o.serviceUrl:(0,n.mN)(e).path}}}function b(e){return null!=e&&e.hasOwnProperty("store")&&e.hasOwnProperty("id")&&"number"==typeof e.id}async function v(e,a,r){let t,n,l=!1;switch(a){case"FeatureServer":{let a=await (0,s.V)(e,{customParameters:r});l=!!a.layersJSON,t=a.layersJSON||a.serviceJSON;break}case"SceneServer":{let a=await S(e,r);t=a.serviceInfo,n=a.tableServerUrl;break}default:t=await (0,y.T)(e,{customParameters:r})}let i=t?.layers,o=t?.tables;return{layers:i?.map(e=>({id:e.id})).reverse()||[],tables:o?.map(e=>({serverUrl:n,id:e.id})).reverse()||[],layerInfos:l?i:[],tableInfos:l?o:[]}}async function S(e,a){let r=await (0,y.T)(e,{customParameters:a});if(!r.layers?.[0])return{serviceInfo:r};try{let{serverUrl:t}=await (0,i.w)(e),n=await (0,y.T)(t,{customParameters:a}).catch(()=>null);return n&&(r.tables=n.tables),{serviceInfo:r,tableServerUrl:t}}catch{return{serviceInfo:r}}}async function L(e){return(0,u.T[e])()}async function P(e,a){return(await (0,y.T)(e,{customParameters:a})).tileInfo}async function g(e){if(!e.length)return;let a=new Set,r=[];for(let{type:t}of e)a.has(t)||(a.add(t),r.push(L((0,s.W)(t))));let t=await Promise.all(r),n=new Map;return Array.from(a).forEach((e,a)=>{n.set(e,t[a])}),e=>n.get(e.type)}},9744:function(e,a,r){r.d(a,{w:function(){return y}});var t=r(94596),n=r(54748),l=r(94605),i=r(31124),s=r(96922),o=r(81449),u=r(20550);async function y(e,a){let r=(0,s.Qc)(e);if(!r)throw new l.Z("invalid-url","Invalid scene service url");let t={...a,sceneServerUrl:r.url.path,layerId:r.sublayer??void 0};if(t.sceneLayerItem??=await c(t),null==t.sceneLayerItem)return m(t.sceneServerUrl.replace("/SceneServer","/FeatureServer"),t);let n=await w(t);if(!n?.url)throw new l.Z("related-service-not-found","Could not find feature service through portal item relationship");t.featureServiceItem=n;let i=await m(n.url,t);return i.portalItem=n,i}async function c(e){let a=(await d(e)).serviceItemId;if(!a)return null;let r=new u.default({id:a,apiKey:e.apiKey}),t=await f(e);null!=t&&(r.portal=new o.Z({url:t}));try{return r.load({signal:e.signal})}catch(e){return(0,i.r9)(e),null}}async function d(e){if(e.rootDocument)return e.rootDocument;let a={query:{f:"json",...e.customParameters,token:e.apiKey},responseType:"json",signal:e.signal};try{let r=await (0,n.Z)(e.sceneServerUrl,a);e.rootDocument=r.data}catch{e.rootDocument={}}return e.rootDocument}async function f(e){let a=t.id?.findServerInfo(e.sceneServerUrl);if(a?.owningSystemUrl)return a.owningSystemUrl;let r=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{let a=(await (0,n.Z)(r,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(a)return a}catch(e){(0,i.r9)(e)}return null}async function m(e,a){let r=(0,s.Qc)(e);if(!r)throw new l.Z("invalid-feature-service-url","Invalid feature service url");let t=r.url.path,i=a.layerId;if(null==i)return{serverUrl:t};let o=d(a),u=a.featureServiceItem?await a.featureServiceItem.fetchData("json"):null,y=(u?.layers?.[0]||u?.tables?.[0])?.customParameters,c=e=>{let r={query:{f:"json",...y},responseType:"json",authMode:e,signal:a.signal};return(0,n.Z)(t,r)},f=c("anonymous").catch(()=>c("no-prompt")),[m,w]=await Promise.all([f,o]),h=w?.layers,p=m.data&&m.data.layers;if(!Array.isArray(p))throw Error("expected layers array");if(Array.isArray(h)){for(let e=0;e<Math.min(h.length,p.length);e++)if(h[e].id===i)return{serverUrl:t,layerId:p[e].id}}else if(null!=i&&i<p.length)return{serverUrl:t,layerId:p[i].id};throw Error("could not find matching associated sublayer")}async function w({sceneLayerItem:e,signal:a}){if(!e)return null;try{let r=(await e.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:a})).find(e=>"Feature Service"===e.type)||null;if(!r)return null;let t=new u.default({portal:r.portal,id:r.id});return await t.load(),t}catch(e){return(0,i.r9)(e),null}}},3770:function(e,a,r){r.d(a,{V:function(){return l},W:function(){return d}});var t=r(62709);let n=new Set(["Catalog Layer","Feature Layer","Oriented Imagery Layer"]);async function l(e,a){let{loadContext:r,...n}=a||{},l=r?await r.fetchServiceMetadata(e,n):await (0,t.T)(e,n);c(l),o(l);let i={serviceJSON:l};if((l.currentVersion??0)<10.5)return i;let s=`${e}/layers`,u=r?await r.fetchServiceMetadata(s,n):await (0,t.T)(s,n);return c(u),o(u),i.layersJSON={layers:u.layers,tables:u.tables},i}function i(e){let{type:a}=e;return!!a&&n.has(a)}function s(e){return"Table"===e.type}function o(e){e.layers=e.layers?.filter(i),e.tables=e.tables?.filter(s)}function u(e){e.type||="Feature Layer"}function y(e){e.type||="Table"}function c(e){e.layers?.forEach(u),e.tables?.forEach(y)}function d(e){switch(e){case"Feature Layer":case"Table":break;case"Oriented Imagery Layer":return"OrientedImageryLayer";case"Catalog Layer":return"CatalogLayer"}return"FeatureLayer"}},27761:function(e,a,r){r.d(a,{T:function(){return t}});let t={BingMapsLayer:async()=>(await Promise.all([r.e(55894),r.e(77957)]).then(r.bind(r,77957))).default,BuildingSceneLayer:async()=>(await Promise.all([r.e(31478),r.e(55894),r.e(5816),r.e(90071),r.e(80404),r.e(70202),r.e(56718),r.e(66072),r.e(60320),r.e(89446),r.e(56143),r.e(17329),r.e(3654),r.e(60008)]).then(r.bind(r,76822))).default,CSVLayer:async()=>(await Promise.all([r.e(31478),r.e(55894),r.e(5816),r.e(90071),r.e(80404),r.e(70202),r.e(56718),r.e(66072),r.e(60320),r.e(40344)]).then(r.bind(r,80261))).default,CatalogLayer:async()=>(await Promise.all([r.e(31478),r.e(55894),r.e(5816),r.e(90071),r.e(80404),r.e(70202),r.e(66072),r.e(15871),r.e(34907),r.e(3149),r.e(96087)]).then(r.bind(r,87941))).default,DimensionLayer:async()=>(await Promise.all([r.e(42972),r.e(32718)]).then(r.bind(r,32718))).default,ElevationLayer:async()=>(await Promise.all([r.e(80404),r.e(43364)]).then(r.bind(r,44746))).default,FeatureLayer:async()=>(await Promise.all([r.e(31478),r.e(55894),r.e(5816),r.e(90071),r.e(80404),r.e(70202),r.e(56718),r.e(66072),r.e(60320),r.e(5210)]).then(r.bind(r,60320))).default,GeoJSONLayer:async()=>(await Promise.all([r.e(31478),r.e(55894),r.e(5816),r.e(90071),r.e(70202),r.e(56718),r.e(79164)]).then(r.bind(r,80631))).default,GeoRSSLayer:async()=>(await Promise.all([r.e(55894),r.e(54757)]).then(r.bind(r,54757))).default,GroupLayer:async()=>(await Promise.all([r.e(55894),r.e(7786)]).then(r.bind(r,7786))).default,ImageryLayer:async()=>(await Promise.all([r.e(55894),r.e(5816),r.e(80404),r.e(15871),r.e(72151),r.e(57949),r.e(85460),r.e(13099),r.e(81624)]).then(r.bind(r,25190))).default,ImageryTileLayer:async()=>(await Promise.all([r.e(55894),r.e(5816),r.e(80404),r.e(72151),r.e(57949),r.e(85460),r.e(16177),r.e(13099),r.e(2731)]).then(r.bind(r,2731))).default,IntegratedMesh3DTilesLayer:async()=>(await Promise.all([r.e(80404),r.e(10528)]).then(r.bind(r,42110))).default,IntegratedMeshLayer:async()=>(await Promise.all([r.e(80404),r.e(56143),r.e(35340)]).then(r.bind(r,79556))).default,KMLLayer:async()=>(await Promise.all([r.e(55894),r.e(5816),r.e(90071),r.e(5982)]).then(r.bind(r,49128))).default,KnowledgeGraphLayer:async()=>(await Promise.all([r.e(31478),r.e(55894),r.e(5816),r.e(90071),r.e(80404),r.e(70202),r.e(15570),r.e(56718),r.e(11243),r.e(87400),r.e(25845),r.e(33362),r.e(26822),r.e(5871),r.e(57083)]).then(r.bind(r,57083))).default,LineOfSightLayer:async()=>(await Promise.all([r.e(42972),r.e(66519)]).then(r.bind(r,66519))).default,LinkChartLayer:async()=>(await Promise.all([r.e(31478),r.e(55894),r.e(5816),r.e(90071),r.e(70202),r.e(15570),r.e(56718),r.e(11243),r.e(87400),r.e(25845),r.e(33362),r.e(26822),r.e(5871),r.e(42455)]).then(r.bind(r,77415))).default,MapImageLayer:async()=>(await Promise.all([r.e(31478),r.e(55894),r.e(5816),r.e(90071),r.e(80404),r.e(70202),r.e(15871),r.e(34907),r.e(69928),r.e(73445)]).then(r.bind(r,73445))).default,MapNotesLayer:async()=>(await Promise.all([r.e(31478),r.e(55894),r.e(5816),r.e(90071),r.e(80404),r.e(70202),r.e(56718),r.e(66072),r.e(60320),r.e(97282)]).then(r.bind(r,13381))).default,MediaLayer:async()=>(await Promise.all([r.e(55894),r.e(84944)]).then(r.bind(r,84944))).default,OGCFeatureLayer:async()=>(await Promise.all([r.e(31478),r.e(55894),r.e(5816),r.e(90071),r.e(70202),r.e(56718),r.e(85069)]).then(r.bind(r,8625))).default,OpenStreetMapLayer:async()=>(await Promise.all([r.e(55894),r.e(57066),r.e(32619)]).then(r.bind(r,32619))).default,OrientedImageryLayer:async()=>(await Promise.all([r.e(31478),r.e(55894),r.e(5816),r.e(90071),r.e(80404),r.e(70202),r.e(56718),r.e(66072),r.e(60320),r.e(34862)]).then(r.bind(r,4600))).default,PointCloudLayer:async()=>(await Promise.all([r.e(80404),r.e(56143),r.e(51257)]).then(r.bind(r,18458))).default,RouteLayer:async()=>(await Promise.all([r.e(55894),r.e(5816),r.e(90071),r.e(93965),r.e(70258)]).then(r.bind(r,99927))).default,SceneLayer:async()=>(await Promise.all([r.e(31478),r.e(5816),r.e(90071),r.e(80404),r.e(70202),r.e(50359),r.e(89446),r.e(56143),r.e(17329),r.e(48816),r.e(3654),r.e(43684)]).then(r.bind(r,73224))).default,StreamLayer:async()=>(await Promise.all([r.e(31478),r.e(55894),r.e(5816),r.e(90071),r.e(80404),r.e(70202),r.e(56718),r.e(32182)]).then(r.bind(r,66036))).default,SubtypeGroupLayer:async()=>(await Promise.all([r.e(31478),r.e(55894),r.e(5816),r.e(90071),r.e(80404),r.e(70202),r.e(66072),r.e(73681)]).then(r.bind(r,75587))).default,TileLayer:async()=>(await Promise.all([r.e(31478),r.e(55894),r.e(5816),r.e(90071),r.e(80404),r.e(70202),r.e(15871),r.e(34907),r.e(69928),r.e(36945)]).then(r.bind(r,36945))).default,UnknownLayer:async()=>(await r.e(23524).then(r.bind(r,23524))).default,UnsupportedLayer:async()=>(await r.e(96338).then(r.bind(r,96338))).default,VectorTileLayer:async()=>(await Promise.all([r.e(55894),r.e(80404),r.e(78088),r.e(34377)]).then(r.bind(r,68889))).default,VideoLayer:async()=>(await Promise.all([r.e(10167),r.e(55894),r.e(97776),r.e(53550)]).then(r.bind(r,14346))).default,VoxelLayer:async()=>(await Promise.all([r.e(80404),r.e(56143),r.e(97040)]).then(r.bind(r,14232))).default,WFSLayer:async()=>(await Promise.all([r.e(31478),r.e(55894),r.e(5816),r.e(90071),r.e(70202),r.e(56718),r.e(25624)]).then(r.bind(r,93769))).default,WMSLayer:async()=>(await Promise.all([r.e(55894),r.e(17757)]).then(r.bind(r,17757))).default,WMTSLayer:async()=>(await Promise.all([r.e(55894),r.e(57066),r.e(25300)]).then(r.bind(r,25300))).default,WebTileLayer:async()=>(await Promise.all([r.e(55894),r.e(57066)]).then(r.bind(r,57066))).default}},62709:function(e,a,r){r.d(a,{T:function(){return n}});var t=r(54748);async function n(e,a){let{data:r}=await (0,t.Z)(e,{responseType:"json",query:{f:"json",...a?.customParameters,token:a?.apiKey}});return r}}}]);