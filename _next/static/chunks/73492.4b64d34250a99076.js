"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[73492],{46049:function(e,t,i){i.d(t,{h:function(){return s},z:function(){return r}});var n=i(81519);let r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],s=n.Ue(),a=n.Ue(),o=n.Ue(),u=n.Ue(),c=n.Ue();n.vc(u,t),n.aC(s,i[0]),n.gT(a,i[1]),n.QO(o,i[2]),n.xJ(c,r),n.Jp(e,s,c),n.Jp(e,a,e),n.Jp(e,o,e),n.Jp(e,u,e)},s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[2,2,4],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,1,0],s=n.Ue(),a=n.Ue(),o=n.Ue();return n.G3(a,2*Math.PI/5,e,.1,100),n.zB(s,t,i,r),n.Jp(o,a,s),{viewMatrix:s,projectionMatrix:a,viewProjectionMatrix:o,cameraOption:{eye:t,center:i,zoomMax:100,zoomSpeed:2}}}},73492:function(e,t,i){i.r(t),i.d(t,{Solution:function(){return f}});var n=i(81519),r=i(49644);let s=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST,n=e.createBuffer({size:t.byteLength,usage:i,mappedAtCreation:!0});return new Float32Array(n.getMappedRange()).set(t),n.unmap(),n};var a=i(46049);let o=function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0,0],s=Math.sin(t*Math.PI/180);return r.al(e*s*Math.cos(i*Math.PI/180)+n[0],e*Math.cos(t*Math.PI/180)+n[1],-e*s*Math.sin(i*Math.PI/180)+n[2])},u=function(){let e,t,i,n,r,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0,0];if(a<2||u<2)return;let h=[];for(let t=0;t<a;t++){let i=[];for(let n=0;n<u;n++)e=o(s,180*t/(a-1),360*n/(u-1),c),i.push(e);h.push(i)}let l=[],f=[];for(let e=0;e<a-1;e++)for(let a=0;a<u-1;a++)t=h[e][a],i=h[e+1][a],n=h[e+1][a+1],r=h[e][a+1],l.push([t[0],t[1],t[2],i[0],i[1],i[2],r[0],r[1],r[2],i[0],i[1],i[2],n[0],n[1],n[2],r[0],r[1],r[2]]),f.push([t[0]/s,t[1]/s,t[2]/s,i[0]/s,i[1]/s,i[2]/s,r[0]/s,r[1]/s,r[2]/s,i[0]/s,i[1]/s,i[2]/s,n[0]/s,n[1]/s,n[2]/s,r[0]/s,r[1]/s,r[2]/s]);return{vertexData:new Float32Array(l.flat()),normalData:new Float32Array(f.flat())}},c=e=>(e.color=void 0===e.color?"(1.0, 0.0, 0.0)":e.color,e.ambientIntensity=void 0===e.ambientIntensity?"0.2":e.ambientIntensity,e.diffuseIntensity=void 0===e.diffuseIntensity?"0.8":e.diffuseIntensity,e.specularIntensity=void 0===e.specularIntensity?"0.4":e.specularIntensity,e.shininess=void 0===e.shininess?"30.0":e.shininess,e.specularColor=void 0===e.specularColor?"(1.0, 1.0, 1.0)":e.specularColor,e.isPhong=void 0===e.isPhong?"0":e.isPhong,{vertex:"\n         struct Uniforms {\n             viewProjectionMatrix : mat4x4<f32>,\n             modelMatrix : mat4x4<f32>,               \n             normalMatrix : mat4x4<f32>,            \n         };\n         @binding(0) @group(0) var<uniform> uniforms : Uniforms;\n \n         struct Output {\n             @builtin(position) Position : vec4<f32>,\n             @location(0) vPosition : vec4<f32>,\n             @location(1) vNormal : vec4<f32>,\n         };\n \n         @vertex\n         fn main(@location(0) position: vec4<f32>, @location(1) normal: vec4<f32>) -> Output {    \n             var output: Output;            \n             let mPosition:vec4<f32> = uniforms.modelMatrix * position; \n             output.vPosition = mPosition;                  \n             output.vNormal =  uniforms.normalMatrix*normal;\n             output.Position = uniforms.viewProjectionMatrix * mPosition;               \n             return output;\n         }",fragment:"\n         struct Uniforms {\n             lightPosition : vec4<f32>,   \n             eyePosition : vec4<f32>,\n         };\n         @binding(1) @group(0) var<uniform> uniforms : Uniforms;\n \n         @fragment\n         fn main(@location(0) vPosition: vec4<f32>, @location(1) vNormal: vec4<f32>) -> @location(0) vec4<f32> {\n             let N:vec3<f32> = normalize(vNormal.xyz);                \n             let L:vec3<f32> = normalize(uniforms.lightPosition.xyz - vPosition.xyz);     \n             let V:vec3<f32> = normalize(uniforms.eyePosition.xyz - vPosition.xyz);          \n             let H:vec3<f32> = normalize(L + V);\n             let diffuse:f32 = ".concat(e.diffuseIntensity," * max(dot(N, L), 0.0);\n             var specular:f32;\n             var isp:i32 = ").concat(e.isPhong,";\n             if(isp === 1){\n                 specular = ").concat(e.specularIntensity," * pow(max(dot(V, reflect(-L, N)),0.0), ").concat(e.shininess,");\n             } else {\n                 specular = ").concat(e.specularIntensity," * pow(max(dot(N, H),0.0), ").concat(e.shininess,");\n             }               \n             let ambient:f32 = ").concat(e.ambientIntensity,";               \n             let finalColor:vec3<f32> = vec3<f32>").concat(e.color,"*(ambient + diffuse) + vec3<f32>").concat(e.specularColor,"*specular; \n             return vec4<f32>(finalColor, 1.0);\n         }")}),h=e=>({shader:c(e),vertex:u(1,20,20,[0,0,0])}),l=i(31859);class f{async initWebGPU(){if(!navigator.gpu)throw Error("Not Support WebGPU");let e=await navigator.gpu.requestAdapter({powerPreference:"high-performance"});if(!e)throw Error("No Adapter Found");let t=await e.requestDevice();this.ctx=this.canvas.getContext("webgpu");let i=navigator.gpu.getPreferredCanvasFormat?navigator.gpu.getPreferredCanvasFormat():this.ctx.getPreferredFormat(e);window.devicePixelRatio,this.canvas.width=this.divHost.clientWidth,this.canvas.height=this.divHost.clientHeight,this.ctx.configure({device:t,format:i,alphaMode:"opaque"}),this.size={width:this.canvas.width,height:this.canvas.height},this.device=t,this.format=i,this.camera=new v(this),this.initPipeline(this.device,this.format)}async initPipeline(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let i={color:"[1.0,0.0,0.0]"};i.color=void 0===i.color?"[1.0,0.0,0.0]":i.color,i.ambientIntensity=void 0===i.ambientIntensity?"0.2":i.ambientIntensity,i.diffuseIntensity=void 0===i.diffuseIntensity?"0.8":i.diffuseIntensity,i.specularIntensity=void 0===i.specularIntensity?"0.4":i.specularIntensity,i.shininess=void 0===i.shininess?"30.0":i.shininess,i.specularColor=void 0===i.specularColor?"[1.0, 1.0, 1.0]":i.specularColor;let n=h(i);this.vertexBuffer=s(e,n.vertex.vertexData),this.normalBuffer=s(e,n.vertex.normalData),this.numberOfVertices=n.vertex.vertexData.length/3;let r=n.shader;this.pipeline=e.createRenderPipeline({layout:"auto",vertex:{module:e.createShaderModule({code:r.vertex}),entryPoint:"main",buffers:[{arrayStride:12,attributes:[{shaderLocation:0,format:"float32x3",offset:0}]},{arrayStride:12,attributes:[{shaderLocation:1,format:"float32x3",offset:0}]}]},fragment:{module:e.createShaderModule({code:r.fragment}),entryPoint:"main",targets:[{format:this.format}]},primitive:{topology:"triangle-list"},depthStencil:{format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"}}),this.uniformBuffer=e.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.uniformBindGroup=e.createBindGroup({layout:this.pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.uniformBuffer,offset:0,size:64}}]});let a=new Float32Array(this.camera.vp.cameraOption.eye),o=e.createBuffer({size:192,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),u=e.createBuffer({size:32,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});e.queue.writeBuffer(o,0,this.camera.vp.viewProjectionMatrix),e.queue.writeBuffer(u,0,a),e.queue.writeBuffer(u,16,a),e.createBindGroup({layout:this.pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:o,offset:0,size:192}},{binding:1,resource:{buffer:u,offset:0,size:32}}]}),this.textureView=this.ctx.getCurrentTexture().createView(),this.renderPassDescription={colorAttachments:[{view:this.textureView,clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]},this.requestAni=requestAnimationFrame(this.loop)}drawing(){this.camera.update();let e=this.device.createBuffer({size:192,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});this.device.createBuffer({size:32,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),n.U_(this.camera.normalMatrix,this.camera.modelMatrix),n.p4(this.camera.normalMatrix,this.camera.normalMatrix),this.device.queue.writeBuffer(e,64,this.camera.modelMatrix),this.device.queue.writeBuffer(e,128,this.camera.normalMatrix),this.textureView=this.ctx.getCurrentTexture().createView(),this.renderPassDescription.colorAttachments[0].view=this.textureView;let t=this.device.createCommandEncoder(),i=t.beginRenderPass(this.renderPassDescription);i.setPipeline(this.pipeline),i.setVertexBuffer(0,this.vertexBuffer),i.setVertexBuffer(1,this.normalBuffer),i.setBindGroup(0,this.uniformBindGroup),i.draw(this.numberOfVertices),i.end(),this.device.queue.submit([t.finish()])}destroy(){for(this.device.destroy(),cancelAnimationFrame(this.requestAni);this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}constructor(e){this.isAnimation=!0,this.rotation=r.al(0,0,0),this.loop=()=>{this.isAnimation?(this.rotation[0]+=.01,this.rotation[1]+=.01,this.rotation[2]+=.01):this.rotation=[0,0,0],this.drawing(),this.isAnimation&&(this.requestAni=requestAnimationFrame(this.loop))},this.divHost=document.getElementById(e),this.canvas=document.createElement("canvas"),this.divHost.appendChild(this.canvas),this.initWebGPU()}}class v{update(){let e=this.vp.projectionMatrix;this.vMatrix=this.camera.matrix,n.Jp(this.vpMatrix,e,this.vMatrix),(0,a.z)(this.modelMatrix,this.translation,this.rotation),n.Jp(this.mvpMatrix,this.vpMatrix,this.modelMatrix)}constructor(e){this.rotation=r.al(0,0,0),this.translation=r.al(0,0,0),this.solution=e,this.canvas=e.canvas,this.normalMatrix=n.Ue(),this.modelMatrix=n.Ue(),this.mvpMatrix=n.Ue(),this.vMatrix=n.Ue(),this.vpMatrix=n.Ue(),this.vp=(0,a.h)(this.canvas.width/this.canvas.height),this.vpMatrix=this.vp.viewProjectionMatrix,this.camera=l(this.canvas,this.vp.cameraOption)}}}}]);