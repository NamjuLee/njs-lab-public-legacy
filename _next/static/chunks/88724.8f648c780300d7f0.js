"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[88724],{88724:function(t,i,e){e.r(i),e.d(i,{Demo60ImageProcessor:function(){return R},Solution:function(){return T}}),e(74087);var s,h,o,n,r=e(8483);(s=o||(o={})).NORMAL="NORMAL",s.GAUSSIAN_BLUR_1="GAUSSIAN_BLUR_1",s.GAUSSIAN_BLUR_2="GAUSSIAN_BLUR_2",s.GAUSSIAN_BLUR_3="GAUSSIAN_BLUR_3",s.BOX_BLUR="BOX_BLUR",s.TRIANGLE_BLUR="TRIANGLE_BLUR",s.EMBOSS="EMBOSS",s.UNSHARPEN="UNSHARPEN",s.SHARPENESS="SHARPENESS",s.SHARPEN="SHARPEN",s.EDGE_DETECTION_1="EDGE_DETECTION_1",s.EDGE_DETECTION_2="EDGE_DETECTION_2",s.EDGE_DETECTION_3="EDGE_DETECTION_3",s.EDGE_DETECTION_4="EDGE_DETECTION_4",s.EDGE_DETECTION_5="EDGE_DETECTION_5",s.EDGE_DETECTION_6="EDGE_DETECTION_6",s.SOBEL_HORIZONTAL="SOBEL_HORIZONTAL",s.SOBEL_VERTICAL="SOBEL_VERTICAL",s.PREVIT_HORIZONTAL="PREVIT_HORIZONTAL",s.PREVIT_VERTICAL="PREVIT_VERTICAL";let a={NORMAL:[0,0,0,0,1,0,0,0,0],GAUSSIAN_BLUR_1:[.045,.122,.045,.122,.332,.122,.045,.122,.045],GAUSSIAN_BLUR_2:[1,2,1,2,4,2,1,2,1],GAUSSIAN_BLUR_3:[0,1,0,1,1,1,0,1,0],BOX_BLUR:[.111,.111,.111,.111,.111,.111,.111,.111,.111],TRIANGLE_BLUR:[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625],EMBOSS:[-2,-1,0,-1,1,1,0,1,2],UNSHARPEN:[-1,-1,-1,-1,9,-1,-1,-1,-1],SHARPENESS:[0,-1,0,-1,5,-1,0,-1,0],SHARPEN:[-1,-1,-1,-1,16,-1,-1,-1,-1],EDGE_DETECTION_1:[-.125,-.125,-.125,-.125,1,-.125,-.125,-.125,-.125],EDGE_DETECTION_2:[-1,-1,-1,-1,8,-1,-1,-1,-1],EDGE_DETECTION_3:[-5,0,0,0,0,0,0,0,5],EDGE_DETECTION_4:[-1,-1,-1,0,0,0,1,1,1],EDGE_DETECTION_5:[-1,-1,-1,2,2,2,-1,-1,-1],EDGE_DETECTION_6:[-5,-5,-5,-5,39,-5,-5,-5,-5],SOBEL_HORIZONTAL:[1,2,3,0,0,0,-1,-2,-1],SOBEL_VERTICAL:[1,0,-1,2,0,-2,1,0,-1],PREVIT_HORIZONTAL:[1,1,1,0,0,0,-1,-1,-1],PREVIT_VERTICAL:[1,0,-1,1,0,-1,1,0,-1]};class l{InitGridNeighbor(){for(let t=0;t<this.height;++t)for(let i=0;i<this.width;++i){let e=t*this.width+i,s=this.pixels[e];i>0&&t<this.height-1&&(s.npix.push(this.pixels[e+this.width-1]),s.UP_LEFT=this.pixels[e+this.width-1]),t<this.height-1&&(s.npix.push(this.pixels[e+this.width]),s.UP_MIDDLE=this.pixels[e+this.width]),i<this.width-1&&t<this.height-1&&(s.npix.push(this.pixels[e+this.width+1]),s.UP_RIGHT=this.pixels[e+this.width+1]),i>0&&(s.npix.push(this.pixels[e-1]),s.MIDDLE_LEFT=this.pixels[e-1]),i<this.width-1&&(s.npix.push(this.pixels[e+1]),s.MIDDLE_RIGHT=this.pixels[e+1]),i>0&&t>0&&(s.npix.push(this.pixels[e-this.width-1]),s.DOWN_LEFT=this.pixels[e-this.width-1]),t>0&&(s.npix.push(this.pixels[e-this.width]),s.DOWN_MIDDLE=this.pixels[e-this.width]),i<this.width-1&&t>0&&(s.npix.push(this.pixels[e-this.width+1]),s.DOWN_RIGHT=this.pixels[e-this.width+1])}}update(t){this.bitmap=t;let i=0;for(let t=0;t<this.bitmap.data.length;t+=4)this.pixels[i].color.R=this.bitmap.data[t+0],this.pixels[i].color.G=this.bitmap.data[t+1],this.pixels[i].color.B=this.bitmap.data[t+2],this.pixels[i].color.A=this.bitmap.data[t+3],i++}computeConvolution(t){for(let i of this.pixels)i.ComputeByKernelList(t)}getBitmap(){this.bitmapResult=new ImageData(this.bitmap.width,this.bitmap.height);let t=0;for(let i=0;i<this.bitmapResult.data.length;i+=4){let e=this.pixels[t].colNew;this.bitmapResult.data[i+0]=e.R,this.bitmapResult.data[i+1]=e.G,this.bitmapResult.data[i+2]=e.B,this.bitmapResult.data[i+3]=e.A,t++}return this.bitmapResult}constructor(t,i=!1){this.height=-1,this.width=-1,this.isGray=!1,this.isGray=i,this.bitmap=t,this.pixels=[],this.height=t.height,this.width=t.width;let e=0,s=-1,h=0;if(this.isGray)for(let t=0;t<this.bitmap.data.length;t+=4){h++%this.bitmap.width==0?(e=0,s++):e++;let i=new E(this.bitmap.data[t+0],this.bitmap.data[t+1],this.bitmap.data[t+2],this.bitmap.data[t+3]),o=r.mK.RGBtoGray(i.R,i.G,i.B),n=E.FromArgb(255,Math.floor(o),Math.floor(o),Math.floor(o)),a=new c(this,e,this.height-s-1,n);this.pixels.push(a)}else for(let t=0;t<this.bitmap.data.length;t+=4){t%this.bitmap.width==0?(e=0,s++):e++;let i=new E(this.bitmap.data[t+0],this.bitmap.data[t+1],this.bitmap.data[t+2],this.bitmap.data[t+3]),h=new c(this,e,this.height-s-1,i);this.pixels.push(h)}this.InitGridNeighbor()}}class c{ComputeByKernelList(t){let i=0,e=0,s=0,h=0;void 0!==this.UP_LEFT&&(e+=this.UP_LEFT.color.R*t[0],s+=this.UP_LEFT.color.G*t[0],h+=this.UP_LEFT.color.B*t[0],i+=t[0]),void 0!==this.UP_MIDDLE&&(e+=this.UP_MIDDLE.color.R*t[1],s+=this.UP_MIDDLE.color.G*t[1],h+=this.UP_MIDDLE.color.B*t[1],i+=t[1]),void 0!==this.UP_RIGHT&&(e+=this.UP_RIGHT.color.R*t[2],s+=this.UP_RIGHT.color.G*t[2],h+=this.UP_RIGHT.color.B*t[2],i+=t[2]),void 0!==this.MIDDLE_LEFT&&(e+=this.MIDDLE_LEFT.color.R*t[3],s+=this.MIDDLE_LEFT.color.G*t[3],h+=this.MIDDLE_LEFT.color.B*t[3],i+=t[3]),e+=this.color.R*t[4],s+=this.color.G*t[4],h+=this.color.B*t[4],i+=t[4],void 0!==this.MIDDLE_RIGHT&&(e+=this.MIDDLE_RIGHT.color.R*t[5],s+=this.MIDDLE_RIGHT.color.G*t[5],h+=this.MIDDLE_RIGHT.color.B*t[5],i+=t[5]),void 0!==this.DOWN_LEFT&&(e+=this.DOWN_LEFT.color.R*t[6],s+=this.DOWN_LEFT.color.G*t[6],h+=this.DOWN_LEFT.color.B*t[6],i+=t[6]),void 0!==this.DOWN_MIDDLE&&(e+=this.DOWN_MIDDLE.color.R*t[7],s+=this.DOWN_MIDDLE.color.G*t[7],h+=this.DOWN_MIDDLE.color.B*t[7],i+=t[7]),void 0!==this.DOWN_RIGHT&&(e+=this.DOWN_RIGHT.color.R*t[8],s+=this.DOWN_RIGHT.color.G*t[8],h+=this.DOWN_RIGHT.color.B*t[8],i+=t[8]),i<=0&&(i=1),this.colNew=E.FromArgb(255,this.CutColorValue(e/i),this.CutColorValue(s/i),this.CutColorValue(h/i))}ComputeKernelWeight(t){let i=0;for(let e of t)i+=e;return i<=0?1:i}CutColorValue(t){return t<0?0:255<t?255:Math.floor(t)}constructor(t,i,e,s){this.width=.5,this.height=.5,this.temp=0,this.val=0,this.npix=[],this.pm=t,this.color=E.FromArgb(255,s.R,s.G,s.B),this.colNew=E.FromArgb(255,s.R,s.G,s.B),this.p=new r.h9(i,e,0)}}class E{static FromArgb(t,i,e,s){return new E(i,e,s,t)}constructor(t,i,e,s){this.R=t,this.G=i,this.B=e,this.A=s}}class d{Init(){let t=document.createElement("canvas");if(t){this.canvas=t,this.canvas.width=this.div.clientWidth,this.canvas.height=this.div.clientHeight,this.div.append(this.canvas);let i=this.canvas.getContext("2d");i&&(this.ctx=i,this.isActive=!0)}this.deltaTime=new r.gk,this.canvasLoopController=new r.NI(60)}LoopInit(){this.translation[0]=.5*this.ctx.canvas.width,this.translation[1]=.5*this.ctx.canvas.height,this.SetLevel4(),this.initBinder(this.ctx),this.Loop()}Loop(){let t=performance.now();if(this.deltaTime.UpdateFPS(),this.canvasLoopController.level>3){if(6===this.canvasLoopController.level)requestAnimationFrame(()=>{this.Loop()}),this.RenderPre(this.ctx);else if(5===this.canvasLoopController.level)this.isViewChanging,requestAnimationFrame(()=>{this.Loop()}),this.RenderPre(this.ctx);else if(4===this.canvasLoopController.level){if(this.isViewChanging,requestAnimationFrame(()=>{this.Loop()}),this.canvasLoopController.stop)return;this.RenderPre(this.ctx),this.canvasLoopController.TimerForStop()}}else 1===this.canvasLoopController.level&&this.isViewChanging||this.RenderPre(this.ctx);let i=performance.now();this.log="level:  ".concat(this.canvasLoopController.level,", total frames: ").concat(this.loopNum++," (FPS: ").concat(this.deltaTime.frameRate.toFixed(0),"), a loop took: ").concat((i-t).toFixed(2)," ms to execute.")}SetLevel1(){this.canvasLoopController.level=1,this.Loop()}SetLevel2(){this.canvasLoopController.level=2,this.Loop()}SetLevel3(){this.canvasLoopController.level=3,this.Loop()}RenderSetLevel4(){this.canvasLoopController.stop=!0}SetLevel4(){this.canvasLoopController.Reset(),setTimeout(()=>{this.canvasLoopController.level=4,this.Loop()},500)}SetLevel5(){this.canvasLoopController.Reset(),setTimeout(()=>{this.canvasLoopController.level=5,this.Loop()},500)}SetLevel6(){this.canvasLoopController.stop=!1,this.canvasLoopController.Reset(),setTimeout(()=>{this.canvasLoopController.level=6,this.Loop()},500)}Clear(t){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}Zoom(t){t.wheel<0?this.scale+=.09*this.scale:this.scale-=.09*this.scale}RemapByZoom(t){return t.x=(t.xs-this.translation[0])/this.scale,t.y=(t.ys-this.translation[1])/this.scale,t}Pan(t){if(!this.ablePan)return;let i=t.xs-t.preXs,e=t.ys-t.preYs;this.translation[0]+=i,this.translation[1]+=e}RenderForce(){this.canvasLoopController.stop=!1}RenderPre(t){if(this.isActive){this.Clear(this.ctx),this.ctx.save(),this.ctx.translate(this.translation[0],this.translation[1]),this.ctx.scale(this.scale,this.scale);for(let i=-10;i<10;++i)for(let e=-10;e<10;++e)t.beginPath(),t.fillStyle="rgba(255, 0, 0, 0.9)",t.arc(10*i,10*e,2,0,2*Math.PI),t.closePath(),t.fill();this.RenderBinder(t),this.ctx.restore()}}initBinder(t){}RenderBinder(t){}constructor(t,i){this.isActive=!1,this.scale=.5,this.translation=[0,0],this.translationZoom=[0,0],this.isViewChanging=!1,this.loopNum=0,this.needRenderloop=!0,this.ablePan=!0,this.pause=!1,this.renderer=t,this.div=i,this.Init()}}(h=n||(n={})).LEFT="LEFT",h.MIDDLE="MIDDLE",h.RIGHT="RIGHT",h.WHEEL="WHEEL",h.DRAG="DRAG",h.DRAG_LEFT="DRAG_LEFT",h.DRAG_MIDDLE="DRAG_MIDDLE",h.DRAG_RIGHT="DRAG_RIGHT",h.MOVE="MOVE",h.DOUBLE="DOUBLE",h.UP="UP",h.DOWN="DOWN",h.DOWN_MIDDLE="DOWN_MIDDLE",h.DOWN_RIGHT="DOWN_RIGHT";class p{DeepCopy(){let t=new p;return t.x=this.x,t.y=this.y,t.z=this.z,t.preX=this.preX,t.preY=this.preY,t.preZ=this.preZ,t.xs=this.x,t.ys=this.y,t.preXs=this.preXs,t.preYs=this.preYs,t.pressedAlt=this.pressedAlt,t.pressedShift=this.pressedShift,t.pressedCtrl=this.pressedCtrl,t.isDoubleClick=this.isDoubleClick,t.isDown=this.isDown,t.isMove=this.isMove,t.wheel=this.wheel,t.preWheel=this.preWheel,t.yGLPicking=this.yGLPicking,t.CLICK_TYPE=this.CLICK_TYPE,t.command=this.command,t.native=this.native,t}constructor(){this.x=-1,this.y=-1,this.z=-1,this.preX=-1,this.preY=-1,this.preZ=-1,this.xs=-1,this.ys=-1,this.preXs=-1,this.preYs=-1,this.CLICK_TYPE="MOVE",this.isDown=!1,this.isDoubleClick=!1,this.isMove=!1,this.pressedShift=!1,this.pressedAlt=!1,this.pressedCtrl=!1,this.wheel=0,this.preWheel=0,this.isActive=!0}}class u{InitNativeMouseEvent(t){t.onclick=t=>{this.prevent=!1,this.timer=setTimeout(()=>{this.prevent||this.MouseClick(t),this.prevent=!1},this.delay)},t.ondblclick=t=>{clearTimeout(this.timer),this.prevent=!0,this.MouseDoubleClick(t)},t.onmousedown=t=>{this.MouseDown(t)},t.onmouseup=t=>{this.MouseUp(t)},t.onmousemove=t=>{this.MouseMove(t)},t.addEventListener("wheel",t=>this.MouseWheel(t,t.deltaY))}MouseDown(t){this.click=!0,this.down=!0;let i=this.CommonEventBuilder(t);i.CLICK_TYPE="DOWN",i.isDown=!0,this.MouseEvenEmitting(i)}MouseClick(t){if(!this.click)return;let i=this.CommonEventBuilder(t);0===t.button?i.CLICK_TYPE="LEFT":1===t.button?i.CLICK_TYPE="MIDDLE":2===t.button&&(i.CLICK_TYPE="RIGHT"),this.MouseEvenEmitting(i)}MouseDoubleClick(t){let i=this.CommonEventBuilder(t);i.CLICK_TYPE="DOUBLE",this.MouseEvenEmitting(i)}MouseDrag(t){this.click=!1,this.prevent=!0;let i=this.CommonEventBuilder(t);i.CLICK_TYPE="DRAG",i.isDown=!0,1===t.buttons?i.CLICK_TYPE="DRAG":4===t.buttons?i.CLICK_TYPE="DRAG_MIDDLE":2===t.buttons&&(i.CLICK_TYPE="DRAG_RIGHT"),this.MouseEvenEmitting(i)}MouseMove(t){if(this.down){this.MouseDrag(t);return}let i=this.CommonEventBuilder(t);i.CLICK_TYPE="MOVE",i.isDown=!0,this.prevent=!0,this.MouseEvenEmitting(i)}MouseUp(t){this.down=!1,this.click=!0;let i=this.CommonEventBuilder(t);i.CLICK_TYPE="UP",i.isDown=!1,this.MouseEvenEmitting(i)}MouseWheel(t,i){let e=this.CommonEventBuilder(t);e.wheel=i,e.CLICK_TYPE="WHEEL",this.MouseEvenEmitting(e)}CommonEventBuilder(t){let i=new p;return i.preXs=this.mouseEventDataPre.xs,i.preYs=this.mouseEventDataPre.ys,i.preX=this.mouseEventDataPre.x,i.preY=this.mouseEventDataPre.y,i.pressedShift=t.shiftKey,i.pressedAlt=t.altKey,i.pressedCtrl=t.ctrlKey,i.xs=t.offsetX,i.ys=t.offsetY,i.preWheel=this.mouseEventDataPre.wheel,i.wheel=0,i.native=t,this.mouseEventDataPre=i,this.e=i,i}get stopPropagation(){return this._stopPropagation}set stopPropagation(t){t?this._stopPropagation=t:setTimeout(()=>{this._stopPropagation=t},500)}MouseEvenEmitting(t){this.MouseEventEmittingForViewController(t),this._stopPropagation||this.MouseEventEmittingBinder(t)}MouseEventEmittingForViewController(t){this.mouseInteractionUI&&this.mouseInteractionUI.MouseInteractionMenu(t)}MouseEventEmittingBinder(t){}constructor(){this.mouseEventDataPre=new p,this.isEnable=!0,this.clickCount=0,this.click=!1,this.prevent=!1,this.delay=250,this.down=!1,this._stopPropagation=!1}}class m{MouseEventController(t){let i=t.DeepCopy();if(i.x=t.xs,i.y=t.ys,this.renderer.canvas.RenderForce(),t.CLICK_TYPE===r.uh.LEFT){this.MouseLeftClickPre(t);return}if(t.CLICK_TYPE===r.uh.MIDDLE){this.MouseMiddleClickPre(t);return}if(t.CLICK_TYPE===r.uh.DOWN_RIGHT){this.MouseRightClickPre(t);return}if(t.CLICK_TYPE===r.uh.DOUBLE){this.MouseDoubleClickPre(t);return}if(t.CLICK_TYPE===r.uh.MOVE){this.MouseMovePre(t);return}if(t.CLICK_TYPE===r.uh.DRAG){this.MouseDragPre(t);return}if(t.CLICK_TYPE===r.uh.DOWN){this.MouseDownPre(t);return}else if(t.CLICK_TYPE===r.uh.WHEEL){this.MouseWheelPre(t);return}else if(t.CLICK_TYPE===r.uh.UP){this.MouseUpPre(t);return}}MouseDown(t){}MouseDownPre(t){this.MouseDown(t)}MouseLeftClick(t){}MouseLeftClickPre(t){this.MouseLeftClick(t)}MouseMiddleClick(t){}MouseMiddleClickPre(t){this.MouseMiddleClick(t)}MouseRightClick(t){}MouseRightClickPre(t){this.MouseRightClick(t)}MouseUp(t){}MouseUpPre(t){this.MouseUp(t)}MouseDoubleClick(t){}MouseDoubleClickPre(t){this.MouseDoubleClick(t)}MouseMove(t){}MouseMovePre(t){this.MouseMove(t)}MouseDrag(t){}MouseDragPre(t){this.mouse.x=t.x,this.mouse.y=t.y,this.renderer.canvas.Pan(t),this.MouseDrag(t)}MouseWheel(t){}MouseWheelPre(t){this.renderer.canvas.Zoom(t),this.MouseWheel(t)}pushActionFromPulldown(t){t.split("@")[0]}constructor(t){this.mouse=new r.h9(0,0),this.renderer=t}}class v{initUI(){let t=document.createElement("div");if(!t)return;this.divUI=t,this.divLocalMain.append(t),this.divUI.style.marginLeft="10px",this.divUI.style.width="100%";let i=document.createElement("button");i.textContent="toggle",i.onclick=()=>{this.canvasRanderer.implmentation.toggle()},this.divUI.append(i);let e=document.createElement("input");e.oninput=()=>{let t=+e.value;console.log(t);let i=o.NORMAL;0===t?i=o.NORMAL:1===t?i=o.BOX_BLUR:2===t?i=o.EDGE_DETECTION_1:3===t?i=o.EDGE_DETECTION_2:4===t?i=o.EDGE_DETECTION_3:5===t?i=o.EDGE_DETECTION_4:6===t?i=o.EDGE_DETECTION_5:7===t?i=o.EDGE_DETECTION_6:8===t?i=o.EMBOSS:9===t?i=o.GAUSSIAN_BLUR_1:10===t?i=o.GAUSSIAN_BLUR_2:11===t?i=o.GAUSSIAN_BLUR_3:12===t?i=o.PREVIT_HORIZONTAL:13===t?i=o.PREVIT_VERTICAL:14===t?i=o.SHARPEN:15===t?i=o.SHARPENESS:16===t?i=o.SOBEL_HORIZONTAL:17===t?i=o.SOBEL_VERTICAL:18===t?i=o.TRIANGLE_BLUR:19===t&&(i=o.UNSHARPEN),this.divConsole.innerHTML="Convolutional filter: "+i,this.canvasRanderer.implmentation.setFilter(i)},e.type="range",e.min="0",e.max="19.0",e.step="1.0",e.value="0",this.divUI.append(e);let s=document.createElement("input");s.oninput=()=>{console.log(+s.value)},s.type="range",s.min="1",s.max="10.0",s.value="4",this.divUI.append(s),this.divConsole=document.createElement("p"),this.divConsole&&(this.divUI.append(this.divConsole),this.divConsole.style.width="max-content",this.divConsole.innerHTML="Convolutional filter: Normal")}constructor(t){this.canvasRanderer=t,this.divLocalMain=this.canvasRanderer.hostDiv,this.initUI()}}class D{setFilter(t){this.pixelMapFilter=new l(this.imgDataOrigin),this.pixelMapFilter.computeConvolution(a[t]);let i=this.pixelMapFilter.getBitmap();this.ctx.putImageData(i,0,0,0,0,this.img.width,this.img.height)}render(t){t.drawImage(this.canvas,-(.5*this.img.width),-(.5*this.img.height),this.img.width,this.img.height)}constructor(t,i){this.implmentation=t,this.img=i,this.canvas=document.createElement("canvas"),this.canvas.width=this.img.width,this.canvas.height=this.img.height,this.ctx=this.canvas.getContext("2d"),this.ctx.drawImage(this.img,0,0,this.img.width,this.img.height),this.imgDataOrigin=this.ctx.getImageData(0,0,this.img.width,this.img.height)}}class L{setFilter(t){this.kernel=a[t]}render(t){this.video&&(this.ctx.drawImage(this.video,0,0,this.video.width,this.video.height),this.pixelMapFilter.update(this.ctx.getImageData(0,0,this.video.width,this.video.height)),this.pixelMapFilter.computeConvolution(this.kernel),this.imgDataOrigin=this.pixelMapFilter.getBitmap(),this.ctx.putImageData(this.imgDataOrigin,0,0),t.drawImage(this.canvas,-(.5*this.video.width),-(.5*this.video.height),this.video.width,this.video.height))}constructor(t,i){this.width=200,this.height=200,this.kernel=a.NORMAL,this.implmentation=t,this.img=new Image,this.width=300,this.height=300,this.canvas=document.createElement("canvas"),this.canvas.width=300,this.canvas.height=300,this.ctx=this.canvas.getContext("2d");let e=document.createElement("video");e.id=this.implmentation.hostDiv.id+"camera",e.setAttribute("playsinline",""),e.setAttribute("autoplay",""),e.setAttribute("muted",""),e.setAttribute("width","".concat(300,"px")),e.setAttribute("height","".concat(300,"px")),e.style.width="".concat(300,"px"),e.style.height="".concat(300,"px"),navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then(t=>{e.srcObject=t}).catch(t=>{console.debug("something went wrong...",t)}),this.video=e,e&&i&&i.appendChild(e),this.pixelMapFilter=new l(this.ctx.getImageData(0,0,this.width,this.height))}}let I=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://raw.githubusercontent.com/NamjuLee/data/master/img/bg/zoom-James-River-Kayaking.jpg";return new Promise((i,e)=>{let s=new Image;s.src=t,s.crossOrigin="Anonymous",s.onload=()=>i(s),s.onerror=()=>e(Error("cannot loade the img by url..."))})};class C{async init(t){let i=await I();this.imageProcessor=new D(this,i),this.videoProcessor=new L(this,this.hostDiv)}toggle(){this.num++}setFilter(t){this.num%2==0?this.videoProcessor.setFilter(t):this.imageProcessor.setFilter(t)}render(t){this.num%2==0?this.videoProcessor&&this.videoProcessor.render(t):this.imageProcessor&&this.imageProcessor.render(t)}constructor(t){this.num=0,this.hostDiv=t}}class _{static Init(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SandBox";new _(t)}Init(){let t=document.getElementById(this.id);if(!t)return;this.hostDiv=t;let i=document.createElement("div");i&&(this.div=i,this.div.style.width="400px",this.div.style.height="300px",this.div.style.background="#dddddd",this.hostDiv.append(this.div)),this.implmentation=new C(this.hostDiv),this.canvas=new d(this,i),this.canvas.initBinder=t=>this.InitRender(t),this.canvas.RenderBinder=t=>this.Render(t),this.activeCommandController=new m(this),this.mouseInteraction=new u,this.InitEventListener(i),this.view=new v(this),this.canvas.LoopInit(),this.canvas.SetLevel6()}InitEventListener(t){this.mouseInteraction.InitNativeMouseEvent(t),this.mouseInteraction.MouseEventEmittingBinder=t=>{this.activeCommandController.MouseEventController(t)},window.addEventListener("resize",t=>{this.Resize(t,this.hostDiv.clientWidth,this.hostDiv.clientHeight)})}Resize(t,i,e){}InitRender(t){this.implmentation.init(t)}Render(t){this.implmentation.render(t)}constructor(t="SandBox"){this.id=t,this.Init(),window.app=this}}class g{static Init(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SandBox";new g(t,1)}Init(){1===this.version&&(this.renderer=new _(this.id))}constructor(t="SandBox",i=1){this.version=1,this.id=t,this.version=i,this.Init()}}class R{static Init(t){new R(t).Dummy()}Dummy(){}constructor(t="SandBox"){new g(t)}}class T{destroy(){if(this.divHost)try{for(;this.divHost.firstChild;)this.divHost.removeChild(this.divHost.firstChild)}catch(t){console.error("Error in destroy method:",t)}else console.warn("divHost is undefined in destroy method")}constructor(t){this.divHost=document.getElementById(t),R.Init(t)}}}}]);