(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[84511,91941],{15510:function(t){function e(t){return Promise.resolve().then(function(){var e=Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}e.keys=function(){return[]},e.resolve=e,e.id=15510,t.exports=e},75410:function(){},48628:function(){},31601:function(){},67792:function(){},34977:function(){},75042:function(){},47757:function(t,e,a){"use strict";a.r(e),a.d(e,{NFaceCam:function(){return c}});var i=a(88405),n=a(14962),l=a(71755),s=a(45169),o=a(30647);let h=0,d=[];class c{async init(t,e,a,i){await g(t,e,a,i,this.mobile,this.VIDEO_SIZE,this.imgSmaile,this.imgHairband,this.imgSunglass,this.renderMode)}initUI(){let t=document.createElement("input");t.type="range",t.min="0",t.max="467",t.step="1",t.value="0",t.style.width="300px",t.oninput=()=>{h=+t.value,a.textContent=t.value},this.host.append(t);let e=document.createElement("input");e.type="range",e.min="0",e.max="5",e.step="1",e.value="0",e.style.width="300px",e.oninput=()=>{u=+e.value},this.host.append(e);let a=document.createElement("div");a.textContent="0",this.host.append(a);let i=document.createElement("div");i.style.width="50px",i.style.height="50px",i.style.background="#000000",this.host.append(i),d.push(i),(i=document.createElement("div")).style.width="50px",i.style.height="50px",i.style.background="#000000",this.host.append(i),d.push(i),(i=document.createElement("div")).style.width="50px",i.style.height="50px",i.style.background="#000000",this.host.append(i),d.push(i)}constructor(t){this.mobile=!1,this.VIDEO_SIZE=400,this.renderMode=0,this.mobile=(0,o.isMobile)(),this.host=document.getElementById(t);let e=document.createElement("div");e.style.display="flex",this.host.append(e);let a=document.createElement("video");e.append(a),a.id="video";let i=document.createElement("canvas");e.append(i),i.width=this.VIDEO_SIZE,i.height=this.VIDEO_SIZE,i.id="canvas-out";let n=i.getContext("2d"),l=document.createElement("div");l.style.display="flex",this.host.append(l);let h=document.createElement("canvas");l.append(h);let d=h.getContext("2d"),c=document.createElement("div");c.style.width=this.VIDEO_SIZE+"px",c.style.height=this.VIDEO_SIZE+"px",l.append(c),(0,s.getImgFromURL)("https://raw.githubusercontent.com/NamjuLee/data/master/img/smile.png").then(t=>{t&&(this.imgSmaile=t,(0,s.getImgFromURL)("https://raw.githubusercontent.com/NamjuLee/data/master/img/hair%20band.png").then(t=>{t&&(this.imgHairband=t,(0,s.getImgFromURL)("https://raw.githubusercontent.com/NamjuLee/data/master/img/sunglass.png").then(t=>{t&&(this.imgSunglass=t,this.init(c,d,n,a))}))}))}),this.initUI()}}let r=!1,m=[[0,0],[0,0],[0,0]],g=async function(t,e,a,s,h,d,c,r,m){let g,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;console.log(i.setBackend),await i.setBackend("webgl"),g=new l.cq(t,{rotateOnStart:!1,selectEnabled:!1}),console.log(),await (0,o.setupCamera)(s,h,d),s.play(),s.width=s.videoWidth,s.height=s.videoHeight,e.canvas.width=s.videoWidth,e.canvas.height=s.videoHeight,e.canvas.style.width=s.videoWidth+"px",e.canvas.style.height=s.videoHeight+"px",e.fillStyle="#32EEDB",e.strokeStyle="rgba(0, 200, 200, 0.35)",e.lineWidth=.5;let f=await n.z({maxFaces:200});console.log(f),p(f,e,a,s,g,c,r,m,u)},u=0,p=async function(t,e,a,i,n,s,c,g){let v=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,y=await t.estimateFaces(i);if(y[0]&&(e.drawImage(i,0,0,i.videoWidth,i.videoHeight,0,0,e.canvas.width,e.canvas.height),a.drawImage(i,0,0,i.videoWidth,i.videoHeight,0,0,e.canvas.width,e.canvas.height),y.length>0&&(y.forEach(t=>{let i=t.scaledMesh,n=[50,280,8];for(let t=0;t<n.length;++t){let a=i[n[t]][0],l=i[n[t]][1],s=e.getImageData(a,l,1,1);d[t].style.background="rgba(".concat(s.data[0],", ").concat(s.data[1],", ").concat(s.data[2],", ").concat(s.data[3],")")}e.getImageData(0,0,1,1),e.beginPath(),e.arc(0,0,30,0,6.28),e.stroke();{for(let t=0;t<i.length;t++){let a=i[t][0],n=i[t][1];e.beginPath(),e.arc(a,n,1,0,2*Math.PI),e.fill(),e.strokeStyle="#000000",e.font="12px Arial",e.strokeText("".concat(t),a-10,n-2)}let t=[50,280,8];e.fillStyle="#ff0000";for(let a=0;a<t.length;++a){let n=i[t[a]][0],l=i[t[a]][1];e.beginPath(),e.arc(n,l,4,0,2*Math.PI),e.fill(),m[a][0]=n,m[a][1]=l}let a=i[h][0],n=i[h][1];e.beginPath(),e.arc(a,n,4,0,2*Math.PI),e.fill(),e.fillStyle="#32EEDB"}a.fillStyle="#ff0000";let l=i[159][0],r=i[145][1]+(i[159][1]-i[145][1])*.5;0===u&&(a.beginPath(),a.arc(l,r,10,0,2*Math.PI),a.fill());let p=i[386][0],v=i[374][1]+(i[386][1]-i[374][1])*.5;0===u&&(a.beginPath(),a.arc(p,v,10,0,2*Math.PI),a.fill());let y=i[13][0],I=i[13][1]+(i[14][1]-i[13][1])*.5;0===u&&(a.beginPath(),a.arc(y,I,10,0,2*Math.PI),a.fill());let E=f(l,r,p,v);a.save(),a.translate(y,I-(I-v)*.6),a.rotate(-E-.5*Math.PI),a.scale((p-l)/130,(r-I)/130),void 0!==s&&(1===u?a.drawImage(s,-150,-150):2===u?a.drawImage(c,-(.5*c.width),-250):3===u?a.drawImage(g,-(.5*g.width),-263):4===u&&(a.globalCompositeOperation="xor",a.filter="blur(".concat(10,"px)"),a.ellipse(0,0,150,150,0,0,2*Math.PI),a.fillStyle="#fff",a.fill(),a.filter="none",a.globalCompositeOperation="source-over")),a.lineWidth=2,a.strokeStyle="#0f0",a.beginPath(),a.rect(-150,-150,300,300),a.closePath(),0===u&&a.stroke(),a.beginPath(),a.arc(0,0,100,0,2*Math.PI),0===u&&a.stroke(),a.restore();for(let t=0;t<o.TRIANGULATION.length/3;t++){[o.TRIANGULATION[3*t],o.TRIANGULATION[3*t+1],o.TRIANGULATION[3*t+2]].map(t=>i[t]);let n=[50,280,8];e.fillStyle="#ff0000";for(let t=0;t<n.length;++t){let e=i[n[t]][0],l=i[n[t]][1];a.beginPath(),a.arc(e,l,4,0,2*Math.PI)}}}),void 0!==n))){let t=y.map(t=>t.scaledMesh.map(t=>[-t[0],-t[1],-t[2]])),e=[];for(let a=0;a<t.length;a++)e=e.concat(t[a]);let a=new l.cq.Dataset(e);r?n.updateDataset(a):n.render(a),r=!0}requestAnimationFrame(()=>p(t,e,a,i,n,s,c,g,v))},f=(t,e,a,i)=>Math.atan2(a-t,i-e)},95418:function(t,e,a){"use strict";a.r(e),a.d(e,{Solution:function(){return n}});var i=a(47757);a(53844);class n{destroy(){try{for(;this.divHost&&this.divHost.lastElementChild;){let t=this.divHost.lastElementChild;this.divHost.removeChild(t)}}catch(t){}}constructor(t){this.divHost=document.getElementById(t);let e=document.createElement("div");this.divHost.appendChild(e),e.id="container-video",e.style.alignItems="center",e.style.marginTop="80px",e.style.marginLeft="auto",e.style.marginRight="auto",e.style.width="50%",e.style.height="600px",new i.NFaceCam(e.id)}}}}]);