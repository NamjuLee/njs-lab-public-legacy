"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[16085,3955,99473],{3955:function(e,t,i){i.r(t),i.d(t,{DefinitionIndeCanvasCore:function(){return s}});var n=i(79309);class s{InitIndeCanvas(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:650,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:350;this.scene.implementation.app.needUI?this.indeCanvas=new n.D(this.scene.implementation.app.viewController.NUIWrapper.NUI.independentPanelWrapper,50,50,e,t,!0):this.indeCanvas=new n.D(this.scene.implementation.app.viewController.NUIWrapper.NUI.independentPanelWrapper,1,-25,e,t,!0),this.indeCanvas.title="TF Env",this.indeCanvas.btnHam.isHidden=!0,this.indeCanvas.btnMini.isHidden=!0,this.indeCanvas.RenderIndependentCanvas=e=>this.RenderIndependentCanvas(e)}get width(){return this.indeCanvas.canvas.width}get height(){return this.indeCanvas.canvas.height}Init(e){}RenderIndependentCanvas(e){}MouseMove(e,t){}MouseMovePre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseMove(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseDown(e,t){}MouseDownPre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseDown(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseUp(e,t){}MouseUpPre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseUp(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseDrag(e,t){}MouseDragPre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseDrag(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseLeftClick(e,t){}MouseLeftClickPre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseLeftClick(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseMiddleClick(e,t){}MouseMiddleClickPre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseMiddleClick(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseRightClick(e,t){}MouseRightClickPre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseRightClick(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseDoubleClick(e,t){}MouseDoubleClickPre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseDoubleClick(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseWheel(e,t,i){}MouseWheelPre(e,t,i){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseWheel(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY,i)}constructor(e,t=650,i=350){this.mOffX=-12,this.mOffY=-12,this.scene=e,this.scene.definitions.push(this),this.InitIndeCanvas(t,i)}}},16085:function(e,t,i){i.r(t),i.d(t,{TFModel01HorsepowerAndMilesPerGallon:function(){return o},convertToTensor:function(){return d},createModel:function(){return u}});var n=i(88405),s=i(1616),a=i(3955),h=i(99473),r=i(49738);class o extends a.DefinitionIndeCanvasCore{Init(){r.TFDataUtility.getData().then(e=>{this.train(e)})}async train(e){let t=d(e),{inputs:i,labels:a}=t,h=u();s.show.modelSummary({name:"Model Summary"},h),await l(h,i,a),function(e,t,i){let{inputMax:a,inputMin:h,labelMin:r,labelMax:o}=i,[l,u]=n.tidy(()=>{let t=n.linspace(0,1,100),i=e.predict(t.reshape([100,1])),s=t.mul(a.sub(h)).add(h),l=i.mul(o.sub(r)).add(r);return[s.dataSync(),l.dataSync()]}),d=Array.from(l).map((e,t)=>({x:e,y:u[t]})),c=t.map(e=>({x:e.horsepower,y:e.mpg}));s.render.scatterplot({name:"Model Predictions vs Original Data"},{values:[c,d],series:["original","predicted"]},{xLabel:"Horsepower",yLabel:"MPG",height:300})}(h,e,t)}MouseDown(e,t){let i=new h.NVector3(this.MapX(e),this.MapY(t));for(let e=0;e<this.vs.length;++e)if(.05>h.NVector3.Distance(i,this.vs[e])){this.selVec=this.vs[e];return}this.vs.push(new h.NVector3(this.MapX(e),this.MapY(t)))}MouseDoubleClick(){}MouseMove(e,t){let i;let n=new h.NVector3(this.MapX(e),this.MapY(t));for(let e=0;e<this.vs.length;++e).05>h.NVector3.Distance(n,this.vs[e])&&(i=this.vs[e]);i?this.selVec=i:this.selVec=void 0}MouseDrag(e,t){this.selVec&&(this.selVec.x=this.MapX(e),this.selVec.y=this.MapY(t))}MouseUp(){this.selVec=void 0}MapX(e){return h.MathUtility.Remap(e,0,this.width,-1,1)}MapY(e){return h.MathUtility.Remap(e,0,this.height,1,-1)}GridLine(e){e.strokeStyle="#555555";let t=this.width/20-1,i=this.height/20-1;for(let n=0;n<20;n+=1){10===n?e.lineWidth=3:e.lineWidth=1;let s=t*n,a=0,h=s,r=this.height;e.beginPath(),e.moveTo(s,a),e.lineTo(h,r),e.stroke(),s=0,a=i*n,h=this.width,r=a,e.beginPath(),e.moveTo(s,a),e.lineTo(h,r),e.stroke()}}RenderIndependentCanvas(e){if(e.fillStyle="#000000",e.beginPath(),e.rect(0,0,e.canvas.width,e.canvas.height),e.closePath(),e.fill(),this.GridLine(e),this.vs.length>1){let t=[],i=[];for(let e=0;e<this.vs.length;++e)t.push(this.vs[e].x),i.push(this.vs[e].y);this.RenderLine(e)}e.fillStyle="#00ff00";for(let t=0;t<this.vs.length;++t)e.beginPath(),e.arc(h.MathUtility.Remap(this.vs[t].x,-1,1,0,this.width),h.MathUtility.Remap(this.vs[t].y,-1,1,this.height,0),5,0,2*Math.PI),e.closePath(),e.fill();this.selVec&&(e.fillStyle="#ffffff",e.font="15px Arial",e.textAlign="center",e.fillText("x:".concat(this.selVec.x.toFixed(3),", y").concat(this.selVec.y.toFixed(3)),h.MathUtility.Remap(this.selVec.x,-1,1,0,this.width),h.MathUtility.Remap(this.selVec.y,-1,1,this.height,0)-9))}RenderLine(e){let t=[];for(let e=-1;e<=1;e+=.05)t.push(e)}constructor(e,t=650,i=350){super(e,t,i),this.xpos=100,this.ypos=100,this.xspeed=10,this.yspeed=10,this.xdirection=1,this.ydirection=1,this.rad=50,this.vs=[],this.selVec=void 0,this.indeCanvas.title="TF Horsepower and Miles Per Gallon",this.Init()}}async function l(e,t,i){return e.compile({optimizer:n.train.adam(),loss:n.losses.meanSquaredError,metrics:["mse"]}),await e.fit(t,i,{batchSize:32,epochs:50,shuffle:!0,callbacks:s.show.fitCallbacks({name:"Training Performance"},["loss","mse"],{height:200,callbacks:["onEpochEnd"]})})}let u=()=>{let e=n.sequential();return e.add(n.layers.dense({inputShape:[1],units:16,useBias:!0})),e.add(n.layers.dense({units:1,useBias:!0})),e},d=e=>n.tidy(()=>{n.util.shuffle(e);let t=e.map(e=>e.horsepower),i=e.map(e=>e.mpg),s=n.tensor2d(t,[t.length,1]),a=n.tensor2d(i,[i.length,1]),h=s.max(),r=s.min(),o=a.max(),l=a.min();return{inputs:s.sub(r).div(h.sub(r)),labels:a.sub(l).div(o.sub(l)),inputMax:h,inputMin:r,labelMax:o,labelMin:l}})},99473:function(e,t,i){i.r(t),i.d(t,{ACTION_TYPE:function(){return n.KW},ACTIVECOMMAND_MODE:function(){return n.AG},ActiveCommandBase:function(){return n.wm},AppAccessibility:function(){return n.Wv},AppProperties:function(){return n.gj},ArrayUtility:function(){return n.R3},BrowserUtility:function(){return n.R7},CLICK_TYPE:function(){return n.uh},CLOGTYPE:function(){return n.g6},COMPILE_MODE:function(){return n.Iq},ColorUtility:function(){return n.mK},Deltatime:function(){return n.gk},EVENT_LISTENER_TYPE:function(){return n.GZ},FHTYPE:function(){return n.OH},GTYPE:function(){return n.OB},GeometryBase:function(){return n.bx},INTERACTION_MODE:function(){return n.WU},LINECAP:function(){return n.EQ},MathUtility:function(){return n.$H},NDataUtility:function(){return n.eu},NUI:function(){return n.Fc},NVector3:function(){return n.h9},NumericalMotion:function(){return n.aX},OPTIMIZER:function(){return n.sg},PRESS_TYPE:function(){return n.dc},TEXTALIGN:function(){return n.mH},TEXTBOX:function(){return n.SE},TOUCH_TYPE:function(){return n.KV},UNIT:function(){return n.iI}});var n=i(8483)}}]);