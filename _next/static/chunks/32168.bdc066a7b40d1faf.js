(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[32168],{32168:function(t,r,e){"use strict";e.r(r),e.d(r,{Solution:function(){return f}});var o=e(34040),n=e(57437),i=e(77719),a=e.n(i);e(89360);var s=e(2265);class c{onAdd(t,r){this.map=t;let e=r.createShader(r.VERTEX_SHADER);r.shaderSource(e,this.vertexSource),r.compileShader(e);let o=r.createShader(r.FRAGMENT_SHADER);r.shaderSource(o,this.fragmentSource),r.compileShader(o),this.program=r.createProgram(),r.attachShader(this.program,e),r.attachShader(this.program,o),r.linkProgram(this.program),this.aPos=r.getAttribLocation(this.program,"aPos"),this.buffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,this.buffer),r.bufferData(r.ARRAY_BUFFER,this.data,r.STATIC_DRAW)}render(t,r){t.useProgram(this.program),t.uniform1f(t.getUniformLocation(this.program,"u_size"),5*Math.pow(2,this.map.transform.zoom)),t.uniform4fv(t.getUniformLocation(this.program,"u_color"),[1,1,0,1]),t.uniform4fv(t.getUniformLocation(this.program,"u_stroke"),[1,0,0,1]),t.uniformMatrix4fv(t.getUniformLocation(this.program,"u_matrix"),!1,r),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.enableVertexAttribArray(this.aPos),t.vertexAttribPointer(this.aPos,2,t.FLOAT,!1,0,0),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.drawArrays(t.POINTS,0,.5*this.data.length)}constructor(t="custom",r){this.type="custom",this.vertexSource="\n    precision highp float;\n    uniform mat4 u_matrix;\n    uniform float u_size;\n    attribute vec2 aPos;\n\n    varying vec2 position;\n    \n    void main() {\n        gl_Position = u_matrix * vec4(aPos, 0.0, 1.0);\n        gl_PointSize = u_size; \n        position = vec2(aPos.xy);\n    }",this.fragmentSource="\n    precision mediump float;\n\n    uniform vec4 u_color;\n    uniform vec4 u_stroke;\n\n    varying vec2 position;\n\n    void main() {\n        \n        float aRadius = 2.0;\n        float dist = distance(position, gl_FragCoord.xy);\n\n        // https://stackoverflow.com/questions/7237086/opengl-es-2-0-equivalent-for-es-1-0-circles-using-gl-point-smooth\n        float len = length(gl_PointCoord - vec2(0.5)) * 1.0;\n        float radius = 0.3;\n        float strokeWidth = 0.2;\n\n        if (len < radius) {\n            gl_FragColor = u_color;\n        } else if (len < radius + strokeWidth) {\n            gl_FragColor = u_stroke;\n        } else {\n            discard;\n        }\n    }",this.id=t,this.data=r}}class u{onAdd(t,r){let e=r.createShader(r.VERTEX_SHADER);r.shaderSource(e,this.vertexSource),r.compileShader(e);let o=r.createShader(r.FRAGMENT_SHADER);r.shaderSource(o,this.fragmentSource),r.compileShader(o),this.program=r.createProgram(),r.attachShader(this.program,e),r.attachShader(this.program,o),r.linkProgram(this.program),this.aPos=r.getAttribLocation(this.program,"aPos");let n=a().MercatorCoordinate.fromLngLat({lng:25.004,lat:60.239}),i=a().MercatorCoordinate.fromLngLat({lng:13.403,lat:52.562}),s=a().MercatorCoordinate.fromLngLat({lng:30.498,lat:50.541});this.buffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,this.buffer),r.bufferData(r.ARRAY_BUFFER,new Float32Array([n.x,n.y,i.x,i.y,s.x,s.y]),r.STATIC_DRAW)}render(t,r){t.useProgram(this.program),t.uniformMatrix4fv(t.getUniformLocation(this.program,"u_matrix"),!1,r),t.uniform4fv(t.getUniformLocation(this.program,"u_color"),[1,0,0,1]),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.enableVertexAttribArray(this.aPos),t.vertexAttribPointer(this.aPos,2,t.FLOAT,!1,0,0),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.drawArrays(t.TRIANGLES,0,3)}constructor(t="custom"){this.type="custom",this.vertexSource="\n    uniform mat4 u_matrix;\n    attribute vec2 aPos;\n    \n    uniform vec4 u_color;\n    // out vec4 vertexColor;\n\n    void main() {\n        gl_Position = u_matrix * vec4(aPos, 0.0, 1.0);\n        gl_PointSize = 5.0; \n    }",this.fragmentSource="\n    \n    // uniform vec4 u_color;\n\n    void main() {\n        gl_FragColor = vec4(1.0, 1.0, 0.0, 0.25);\n    }",this.id=t}}class l{init(){this.map.addLayer(new u("custom-01"),"building");let t=this.toMercators([25.004,60.239,0,0,1,1,2,2,3,3]);this.map.addLayer(new c("custom-02",t),"building"),this.map.on("click",t=>{let r=this.map.queryRenderedFeatures(t.point,{layers:["custom-01"]});r.length>0&&console.log(r[0].properties)})}dispose(){}toMercator(t,r){return a().MercatorCoordinate.fromLngLat({lng:t,lat:r})}toMercators(t){let r=new Float32Array(t.length);for(let e=0;e<t.length;e+=2){let o=this.toMercator(t[e],t[e+1]);r[e]=o.x,r[e+1]=o.y}return r}constructor(t){this.map=t}}var m=e(99846),h=e.n(m),d=()=>{let t=(0,s.useRef)(null),r=(0,s.useRef)(null),e=(0,s.useRef)(null),o=()=>{r.current||(a().accessToken="pk.eyJ1IjoiZGVzaWduanUiLCJhIjoiY2xhNGU0YWo4MDlhYzNwdHBwenVvang4eiJ9.P3sX4l_3KjdPeRRbVS1VVg",r.current=new(a()).Map({container:t.current,style:"mapbox://styles/mapbox/dark-v11",center:[0,38],projection:"mercator",zoom:2,attributionControl:!1}),e.current=new l(r.current),r.current.on("load",()=>{e.current.init()}),r.current.on("move",()=>{}))};return(0,s.useEffect)(()=>(o(),()=>{e.current.dispose()}),[]),(0,n.jsx)("div",{ref:t,className:h().mapContainer})};class f{destroy(){for(;this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}constructor(t){this.divHost=document.getElementById(t);let r=document.createElement("div");r.style.height="100%",this.divHost.appendChild(r),o.createRoot(r).render(s.createElement(d,{}))}}},89360:function(){},99846:function(t){t.exports={mapContainer:"style_mapContainer__HF3qx"}}}]);