"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[90498],{15986:function(e,t,r){r.d(t,{c:function(){return a},f:function(){return s}});var i=r(44340);function s(e,t){let r;if("string"==typeof e)r=(0,i.hP)(e+`-seed(${t})`);else{let i=12;r=e^t;do r=107*(r>>8^r)+i|0;while(0!=--i)}return(1+-(r/2147483648))/2}function a(e){return Math.floor(s(e,n)*l)}let n=53290320,l=10},90498:function(e,t,r){r.d(t,{a:function(){return ee}});var i=r(31408),s=r(97398),a=r(52776),n=r(30375),l=r(14888),o=r(52165),h=r(60186),c=r(89767),u=r(14162),d=r(59528),m=r(4392),f=r(49978),p=r(89668),_=r(76827),g=r(6977),x=r(24168),y=r(83339),v=r(73503),P=r(66494),M=r(32412),w=r(85445),b=r(6299),I=r(9736);function L(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function S(e,t){return Math.sqrt(e*e+t*t)}function k(e){let t=S(e[0],e[1]);e[0]/=t,e[1]/=t}class z{constructor(e,t,r,i,s){this._segments=e,this._index=t,this._distance=r,this._xStart=i,this._yStart=s,this._done=!1}static create(e){return new z(e,0,0,e[0][0],e[0][1])}clone(){return new z(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(e){return this._index===e._index||e._index===this._index-1&&(0===this._distance||1===e._distance)||e._index===this._index+1&&(1===this._distance||0===e._distance)}leq(e){return this._index<e._index||this._index===e._index&&this._distance<=e._distance}geq(e){return this._index>e._index||this._index===e._index&&this._distance>=e._distance}get _segment(){return this._segments[this._index+1]}get angle(){let e=this.dy,t=Math.acos((0*e+-(-1*this.dx))/(1*this.length));return e>0&&(t=2*Math.PI-t),t}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){let{dx:e,dy:t}=this;return Math.sqrt(e*e+t*t)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<this._segments.length-1}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(e,t){let r=this.backwardLength;if(e<=r)return this._distance=(r-e)/this.length,this;let i=this.backwardLength;for(;this.prev();){if(i+this.length>e)return this._seekBackwards(e-i);i+=this.length}return this._distance=0,t?this:null}seek(e,t=!1){if(e<0)return this._seekBackwards(Math.abs(e),t);if(e<=this.remainingLength)return this._distance=(this.backwardLength+e)/this.length,this;let r=this.remainingLength;for(;this.next();){if(r+this.length>e)return this.seek(e-r,t);r+=this.length}return this._distance=1,t?this:null}}function E(e,t,r,i=!0){let s=function(e){let t=0;for(let r=0;r<e.length-1;r++)t+=function(e,t,r=1){let[i,s]=e[t+1];return[i,s]=[Math.round(i),Math.round(s)],Math.sqrt(i*i+s*s)*r}(e,r);return t}(e),a=z.create(e),n=s/2;if(!i)return a.seek(n),void(Math.abs(a.x)<I.L&&Math.abs(a.y)<I.L&&r(a.clone(),0,n+0*t,s));let l=Math.floor(Math.max((s-t)/2,0)/t);a.seek(n-l*t);for(let e=-l;e<=l;e++)Math.abs(a.x)<I.L&&Math.abs(a.y)<I.L&&r(a.clone(),e,n+e*t,s),a.seek(t)}function B(e,t){for(let r=0;r<e.length;r++){let i=e[r];!function(e,t){if(t<=0)return;let r=e.length;if(r<3)return;let i=[],s=0;i.push(0);for(let t=1;t<r;t++){var a,n;s+=(a=e[t],n=e[t-1],S(a[0]-n[0],a[1]-n[1])),i.push(s)}t=Math.min(t,.2*s);let l=[];l.push(e[0][0]),l.push(e[0][1]);let o=e[r-1][0],h=e[r-1][1],c=L([0,0],e[0],e[1]);k(c),e[0][0]+=t*c[0],e[0][1]+=t*c[1],L(c,e[r-1],e[r-2]),k(c),e[r-1][0]+=t*c[0],e[r-1][1]+=t*c[1];for(let e=1;e<r;e++)i[e]+=t;i[r-1]+=t;let u=.5*t;for(let s=1;s<r-1;s++){let a=0,n=0,o=0;for(let r=s-1;r>=0&&!(i[r+1]<i[s]-u);r--){let l=u+i[r+1]-i[s],h=i[r+1]-i[r],c=i[s]-i[r]<u?1:l/h;if(1e-6>Math.abs(c))break;let d=c*c,m=c*l-.5*d*h,f=c*h/t,p=e[r+1],_=e[r][0]-p[0],g=e[r][1]-p[1];a+=f/m*(p[0]*c*l+.5*d*(l*_-h*p[0])-d*c*h*_/3),n+=f/m*(p[1]*c*l+.5*d*(l*g-h*p[1])-d*c*h*g/3),o+=f}for(let l=s+1;l<r&&!(i[l-1]>i[s]+u);l++){let r=u-i[l-1]+i[s],h=i[l]-i[l-1],c=i[l]-i[s]<u?1:r/h;if(1e-6>Math.abs(c))break;let d=c*c,m=c*r-.5*d*h,f=c*h/t,p=e[l-1],_=e[l][0]-p[0],g=e[l][1]-p[1];a+=f/m*(p[0]*c*r+.5*d*(r*_-h*p[0])-d*c*h*_/3),n+=f/m*(p[1]*c*r+.5*d*(r*g-h*p[1])-d*c*h*g/3),o+=f}l.push(a/o),l.push(n/o)}l.push(o),l.push(h);for(let t=0,i=0;t<r;t++)e[t][0]=l[i++],e[t][1]=l[i++]}(i,t);let s=[];s.push(i[0]);for(let e=1;e<i.length;e++){let[t,r]=i[e-1],[a,n]=i[e],l=a-t,o=n-r;s.push([l,o])}e[r]=s,i=s}return e}var A=r(85837),D=r(23040);let F=(0,d.HP)(e=>{let t=0;if(0===e)return 1/0;for(;!(e%2);)t++,e/=2;return t});class G extends D.lW{constructor(){super(...arguments),this._zoomLevel=0}_write(e,t,r,i){if(this._zoomLevel=i||0,null!=r)throw Error("InternalError: EffectGeometry not support for LabelMeshWriter");switch(t.geometryType){case"esriGeometryPoint":{let r=t.readXForDisplay(),i=t.readYForDisplay();return this._writePoint(e,r,i,t)}case"esriGeometryEnvelope":case"esriGeometryPolygon":case"esriGeometryMultipoint":{let r=t.readCentroidForDisplay();if(!r)return;let[i,s]=r.coords;return this._writePoint(e,i,s,t)}case"esriGeometryPolyline":this._writeLines(e,t)}}_writePoint(e,t,r,i){let s=this._getShaping();if(!s)return;let a=this._getPointReferenceBounds();a||(a={offsetX:0,offsetY:0,size:0});let n=s.boundsT,l=(0,P.kH)(this.evaluatedMeshParams.horizontalAlignment),o=(0,P.b7)(this.evaluatedMeshParams.verticalAlignment),h=this.evaluatedMeshParams.scaleInfo?.maxScale??0,c=this.evaluatedMeshParams.scaleInfo?.minScale??0,u=(0,M.jL)(i.getDisplayId());e.metricStart(new b.O(u,t,r,l,o,h,c,a)),e.metricBoxWrite(n),this._writeGlyphs(e,i.getDisplayId(),t,r,s,0,a),e.metricEnd()}_getPointReferenceBounds(){if(!this._references)return null;for(let e of this._references){let t=e.getBoundsInfo();if(t)return t}return null}_writeLines(e,t){let{scaleInfo:r,verticalAlignment:i}=this.evaluatedMeshParams,s=this.evaluatedMeshParams.repeatLabelDistance||128,a=this._getShaping("middle");if(!a)return;let n=(e,t,r,i)=>this._placeSubdivGlyphs(e,t,r,i),l=(a.bounds.width+s)/2;this._current={out:e,id:t.getDisplayId(),shaping:a,zoomRange:(0,A._f)(r,this.getTileInfo()),referenceBounds:this._getPointReferenceBounds()||{offsetX:0,offsetY:0,size:0},offsetDirection:null},this._verticalPlacement="bottom"===i?"above":"top"===i?"below":null,this._verticalPlacement?this._writeAboveAndBelowAlong(t,n,l):this._writeCenterAlong(t,n,l)}_writeAboveAndBelowAlong(e,t,r){let{repeatLabel:i,fontSize:s}=this.evaluatedMeshParams,{shaping:a}=this._current,n=(0,m.F2)(s),l=e.readGeometryForDisplay();if(!l)return;let o=new v.Z;(0,y.zj)(o,l,!1,!1,"esriGeometryPolyline",1);let h=O(new v.Z,o,n),c=O(new v.Z,o,-n),u=(0,y.di)(c,"esriGeometryPolyline",!1,!1),d=B((0,y.di)(h,"esriGeometryPolyline",!1,!1).paths,a.bounds.width),f=B(u.paths,a.bounds.width);for(let e of(this._current.offsetDirection="above",d))E(e,r,t,!!i);for(let e of(this._current.offsetDirection="below",f))E(e,r,t,!!i)}_writeCenterAlong(e,t,r){let{repeatLabel:i}=this.evaluatedMeshParams,{shaping:s}=this._current;for(let a of B(e.readLegacyGeometryForDisplay().paths,s.bounds.width))E(a,r,t,!!i)}_placeSubdivGlyphs(e,t,r,i){let{allowOverrun:s,labelPosition:a,repeatLabelDistance:n}=this.evaluatedMeshParams,l=this._current.zoomRange[0],o=F(t),h=this._current.shaping.bounds.width/2,c=this._current.shaping.isMultiline?D.PW:Math.log2(Math.min(r,i-r)/(Math.sqrt(n||128)/2+h/2)),u=0===t?c:Math.min(o,c),d=Math.max(l,this._zoomLevel+1-u),m=this._zoomLevel-d,f=this._current.shaping.bounds.width/2*2**m;this._current.shaping.isMultiline?0===t&&this._placeStraight(e,d):s&&m<0?this._placeStraightAlong(e,l):"parallel"===a?this._placeStraightAlong(e,d):"curved"===a&&this._placeCurved(e,d,f)}_placeStraight(e,t){let{out:r,id:i,shaping:s,referenceBounds:a}=this._current,{x:n,y:l}=e,o=(0,M.jL)(i),h=this.evaluatedMeshParams.scaleInfo?.maxScale??0,c=this.evaluatedMeshParams.scaleInfo?.minScale??0;r.metricStart(new b.O(o,e.x,e.y,0,0,h,c,null)),r.metricBoxWrite(s.boundsT);let u=e.angle*(180/Math.PI)%360,d=(e.angle*(180/Math.PI)+180)%360;this._writeGlyphs(r,i,n,l,s,0,a,{clipAngle:u,mapAligned:!0,isLineLabel:!0,minZoom:t}),this._writeGlyphs(r,i,n,l,s,0,a,{clipAngle:d,mapAligned:!0,isLineLabel:!0,minZoom:t}),r.metricEnd()}_placeCurved(e,t,r){let{out:i,id:s}=this._current,a=e.clone(),n=e.angle*(180/Math.PI)%360,l=(e.angle*(180/Math.PI)+180)%360,o=(0,M.jL)(s),h=this.evaluatedMeshParams.scaleInfo?.maxScale??0,c=this.evaluatedMeshParams.scaleInfo?.minScale??0;i.metricStart(new b.O(o,e.x,e.y,0,0,h,c,null)),this._verticalPlacement&&this._verticalPlacement!==this._current.offsetDirection||(this._placeFirst(a,t,1,n),this._placeBack(e,a,t,r,1,n),this._placeForward(e,a,t,r,1,n)),this._verticalPlacement&&this._verticalPlacement===this._current.offsetDirection||(this._placeFirst(a,t,0,l),this._placeBack(e,a,t,r,0,l),this._placeForward(e,a,t,r,0,l)),i.metricEnd()}_placeStraightAlong(e,t){let{out:r,id:i,shaping:s,zoomRange:a,referenceBounds:n}=this._current,{boxBorderLineColor:l,boxBackgroundColor:o}=this.evaluatedMeshParams,h=e.clone(),c=e.angle*(180/Math.PI)%360,u=(e.angle*(180/Math.PI)+180)%360;if(s.glyphs.length>0&&!(!l&&!o)){let l=Math.max(t,a[0],0),o=Math.min(D.PW,a[1]),h=(0,f.Us)((0,p.Ue)(),-e.angle),d={minZoom:l,maxZoom:o,clipAngle:c,mapAligned:!0,isLineLabel:!0},_=(0,m.F2)(this.evaluatedMeshParams.offsetX),x=(0,m.F2)(this.evaluatedMeshParams.offsetY);if(!this._verticalPlacement||this._verticalPlacement===this._current.offsetDirection){let t=(0,g.al)(_,-1*x),[a,l]=s.shapeBackground((0,f.Iu)((0,p.Ue)(),h,t));r.recordStart(this.instanceId,this.attributeLayout,s.glyphs[0].textureBinding);let o=2*Math.max(a.width,a.height);r.recordBounds(e.x+a.x,e.y+a.y,o,o),this._writeTextBox(r,i,e.x,e.y,l,n,d),r.recordEnd()}if(!this._verticalPlacement||this._verticalPlacement!==this._current.offsetDirection){let t=(0,g.al)(_,x),[a,l]=s.shapeBackground((0,f.Iu)((0,p.Ue)(),h,t));d.clipAngle=u,r.recordStart(this.instanceId,this.attributeLayout,s.glyphs[0].textureBinding);let o=2*Math.max(a.width,a.height);r.recordBounds(e.x+a.x,e.y+a.y,o,o),this._writeTextBox(r,i,e.x,e.y,l,n,d),r.recordEnd()}}let d=(0,M.jL)(i),_=this.evaluatedMeshParams.scaleInfo?.maxScale??0,x=this.evaluatedMeshParams.scaleInfo?.minScale??0;r.metricStart(new b.O(d,e.x,e.y,0,0,_,x,null)),this._verticalPlacement&&this._verticalPlacement!==this._current.offsetDirection||this._placeFirst(h,t,1,c,!0),this._verticalPlacement&&this._verticalPlacement===this._current.offsetDirection||this._placeFirst(h,t,0,u,!0),r.metricEnd()}_placeBack(e,t,r,i,s,a){let n=e.clone(),l=e.backwardLength+0;for(;n.prev()&&!(l>=i);)this._placeOnSegment(n,t,l,r,-1,s,a),l+=n.length+0}_placeForward(e,t,r,i,s,a){let n=e.clone(),l=e.remainingLength+0;for(;n.next()&&!(l>=i);)this._placeOnSegment(n,t,l,r,1,s,a),l+=n.length+0}_placeFirst(e,t,r,i,s=!1){let{out:a,id:n,shaping:l,zoomRange:o,referenceBounds:h}=this._current;for(let c of l.glyphs){let u=c.x>l.bounds.x?r:1-r,d=u*e.remainingLength+(1-u)*e.backwardLength,m=Math.abs(c.x+c.width/2-l.bounds.x),f=Math.max(0,this._zoomLevel+Math.log2(m/(d+0))),p=Math.max(t,s?0:f);c.maxZoom=Math.min(o[1],D.PW),c.angle=e.angle+(1-r)*Math.PI,c.minZoom=Math.max(o[0],p),this._writeLineGlyph(a,n,e.x,e.y,l.bounds,c,i,h,!0),r&&this._isVisible(c.minZoom,c.maxZoom)&&a.metricBoxWrite(c.bounds)}}_placeOnSegment(e,t,r,i,s,a,n){let{out:l,id:o,shaping:h,referenceBounds:c}=this._current,u=h.glyphs,d=e.dx/e.length,m=e.dy/e.length,f={x:e.x+-(r*s)*d,y:e.y+-(r*s)*m};for(let d of u){let u=d.x>h.bounds.x?a:1-a;if(!(u&&1===s||!u&&-1===s))continue;let m=Math.abs(d.x+d.width/2-h.bounds.x),p=Math.max(0,this._zoomLevel+Math.log2(m/r)-.1),_=Math.max(i,this._zoomLevel+Math.log2(m/(r+e.length+0)));if(0!==p&&(d.angle=e.angle+(1-a)*Math.PI,d.minZoom=_,d.maxZoom=p,this._writeLineGlyph(l,o,f.x,f.y,h.bounds,d,n,c,!0),a&&this._isVisible(d.minZoom,d.maxZoom))){let r=d.bounds,i=e.x-t.x,s=e.y-t.y,a=new w.Z(r.center[0]+i,r.center[1]+s,r.width,r.height);l.metricBoxWrite(a)}}}_writeLineGlyph(e,t,r,i,s,a,n,l,o){let h=r+s.x,c=i+s.y,u=2*(this.evaluatedMeshParams.minPixelBuffer?this.evaluatedMeshParams.minPixelBuffer/this._textMeshTransformProps.fontSize:1),d=Math.max(s.width,s.height)*u;e.recordStart(this.instanceId,this.attributeLayout,a.textureBinding),e.recordBounds(h,c,d,d);let{texcoords:m,offsets:f}=a,p=this._textMeshTransformProps.fontSize;this._writeQuad(e,t,r,i,{texcoords:m,offsets:f,fontSize:p,color:(0,A.G7)(this.evaluatedMeshParams.color),isBackground:!1,referenceBounds:l,minZoom:Math.max(this._current.zoomRange[0],a.minZoom),maxZoom:Math.min(this._current.zoomRange[1],a.maxZoom),clipAngle:n,mapAligned:o,isLineLabel:!0}),e.recordEnd()}_isVisible(e,t){let r=this._zoomLevel;return e<=r&&r<=t}}function O(e,t,r){let{coords:i,lengths:s}=t,a=(0,x.Ue)(),n=(0,x.Ue)(),l=(0,x.Ue)(),o=(0,x.Ue)(),h=(0,x.Ue)(),c=(0,x.Ue)(),u=0;for(let t=0;t<s.length;t++){let d=s[t];for(let t=0;t<d;t++){let s=2*(t+u-1),m=2*(t+u),f=2*(t+u+1);t>0?(0,_.t8)(a,i[s],i[s+1]):(0,_.t8)(a,0,0),(0,_.t8)(n,i[m],i[m+1]),t<d-1?(0,_.t8)(l,i[f],i[f+1]):(0,_.t8)(l,0,0),0===t?(0,_.t8)(o,0,0):((0,_.lu)(o,n,a),(0,_.Fv)(o,o),(0,_.t8)(o,o[1],-o[0])),t===d-1?(0,_.t8)(h,0,0):((0,_.lu)(h,l,n),(0,_.Fv)(h,h),(0,_.t8)(h,h[1],-h[0])),(0,_.IH)(c,o,h),(0,_.Fv)(c,c);let p=c[0]*h[0]+c[1]*h[1];0!==p&&(0,_.bA)(c,c,p),(0,_.bA)(c,c,r),e.coords.push(n[0]+c[0],n[1]+c[1])}e.lengths.push(d),u+=d}return e}var R=r(35619),T=r(88125),Z=r(6013),C=r(78628),W=r(94605),V=r(61764),j=r(65223),q=r(15986),N=r(8186),U=r(18161);let H=()=>j.Z.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.mesh.MeshWriterInputEvaluator");async function X(e,t,r=!1){let{defaultValue:i,valueExpressionInfo:s,value:a}=t;if(s){let{expression:a}=s,n=await e.createComputedField({expression:a},r);return n?{...t,computed:n,defaultValue:i}:null}return{...t,computed:new U.J(a),defaultValue:i}}async function $(e,t){let{defaultValue:r,valueExpressionInfo:i}=t,{expression:s}=i,a=await e.createComputedField({expression:s});return a?{...t,computed:a,defaultValue:r}:null}let Y=e=>"boolean"!=typeof e&&"number"!=typeof e&&"valueExpressionInfo"in e,J=e=>e.some(e=>{for(let t in e)if(Y(e[t]))return!0;return!1});class Q{static async create(e,t,r){let i={},s=new Map,a=new Map,n=new Map,l=new Map,o=new Map;for(let h in r){let c=r[h];if(null!=c&&"object"==typeof c){if(Array.isArray(c)){if("object"==typeof c[0])throw Error(`InternalError: Cannot handle ${h}. Nested array params are not supported`);i[h]=c}else if("valueExpressionInfo"in c){if(c.value){i[h]=c.value;continue}let t=await $(e,c);if(!t){i[h]=c.defaultValue;continue}s.set(h,t),i[h]=null}else switch(c.type){case"cim-effect-infos":if(c.effectInfos.some(e=>e.overrides.length)){a.set(h,{effects:await Promise.all(c.effectInfos.map(async t=>{let r=t.overrides.map(t=>X(e,t));return{effect:t.effect,compiledOverrides:(await Promise.all(r)).filter(C.pC)}}))});break}i[h]=c.effectInfos.map(e=>e.effect);break;case"cim-marker-placement-param":c.overrides.length&&n.set(h,{placementInfo:c,compiledOverrides:(await Promise.all(c.overrides.map(t=>X(e,t)))).filter(C.pC)}),i[h]=c.placement;break;case"text-rasterization-param":{if(c.overrides.length){let t=c.overrides.map(t=>X(e,t,c.useLegacyLabelEvaluationRules));l.set(h,{compiledOverrides:(await Promise.all(t)).filter(C.pC),rasterizationParam:c,objectIdToResourceId:new Map});continue}let r={type:"cim-rasterization-info",resource:c.resource};i[h]=await t.fetchResourceImmediate(r)??null;break}case"sprite-rasterization-param":{if(c.overrides.length){let t=c.overrides.map(t=>X(e,t));l.set(h,{compiledOverrides:(await Promise.all(t)).filter(C.pC),rasterizationParam:c,objectIdToResourceId:new Map});continue}if("animated"===c.resource.type){l.set(h,{compiledOverrides:[],rasterizationParam:c,objectIdToResourceId:new Map});continue}let r={type:"cim-rasterization-info",resource:c.resource};i[h]=await t.fetchResourceImmediate(r)??null;break}case"cim-marker-transform-param":{let{params:t}=c;if(J(t)){let r={compiledMarkerInfos:[]};await Promise.all(t.map(async t=>{let i={props:{}};for(let r in t)if(Y(t[r])){let s=await $(e,t[r]);i.compiledExpressionMap||(i.compiledExpressionMap=new Map);let a=i.compiledExpressionMap;s&&a.set(r,s)}else i.props[r]=t[r];r.compiledMarkerInfos.push(i)})),o.set(h,r)}else i[h]={type:"cim-marker-transform-info",infos:t};break}default:i[h]=c}}else i[h]=c}return new Q(r,i,s,a,n,l,o)}constructor(e,t,r,i,s,a,n){this.inputMeshParams=e,this._resolvedMeshParams=t,this._dynamicProperties=r,this._dynamicEffectProperties=i,this._dynamicPlacementProperties=s,this._dynamicAsyncProperties=a,this._dynamicTransformProperties=n,this.evaluator=e=>e}get hasDynamicProperties(){return!!(this._dynamicProperties.size||this._dynamicAsyncProperties.size||this._dynamicEffectProperties.size||this._dynamicTransformProperties.size||this._dynamicPlacementProperties.size)}get evaluatedMeshParams(){return this._evaluatedMeshParams||(this._evaluatedMeshParams=this.evaluator(this._resolvedMeshParams)),this._evaluatedMeshParams}enqueueRequest(e,t,r){for(let i of this._dynamicAsyncProperties.values()){let s=(0,V.d9)(i.rasterizationParam.resource);for(let{primitiveName:e,propertyName:a,computed:n,defaultValue:l,valueExpressionInfo:o}of("animated"===i.rasterizationParam.resource.type&&i.rasterizationParam.resource.randomizeStartTime&&(s.primitiveName="__RESERVED__PRIMITIVE__NAME__",s.startGroup=(0,q.c)(t.getObjectId()||0)),i.compiledOverrides))try{let o="animated"===i.rasterizationParam.resource.type?s.primitiveName:e;(0,N.mx)(s,o,a,n,t,r,l)}catch(t){H().errorOnce(new W.Z("invalid-arcade-expression",`Encountered an error when evaluating the arcade expression '${o?.expression}' (primitive: '${e}', property: '${a}')`,t))}let a=e.enqueueRequest({type:"cim-rasterization-info",resource:s});i.objectIdToResourceId.set(t.getObjectId(),a)}}evaluateMeshParams(e,t,r){for(let[e,i]of this._dynamicProperties.entries())this._resolvedMeshParams[e]=i.computed.readWithDefault(t,r,i.defaultValue);for(let[e,i]of this._dynamicPlacementProperties.entries())for(let{computed:s,defaultValue:a,propertyName:n}of i.compiledOverrides){let l=s.readWithDefault(t,r,a);i.placementInfo.placement[n]=l,this._resolvedMeshParams[e]=i.placementInfo.placement}for(let[e,i]of this._dynamicEffectProperties.entries())for(let s of i.effects){for(let{computed:e,defaultValue:i,propertyName:a}of s.compiledOverrides){let n=e.readWithDefault(t,r,i);s.effect[a]=n}this._resolvedMeshParams[e]=i.effects.map(e=>e.effect)}for(let[e,i]of this._dynamicTransformProperties.entries()){let s={type:"cim-marker-transform-info",infos:[]};for(let e of i.compiledMarkerInfos){let i={...e.props};if(e.compiledExpressionMap)for(let[s,a]of e.compiledExpressionMap){let e=a.computed.readWithDefault(t,r,a.defaultValue);i[s]="number"==typeof e||"boolean"==typeof e?e:a.defaultValue}s.infos.push(i)}this._resolvedMeshParams[e]=s}for(let[r,i]of this._dynamicAsyncProperties.entries()){let s=i.objectIdToResourceId.get(t.getObjectId());if(null==s)continue;let a=e.getResource(s);this._resolvedMeshParams[r]=a}return this._evaluatedMeshParams=this.evaluator(this._resolvedMeshParams),this.evaluatedMeshParams}}var K=r(12702);class ee{async createMeshWriter(e,t,r,i){let s=this._getMeshWriter(i.techniqueType),a=await Q.create(e,t,i.inputParams),n=new s(i.id,a,i.optionalAttributes,r);return await n.loadDependencies(),n}_getMeshWriter(e){switch(e){case i.t.Fill:return l.Q;case i.t.DotDensity:return s.Z;case i.t.ComplexFill:return a.h5;case i.t.PatternFill:return h.H;case i.t.OutlineFill:return o.nT;case i.t.PatternOutlineFill:return c.i;case i.t.ComplexOutlineFill:return n.f;case i.t.Marker:return Z.A;case i.t.PieChart:return K.q;case i.t.Text:return D.lW;case i.t.Line:return R.ti;case i.t.TexturedLine:return T.I;case i.t.Heatmap:return u.E;case i.t.Label:return G;case i.t.Test:throw Error("Internal Error: Found invalid mesh writer")}}}},18161:function(e,t,r){r.d(t,{J:function(){return s}});var i=r(8263);class s extends i.X{constructor(e){super(),this._value=e}resize(e){}read(e,t){return this._value}readWithDefault(e,t,r){return this._value}referencesScale(){return!1}referencesGeometry(){return!1}}}}]);