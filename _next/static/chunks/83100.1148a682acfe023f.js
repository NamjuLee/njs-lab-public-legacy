(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[83100],{15510:function(e){function t(e){return Promise.resolve().then(function(){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=15510,e.exports=t},75410:function(){},48628:function(){},31601:function(){},67792:function(){},34977:function(){},75042:function(){},21322:function(e,t,r){"use strict";r.d(t,{P:function(){return i}});var s=r(88405);class i{predict1d(e){return e.mul(this.weights[0]).add(this.bias)}predict2d(e){return e.square().mul(this.weights[1]).add(e.mul(this.weights[0])).add(this.bias)}predict3d(e){return e.pow(s.scalar(3)).mul(this.weights[2]).add(e.square().mul(this.weights[1])).add(e.mul(this.weights[0])).add(this.bias)}predict4d(e){return e.pow(s.scalar(4)).mul(this.weights[3]).add(e.pow(s.scalar(3)).mul(this.weights[2])).add(e.square().mul(this.weights[1])).add(e.mul(this.weights[0])).add(this.bias)}predict5d(e){return e.pow(s.scalar(5)).mul(this.weights[4]).add(e.pow(s.scalar(4)).mul(this.weights[3])).add(e.pow(s.scalar(3)).mul(this.weights[2])).add(e.square().mul(this.weights[1])).add(e.mul(this.weights[0])).add(this.bias)}predict(e){return 5===this.dim?this.predict5d(e):4===this.dim?this.predict4d(e):3===this.dim?this.predict3d(e):2===this.dim?this.predict2d(e):(this.dim,this.predict1d(e))}loss(e,t){return e.sub(t).square().mean()}train(e,t){s.tidy(()=>{let r=s.tensor1d(e),i=s.tensor1d(t);this.optimizer.minimize(()=>this.loss(this.predict(r),i))})}constructor(e=0){this.weights=[],this.dim=3,this.leraningRate=.2,this.dim=e;for(let e=0;e<5;++e){let e=s.variable(s.scalar(2*Math.random()-1));e.print(),this.weights.push(e)}this.bias=s.variable(s.scalar(2*Math.random()-1)),this.optimizer=s.train.adam(this.leraningRate)}}},88876:function(e,t,r){"use strict";r.d(t,{NJSCORE:function(){return o},PolynomialRegression:function(){return n.P},RendererThree:function(){return s.T}});var s=r(14540),i=r(45169);r.o(i,"AStart")&&r.d(t,{AStart:function(){return i.AStart}}),r.o(i,"COLOR_BLENDING")&&r.d(t,{COLOR_BLENDING:function(){return i.COLOR_BLENDING}}),r.o(i,"Graph")&&r.d(t,{Graph:function(){return i.Graph}}),r.o(i,"KNN")&&r.d(t,{KNN:function(){return i.KNN}}),r.o(i,"LinearRegression")&&r.d(t,{LinearRegression:function(){return i.LinearRegression}}),r.o(i,"LinearRegressionGradientDescent")&&r.d(t,{LinearRegressionGradientDescent:function(){return i.LinearRegressionGradientDescent}}),r.o(i,"MercatorProjection")&&r.d(t,{MercatorProjection:function(){return i.MercatorProjection}}),r.o(i,"PolynomialRegression")&&r.d(t,{PolynomialRegression:function(){return i.PolynomialRegression}}),r.o(i,"RGBtoGray")&&r.d(t,{RGBtoGray:function(){return i.RGBtoGray}}),r.o(i,"RendererCanvas")&&r.d(t,{RendererCanvas:function(){return i.RendererCanvas}}),r.o(i,"RendererJSAPI")&&r.d(t,{RendererJSAPI:function(){return i.RendererJSAPI}}),r.o(i,"TypeDithering")&&r.d(t,{TypeDithering:function(){return i.TypeDithering}}),r.o(i,"Vector3")&&r.d(t,{Vector3:function(){return i.Vector3}}),r.o(i,"buildNetwork")&&r.d(t,{buildNetwork:function(){return i.buildNetwork}}),r.o(i,"crossProduct")&&r.d(t,{crossProduct:function(){return i.crossProduct}}),r.o(i,"deepCopy")&&r.d(t,{deepCopy:function(){return i.deepCopy}}),r.o(i,"distanceEuclidean")&&r.d(t,{distanceEuclidean:function(){return i.distanceEuclidean}}),r.o(i,"distanceTo")&&r.d(t,{distanceTo:function(){return i.distanceTo}}),r.o(i,"dithering4_4")&&r.d(t,{dithering4_4:function(){return i.dithering4_4}}),r.o(i,"ditheringFloydSteinberg")&&r.d(t,{ditheringFloydSteinberg:function(){return i.ditheringFloydSteinberg}}),r.o(i,"getArrayBinaryImgFromCtx")&&r.d(t,{getArrayBinaryImgFromCtx:function(){return i.getArrayBinaryImgFromCtx}}),r.o(i,"getCSVFromURL")&&r.d(t,{getCSVFromURL:function(){return i.getCSVFromURL}}),r.o(i,"getCheckBox")&&r.d(t,{getCheckBox:function(){return i.getCheckBox}}),r.o(i,"getImgFromURL")&&r.d(t,{getImgFromURL:function(){return i.getImgFromURL}}),r.o(i,"getJSONFromURL")&&r.d(t,{getJSONFromURL:function(){return i.getJSONFromURL}}),r.o(i,"getLineSeg")&&r.d(t,{getLineSeg:function(){return i.getLineSeg}}),r.o(i,"getRandomHex")&&r.d(t,{getRandomHex:function(){return i.getRandomHex}}),r.o(i,"getSlider")&&r.d(t,{getSlider:function(){return i.getSlider}}),r.o(i,"getUUID")&&r.d(t,{getUUID:function(){return i.getUUID}}),r.o(i,"hex2RGBA")&&r.d(t,{hex2RGBA:function(){return i.hex2RGBA}}),r.o(i,"isInsideOfVecs")&&r.d(t,{isInsideOfVecs:function(){return i.isInsideOfVecs}}),r.o(i,"normalize")&&r.d(t,{normalize:function(){return i.normalize}}),r.o(i,"reflect")&&r.d(t,{reflect:function(){return i.reflect}}),r.o(i,"remap")&&r.d(t,{remap:function(){return i.remap}}),r.o(i,"shuffleArray")&&r.d(t,{shuffleArray:function(){return i.shuffleArray}});var n=r(21322),o=r(8483)},14540:function(e,t,r){"use strict";r.d(t,{T:function(){return n}});var s=r(97776),i=r(78252);class n{initCanvas(){this.scene=new s.xsS,this.scene.background=new s.Ilk(0),this.scene.castShadow=!0,this.renderer=new s.CP7({antialias:!0,alpha:!0}),this.renderer.setPixelRatio(this.hostDiv.clientWidth/this.hostDiv.clientHeight),this.renderer.domElement.id="Three",this.renderer.domElement.style.position="absolute",this.renderer.shadowMap.enabled=!0,this.renderer.setSize(this.hostDiv.clientWidth,this.hostDiv.clientHeight),this.hostDiv.appendChild(this.renderer.domElement),this.camera=new s.cPb(30,this.hostDiv.clientWidth/this.hostDiv.clientHeight,1,5e3),this.controls=new i.OrbitControls(this.camera,this.renderer.domElement),this.camera.position.set(0,0,5),this.controls.update(),this.canvas=this.renderer.domElement,this.init()}init(){this.eventBind()}eventBind(){this.renderer.domElement.onmousedown=e=>this.mouseDown(e),this.renderer.domElement.onmouseup=e=>this.mouseUp(e),this.renderer.domElement.onmousemove=e=>this.mouseMove(e),this.renderer.domElement.addEventListener("click",e=>this.mouseClick(e)),window.addEventListener("resize",()=>this.onWindowResize())}onWindowResize(){this.camera.aspect=this.hostDiv.clientWidth/this.hostDiv.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.hostDiv.clientWidth,this.hostDiv.clientHeight)}start(){this.loop()}mouseDown(e){}mouseUp(e){}mouseClick(e){}mouseDClick(e){}mouseMove(e){}mouseDrag(e){}update(e){}destroy(){for(window.removeEventListener("resize",()=>this.onWindowResize()),cancelAnimationFrame(this.requestFrame),this.requestFrame=void 0;this.hostDiv.lastChild;)this.hostDiv.removeChild(this.hostDiv.lastChild)}constructor(e){this.t=0,this.requestFrame=void 0,this.loop=()=>{this.requestFrame=requestAnimationFrame(this.loop),this.controls.update(),this.update(this.scene),this.renderer.render(this.scene,this.camera),this.t+=.01},this.hostDiv=document.getElementById(e),this.initCanvas()}}},10053:function(e,t,r){"use strict";r.r(t),r.d(t,{Solution:function(){return _}});var s=r(88876);class i{constructor(e,t,r=0){this.x=e,this.y=t,this.z=r}}let n=(e,t)=>Math.sqrt(o(e,t)),o=(e,t)=>(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)+(e.z-t.z)*(e.z-t.z),h=(e,t,r,s,i,n,o,h)=>{if(e===r&&t===s||i===o&&n===h)return;let d=(h-n)*(r-e)-(o-i)*(s-t);if(0===d)return;let a=((o-i)*(t-n)-(h-n)*(e-i))/d,l=((r-e)*(t-n)-(s-t)*(e-i))/d;if(!(a<0)&&!(a>1)&&!(l<0)&&!(l>1))return[e+a*(r-e),t+a*(s-t)]},d=(e,t,r)=>e+r*(t-e),a=(e,t,r)=>{let s=r.x-t.x,n=r.y-t.y,o=((e.x-t.x)*s+(e.y-t.y)*n)/(s*s+n*n);return new i(d(t.x,r.x,o),d(t.y,r.y,o))},l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"download",r=document.createElement("a");r.href="data:application/json;charset=utf-8,"+encodeURIComponent(e),r.download="".concat(t),r.click()};class c{constructor(){this.type="node",this.isSelected=!1,this.id=0,this.visited=!1,this.data=[]}}class p{constructor(e){this.nodes=[],this.edges=[],this.graphSystem=e}}class u extends c{getLength(){return this.length=n(this.n0.vec,this.n1.vec),this.length}toJSON(){return{id:this.id,n0:this.n0.id,n1:this.n1.id,data:this.data}}remove(){this.n0.removeEdge(this),this.n1.removeEdge(this)}constructor(e,t){super(),this.length=-1,this.type="edge",this.n0=e,this.n1=t}}class g extends c{reset(){this.networkDistance=-1,this.countVisit=0,this.visited=!1}toJSON(){return{id:this.id,vec:{x:this.vec.x,y:this.vec.y,z:this.vec.z},data:this.data}}remove(){this.graph.graphSystem.removeNode(this)}removeEdge(e){this.edges.splice(this.edges.indexOf(e),1)}constructor(e,t,r,s=0){super(),this.edges=[],this.r=5,this.networkDistance=-1,this.countVisit=0,this.graph=e,this.type="node",this.vec=new i(t,r,s)}}let m=e=>{let t=0,r=[],s=[];for(e.visited=!0,s.push(e),r.push(e);s.length>0;){let e=s.shift();for(let t=0;t<e.edges.length;++t){let i=e.edges[t],n=i.n0===e?i.n1:i.n0;n.visited||(n.visited=!0,r.push(n),s.push(n))}if(t++>1e5)return}return r},v=e=>{let t=[],r=e=>{if(!e.visited){e.visited=!0,t.push(e);for(let t=0;t<e.edges.length;++t){let s=e.edges[t];r(s.n0===e?s.n1:s.n0)}}};return r(e),t},f=(e,t,r)=>(E(e.nodes,t,y,.1),x(e.nodes,r)),S=(e,t,r,s,i,n)=>Math.sqrt((e-s)*(e-s)+(t-i)*(t-i)+(r-n)*(r-n)),y=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2],S(e.vec.x,e.vec.y,e.vec.z,t.vec.x,t.vec.y,t.vec.z)},E=function(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;void 0===r&&(r=y);for(let t=0;t<e.length;++t)e[t].reset();let i=[t];t.networkDistance=0;for(let e=0;e<1e7&&0!==i.length;++e){let e=i[0];i.shift();for(let t=0;t<e.edges.length;++t){let n=e.edges[t],o=e===n.n0?n.n1:n.n0,h=r(e,o,s),d=e.networkDistance+h;(-1===o.networkDistance||d<o.networkDistance)&&(o.networkDistance=d,i.push(o))}}},x=(e,t)=>{let r=0,s=0,i=[];if(-1!==t.networkDistance){i.push(e[t.id]);let n=t;for(r=0;r<1e5;++r){let t=n;for(t.countVisit++,s=0;s<n.edges.length;++s){let e=n.edges[s],r=n===e.n0?e.n1:e.n0;r.networkDistance<t.networkDistance&&(t=r)}if(t===n)break;n=t,i.push(e[n.id])}}return i},w=(e,t,r)=>{let s=[];for(let t=0;t<e.nodes.length;++t){let r=e.nodes[t],i=new N(r.vec.x,r.vec.y,r.vec.z);i.id=r.id,s.push(i)}let i=[];for(let t=0;t<e.edges.length;++t){let r=e.edges[t],n=new D(s[r.n0.id],s[r.n1.id]);i.push(n)}return C.gePath(s[t.id],s[r.id])};class C{}C.TYPE={Manhattan:"Manhattan  ",Euclidean:"Euclidean "},C.strength=.01,C.distanceManhattan=(e,t,r,s,i,n)=>Math.abs(e-s)+Math.abs(t-i)+Math.abs(r-n),C.distanceEuclidean=(e,t,r,s,i,n)=>Math.sqrt((e-s)*(e-s)+(t-i)*(t-i)+(r-n)*(r-n)),C.gePath=(e,t,r)=>{let s;C.typeHeuristic=C.distanceEuclidean,r===C.TYPE.Manhattan&&(C.typeHeuristic=C.distanceManhattan);let i=[e],n=[],o=100;for(;o--&&(void 0===(s=C.propagation(i,n,t))||!s.length););return s},C.path=[],C.propagation=(e,t,r)=>{if(!(e.length>0))return C.path;{let s=0;for(let t=0;t<e.length;t++)e[t].f<e[s].f&&(s=t),e[t].f===e[s].f&&e[t].g>e[s].g&&(s=t);let i=e[s];if(i===r)return[i,i.previous,...C.path];C.path=[];let n=i;for(;n.previous&&(C.path.push(n.previous),(n=n.previous).previous!==C.path[C.path.length-2]););e.splice(e.indexOf(i),1),t.push(i);let o=i.neighbors;for(let s=0;s<o.length;s++){let n=o[s];if(!t.includes(n)&&!n.blocked){let t=i.g+C.heuristic(n,i)*C.strength;if(e.includes(n))continue;e.push(n),n.g=t,n.h=C.heuristic(n,r),n.f=n.g+n.h,n.previous=i}}return}},C.heuristic=(e,t)=>C.typeHeuristic(e.x,e.y,e.z,t.x,t.y,t.z);class N{constructor(e,t,r){this.id=-1,this.f=0,this.h=0,this.g=0,this.x=0,this.y=0,this.z=0,this.neighbors=[],this.edges=[],this.previous=void 0,this.blocked=!1,this.x=e,this.y=t,this.z=r}}class D{constructor(e,t){this.id=-1,this.n0=e,this.n1=t,this.n0.edges.push(this),this.n1.edges.push(this),e.neighbors.push(t),t.neighbors.push(e)}}class k{addVertex(e){this.nodes.push(e)}addEdge(e,t,r){this.edges.push({n0:e,n1:t,weight:r})}primMST(e){let t={},r=[];for(t[e]=!0;r.length<this.nodes.length-1;){let e=null;if(this.edges.forEach(r=>{(t[r.n0]&&!t[r.n1]||!t[r.n0]&&t[r.n1])&&(!e||r.weight<e.weight)&&(e=r)}),!e)break;r.push(e),t[e.n0]=!0,t[e.n1]=!0}return r}constructor(){this.nodes=[],this.edges=[],this.nodes=[],this.edges=[]}}let b=e=>{let t=new k;for(let r=0;r<e.nodes.length;++r)t.addVertex(e.nodes[r].id);for(let r=0;r<e.edges.length;++r){let s=e.edges[r];t.addEdge(s.n0.id,s.n1.id,s.getLength())}return t.primMST(0)};class P{get captured(){return this._captured}set captured(e){this._captured&&(this._captured.isSelected=!1),this._captured=e,e&&(this._captured.isSelected=!0)}resetCapture(){this.captured=void 0,this.nodePre=void 0}addNode(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let r=new g(this.graph,e,t,0);return this.graph.nodes.push(r),this.resetCapture(),r}addEdge(e,t){if(e===t||this.findEdgeByNodes(e,t))return;let r=new u(e,t);return e.edges.push(r),t.edges.push(r),this.graph.edges.push(r),this.edgeSplitByEdge(r),this.resetCapture(),r}addEdgeByClosestNode(e){let t=this.findNode(e);t&&this.addEdge(e,t),this.resetCapture()}addEdgeSplit(e,t){let r=new u(e,t);return e.edges.push(r),t.edges.push(r),this.graph.edges.push(r),r}edgeSplitByNode(e,t){let r=t.n0,s=t.n1;this.addEdge(r,e),this.addEdge(e,s),this.removeEdge(t),this.resetCapture()}edgeSplitByNodeEdges(e){let t=[],r=e.edges.length;for(let s=0;s<r;++s){let r=e.edges[s],i=[];for(let e=this.graph.edges.length-1;e>-1;--e){let t=this.graph.edges[e];if(r.n0!==t.n0&&r.n0!==t.n1&&r.n1!==t.n0&&r.n1!==t.n1){let e=R(r,t);if(e){let r=new g(this.graph,e[0],e[1]);this.graph.nodes.push(r),this.addEdgeSplit(r,t.n0),this.addEdgeSplit(r,t.n1),this.removeEdge(t),i.push(r)}}}if(i.length>0){let e=r.n0;i.push(r.n1);let s=i.map(e=>n(e.vec,r.n0.vec)),o=s.map((e,t)=>t).sort((e,t)=>s[e]-s[t]);this.addEdgeSplit(e,i[o[0]]);for(let e=0;e<o.length-1;++e)this.addEdgeSplit(i[o[e]],i[o[e+1]]);t.push(r),this.graph.edges.splice(this.graph.edges.indexOf(r),1)}}t.forEach(e=>{e.n0.removeEdge(e),e.n1.removeEdge(e)}),this.updateID()}edgeSplitByEdge(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=[];for(let t=this.graph.edges.length-1;t>-1;--t){let s=this.graph.edges[t];if(e.n0!==s.n0&&e.n0!==s.n1&&e.n1!==s.n0&&e.n1!==s.n1){let t=R(e,s);if(t){let e=new g(this.graph,t[0],t[1]);this.graph.nodes.push(e),this.addEdgeSplit(e,s.n0),this.addEdgeSplit(e,s.n1),this.removeEdge(s),r.push(e)}}}if(r.length>0){let t=e.n0;r.push(e.n1);let s=r.map(t=>n(t.vec,e.n0.vec)),i=s.map((e,t)=>t).sort((e,t)=>s[e]-s[t]);this.addEdgeSplit(t,r[i[0]]);for(let e=0;e<i.length-1;++e)this.addEdgeSplit(r[i[e]],r[i[e+1]]);this.removeEdge(e)}t&&this.updateID()}removeNode(e){e.edges.forEach(t=>{t.n0===e?t.n1.removeEdge(t):t.n0.removeEdge(t),this.graph.edges.splice(this.graph.edges.indexOf(t),1)}),this.graph.nodes.splice(this.graph.nodes.indexOf(e),1),this.updateID(),this.resetCapture()}removeEdge(e){e.n0.removeEdge(e),e.n1.removeEdge(e),this.graph.edges.splice(this.graph.edges.indexOf(e),1)}findNode(e){let t=Number.MAX_VALUE,r=-1;for(let s=0;s<this.graph.nodes.length;++s){if(this.graph.nodes[s]===e)continue;let i=n(this.graph.nodes[s].vec,e.vec);t>i&&(t=i,r=s)}if(r>-1)return this.graph.nodes[r]}findNodeVec(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,s=Number.MAX_VALUE,o=-1,h=new i(e,t);for(let e=0;e<this.graph.nodes.length;++e){let t=n(this.graph.nodes[e].vec,h);s>t&&(s=t,o=e)}if(o>-1&&s<r)return this.graph.nodes[o]}findEdgeVec(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,s=new i(e,t,0);for(let e=0;e<this.graph.edges.length;++e){let t=this.graph.edges[e],i=a(s,t.n0.vec,t.n1.vec);if(n(s,i)<r)return{edge:t,vec:i}}}findEdgeByEdge(e){return this.findEdgeByNodes(e.n0,e.n1)}findEdgeByNodes(e,t){for(let r=0;r<this.graph.edges.length;++r){let s=this.graph.edges[r];if(e===s.n0&&t===s.n1||e===s.n1&&t===s.n0)return s}}getEdgeByTwoNode(e,t){for(let r=0;r<this.graph.edges.length;++r){let s=this.graph.edges[r];if(s.n0===e&&s.n1===t||s.n0===t&&s.n1===e)return s}}mergeTwoNodes(e,t){let r=[];for(let e=0;e<t.edges.length;++e){let s=t.edges[e];s.n0===t?r.push(s.n1):r.push(s.n0)}t.remove(),r.forEach(t=>{this.getEdgeByTwoNode(e,t)||this.addEdge(e,t)})}updateID(){for(let e=0;e<this.graph.nodes.length;++e)this.graph.nodes[e].id=e;for(let e=0;e<this.graph.edges.length;++e)this.graph.edges[e].id=e}resetVisit(){for(let e=0;e<this.graph.nodes.length;++e)this.graph.nodes[e].visited=!1}setNodeStart(){this.captured&&(this.nodeStart=this.captured)}setNodeEnd(){this.captured&&(this.nodeEnd=this.captured)}computePath(){if(this.nodeStart&&this.nodeEnd)return T(this.graph,this.nodeStart.id,this.nodeEnd.id)}computePathAStar(){if(this.nodeStart&&this.nodeEnd)return B(this.graph,this.nodeStart.id,this.nodeEnd.id)}computeMST(){let e=I(this.graph);return this.pathMST=e,e}computeBFS(){return this.resetVisit(),m(this.graph.nodes[0]).map(e=>e.id)}computeDFS(){return this.resetVisit(),v(this.graph.nodes[0]).map(e=>e.id)}constructor(){this.pathMST=void 0,this.nodeStart=void 0,this.nodeEnd=void 0,this.nodePre=void 0,this._captured=void 0,this.graph=new p(this)}}let R=(e,t)=>M(e.n0,e.n1,t.n0,t.n1),M=(e,t,r,s)=>h(e.vec.x,e.vec.y,t.vec.x,t.vec.y,r.vec.x,r.vec.y,s.vec.x,s.vec.y),I=e=>b(e),T=(e,t,r)=>f(e,e.nodes[t],e.nodes[r]),B=(e,t,r)=>w(e,e.nodes[t],e.nodes[r]);class L{reset(){this.histories=[],this.currentIndex=-1}push(e){this.currentIndex<this.histories.length-1&&this.histories.splice(this.currentIndex+1,this.histories.length),this.histories.push(e),this.currentIndex=this.histories.length-1}getCurrentIndex(){return this.currentIndex}getHistoryLength(){return this.histories.length}getCurrentState(){return{currentIndex:this.getCurrentIndex(),historyNum:this.getHistoryLength()}}undo(){if(0!==this.currentIndex)return this.currentIndex--,this.histories[this.currentIndex]}redo(){return this.currentIndex++,this.currentIndex=this.currentIndex<this.histories.length?this.currentIndex:this.histories.length-1,this.histories[this.currentIndex]}constructor(){this.histories=[],this.currentIndex=-1}}class O{getLog(){return this.manager.getCurrentState()}resetState(){this.manager.reset(),this.captureState([])}captureState(e){return this.manager.push(e),this.manager.getCurrentState()}undo(){return this.manager.undo()}redo(){return this.manager.redo()}constructor(){this.manager=new L}}class F{reset(){let e=this.controller.graphSystem.graph;e.nodes=[],e.edges=[],this.capture()}capture(){this.sceneState.captureState(this.toJSON()),this.updateUndoRedoHist()}updateUndoRedoHist(){if(this.controller.divHist){let e=this.sceneState.getLog();this.controller.divHist.textContent="hist: ".concat(e.currentIndex,"/").concat(e.historyNum-1)}}undo(){let e=this.sceneState.undo();e&&this.dump(e),this.updateUndoRedoHist(),this.controller.graphSystem.resetCapture()}redo(){let e=this.sceneState.redo();e&&this.dump(e),this.updateUndoRedoHist(),this.controller.graphSystem.resetCapture()}toJSON(){let e={node:[],edge:[]};return this.controller.graphSystem.graph.nodes.forEach(t=>{e.node.push(t.toJSON())}),this.controller.graphSystem.graph.edges.forEach(t=>{e.edge.push(t.toJSON())}),e}exportJSON(){l(JSON.stringify(this.toJSON()),"graph.json")}dump(e){let t=this.controller.graphSystem;t.graph.nodes=[],t.graph.edges=[];for(let r=0;r<e.node.length;++r){let s=e.node[r],i=t.addNode(s.vec.x,s.vec.y,s.vec.z);i.id=s.id,i.data=s.data}for(let r=0;r<e.edge.length;++r){let s=e.edge[r],i=t.addEdge(t.graph.nodes[s.n0],t.graph.nodes[s.n1]);i.id=s.id,i.data=s.data}}populate(){let e=Math.random()*this.controller.canvas.width,t=Math.random()*this.controller.canvas.height;this.controller.mouseClick(e,t)}toggleDelaunay(e){this.controller.renderer.toggleDelaunay=e}toggleMST(e){this.controller.graphSystem.computeMST(),this.controller.renderer.toggleMST=e}computedBSF(){let e=this.controller.graphSystem.computeBFS();this.updateSearchResult("BFS: "+e.join(", "))}computedDFS(){let e=this.controller.graphSystem.computeDFS();this.updateSearchResult("DFS: "+e.join(", "))}updateSearchResult(e){this.controller.divSearchResult.textContent=e}computedDijkstra(e){this.controller.renderer.toggleDijkstra=e}computedAStar(e){this.controller.renderer.toggleAStar=e}removeSelection(){this.controller.graphSystem.captured&&(this.controller.graphSystem.captured.remove(),this.controller.graphSystem.captured=void 0)}addNodeWithClosestNode(e,t){let r=this.graphSystem.addNode(e,t,0);this.graphSystem.addEdgeByClosestNode(r)}constructor(e){this.controller=e,this.graphSystem=this.controller.graphSystem,this.sceneState=new O}}var U=r(8483);let z=(e,t)=>{new U.oc(t.map(e=>e.vec)).DrawTriClass(e)};class A{render(e){if(this.controller.graphSystem.captured?this.controller.divSel.textContent=this.controller.graphSystem.captured.type:this.controller.divSel.textContent="undefined",this.renderNodeStartEnd(e),e.beginPath(),e.arc(this.controller.m.x,this.controller.m.y,2,0,6.28),e.closePath(),e.fillStyle="#888",e.fill(),this.toggleMST&&this.controller.graphSystem.pathMST){let t=this.controller.graphSystem.graph.nodes;this.controller.graphSystem.pathMST.forEach(r=>{let s=t[r.n0].vec,i=t[r.n1].vec;e.beginPath(),e.moveTo(s.x,s.y),e.lineTo(i.x,i.y),e.lineWidth=5,e.stroke()})}if(this.toggleDelaunay&&z(e,this.controller.graphSystem.graph.nodes),this.toggleDijkstra&&this.controller.graphSystem.nodeStart&&this.controller.graphSystem.nodeEnd){let t=this.controller.graphSystem.computePath();e.beginPath(),e.moveTo(t[0].vec.x,t[0].vec.y);for(let r=1;r<t.length;++r)e.lineTo(t[r].vec.x,t[r].vec.y);e.strokeStyle="#f0f",e.lineWidth=5,e.stroke()}if(this.toggleAStar&&this.controller.graphSystem.nodeStart&&this.controller.graphSystem.nodeEnd){let t=this.controller.graphSystem.computePathAStar();e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let r=1;r<t.length;++r)e.lineTo(t[r].x,t[r].y);e.strokeStyle="#f0f",e.lineWidth=5,e.stroke()}this.renderGraph(e)}renderNodeStartEnd(e){if(e.fillStyle="#0ff",this.controller.graphSystem.nodeStart){let t=this.controller.graphSystem.nodeStart.vec;e.beginPath(),e.arc(t.x,t.y,8,0,2*Math.PI),e.closePath(),e.fill()}if(this.controller.graphSystem.nodeEnd){let t=this.controller.graphSystem.nodeEnd.vec;e.beginPath(),e.arc(t.x,t.y,8,0,2*Math.PI),e.closePath(),e.fill()}}renderGraph(e){this.controller.log="N:".concat(this.controller.graphSystem.graph.nodes.length,", E:").concat(this.controller.graphSystem.graph.edges.length),this.controller.graphSystem.graph.edges.forEach(t=>{this.renderGraphEdge(e,t)}),this.controller.graphSystem.graph.nodes.forEach(t=>{this.renderGraphNode(e,t)})}renderGraphNode(e,t){e.beginPath(),e.arc(t.vec.x,t.vec.y,t.r,0,6.28),e.closePath(),e.fillStyle="#ff0000",e.fill(),t.isSelected&&(e.lineWidth=3,e.strokeStyle="#00f",e.stroke()),e.strokeStyle="#ff0000",e.lineWidth=1,e.strokeText("".concat(t.networkDistance),t.vec.x,t.vec.y-20),e.strokeText("".concat(t.id),t.vec.x,t.vec.y-7)}renderGraphEdge(e,t){t.isSelected&&(e.lineWidth=3,e.strokeStyle="#00f",e.beginPath(),e.moveTo(t.n0.vec.x,t.n0.vec.y),e.lineTo(t.n1.vec.x,t.n1.vec.y),e.stroke()),e.lineWidth=1,e.beginPath(),e.moveTo(t.n0.vec.x,t.n0.vec.y),e.lineTo(t.n1.vec.x,t.n1.vec.y),e.strokeStyle="#0f0",e.stroke(),e.strokeStyle="#00ff00",e.lineWidth=1;let r=t.n0.vec.x+(t.n1.vec.x-t.n0.vec.x)*.5,s=t.n0.vec.y+(t.n1.vec.y-t.n0.vec.y)*.5;e.strokeText("".concat(t.id),r,s-7)}constructor(e){this.toggleDelaunay=!1,this.toggleMST=!1,this.toggleDijkstra=!1,this.toggleAStar=!1,this.controller=e}}class G{mouseDown(e,t){let r=this.graphSystem.findNodeVec(e,t);this.graphSystem.captured&&this.graphSystem.captured!==r&&(this.graphSystem.nodePre=this.graphSystem.captured),this.graphSystem.captured=r}mouseClick(e,t){if(this.graphSystem.captured=this.graphSystem.findNodeVec(e,t),this.graphSystem.nodePre&&this.graphSystem.captured){this.graphSystem.addEdge(this.graphSystem.nodePre,this.graphSystem.captured),this.common.capture(),this.updatePost();return}let r=this.graphSystem.findEdgeVec(e,t);if(r&&void 0===this.graphSystem.captured){let e=this.graphSystem.addNode(r.vec.x,r.vec.y);this.graphSystem.edgeSplitByNode(e,r.edge),this.common.capture(),this.updatePost();return}if(void 0===this.graphSystem.captured){this.common.addNodeWithClosestNode(e,t),this.common.capture(),this.updatePost();return}}mouseMove(e,t){this.m.x=e,this.m.y=t}mouseUp(){if(this.graphSystem.captured&&"node"===this.graphSystem.captured.type){let e=this.graphSystem.captured;this.graphSystem.edgeSplitByNodeEdges(e);let t=this.graphSystem.findNode(e);t&&8>n(e.vec,t.vec)&&this.graphSystem.mergeTwoNodes(t,e),this.wasMoved&&(this.common.capture(),this.wasMoved=!1),this.graphSystem.captured=void 0,this.updatePost()}}mouseDrag(e,t){if(this.graphSystem.captured&&"node"===this.graphSystem.captured.type){let r=this.graphSystem.captured;r.vec.x=e,r.vec.y=t}this.wasMoved=!0}updatePost(){this.renderer.toggleMST&&this.graphSystem.computeMST()}render(e){this.needPopulate&&this.populate(),this.divLog.textContent=this.log,this.renderer.render(e)}exportJSON(){return this.common.exportJSON()}populate(){return this.common.populate()}constructor(e){this.needPopulate=!1,this.m=new i(0,0,0),this.log="",this.wasMoved=!1,this.graphSystem=new P,this.common=new F(this),this.renderer=new A(this),this.canvas=e}}class V{initUI(){let e=document.createElement("div");e.style.width="160px",e.style.position="absolute",e.style.background="#222",e.style.padding="10px",this.app.divHost.appendChild(e);let t=document.createElement("button");t.textContent="run",t.onclick=()=>{this.app.controller.needPopulate=!this.app.controller.needPopulate},e.appendChild(t);let r=document.createElement("button");r.textContent="remove",r.onclick=()=>{this.app.controller.common.removeSelection()},e.appendChild(r);let s=document.createElement("button");s.textContent="Export JSON",e.appendChild(s),s.onclick=()=>{this.app.controller.exportJSON()};let i=document.createElement("div");i.textContent="N:0, E:0",i.style.color="#bbb",e.appendChild(i),this.app.controller.divLog=i;let n=document.createElement("div");n.textContent="hist: 0",n.style.color="#bbb",e.appendChild(n),this.app.controller.divHist=n;let o=document.createElement("div");o.textContent="undefined",o.style.color="#bbb",e.appendChild(o),this.app.controller.divSel=o;let h=H("reset",()=>{this.app.controller.common.reset()});e.appendChild(h);let d=H("undo",()=>{this.app.controller.common.undo()});e.appendChild(d);let a=H("redo",()=>{this.app.controller.common.redo()});e.appendChild(a);let l=J("Delaunay",e=>{this.app.controller.common.toggleDelaunay(e)});e.appendChild(l.div);let c=J("MST",e=>{this.app.controller.common.toggleMST(e)});e.appendChild(c.div);let p=H("DFS",()=>{this.app.controller.common.computedDFS()});e.appendChild(p);let u=H("BFS",()=>{this.app.controller.common.computedBSF()});e.appendChild(u);let g=document.createElement("div"),m=document.createElement("p");m.style.marginTop="2px",g.appendChild(m),e.appendChild(g),this.app.controller.divSearchResult=m;let v=J("Dijkstra",e=>{this.app.controller.common.computedDijkstra(e)});e.appendChild(v.div);let f=J("*Star",e=>{this.app.controller.common.computedAStar(e)});e.appendChild(f.div);let S=H("Start",()=>{this.app.controller.common.graphSystem.setNodeStart()});e.appendChild(S);let y=H("End",()=>{this.app.controller.common.graphSystem.setNodeEnd()});e.appendChild(y)}constructor(e){this.app=e,this.initUI()}}let H=(e,t)=>{let r=document.createElement("button");return r.textContent=e,r.onclick=()=>{t()},r},J=(e,t)=>{let r=document.createElement("div");r.style.display="flex";let s=document.createElement("input");s.type="checkbox",s.defaultChecked=!1;let i=document.createElement("div");return i.textContent=e,i.style.color="#aaa",r.appendChild(s),r.appendChild(i),s.onchange=()=>t(s.checked),{div:r,checkBox:s}};class _ extends s.RendererCanvas{init(){this.controller=new G(this.canvas),this.mouseClick(300,300),this.ui=new V(this),this.start()}render(e){this.controller.render(e)}mouseClick(e,t){this.controller.mouseClick(e,t)}mouseDown(e,t){this.controller.mouseDown(e,t)}mouseMove(e,t){this.controller.mouseMove(e,t)}mouseDrag(e,t){this.controller.mouseDrag(e,t)}mouseUp(){this.controller.mouseUp()}constructor(e){super(document.getElementById(e)),this.canvas.style.position="absolute",this.init()}}}}]);