"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95629,3955,99473],{3955:function(e,t,i){i.r(t),i.d(t,{DefinitionIndeCanvasCore:function(){return n}});var s=i(79309);class n{InitIndeCanvas(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:650,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:350;this.scene.implementation.app.needUI?this.indeCanvas=new s.D(this.scene.implementation.app.viewController.NUIWrapper.NUI.independentPanelWrapper,50,50,e,t,!0):this.indeCanvas=new s.D(this.scene.implementation.app.viewController.NUIWrapper.NUI.independentPanelWrapper,1,-25,e,t,!0),this.indeCanvas.title="TF Env",this.indeCanvas.btnHam.isHidden=!0,this.indeCanvas.btnMini.isHidden=!0,this.indeCanvas.RenderIndependentCanvas=e=>this.RenderIndependentCanvas(e)}get width(){return this.indeCanvas.canvas.width}get height(){return this.indeCanvas.canvas.height}Init(e){}RenderIndependentCanvas(e){}MouseMove(e,t){}MouseMovePre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseMove(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseDown(e,t){}MouseDownPre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseDown(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseUp(e,t){}MouseUpPre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseUp(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseDrag(e,t){}MouseDragPre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseDrag(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseLeftClick(e,t){}MouseLeftClickPre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseLeftClick(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseMiddleClick(e,t){}MouseMiddleClickPre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseMiddleClick(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseRightClick(e,t){}MouseRightClickPre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseRightClick(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseDoubleClick(e,t){}MouseDoubleClickPre(e,t){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseDoubleClick(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseWheel(e,t,i){}MouseWheelPre(e,t,i){this.indeCanvas.IsMouseInsidePanel(e,t)&&this.MouseWheel(e-this.indeCanvas.vec.x+this.mOffX,t-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY,i)}constructor(e,t=650,i=350){this.mOffX=-12,this.mOffY=-12,this.scene=e,this.scene.definitions.push(this),this.InitIndeCanvas(t,i)}}},95629:function(e,t,i){i.r(t),i.d(t,{TFPolynomialRegressionGradientDescent02:function(){return r}});var s=i(88405),n=i(3955),a=i(99473),h=i(49738);class r extends n.DefinitionIndeCanvasCore{InitUI(){let e=document.createElement("div");e.style.position="absolute",e.style.left="400px",e.style.color="#ffffff";let t=document.createElement("p");t.textContent="click on this screen to add data",e.append(t);let i=document.getElementById("indePanel");if(i){i.append(e);let t=document.createElement("button");t.textContent="run",t.style.position="absolute",t.style.left="650px",t.onclick=()=>{console.log(this)},this.scene.implementation.app.model.modelViewCoreWrapper.viewWrapper.div.append(t)}}InitData(){h.TFDataUtility.getData().then(e=>{let t=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;for(let h of(e.map(e=>{let a=e.horsepower;a>i&&(i=a),a<t&&(t=a);let h=e.mpg;return h>n&&(n=h),h<s&&(s=h),0}),e)){let e=h.horsepower,r=h.mpg;this.vsTemp.push(new a.NVector3(a.MathUtility.Remap(e,t,i,-.9,.9),a.MathUtility.Remap(r,s,n,-.9,.9)))}})}Init(){console.log(s.version),this.tfLinearRegression=new d}MouseDown(e,t){this.vs.push(new a.NVector3(this.MapX(e),this.MapY(t)))}MouseDoubleClick(){}MapX(e){return a.MathUtility.Remap(e,0,this.width,-1,1)}MapY(e){return a.MathUtility.Remap(e,0,this.height,1,-1)}Grid(e){}RenderIndependentCanvas(e){if(this.Grid(e),e.fillStyle="#000000",e.beginPath(),e.rect(0,0,e.canvas.width,e.canvas.height),e.closePath(),e.fill(),(2&this.t)==0){let e=this.vsTemp.pop();e&&this.vs.push(e)}if(this.vs.length>1){let t=[],i=[];for(let e=0;e<this.vs.length;++e)t.push(this.vs[e].x),i.push(this.vs[e].y);this.tfLinearRegression.train(t,i),this.RenderLine(e)}e.fillStyle="#00ff00";for(let t=0;t<this.vs.length;++t)e.beginPath(),e.arc(a.MathUtility.Remap(this.vs[t].x,-1,1,0,this.width),a.MathUtility.Remap(this.vs[t].y,-1,1,this.height,0),5,0,2*Math.PI),e.closePath(),e.fill();this.t+=.3}RenderLine(e){let t=[];for(let e=-1;e<=1;e+=.05)t.push(e);let i=s.tidy(()=>this.tfLinearRegression.predict2d(s.tensor1d(t))),n=i.dataSync();i.dispose(),e.lineWidth=3,e.strokeStyle="#00fff0",e.beginPath(),e.moveTo(a.MathUtility.Remap(t[0],-1,1,0,this.width),a.MathUtility.Remap(n[0],-1,1,this.height,0));for(let i=1;i<t.length;++i)e.lineTo(a.MathUtility.Remap(t[i],-1,1,0,this.width),a.MathUtility.Remap(n[i],-1,1,this.height,0));e.stroke()}constructor(e){super(e),this.xpos=100,this.ypos=100,this.xspeed=10,this.yspeed=10,this.xdirection=1,this.ydirection=1,this.rad=50,this.vs=[],this.vsTemp=[],this.selVec=void 0,this.t=0,this.indeCanvas.title="TF LinearRegression GradientDescent 01",this.Init(),this.InitData(),this.InitUI()}}class d{predict1d(e){return e.mul(this.weights[0]).add(this.bias)}predict2d(e){return e.square().mul(this.weights[1]).add(e.mul(this.weights[0])).add(this.bias)}predict3d(e){return e.pow(s.scalar(3)).mul(this.weights[2]).add(e.square().mul(this.weights[1])).add(e.mul(this.weights[0])).add(this.bias)}predict4d(e){return e.pow(s.scalar(4)).mul(this.weights[3]).add(e.pow(s.scalar(3)).mul(this.weights[2])).add(e.square().mul(this.weights[1])).add(e.mul(this.weights[0])).add(this.bias)}predict5d(e){return e.pow(s.scalar(5)).mul(this.weights[4]).add(e.pow(s.scalar(4)).mul(this.weights[3])).add(e.pow(s.scalar(3)).mul(this.weights[2])).add(e.square().mul(this.weights[1])).add(e.mul(this.weights[0])).add(this.bias)}predict(e){return 5===this.dim?this.predict5d(e):4===this.dim?this.predict4d(e):3===this.dim?this.predict3d(e):2===this.dim?this.predict2d(e):this.predict1d(e)}loss(e,t){return e.sub(t).square().mean()}train(e,t){s.tidy(()=>{let i=s.tensor1d(e),n=s.tensor1d(t);this.optimizer.minimize(()=>this.loss(this.predict(i),n))}),console.log(s.memory().numTensors)}constructor(){this.weights=[],this.dim=1,this.leraningRate=.2;for(let e=0;e<5;++e){let e=s.variable(s.scalar(2*Math.random()-1));e.print(),this.weights.push(e)}this.bias=s.variable(s.scalar(2*Math.random()-1)),this.optimizer=s.train.adam(this.leraningRate)}}},99473:function(e,t,i){i.r(t),i.d(t,{ACTION_TYPE:function(){return s.KW},ACTIVECOMMAND_MODE:function(){return s.AG},ActiveCommandBase:function(){return s.wm},AppAccessibility:function(){return s.Wv},AppProperties:function(){return s.gj},ArrayUtility:function(){return s.R3},BrowserUtility:function(){return s.R7},CLICK_TYPE:function(){return s.uh},CLOGTYPE:function(){return s.g6},COMPILE_MODE:function(){return s.Iq},ColorUtility:function(){return s.mK},Deltatime:function(){return s.gk},EVENT_LISTENER_TYPE:function(){return s.GZ},FHTYPE:function(){return s.OH},GTYPE:function(){return s.OB},GeometryBase:function(){return s.bx},INTERACTION_MODE:function(){return s.WU},LINECAP:function(){return s.EQ},MathUtility:function(){return s.$H},NDataUtility:function(){return s.eu},NUI:function(){return s.Fc},NVector3:function(){return s.h9},NumericalMotion:function(){return s.aX},OPTIMIZER:function(){return s.sg},PRESS_TYPE:function(){return s.dc},TEXTALIGN:function(){return s.mH},TEXTBOX:function(){return s.SE},TOUCH_TYPE:function(){return s.KV},UNIT:function(){return s.iI}});var s=i(8483)}}]);