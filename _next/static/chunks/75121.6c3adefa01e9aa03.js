"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[75121],{75121:function(t,r,e){var s,n;e.r(r),e.d(r,{AppCanvasTemplate:function(){return d},Solution:function(){return f}});class i{static times(t,r){return new i(t*r.x,t*r.y,t*r.z)}static minus(t,r){return new i(t.x-r.x,t.y-r.y,t.z-r.z)}static plus(t,r){return new i(t.x+r.x,t.y+r.y,t.z+r.z)}static dot(t,r){return t.x*r.x+t.y*r.y+t.z*r.z}static mag(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)}static norm(t){var r=i.mag(t);return i.times(0===r?1/0:1/r,t)}static cross(t,r){return new i(t.y*r.z-t.z*r.y,t.z*r.x-t.x*r.z,t.x*r.y-t.y*r.x)}constructor(t,r,e){this.x=t,this.y=r,this.z=e}}class o{static scale(t,r){return new o(t*r.r,t*r.g,t*r.b)}static plus(t,r){return new o(t.r+r.r,t.g+r.g,t.b+r.b)}static times(t,r){return new o(t.r*r.r,t.g*r.g,t.b*r.b)}static toDrawingColor(t){var r=t=>t>1?1:t;return[Math.floor(255*r(t.r)),Math.floor(255*r(t.g)),Math.floor(255*r(t.b))]}constructor(t,r,e){this.r=t,this.g=r,this.b=e}}o.white=new o(1,1,1),o.grey=new o(.5,.5,.5),o.black=new o(.05,.05,.05),o.background=o.black,o.defaultColor=o.black;class a{constructor(t,r){this.pos=t;var e=new i(0,-1,0);this.forward=i.norm(i.minus(r,this.pos)),this.right=i.times(1.5,i.norm(i.cross(this.forward,e))),this.up=i.times(1.5,i.norm(i.cross(this.forward,this.right)))}}class c{constructor(t){!function(t){let r=document.getElementById(t),e=document.createElement("canvas");e.width=512,e.height=512,r.append(e);let n=e.getContext("2d");new h().render({things:[new l(new i(0,1,0),0,s.checkerboard),new u(new i(0,1,-.25),1,s.shiny),new u(new i(-6,3,-5),1,s.shiny),new u(new i(-6,8,15),5,s.shiny),new u(new i(-1,.5,1.5),.5,s.shiny)],lights:[{pos:new i(-2,2.5,0),color:new o(1,1,1)},{pos:new i(0,3.5,0),color:new o(.21,.21,.35)}],camera:new a(new i(3,2,4),new i(-1,.5,0))},n,512,512)}(t)}}(n=s||(s={})).shiny={diffuse:function(t){return o.white},specular:function(t){return o.grey},reflect:function(t){return 0},roughness:250},n.checkerboard={diffuse:function(t){return(Math.floor(t.z)+Math.floor(t.x))%2!=0?o.white:o.black},specular:function(t){return o.white},reflect:function(t){return(Math.floor(t.z)+Math.floor(t.x))%2!=0?.1:.7},roughness:150};class u{intersect(t){var r=i.minus(this.center,t.start),e=i.dot(r,t.dir),s=0;if(e>=0){var n=this.radius2-(i.dot(r,r)-e*e);n>=0&&(s=e-Math.sqrt(n))}return 0===s?null:{thing:this,ray:t,dist:s}}normal(t){return i.norm(i.minus(t,this.center))}constructor(t,r,e){this.center=t,this.surface=e,this.radius2=r*r}}class l{constructor(t,r,e){this.surface=e,this.normal=function(r){return t},this.intersect=e=>{var s=i.dot(t,e.dir);if(!(s>0)){var n=-((i.dot(t,e.start)+r)/s);return{thing:this,ray:e,dist:n}}}}}class h{intersections(t,r){let e,s=Infinity;for(let n in r.things){let i=r.things[n].intersect(t);null!=i&&i.dist<s&&(e=i,s=i.dist)}return e}testRay(t,r){let e=this.intersections(t,r);if(void 0!==e)return e.dist}traceRay(t,r,e){let s=this.intersections(t,r);return void 0===s?o.background:this.shade(s,r,e)}shade(t,r,e){var s=t.ray.dir,n=i.plus(i.times(t.dist,s),t.ray.start),a=t.thing.normal(n),c=i.minus(s,i.times(2,i.times(i.dot(a,s),a))),u=o.plus(o.background,this.getNaturalColor(t.thing,n,a,c,r)),l=e>=this.maxDepth?o.grey:this.getReflectionColor(t.thing,n,a,c,r,e);return o.plus(u,l)}getReflectionColor(t,r,e,s,n,i){return o.scale(t.surface.reflect(r),this.traceRay({start:r,dir:s},n,i+1))}getNaturalColor(t,r,e,s,n){return n.lights.reduce((a,c)=>{let u=i.minus(c.pos,r),l=i.norm(u),h=this.testRay({start:r,dir:l},n);if(void 0!==h&&h<=i.mag(u))return a;{let n=i.dot(l,e),u=n>0?o.scale(n,c.color):o.defaultColor,h=i.dot(l,i.norm(s)),d=h>0?o.scale(Math.pow(h,t.surface.roughness),c.color):o.defaultColor;return o.plus(a,o.plus(o.times(t.surface.diffuse(r),u),o.times(t.surface.specular(r),d)))}},o.defaultColor)}render(t,r,e,s){for(var n=(t,r,n)=>i.norm(i.plus(n.forward,i.plus(i.times((t-e/2)/2/e,n.right),i.times(-(r-s/2)/2/s,n.up)))),a=0;a<s;a++)for(var c=0;c<e;c++){var u=this.traceRay({start:t.camera.pos,dir:n(c,a,t.camera)},t,0),l=o.toDrawingColor(u);r.fillStyle="rgb("+String(l[0])+", "+String(l[1])+", "+String(l[2])+")",r.fillRect(c,a,c+1,a+1)}}constructor(){this.maxDepth=100}}class d{static Init(t){new d(t).Dummy()}Dummy(){}constructor(t="SandBox"){this.implementation=new c(t),console.log("AppCanvasTemplate 1000")}}class f{destroy(){if(this.divHost)try{for(;this.divHost.firstChild;)this.divHost.removeChild(this.divHost.firstChild)}catch(t){console.error("Error in destroy method:",t)}else console.warn("divHost is undefined in destroy method")}constructor(t){this.divHost=document.getElementById(t),d.Init(t)}}}}]);