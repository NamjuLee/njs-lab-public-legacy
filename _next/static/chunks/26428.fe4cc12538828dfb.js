(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26428],{75410:function(){},48628:function(){},31601:function(){},67792:function(){},34977:function(){},75042:function(){},73628:function(e,a,s){"use strict";s.r(a),s.d(a,{Solution:function(){return n}});var t=s(88405),r=s(1616);s(53844);class n{destroy(){}constructor(e){i()}}let i=async()=>{let e=await l();o(e);let a=await c(e),s=u();await p(s,a.inputs,a.labels),d(s,e,a)},l=async()=>{let e=await fetch("https://storage.googleapis.com/tfjs-tutorials/carsData.json");return(await e.json()).map(e=>({mpg:e.Miles_per_Gallon,horsepower:e.Horsepower})).filter(e=>null!=e.mpg&&null!=e.horsepower)},o=async e=>{let a=e.map(e=>({x:e.horsepower,y:e.mpg}));r.render.scatterplot({name:"Horsepower v MPG"},{values:a},{xLabel:"Horsepower",yLabel:"MPG",height:300})},u=()=>{let e=t.sequential();return e.add(t.layers.dense({inputShape:[1],units:1,useBias:!0})),e.add(t.layers.dense({units:1,useBias:!0})),e},c=async e=>t.tidy(()=>{t.util.shuffle(e);let a=e.map(e=>e.horsepower),s=e.map(e=>e.mpg),r=t.tensor2d(a,[a.length,1]),n=t.tensor2d(s,[s.length,1]),i=r.max(),l=r.min(),o=n.max(),u=n.min();return{inputs:r.sub(l).div(i.sub(l)),labels:n.sub(u).div(o.sub(u)),inputMax:i,inputMin:l,labelMax:o,labelMin:u}}),p=async(e,a,s)=>(e.compile({optimizer:t.train.adam(),loss:t.losses.meanSquaredError,metrics:["mse"]}),await e.fit(a,s,{batchSize:32,epochs:30,shuffle:!0,callbacks:r.show.fitCallbacks({name:"Training Performance"},["loss","mse"],{height:200,callbacks:["onEpochEnd"]})})),d=(e,a,s)=>{let{inputMax:n,inputMin:i,labelMin:l,labelMax:o}=s,[u,c]=t.tidy(()=>{let a=t.linspace(0,1,100),s=e.predict(a.reshape([100,1])),r=a.mul(n.sub(i)).add(i),u=s.mul(o.sub(l)).add(l);return[r.dataSync(),u.dataSync()]}),p=Array.from(u).map((e,a)=>({x:e,y:c[a]})),d=a.map(e=>({x:e.horsepower,y:e.mpg}));r.render.scatterplot({name:"Model Predictions vs Original Data"},{values:[d,p],series:["original","predicted"]},{xLabel:"Horsepower",yLabel:"MPG",height:300})}}}]);