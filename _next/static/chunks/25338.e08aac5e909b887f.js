"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[25338],{8039:function(e){e.exports='export default "#define GLSLIFY 1\\nstruct TransformData {\\n    model: mat4x4<f32>,\\n    view: mat4x4<f32>,\\n    projection: mat4x4<f32>,\\n};\\n@binding(0) @group(0) var<uniform> transformUBO: TransformData;\\n\\nstruct Fragment {\\n    @builtin(position) Position : vec4<f32>,\\n    @location(0) Color : vec4<f32>\\n};\\n\\n@vertex\\nfn vs_main(@location(0) vertexPostion: vec3<f32>, @location(1) vertexColor: vec3<f32>) -> Fragment {\\n\\n    var output : Fragment;\\n    output.Position = transformUBO.projection * transformUBO.view * transformUBO.model * vec4<f32>(vertexPostion, 1.0);\\n    output.Color = vec4<f32>(vertexColor, 1.0);\\n\\n    return output;\\n}\\n\\n@fragment\\nfn fs_main(@location(0) Color: vec4<f32>) -> @location(0) vec4<f32> {\\n    return Color;\\n}";'},25338:function(e,t,i){i.r(t),i.d(t,{App:function(){return b},Solution:function(){return P}});class s{init(){this.appendEvent()}appendEvent(){this.app.renderer.canvas.addEventListener("drag",e=>{},!1),this.app.renderer.canvas.addEventListener("click",e=>{},!1),this.app.renderer.canvas.addEventListener("dblclick",e=>{},!1),this.app.renderer.canvas.addEventListener("drag",e=>{},!0),this.app.renderer.canvas.addEventListener("mouseup",e=>{},!1),this.app.renderer.canvas.addEventListener("mousedown",e=>{this.isDown=!0,this.pos[0]=e.offsetX,this.pos[1]=e.offsetY},!1),this.app.renderer.canvas.addEventListener("mouseup",e=>{this.isDown=!1},!1),this.app.renderer.canvas.addEventListener("mousemove",e=>{if(this.isDown){let t=this.pos[0]-e.offsetX,i=this.pos[1]-e.offsetY;this.app.renderer.cameraController.arcRotation(t,i),this.pos[0]=e.offsetX,this.pos[1]=e.offsetY}},!1),this.app.renderer.canvas.addEventListener("wheel",e=>{this.app.renderer.cameraController.zoomWheel(e.deltaY)},!1)}constructor(e){this.pos=[0,0],this.isDown=!1,this.app=e}}var r,a,n=i(81519),o=i(49644),h=i(50023);class c{zoomWheel(e){this.distance+=.01*e,this.arcRotation(0,0)}update(){this.camera.update(),l(this.modelMatrix,this.translation,this.rotation),n.Jp(this.mvpMatrix,this.camera.viewProjectionMatrix,this.modelMatrix)}rotateZ(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.rotation[2]+=e,this.update()}translateX(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.translation[0]+=e,this.update()}get getMatrix(){return this.mvpMatrix}arcRotation(e,t){e*=.01,t*=.01,this.angleXY-=e,this.angleZ-=t,this.camera.eye[0]=this.camera.center[0]+Math.sin(this.angleXY)*Math.cos(this.angleZ)*this.distance,this.camera.eye[1]=this.camera.center[1]+Math.cos(this.angleXY)*Math.cos(this.angleZ)*this.distance,this.camera.eye[2]=this.camera.center[2]+Math.sin(this.angleZ)*this.distance,this.update()}constructor(e){this.modelMatrix=n.Ue(),this.mvpMatrix=n.Ue(),this.rotation=o.al(0,0,0),this.translation=o.al(0,0,0),this.screen2=h.al(0,0),this.angleXY=2.5,this.angleZ=.6,this.distance=5,this.solution=e,this.canvas=e.canvas;let t=o.al(2.6451475620269775,-3.130298137664795,2.864337205886841),i=o.al(0,0,0),s=o.al(0,0,1);this.camera=new d(this.canvas.width/this.canvas.height,t,i,s),this.update()}}class d{update(){n.zB(this.viewMatrix,this.eye,this.center,this.up),n.Jp(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix)}constructor(e=1,t=[2,2,4],i=[0,0,0],s=[0,1,0]){this.viewMatrix=n.Ue(),this.projectionMatrix=n.Ue(),this.viewProjectionMatrix=n.Ue(),this.zoomMax=100,this.zoomSpeed=2,this.near=.01,this.far=1e4,this.mvpMatrix=n.Ue(),this.eye=o.al(2.6451475620269775,-3.130298137664795,2.864337205886841),this.center=o.al(0,0,0),this.up=o.al(0,1,0),this.eye=t,this.center=i,this.up=s,n.G3(this.projectionMatrix,2*Math.PI/5,e,this.near,this.far),this.update()}}let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],r=n.Ue(),a=n.Ue(),o=n.Ue(),h=n.Ue(),c=n.Ue();n.vc(h,t),n.aC(r,i[0]),n.gT(a,i[1]),n.QO(o,i[2]),n.xJ(c,s),n.Jp(e,r,c),n.Jp(e,a,e),n.Jp(e,o,e),n.Jp(e,h,e)};(r=a||(a={})).PointList="point-list",r.LineList="line-list",r.LineStrip="line-strip",r.TriangleList="triangle-list",r.TriangleStrip="triangle-strip";class p{async initWebGPU(){if(!navigator.gpu)throw Error("Not Support WebGPU");let e=await navigator.gpu.requestAdapter({powerPreference:"high-performance"});if(!e)throw Error("No Adapter Found");let t=await e.requestDevice();this.ctx=this.renderer.canvas.getContext("webgpu"),this.format="bgra8unorm",this.ctx.configure({device:t,format:this.format,alphaMode:"opaque"}),this.device=t}destroy(){this.device.destroy()}constructor(e){this.PrimitiveTopology=a,this.renderer=e}}class u{async init(){await this.webGPU.initWebGPU(),this.cameraController=new c(this),this.requestAni=requestAnimationFrame(this.loop)}drawing(){this.app.scene.render()}destroy(){for(this.webGPU.destroy(),cancelAnimationFrame(this.requestAni);this.app.divHost.lastElementChild;)this.app.divHost.removeChild(this.app.divHost.lastElementChild)}constructor(e){this.isAnimation=!0,this.loop=()=>{this.isAnimation&&(this.requestAni=requestAnimationFrame(this.loop)),this.drawing()},this.app=e,this.canvas=document.createElement("canvas"),this.canvas.width=this.app.divHost.clientWidth,this.canvas.height=this.app.divHost.clientHeight,this.app.divHost.appendChild(this.canvas),this.canvas.addEventListener("resize",()=>{}),this.webGPU=new p(this)}}let f=async e=>fetch("".concat(e)).then(e=>e.text()).catch(e=>{console.debug(e)});class v{async initPipeline(){}update(){}render(){}constructor(e){this.scene=e,this.webGPU=e.app.renderer.webGPU,this.scene.objects.push(this)}}let m=i(8039);class w extends v{async initPipeline(){this.uniformBuffer=this.webGPU.device.createBuffer({size:192,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});let e=this.webGPU.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{}}]});this.bindGroup=this.webGPU.device.createBindGroup({layout:e,entries:[{binding:0,resource:{buffer:this.uniformBuffer}}]});let t=this.webGPU.device.createPipelineLayout({bindGroupLayouts:[e]}),i=await f(m);this.pipeline=this.webGPU.device.createRenderPipeline({vertex:{module:this.webGPU.device.createShaderModule({code:i}),entryPoint:"vs_main",buffers:[this.bufferLayout]},fragment:{module:this.webGPU.device.createShaderModule({code:i}),entryPoint:"fs_main",targets:[{format:this.webGPU.format}]},primitive:{topology:"triangle-list"},layout:t}),this.isRenderable=!0}render(){if(!this.isRenderable)return;this.t+=.01,this.t;let e=n.Ue(),t=this.webGPU.renderer.canvas.width/this.webGPU.renderer.canvas.height;n.G3(e,Math.PI/4,t,.1,10);let i=n.Ue(),s=o.al(-2,0,2),r=o.al(0,0,0),a=o.al(0,0,1);n.zB(i,s,r,a);let h=n.Ue();n.Iu(h,h,[Math.sin(this.t),0,0]),e=this.webGPU.renderer.cameraController.camera.projectionMatrix,i=this.webGPU.renderer.cameraController.camera.viewMatrix,this.webGPU.device.queue.writeBuffer(this.uniformBuffer,0,h),this.webGPU.device.queue.writeBuffer(this.uniformBuffer,64,i),this.webGPU.device.queue.writeBuffer(this.uniformBuffer,128,e);let c=this.webGPU.device.createCommandEncoder(),d=this.webGPU.ctx.getCurrentTexture().createView(),l=c.beginRenderPass({colorAttachments:[{view:d,clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]});l.setPipeline(this.pipeline),l.setVertexBuffer(0,this.buffer),l.setBindGroup(0,this.bindGroup),l.draw(3,1,0,0),l.end(),this.webGPU.device.queue.submit([c.finish()])}constructor(e){super(e),this.t=0,this.isRenderable=!1;let t=new Float32Array([0,0,1.5,1,0,0,0,-1.5,-1.5,0,1,0,0,1.5,-1.5,0,0,1]),i=GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST,s={size:t.byteLength,usage:i,mappedAtCreation:!0};this.buffer=this.webGPU.device.createBuffer(s),new Float32Array(this.buffer.getMappedRange()).set(t),this.buffer.unmap(),this.bufferLayout={arrayStride:24,attributes:[{shaderLocation:0,format:"float32x3",offset:0},{shaderLocation:1,format:"float32x3",offset:12}]},this.initPipeline()}}class g{async init(){new w(this)}render(){for(let e=0;e<this.objects.length;++e)this.objects[e].update(),this.objects[e].render();this.t,this.t+=.1}constructor(e){this.objects=[],this.t=0,this.app=e}}class b{async init(){this.controller.init(),await this.renderer.init(),await this.scene.init()}destroy(){for(this.renderer.destroy();this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}constructor(e){this.divHost=document.getElementById(e),this.renderer=new u(this),this.controller=new s(this),this.scene=new g(this),this.init()}}class P{destroy(){this.app.destroy()}constructor(e){this.app=new b(e)}}}}]);