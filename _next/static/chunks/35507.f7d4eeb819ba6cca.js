"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[35507,3955,99473],{3955:function(t,e,i){i.r(e),i.d(e,{DefinitionIndeCanvasCore:function(){return n}});var s=i(79309);class n{InitIndeCanvas(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:650,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:350;this.scene.implementation.app.needUI?this.indeCanvas=new s.D(this.scene.implementation.app.viewController.NUIWrapper.NUI.independentPanelWrapper,50,50,t,e,!0):this.indeCanvas=new s.D(this.scene.implementation.app.viewController.NUIWrapper.NUI.independentPanelWrapper,1,-25,t,e,!0),this.indeCanvas.title="TF Env",this.indeCanvas.btnHam.isHidden=!0,this.indeCanvas.btnMini.isHidden=!0,this.indeCanvas.RenderIndependentCanvas=t=>this.RenderIndependentCanvas(t)}get width(){return this.indeCanvas.canvas.width}get height(){return this.indeCanvas.canvas.height}Init(t){}RenderIndependentCanvas(t){}MouseMove(t,e){}MouseMovePre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseMove(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseDown(t,e){}MouseDownPre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseDown(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseUp(t,e){}MouseUpPre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseUp(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseDrag(t,e){}MouseDragPre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseDrag(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseLeftClick(t,e){}MouseLeftClickPre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseLeftClick(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseMiddleClick(t,e){}MouseMiddleClickPre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseMiddleClick(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseRightClick(t,e){}MouseRightClickPre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseRightClick(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseDoubleClick(t,e){}MouseDoubleClickPre(t,e){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseDoubleClick(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY)}MouseWheel(t,e,i){}MouseWheelPre(t,e,i){this.indeCanvas.IsMouseInsidePanel(t,e)&&this.MouseWheel(t-this.indeCanvas.vec.x+this.mOffX,e-this.indeCanvas.vec.y-this.indeCanvas.HeadHeight+this.mOffY,i)}constructor(t,e=650,i=350){this.mOffX=-12,this.mOffY=-12,this.scene=t,this.scene.definitions.push(this),this.InitIndeCanvas(e,i)}}},35507:function(t,e,i){i.r(e),i.d(e,{IMAGE_H:function(){return l},IMAGE_W:function(){return d},MnistData:function(){return c},TFMnist:function(){return r}});var s=i(88405),n=i(3955),a=i(99473),h=i(49738);class r extends n.DefinitionIndeCanvasCore{Init(){this.tfLinearRegression.push(new o(1)),this.tfLinearRegression.push(new o(2)),this.tfLinearRegression.push(new o(3)),this.tfLinearRegression.push(new o(4)),this.indeCanvas.canvas.style.zIndex="-1",h.TFDataUtility.getData().then(t=>{}),console.log(new c().getTrainData())}InitUI(){let t=document.createElement("div");t.style.position="absolute",t.style.left="40px",t.style.color="#ffffff";let e=document.createElement("p");e.textContent="click on this screen to add data",t.append(e),(e=document.createElement("p")).textContent="LinearRegression",e.style.marginTop="0px",e.style.marginBottom="0px",e.style.color=this.col[0],t.append(e),(e=document.createElement("p")).style.marginTop="0px",e.style.marginBottom="0px",e.style.color=this.col[1],e.textContent="Degree of polynomial - 2",t.append(e),(e=document.createElement("p")).style.marginTop="0px",e.style.marginBottom="0px",e.style.color=this.col[2],e.textContent="Degree of polynomial - 3",t.append(e),(e=document.createElement("p")).style.marginTop="0px",e.style.marginBottom="0px",e.style.color=this.col[3],e.textContent="Degree of polynomial - 4",t.append(e);let i=document.getElementById("indePanel");i&&i.append(t)}MouseDown(t,e){let i=new a.NVector3(this.MapX(t),this.MapY(e));for(let t=0;t<this.vs.length;++t)if(.05>a.NVector3.Distance(i,this.vs[t])){this.selVec=this.vs[t];return}this.vs.push(new a.NVector3(this.MapX(t),this.MapY(e)))}MouseDoubleClick(){}MouseMove(t,e){let i;let s=new a.NVector3(this.MapX(t),this.MapY(e));for(let t=0;t<this.vs.length;++t).05>a.NVector3.Distance(s,this.vs[t])&&(i=this.vs[t]);i?this.selVec=i:this.selVec=void 0}MouseDrag(t,e){this.selVec&&(this.selVec.x=this.MapX(t),this.selVec.y=this.MapY(e))}MouseUp(){this.selVec=void 0}MapX(t){return a.MathUtility.Remap(t,0,this.width,-1,1)}MapY(t){return a.MathUtility.Remap(t,0,this.height,1,-1)}GridLine(t){t.strokeStyle="#555555";let e=this.width/20-1,i=this.height/20-1;for(let s=0;s<20;s+=1){10===s?t.lineWidth=3:t.lineWidth=1;let n=e*s,a=0,h=n,r=this.height;t.beginPath(),t.moveTo(n,a),t.lineTo(h,r),t.stroke(),n=0,a=i*s,h=this.width,r=a,t.beginPath(),t.moveTo(n,a),t.lineTo(h,r),t.stroke()}}RenderIndependentCanvas(t){if(t.fillStyle="#000000",t.beginPath(),t.rect(0,0,t.canvas.width,t.canvas.height),t.closePath(),t.fill(),this.GridLine(t),this.vs.length>1)for(let e=0;e<this.tfLinearRegression.length;++e){let i=[],s=[];for(let t=0;t<this.vs.length;++t)i.push(this.vs[t].x),s.push(this.vs[t].y);this.tfLinearRegression[e].train(i,s),this.RenderLine(t)}t.fillStyle="#00ff00";for(let e=0;e<this.vs.length;++e)t.beginPath(),t.arc(a.MathUtility.Remap(this.vs[e].x,-1,1,0,this.width),a.MathUtility.Remap(this.vs[e].y,-1,1,this.height,0),5,0,2*Math.PI),t.closePath(),t.fill();this.selVec&&(t.fillStyle="#ffffff",t.font="15px Arial",t.textAlign="center",t.fillText("x:".concat(this.selVec.x.toFixed(3),", y").concat(this.selVec.y.toFixed(3)),a.MathUtility.Remap(this.selVec.x,-1,1,0,this.width),a.MathUtility.Remap(this.selVec.y,-1,1,this.height,0)-9))}RenderLine(t){for(let e=0;e<this.tfLinearRegression.length;++e){let i=[];for(let t=-1;t<=1;t+=.08)i.push(t);let n=s.tidy(()=>this.tfLinearRegression[e].predict(s.tensor1d(i))),h=n.dataSync();n.dispose(),t.lineWidth=1,t.strokeStyle=this.col[e],t.beginPath(),t.moveTo(a.MathUtility.Remap(i[0],-1,1,0,this.width),a.MathUtility.Remap(h[0],-1,1,this.height,0));for(let e=1;e<i.length;++e)t.lineTo(a.MathUtility.Remap(i[e],-1,1,0,this.width),a.MathUtility.Remap(h[e],-1,1,this.height,0));t.stroke()}}constructor(t,e=650,i=350){super(t,e,i),this.xpos=100,this.ypos=100,this.xspeed=10,this.yspeed=10,this.xdirection=1,this.ydirection=1,this.rad=50,this.vs=[],this.selVec=void 0,this.col=["#ff0000","#00ff00","#0000ff","#00fff0","#ff0000","#fff000","#0fff00"],this.tfLinearRegression=[],this.indeCanvas.title="TF MNist ",this.Init(),this.InitUI()}}class o{predict1d(t){return t.mul(this.weights[0]).add(this.bias)}predict2d(t){return t.square().mul(this.weights[1]).add(t.mul(this.weights[0])).add(this.bias)}predict3d(t){return t.pow(s.scalar(3)).mul(this.weights[2]).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict4d(t){return t.pow(s.scalar(4)).mul(this.weights[3]).add(t.pow(s.scalar(3)).mul(this.weights[2])).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict5d(t){return t.pow(s.scalar(5)).mul(this.weights[4]).add(t.pow(s.scalar(4)).mul(this.weights[3])).add(t.pow(s.scalar(3)).mul(this.weights[2])).add(t.square().mul(this.weights[1])).add(t.mul(this.weights[0])).add(this.bias)}predict(t){return 5===this.dim?this.predict5d(t):4===this.dim?this.predict4d(t):3===this.dim?this.predict3d(t):2===this.dim?this.predict2d(t):(this.dim,this.predict1d(t))}loss(t,e){return t.sub(e).square().mean()}train(t,e){s.tidy(()=>{let i=s.tensor1d(t),n=s.tensor1d(e);this.optimizer.minimize(()=>this.loss(this.predict(i),n))})}constructor(t=0){this.weights=[],this.dim=3,this.leraningRate=.2,this.dim=t;for(let t=0;t<5;++t){let t=s.variable(s.scalar(2*Math.random()-1));t.print(),this.weights.push(t)}this.bias=s.variable(s.scalar(2*Math.random()-1)),this.optimizer=s.train.adam(this.leraningRate)}}let l=28,d=28;class c{async load(){let t=new Image,e=document.createElement("canvas"),i=e.getContext("2d"),s=new Promise((s,n)=>{t.crossOrigin="",t.onload=()=>{t.width=t.naturalWidth,t.height=t.naturalHeight;let n=new ArrayBuffer(20384e4);e.width=t.width,e.height=5e3;for(let s=0;s<13;s++){let a=new Float32Array(n,1568e4*s,392e4);i.drawImage(t,0,5e3*s,t.width,5e3,0,0,t.width,5e3);let h=i.getImageData(0,0,e.width,e.height);for(let t=0;t<h.data.length/4;t++)a[t]=h.data[4*t]/255}this.datasetImages=new Float32Array(n),s()},t.src="https://storage.googleapis.com/learnjs-data/model-builder/mnist_images.png"}),n=fetch("https://storage.googleapis.com/learnjs-data/model-builder/mnist_labels_uint8"),a=(await Promise.all([s,n]))[1];this.datasetLabels=new Uint8Array(await a.arrayBuffer()),this.trainImages=this.datasetImages.slice(0,4312e4),this.testImages=this.datasetImages.slice(4312e4),this.trainLabels=this.datasetLabels.slice(0,55e4),this.testLabels=this.datasetLabels.slice(55e4)}getTrainData(){return{xs:s.tensor4d(this.trainImages,[this.trainImages.length/784,l,d,1]),labels:s.tensor2d(this.trainLabels,[this.trainLabels.length/10,10])}}getTestData(t){let e=s.tensor4d(this.testImages,[this.testImages.length/784,l,d,1]),i=s.tensor2d(this.testLabels,[this.testLabels.length/10,10]);return null!=t&&(e=e.slice([0,0,0,0],[t,l,d,1]),i=i.slice([0,0],[t,10])),{xs:e,labels:i}}constructor(){}}},99473:function(t,e,i){i.r(e),i.d(e,{ACTION_TYPE:function(){return s.KW},ACTIVECOMMAND_MODE:function(){return s.AG},ActiveCommandBase:function(){return s.wm},AppAccessibility:function(){return s.Wv},AppProperties:function(){return s.gj},ArrayUtility:function(){return s.R3},BrowserUtility:function(){return s.R7},CLICK_TYPE:function(){return s.uh},CLOGTYPE:function(){return s.g6},COMPILE_MODE:function(){return s.Iq},ColorUtility:function(){return s.mK},Deltatime:function(){return s.gk},EVENT_LISTENER_TYPE:function(){return s.GZ},FHTYPE:function(){return s.OH},GTYPE:function(){return s.OB},GeometryBase:function(){return s.bx},INTERACTION_MODE:function(){return s.WU},LINECAP:function(){return s.EQ},MathUtility:function(){return s.$H},NDataUtility:function(){return s.eu},NUI:function(){return s.Fc},NVector3:function(){return s.h9},NumericalMotion:function(){return s.aX},OPTIMIZER:function(){return s.sg},PRESS_TYPE:function(){return s.dc},TEXTALIGN:function(){return s.mH},TEXTBOX:function(){return s.SE},TOUCH_TYPE:function(){return s.KV},UNIT:function(){return s.iI}});var s=i(8483)}}]);