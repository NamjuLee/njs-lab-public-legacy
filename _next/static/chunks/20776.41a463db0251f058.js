(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[20776],{72888:function(t,e,r){var i,n=r(20357);i=function(){"use strict";var t=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function e(t,e){return t>e?1:t<e?-1:0}function r(e,r,i){for(var n=new t(null,null),o=n,l=n;;){var s=i(e,r.key);if(s<0){if(null===r.left)break;if(0>i(e,r.left.key)){var h=r.left;if(r.left=h.right,h.right=r,null===(r=h).left)break}l.left=r,l=r,r=r.left}else if(s>0){if(null===r.right)break;if(i(e,r.right.key)>0){var h=r.right;if(r.right=h.left,h.left=r,null===(r=h).right)break}o.right=r,o=r,r=r.right}else break}return o.right=r.left,l.left=r.right,r.left=n.right,r.right=n.left,r}function i(e,i,n,o){var l=new t(e,i);if(null===n)return l.left=l.right=null,l;n=r(e,n,o);var s=o(e,n.key);return s<0?(l.left=n.left,l.right=n,n.left=null):s>=0&&(l.right=n.right,l.left=n,n.right=null),l}function o(t,e,i){var n=null,o=null;if(e){e=r(t,e,i);var l=i(e.key,t);0===l?(n=e.left,o=e.right):l<0?(o=e.right,e.right=null,n=e):(n=e.left,e.left=null,o=e)}return{left:n,right:o}}var l=function(){function n(t){void 0===t&&(t=e),this._root=null,this._size=0,this._comparator=t}return n.prototype.insert=function(t,e){return this._size++,this._root=i(t,e,this._root,this._comparator)},n.prototype.add=function(e,i){var n=new t(e,i);null===this._root&&(n.left=n.right=null,this._size++,this._root=n);var o=this._comparator,l=r(e,this._root,o),s=o(e,l.key);return 0===s?this._root=l:(s<0?(n.left=l.left,n.right=l,l.left=null):s>0&&(n.right=l.right,n.left=l,l.right=null),this._size++,this._root=n),this._root},n.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},n.prototype._remove=function(t,e,i){var n;return null===e?null:(e=r(t,e,i),0===i(t,e.key))?(null===e.left?n=e.right:(n=r(t,e.left,i)).right=e.right,this._size--,n):e},n.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=r(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},n.prototype.findStatic=function(t){for(var e=this._root,r=this._comparator;e;){var i=r(t,e.key);if(0===i)return e;e=i<0?e.left:e.right}return null},n.prototype.find=function(t){return this._root&&(this._root=r(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},n.prototype.contains=function(t){for(var e=this._root,r=this._comparator;e;){var i=r(t,e.key);if(0===i)return!0;e=i<0?e.left:e.right}return!1},n.prototype.forEach=function(t,e){for(var r=this._root,i=[],n=!1;!n;)null!==r?(i.push(r),r=r.left):0!==i.length?(r=i.pop(),t.call(e,r),r=r.right):n=!0;return this},n.prototype.range=function(t,e,r,i){for(var n=[],o=this._comparator,l=this._root;0!==n.length||l;)if(l)n.push(l),l=l.left;else{if(o((l=n.pop()).key,e)>0)break;if(o(l.key,t)>=0&&r.call(i,l))return this;l=l.right}return this},n.prototype.keys=function(){var t=[];return this.forEach(function(e){var r=e.key;return t.push(r)}),t},n.prototype.values=function(){var t=[];return this.forEach(function(e){var r=e.data;return t.push(r)}),t},n.prototype.min=function(){return this._root?this.minNode(this._root).key:null},n.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},n.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},n.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},n.prototype.at=function(t){for(var e=this._root,r=!1,i=0,n=[];!r;)if(e)n.push(e),e=e.left;else if(n.length>0){if(e=n.pop(),i===t)return e;i++,e=e.right}else r=!0;return null},n.prototype.next=function(t){var e=this._root,r=null;if(t.right){for(r=t.right;r.left;)r=r.left;return r}for(var i=this._comparator;e;){var n=i(t.key,e.key);if(0===n)break;n<0?(r=e,e=e.left):e=e.right}return r},n.prototype.prev=function(t){var e=this._root,r=null;if(null!==t.left){for(r=t.left;r.right;)r=r.right;return r}for(var i=this._comparator;e;){var n=i(t.key,e.key);if(0===n)break;n<0?e=e.left:(r=e,e=e.right)}return r},n.prototype.clear=function(){return this._root=null,this._size=0,this},n.prototype.toList=function(){return function(e){for(var r=e,i=[],n=!1,o=new t(null,null),l=o;!n;)r?(i.push(r),r=r.left):i.length>0?r=(r=l=l.next=i.pop()).right:n=!0;return l.next=null,o.next}(this._root)},n.prototype.load=function(e,r,i){void 0===r&&(r=[]),void 0===i&&(i=!1);var n=e.length,o=this._comparator;if(i&&function t(e,r,i,n,o){if(!(i>=n)){for(var l=e[i+n>>1],s=i-1,h=n+1;;){do s++;while(0>o(e[s],l));do h--;while(o(e[h],l)>0);if(s>=h)break;var u=e[s];e[s]=e[h],e[h]=u,u=r[s],r[s]=r[h],r[h]=u}t(e,r,i,h,o),t(e,r,h+1,n,o)}}(e,r,0,n-1,o),null===this._root)this._root=function e(r,i,n,o){var l=o-n;if(l>0){var s=n+Math.floor(l/2),h=new t(r[s],i[s]);return h.left=e(r,i,n,s),h.right=e(r,i,s+1,o),h}return null}(e,r,0,n),this._size=n;else{var l=function(e,r,i){for(var n=new t(null,null),o=n,l=e,s=r;null!==l&&null!==s;)0>i(l.key,s.key)?(o.next=l,l=l.next):(o.next=s,s=s.next),o=o.next;return null!==l?o.next=l:null!==s&&(o.next=s),n.next}(this.toList(),function(e,r){for(var i=new t(null,null),n=i,o=0;o<e.length;o++)n=n.next=new t(e[o],r[o]);return n.next=null,i.next}(e,r),o);n=this._size+n,this._root=function t(e,r,i){var n=i-r;if(n>0){var o=r+Math.floor(n/2),l=t(e,r,o),s=e.head;return s.left=l,e.head=e.head.next,s.right=t(e,o+1,i),s}return null}({head:l},0,n)}return this},n.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(n.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),n.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return function t(e,r,i,n,o){if(e){n(""+r+(i?"└── ":"├── ")+o(e)+"\n");var l=r+(i?"    ":"│   ");e.left&&t(e.left,l,!1,n,o),e.right&&t(e.right,l,!0,n,o)}}(this._root,"",!0,function(t){return e.push(t)},t),e.join("")},n.prototype.update=function(t,e,n){var l,s,h=this._comparator,u=o(t,this._root,h),f=u.left,p=u.right;0>h(t,e)?p=i(e,n,p,h):f=i(e,n,f,h),this._root=(l=f,null===(s=p)?l:(null===l||((s=r(l.key,s,h)).left=l),s))},n.prototype.split=function(t){return o(t,this._root,this._comparator)},n.prototype[Symbol.iterator]=function(){var t,e,r;return(/**
     * splaytree v3.1.2
     * Fast Splay tree for Node and browser
     *
     * @author Alexander Milevski <info@w8r.name>
     * @license MIT
     * @preserve
     *//*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function(t,e){var r,i,n,o,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw TypeError("Generator is already executing.");for(;l;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,i=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(n=(n=l.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){l=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){l.label=o[1];break}if(6===o[0]&&l.label<n[1]){l.label=n[1],n=o;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(o);break}n[2]&&l.ops.pop(),l.trys.pop();continue}o=e.call(t,l)}catch(t){o=[6,t],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,function(i){switch(i.label){case 0:t=this._root,e=[],r=!1,i.label=1;case 1:if(r)return[3,6];if(!(null!==t))return[3,2];return e.push(t),t=t.left,[3,5];case 2:if(!(0!==e.length))return[3,4];return[4,t=e.pop()];case 3:return i.sent(),t=t.right,[3,5];case 4:r=!0,i.label=5;case 5:return[3,1];case 6:return[2]}}))},n}();let s=(t,e)=>t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y,h=(t,e)=>{if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;let r=t.ll.x<e.ll.x?e.ll.x:t.ll.x,i=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:r,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:i,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},u=Number.EPSILON;void 0===u&&(u=2220446049250313e-31);let f=u*u,p=(t,e)=>{if(-u<t&&t<u&&-u<e&&e<u)return 0;let r=t-e;return r*r<f*t*e?0:t<e?-1:1};class g{constructor(){this.reset()}reset(){this.xRounder=new a,this.yRounder=new a}round(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}class a{constructor(){this.tree=new l,this.round(0)}round(t){let e=this.tree.add(t),r=this.tree.prev(e);if(null!==r&&0===p(e.key,r.key))return this.tree.remove(t),r.key;let i=this.tree.next(e);return null!==i&&0===p(e.key,i.key)?(this.tree.remove(t),i.key):t}}let y=new g,c=(3+8881784197001252e-31)*11102230246251565e-32;function x(t,e,r,i,n){let o,l,s,h;let u=e[0],f=i[0],p=0,g=0;f>u==f>-u?(o=u,u=e[++p]):(o=f,f=i[++g]);let a=0;if(p<t&&g<r)for(f>u==f>-u?(l=u+o,s=o-(l-u),u=e[++p]):(l=f+o,s=o-(l-f),f=i[++g]),o=l,0!==s&&(n[a++]=s);p<t&&g<r;)f>u==f>-u?(h=(l=o+u)-o,s=o-(l-h)+(u-h),u=e[++p]):(h=(l=o+f)-o,s=o-(l-h)+(f-h),f=i[++g]),o=l,0!==s&&(n[a++]=s);for(;p<t;)h=(l=o+u)-o,s=o-(l-h)+(u-h),u=e[++p],o=l,0!==s&&(n[a++]=s);for(;g<r;)h=(l=o+f)-o,s=o-(l-h)+(f-h),f=i[++g],o=l,0!==s&&(n[a++]=s);return(0!==o||0===a)&&(n[a++]=o),a}function b(t){return new Float64Array(t)}let v=(3+17763568394002505e-31)*11102230246251565e-32,m=(2+13322676295501878e-31)*11102230246251565e-32,d=(9+7105427357601002e-30)*11102230246251565e-32*11102230246251565e-32,E=b(4),S=b(8),_=b(12),w=b(16),k=b(4),R=(t,e)=>t.x*e.y-t.y*e.x,I=(t,e)=>t.x*e.x+t.y*e.y,P=(t,e,r)=>{let i=function(t,e,r,i,n,o){let l=(e-o)*(r-n),s=(t-n)*(i-o),h=l-s,u=Math.abs(l+s);return Math.abs(h)>=v*u?h:-function(t,e,r,i,n,o,l){let s,h,u,f,p,g,a,y,b,v,R,I,P,N,A,O,L,$;let z=t-n,M=r-n,B=e-o,G=i-o;N=z*G,a=(g=134217729*z)-(g-z),y=z-a,b=(g=134217729*G)-(g-G),A=y*(v=G-b)-(N-a*b-y*b-a*v),O=B*M,a=(g=134217729*B)-(g-B),y=B-a,b=(g=134217729*M)-(g-M),R=A-(L=y*(v=M-b)-(O-a*b-y*b-a*v)),p=A-R,E[0]=A-(R+p)+(p-L),p=(I=N+R)-N,R=(P=N-(I-p)+(R-p))-O,p=P-R,E[1]=P-(R+p)+(p-O),p=($=I+R)-I,E[2]=I-($-p)+(R-p),E[3]=$;let T=function(t,e){let r=e[0];for(let t=1;t<4;t++)r+=e[t];return r}(0,E),C=m*l;if(T>=C||-T>=C||(p=t-z,s=t-(z+p)+(p-n),p=r-M,u=r-(M+p)+(p-n),p=e-B,h=e-(B+p)+(p-o),p=i-G,f=i-(G+p)+(p-o),0===s&&0===h&&0===u&&0===f)||(C=d*l+c*Math.abs(T),(T+=z*f+G*s-(B*u+M*h))>=C||-T>=C))return T;N=s*G,a=(g=134217729*s)-(g-s),y=s-a,b=(g=134217729*G)-(g-G),A=y*(v=G-b)-(N-a*b-y*b-a*v),O=h*M,a=(g=134217729*h)-(g-h),y=h-a,b=(g=134217729*M)-(g-M),R=A-(L=y*(v=M-b)-(O-a*b-y*b-a*v)),p=A-R,k[0]=A-(R+p)+(p-L),p=(I=N+R)-N,R=(P=N-(I-p)+(R-p))-O,p=P-R,k[1]=P-(R+p)+(p-O),p=($=I+R)-I,k[2]=I-($-p)+(R-p),k[3]=$;let q=x(4,E,4,k,S);N=z*f,a=(g=134217729*z)-(g-z),y=z-a,b=(g=134217729*f)-(g-f),A=y*(v=f-b)-(N-a*b-y*b-a*v),O=B*u,a=(g=134217729*B)-(g-B),y=B-a,b=(g=134217729*u)-(g-u),R=A-(L=y*(v=u-b)-(O-a*b-y*b-a*v)),p=A-R,k[0]=A-(R+p)+(p-L),p=(I=N+R)-N,R=(P=N-(I-p)+(R-p))-O,p=P-R,k[1]=P-(R+p)+(p-O),p=($=I+R)-I,k[2]=I-($-p)+(R-p),k[3]=$;let F=x(q,S,4,k,_);N=s*f,a=(g=134217729*s)-(g-s),y=s-a,b=(g=134217729*f)-(g-f),A=y*(v=f-b)-(N-a*b-y*b-a*v),O=h*u,a=(g=134217729*h)-(g-h),y=h-a,b=(g=134217729*u)-(g-u),R=A-(L=y*(v=u-b)-(O-a*b-y*b-a*v)),p=A-R,k[0]=A-(R+p)+(p-L),p=(I=N+R)-N,R=(P=N-(I-p)+(R-p))-O,p=P-R,k[1]=P-(R+p)+(p-O),p=($=I+R)-I,k[2]=I-($-p)+(R-p),k[3]=$;let j=x(F,_,4,k,w);return w[j-1]}(t,e,r,i,n,o,u)}(t.x,t.y,e.x,e.y,r.x,r.y);return i>0?-1:i<0?1:0},N=t=>Math.sqrt(I(t,t)),A=(t,e,r)=>{let i={x:e.x-t.x,y:e.y-t.y},n={x:r.x-t.x,y:r.y-t.y};return R(n,i)/N(n)/N(i)},O=(t,e,r)=>{let i={x:e.x-t.x,y:e.y-t.y},n={x:r.x-t.x,y:r.y-t.y};return I(n,i)/N(n)/N(i)},L=(t,e,r)=>0===e.y?null:{x:t.x+e.x/e.y*(r-t.y),y:r},$=(t,e,r)=>0===e.x?null:{x:r,y:t.y+e.y/e.x*(r-t.x)},z=(t,e,r,i)=>{if(0===e.x)return $(r,i,t.x);if(0===i.x)return $(t,e,r.x);if(0===e.y)return L(r,i,t.y);if(0===i.y)return L(t,e,r.y);let n=R(e,i);if(0==n)return null;let o={x:r.x-t.x,y:r.y-t.y},l=R(o,e)/n,s=R(o,i)/n,h=t.x+s*e.x,u=r.x+l*i.x;return{x:(h+u)/2,y:(t.y+s*e.y+(r.y+l*i.y))/2}};class M{static compare(t,e){let r=M.comparePoints(t.point,e.point);return 0!==r?r:(t.point!==e.point&&t.link(e),t.isLeft!==e.isLeft)?t.isLeft?1:-1:G.compare(t.segment,e.segment)}static comparePoints(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}constructor(t,e){void 0===t.events?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}link(t){if(t.point===this.point)throw Error("Tried to link already linked events");let e=t.point.events;for(let t=0,r=e.length;t<r;t++){let r=e[t];this.point.events.push(r),r.point=this.point}this.checkForConsuming()}checkForConsuming(){let t=this.point.events.length;for(let e=0;e<t;e++){let r=this.point.events[e];if(void 0===r.segment.consumedBy)for(let i=e+1;i<t;i++){let t=this.point.events[i];void 0===t.consumedBy&&r.otherSE.point.events===t.otherSE.point.events&&r.segment.consume(t.segment)}}}getAvailableLinkedEvents(){let t=[];for(let e=0,r=this.point.events.length;e<r;e++){let r=this.point.events[e];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&t.push(r)}return t}getLeftmostComparator(t){let e=new Map,r=r=>{let i=r.otherSE;e.set(r,{sine:A(this.point,t.point,i.point),cosine:O(this.point,t.point,i.point)})};return(t,i)=>{e.has(t)||r(t),e.has(i)||r(i);let{sine:n,cosine:o}=e.get(t),{sine:l,cosine:s}=e.get(i);return n>=0&&l>=0?o<s?1:o>s?-1:0:n<0&&l<0?o<s?-1:o>s?1:0:l<n?-1:l>n?1:0}}}let B=0;class G{static compare(t,e){let r=t.leftSE.point.x,i=e.leftSE.point.x,n=t.rightSE.point.x,o=e.rightSE.point.x;if(o<r)return 1;if(n<i)return -1;let l=t.leftSE.point.y,s=e.leftSE.point.y,h=t.rightSE.point.y,u=e.rightSE.point.y;if(r<i){if(s<l&&s<h)return 1;if(s>l&&s>h)return -1;let r=t.comparePoint(e.leftSE.point);if(r<0)return 1;if(r>0)return -1;let i=e.comparePoint(t.rightSE.point);return 0!==i?i:-1}if(r>i){if(l<s&&l<u)return -1;if(l>s&&l>u)return 1;let r=e.comparePoint(t.leftSE.point);if(0!==r)return r;let i=t.comparePoint(e.rightSE.point);return i<0?1:i>0?-1:1}if(l<s)return -1;if(l>s)return 1;if(n<o){let r=e.comparePoint(t.rightSE.point);if(0!==r)return r}if(n>o){let r=t.comparePoint(e.rightSE.point);if(r<0)return 1;if(r>0)return -1}if(n!==o){let t=h-l,e=n-r,f=u-s,p=o-i;if(t>e&&f<p)return 1;if(t<e&&f>p)return -1}return n>o?1:n<o||h<u?-1:h>u?1:t.id<e.id?-1:t.id>e.id?1:0}constructor(t,e,r,i){this.id=++B,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=r,this.windings=i}static fromRing(t,e,r){let i,n,o;let l=M.comparePoints(t,e);if(l<0)i=t,n=e,o=1;else if(l>0)i=e,n=t,o=-1;else throw Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);return new G(new M(i,!0),new M(n,!1),[r],[o])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){let t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}comparePoint(t){if(this.isAnEndpoint(t))return 0;let e=this.leftSE.point,r=this.rightSE.point,i=this.vector();if(e.x===r.x)return t.x===e.x?0:t.x<e.x?1:-1;let n=(t.y-e.y)/i.y,o=e.x+n*i.x;if(t.x===o)return 0;let l=(t.x-e.x)/i.x,s=e.y+l*i.y;return t.y===s?0:t.y<s?-1:1}getIntersection(t){let e=this.bbox(),r=t.bbox(),i=h(e,r);if(null===i)return null;let n=this.leftSE.point,o=this.rightSE.point,l=t.leftSE.point,u=t.rightSE.point,f=s(e,l)&&0===this.comparePoint(l),p=s(r,n)&&0===t.comparePoint(n),g=s(e,u)&&0===this.comparePoint(u),a=s(r,o)&&0===t.comparePoint(o);if(p&&f)return a&&!g?o:!a&&g?u:null;if(p)return g&&n.x===u.x&&n.y===u.y?null:n;if(f)return a&&o.x===l.x&&o.y===l.y?null:l;if(a&&g)return null;if(a)return o;if(g)return u;let c=z(n,this.vector(),l,t.vector());return null!==c&&s(i,c)?y.round(c.x,c.y):null}split(t){let e=[],r=void 0!==t.events,i=new M(t,!0),n=new M(t,!1),o=this.rightSE;this.replaceRightSE(n),e.push(n),e.push(i);let l=new G(i,o,this.rings.slice(),this.windings.slice());return M.comparePoints(l.leftSE.point,l.rightSE.point)>0&&l.swapEvents(),M.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),n.checkForConsuming()),e}swapEvents(){let t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,e=this.windings.length;t<e;t++)this.windings[t]*=-1}consume(t){let e=this,r=t;for(;e.consumedBy;)e=e.consumedBy;for(;r.consumedBy;)r=r.consumedBy;let i=G.compare(e,r);if(0!==i){if(i>0){let t=e;e=r,r=t}if(e.prev===r){let t=e;e=r,r=t}for(let t=0,i=r.rings.length;t<i;t++){let i=r.rings[t],n=r.windings[t],o=e.rings.indexOf(i);-1===o?(e.rings.push(i),e.windings.push(n)):e.windings[o]+=n}r.rings=null,r.windings=null,r.consumedBy=e,r.leftSE.consumedBy=e.leftSE,r.rightSE.consumedBy=e.rightSE}}prevInResult(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}beforeState(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){let t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}afterState(){if(void 0!==this._afterState)return this._afterState;let t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};let e=this._afterState.rings,r=this._afterState.windings,i=this._afterState.multiPolys;for(let t=0,i=this.rings.length;t<i;t++){let i=this.rings[t],n=this.windings[t],o=e.indexOf(i);-1===o?(e.push(i),r.push(n)):r[o]+=n}let n=[],o=[];for(let t=0,i=e.length;t<i;t++){if(0===r[t])continue;let i=e[t],l=i.poly;if(-1===o.indexOf(l)){if(i.isExterior)n.push(l);else{-1===o.indexOf(l)&&o.push(l);let t=n.indexOf(i.poly);-1!==t&&n.splice(t,1)}}}for(let t=0,e=n.length;t<e;t++){let e=n[t].multiPoly;-1===i.indexOf(e)&&i.push(e)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;let t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(W.type){case"union":{let r=0===t.length,i=0===e.length;this._isInResult=r!==i;break}case"intersection":{let r,i;t.length<e.length?(r=t.length,i=e.length):(r=e.length,i=t.length),this._isInResult=i===W.numMultiPolys&&r<i;break}case"xor":{let r=Math.abs(t.length-e.length);this._isInResult=r%2==1;break}case"difference":this._isInResult=(1===t.length&&t[0].isSubject)!==(1===e.length&&e[0].isSubject);break;default:throw Error(`Unrecognized operation type found ${W.type}`)}return this._isInResult}}class T{constructor(t,e,r){if(!Array.isArray(t)||0===t.length||(this.poly=e,this.isExterior=r,this.segments=[],"number"!=typeof t[0][0]||"number"!=typeof t[0][1]))throw Error("Input geometry is not a valid Polygon or MultiPolygon");let i=y.round(t[0][0],t[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let n=i;for(let e=1,r=t.length;e<r;e++){if("number"!=typeof t[e][0]||"number"!=typeof t[e][1])throw Error("Input geometry is not a valid Polygon or MultiPolygon");let r=y.round(t[e][0],t[e][1]);(r.x!==n.x||r.y!==n.y)&&(this.segments.push(G.fromRing(n,r,this)),r.x<this.bbox.ll.x&&(this.bbox.ll.x=r.x),r.y<this.bbox.ll.y&&(this.bbox.ll.y=r.y),r.x>this.bbox.ur.x&&(this.bbox.ur.x=r.x),r.y>this.bbox.ur.y&&(this.bbox.ur.y=r.y),n=r)}(i.x!==n.x||i.y!==n.y)&&this.segments.push(G.fromRing(n,i,this))}getSweepEvents(){let t=[];for(let e=0,r=this.segments.length;e<r;e++){let r=this.segments[e];t.push(r.leftSE),t.push(r.rightSE)}return t}}class C{constructor(t,e){if(!Array.isArray(t))throw Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new T(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let e=1,r=t.length;e<r;e++){let r=new T(t[e],this,!1);r.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=r.bbox.ll.x),r.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=r.bbox.ll.y),r.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=r.bbox.ur.x),r.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=r.bbox.ur.y),this.interiorRings.push(r)}this.multiPoly=e}getSweepEvents(){let t=this.exteriorRing.getSweepEvents();for(let e=0,r=this.interiorRings.length;e<r;e++){let r=this.interiorRings[e].getSweepEvents();for(let e=0,i=r.length;e<i;e++)t.push(r[e])}return t}}class q{constructor(t,e){if(!Array.isArray(t))throw Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof t[0][0][0]&&(t=[t])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let e=0,r=t.length;e<r;e++){let r=new C(t[e],this);r.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=r.bbox.ll.x),r.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=r.bbox.ll.y),r.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=r.bbox.ur.x),r.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=r.bbox.ur.y),this.polys.push(r)}this.isSubject=e}getSweepEvents(){let t=[];for(let e=0,r=this.polys.length;e<r;e++){let r=this.polys[e].getSweepEvents();for(let e=0,i=r.length;e<i;e++)t.push(r[e])}return t}}class F{static factory(t){let e=[];for(let r=0,i=t.length;r<i;r++){let i=t[r];if(!i.isInResult()||i.ringOut)continue;let n=null,o=i.leftSE,l=i.rightSE,s=[o],h=o.point,u=[];for(;n=o,o=l,s.push(o),o.point!==h;)for(;;){let t=o.getAvailableLinkedEvents();if(0===t.length){let t=s[0].point,e=s[s.length-1].point;throw Error(`Unable to complete output ring starting at [${t.x}, ${t.y}]. Last matching segment found ends at [${e.x}, ${e.y}].`)}if(1===t.length){l=t[0].otherSE;break}let r=null;for(let t=0,e=u.length;t<e;t++)if(u[t].point===o.point){r=t;break}if(null!==r){let t=u.splice(r)[0],i=s.splice(t.index);i.unshift(i[0].otherSE),e.push(new F(i.reverse()));continue}u.push({index:s.length,point:o.point});let i=o.getLeftmostComparator(n);l=t.sort(i)[0].otherSE;break}e.push(new F(s))}return e}constructor(t){this.events=t;for(let e=0,r=t.length;e<r;e++)t[e].segment.ringOut=this;this.poly=null}getGeom(){let t=this.events[0].point,e=[t];for(let r=1,i=this.events.length-1;r<i;r++){let i=this.events[r].point;0!==P(i,t,this.events[r+1].point)&&(e.push(i),t=i)}if(1===e.length)return null;0===P(e[0],t,e[1])&&e.shift(),e.push(e[0]);let r=this.isExteriorRing()?1:-1,i=this.isExteriorRing()?0:e.length-1,n=this.isExteriorRing()?e.length:-1,o=[];for(let t=i;t!=n;t+=r)o.push([e[t].x,e[t].y]);return o}isExteriorRing(){if(void 0===this._isExteriorRing){let t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}enclosingRing(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let e=1,r=this.events.length;e<r;e++){let r=this.events[e];M.compare(t,r)>0&&(t=r)}let e=t.segment.prevInResult(),r=e?e.prevInResult():null;for(;;){if(!e)return null;if(!r)return e.ringOut;if(r.ringOut!==e.ringOut){if(r.ringOut.enclosingRing()!==e.ringOut)return e.ringOut;return e.ringOut.enclosingRing()}r=(e=r.prevInResult())?e.prevInResult():null}}}class j{constructor(t){this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){let t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(let e=0,r=this.interiorRings.length;e<r;e++){let r=this.interiorRings[e].getGeom();null!==r&&t.push(r)}return t}}class U{constructor(t){this.rings=t,this.polys=this._composePolys(t)}getGeom(){let t=[];for(let e=0,r=this.polys.length;e<r;e++){let r=this.polys[e].getGeom();null!==r&&t.push(r)}return t}_composePolys(t){let e=[];for(let r=0,i=t.length;r<i;r++){let i=t[r];if(!i.poly){if(i.isExteriorRing())e.push(new j(i));else{let t=i.enclosingRing();t.poly||e.push(new j(t)),t.poly.addInterior(i)}}}return e}}class Y{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G.compare;this.queue=t,this.tree=new l(e),this.segments=[]}process(t){let e,r;let i=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(i),n;let o=t.isLeft?this.tree.add(i):this.tree.find(i);if(!o)throw Error(`Unable to find segment #${i.id} [${i.leftSE.point.x}, ${i.leftSE.point.y}] -> [${i.rightSE.point.x}, ${i.rightSE.point.y}] in SweepLine tree.`);let l=o,s=o;for(;void 0===e;)null===(l=this.tree.prev(l))?e=null:void 0===l.key.consumedBy&&(e=l.key);for(;void 0===r;)null===(s=this.tree.next(s))?r=null:void 0===s.key.consumedBy&&(r=s.key);if(t.isLeft){let o=null;if(e){let t=e.getIntersection(i);if(null!==t&&(i.isAnEndpoint(t)||(o=t),!e.isAnEndpoint(t))){let r=this._splitSafely(e,t);for(let t=0,e=r.length;t<e;t++)n.push(r[t])}}let l=null;if(r){let t=r.getIntersection(i);if(null!==t&&(i.isAnEndpoint(t)||(l=t),!r.isAnEndpoint(t))){let e=this._splitSafely(r,t);for(let t=0,r=e.length;t<r;t++)n.push(e[t])}}if(null!==o||null!==l){let t=null;t=null===o?l:null===l?o:0>=M.comparePoints(o,l)?o:l,this.queue.remove(i.rightSE),n.push(i.rightSE);let e=i.split(t);for(let t=0,r=e.length;t<r;t++)n.push(e[t])}n.length>0?(this.tree.remove(i),n.push(t)):(this.segments.push(i),i.prev=e)}else{if(e&&r){let t=e.getIntersection(r);if(null!==t){if(!e.isAnEndpoint(t)){let r=this._splitSafely(e,t);for(let t=0,e=r.length;t<e;t++)n.push(r[t])}if(!r.isAnEndpoint(t)){let e=this._splitSafely(r,t);for(let t=0,r=e.length;t<r;t++)n.push(e[t])}}}this.tree.remove(i)}return n}_splitSafely(t,e){this.tree.remove(t);let r=t.rightSE;this.queue.remove(r);let i=t.split(e);return i.push(r),void 0===t.consumedBy&&this.tree.add(t),i}}let V=void 0!==n&&n.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,X=void 0!==n&&n.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class Q{run(t,e,r){W.type=t,y.reset();let i=[new q(e,!0)];for(let t=0,e=r.length;t<e;t++)i.push(new q(r[t],!1));if(W.numMultiPolys=i.length,"difference"===W.type){let t=i[0],e=1;for(;e<i.length;)null!==h(i[e].bbox,t.bbox)?e++:i.splice(e,1)}if("intersection"===W.type)for(let t=0,e=i.length;t<e;t++){let e=i[t];for(let r=t+1,n=i.length;r<n;r++)if(null===h(e.bbox,i[r].bbox))return[]}let n=new l(M.compare);for(let t=0,e=i.length;t<e;t++){let e=i[t].getSweepEvents();for(let t=0,r=e.length;t<r;t++)if(n.insert(e[t]),n.size>V)throw Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}let o=new Y(n),s=n.size,u=n.pop();for(;u;){let t=u.key;if(n.size===s){let e=t.segment;throw Error(`Unable to pop() ${t.isLeft?"left":"right"} SweepEvent [${t.point.x}, ${t.point.y}] from segment #${e.id} [${e.leftSE.point.x}, ${e.leftSE.point.y}] -> [${e.rightSE.point.x}, ${e.rightSE.point.y}] from queue.`)}if(n.size>V)throw Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(o.segments.length>X)throw Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");let e=o.process(t);for(let t=0,r=e.length;t<r;t++){let r=e[t];void 0===r.consumedBy&&n.insert(r)}s=n.size,u=n.pop()}return y.reset(),new U(F.factory(o.segments)).getGeom()}}let W=new Q;return{union:function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return W.run("union",t,r)},intersection:function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return W.run("intersection",t,r)},xor:function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return W.run("xor",t,r)},difference:function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return W.run("difference",t,r)}}},t.exports=i()}}]);