(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[93411],{58478:function(t){function e(t){return Promise.resolve().then(function(){var e=Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}e.keys=function(){return[]},e.resolve=e,e.id=58478,t.exports=e},41833:function(t,e,i){"use strict";i.r(e),i.d(e,{BindingNNA:function(){return g}});class n{addIconTopPanel(t){let e=document.createElement("button");e.style.width="".concat(t.width,"px"),e.style.zIndex="13;",e.style.position="relative",e.style.border="none",e.textContent=t.text,e.onclick=()=>t.callBack(),this.window.builder.divFulldownArea.appendChild(e)}addToggleTopPanel(t){let e=document.createElement("button");e.style.width="".concat(t.width,"px"),e.style.zIndex="13;",e.style.position="relative",e.style.border="none",e.textContent=t.text,e.onclick=()=>t.callBack(),this.window.builder.divFulldownArea.appendChild(e)}addIconLeftPanel(t){let e=document.createElement("button");e.style.height="50px",e.style.width="50px",e.style.zIndex="13;",e.style.position="relative",e.style.border="none",e.style.color="#000000",e.style.background="#fafafa",e.textContent=t.text,e.onclick=()=>t.callBack(),e.onmouseenter=()=>{e.style.color="#ffffff",e.style.background="#888888"},e.onmouseleave=()=>{e.style.color="#000000",e.style.background="#fafafa"},this.window.builder.divLeftUI.appendChild(e)}addIconLeft(){}constructor(t){this.window=t}}class a{initPanel(t){this.initDivMain(),this.initDivTopArea(),this.initDivFulldownArea();let e=document.createElement("div");e.style.float="left",e.style.height="100%",e.style.padding="10px",e.style.background="#ff0000",this.divTopArea.appendChild(e);let i=document.createElement("div");i.style.float="left",i.style.padding="10px",i.textContent=t,this.divTopArea.appendChild(i),this.initDivContextArea(),this.initDivLeftArea(),this.divForGraphicContext=document.createElement("div"),this.divForGraphicContext.style.height="100%",this.divForGraphicContext.id="divForGraphicContext",this.divMainBody.appendChild(this.divForGraphicContext);let n=document.createElement("button");n.style.top="0px",n.style.left="0px",n.style.height="20px",n.style.width="20px",n.style.zIndex="13",n.style.float="right",n.style.padding="0px",n.style.zIndex="20",n.textContent="X",n.onclick=()=>{this.window.remove()},this.divTopArea.appendChild(n),this.initBottomArea(this.divMain);let a=document.createElement("div");a.style.height="100%",a.style.width="100px",a.style.float="left",this.divBottomArea.appendChild(a);let s=document.createElement("div");s.style.height="100%",s.style.width="80%",s.style.float="left",this.divBottomArea.appendChild(s)}initDivTopArea(){let t=document.createElement("div");t.style.width="100%",t.style.height="40px",t.style.background=this.colorTopMenu,t.style.zIndex="11";let e=!1,i=[0,0];t.ondrag=t=>{},t.onmouseenter=t=>{},t.ondrag=t=>{},t.onmousemove=t=>{if(e){let e=t.clientX-i[0],n=t.clientY-i[1];this.divMain.style.top=parseFloat(this.divMain.style.top)+n+"px",this.divMain.style.left=parseFloat(this.divMain.style.left)+e+"px",i[0]=t.clientX,i[1]=t.clientY}},t.onmousedown=t=>{i[0]=t.clientX,i[1]=t.clientY,e=!0,this.window.updateZindex()},t.onmouseup=t=>{e=!1},t.onmouseout=t=>{if(e){let e=t.clientX-i[0],n=t.clientY-i[1];this.divMain.style.top=parseFloat(this.divMain.style.top)+n+"px",this.divMain.style.left=parseFloat(this.divMain.style.left)+e+"px",i[0]=t.clientX,i[1]=t.clientY}},this.divTopArea=t,this.divMain.appendChild(t)}appendCloseTop(){}initBottomArea(t){let e=document.createElement("div");e.style.top=parseFloat(t.style.height)-parseFloat(t.style.top)-10+"px",e.style.width="100%",e.style.height="40px",e.style.background=this.colorBGmenu,e.style.zIndex="11";let i=!1,n=[0,0];e.ondrag=t=>{},e.onmouseenter=t=>{},e.ondrag=t=>{},e.onmousemove=a=>{if(i){let i=a.clientX-n[0],s=a.clientY-n[1];t.style.width=parseFloat(t.style.width)+i+"px",t.style.height=parseFloat(t.style.height)+s+"px",e.style.top=parseFloat(e.style.top)+s+"px",e.style.left=parseFloat(e.style.left)+i+"px",n[0]=a.clientX,n[1]=a.clientY}},e.onmousedown=t=>{n[0]=t.clientX,n[1]=t.clientY,i=!0},e.onmouseup=t=>{i=!1},e.onmouseout=a=>{if(this.window.updateResize=setTimeout(()=>{if(i){let i=a.clientX-n[0],s=a.clientY-n[1];t.style.width=parseFloat(t.style.width)+i+"px",t.style.height=parseFloat(t.style.height)+s+"px",e.style.top=parseFloat(e.style.top)+s+"px",e.style.left=parseFloat(e.style.left)+i+"px",n[0]=a.clientX,n[1]=a.clientY}},300),i){let i=a.clientX-n[0],s=a.clientY-n[1];t.style.width=parseFloat(t.style.width)+i+"px",t.style.height=parseFloat(t.style.height)+s+"px",e.style.top=parseFloat(e.style.top)+s+"px",e.style.left=parseFloat(e.style.left)+i+"px",n[0]=a.clientX,n[1]=a.clientY}},this.divBottomArea=e,t.appendChild(e)}initDivMain(){this.divMain=document.createElement("div"),this.divMain.style.width="".concat(this.window.width,"px"),this.divMain.style.height="".concat(this.window.height,"px"),this.divMain.style.position="absolute",this.divMain.style.zIndex="10",this.divMain.id="NWindow",this.divMain.style.top="100px",this.divMain.style.left="200px",this.window.divHost.appendChild(this.divMain)}initDivFulldownArea(){this.divFulldownArea=document.createElement("div"),this.divFulldownArea.style.height="50px",this.divFulldownArea.style.width="100%",this.divFulldownArea.style.background=this.colorBGmenu,this.divMain.appendChild(this.divFulldownArea)}initDivContextArea(){this.divMainBody=document.createElement("div"),this.divMainBody.style.height="100%",this.divMainBody.style.width="100%",this.divMainBody.id="divContext",this.divMain.appendChild(this.divMainBody)}initDivLeftArea(){this.divLeftUI=document.createElement("div"),this.divLeftUI.style.height="100%",this.divLeftUI.style.width="100px",this.divLeftUI.style.background=this.colorBGmenu,this.divLeftUI.style.float="left",this.divMainBody.appendChild(this.divLeftUI)}constructor(t){this.colorTopMenu="#dfdfdf",this.colorBGmenu="#f3f3f3",this.window=t}}class s{addIconTopPanel(t){this.controller.addIconTopPanel(t)}addToggleTopPanel(t){this.controller.addToggleTopPanel(t)}addIconLeftPanel(t){this.controller.addIconLeftPanel(t)}addIconLeft(){this.controller.addIconLeft()}getContext(){return this.builder.divForGraphicContext}remove(){this.divHost.removeChild(this.builder.divMain)}updateZindex(){}constructor(t,e="NJS Sandbox",i=600,s=400){this.width=600,this.height=400,this.divHost=t,this.width=i,this.height=s,this.controller=new n(this),this.builder=new a(this),this.builder.initPanel(e)}}var o=i(37526),l=i(28101),d=i(36502);class h{async OpenGeoJsonEx01(t){}constructor(t){this.app=t,this.OpenGeoJsonEx01("")}}class r{AppendMapViewEvent(){this.app.mapView.watch("extent",()=>{}),this.app.mapView.watch("stationary",t=>{this.app.renderer.isPanning=!t}),this.app.mapView.watch("ready",t=>{}),this.app.mapView.on("resize",t=>{this.app.canvas.ResizeCanvas(t.width,t.height)})}constructor(t){this.app=t,this.AppendMapViewEvent()}}class p{ToScreenFromProjected(t,e){this.app.mPoint.x=t,this.app.mPoint.y=e,this.app.mPoint.spatialReference=this.app.mapView.spatialReference;let i=this.app.mapView.toScreen(this.app.mPoint);return[i.x,i.y]}ToScreenFromGeoPos(t,e){let i=this.app.mapView.toMap({x:t,y:e}).clone();i.longitude=t,i.latitude=e;let n=this.app.mapView.toScreen(i);return[n.x,n.y]}ToScreenFromProjectedPos(t,e){let i=this.app.mapView.toMap({x:t,y:e}).clone(),n=this.app.mapView.toScreen(i);return[n.x,n.y]}ToScreenOld(t,e){let i=this.app.mapView.toMap({x:t,y:e}).clone();i.spatialReference.wkid=102100,i.longitude=t,i.latitude=e;let n=this.app.mapView.toScreen(i);return[n.x,n.y]}constructor(t){this.ToMap=(t,e)=>{let i=this.app.mapView.toMap({x:t,y:e}).clone();return[i.longitude,i.latitude,i.x,i.y]},this.ToScreen=(t,e)=>{this.app.mPoint.longitude=t,this.app.mPoint.latitude=e,this.app.mPoint.spatialReference=this.app.mapView.spatialReference;let i=this.app.mapView.toScreen(this.app.mPoint);return[i.x,i.y]},this.app=t}}class c{Start(t){this.App.renderer.Init(t),this.Draw(this.ctx)}Draw(t){requestAnimationFrame(()=>{this.Draw(t)}),this.Clear(t),this.Render(t)}Clear(t){t.clearRect(0,0,t.canvas.width,t.canvas.height)}Render(t){this.App.renderer.Render(t)}ResizeCanvas(t,e){this.ctx.canvas.width=t,this.ctx.canvas.height=e}constructor(t){this.smoothingEnabled=!0,this.then=0,this.interval=0,this.last=0,this.asyncSafeGuard=0,this.App=t,this.canvas=document.createElement("canvas"),this.canvas.id="App",this.canvas.style.zIndex="1",this.canvas.style.position="absolute",this.canvas.style.pointerEvents="none",this.ctx=this.canvas.getContext("2d"),t.divHost.appendChild(this.canvas),this.ctx.globalCompositeOperation="source-over",this.canvas.width=t.divHost.clientWidth,this.canvas.height=t.divHost.clientHeight,this.Start(this.ctx)}}var v=i(20191);class w{InitArcGISMapEventV4x(){this.app.mapView.on("click",t=>{let e=this.CommonEventBuilderArcGIS(t);e.type=v.zK.LEFT,2===t.native.button?e.type=v.zK.RIGHT:1===t.native.button&&(e.type=v.zK.MIDDLE),this.app.MouseEvent(e)}),this.app.mapView.on("pointer-down",t=>{let e=this.CommonEventBuilderArcGIS(t);e.type=v.zK.DOWN,this.app.MouseEvent(e)}),this.app.mapView.on("pointer-up",t=>{let e=this.CommonEventBuilderArcGIS(t);e.type=v.zK.UP,this.app.MouseEvent(e)}),this.app.mapView.on("pointer-move",t=>{let e=this.CommonEventBuilderArcGIS(t);e.type=v.zK.MOVE,this.app.MouseEvent(e)}),this.app.mapView.on("drag",t=>{let e=this.CommonEventBuilderArcGIS(t);e.type=v.zK.DRAG,this.app.MouseEvent(e),this.app.ableToPan||t.stopPropagation()}),this.app.mapView.on("key-down",t=>{("Arrow"===t.key.slice(0,5)||"-"===t.key||"="===t.key||"d"===t.key)&&t.stopPropagation(),this.KeyDownJSAPI4X(t.native)}),this.app.mapView.on("key-up",t=>{("Arrow"===t.key.slice(0,5)||"-"===t.key||"="===t.key||"d"===t.key)&&t.stopPropagation(),this.KeyDownJSAPI4X(t.native)})}MouseClickLeftArcGIS(t){let e=this.CommonEventBuilderArcGIS(t);this.app.MouseEvent(e)}CommonEventBuilderArcGIS(t){let e=new v.$E;return e.preX=w.mouseEventDataPre.x,e.preY=w.mouseEventDataPre.y,e.x=t.x,e.y=t.y,e.yGLPicking=t.native.target.getBoundingClientRect().bottom-t.native.clientY,e.pressedShift=t.native.shiftKey,e.pressedAlt=t.native.altKey,e.pressedCtrl=t.native.ctrlKey,e.native=t.native,w.mouseEventDataPre=e,e}KeyDownJSAPI4X(t){let e=this.CommonEventBuilder(t);this.app.KeyEvent(e)}CommonEventBuilder(t){let e=new v.ON;return e.key=t.key,e.keyCode=t.keyCode,e.code=t.code,e.hasCtrlKey=t.ctrlKey,e.hasShiftKey=t.shiftKey,e.hasAltKey=t.altKey,e.hasMetaCommand=t.metaKey,e}constructor(t){this.app=t,w.mouseEventDataPre=new v.$E,this.InitArcGISMapEventV4x()}}class y{Init(t){}Render(t){for(let e=0;e<this.renderer.length;++e)this.renderer[e](t,this.isPanning)}constructor(t){this.p=[],this.num=0,this.isPanning=!1,this.renderer=[],this.sandbox=t}}class m{static start(t){new m(t)}appendRenderer(t){this.renderer.renderer.push(t)}appendEventListener(t){this.MouseEvents.push(t.mouse),this.keyEvents.push(t.keyboard)}MouseEvent(t){for(let e=0;e<this.MouseEvents.length;++e)this.MouseEvents[e](t)}KeyEvent(t){for(let e=0;e<this.keyEvents.length;++e)this.keyEvents[e](t)}constructor(t){this.ableToPan=!0,this.keyEvents=[],this.MouseEvents=[],this.renderer=new y(this);let e=new l.Z({basemap:"dark-gray-vector"});this.map=e,new o.Z({map:e,container:t,center:[-73.989502,40.741286],zoom:13}).when(t=>{this.mapView=t,this.mapView.spatialReference=d.Z.WebMercator,this.mPoint=this.mapView.toMap({x:0,y:0}),this.divHost=this.mapView.container,this.io=new h(this),this.eventInteraction=new w(this),this.projection=new p(this),this.canvas=new c(this),this.arcGIS=new r(this)})}}var u=i(11827),x=i(59945);class g{async initBinding(){this.njsSandbox.win=new s(this.njsSandbox.div,"NNA Engine V4 by NJSTUDIO",1200,600),this.njsSandbox.env=await new m(this.njsSandbox.win.getContext()),this.drawingEngine=new x.J,this.drawingEngine.updateProjection({toMap:(t,e)=>this.njsSandbox.env.projection.ToMap(t,e),toScreen:(t,e)=>this.njsSandbox.env.projection.ToScreen(t,e)}),this.drawingEngine.bindAbleToPan=t=>{this.njsSandbox.env.ableToPan=t},this.njsSandbox.env.appendEventListener({mouse:t=>this.drawingEngine.mouseEvent(t),keyboard:t=>this.drawingEngine.keyEvent(t)}),this.nna=new u.V,this.nna.updateProjection({toMap:(t,e)=>this.njsSandbox.env.projection.ToMap(t,e),toScreen:(t,e)=>this.njsSandbox.env.projection.ToScreen(t,e)}),this.njsSandbox.env.appendEventListener({mouse:t=>this.nna.mouseEvent(t),keyboard:t=>this.nna.keyEvent(t)}),this.njsSandbox.env.appendRenderer((t,e)=>this.nna.render(t,e)),this.njsSandbox.env.appendRenderer((t,e)=>this.drawingEngine.render(t,e)),this.njsSandbox.win.addIconLeftPanel({text:"save",callBack:()=>this.drawingEngine.setCommand("save")}),this.njsSandbox.win.addIconLeftPanel({text:"load",callBack:()=>this.drawingEngine.setCommand("load")}),this.njsSandbox.win.addIconLeftPanel({text:"Select",callBack:()=>this.drawingEngine.setCommand("SELECT")}),this.njsSandbox.win.addIconLeftPanel({text:"Point",callBack:()=>this.drawingEngine.setCommand("POINT")}),this.njsSandbox.win.addIconLeftPanel({text:"Line",callBack:()=>this.drawingEngine.setCommand("LINE")}),this.njsSandbox.win.addIconLeftPanel({text:"Polyl",callBack:()=>this.drawingEngine.setCommand("POLYLINE")}),this.njsSandbox.win.addIconLeftPanel({text:"Circle",callBack:()=>this.drawingEngine.setCommand("CIRCLE")}),this.njsSandbox.win.addIconLeftPanel({text:"Rect",callBack:()=>this.drawingEngine.setCommand("RECTANGLE")}),this.njsSandbox.win.addIconLeftPanel({text:"ZipData",callBack:()=>this.drawingEngine.apiCall("importZipData")}),this.njsSandbox.win.addIconLeftPanel({text:"clusterGrid",callBack:()=>this.drawingEngine.apiCall("importClustering")}),this.njsSandbox.win.addIconLeftPanel({text:"clusterCol",callBack:()=>this.drawingEngine.apiCall("importClusteringCollision")}),this.njsSandbox.win.addIconTopPanel({text:"import",width:60,callBack:()=>this.nna.importDummyData()}),this.njsSandbox.win.addIconTopPanel({text:"Origin",width:60,callBack:()=>{this.nna.apiCall(v.lw.NETWORK,"addOrigins",this.drawingEngine.apiCall("getSelectedCPoint"))}}),this.njsSandbox.win.addIconTopPanel({text:"Destination",width:90,callBack:()=>{this.nna.apiCall(v.lw.NETWORK,"addDestinations",this.drawingEngine.apiCall("getSelectedCPoint"))}}),this.njsSandbox.win.addIconTopPanel({text:"Agent",width:90,callBack:()=>{this.nna.apiCall(v.lw.AGENCY,"runAgent",void 0)}}),this.njsSandbox.win.addIconTopPanel({text:"pathOpti",width:90,callBack:()=>{this.nna.apiCall(v.lw.GA,"pathOptimization",this.drawingEngine.apiCall("getSelectedCPoint"))}}),this.njsSandbox.win.addIconTopPanel({text:"Inspection",width:90,callBack:()=>{this.nna.controller.inspection=!this.nna.controller.inspection,this.drawingEngine.activeCommand.inspection=!this.drawingEngine.activeCommand.inspection}}),this.njsSandbox.win.addIconTopPanel({text:"Capture",width:60,callBack:()=>this.nna.apiCall(v.lw.NETWORK,"capture",void 0)}),this.njsSandbox.win.addIconTopPanel({text:"Download",width:60,callBack:()=>this.nna.apiCall(v.lw.NETWORK,"download",void 0)})}constructor(t){this.njsSandbox=t}}}}]);