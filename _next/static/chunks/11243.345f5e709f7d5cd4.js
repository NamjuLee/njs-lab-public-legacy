"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11243],{99497:function(e,t,r){r.d(t,{EN:function(){return f},H9:function(){return s},eS:function(){return u},f:function(){return i}});var n,a,i,s,o=r(44340);(n=i||(i={})).InvalidFunctionParameters="InvalidFunctionParameters",n.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction",n.UnsupportedSqlFunction="UnsupportedSqlFunction",n.UnsupportedOperator="UnsupportedOperator",n.UnsupportedSyntax="UnsupportedSyntax",n.UnsupportedIsRhs="UnsupportedIsRhs",n.UnsupportedIsLhs="UnsupportedIsLhs",n.InvalidDataType="InvalidDataType",n.CannotCastValue="CannotCastValue",n.FunctionNotRecognized="FunctionNotRecognized",n.InvalidTime="InvalidTime",n.InvalidParameterCount="InvalidParameterCount",n.InvalidTimeStamp="InvalidTimeStamp",n.InvalidDate="InvalidDate",n.InvalidOperator="InvalidOperator",n.IllegalInterval="IllegalInterval",n.YearMonthIntervals="YearMonthIntervals",n.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers",n.MissingStatisticParameters="MissingStatisticParameters";let l={[i.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[i.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[i.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[i.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[i.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[i.UnsupportedOperator]:"Unsupported operator - {operator}",[i.UnsupportedSyntax]:"Unsupported syntax - {node}",[i.UnsupportedSqlFunction]:"Sql function not found = {function}",[i.InvalidDataType]:"Invalid sql data type",[i.InvalidDate]:"Invalid date encountered",[i.InvalidOperator]:"Invalid operator encountered",[i.InvalidTime]:"Invalid time encountered",[i.IllegalInterval]:"Illegal interval",[i.FunctionNotRecognized]:"Function not recognized",[i.InvalidTimeStamp]:"Invalid timestamp encountered",[i.InvalidParameterCount]:"Invalid parameter count for call to {name}",[i.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[i.YearMonthIntervals]:"Year-Month Intervals not supported",[i.CannotCastValue]:"Cannot cast value to the required data type"};class u extends Error{constructor(e,t){super((0,o.gx)(l[e],t)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,u)}}(a=s||(s={})).NeverReach="NeverReach",a.NotImplemented="NotImplemented",a.Cancelled="Cancelled",a.InvalidStatResponse="InvalidStatResponse",a.InvalidRequest="InvalidRequest",a.RequestFailed="RequestFailed",a.MissingFeatures="MissingFeatures",a.AggregationFieldNotFound="AggregationFieldNotFound",a.DataElementsNotFound="DataElementsNotFound";let c={[s.Cancelled]:"Cancelled",[s.InvalidStatResponse]:"Invalid statistics response from service",[s.InvalidRequest]:"Invalid request",[s.RequestFailed]:"Request failed - {reason}",[s.MissingFeatures]:"Missing features",[s.AggregationFieldNotFound]:"Aggregation field not found",[s.DataElementsNotFound]:"Data elements not found on service",[s.NeverReach]:"Encountered unreachable logic",[s.NotImplemented]:"Not implemented"};class f extends Error{constructor(e,t){super((0,o.gx)(c[e],t)),this.declaredRootClass="esri.arcade.featureset.support.featureseterror",Error.captureStackTrace&&Error.captureStackTrace(this,f)}}},77660:function(e,t,r){r.d(t,{H:function(){return i}});var n=r(9450);function a(e){return Number.isNaN(e)||0===e?e:Math.trunc(e)}class i{constructor(e){this._timeStampOffset=e,this._date=null}toDateTime(){return this._date??=n.ou.fromISO(this._timeStampOffset,{setZone:!0}),this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return a(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return a(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return i.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(e){return new i(n.ou.fromJSDate(e).toISO({includeOffset:!0}))}static fromDateTime(e){return new i(e.toISO({includeOffset:!0}))}static fromParts(e,t,r=0,n=0,a=0,s=0,o=0,l=!1,u=0,c=0){let f=`${e.toString().padStart(4,"0")}-${t.toString().padStart(2,"0")}-${r.toString().padStart(2,"0")}`,d="";s<10&&(d="0");let p=`${n.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${d+s.toString()}`;return 0!==o&&(p+="."+o.toString().padStart(3,"0")),new i(f+"T"+p+`${l?"-":"+"}${u.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let e=this.toDateTime().toSQL({includeOffset:!0,includeOffsetSpace:!0});return e&&(e=e.replace(".000","")),e}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(e){let t=this.toDateTime().plus(e);return i.fromDateTime(t)}}},11243:function(e,t,r){r.d(t,{WhereClause:function(){return es}});var n,a,i=r(30687),s=r(99497),o=r(37180),l=r(11697),u=r(77660),c=r(11693),f=r(9450);function d(e,t){let r=p[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}let p={min:{minParams:1,maxParams:1,evaluate:e=>v(e[0],"min")},max:{minParams:1,maxParams:1,evaluate:e=>v(e[0],"max")},avg:{minParams:1,maxParams:1,evaluate:e=>h(e[0])},sum:{minParams:1,maxParams:1,evaluate:e=>(function(e){if(null===e)return null;let t=0;for(let r=0;r<e.length;r++){let n=e[r];if(null!==n){if(!m(n))throw new s.eS(s.f.InvalidValueForAggregateFunction);t+=n}}return t})(e[0])},stddev:{minParams:1,maxParams:1,evaluate:e=>(function(e){if(null===e)return null;let t=w(e);return null===t?null:Math.sqrt(t)})(e[0])},count:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].length},var:{minParams:1,maxParams:1,evaluate:e=>w(e[0])}};function h(e){if(null===e)return null;let t=0,r=0;for(let n=0;n<e.length;n++){let a=e[n];if(null!==a){if(!m(a))throw new s.eS(s.f.InvalidValueForAggregateFunction);r++,t+=a}}return 0===r?null:t/e.length}function m(e){return"number"==typeof e}function v(e,t){if(null===e)return null;let r=null,n=null;for(let a of e){let e=a;e=a instanceof l.u||a instanceof c.n?a.toNumber():a instanceof f.ou?a.toMillis():a instanceof u.H?a.toMilliseconds():a,(null===r||"max"===t&&null!==n&&null!==e&&n<=e||"min"===t&&null!==n&&null!==e&&n>=e)&&(r=a,n=e)}return r}function w(e){if(null===e||0===(e=e.filter(e=>null!==e)).length)return null;let t=h(e);if(null===t)return null;let r=0;for(let n of e){if(!m(n))throw new s.eS(s.f.InvalidValueForAggregateFunction);r+=(t-n)**2}return r/(e.length-1)}class S{constructor(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static _fixDefaults(e){if(null!==e.precision||null!==e.secondary)throw new s.eS(s.f.PrimarySecondaryQualifiers)}static _parseSecondsComponent(e,t){if(t.includes(".")){let r=t.split(".");e.second=parseFloat(r[0]),e.millis=parseInt(r[1],10)}else e.second=parseFloat(t)}static createFromMilliseconds(e){let t=new S;return t.second=e/1e3,t}static createFromValueAndQualifier(e,t,r){let n=new S;if(n.op="-"===r?"-":"+","interval-period"===t.type){S._fixDefaults(t);let r=RegExp("^[0-9]{1,}$");if("year"===t.period||"month"===t.period)throw new s.eS(s.f.YearMonthIntervals);if("second"===t.period){if(!/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(e))throw new s.eS(s.f.IllegalInterval);S._parseSecondsComponent(n,e)}else{if(!r.test(e))throw new s.eS(s.f.IllegalInterval);n[t.period]=parseFloat(e)}}else{if(S._fixDefaults(t.start),S._fixDefaults(t.end),"year"===t.start.period||"month"===t.start.period||"year"===t.end.period||"month"===t.end.period)throw new s.eS(s.f.YearMonthIntervals);switch(t.start.period){case"day":switch(t.end.period){case"hour":if(!RegExp("^[0-9]{1,} [0-9]{1,}$").test(e))throw new s.eS(s.f.IllegalInterval);n[t.start.period]=parseFloat(e.split(" ")[0]),n[t.end.period]=parseFloat(e.split(" ")[1]);break;case"minute":if(!RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$").test(e))throw new s.eS(s.f.IllegalInterval);{n[t.start.period]=parseFloat(e.split(" ")[0]);let r=e.split(" ")[1].split(":");n.hour=parseFloat(r[0]),n.minute=parseFloat(r[1])}break;case"second":if(!RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(e))throw new s.eS(s.f.IllegalInterval);{n[t.start.period]=parseFloat(e.split(" ")[0]);let r=e.split(" ")[1].split(":");n.hour=parseFloat(r[0]),n.minute=parseFloat(r[1]),S._parseSecondsComponent(n,r[2])}break;default:throw new s.eS(s.f.IllegalInterval)}break;case"hour":switch(t.end.period){case"minute":if(!RegExp("^[0-9]{1,}:[0-9]{1,}$").test(e))throw new s.eS(s.f.IllegalInterval);n.hour=parseFloat(e.split(":")[0]),n.minute=parseFloat(e.split(":")[1]);break;case"second":if(!RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(e))throw new s.eS(s.f.IllegalInterval);{let t=e.split(":");n.hour=parseFloat(t[0]),n.minute=parseFloat(t[1]),S._parseSecondsComponent(n,t[2])}break;default:throw new s.eS(s.f.IllegalInterval)}break;case"minute":if("second"!==t.end.period||!RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(e))throw new s.eS(s.f.IllegalInterval);{let t=e.split(":");n.minute=parseFloat(t[0]),S._parseSecondsComponent(n,t[1])}break;default:throw new s.eS(s.f.IllegalInterval)}}return n}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*6e4+24*this.day*36e5+this.month*(365/12)*864e5+365*this.year*864e5)}}var I=r(22521);let g=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,y=/^(\d{1,2}):(\d{1,2})$/,T=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,N=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,O=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,x=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,b=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,C=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function A(e,t){if(t instanceof f.ld)return t===I.yV.instance?f.ou.fromMillis(e.getTime(),{zone:I.yV.instance}):f.ou.fromJSDate(e,{zone:t});switch(t){case"system":case"local":case null:return f.ou.fromJSDate(e);default:return"unknown"===t?.toLowerCase()?f.ou.fromMillis(e.getTime(),{zone:I.yV.instance}):f.ou.fromJSDate(e,{zone:t})}}function M(e){return"number"==typeof e}function E(e){return"string"==typeof e||e instanceof String}function F(e){return e instanceof S}function D(e){return e instanceof Date}function P(e){return e instanceof f.ou}function _(e){return e instanceof l.u}function L(e){return e instanceof c.n}function R(e){return e instanceof u.H}function U(e){let t=g.exec(e);if(null!==t){let[,e,r,n]=t,a=c.n.fromParts(parseInt(e,10),parseInt(r,10),parseInt(n,10),0);if(null!==a)return a;throw new s.eS(s.f.InvalidTime)}if(null!==(t=y.exec(e))){let[,e,r]=t,n=c.n.fromParts(parseInt(e,10),parseInt(r,10),0,0);if(null!==n)return n;throw new s.eS(s.f.InvalidTime)}if(null!==(t=T.exec(e))){let[,e,r,n,a]=t,i=c.n.fromParts(parseInt(e,10),parseInt(r,10),parseInt(n,10),parseInt(a,10));if(null!==i)return i}throw new s.eS(s.f.InvalidTime)}function V(e,t,r=!1){let n=O.exec(e);if(null!==n){let[,e,r,a,i,o,l,u]=n,c=f.ou.fromObject({year:parseInt(e,10),month:parseInt(r,10),day:parseInt(a,10),hour:parseInt(i,10),minute:parseInt(o,10),second:parseInt(l,10),millisecond:u?parseInt(u.replace(".",""),10):0},{zone:(0,I.L9)(t)});if(!1===c.isValid)throw new s.eS(s.f.InvalidTimeStamp);return c}if(null!==(n=x.exec(e))){let[,e,t,r,a,i,o,l,c,f,d]=n,p=u.H.fromParts(parseInt(e,10),parseInt(t,10),parseInt(r,10),parseInt(a,10),parseInt(i,10),parseInt(o,10),l?parseInt(l.replace(".",""),10):0,"-"===c,parseInt(f,10),parseInt(d,10));if(!1===p.isValid)throw new s.eS(s.f.InvalidTimeStamp);return p}if(null!==(n=b.exec(e))){let[,e,t,r,a,i,o,l,c]=n,f=u.H.fromParts(parseInt(e,10),parseInt(t,10),parseInt(r,10),parseInt(a,10),parseInt(i,10),0,0,"-"===o,parseInt(l,10),parseInt(c,10));if(!1===f.isValid)throw new s.eS(s.f.InvalidTimeStamp);return f}if(null!==(n=C.exec(e))){let[,e,r,a,i,o]=n,l=f.ou.fromObject({year:parseInt(e,10),month:parseInt(r,10),day:parseInt(a,10),hour:parseInt(i,10),minute:parseInt(o,10),second:0},{zone:(0,I.L9)(t)});if(!1===l.isValid)throw new s.eS(s.f.InvalidTimeStamp);return l}if(null!==(n=N.exec(e))){let[,e,r,a]=n,i=f.ou.fromObject({year:parseInt(e,10),month:parseInt(r,10),day:parseInt(a,10),hour:0,minute:0,second:0},{zone:(0,I.L9)(t)});if(!1===i.isValid)throw new s.eS(s.f.InvalidTimeStamp);return i}throw new s.eS(s.f.InvalidTimeStamp)}function J(e,t){let r=N.exec(e);if(null===r)try{return V(e,t)}catch{throw new s.eS(s.f.InvalidDate)}let[,n,a,i]=r,o=l.u.fromParts(parseInt(n,10),parseInt(a,10),parseInt(i,10));if(null===o)throw new s.eS(s.f.InvalidDate);return o}var $=r(44340);function k(e){return!!P(e)||!!R(e)}function H(e){return!!P(e)||!!_(e)||!!R(e)||!!L(e)}function Z(e){if(P(e))return e.toMillis();if(_(e))return e.toNumber();if(R(e))return e.toMilliseconds();throw new s.eS(s.f.InvalidDataType)}function z(e,t,r,n){if(null==e||null==t)return null;if(M(e)){if(M(t))return q(e,t,r);if(E(t))return function(e,t,r){let n=parseFloat(t);if(!isNaN(n))return q(e,n,r);let a=e.toString();switch(r){case"<>":return a!==t;case"=":return a===t;case">":return a>t;case"<":return a<t;case">=":return a>=t;case"<=":return a<=t}}(e,t,r);if(H(t)||_(t))throw new s.eS(s.f.InvalidOperator)}else if(E(e)){if(M(t))return function(e,t,r){let n=parseFloat(e);if(!isNaN(n))return q(n,t,r);let a=t.toString();switch(r){case"<>":return e!==a;case"=":return e===a;case">":return e>a;case"<":return e<a;case">=":return e>=a;case"<=":return e<=a}}(e,t,r);if(E(t))return function(e,t,r){switch(r){case"<>":return e!==t;case"=":return e===t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}}(e,t,r);if(P(t)||_(t)||L(t)||R(t))throw new s.eS(s.f.InvalidOperator)}else if(P(e)){if(k(t)){if(e instanceof f.ou&&(0,I.A4)(e.zone)){if(t instanceof f.ou&&!1===(0,I.A4)(t.zone)||t instanceof u.H)return Y(e,t,r)}else if(t instanceof f.ou&&(0,I.A4)(t.zone)&&(e instanceof f.ou&&!1===(0,I.A4)(e.zone)||e instanceof u.H))return Y(e,t,r);return q(Z(e),Z(t),r)}if(E(t))throw new s.eS(s.f.InvalidOperator);if(_(t))return function(e,t,r){let n=t.toDateTimeLuxon(e.zone);return q((e=e.startOf("day")).toMillis(),n.toMillis(),r)}(e,t,r);if(L(t)||M(t))throw new s.eS(s.f.InvalidOperator)}else if(_(e)){if(R(t))return function(e,t,r){let n=e.toDateTimeLuxon(t.toDateTime().zone);return t=t.startOfDay(),q(n.toMillis(),t.toMilliseconds(),r)}(e,t,r);if(P(t))return function(e,t,r){let n=e.toDateTimeLuxon(t.zone);return t=t.startOf("day"),q(n.toMillis(),t.toMillis(),r)}(e,t,r);if(E(t))throw new s.eS(s.f.InvalidOperator);if(_(t))return q(e.toNumber(),t.toNumber(),r);if(L(t)||M(t))throw new s.eS(s.f.InvalidOperator)}else if(L(e)){if(L(t))return q(e.toNumber(),t.toNumber(),r);if(E(t)||M(t)||_(t)||k(t))throw new s.eS(s.f.InvalidOperator)}else if(R(e)){if(k(t))return t instanceof f.ou&&(0,I.A4)(t.zone)?Y(e,t,r):q(Z(e),Z(t),r);if(E(t))throw new s.eS(s.f.InvalidOperator);if(_(t))return function(e,t,r){let n=t.toDateTimeLuxon(e.toDateTime().zone);return q((e=e.startOfDay()).toMilliseconds(),n.toMillis(),r)}(e,t,r);if(L(t)||M(t))throw new s.eS(s.f.InvalidOperator)}switch(r){case"<>":return e!==t;case"=":return e===t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}}function q(e,t,r){switch(r){case"<>":return e!==t;case"=":return e===t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}}function Y(e,t,r){e instanceof u.H&&(e=e.toDateTime()),t instanceof u.H&&(t=t.toDateTime());let n=B(e),a=B(t);switch(r){case"<>":return n!==a;case"=":return n===a;case">":return n>a;case"<":return n<a;case">=":return n>=a;case"<=":return n<=a}}function B(e){return 321408e5*e.year+26784e5*e.month+864e5*e.day+36e5*e.hour+6e4*e.minute+1e3*e.second+e.millisecond}function Q(e,t,r){let n=W[e.toLowerCase()];if(null==n)throw new s.eS(s.f.FunctionNotRecognized);if(t.length<n.minParams||t.length>n.maxParams)throw new s.eS(s.f.InvalidParameterCount,{name:e.toUpperCase()});return n.evaluate(t,r)}function j(e){return"string"==typeof e||e instanceof String}function G(e){return!D(e)&&!_(e)&&!P(e)&&!L(e)&&!R(e)}let W={extract:{minParams:2,maxParams:2,evaluate:([e,t])=>{if(null==t)return null;if(D(t))switch(e.toUpperCase()){case"SECOND":return t.getSeconds();case"MINUTE":return t.getMinutes();case"HOUR":return t.getHours();case"DAY":return t.getDate();case"MONTH":return t.getMonth()+1;case"YEAR":return t.getFullYear();case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":return 0}else if(P(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour;case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year}else if(_(t))switch(e.toUpperCase()){case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year}else if(L(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour}else if(R(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour;case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year;case"TIMEZONE_HOUR":return t.timezoneOffsetHour;case"TIMEZONE_MINUTE":return t.timezoneOffsetMinutes}throw new s.eS(s.f.InvalidFunctionParameters,{function:"EXTRACT"})}},substring:{minParams:2,maxParams:3,evaluate:e=>{if(2===e.length){let[t,r]=e;return null==t||null==r?null:t.toString().substring(r-1)}if(3===e.length){let[t,r,n]=e;return null==t||null==r||null==n?null:n<=0?"":t.toString().substring(r-1,r+n-1)}}},position:{minParams:2,maxParams:2,evaluate:([e,t])=>null==e||null==t?null:t.indexOf(e)+1},trim:{minParams:2,maxParams:3,evaluate:e=>{let t=3===e.length,r=t?e[1]:" ",n=t?e[2]:e[1];if(null==r||null==n)return null;let a=`(${(0,$.Qs)(r)})`;switch(e[0]){case"BOTH":return n.replaceAll(RegExp(`^${a}*|${a}*$`,"g"),"");case"LEADING":return n.replaceAll(RegExp(`^${a}*`,"g"),"");case"TRAILING":return n.replaceAll(RegExp(`${a}*$`,"g"),"")}throw new s.eS(s.f.InvalidFunctionParameters,{function:"TRIM"})}},abs:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.abs(e[0])},ceiling:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.ceil(e[0])},floor:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.floor(e[0])},log:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])},log10:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sin(e[0])},cos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.cos(e[0])},tan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.tan(e[0])},asin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.asin(e[0])},acos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.acos(e[0])},atan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.atan(e[0])},sign:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0]>0?1:e[1]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]**e[1]},mod:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]%e[1]},round:{minParams:1,maxParams:2,evaluate:e=>{let t=e[0],r=2===e.length?10**e[1]:1;return null==t?null:Math.round(t*r)/r}},truncate:{minParams:1,maxParams:2,evaluate:e=>null==e[0]?null:1===e.length?parseInt(e[0].toFixed(0),10):parseFloat(e[0].toFixed(e[1]))},char_length:{minParams:1,maxParams:1,evaluate:e=>j(e[0])?e[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:e=>{let t="";for(let r=0;r<e.length;r++){if(null==e[r])return null;t+=e[r].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:e=>{for(let t of e)if(null!==t)return t;return null}},cosh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.cosh(e[0])},sinh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sinh(e[0])},tanh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.tanh(e[0])},nullif:{minParams:2,maxParams:2,evaluate:(e,t)=>z(e[0],e[1],"=")?null:e[0]},cast:{minParams:2,maxParams:2,evaluate:(e,t)=>{let r=e[0],n=e[1];if(null===r)return null;switch(n.type){case"integer":{if(!G(r))throw new s.eS(s.f.CannotCastValue);let e=parseInt(r,10);if(isNaN(e))throw new s.eS(s.f.CannotCastValue);return e}case"smallint":{if(!G(r))throw new s.eS(s.f.CannotCastValue);let e=parseInt(r,10);if(isNaN(e)||e>32767||e<-32767)throw new s.eS(s.f.CannotCastValue);return e}case"float":case"real":{if(!G(r))throw new s.eS(s.f.CannotCastValue);let e=parseFloat(r);if(isNaN(e))throw new s.eS(s.f.CannotCastValue);return e}case"time":return function(e){if(D(e))return c.n.fromDateJS(e);if(P(e))return c.n.fromDateTime(e);if(_(e))throw new s.eS(s.f.CannotCastValue);if(L(e))return e;if(R(e))return c.n.fromSqlTimeStampOffset(e);if(j(e))return U(e);throw new s.eS(s.f.CannotCastValue)}(r);case"date":return function(e){if(D(e))return l.u.fromDateJS(e);if(P(e))return l.u.fromParts(e.year,e.month,e.day);if(_(e))return e;if(L(e)||R(e)&&null===l.u.fromParts(e.year,e.month,e.day))throw new s.eS(s.f.CannotCastValue);if(j(e)){let t=l.u.fromReader(e);if(null!==t&&t.isValid)return t}throw new s.eS(s.f.CannotCastValue)}(r);case"timestamp":return function(e,t,r){if(D(e))return A(e,t);if(P(e))return e;if(_(e))return e.toDateTimeLuxon("unknown");if(L(e))throw new s.eS(s.f.CannotCastValue);if(R(e))return e;if(j(e))return V(e,"unknown",r);throw new s.eS(s.f.CannotCastValue)}(r,t,!0===n.withtimezone);case"varchar":{let e=function e(t){return _(t)||L(t)?t.toString():R(t)?t.toSQLValue():P(t)?0===t.millisecond?t.toFormat("yyyy-LL-dd HH:mm:ss"):t.toSQL({includeOffset:!1}):D(t)?e(f.ou.fromJSDate(t)):t.toString()}(r);if(e.length>n.size)throw new s.eS(s.f.CannotCastValue);return e}default:throw new s.eS(s.f.InvalidDataType)}}}};function K(e,t,r,n){if("||"===e)return Q("concat",[t,r],n);if(null===t||null===r)return null;if(M(t)){if(M(r))return X(t,r,e);if(F(r))return function(e,t,r){switch(r){case"+":return S.createFromMilliseconds(e+t.valueInMilliseconds());case"-":return S.createFromMilliseconds(e-t.valueInMilliseconds());case"*":return S.createFromMilliseconds(e*t.valueInMilliseconds());case"/":return S.createFromMilliseconds(e/t.valueInMilliseconds())}throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(L(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(_(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(R(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(P(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(E(r))return function(e,t,r){let n=parseFloat(t);if(isNaN(n))throw new s.eS(s.f.InvalidOperator);return X(e,n,r)}(t,r,e);throw new s.eS(s.f.InvalidOperator)}if(_(t)){if(M(r))return function(e,t,r){let n=1e3*t*86400;switch(r){case"+":return e.plus("milliseconds",n);case"-":return e.plus("milliseconds",-1*n)}throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(F(r))return function(e,t,r){switch(r){case"+":return e.plus("milliseconds",t.valueInMilliseconds());case"-":return e.plus("milliseconds",-1*t.valueInMilliseconds())}throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(L(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(_(r))return function(e,t,r){if("-"===r)return e.toDateTimeLuxon("UTC").diff(t.toDateTimeLuxon("UTC")).as("days");throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(R(r))return function(e,t,r){if("-"===r)return e.toDateTimeLuxon(t.toDateTime().zone).diff(t.toDateTime()).as("days");throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(P(r))return function(e,t,r){if("-"===r)return e.toDateTimeLuxon(t.zone).diff(t).as("days");throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(E(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();throw new s.eS(s.f.InvalidOperator)}if(L(t)){if(M(r))return function(e,t,r){let n=1e3*t*86400;switch(r){case"+":return e.plus("milliseconds",n);case"-":return e.plus("milliseconds",-1*n)}throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(F(r))return function(e,t,r){switch(r){case"+":return e.plus("milliseconds",t.valueInMilliseconds());case"-":return e.plus("milliseconds",-1*t.valueInMilliseconds())}throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(L(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(_(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(R(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(P(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(E(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();throw new s.eS(s.f.InvalidOperator)}if(F(t)){if(M(r))return function(e,t,r){switch(r){case"+":return S.createFromMilliseconds(e.valueInMilliseconds()+t);case"-":return S.createFromMilliseconds(e.valueInMilliseconds()-t);case"*":return S.createFromMilliseconds(e.valueInMilliseconds()*t);case"/":return S.createFromMilliseconds(e.valueInMilliseconds()/t)}throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(F(r))return function(e,t,r){switch(r){case"+":return S.createFromMilliseconds(e.valueInMilliseconds()+t.valueInMilliseconds());case"-":return S.createFromMilliseconds(e.valueInMilliseconds()-t.valueInMilliseconds());case"*":return S.createFromMilliseconds(e.valueInMilliseconds()*t.valueInMilliseconds());case"/":return S.createFromMilliseconds(e.valueInMilliseconds()/t.valueInMilliseconds())}throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(L(r))return function(e,t,r){if("+"===r)return t.plus("milliseconds",e.valueInMilliseconds());throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(_(r))return function(e,t,r){if("+"===r)return t.plus("milliseconds",e.valueInMilliseconds());throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(R(r))return function(e,t,r){if("+"===r)return t.addMilliseconds(e.valueInMilliseconds());throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(P(r))return function(e,t,r){switch(r){case"+":return t.plus({milliseconds:e.valueInMilliseconds()});case"-":return e.valueInMilliseconds()-t.toMillis()}throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(E(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();throw new s.eS(s.f.InvalidOperator)}if(P(t)){if(M(r))return function(e,t,r){let n=1e3*t*86400;switch(r){case"+":return e.plus({milliseconds:n});case"-":return e.minus({milliseconds:n})}throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(F(r))return function(e,t,r){switch(r){case"+":return e.plus({milliseconds:t.valueInMilliseconds()});case"-":return e.minus({milliseconds:t.valueInMilliseconds()})}throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(L(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(_(r))return function(e,t,r){if("-"===r)return e.diff(t.toDateTimeLuxon(e.zone)).as("days");throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(R(r))return function(e,t,r){if("-"===r)return e.diff(t.toDateTime()).as("days");throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(P(r))return function(e,t,r){if("-"===r)return e.diff(t).as("days");throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(E(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();throw new s.eS(s.f.InvalidOperator)}if(R(t)){if(M(r))return function(e,t,r){let n=1e3*t*86400;switch(r){case"+":return e.addMilliseconds(n);case"-":return e.addMilliseconds(-1*n)}throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(F(r))return function(e,t,r){switch(r){case"+":return e.addMilliseconds(t.valueInMilliseconds());case"-":return e.addMilliseconds(-1*t.valueInMilliseconds())}throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(L(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(_(r))return function(e,t,r){if("-"===r)return e.toDateTime().diff(t.toDateTimeLuxon(e.toDateTime().zone)).as("days");throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(R(r))return function(e,t,r){if("-"===r)return e.toDateTime().diff(t.toDateTime()).as("days");throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(P(r))return function(e,t,r){if("-"===r)return e.toDateTime().diff(t).as("days");throw new s.eS(s.f.InvalidOperator)}(t,r,e);if(E(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();throw new s.eS(s.f.InvalidOperator)}if(E(t)){if(M(r))return function(e,t,r){let n=parseFloat(e);if(isNaN(n))throw new s.eS(s.f.InvalidOperator);return X(n,t,r)}(t,r,e);if(F(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(L(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(_(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(R(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(P(r))return function(e,t,r){throw new s.eS(s.f.InvalidOperator)}();if(E(r))return function(e,t,r){if("+"===r)return e+t;throw new s.eS(s.f.InvalidOperator)}(t,r,e)}throw new s.eS(s.f.InvalidOperator)}function X(e,t,r){switch(r){case"+":return e+t;case"-":return e-t;case"*":return e*t;case"/":return e/t}throw new s.eS(s.f.InvalidOperator)}r(19324);var ee,et={exports:{}};ee=function(){function e(t,r,n,a){var i=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(i,e.prototype),i.expected=r,i.found=n,i.location=a,i.name="SyntaxError",i}function t(e,t,r){return r=r||" ",e.length>t?e:(t-=e.length,e+(r+=r.repeat(t)).slice(0,t))}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.prototype.format=function(e){var r="Error: "+this.message;if(this.location){var n,a=null;for(n=0;n<e.length;n++)if(e[n].source===this.location.source){a=e[n].text.split(/\r\n|\n|\r/g);break}var i=this.location.start,s=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(i):i,o=this.location.source+":"+s.line+":"+s.column;if(a){var l=this.location.end,u=t("",s.line.toString().length," "),c=a[i.line-1],f=(i.line===l.line?l.column:c.length+1)-i.column||1;r+="\n --> "+o+"\n"+u+" |\n"+s.line+" | "+c+"\n"+u+" | "+t("",i.column-1," ")+t("",f,"^")}else r+="\n at "+o}return r},e.buildMessage=function(e,t){var r={literal:function(e){return'"'+a(e.text)+'"'},class:function(e){var t=e.parts.map(function(e){return Array.isArray(e)?i(e[0])+"-"+i(e[1]):i(e)});return"["+(e.inverted?"^":"")+t.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function a(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+n(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+n(e)})}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+n(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+n(e)})}function s(e){return r[e.type](e)}return"Expected "+function(e){var t,r,n=e.map(s);if(n.sort(),n.length>0){for(t=1,r=1;t<n.length;t++)n[t-1]!==n[t]&&(n[r]=n[t],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+(t?'"'+a(t)+'"':"end of input")+" found."},{SyntaxError:e,parse:function(t,r){var n,a,i,s,o={},l=(r=void 0!==r?r:{}).grammarSource,u={start:e9},c=e9,f=/^[A-Za-z_\x80-\uFFFF]/,d=/^[A-Za-z0-9_]/,p=/^[A-Za-z0-9_.\x80-\uFFFF]/,h=/^["]/,m=/^[^']/,v=/^[0-9]/,w=/^[eE]/,S=/^[+\-]/,I=/^[ \t\n\r]/,g=/^[^`]/,y=eX("!",!1),T=eX("=",!1),N=eX(">=",!1),O=eX(">",!1),x=eX("<=",!1),b=eX("<>",!1),C=eX("<",!1),A=eX("!=",!1),M=eX("+",!1),E=eX("-",!1),F=eX("||",!1),D=eX("*",!1),P=eX("/",!1),_=e0([["A","Z"],["a","z"],"_",["\x80","￿"]],!1,!1),L=e0([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),R=e0([["A","Z"],["a","z"],["0","9"],"_",".",["\x80","￿"]],!1,!1),U=e0(['"'],!1,!1),V=eX("@",!1),J=eX("'",!1),$=eX("N'",!1),k=eX("''",!1),H=e0(["'"],!0,!1),Z=eX(".",!1),z=e0([["0","9"]],!1,!1),q=e0(["e","E"],!1,!1),Y=e0(["+","-"],!1,!1),B=eX("NULL",!0),Q=eX("TRUE",!0),j=eX("FALSE",!0),G=eX("IN",!0),W=eX("IS",!0),K=eX("LIKE",!0),X=eX("ESCAPE",!0),ee=eX("NOT",!0),et=eX("AND",!0),er=eX("OR",!0),en=eX("BETWEEN",!0),ea=eX("FROM",!0),ei=eX("FOR",!0),es=eX("SUBSTRING",!0),eo=eX("EXTRACT",!0),el=eX("TRIM",!0),eu=eX("POSITION",!0),ec=eX("TIMESTAMP",!0),ef=eX("DATE",!0),ed=eX("TIME",!0),ep=eX("LEADING",!0),eh=eX("TRAILING",!0),em=eX("BOTH",!0),ev=eX("CAST",!0),ew=eX("AS",!0),eS=eX("INTEGER",!0),eI=eX("SMALLINT",!0),eg=eX("FLOAT",!0),ey=eX("REAL",!0),eT=eX("VARCHAR",!0),eN=eX("TO",!0),eO=eX("INTERVAL",!0),ex=eX("YEAR",!0),eb=eX("TIMEZONE_HOUR",!0),eC=eX("TIMEZONE_MINUTE",!0),eA=eX("MONTH",!0),eM=eX("DAY",!0),eE=eX("HOUR",!0),eF=eX("MINUTE",!0),eD=eX("SECOND",!0),eP=eX("CASE",!0),e_=eX("END",!0),eL=eX("WHEN",!0),eR=eX("THEN",!0),eU=eX("ELSE",!0),eV=eX(",",!1),eJ=eX("(",!1),e$=eX(")",!1),ek=e0([" ","	","\n","\r"],!1,!1),eH=eX("`",!1),eZ=e0(["`"],!0,!1),ez=function(e,t){var r={type:"expression-list"},n=function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n][3]);return r}(e,t);return r.value=n,r},eq=function(){return"'"},eY=0,eB=0,eQ=[{line:1,column:1}],ej=0,eG=[],eW=0;if("startRule"in r){if(!(r.startRule in u))throw Error("Can't start parsing from rule \""+r.startRule+'".');c=u[r.startRule]}function eK(t,r){throw new e(t,null,null,r=void 0!==r?r:e2(eB,eY))}function eX(e,t){return{type:"literal",text:e,ignoreCase:t}}function e0(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function e1(e){var r,n=eQ[e];if(n)return n;for(r=e-1;!eQ[r];)r--;for(n={line:(n=eQ[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return eQ[e]=n,n}function e2(e,t,r){var n=e1(e),a=e1(t);return{source:l,start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:a.line,column:a.column}}}function e4(e){eY<ej||(eY>ej&&(ej=eY,eG=[]),eG.push(e))}function e9(){var e,t;return e=eY,t1(),(t=e6())!==o?(t1(),eB=e,e=t):(eY=e,e=o),e}function e3(){var e,t,r,n,a,i,s,l;if(e=eY,(t=e6())!==o){for(r=[],n=eY,a=t1(),(i=tK())!==o?(s=t1(),(l=e6())!==o?n=a=[a,i,s,l]:(eY=n,n=o)):(eY=n,n=o);n!==o;)r.push(n),n=eY,a=t1(),(i=tK())!==o?(s=t1(),(l=e6())!==o?n=a=[a,i,s,l]:(eY=n,n=o)):(eY=n,n=o);eB=e,e=ez(t,r)}else eY=e,e=o;return e}function e6(){var e,t,r,n,a,i,s,l;if(e=eY,(t=e7())!==o){for(r=[],n=eY,a=t1(),(i=t_())!==o?(s=t1(),(l=e7())!==o?n=a=[a,i,s,l]:(eY=n,n=o)):(eY=n,n=o);n!==o;)r.push(n),n=eY,a=t1(),(i=t_())!==o?(s=t1(),(l=e7())!==o?n=a=[a,i,s,l]:(eY=n,n=o)):(eY=n,n=o);eB=e,e=t9(t,r)}else eY=e,e=o;return e}function e7(){var e,t,r,n,a,i,s,l;if(e=eY,(t=e5())!==o){for(r=[],n=eY,a=t1(),(i=tP())!==o?(s=t1(),(l=e5())!==o?n=a=[a,i,s,l]:(eY=n,n=o)):(eY=n,n=o);n!==o;)r.push(n),n=eY,a=t1(),(i=tP())!==o?(s=t1(),(l=e5())!==o?n=a=[a,i,s,l]:(eY=n,n=o)):(eY=n,n=o);eB=e,e=t9(t,r)}else eY=e,e=o;return e}function e5(){var e,r,n,a,i,s,l,u,c,f,d,p,h,m,v,w,S,I,g,N,O,x,b,C,A,M,E,F,D,P,_,L;return e=eY,(r=tD())===o&&(r=eY,33===t.charCodeAt(eY)?(n="!",eY++):(n=o,0===eW&&e4(y)),n!==o?(a=eY,eW++,61===t.charCodeAt(eY)?(i="=",eY++):(i=o,0===eW&&e4(T)),eW--,i===o?a=void 0:(eY=a,a=o),a!==o?r=n=[n,a]:(eY=r,r=o)):(eY=r,r=o)),r!==o?(n=t1(),(a=e5())!==o?(eB=e,e={type:"unary-expression",operator:"NOT",expr:a}):(eY=e,e=o)):(eY=e,e=o),e===o&&(s=eY,(l=tr())!==o?(t1(),(f=function(){var e,t,r,n,a,i,s;if(e=eY,t=[],r=eY,n=t1(),(a=e8())!==o?(i=t1(),(s=tr())!==o?r=n=[n,a,i,s]:(eY=r,r=o)):(eY=r,r=o),r!==o)for(;r!==o;)t.push(r),r=eY,n=t1(),(a=e8())!==o?(i=t1(),(s=tr())!==o?r=n=[n,a,i,s]:(eY=r,r=o)):(eY=r,r=o);else t=o;return t!==o&&(eB=e,t={type:"arithmetic",tail:t}),e=t}())===o&&(d=eY,(p=tt())!==o?(t1(),(h=tX())!==o?(t1(),(m=e3())!==o?(t1(),t0()!==o?(eB=d,d={op:p,right:m}):(eY=d,d=o)):(eY=d,d=o)):(eY=d,d=o)):(eY=d,d=o),d===o&&(d=eY,(p=tt())!==o?(t1(),(h=tX())!==o?(t1(),(m=t0())!==o?(eB=d,d={op:p,right:{type:"expression-list",value:[]}}):(eY=d,d=o)):(eY=d,d=o)):(eY=d,d=o),d===o&&(d=eY,(p=tt())!==o?(t1(),(h=tp())!==o?(eB=d,d={op:p,right:h}):(eY=d,d=o)):(eY=d,d=o))),(f=d)===o)&&(v=eY,(w=tD())!==o?(t1(),(S=tL())!==o?(t1(),(I=tr())!==o?(t1(),(g=tP())!==o?(t1(),(N=tr())!==o?(eB=v,v={op:"NOT"+S,right:{type:"expression-list",value:[I,N]}}):(eY=v,v=o)):(eY=v,v=o)):(eY=v,v=o)):(eY=v,v=o)):(eY=v,v=o),v===o&&(v=eY,(w=tL())!==o?(t1(),(S=tr())!==o?(t1(),(I=tP())!==o?(t1(),(g=tr())!==o?(eB=v,v={op:w,right:{type:"expression-list",value:[S,g]}}):(eY=v,v=o)):(eY=v,v=o)):(eY=v,v=o)):(eY=v,v=o)),(f=v)===o)&&(O=eY,(x=tE())!==o?(t1(),(b=tD())!==o?(t1(),(C=tr())!==o?(eB=O,O={op:x+"NOT",right:C}):(eY=O,O=o)):(eY=O,O=o)):(eY=O,O=o),O===o&&(O=eY,(x=tE())!==o?(t1(),(b=tr())!==o?(eB=O,O={op:x,right:b}):(eY=O,O=o)):(eY=O,O=o)),(f=O)===o)&&(A=eY,(M=te())!==o?(t1(),(E=tI())!==o?(t1(),(D=eY,"escape"===t.substr(eY,6).toLowerCase()?(P=t.substr(eY,6),eY+=6):(P=o,0===eW&&e4(X)),P!==o?(_=eY,eW++,L=tu(),eW--,L===o?_=void 0:(eY=_,_=o),_!==o?(eB=D,D="ESCAPE"):(eY=D,D=o)):(eY=D,D=o),D!==o)?(t1(),(F=tg())!==o?(eB=A,A={op:M,right:E,escape:F.value}):(eY=A,A=o)):(eY=A,A=o)):(eY=A,A=o)):(eY=A,A=o),A===o&&(A=eY,(M=te())!==o?(t1(),(E=tI())!==o?(eB=A,A={op:M,right:E,escape:""}):(eY=A,A=o)):(eY=A,A=o)),f=A),(u=f)===o&&(u=null),eB=s,s=""==(c=u)||null==c||null==c?l:"arithmetic"==c.type?t9(l,c.tail):t4(c.op,l,c.right,c.escape)):(eY=s,s=o),e=s),e}function e8(){var e;return">="===t.substr(eY,2)?(e=">=",eY+=2):(e=o,0===eW&&e4(N)),e===o&&(62===t.charCodeAt(eY)?(e=">",eY++):(e=o,0===eW&&e4(O)),e===o&&("<="===t.substr(eY,2)?(e="<=",eY+=2):(e=o,0===eW&&e4(x)),e===o&&("<>"===t.substr(eY,2)?(e="<>",eY+=2):(e=o,0===eW&&e4(b)),e===o&&(60===t.charCodeAt(eY)?(e="<",eY++):(e=o,0===eW&&e4(C)),e===o&&(61===t.charCodeAt(eY)?(e="=",eY++):(e=o,0===eW&&e4(T)),e===o&&("!="===t.substr(eY,2)?(e="!=",eY+=2):(e=o,0===eW&&e4(A)))))))),e}function te(){var e,t,r,n,a,i;return e=eY,t=eY,(r=tD())!==o?(n=t1(),(a=tF())!==o?t=r=[r,n,a]:(eY=t,t=o)):(eY=t,t=o),t!==o&&(eB=e,t=(i=t)[0]+" "+i[2]),(e=t)===o&&(e=tF()),e}function tt(){var e,t,r,n,a,i;return e=eY,t=eY,(r=tD())!==o?(n=t1(),(a=tM())!==o?t=r=[r,n,a]:(eY=t,t=o)):(eY=t,t=o),t!==o&&(eB=e,t=(i=t)[0]+" "+i[2]),(e=t)===o&&(e=tM()),e}function tr(){var e,t,r,n,a,i,s,l;if(e=eY,(t=ta())!==o){for(r=[],n=eY,a=t1(),(i=tn())!==o?(s=t1(),(l=ta())!==o?n=a=[a,i,s,l]:(eY=n,n=o)):(eY=n,n=o);n!==o;)r.push(n),n=eY,a=t1(),(i=tn())!==o?(s=t1(),(l=ta())!==o?n=a=[a,i,s,l]:(eY=n,n=o)):(eY=n,n=o);eB=e,e=t9(t,r)}else eY=e,e=o;return e}function tn(){var e;return 43===t.charCodeAt(eY)?(e="+",eY++):(e=o,0===eW&&e4(M)),e===o&&(45===t.charCodeAt(eY)?(e="-",eY++):(e=o,0===eW&&e4(E)),e===o&&("||"===t.substr(eY,2)?(e="||",eY+=2):(e=o,0===eW&&e4(F)))),e}function ta(){var e,t,r,n,a,i,s,l;if(e=eY,(t=ts())!==o){for(r=[],n=eY,a=t1(),(i=ti())!==o?(s=t1(),(l=ts())!==o?n=a=[a,i,s,l]:(eY=n,n=o)):(eY=n,n=o);n!==o;)r.push(n),n=eY,a=t1(),(i=ti())!==o?(s=t1(),(l=ts())!==o?n=a=[a,i,s,l]:(eY=n,n=o)):(eY=n,n=o);eB=e,e=t9(t,r)}else eY=e,e=o;return e}function ti(){var e;return 42===t.charCodeAt(eY)?(e="*",eY++):(e=o,0===eW&&e4(D)),e===o&&(47===t.charCodeAt(eY)?(e="/",eY++):(e=o,0===eW&&e4(P))),e}function ts(){var e,r,n,a,i,s,l,u,c,f,d,p,h,m,v,w,S,I,y,T,N,O,x,b,C,A,F,D,P,_,L,R,U,V,J,$,k,H,Z,z,q,Y,G,W,K,X,ee,et,er,en,ea,el,ec,ef,ed,ep,eh,em,eN,eO,ex,eA,eM,eE,eF,eD,eP,e_,eL,eR,eU,eV,eJ,e$,ek,ez,eq,eQ,ej,eG,eX,e0,e1,e2,e9,e7,e5,e8,te,tt,tr,tn,ta,ti,ts,tv,tw,tS,tA,tE,tF,tD,tP,t_,tL,tG,tW,tK,t2,t4,t9,t3,t6,t7,t5,t8,re,rt,rr,rn,ra,ri,rs,ro,rl,ru,rc,rf;return(n=tg())===o&&(a=eY,(u=eY,(c=tO())!==o&&(f=tx())!==o&&(d=tb())!==o?(eB=u,u=parseFloat(c+f+d)):(eY=u,u=o),u===o&&(u=eY,(c=tO())!==o&&(f=tx())!==o?(eB=u,u=parseFloat(c+f)):(eY=u,u=o),u===o&&(u=eY,(c=tO())!==o&&(f=tb())!==o?(eB=u,u=parseFloat(c+f)):(eY=u,u=o),u===o&&(u=eY,(c=tO())!==o&&(eB=u,c=parseFloat(c)),u=c))),(i=u)!==o)?(s=eY,eW++,l=tl(),eW--,l===o?s=void 0:(eY=s,s=o),s!==o?(eB=a,a={type:"number",value:i}):(eY=a,a=o)):(eY=a,a=o),(n=a)===o)&&(p=eY,m=eY,"true"===t.substr(eY,4).toLowerCase()?(v=t.substr(eY,4),eY+=4):(v=o,0===eW&&e4(Q)),v!==o?(w=eY,eW++,S=tu(),eW--,S===o?w=void 0:(eY=w,w=o),w!==o?m=v=[v,w]:(eY=m,m=o)):(eY=m,m=o),(h=m)!==o&&(eB=p,h={type:"boolean",value:!0}),(p=h)===o&&(p=eY,I=eY,"false"===t.substr(eY,5).toLowerCase()?(y=t.substr(eY,5),eY+=5):(y=o,0===eW&&e4(j)),y!==o?(T=eY,eW++,N=tu(),eW--,N===o?T=void 0:(eY=T,T=o),T!==o?I=y=[y,T]:(eY=I,I=o)):(eY=I,I=o),(h=I)!==o&&(eB=p,h={type:"boolean",value:!1}),p=h),(n=p)===o)&&(O=eY,b=eY,"null"===t.substr(eY,4).toLowerCase()?(C=t.substr(eY,4),eY+=4):(C=o,0===eW&&e4(B)),C!==o?(A=eY,eW++,F=tu(),eW--,F===o?A=void 0:(eY=A,A=o),A!==o?b=C=[C,A]:(eY=b,b=o)):(eY=b,b=o),(x=b)!==o&&(eB=O,x={type:"null",value:null}),(n=O=x)===o)&&(t_=eY,tJ()!==o?(t1(),(tL=tI())!==o?(eB=t_,"string"===tL.type&&(tG=tL.value,!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(tG)&&eK("Date literal is invalid")),t_={type:"date",value:tL.value}):(eY=t_,t_=o)):(eY=t_,t_=o),(n=t_)===o)&&(tW=eY,tV()!==o?(t1(),(tK=tI())!==o?(eB=tW,"string"===tK.type&&(t2=tK.value,!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(t2)&&eK("Timestamp literal is invalid")),tW={type:"timestamp",value:tK.value}):(eY=tW,tW=o)):(eY=tW,tW=o),(n=tW)===o)&&(D=eY,tk()!==o?(t1(),45===t.charCodeAt(eY)?(P="-",eY++):(P=o,0===eW&&e4(E)),P===o&&(43===t.charCodeAt(eY)?(P="+",eY++):(P=o,0===eW&&e4(M))),P!==o?(t1(),(_=tI())!==o?(t1(),(L=tm())!==o?(eB=D,D={type:"interval",value:_,qualifier:L,op:P}):(eY=D,D=o)):(eY=D,D=o)):(eY=D,D=o)):(eY=D,D=o),D===o&&(D=eY,tk()!==o?(t1(),(P=tI())!==o?(t1(),(_=tm())!==o?(eB=D,D={type:"interval",value:P,qualifier:_,op:""}):(eY=D,D=o)):(eY=D,D=o)):(eY=D,D=o)),(n=D)===o)&&(t4=eY,t$()!==o?(t1(),(t9=tI())!==o?(eB=t4,"string"===t9.type&&(t3=t9.value,!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(t3)&&eK("Time literal is invalid")),t4={type:"time",value:t9.value}):(eY=t4,t4=o)):(eY=t4,t4=o),n=t4),(e=n)===o&&(R=eY,(J=eY,"extract"===t.substr(eY,7).toLowerCase()?($=t.substr(eY,7),eY+=7):($=o,0===eW&&e4(eo)),$!==o?(k=eY,eW++,H=tu(),eW--,H===o?k=void 0:(eY=k,k=o),k!==o?(eB=J,J="EXTRACT"):(eY=J,J=o)):(eY=J,J=o),J!==o)?(t1(),tX()!==o?(t1(),((Z=tH())===o&&(Z=tZ())===o&&(Z=tz())===o&&(Z=tq())===o&&(Z=tY())===o&&(Z=tB())===o&&(z=eY,"timezone_hour"===t.substr(eY,13).toLowerCase()?(q=t.substr(eY,13),eY+=13):(q=o,0===eW&&e4(eb)),q!==o?(Y=eY,eW++,G=tu(),eW--,G===o?Y=void 0:(eY=Y,Y=o),Y!==o?(eB=z,z="TIMEZONE_HOUR"):(eY=z,z=o)):(eY=z,z=o),(Z=z)===o)&&(W=eY,"timezone_minute"===t.substr(eY,15).toLowerCase()?(K=t.substr(eY,15),eY+=15):(K=o,0===eW&&e4(eC)),K!==o?(X=eY,eW++,ee=tu(),eW--,ee===o?X=void 0:(eY=X,X=o),X!==o?(eB=W,W="TIMEZONE_MINUTE"):(eY=W,W=o)):(eY=W,W=o),Z=W),(U=Z)!==o)?(t1(),tR()!==o?(t1(),(V=e6())!==o?(t1(),t0()!==o?(eB=R,R={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:U},V]}}):(eY=R,R=o)):(eY=R,R=o)):(eY=R,R=o)):(eY=R,R=o)):(eY=R,R=o)):(eY=R,R=o),(e=R)===o)&&(t6=eY,(ra=eY,"substring"===t.substr(eY,9).toLowerCase()?(ri=t.substr(eY,9),eY+=9):(ri=o,0===eW&&e4(es)),ri!==o?(rs=eY,eW++,ro=tu(),eW--,ro===o?rs=void 0:(eY=rs,rs=o),rs!==o?(eB=ra,ra="SUBSTRING"):(eY=ra,ra=o)):(eY=ra,ra=o),ra!==o)?(t1(),tX()!==o?(t1(),(t7=e6())!==o?(t1(),tR()!==o?(t1(),(t5=e6())!==o?(t1(),t8=eY,(rl=eY,"for"===t.substr(eY,3).toLowerCase()?(ru=t.substr(eY,3),eY+=3):(ru=o,0===eW&&e4(ei)),ru!==o?(rc=eY,eW++,rf=tu(),eW--,rf===o?rc=void 0:(eY=rc,rc=o),rc!==o?(eB=rl,rl="FOR"):(eY=rl,rl=o)):(eY=rl,rl=o),(re=rl)!==o)?(rt=t1(),(rr=e6())!==o?t8=re=[re,rt,rr,t1()]:(eY=t8,t8=o)):(eY=t8,t8=o),t8===o&&(t8=null),(re=t0())!==o?(eB=t6,t6={type:"function",name:"substring",args:{type:"expression-list",value:(rn=t8)?[t7,t5,rn[2]]:[t7,t5]}}):(eY=t6,t6=o)):(eY=t6,t6=o)):(eY=t6,t6=o)):(eY=t6,t6=o)):(eY=t6,t6=o)):(eY=t6,t6=o),(e=t6)===o)&&(et=eY,tU()!==o?(t1(),tX()!==o?(t1(),(er=th())===o&&(er=null),t1(),(en=e6())!==o?(t1(),tR()!==o?(t1(),(ea=e6())!==o?(t1(),t0()!==o?(eB=et,et={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:er??"BOTH"},en,ea]}}):(eY=et,et=o)):(eY=et,et=o)):(eY=et,et=o)):(eY=et,et=o)):(eY=et,et=o)):(eY=et,et=o),et===o&&(et=eY,tU()!==o?(t1(),tX()!==o?(t1(),(er=th())===o&&(er=null),t1(),(en=e6())!==o?(t1(),t0()!==o?(eB=et,et={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:er??"BOTH"},en]}}):(eY=et,et=o)):(eY=et,et=o)):(eY=et,et=o)):(eY=et,et=o)),(e=et)===o)&&(el=eY,(ed=eY,"position"===t.substr(eY,8).toLowerCase()?(ep=t.substr(eY,8),eY+=8):(ep=o,0===eW&&e4(eu)),ep!==o?(eh=eY,eW++,em=tu(),eW--,em===o?eh=void 0:(eY=eh,eh=o),eh!==o?(eB=ed,ed="POSITION"):(eY=ed,ed=o)):(eY=ed,ed=o),ed!==o)?(t1(),tX()!==o?(t1(),(ec=e6())!==o?(t1(),tM()!==o?(t1(),(ef=e6())!==o?(t1(),t0()!==o?(eB=el,el={type:"function",name:"position",args:{type:"expression-list",value:[ec,ef]}}):(eY=el,el=o)):(eY=el,el=o)):(eY=el,el=o)):(eY=el,el=o)):(eY=el,el=o)):(eY=el,el=o),(e=el)===o)&&(eN=eY,(eA=eY,"cast"===t.substr(eY,4).toLowerCase()?(eM=t.substr(eY,4),eY+=4):(eM=o,0===eW&&e4(ev)),eM!==o?(eE=eY,eW++,eF=tu(),eW--,eF===o?eE=void 0:(eY=eE,eE=o),eE!==o?(eB=eA,eA="CAST"):(eY=eA,eA=o)):(eY=eA,eA=o),eA!==o)?(t1(),tX()!==o?(t1(),(eO=e6())!==o?(t1(),(eD=eY,"as"===t.substr(eY,2).toLowerCase()?(eP=t.substr(eY,2),eY+=2):(eP=o,0===eW&&e4(ew)),eP!==o?(e_=eY,eW++,eL=tu(),eW--,eL===o?e_=void 0:(eY=e_,e_=o),e_!==o?(eB=eD,eD="AS"):(eY=eD,eD=o)):(eY=eD,eD=o),eD!==o)?(t1(),(eR=eY,eJ=eY,"integer"===t.substr(eY,7).toLowerCase()?(e$=t.substr(eY,7),eY+=7):(e$=o,0===eW&&e4(eS)),e$!==o?(ek=eY,eW++,ez=tu(),eW--,ez===o?ek=void 0:(eY=ek,ek=o),ek!==o?(eB=eJ,eJ="INTEGER"):(eY=eJ,eJ=o)):(eY=eJ,eJ=o),(eU=eJ)!==o&&(eB=eR,eU={type:"data-type",value:{type:"integer"}}),(eR=eU)===o&&(eR=eY,eq=eY,"smallint"===t.substr(eY,8).toLowerCase()?(eQ=t.substr(eY,8),eY+=8):(eQ=o,0===eW&&e4(eI)),eQ!==o?(ej=eY,eW++,eG=tu(),eW--,eG===o?ej=void 0:(eY=ej,ej=o),ej!==o?(eB=eq,eq="SMALLINT"):(eY=eq,eq=o)):(eY=eq,eq=o),(eU=eq)!==o&&(eB=eR,eU={type:"data-type",value:{type:"smallint"}}),(eR=eU)===o&&(eR=eY,eX=eY,"float"===t.substr(eY,5).toLowerCase()?(e0=t.substr(eY,5),eY+=5):(e0=o,0===eW&&e4(eg)),e0!==o?(e1=eY,eW++,e2=tu(),eW--,e2===o?e1=void 0:(eY=e1,e1=o),e1!==o?(eB=eX,eX="FLOAT"):(eY=eX,eX=o)):(eY=eX,eX=o),(eU=eX)!==o&&(eB=eR,eU={type:"data-type",value:{type:"float"}}),(eR=eU)===o&&(eR=eY,e9=eY,"real"===t.substr(eY,4).toLowerCase()?(e7=t.substr(eY,4),eY+=4):(e7=o,0===eW&&e4(ey)),e7!==o?(e5=eY,eW++,e8=tu(),eW--,e8===o?e5=void 0:(eY=e5,e5=o),e5!==o?(eB=e9,e9="REAL"):(eY=e9,e9=o)):(eY=e9,e9=o),(eU=e9)!==o&&(eB=eR,eU={type:"data-type",value:{type:"real"}}),(eR=eU)===o&&(eR=eY,(eU=tJ())!==o&&(eB=eR,eU={type:"data-type",value:{type:"date"}}),(eR=eU)===o&&(eR=eY,(eU=tV())!==o&&(eB=eR,eU={type:"data-type",value:{type:"timestamp"}}),(eR=eU)===o&&(eR=eY,(eU=t$())!==o&&(eB=eR,eU={type:"data-type",value:{type:"time"}}),(eR=eU)===o&&(eR=eY,(te=eY,"varchar"===t.substr(eY,7).toLowerCase()?(tt=t.substr(eY,7),eY+=7):(tt=o,0===eW&&e4(eT)),tt!==o?(tr=eY,eW++,tn=tu(),eW--,tn===o?tr=void 0:(eY=tr,tr=o),tr!==o?(eB=te,te="VARCHAR"):(eY=te,te=o)):(eY=te,te=o),(eU=te)!==o)?(t1(),tX()!==o?(t1(),(eV=tC())!==o?(t1(),t0()!==o?(eB=eR,eR={type:"data-type",value:{type:"varchar",size:parseInt(eV)}}):(eY=eR,eR=o)):(eY=eR,eR=o)):(eY=eR,eR=o)):(eY=eR,eR=o)))))))),(ex=eR)!==o)?(t1(),t0()!==o?(eB=eN,eN={type:"function",name:"cast",args:{type:"expression-list",value:[eO,ex]}}):(eY=eN,eN=o)):(eY=eN,eN=o)):(eY=eN,eN=o)):(eY=eN,eN=o)):(eY=eN,eN=o)):(eY=eN,eN=o),(e=eN)===o)&&(ta=eY,(ti=function(){var e,r,n,a;if(e=eY,(r=to())!==o&&(eB=e),(e=r)===o){if(e=eY,96===t.charCodeAt(eY)?(r="`",eY++):(r=o,0===eW&&e4(eH)),r!==o){if(n=[],g.test(t.charAt(eY))?(a=t.charAt(eY),eY++):(a=o,0===eW&&e4(eZ)),a!==o)for(;a!==o;)n.push(a),g.test(t.charAt(eY))?(a=t.charAt(eY),eY++):(a=o,0===eW&&e4(eZ));else n=o;n!==o?(96===t.charCodeAt(eY)?(a="`",eY++):(a=o,0===eW&&e4(eH)),a!==o?(eB=e,e=n.join("")):(eY=e,e=o)):(eY=e,e=o)}else eY=e,e=o}return e}())!==o?(t1(),tX()!==o?(t1(),(ts=e3())===o&&(ts=null),t1(),t0()!==o?(eB=ta,ta={type:"function",name:ti,args:ts||{type:"expression-list",value:[]}}):(eY=ta,ta=o)):(eY=ta,ta=o)):(eY=ta,ta=o),(e=ta)===o)&&((tv=function(){var e,t,r,n,a;if(e=eY,tQ()!==o){if(t1(),(t=e6())!==o){for(t1(),r=[],n=tT();n!==o;)r.push(n),n=tT();n=t1(),(a=tj())!==o?(eB=e,e={type:"case-expression",format:"simple",operand:t,clauses:r,else:null}):(eY=e,e=o)}else eY=e,e=o}else eY=e,e=o;if(e===o){if(e=eY,tQ()!==o){if(t1(),(t=e6())!==o){for(t1(),r=[],n=tT();n!==o;)r.push(n),n=tT();n=t1(),(a=tN())!==o?(t1(),tj()!==o?(eB=e,e={type:"case-expression",format:"simple",operand:t,clauses:r,else:a.value}):(eY=e,e=o)):(eY=e,e=o)}else eY=e,e=o}else eY=e,e=o}return e}())===o&&(tv=function(){var e,t,r,n;if(e=eY,tQ()!==o){for(t1(),t=[],r=ty();r!==o;)t.push(r),r=ty();r=t1(),(n=tj())!==o?(eB=e,e={type:"case-expression",format:"searched",clauses:t,else:null}):(eY=e,e=o)}else eY=e,e=o;if(e===o){if(e=eY,tQ()!==o){for(t1(),t=[],r=ty();r!==o;)t.push(r),r=ty();r=t1(),(n=tN())!==o?(t1(),tj()!==o?(eB=e,e={type:"case-expression",format:"searched",clauses:t,else:n.value}):(eY=e,e=o)):(eY=e,e=o)}else eY=e,e=o}return e}()),(e=tv)===o)&&(tw=eY,tE=eY,(tF=function(){var e,t,r,n;if(e=eY,(t=tl())!==o){for(r=[],n=tc();n!==o;)r.push(n),n=tc();eB=e,e=t+r.join("")}else eY=e,e=o;return e}())!==o&&(eB=tE),(tS=tE=tF)!==o&&(eB=tw,tA=tS,tS=/^CURRENT_DATE$/i.test(tA)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(tA)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:tA}),(tw=tS)===o&&(tw=eY,tD=eY,td()!==o?(tP=function(){var e,t,r;for(e=eY,t=[],r=tf();r!==o;)t.push(r),r=tf();return eB=e,e=t=t.join("")}(),td()!==o?(eB=tD,tD=tP):(eY=tD,tD=o)):(eY=tD,tD=o),(tS=tD)!==o&&(eB=tw,tS={type:"column-reference",table:"",column:tS,delimited:!0}),tw=tS),(e=tw)===o)&&(e=tp())===o&&(e=eY,tX()!==o?(t1(),(r=e6())!==o?(t1(),t0()!==o?(eB=e,r.paren=!0,e=r):(eY=e,e=o)):(eY=e,e=o)):(eY=e,e=o)),e}function to(){var e,t,r,n;if(e=eY,(t=tl())!==o){for(r=[],n=tu();n!==o;)r.push(n),n=tu();eB=e,e=t+r.join("")}else eY=e,e=o;return e}function tl(){var e;return f.test(t.charAt(eY))?(e=t.charAt(eY),eY++):(e=o,0===eW&&e4(_)),e}function tu(){var e;return d.test(t.charAt(eY))?(e=t.charAt(eY),eY++):(e=o,0===eW&&e4(L)),e}function tc(){var e;return p.test(t.charAt(eY))?(e=t.charAt(eY),eY++):(e=o,0===eW&&e4(R)),e}function tf(){var e,r,n;return p.test(t.charAt(eY))?(r=t.charAt(eY),eY++):(r=o,0===eW&&e4(R)),(e=r)===o&&(n=eY,td()!==o&&td()!==o?(eB=n,n='"'):(eY=n,n=o),e=n),e}function td(){var e;return h.test(t.charAt(eY))?(e=t.charAt(eY),eY++):(e=o,0===eW&&e4(U)),e}function tp(){var e,r,n,a;return e=eY,r=eY,64===t.charCodeAt(eY)?(n="@",eY++):(n=o,0===eW&&e4(V)),n!==o&&(a=to())!==o?r=n=[n,a]:(eY=r,r=o),r!==o&&(eB=e,r={type:"parameter",value:r[1]}),e=r}function th(){var e,r,n,a,i,s,l,u,c,f,d,p,h;return r=eY,"leading"===t.substr(eY,7).toLowerCase()?(n=t.substr(eY,7),eY+=7):(n=o,0===eW&&e4(ep)),n!==o?(a=eY,eW++,i=tu(),eW--,i===o?a=void 0:(eY=a,a=o),a!==o?(eB=r,r="LEADING"):(eY=r,r=o)):(eY=r,r=o),(e=r)===o&&(s=eY,"trailing"===t.substr(eY,8).toLowerCase()?(l=t.substr(eY,8),eY+=8):(l=o,0===eW&&e4(eh)),l!==o?(u=eY,eW++,c=tu(),eW--,c===o?u=void 0:(eY=u,u=o),u!==o?(eB=s,s="TRAILING"):(eY=s,s=o)):(eY=s,s=o),(e=s)===o)&&(f=eY,"both"===t.substr(eY,4).toLowerCase()?(d=t.substr(eY,4),eY+=4):(d=o,0===eW&&e4(em)),d!==o?(p=eY,eW++,h=tu(),eW--,h===o?p=void 0:(eY=p,p=o),p!==o?(eB=f,f="BOTH"):(eY=f,f=o)):(eY=f,f=o),e=f),e}function tm(){var e,r,n,a,i,s,l,u,c,f,d,p,h,m,v,w,S,I,g,y;return e=eY,(I=eY,(g=tv())!==o?(t1(),tX()!==o?(t1(),(y=tS())!==o?(t1(),t0()!==o?(eB=I,I={type:"interval-period",period:g.value,precision:y,secondary:null}):(eY=I,I=o)):(eY=I,I=o)):(eY=I,I=o)):(eY=I,I=o),I===o&&(I=eY,(g=tv())!==o&&(eB=I,g={type:"interval-period",period:g.value,precision:null,secondary:null}),I=g),(r=I)!==o)?(t1(),(a=eY,"to"===t.substr(eY,2).toLowerCase()?(i=t.substr(eY,2),eY+=2):(i=o,0===eW&&e4(eN)),i!==o?(s=eY,eW++,l=tu(),eW--,l===o?s=void 0:(eY=s,s=o),s!==o?(eB=a,a="TO"):(eY=a,a=o)):(eY=a,a=o),a!==o)?(t1(),(u=eY,(c=tv())!==o&&(eB=u,c={type:"interval-period",period:c.value,precision:null,secondary:null}),(u=c)===o&&(u=eY,(c=tB())!==o?(t1(),tX()!==o?(t1(),(f=tS())!==o?(t1(),tK()!==o?(t1(),(d=tw())!==o?(t1(),t0()!==o?(eB=u,u={type:"interval-period",period:"second",precision:f,secondary:d}):(eY=u,u=o)):(eY=u,u=o)):(eY=u,u=o)):(eY=u,u=o)):(eY=u,u=o)):(eY=u,u=o),u===o&&(u=eY,(c=tB())!==o?(t1(),tX()!==o?(t1(),(f=tS())!==o?(t1(),t0()!==o?(eB=u,u={type:"interval-period",period:"second",precision:f,secondary:null}):(eY=u,u=o)):(eY=u,u=o)):(eY=u,u=o)):(eY=u,u=o),u===o&&(u=eY,(c=tB())!==o&&(eB=u,c={type:"interval-period",period:"second",precision:null,secondary:null}),u=c))),(n=u)!==o)?(eB=e,e={type:"interval-qualifier",start:r,end:n}):(eY=e,e=o)):(eY=e,e=o)):(eY=e,e=o),e===o&&(p=eY,(h=tv())!==o?(t1(),tX()!==o?(t1(),(m=tw())!==o?(t1(),t0()!==o?(eB=p,w=h,S=m,p={type:"interval-period",period:w.value,precision:S,secondary:null}):(eY=p,p=o)):(eY=p,p=o)):(eY=p,p=o)):(eY=p,p=o),p===o&&(p=eY,(h=tv())!==o&&(eB=p,h={type:"interval-period",period:h.value,precision:null,secondary:null}),(p=h)===o&&(p=eY,(h=tB())!==o?(t1(),tX()!==o?(t1(),(m=tS())!==o?(t1(),tK()!==o?(t1(),(v=tw())!==o?(t1(),t0()!==o?(eB=p,p={type:"interval-period",period:"second",precision:m,secondary:v}):(eY=p,p=o)):(eY=p,p=o)):(eY=p,p=o)):(eY=p,p=o)):(eY=p,p=o)):(eY=p,p=o),p===o&&(p=eY,(h=tB())!==o?(t1(),tX()!==o?(t1(),(m=tw())!==o?(t1(),t0()!==o?(eB=p,p={type:"interval-period",period:"second",precision:m,secondary:null}):(eY=p,p=o)):(eY=p,p=o)):(eY=p,p=o)):(eY=p,p=o),p===o&&(p=eY,(h=tB())!==o&&(eB=p,h={type:"interval-period",period:"second",precision:null,secondary:null}),p=h)))),e=p),e}function tv(){var e,t;return e=eY,(t=tz())!==o&&(eB=e,t={type:"string",value:"day"}),(e=t)===o&&(e=eY,(t=tq())!==o&&(eB=e,t={type:"string",value:"hour"}),(e=t)===o&&(e=eY,(t=tY())!==o&&(eB=e,t={type:"string",value:"minute"}),(e=t)===o&&(e=eY,(t=tZ())!==o&&(eB=e,t={type:"string",value:"month"}),(e=t)===o&&(e=eY,(t=tH())!==o&&(eB=e,t={type:"string",value:"year"}),e=t)))),e}function tw(){var e,t;return e=eY,(t=tC())!==o&&(eB=e,t=parseFloat(t)),e=t}function tS(){var e,t;return e=eY,(t=tC())!==o&&(eB=e,t=parseFloat(t)),e=t}function tI(){var e;return(e=tg())===o&&(e=tp()),e}function tg(){var e,r,n,a,i;if(e=eY,39===t.charCodeAt(eY)?(r="'",eY++):(r=o,0===eW&&e4(J)),r===o&&("N'"===t.substr(eY,2)?(r="N'",eY+=2):(r=o,0===eW&&e4($))),r!==o){for(n=[],a=eY,"''"===t.substr(eY,2)?(i="''",eY+=2):(i=o,0===eW&&e4(k)),i!==o&&(eB=a,i=eq()),(a=i)===o&&(m.test(t.charAt(eY))?(a=t.charAt(eY),eY++):(a=o,0===eW&&e4(H)));a!==o;)n.push(a),a=eY,"''"===t.substr(eY,2)?(i="''",eY+=2):(i=o,0===eW&&e4(k)),i!==o&&(eB=a,i=eq()),(a=i)===o&&(m.test(t.charAt(eY))?(a=t.charAt(eY),eY++):(a=o,0===eW&&e4(H)));39===t.charCodeAt(eY)?(a="'",eY++):(a=o,0===eW&&e4(J)),a!==o?(eB=e,e={type:"string",value:n.join("")}):(eY=e,e=o)}else eY=e,e=o;return e}function ty(){var e,t,r;return e=eY,tG()!==o?(t1(),(t=e6())!==o?(t1(),tW()!==o?(t1(),(r=e6())!==o?(eB=e,e={type:"when-clause",operand:t,value:r}):(eY=e,e=o)):(eY=e,e=o)):(eY=e,e=o)):(eY=e,e=o),e}function tT(){var e,t,r;return e=eY,tG()!==o?(t1(),(t=e6())!==o?(t1(),tW()!==o?(t1(),(r=e6())!==o?(eB=e,e={type:"when-clause",operand:t,value:r}):(eY=e,e=o)):(eY=e,e=o)):(eY=e,e=o)):(eY=e,e=o),e}function tN(){var e,r,n,a,i,s;return e=eY,(n=eY,"else"===t.substr(eY,4).toLowerCase()?(a=t.substr(eY,4),eY+=4):(a=o,0===eW&&e4(eU)),a!==o?(i=eY,eW++,s=tu(),eW--,s===o?i=void 0:(eY=i,i=o),i!==o?(eB=n,n="ELSE"):(eY=n,n=o)):(eY=n,n=o),n!==o)?(t1(),(r=e6())!==o?(eB=e,e={type:"else-clause",value:r}):(eY=e,e=o)):(eY=e,e=o),e}function tO(){var e,r,n,a,i;return(e=tC())===o&&(e=eY,45===t.charCodeAt(eY)?(r="-",eY++):(r=o,0===eW&&e4(E)),r===o&&(43===t.charCodeAt(eY)?(r="+",eY++):(r=o,0===eW&&e4(M))),r!==o&&(n=tC())!==o?(eB=e,a=r,i=n,e=a[0]+i):(eY=e,e=o)),e}function tx(){var e,r,n,a;return e=eY,46===t.charCodeAt(eY)?(r=".",eY++):(r=o,0===eW&&e4(Z)),r!==o?((n=tC())===o&&(n=null),eB=e,e="."+(null!=(a=n)?a:"")):(eY=e,e=o),e}function tb(){var e,r,n,a,i,s,l;return e=eY,(a=eY,w.test(t.charAt(eY))?(i=t.charAt(eY),eY++):(i=o,0===eW&&e4(q)),i!==o?(S.test(t.charAt(eY))?(s=t.charAt(eY),eY++):(s=o,0===eW&&e4(Y)),s===o&&(s=null),eB=a,a="e"+(null===(l=s)?"":l)):(eY=a,a=o),(r=a)!==o&&(n=tC())!==o)?(eB=e,e=r+n):(eY=e,e=o),e}function tC(){var e,t,r;if(e=eY,t=[],(r=tA())!==o)for(;r!==o;)t.push(r),r=tA();else t=o;return t!==o&&(eB=e,t=t.join("")),e=t}function tA(){var e;return v.test(t.charAt(eY))?(e=t.charAt(eY),eY++):(e=o,0===eW&&e4(z)),e}function tM(){var e,r,n,a;return e=eY,"in"===t.substr(eY,2).toLowerCase()?(r=t.substr(eY,2),eY+=2):(r=o,0===eW&&e4(G)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="IN"):(eY=e,e=o)):(eY=e,e=o),e}function tE(){var e,r,n,a;return e=eY,"is"===t.substr(eY,2).toLowerCase()?(r=t.substr(eY,2),eY+=2):(r=o,0===eW&&e4(W)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="IS"):(eY=e,e=o)):(eY=e,e=o),e}function tF(){var e,r,n,a;return e=eY,"like"===t.substr(eY,4).toLowerCase()?(r=t.substr(eY,4),eY+=4):(r=o,0===eW&&e4(K)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="LIKE"):(eY=e,e=o)):(eY=e,e=o),e}function tD(){var e,r,n,a;return e=eY,"not"===t.substr(eY,3).toLowerCase()?(r=t.substr(eY,3),eY+=3):(r=o,0===eW&&e4(ee)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="NOT"):(eY=e,e=o)):(eY=e,e=o),e}function tP(){var e,r,n,a;return e=eY,"and"===t.substr(eY,3).toLowerCase()?(r=t.substr(eY,3),eY+=3):(r=o,0===eW&&e4(et)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="AND"):(eY=e,e=o)):(eY=e,e=o),e}function t_(){var e,r,n,a;return e=eY,"or"===t.substr(eY,2).toLowerCase()?(r=t.substr(eY,2),eY+=2):(r=o,0===eW&&e4(er)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="OR"):(eY=e,e=o)):(eY=e,e=o),e}function tL(){var e,r,n,a;return e=eY,"between"===t.substr(eY,7).toLowerCase()?(r=t.substr(eY,7),eY+=7):(r=o,0===eW&&e4(en)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="BETWEEN"):(eY=e,e=o)):(eY=e,e=o),e}function tR(){var e,r,n,a;return e=eY,"from"===t.substr(eY,4).toLowerCase()?(r=t.substr(eY,4),eY+=4):(r=o,0===eW&&e4(ea)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="FROM"):(eY=e,e=o)):(eY=e,e=o),e}function tU(){var e,r,n,a;return e=eY,"trim"===t.substr(eY,4).toLowerCase()?(r=t.substr(eY,4),eY+=4):(r=o,0===eW&&e4(el)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="TRIM"):(eY=e,e=o)):(eY=e,e=o),e}function tV(){var e,r,n,a;return e=eY,"timestamp"===t.substr(eY,9).toLowerCase()?(r=t.substr(eY,9),eY+=9):(r=o,0===eW&&e4(ec)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="TIMESTAMP"):(eY=e,e=o)):(eY=e,e=o),e}function tJ(){var e,r,n,a;return e=eY,"date"===t.substr(eY,4).toLowerCase()?(r=t.substr(eY,4),eY+=4):(r=o,0===eW&&e4(ef)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="DATE"):(eY=e,e=o)):(eY=e,e=o),e}function t$(){var e,r,n,a;return e=eY,"time"===t.substr(eY,4).toLowerCase()?(r=t.substr(eY,4),eY+=4):(r=o,0===eW&&e4(ed)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="TIME"):(eY=e,e=o)):(eY=e,e=o),e}function tk(){var e,r,n,a;return e=eY,"interval"===t.substr(eY,8).toLowerCase()?(r=t.substr(eY,8),eY+=8):(r=o,0===eW&&e4(eO)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="INTERVAL"):(eY=e,e=o)):(eY=e,e=o),e}function tH(){var e,r,n,a;return e=eY,"year"===t.substr(eY,4).toLowerCase()?(r=t.substr(eY,4),eY+=4):(r=o,0===eW&&e4(ex)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="YEAR"):(eY=e,e=o)):(eY=e,e=o),e}function tZ(){var e,r,n,a;return e=eY,"month"===t.substr(eY,5).toLowerCase()?(r=t.substr(eY,5),eY+=5):(r=o,0===eW&&e4(eA)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="MONTH"):(eY=e,e=o)):(eY=e,e=o),e}function tz(){var e,r,n,a;return e=eY,"day"===t.substr(eY,3).toLowerCase()?(r=t.substr(eY,3),eY+=3):(r=o,0===eW&&e4(eM)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="DAY"):(eY=e,e=o)):(eY=e,e=o),e}function tq(){var e,r,n,a;return e=eY,"hour"===t.substr(eY,4).toLowerCase()?(r=t.substr(eY,4),eY+=4):(r=o,0===eW&&e4(eE)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="HOUR"):(eY=e,e=o)):(eY=e,e=o),e}function tY(){var e,r,n,a;return e=eY,"minute"===t.substr(eY,6).toLowerCase()?(r=t.substr(eY,6),eY+=6):(r=o,0===eW&&e4(eF)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="MINUTE"):(eY=e,e=o)):(eY=e,e=o),e}function tB(){var e,r,n,a;return e=eY,"second"===t.substr(eY,6).toLowerCase()?(r=t.substr(eY,6),eY+=6):(r=o,0===eW&&e4(eD)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="SECOND"):(eY=e,e=o)):(eY=e,e=o),e}function tQ(){var e,r,n,a;return e=eY,"case"===t.substr(eY,4).toLowerCase()?(r=t.substr(eY,4),eY+=4):(r=o,0===eW&&e4(eP)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="CASE"):(eY=e,e=o)):(eY=e,e=o),e}function tj(){var e,r,n,a;return e=eY,"end"===t.substr(eY,3).toLowerCase()?(r=t.substr(eY,3),eY+=3):(r=o,0===eW&&e4(e_)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="END"):(eY=e,e=o)):(eY=e,e=o),e}function tG(){var e,r,n,a;return e=eY,"when"===t.substr(eY,4).toLowerCase()?(r=t.substr(eY,4),eY+=4):(r=o,0===eW&&e4(eL)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="WHEN"):(eY=e,e=o)):(eY=e,e=o),e}function tW(){var e,r,n,a;return e=eY,"then"===t.substr(eY,4).toLowerCase()?(r=t.substr(eY,4),eY+=4):(r=o,0===eW&&e4(eR)),r!==o?(n=eY,eW++,a=tu(),eW--,a===o?n=void 0:(eY=n,n=o),n!==o?(eB=e,e="THEN"):(eY=e,e=o)):(eY=e,e=o),e}function tK(){var e;return 44===t.charCodeAt(eY)?(e=",",eY++):(e=o,0===eW&&e4(eV)),e}function tX(){var e;return 40===t.charCodeAt(eY)?(e="(",eY++):(e=o,0===eW&&e4(eJ)),e}function t0(){var e;return 41===t.charCodeAt(eY)?(e=")",eY++):(e=o,0===eW&&e4(e$)),e}function t1(){var e,t;for(e=[],t=t2();t!==o;)e.push(t),t=t2();return e}function t2(){var e;return I.test(t.charAt(eY))?(e=t.charAt(eY),eY++):(e=o,0===eW&&e4(ek)),e}function t4(e,t,r,n){var a={type:"binary-expression",operator:e,left:t,right:r};return void 0!==n&&(a.escape=n),a}function t9(e,t){for(var r=e,n=0;n<t.length;n++)r=t4(t[n][1],r,t[n][3]);return r}if((s=c())!==o&&eY===t.length)return s;throw s!==o&&eY<t.length&&e4({type:"end"}),n=eG,a=ej<t.length?t.charAt(ej):null,i=ej<t.length?e2(ej,ej+1):e2(ej,ej),new e(e.buildMessage(n,a),n,a,i)}}},et.exports&&(et.exports=ee());var er=et.exports;class en{static parse(e){return er.parse(e)}}let ea=new Set(["current_timestamp","current_date","current_time"]);class ei{static makeBool(e){return!0===e}static featureValue(e,t,r,n){return eh(e,t,r,n)}static equalsNull(e){return null===e}static applyLike(e,t,r){return ep(e,t,r)}static ensureArray(e){return eo(e)}static applyIn(e,t,r){return ef(e,t)}static currentDate(e){return l.u.fromNow(e)}static makeSqlInterval(e,t,r){return S.createFromValueAndQualifier(e,t,r)}static convertInterval(e){return e instanceof S?e.valueInMilliseconds():e}static currentTimestamp(e){return A(new Date,e)}static compare(e,t,r,n){return z(t,r,e)}static calculate(e,t,r,n){return K(e,t,r,n)}static evaluateTime(e){return U(e)}static evaluateTimestamp(e,t,r){return V(e,t,r)}static evaluateDate(e,t){return J(e,t)}static evaluateFunction(e,t,r){return Q(e,t,r)}static lookup(e,t){let r=t[e];return void 0===r?null:r}static between(e,t,r){return null==e||null==t[0]||null==t[1]?null:z(e,t[0],">=")&&z(e,t[1],"<=")}static notbetween(e,t,r){return null==e||null==t[0]||null==t[1]?null:z(e,t[0],"<")||z(e,t[1],">")}static ternaryNot(e){return el(e)}static ternaryAnd(e,t){return eu(e,t)}static ternaryOr(e,t){return ec(e,t)}}class es{constructor(e,t,r="UTC"){this.fieldsIndex=t,this.timeZone=r,this.parameters={},this._hasDateFunctions=void 0,this.parseTree=en.parse(e);let{isStandardized:n,isAggregate:a,referencedFieldNames:i}=this._extractExpressionInfo(t);this._referencedFieldNames=i,this.isStandardized=n,this.isAggregate=a}static convertValueToStorageFormat(e,t=null){if(null===t)return D(e)?e.getTime():P(e)?e.toMillis():R(e)?e.toStorageFormat():L(e)?e.toStorageString():_(e)?e.toStorageFormat():e;switch(t){case"date":return D(e)?e.getTime():P(e)?e.toMillis():R(e)?e.toMilliseconds():_(e)?e.toNumber():e;case"date-only":return D(e)?l.u.fromDateJS(e).toString():R(e)?l.u.fromSqlTimeStampOffset(e).toString():P(e)?l.u.fromDateTime(e).toString():e;case"time-only":return D(e)?c.n.fromDateJS(e).toStorageString():P(e)?c.n.fromDateTime(e).toStorageString():R(e)?c.n.fromSqlTimeStampOffset(e).toStorageString():L(e)?e.toStorageString():e;case"timestamp-offset":if(D(e))return u.H.fromJSDate(e).toStorageFormat();if(P(e))return u.H.fromDateTime(e).toStorageFormat();if(R(e))return e.toStorageFormat()}return e}static create(e,t,r="UTC"){return new es(e,t,r)}get fieldNames(){return this._referencedFieldNames}testSet(e,t=em){return!!this._evaluateNode(this.parseTree,null,t,e)}calculateValue(e,t=em){let r=this._evaluateNode(this.parseTree,e,t,null);return r instanceof S?r.valueInMilliseconds()/864e5:r}calculateValueCompiled(e,t=em){return null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone):(0,o.Z)("esri-csp-restrictions")?this.calculateValue(e,t):(this._compileMe(),this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone))}testFeature(e,t=em){return!!this._evaluateNode(this.parseTree,e,t,null)}testFeatureCompiled(e,t=em){return null!=this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone):(0,o.Z)("esri-csp-restrictions")?this.testFeature(e,t):(this._compileMe(),!!this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone))}get hasDateFunctions(){return null!=this._hasDateFunctions||(this._hasDateFunctions=!1,this._visitAll(this.parseTree,e=>{"current-time"===e.type?this._hasDateFunctions=!0:"function"===e.type&&(this._hasDateFunctions=this._hasDateFunctions||ea.has(e.name.toLowerCase()))})),this._hasDateFunctions}getFunctions(){let e=new Set;return this._visitAll(this.parseTree,t=>{"function"===t.type&&e.add(t.name.toLowerCase())}),Array.from(e)}getExpressions(){let e=new Map;return this._visitAll(this.parseTree,t=>{if("function"===t.type){let r=t.name.toLowerCase(),n=t.args.value[0];if("column-reference"===n.type){let t=n.column,a=`${r}-${t}`;e.has(a)||e.set(a,{aggregateType:r,field:t})}}}),[...e.values()]}getVariables(){let e=new Set;return this._visitAll(this.parseTree,t=>{"parameter"===t.type&&e.add(t.value.toLowerCase())}),Array.from(e)}_compileMe(){let e="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=Function("feature","lookups","attributeAdapter","fieldsIndex","timeZone",e).bind(ei)}_extractExpressionInfo(e){let t=[],r=new Set,n=!0,a=!1;return this._visitAll(this.parseTree,i=>{switch(i.type){case"column-reference":{let n,a;let s=e?.get(i.column);n=s?a=s.name??"":(a=i.column).toLowerCase(),r.has(n)||(r.add(n),t.push(a)),i.column=a;break}case"function":{let{name:e,args:t}=i,r=t.value.length;n&&(n=function(e,t){let r=W[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}(e,r)),!1===a&&(a=d(e,r))}}}),{referencedFieldNames:Array.from(t),isStandardized:n,isAggregate:a}}_visitAll(e,t){if(null!=e)switch(t(e),e.type){case"when-clause":this._visitAll(e.operand,t),this._visitAll(e.value,t);break;case"case-expression":for(let r of e.clauses)this._visitAll(r,t);"simple"===e.format&&this._visitAll(e.operand,t),null!==e.else&&this._visitAll(e.else,t);break;case"expression-list":for(let r of e.value)this._visitAll(r,t);break;case"unary-expression":this._visitAll(e.expr,t);break;case"binary-expression":this._visitAll(e.left,t),this._visitAll(e.right,t);break;case"function":this._visitAll(e.args,t)}}evaluateNodeToJavaScript(e){switch(e.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(e.value)+", "+JSON.stringify(e.qualifier)+","+JSON.stringify(e.op)+")";case"case-expression":{let t="";if("simple"===e.format){let r=this.evaluateNodeToJavaScript(e.operand);t="( ";for(let n=0;n<e.clauses.length;n++)t+=" (this.compare('=',"+r+","+this.evaluateNodeToJavaScript(e.clauses[n].operand)+") ? ("+this.evaluateNodeToJavaScript(e.clauses[n].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}else{t="( ";for(let r=0;r<e.clauses.length;r++)t+=" this.makeBool("+this.evaluateNodeToJavaScript(e.clauses[r].operand)+")===true ? ("+this.evaluateNodeToJavaScript(e.clauses[r].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}return t}case"parameter":return"this.lookup("+JSON.stringify(e.value.toLowerCase())+",lookups)";case"expression-list":{let t="[";for(let r of e.value)"["!==t&&(t+=","),t+=this.evaluateNodeToJavaScript(r);return t+"]"}case"unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(e.expr)+")";case"binary-expression":switch(e.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"IS":if("null"!==e.right.type)throw new s.eS(s.f.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")";case"ISNOT":if("null"!==e.right.type)throw new s.eS(s.f.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+"), timeZone)";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+"), timeZone))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)";case"*":case"-":case"+":case"/":case"||":return"this.calculate("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)"}throw new s.eS(s.f.UnsupportedOperator,{operator:e.operator});case"null":case"boolean":case"string":case"number":return JSON.stringify(e.value);case"time":return"this.evaluateTime("+JSON.stringify(e.value)+")";case"date":return"this.evaluateDate("+JSON.stringify(e.value)+", 'unknown')";case"timestamp":return"this.evaluateTimestamp("+JSON.stringify(e.value)+", 'unknown')";case"current-time":return"date"===e.mode?"this.currentDate(timeZone)":"this.currentTimestamp(timeZone)";case"column-reference":return"this.featureValue(feature,"+JSON.stringify(e.column)+",fieldsIndex,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(e.name)+","+this.evaluateNodeToJavaScript(e.args)+", timeZone)"}throw new s.eS(s.f.UnsupportedSyntax,{node:e.type})}_evaluateNode(e,t,r,n){let a;switch(e.type){case"interval":{let a=this._evaluateNode(e.value,t,r,n);return S.createFromValueAndQualifier(a,e.qualifier,e.op)}case"case-expression":if("simple"===e.format){let a=this._evaluateNode(e.operand,t,r,n);for(let i=0;i<e.clauses.length;i++)if(z(a,this._evaluateNode(e.clauses[i].operand,t,r,n),"=",this.timeZone))return this._evaluateNode(e.clauses[i].value,t,r,n);if(null!==e.else)return this._evaluateNode(e.else,t,r,n)}else{for(let a=0;a<e.clauses.length;a++)if(!0===this._evaluateNode(e.clauses[a].operand,t,r,n))return this._evaluateNode(e.clauses[a].value,t,r,n);if(null!==e.else)return this._evaluateNode(e.else,t,r,n)}return null;case"parameter":return D(a=this.parameters[e.value.toLowerCase()])?f.ou.fromJSDate(a):a instanceof i.iG?a.toDateTime():a;case"expression-list":{let a=[];for(let i of e.value)a.push(this._evaluateNode(i,t,r,n));return a}case"unary-expression":return el(this._evaluateNode(e.expr,t,r,n));case"binary-expression":switch(e.operator){case"AND":return eu(this._evaluateNode(e.left,t,r,n),this._evaluateNode(e.right,t,r,n));case"OR":return ec(this._evaluateNode(e.left,t,r,n),this._evaluateNode(e.right,t,r,n));case"IS":if("null"!==e.right.type)throw new s.eS(s.f.UnsupportedIsRhs);return null===this._evaluateNode(e.left,t,r,n);case"ISNOT":if("null"!==e.right.type)throw new s.eS(s.f.UnsupportedIsRhs);return null!==this._evaluateNode(e.left,t,r,n);case"IN":{let a=eo(this._evaluateNode(e.right,t,r,n));return ef(this._evaluateNode(e.left,t,r,n),a,this.timeZone)}case"NOT IN":{let a=eo(this._evaluateNode(e.right,t,r,n));return el(ef(this._evaluateNode(e.left,t,r,n),a,this.timeZone))}case"BETWEEN":{let a=this._evaluateNode(e.left,t,r,n),i=this._evaluateNode(e.right,t,r,n);return null==a||null==i[0]||null==i[1]?null:z(a,i[0],">=",this.timeZone)&&z(a,i[1],"<=",this.timeZone)}case"NOTBETWEEN":{let a=this._evaluateNode(e.left,t,r,n),i=this._evaluateNode(e.right,t,r,n);return null==a||null==i[0]||null==i[1]?null:z(a,i[0],"<",this.timeZone)||z(a,i[1],">",this.timeZone)}case"LIKE":return ep(this._evaluateNode(e.left,t,r,n),this._evaluateNode(e.right,t,r,n),e.escape);case"NOT LIKE":return el(ep(this._evaluateNode(e.left,t,r,n),this._evaluateNode(e.right,t,r,n),e.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return z(this._evaluateNode(e.left,t,r,n),this._evaluateNode(e.right,t,r,n),e.operator,this.timeZone);case"-":case"+":case"*":case"/":case"||":return K(e.operator,this._evaluateNode(e.left,t,r,n),this._evaluateNode(e.right,t,r,n),this.timeZone)}case"null":case"boolean":case"string":case"number":case"data-type":return e.value;case"date":return e.parsedValue??=J(e.value,"unknown"),e.parsedValue;case"timestamp":return e.parsedValue??=V(e.value,"unknown"),e.parsedValue;case"time":return U(e.value);case"current-time":return"date"===e.mode?l.u.fromNow(this.timeZone):A(new Date,this.timeZone);case"column-reference":return eh(t,e.column,this.fieldsIndex,r);case"function":{if(this.isAggregate&&d(e.name,e.args.value.length)){let t=[];for(let a of e.args?.value||[]){let e=[];for(let t of n||[])e.push(this._evaluateNode(a,t,r,null));t.push(e)}return function(e,t){let r=p[e.toLowerCase()];if(null==r)throw new s.eS(s.f.FunctionNotRecognized);if(t.length<r.minParams||t.length>r.maxParams)throw new s.eS(s.f.InvalidParameterCount,{name:e.toUpperCase()});return r.evaluate(t)}(e.name,t)}let a=this._evaluateNode(e.args,t,r,n);return Q(e.name,a,this.timeZone)}}throw new s.eS(s.f.UnsupportedSyntax,{node:e.type})}}function eo(e){return Array.isArray(e)?e:[e]}function el(e){return null!==e?!0!==e:null}function eu(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function ec(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function ef(e,t,r){if(null==e)return null;let n=!1;for(let r of t)if(null==r)n=null;else{if(e===r){n=!0;break}if(H(e)&&H(r)&&(n=z(e,r,"=")))break}return n}let ed="-[]/{}()*+?.\\^$|";function ep(e,t,r){return null==e?null:(function(e,t){let r="",n=a.Normal;for(let i=0;i<e.length;i++){let s=e.charAt(i);switch(n){case a.Normal:s===t?n=a.Escaped:ed.includes(s)?r+="\\"+s:r+="%"===s?".*":"_"===s?".":s;break;case a.Escaped:ed.includes(s)?r+="\\"+s:r+=s,n=a.Normal}}return RegExp("^"+r+"$","m")})(t,r).test(e)}function eh(e,t,r,n){let a=n.getAttribute(e,t),i=r?.get(t);return null==a||"esriFieldTypeDate"!==i?.type&&"date"!==i?.type?null==a||"esriFieldTypeDateOnly"!==i?.type&&"date-only"!==i?.type?null==a||"esriFieldTypeTimeOnly"!==i?.type&&"time-only"!==i?.type?null==a||"esriFieldTypeTimestampOffset"!==i?.type&&"timestamp-offset"!==i?.type?a:new u.H(a):c.n.fromReader(a):l.u.fromReader(a):A(new Date(a),r?.getLuxonTimeZone(i.name)??f.Qf.utcInstance)}(n=a||(a={}))[n.Normal=0]="Normal",n[n.Escaped=1]="Escaped";let em={getAttribute:(e,t)=>(e&&"object"==typeof e.attributes?e.attributes:e)[t]}}}]);