"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[448],{448:(t,e,i)=>{i.r(e),i.d(e,{Demo21AppD3USTopoVis:()=>m});var n=i(8888),s=i(873),o=i(3994),a=i(2190),r=i(7028),h=i(906),c=function(t,e,i,n){return new(i||(i=Promise))((function(s,o){function a(t){try{h(n.next(t))}catch(t){o(t)}}function r(t){try{h(n.throw(t))}catch(t){o(t)}}function h(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}h((n=n.apply(t,e||[])).next())}))},l=function(t,e){var i,n,s,o,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(s=2&o[0]?n.return:o[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,o[1])).done)return s;switch(n=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((s=(s=a.trys).length>0&&s[s.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){a.label=o[1];break}if(6===o[0]&&a.label<s[1]){a.label=s[1],s=o;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(o);break}s[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{i=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},p=function(){function t(t){this.USTopoSVG=t,this.id=this.USTopoSVG.divHost.id,this.width=this.USTopoSVG.properties.widthVis-this.USTopoSVG.margin.left-this.USTopoSVG.margin.right,this.height=this.USTopoSVG.properties.heightVis-this.USTopoSVG.margin.top-this.USTopoSVG.margin.bottom,this.Init()}return t.prototype.Init=function(){return c(this,void 0,void 0,(function(){var t=this;return l(this,(function(e){return this.InitProjection(),this.InitSVG(),this.InitBase().then((function(){t.DrawMapSVG()})),this.InitRefer(),[2]}))}))},t.prototype.InitRefer=function(){var t=document.createElement("div");t.textContent="Reference: https://observablehq.com/@d3/choropleth",t.style.marginLeft="10px",t.style.marginTop="10px",this.USTopoSVG.divHost.append(t)},t.prototype.InitProjection=function(){var t=.5*this.width,e=.5*this.height;this.d3projection=(0,a.Z)().scale(1e3).translate([t,e]),this.d3GeoPathGenerator=(0,r.Z)().projection(this.d3projection).pointRadius(4)},t.prototype.InitSVG=function(){this.d3Selection=(0,o.Ys)("#"+this.id).append("svg").attr("width",this.width+this.USTopoSVG.margin.left+this.USTopoSVG.margin.right).attr("height",this.height+this.USTopoSVG.margin.top+this.USTopoSVG.margin.bottom).style("position","absolute").append("g").attr("transform","translate("+this.USTopoSVG.margin.left+","+this.USTopoSVG.margin.top+")")},t.prototype.InitBase=function(){return c(this,void 0,void 0,(function(){var t=this;return l(this,(function(e){return[2,h.G7.URL("https://gist.githubusercontent.com/mbostock/4090846/raw/d534aba169207548a8a3d670c9c2cc719ff05c47/us.json").then((function(e){t.topoUSARaw=JSON.parse(e),t.geoJsonBase=(0,s.zL)(t.topoUSARaw,t.topoUSARaw.objects.counties);for(var i=0;i<t.geoJsonBase.features.length;++i){var n=t.geoJsonBase.features[i],o=t.USTopoSVG.dataClass.data[n.id],a=t.USTopoSVG.sleID;try{if(o[a]){var r=h.$H.Remap(+o[a],t.USTopoSVG.dataClass.min,t.USTopoSVG.dataClass.max,0,600);t.geoJsonBase.features[i].properties.data=r}else t.geoJsonBase.features[i].properties.data=0}catch(e){t.geoJsonBase.features[i].properties.data=0}Math.random()<.5?t.geoJsonBase.features[i].properties.visited=!0:t.geoJsonBase.features[i].properties.visited=!1}return t.geoJsonBase}))]}))}))},t.prototype.DrawMapSVG=function(){var t=this;this.d3Selection.selectAll("path").data(this.geoJsonBase.features).enter().append("path").attr("d",this.d3GeoPathGenerator).style("stroke","#fff").style("stroke-width",".25").style("fill",(function(t){return"rgb(0, 0, "+t.properties.data+")"})).on("mouseover",(function(t){null!==o.Ba6.currentTarget&&(0,o.Ys)(o.Ba6.currentTarget).style("fill",(function(t){var e=t.properties.data;return"rgb(0, 0, "+(e+e)+")"}))})).on("mousemove",(function(e,i){t.USTopoSVG.UpdateLegend(e)})).on("click",(function(t,e){null!==o.Ba6.currentTarget&&(0,o.Ys)(o.Ba6.currentTarget).style("fill",(function(t){return"rgb(0, 0, "+t.properties.data+")"}))})).on("mouseleave",(function(){null!==o.Ba6.currentTarget&&(0,o.Ys)(o.Ba6.currentTarget).style("fill",(function(t){return"rgb(0, 0, "+t.properties.data+")"}))}))},t}(),u=function(){function t(t,e,i,n,s,o){void 0===i&&(i=670),void 0===n&&(n=400),void 0===s&&(s=250),void 0===o&&(o=150),this.width=250,this.height=300,this.vec=new h.h9(0,0),this.isCaptured=!1,this.histData=[],this.binNum=20,this.binIndexSel=-1,this.valSel=-1,this.xStandardDeviation=0,this.USTopoSVG=t,this.hostDiv=e,this.vec.x=i,this.vec.y=n,this.width=s,this.height=o,this.InitDiv(),this.Render()}return t.prototype.InitDiv=function(){var t=document.createElement("div");if(t){this.div=t,this.hostDiv.append(this.div),this.div.style.position="absolute",this.div.style.background="rgba(255, 255, 255, 1.0)",this.div.style.pointerEvents="none",this.div.style.top=this.vec.y+"px",this.div.style.left=this.vec.x+"px",this.div.style.width=this.width+"px",this.div.style.height=this.height+"px",this.div.style.border="2px",this.div.style.borderColor="#000000";var e=document.createElement("div");e&&(this.divTitle=e,this.div.append(this.divTitle),this.divTitle.style.margin="5px",this.divTitle.textContent="Unemployment rate (%)"),this.InitCanvas();var i=document.createElement("div");i&&(this.divInspection=i,this.div.append(this.divInspection),this.divInspection.style.margin="5px",this.divInspection.textContent="Move your mouse to inspect the data")}},t.prototype.UpdateLegend=function(t,e){var i=t.id,n=this.USTopoSVG.dataClass.data[i];try{var s=n[3]+","+n[4]+", value:"+n[e];this.valSel=n[e],this.binIndexSel=h.cb.GetIndexByDataForHistDataFromNumeric(this.histData,n[e]),this.divInspection.textContent=s}catch(t){s="",this.divInspection.textContent=s}},t.prototype.InitCanvas=function(){var t=document.createElement("canvas");if(t){this.canvas=t,this.canvas.style.pointerEvents="none",this.canvas.height=50,this.canvas.width=this.width-10,this.canvas.style.margin="5px";var e=this.canvas.getContext("2d");e&&(this.ctx=e,this.div.append(this.canvas),this.histData=h.cb.GetDataForHistDataFromNumeric(this.USTopoSVG.dataClass.dataSelArray,this.binNum),this.xStandardDeviation=h.cb.StandardDeviation(this.USTopoSVG.dataClass.dataSelArray))}},t.prototype.IsInside=function(t,e){return!(this.vec.x>t||this.vec.x+this.width<t||this.vec.y>e||this.vec.y+this.height<e)},t.prototype.MouseDown=function(t){this.IsInside(t.x,t.y)?this.isCaptured=!0:this.isCaptured=!1},t.prototype.MouseUp=function(t){this.isCaptured=!0},t.prototype.MouseMove=function(t){this.IsInside(t.x,t.y)?(this.isCaptured=!0,this.div.style.background="rgba(255, 255, 255, 1.0)"):(this.div.style.background="rgba(230, 230, 230, 0.0)",this.isCaptured=!1)},t.prototype.MouseDrag=function(t){if(this.isCaptured){var e=t.x-t.preX,i=t.y-t.preY;if(this.div.style.top&&this.div.style.left){var n=parseFloat(this.div.style.top),s=parseFloat(this.div.style.left);if(n&&s){var o=s*e,a=n*i;this.vec.x=o,this.vec.y=a,this.div.style.top=this.vec.y+"px",this.div.style.left=this.vec.x+"px"}}}},t.prototype.Render=function(){var t=this;requestAnimationFrame((function(){t.Render()})),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.beginPath(),this.ctx.rect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.closePath(),this.ctx.fillStyle="rgba(0, 0, 0, 0)",this.ctx.fill();for(var e=this.ctx.canvas.width/this.binNum+1,i=Number.MIN_SAFE_INTEGER,n=0;n<this.histData.length;++n){var s=this.histData[n].length;i<s&&(i=s)}for(n=0;n<this.histData.length;++n){var o=this.histData[n].length;this.binIndexSel===n&&this.binIndexSel>0?this.ctx.fillStyle="#0000ff":this.ctx.fillStyle="#0000aa",this.ctx.beginPath();var a=h.$H.Remap(o,0,i,this.ctx.canvas.height-3,5);this.ctx.rect(n*e,a,e-5,this.ctx.canvas.height),this.ctx.closePath(),this.ctx.fill()}var r=h.$H.Remap(this.xStandardDeviation,this.USTopoSVG.dataClass.min,this.USTopoSVG.dataClass.max,5,this.ctx.canvas.width);this.ctx.setLineDash([2,4]),this.ctx.strokeStyle="#000000",this.ctx.beginPath(),this.ctx.moveTo(r,0),this.ctx.lineTo(r,this.ctx.canvas.height),this.ctx.closePath(),this.ctx.lineWidth=1,this.ctx.stroke(),this.ctx.setLineDash([0,0]),r=h.$H.Remap(this.valSel,this.USTopoSVG.dataClass.min,this.USTopoSVG.dataClass.max,5,this.ctx.canvas.width),this.ctx.setLineDash([3,3]),this.ctx.beginPath(),this.ctx.moveTo(r,0),this.ctx.lineTo(r,this.ctx.canvas.height),this.ctx.closePath(),this.ctx.strokeStyle="#0000ff",this.ctx.lineWidth=1.5,this.ctx.stroke(),this.ctx.setLineDash([0,0])},t}(),d=function(){function t(t){this.data={},this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER,this.dataSelArray=[],this.USTopoSVG=t}return t.prototype.Init=function(t){return e=this,i=void 0,s=function(){var e=this;return function(t,e){var i,n,s,o,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(s=2&o[0]?n.return:o[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,o[1])).done)return s;switch(n=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((s=(s=a.trys).length>0&&s[s.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){a.label=o[1];break}if(6===o[0]&&a.label<s[1]){a.label=s[1],s=o;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(o);break}s[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{i=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}}(this,(function(i){return[2,fetch("njslabSandboxStatic/data/dataUSUnemployed.csv").then((function(t){return t.text()})).then((function(i){var n=[],s=i.split("\r\n");e.index=s[4].split(",");for(var o=6;o<s.length;++o){var a=s[o].split(",");n.push(a);var r=+a[t];r&&(e.dataSelArray.push(r),r<e.min&&(e.min=r),r>e.max&&(e.max=r))}for(e.dataRaw=n,o=0;o<n.length;++o){var h=n[o][1]+n[o][2];e.data[h]=n[o]}return e.dataRaw})).catch((function(t){console.log(t)}))]}))},new((n=void 0)||(n=Promise))((function(t,o){function a(t){try{h(s.next(t))}catch(t){o(t)}}function r(t){try{h(s.throw(t))}catch(t){o(t)}}function h(e){var i;e.done?t(e.value):(i=e.value,i instanceof n?i:new n((function(t){t(i)}))).then(a,r)}h((s=s.apply(e,i||[])).next())}));var e,i,n,s},t}(),f=i(7557),v=function(t,e,i,n){return new(i||(i=Promise))((function(s,o){function a(t){try{h(n.next(t))}catch(t){o(t)}}function r(t){try{h(n.throw(t))}catch(t){o(t)}}function h(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}h((n=n.apply(t,e||[])).next())}))},y=function(t,e){var i,n,s,o,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(s=2&o[0]?n.return:o[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,o[1])).done)return s;switch(n=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((s=(s=a.trys).length>0&&s[s.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){a.label=o[1];break}if(6===o[0]&&a.label<s[1]){a.label=s[1],s=o;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(o);break}s[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{i=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}},g=function(){function t(t){this.width=800,this.height=500,this.mp=[0,0],this.divHost=t,this.properties={widthVis:800,heightVis:500,labelX:"string",labelY:"string",minX:0,maxX:500,minY:0,maxY:500},this.margin=new h.yA,this.margin.bottom=5,this.margin.left=5,this.margin.right=5,this.margin.top=5,this.listShapes=new Object,this.color=(0,n.PK)().range(["rgb(213,222,217)","rgb(69,173,168)","rgb(84,36,55)","rgb(217,91,67)"]),this.sleID=10,this.Init()}return t.prototype.Init=function(){return v(this,void 0,void 0,(function(){var t=this;return y(this,(function(e){return this.InitData().then((function(){t.d3Implementation=new p(t),t.InitCanvas(),t.legend=new u(t,t.divHost)})),[2]}))}))},t.prototype.InitData=function(){return v(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return this.dataClass=new d(this),[4,this.dataClass.Init(this.sleID)];case 1:return[2,t.sent()]}}))}))},t.prototype.UpdateLegend=function(t){this.legend&&this.legend.UpdateLegend(t,this.sleID)},t.prototype.InitCanvas=function(){var t=document.createElement("canvas");t.style.pointerEvents="none",t.style.position="absolute",t.width=1e3,t.height=1e3,this.divHost.append(t);var e=t.getContext("2d");this.id=this.divHost.id,e&&(this.ctx=e,this.Update())},t.prototype.MouseDown=function(t){this.legend&&this.legend.MouseDown(t)},t.prototype.MouseUp=function(t){this.legend&&this.legend.MouseUp(t)},t.prototype.MouseMove=function(t){this.mp[0]=t.x,this.mp[1]=t.y,this.legend&&this.legend.MouseMove(t)},t.prototype.MouseDrag=function(t){this.legend.MouseDrag(t)},t.prototype.arcToCoordinates=function(t,e){var i=0,n=0;return e.map((function(e){return[(i+=e[0])*t.transform.scale[0]+t.transform.translate[0],(n+=e[1])*t.transform.scale[1]+t.transform.translate[1]]}))},t.prototype.Update=function(){var t=this;requestAnimationFrame((function(){t.Update()})),this.ctx.clearRect(0,0,1500,1500);var e=(0,f.Z)();this.ctx.beginPath(),this.ctx.strokeStyle="#eee",this.d3Implementation.d3GeoPathGenerator(e()),this.ctx.strokeStyle="#bbbbbb",this.ctx.stroke(),this.ctx.lineWidth=.5,this.ctx.strokeStyle="#333",this.ctx.beginPath(),this.ctx.stroke(),this.ctx.globalCompositeOperation=h.kz.SCREEN,this.d3Implementation.d3projection([this.mp[0],this.mp[1]]),this.ctx.beginPath(),this.ctx.arc(this.mp[0],this.mp[1],25,0,6.28),this.ctx.closePath(),this.ctx.fillStyle="rgba(255, 255, 255, 0.25)",this.ctx.fill(),this.ctx.globalCompositeOperation=h.kz.SOURCE_OVER},t}(),x=function(){function t(t){var e=document.getElementById(t);e&&(this.divHost=e,this.InitApp())}return t.prototype.InitApp=function(){console.log("ddsdd"),this.USTopoSVG=new g(this.divHost)},t}(),m=function(){function t(t){void 0===t&&(t="SandBox"),this.implementation=new x(t)}return t.Init=function(e){new t(e).Dummy()},t.prototype.Dummy=function(){},t}()}}]);