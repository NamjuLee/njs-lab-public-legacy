"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[371],{371:(t,n,r)=>{r.r(n),r.d(n,{AppCanvasTemplate:()=>h});var e,i=function(){function t(t,n,r){this.x=t,this.y=n,this.z=r}return t.times=function(n,r){return new t(n*r.x,n*r.y,n*r.z)},t.minus=function(n,r){return new t(n.x-r.x,n.y-r.y,n.z-r.z)},t.plus=function(n,r){return new t(n.x+r.x,n.y+r.y,n.z+r.z)},t.dot=function(t,n){return t.x*n.x+t.y*n.y+t.z*n.z},t.mag=function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},t.norm=function(n){var r=t.mag(n),e=0===r?1/0:1/r;return t.times(e,n)},t.cross=function(n,r){return new t(n.y*r.z-n.z*r.y,n.z*r.x-n.x*r.z,n.x*r.y-n.y*r.x)},t}(),o=function(){function t(t,n,r){this.r=t,this.g=n,this.b=r}return t.scale=function(n,r){return new t(n*r.r,n*r.g,n*r.b)},t.plus=function(n,r){return new t(n.r+r.r,n.g+r.g,n.b+r.b)},t.times=function(n,r){return new t(n.r*r.r,n.g*r.g,n.b*r.b)},t.toDrawingColor=function(t){var n=function(t){return t>1?1:t};return[Math.floor(255*n(t.r)),Math.floor(255*n(t.g)),Math.floor(255*n(t.b))]},t.white=new t(1,1,1),t.grey=new t(.5,.5,.5),t.black=new t(.05,.05,.05),t.background=t.black,t.defaultColor=t.black,t}(),s=function(t,n){this.pos=t;var r=new i(0,-1,0);this.forward=i.norm(i.minus(n,this.pos)),this.right=i.times(1.5,i.norm(i.cross(this.forward,r))),this.up=i.times(1.5,i.norm(i.cross(this.forward,this.right)))},u=function(t){!function(t){var n=document.getElementById(t),r=document.createElement("canvas");r.width=512,r.height=512,n.append(r);var u=r.getContext("2d");(new f).render({things:[new c(new i(0,1,0),0,e.checkerboard),new a(new i(0,1,-.25),1,e.shiny),new a(new i(-6,3,-5),1,e.shiny),new a(new i(-6,8,15),5,e.shiny),new a(new i(-1,.5,1.5),.5,e.shiny)],lights:[{pos:new i(-2,2.5,0),color:new o(1,1,1)},{pos:new i(0,3.5,0),color:new o(.21,.21,.35)}],camera:new s(new i(3,2,4),new i(-1,.5,0))},u,512,512)}(t)},a=function(){function t(t,n,r){this.center=t,this.surface=r,this.radius2=n*n}return t.prototype.intersect=function(t){var n=i.minus(this.center,t.start),r=i.dot(n,t.dir),e=0;if(r>=0){var o=this.radius2-(i.dot(n,n)-r*r);o>=0&&(e=r-Math.sqrt(o))}return 0===e?null:{thing:this,ray:t,dist:e}},t.prototype.normal=function(t){return i.norm(i.minus(t,this.center))},t}(),c=function(t,n,r){var e=this;this.surface=r,this.normal=function(n){return t},this.intersect=function(r){var o=i.dot(t,r.dir);if(!(o>0)){var s=(i.dot(t,r.start)+n)/-o;return{thing:e,ray:r,dist:s}}}};!function(t){t.shiny={diffuse:function(t){return o.white},specular:function(t){return o.grey},reflect:function(t){return 0},roughness:250},t.checkerboard={diffuse:function(t){return(Math.floor(t.z)+Math.floor(t.x))%2!=0?o.white:o.black},specular:function(t){return o.white},reflect:function(t){return(Math.floor(t.z)+Math.floor(t.x))%2!=0?.1:.7},roughness:150}}(e||(e={}));var f=function(){function t(){this.maxDepth=100}return t.prototype.intersections=function(t,n){var r=1/0,e=void 0;for(var i in n.things){var o=n.things[i].intersect(t);null!=o&&o.dist<r&&(e=o,r=o.dist)}return e},t.prototype.testRay=function(t,n){var r=this.intersections(t,n);return void 0===r?void 0:r.dist},t.prototype.traceRay=function(t,n,r){var e=this.intersections(t,n);return void 0===e?o.background:this.shade(e,n,r)},t.prototype.shade=function(t,n,r){var e=t.ray.dir,s=i.plus(i.times(t.dist,e),t.ray.start),u=t.thing.normal(s),a=i.minus(e,i.times(2,i.times(i.dot(u,e),u))),c=o.plus(o.background,this.getNaturalColor(t.thing,s,u,a,n)),f=r>=this.maxDepth?o.grey:this.getReflectionColor(t.thing,s,u,a,n,r);return o.plus(c,f)},t.prototype.getReflectionColor=function(t,n,r,e,i,s){return o.scale(t.surface.reflect(n),this.traceRay({start:n,dir:e},i,s+1))},t.prototype.getNaturalColor=function(t,n,r,e,s){var u=this;return s.lights.reduce((function(a,c){var f=i.minus(c.pos,n),h=i.norm(f),l=u.testRay({start:n,dir:h},s);if(void 0!==l&&l<=i.mag(f))return a;var d=i.dot(h,r),p=d>0?o.scale(d,c.color):o.defaultColor,m=i.dot(h,i.norm(e)),g=m>0?o.scale(Math.pow(m,t.surface.roughness),c.color):o.defaultColor;return o.plus(a,o.plus(o.times(t.surface.diffuse(n),p),o.times(t.surface.specular(n),g)))}),o.defaultColor)},t.prototype.render=function(t,n,r,e){for(var s=function(t,n,o){return i.norm(i.plus(o.forward,i.plus(i.times(function(t){return(t-r/2)/2/r}(t),o.right),i.times(function(t){return-(t-e/2)/2/e}(n),o.up))))},u=0;u<e;u++)for(var a=0;a<r;a++){var c=this.traceRay({start:t.camera.pos,dir:s(a,u,t.camera)},t,0),f=o.toDrawingColor(c);n.fillStyle="rgb("+String(f[0])+", "+String(f[1])+", "+String(f[2])+")",n.fillRect(a,u,a+1,u+1)}},t}(),h=function(){function t(t){void 0===t&&(t="SandBox"),this.implementation=new u(t),console.log("AppCanvasTemplate 1000")}return t.Init=function(n){new t(n).Dummy()},t.prototype.Dummy=function(){},t}()}}]);