"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6074],{6074:(t,o,n)=>{n.r(o),n.d(o,{Demo300GA:()=>m});var e=function(t,o){void 0===o&&(o=void 0),o=o||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var n="",e=0;e<t;e++){var i=Math.floor(Math.random()*o.length);n+=o.substring(i,i+1)}return n},i=function(t){for(var o=t.length,n=new Array(o),e=0;e<o;++e)n[e]=e;return n.sort((function(o,n){return t[o]<t[n]?-1:t[o]>t[n]?1:0})),n},s=function(t){void 0===t&&(t="NJnamju6178607084");var o=new r(t);console.log(o.Evloution()),console.log(o.history),console.log(o.historyScore)},r=function(){function t(t){void 0===t&&(t="00110001"),this.history=[],this.historyScore=[],this.keyword="00110001",this.numGeneration=5e3,this.numPopulation=100,this.best_sample=20,this.lucky_few=0,this.n_child=5,this.length=10,this.chance_of_mutation=.5,this.keyword=t,this.length=t.length,this.history=[]}return t.prototype.Evloution=function(){for(var t=this.InitPopulation(this.numPopulation),o=0,n=0;n<this.numGeneration;++n){var e=this.ComputeFitness(t,this.keyword),i=e.scoreOrdered,s=e.popOrdered;if(o=e.pred_len,1===i[0])return console.log('SUCCESS! The word is "'+s[0]),this.history.push(n+" Iter, Done: "+s[0]+", Score: "+i[0]),this.historyScore.push(i[0]),s[0];var r=this.Selection(s,this.best_sample,this.lucky_few,o),h=this.ComputeReproductions(r,this.n_child);t=this.ComputeMutations(h,this.chance_of_mutation),this.history.push(n+" Iter: "+s[0]+", Score: "+i[0]),this.historyScore.push(i[0])}return""},t.prototype.ComputeMutations=function(t,o){for(var n=0;n<t.length;++n)Math.random()<o&&(t[n]=this.Mutation(t[n]));return t},t.prototype.Mutation=function(t){var o,n,i,s=e(5);return o=t,n=Math.fround(Math.random()*t.length),i=s[0],o.substr(0,n)+i+o.substr(n+i.length)},t.prototype.ComputeReproductions=function(t,o){for(var n=[],e=0;e<t.length/2;++e)for(var i=0;i<o;++i)n.push(this.Reproduction(t[e],t[t.length-1-e]));return n},t.prototype.Reproduction=function(t,o){for(var n="",e=0;e<this.length;++e)Math.random()<.499?n+=t[e]:n+=o[e];return n},t.prototype.Selection=function(t,o,n,i){for(var s=[],r=0;r<o;++r)s.push(t[r]);for(r=0;r<n;++r){var h=Math.floor(Math.random()*(t.length-o));s.push(t[h+o])}for(;s.length<o+n;)s.push(e(i));return function(t){for(var o=t.length;o>1;){o--;var n=Math.floor(Math.random()*(o+1)),e=t[n];t[n]=t[o],t[o]=e}}(s),s},t.prototype.ComputeFitness=function(t,o){for(var n=-1,e=[],s=[],r=0;r<t.length;++r){var h=t[r],a=this.Fitness(o,h);a>0&&(n=h.length),e.push(h),s.push(a)}var p=i(s),u=[],l=[];for(r=p.length-1;r>-1;--r)u.push(e[p[r]]),l.push(s[p[r]]);return{popOrdered:u,scoreOrdered:l,pred_len:n}},t.prototype.Fitness=function(t,o){var n=0;if(t.length!==o.length)return n;n+=.5;for(var e=0;e<t.length;++e)t[e]===o[e]&&(n+=1);return n/(t.length+.5)},t.prototype.InitPopulation=function(t){for(var o=[],n=0;n<t;++n)o.push(e(this.length));return o},t}(),h=function(t){return t.param[0]*t.param[1]-t.param[2]+t.param[3]},a=function(t){void 0===t&&(t=4);for(var o=new u(t),n=0;n<100;++n)console.log(o.Evloution())},p=function(){function t(t){this.param=[],this.param=[];for(var o=0;o<t;++o)this.param.push(10*(Math.random()-.5))}return t.prototype.mutation=function(){for(var t=0;t<this.param.length;++t)if(Math.random()<.5){var o=Math.random()-.5;this.param[t]+=o}},t.prototype.toString=function(){for(var t="",o=0;o<this.param.length;++o)t+=this.param[o]+", ";return t},t}(),u=function(){function t(t){this.history=[],this.historyScore=[],this.numGeneration=200,this.numPopulation=100,this.best_sample=20,this.lucky_few=0,this.n_child=5,this.length=10,this.chance_of_mutation=.5,this.length=t,this.history=[]}return t.prototype.Evloution=function(){for(var t=this.InitPopulation(this.numPopulation),o=0;o<this.numGeneration;++o){var n=this.ComputeFitness(t),e=n.scoreOrdered,i=n.popOrdered;if(e[0]>.98)return console.log('SUCCESS! The word is "'+i[0]+'"',", Score: "+e[0]),console.log("compute: ",h(i[0])-500),this.history.push(o+" Iter, Done: "+i[0].toString()+", Score: "+e[0]),this.historyScore.push(e[0]),i[0];var s=this.Selection(i,this.best_sample,this.lucky_few),r=this.ComputeReproductions(s,this.n_child);t=this.ComputeMutations(r,this.chance_of_mutation),this.history.push(o+" Iter: "+i[0]+", Score: "+e[0]),this.historyScore.push(e[0])}},t.prototype.ComputeMutations=function(t,o){for(var n=0;n<t.length;++n)Math.random()<o&&t[n].mutation();return t},t.prototype.ComputeReproductions=function(t,o){for(var n=[],e=0;e<t.length/2;++e)for(var i=0;i<o;++i)n.push(this.Reproduction(t[e],t[t.length-1-e]));return n},t.prototype.Reproduction=function(t,o){for(var n=new p(4),e=0;e<t.param.length;++e)Math.random()<.499?n.param[e]+=t.param[e]:n.param[e]+=o.param[e];return n},t.prototype.Selection=function(t,o,n){for(var e=[],i=0;i<o;++i)e.push(t[i]);for(i=0;i<n;++i){var s=Math.floor(Math.random()*(t.length-o));e.push(t[s+o])}for(;e.length<o+n;)e.push(new p(4));return l(e),e},t.prototype.ComputeFitness=function(t){for(var o=[],n=[],e=0;e<t.length;++e){var s=t[e],r=this.Fitness(s);o.push(s),n.push(r)}var h=i(n),a=[],p=[];for(e=h.length-1;e>-1;--e)a.push(o[h[e]]),p.push(n[h[e]]);return{popOrdered:a,scoreOrdered:p}},t.prototype.Fitness=function(t){return function(t,o){void 0===o&&(o=.02);var n=h(t);return n-=500,Math.pow(1-o,Math.abs(n))}(t)},t.prototype.InitPopulation=function(t){for(var o=[],n=0;n<t;++n)o.push(new p(4));return o},t}(),l=function(t){for(var o=t.length;o>1;){o--;var n=Math.floor(Math.random()*(o+1)),e=t[n];t[n]=t[o],t[o]=e}},c=n(1105),f=(n(6947),function(){function t(t){this.pathsOrigin=[],this.nodes=[],this.fitness=0,this.distance=0,this.pathsOrigin=t,this.nodes=[],this.fitness=0,this.distance=0;for(var o=0;o<this.pathsOrigin.length;++o)this.nodes.push(void 0)}return t.prototype.generateIndividual=function(){for(var t=0;t<this.pathsOrigin.length;++t)this.setCityInit(t,this.pathsOrigin[t]);(0,c.TV)(this.nodes)},t.prototype.setCityInit=function(t,o){this.nodes[t]=o,this.fitness=0,this.distance=0},t.prototype.getFitness=function(){return 0===this.fitness&&(this.fitness=1/this.getDistance()),this.fitness},t.prototype.getDistance=function(){if(0===this.distance){for(var t=0,o=0;o<this.nodes.length;++o){var n=this.nodes[o];if(n){var e;(e=o===this.nodes.length-1?this.nodes[0]:this.nodes[o+1])&&(t+=n.distanceTo(e))}}this.distance=t}return this.distance},t.prototype.containsCity=function(t){for(var o=0;o<this.nodes.length;++o)if(this.nodes[o]===t)return!0;return!1},t}()),d=function(){function t(t,o,n){this.paths=[],this.paths=[];for(var e=0;e<o;++e)this.paths.push(void 0);if(n)for(e=0;e<o;++e){var i=new f(t);i.generateIndividual(),this.paths[e]=i}}return t.prototype.getFittestPath=function(){for(var t=this.paths[0],o=0;o<this.paths.length;++o){var n=this.paths[o];t&&n&&t.getFitness()<=n.getFitness()&&(t=n)}return t},t}(),v=function(){function t(t,o,n,e){void 0===o&&(o=.05),void 0===n&&(n=5),void 0===e&&(e=!0),this.nodes=t,this.mutationRate=o,this.nodeSize=n,this.elitism=e}return t.prototype.evolvePopulation=function(t){var o=new d(this.nodes,t.paths.length,!1),n=0;if(this.elitism){var e=t.getFittestPath();e&&(o.paths[0]=e,n=1)}for(var i=n;i<o.paths.length;++i){var s=this.tournamentSelection(t),r=this.tournamentSelection(t);if(s&&r){var h=this.crossover(s,r);o.paths[i]=h}}for(i=n;i<o.paths.length;++i){var a=o.paths[i];a&&this.mutate(a)}return o},t.prototype.crossover=function(t,o){for(var n=new f(this.nodes),e=Math.floor(Math.random()*t.nodes.length),i=Math.floor(Math.random()*t.nodes.length),s=0;s<n.nodes.length;++s)(r=t.nodes[s])&&(e<i&&s>e&&s<i||e>i&&0==(s<e&&s>i))&&n.setCityInit(s,r);for(s=0;s<o.nodes.length;++s){var r;if((r=o.nodes[s])&&!1===n.containsCity(r))for(var h=0;h<n.nodes.length;++h)if(void 0===n.nodes[h]){n.setCityInit(h,r);break}}return n},t.prototype.mutate=function(t){for(var o=0;o<t.nodes.length;++o)if(Math.random()<this.mutationRate){var n=Math.floor(t.nodes.length*Math.random()),e=t.nodes[o],i=t.nodes[n];e&&i&&(t.setCityInit(n,e),t.setCityInit(o,i))}},t.prototype.tournamentSelection=function(t){for(var o=new d(this.nodes,this.nodeSize,!1),n=0;n<this.nodeSize;++n){var e=Math.floor(Math.random()*t.paths.length);o.paths[n]=t.paths[e]}return o.getFittestPath()},t}(),g=function(){function t(t){void 0===t&&(t=0),this.pathFittest=void 0,this.timer=0,this.cost=Number.MAX_VALUE,this.posByMouse=[],this.random=(0,c.MX)(t),this.posByMouse=[];for(var o=0;o<5;++o){var n=700*this.random()+50,e=700*this.random()+50;this.posByMouse.push([n,e])}this.init()}return t.Init=function(){var o=new t;return console.log(o),o},t.prototype.mouseClick=function(t,o){this.posByMouse.push([t,o]),this.init()},t.prototype.init=function(){var t=this.posByMouse.length;this.placesAll=[];for(var o=0;o<this.posByMouse.length;++o);this.pop=new d(this.placesAll,5,!0),this.pathFittest=this.pop.getFittestPath(),this.pathFittest&&console.log("Initial distance: "+this.pathFittest.getDistance()),this.ga=new v(this.placesAll,.1,t)},t.prototype.optimize=function(){if(this.pop=this.ga.evolvePopulation(this.pop),this.pathFittest=this.pop.getFittestPath(),this.pathFittest){var t=this.pathFittest.getDistance();t<this.cost&&(console.log("iter optimization",this.timer),console.log("Final distance: ",t),console.log("Solution:"),console.log(this.pathFittest),this.cost=t),this.timer++}},t.prototype.render=function(t,o){if(this.optimize(),t.fillStyle="#ff0000",t.strokeStyle="#ff0000",t.lineWidth=1,o)for(var n=0;n<this.placesAll.length;++n){t.beginPath();var e=this.placesAll[n];t.arc(e.vec.x,e.vec.y,10,0,2*Math.PI),t.closePath(),t.fill()}if(this.pathFittest)for(n=0;n<this.pathFittest.nodes.length-1;n++){var i=this.pathFittest.nodes[n],s=this.pathFittest.nodes[n+1];i&&s&&(t.beginPath(),t.moveTo(i.vec.x,i.vec.y),t.lineTo(s.vec.x,s.vec.y),t.closePath(),t.stroke())}for(n=0;n<this.placesAll.length;++n)t.beginPath(),e=this.placesAll[n],t.arc(e.vec.x,e.vec.y,10,0,2*Math.PI),t.closePath(),t.fill()},t}(),m=function(){function t(t){var o,n=document.getElementById(t);n&&(this.divHost=n),new s("NJ3N6am8j"),void 0===(o=4)&&(o=4),new a(o),function(t){void 0===t&&(t=4),g.Init()}(),console.log("GA..")}return t.Init=function(o){new t(o)},t.prototype.MouseEventController=function(t){this.sceneWrapper.activeCommandController.MouseEventController(t)},t.prototype.Resize=function(t,o){this.graphicsCoreWrapper.Resize(t,o)},t.prototype.Dispose=function(){this.graphicsCoreWrapper.Dispose(),this.sceneWrapper.Dispose()},t.prototype.Dummy=function(){},t}()}}]);