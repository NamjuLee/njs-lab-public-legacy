"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9645],{9645:(t,e,o)=>{o.r(e),o.d(e,{AppDrawingBlock:()=>B});var i,n=o(906),s=function(){function t(t,e){this.isActive=!1,this.zoom=1,this.translation=[0,0],this.translationZoom=[0,0],this.isViewChanging=!1,this.loopNum=0,this.needRenderloop=!0,this.ablePan=!0,this.pause=!1,this.core=t,this.div=e,this.Init(),this.LoopInit()}return t.prototype.Init=function(){var t=document.createElement("canvas");if(t){this.canvas=t,this.canvas.width=this.div.clientWidth,this.canvas.height=this.div.clientHeight,this.div.append(this.canvas);var e=this.canvas.getContext("2d");e&&(this.ctx=e,this.isActive=!0)}},t.prototype.LoopInit=function(){this.translation[0]=.5*this.ctx.canvas.width,this.translation[1]=.5*this.ctx.canvas.height,this.deltaTime=new n.gk,this.canvasLoopController=new n.NI(60),this.SetLevel4(),this.Loop()},t.prototype.Loop=function(){var t=this,e=performance.now();if(this.deltaTime.UpdateFPS(),this.canvasLoopController.level>3){if(6===this.canvasLoopController.level)requestAnimationFrame((function(){t.Loop()})),this.RenderPre(this.ctx);else if(5===this.canvasLoopController.level)this.isViewChanging,requestAnimationFrame((function(){t.Loop()})),this.RenderPre(this.ctx);else if(4===this.canvasLoopController.level){if(this.isViewChanging,requestAnimationFrame((function(){t.Loop()})),this.canvasLoopController.stop)return;this.RenderPre(this.ctx),this.canvasLoopController.TimerForStop()}}else 1===this.canvasLoopController.level&&this.isViewChanging||this.RenderPre(this.ctx);var o=performance.now();this.log="level:  "+this.canvasLoopController.level+", total frames: "+this.loopNum+++" (FPS: "+this.deltaTime.frameRate.toFixed(0)+"), a loop took: "+(o-e).toFixed(2)+" ms to execute."},t.prototype.SetLevel1=function(){this.canvasLoopController.level=1,this.Loop()},t.prototype.SetLevel2=function(){this.canvasLoopController.level=2,this.Loop()},t.prototype.SetLevel3=function(){this.canvasLoopController.level=3,this.Loop()},t.prototype.RenderSetLevel4=function(){this.canvasLoopController.stop=!0},t.prototype.SetLevel4=function(){var t=this;this.canvasLoopController.Reset(),setTimeout((function(){t.canvasLoopController.level=4,t.Loop()}),500)},t.prototype.SetLevel5=function(){var t=this;this.canvasLoopController.Reset(),setTimeout((function(){t.canvasLoopController.level=5,t.Loop()}),500)},t.prototype.SetLevel6=function(){var t=this;this.canvasLoopController.Reset(),setTimeout((function(){t.canvasLoopController.level=6,t.Loop()}),500)},t.prototype.Clear=function(t){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)},t.prototype.Zoom=function(t){t.wheel<0?this.zoom+=.09*this.zoom:(console.log("out",this.zoom),this.zoom-=.09*this.zoom)},t.prototype.RemapByZoom=function(t){return t.x=(t.xs-this.translation[0])/this.zoom,t.y=(t.ys-this.translation[1])/this.zoom,t},t.prototype.Pan=function(t){if(this.ablePan){var e=t.xs-t.preXs,o=t.ys-t.preYs;this.translation[0]+=e,this.translation[1]+=o}},t.prototype.RenderForce=function(){this.canvasLoopController.stop=!1},t.prototype.RenderPre=function(t){this.isActive&&(this.Clear(this.ctx),this.ctx.save(),this.ctx.translate(this.translation[0],this.translation[1]),this.ctx.scale(this.zoom,this.zoom),this.Render(t),this.ctx.restore())},t.prototype.Render=function(t){},t}();!function(t){t.LEFT="LEFT",t.MIDDLE="MIDDLE",t.RIGHT="RIGHT",t.WHEEL="WHEEL",t.DRAG="DRAG",t.DRAG_LEFT="DRAG_LEFT",t.DRAG_MIDDLE="DRAG_MIDDLE",t.DRAG_RIGHT="DRAG_RIGHT",t.MOVE="MOVE",t.DOUBLE="DOUBLE",t.UP="UP",t.DOWN="DOWN",t.DOWN_MIDDLE="DOWN_MIDDLE",t.DOWN_RIGHT="DOWN_RIGHT"}(i||(i={})),function(){function t(){}t.prototype.MouseEventController=function(t){},t.prototype.KeyboardEventController=function(t){},t.prototype.TouchEventController=function(t){},t.prototype.GestureEventController=function(t){},t.prototype.mouseLeftClick=function(t){},t.prototype.mouseMiddleClick=function(t){},t.prototype.mouseRightClick=function(t){},t.prototype.mouseDoubleClick=function(t){},t.prototype.mouseMove=function(t){},t.prototype.mouseDrag=function(t){},t.prototype.mouseDown=function(t){},t.prototype.mouseUp=function(t){},t.prototype.keydown=function(t){},t.prototype.keyUp=function(t){}}();var r,h,u=function(){function t(){this.x=-1,this.y=-1,this.z=-1,this.preX=-1,this.preY=-1,this.preZ=-1,this.xs=-1,this.ys=-1,this.preXs=-1,this.preYs=-1,this.CLICK_TYPE=i.MOVE,this.isDown=!1,this.isDoubleClick=!1,this.isMove=!1,this.pressedShift=!1,this.pressedAlt=!1,this.pressedCtrl=!1,this.wheel=0,this.preWheel=0,this.isActive=!0}return t.prototype.DeepCopy=function(){var e=new t;return e.x=this.x,e.y=this.y,e.z=this.z,e.preX=this.preX,e.preY=this.preY,e.preZ=this.preZ,e.xs=this.x,e.ys=this.y,e.preXs=this.preXs,e.preYs=this.preYs,e.pressedAlt=this.pressedAlt,e.pressedShift=this.pressedShift,e.pressedCtrl=this.pressedCtrl,e.isDoubleClick=this.isDoubleClick,e.isDown=this.isDown,e.isMove=this.isMove,e.wheel=this.wheel,e.preWheel=this.preWheel,e.yGLPicking=this.yGLPicking,e.CLICK_TYPE=this.CLICK_TYPE,e.command=this.command,e.native=this.native,e},t}(),c=(function(){function t(){}t.LineByVecs=function(t,e,o,i,n){void 0===i&&(i=1),void 0===n&&(n="#ff0000"),t.strokeStyle=n,t.lineWidth=i,t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(o.x,o.y),t.closePath(),t.stroke()},t.Line=function(t,e,o,i,n,s,r){void 0===s&&(s=1),void 0===r&&(r="#ff0000"),t.strokeStyle=r,t.lineWidth=s,t.beginPath(),t.moveTo(e,o),t.lineTo(i,n),t.closePath(),t.stroke()},t.Point=function(t,e,o,i,n){void 0===i&&(i=5),void 0===n&&(n="#ff0000"),t.fillStyle=n,t.beginPath(),t.arc(e,o,i,0,2*Math.PI),t.closePath(),t.fill()},t.PointByNVec=function(t,e,o,i){void 0===o&&(o=5),void 0===i&&(i="#ff0000"),t.fillStyle=i,t.beginPath(),t.arc(e.x,e.y,o,0,2*Math.PI),t.closePath(),t.fill()},t.GridLineOrigin=function(t,e,o,i,n){void 0===e&&(e=10),void 0===o&&(o=10),void 0===i&&(i=20),void 0===n&&(n=20);var s=-e*i*.5,r=-o*n*.5;t.lineWidth=.1;for(var h=0;h<=o;++h)t.beginPath(),t.moveTo(s,r+n*h),t.lineTo(e*i*.5,r+n*h),t.closePath(),t.stroke(),t.beginPath(),t.moveTo(s+i*h,r),t.lineTo(r+n*h,o*n*.5),t.closePath(),t.stroke()},t.GridPointOrigin=function(t,e,o,i,n){void 0===e&&(e=10),void 0===o&&(o=10),void 0===i&&(i=20),void 0===n&&(n=20);var s=-e*i*.5,r=-o*n*.5;t.lineWidth=.1;for(var h=0;h<=o;++h)for(var u=0;u<=e;++u)t.beginPath(),t.arc(s+i*u,r+n*h,1,0,2*Math.PI),t.closePath(),t.fill()}}(),function(){function t(t){this.mouseEventDataPre=new u,this.isEnable=!0,this.clickCount=0,this.click=!1,this.prevent=!1,this.delay=250,this.down=!1,this._stopPropagation=!1,this.ioWrapper=t}return t.prototype.InitNativeMouseEvent=function(t){var e=this;t.onclick=function(t){e.prevent=!1,e.timer=setTimeout((function(){e.prevent||e.MouseClick(t),e.prevent=!1}),e.delay)},t.ondblclick=function(t){clearTimeout(e.timer),e.prevent=!0,e.MouseDoubleClick(t)},t.onmousedown=function(t){e.MouseDown(t)},t.onmouseup=function(t){e.MouseUp(t)},t.onmousemove=function(t){e.MouseMove(t)},t.addEventListener("wheel",(function(t){return e.MouseWheel(t,t.deltaY)}))},t.prototype.MouseDown=function(t){this.click=!0,this.down=!0;var e=this.CommonEventBuilder(t);e.CLICK_TYPE=i.DOWN,e.isDown=!0,this.MouseEvenEmitting(e)},t.prototype.MouseClick=function(t){if(this.click){var e=this.CommonEventBuilder(t);0===t.button?e.CLICK_TYPE=i.LEFT:1===t.button?e.CLICK_TYPE=i.MIDDLE:2===t.button&&(e.CLICK_TYPE=i.RIGHT),this.MouseEvenEmitting(e)}},t.prototype.MouseDoubleClick=function(t){var e=this.CommonEventBuilder(t);e.CLICK_TYPE=i.DOUBLE,this.MouseEvenEmitting(e)},t.prototype.MouseDrag=function(t){this.click=!1,this.prevent=!0;var e=this.CommonEventBuilder(t);e.CLICK_TYPE=i.DRAG,e.isDown=!0,1===t.buttons?e.CLICK_TYPE=i.DRAG:4===t.buttons?e.CLICK_TYPE=i.DRAG_MIDDLE:2===t.buttons&&(e.CLICK_TYPE=i.DRAG_RIGHT),this.MouseEvenEmitting(e)},t.prototype.MouseMove=function(t){if(this.down)this.MouseDrag(t);else{var e=this.CommonEventBuilder(t);e.CLICK_TYPE=i.MOVE,e.isDown=!0,this.prevent=!0,this.MouseEvenEmitting(e)}},t.prototype.MouseUp=function(t){this.down=!1,this.click=!0;var e=this.CommonEventBuilder(t);e.CLICK_TYPE=i.UP,e.isDown=!1,this.MouseEvenEmitting(e)},t.prototype.MouseWheel=function(t,e){var o=this.CommonEventBuilder(t);o.wheel=e,o.CLICK_TYPE=i.WHEEL,this.MouseEvenEmitting(o)},t.prototype.CommonEventBuilder=function(t){var e=new u;return e.preXs=this.mouseEventDataPre.xs,e.preYs=this.mouseEventDataPre.ys,e.preX=this.mouseEventDataPre.x,e.preY=this.mouseEventDataPre.y,e.pressedShift=t.shiftKey,e.pressedAlt=t.altKey,e.pressedCtrl=t.ctrlKey,e.xs=t.offsetX,e.ys=t.offsetY,e.preWheel=this.mouseEventDataPre.wheel,e.wheel=0,e.native=t,e=this.ioWrapper.core.canvas.RemapByZoom(e),this.mouseEventDataPre=e,this.e=e,e},Object.defineProperty(t.prototype,"stopPropagation",{get:function(){return this._stopPropagation},set:function(t){var e=this;t?this._stopPropagation=t:setTimeout((function(){e._stopPropagation=t}),500)},enumerable:!1,configurable:!0}),t.prototype.MouseEvenEmitting=function(t){this.MouseEventEmittingForViewController(t),this._stopPropagation||this.MouseEventEmittingForModel(t)},t.prototype.MouseEventEmittingForViewController=function(t){this.mouseInteractionUI&&this.mouseInteractionUI.MouseInteractionMenu(t)},t.prototype.MouseEventEmittingForModel=function(t){this.ioWrapper.core.activeCommandController.MouseEventController(t)},t}()),p=function(){function t(t){this.core=t,this.mouseInteraction=new c(this)}return t.prototype.InitEventListener=function(t){this.mouseInteraction.InitNativeMouseEvent(t),this.Resize()},t.prototype.Resize=function(){var t=this;window.addEventListener("resize",(function(e){return t.ReSizeWindow(e)}))},t.prototype.ReSizeWindow=function(t){},t}(),l=function(){function t(t){this.mouse=new n.h9(0,0),this.core=t}return t.prototype.MouseEventController=function(t){var e=t.DeepCopy();e.x=t.xs,e.y=t.ys,this.core.nUI.MouseInteractionMenu(e),this.core.nUI.stopPropagation||(this.core.canvas.RenderForce(),this.core.nBlock.implmentations.MouseEventController(t),t.CLICK_TYPE!==n.uh.LEFT?t.CLICK_TYPE!==n.uh.MIDDLE?t.CLICK_TYPE!==n.uh.DOWN_RIGHT?t.CLICK_TYPE!==n.uh.DOUBLE?t.CLICK_TYPE!==n.uh.MOVE?t.CLICK_TYPE!==n.uh.DRAG?t.CLICK_TYPE!==n.uh.DOWN?t.CLICK_TYPE!==n.uh.WHEEL?t.CLICK_TYPE!==n.uh.UP||this.MouseUpPre(t):this.MouseWheelPre(t):this.MouseDownPre(t):this.MouseDragPre(t):this.MouseMovePre(t):this.MouseDoubleClickPre(t):this.MouseRightClickPre(t):this.MouseMiddleClickPre(t):this.MouseLeftClickPre(t))},t.prototype.MouseDown=function(t){},t.prototype.MouseDownPre=function(t){this.MouseDown(t)},t.prototype.MouseLeftClick=function(t){},t.prototype.MouseLeftClickPre=function(t){this.MouseLeftClick(t)},t.prototype.MouseMiddleClick=function(t){},t.prototype.MouseMiddleClickPre=function(t){this.MouseMiddleClick(t)},t.prototype.MouseRightClick=function(t){},t.prototype.MouseRightClickPre=function(t){this.MouseRightClick(t)},t.prototype.MouseUp=function(t){},t.prototype.MouseUpPre=function(t){this.MouseUp(t)},t.prototype.MouseDoubleClick=function(t){},t.prototype.MouseDoubleClickPre=function(t){this.MouseDoubleClick(t)},t.prototype.MouseMove=function(t){},t.prototype.MouseMovePre=function(t){this.MouseMove(t)},t.prototype.MouseDrag=function(t){},t.prototype.MouseDragPre=function(t){this.mouse.x=t.x,this.mouse.y=t.y,this.core.canvas.Pan(t),this.MouseDrag(t)},t.prototype.MouseWheel=function(t){},t.prototype.MouseWheelPre=function(t){this.core.canvas.Zoom(t),this.MouseWheel(t)},t.prototype.pushActionFromPulldown=function(t){t.split("@")[0]},t}(),a=function(){function t(t,e){this.nBlock=t,this.InitPulldown(),this.InitCanvas(e),this.activeCommandController=new l(this),this.ioWrapper=new p(this)}return t.prototype.InitCanvas=function(t){this.canvas=new s(this,t)},t.prototype.InitPulldown=function(){this.nUI=new n.Fc(this.nBlock.div),this.BindingActiveCommandController()},t.prototype.InitPost=function(){this.ioWrapper.InitEventListener(this.nBlock.div)},t.prototype.BindingActiveCommandController=function(){var t=this;this.nUI.BindingActiveCommandController("NDrawingBlock",(function(e){return t.Commander(e)}))},t.prototype.Resize=function(t,e){this.nUI.Resize(t,e)},t.prototype.Commander=function(t){this.activeCommandController.pushActionFromPulldown(t)},t}(),f=function(){function t(t){this.implementation=t,this.activeCommandController=this.implementation.activeCommandController}return t.prototype.OnRender=function(t){this.Update(t),this.Render(t)},t.prototype.Update=function(t){},t.prototype.Render=function(t){n.gi.GridLineOrigin(t,10,10,50,50);for(var e=0;e<this.implementation.scene.listBlocks.length;++e)this.implementation.scene.listBlocks[e].Render(t);this.implementation.scene.drawingGraph.Render(t),t.fillStyle="#00ff00",t.beginPath(),t.arc(this.activeCommandController.mouse.x,this.activeCommandController.mouse.y,2,0,2*Math.PI),t.closePath(),t.fill()},t}(),d=function(){function t(t){this.implementation=t}return t.prototype.Pick=function(t){for(var e=0;e<this.implementation.scene.listBlocks.length;++e)if(this.implementation.scene.listBlocks[e].IsInside(t))return this.implementation.scene.listBlocks[e]},t}(),v=function(){function t(t){this.scene=t}return t.prototype.RenderPre=function(t){this.Render(t)},t.prototype.Translation=function(t){},t}(),C=(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])},r(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),m=function(t){function e(e,o,i){var s=t.call(this,e)||this;return s.width=50,s.height=25,s.col="#ff0000",s.v=new n.h9(o-.5*s.width,i-.5*s.height,0),s.scene.Add(s),s}return C(e,t),e.prototype.Render=function(t){t.fillStyle=this.col,t.beginPath(),t.fillRect(this.v.x,this.v.y,this.width,this.height),t.closePath(),t.fill()},e.prototype.Translation=function(t){this.v.x+=t.x-t.preX,this.v.y+=t.y-t.preY},e.prototype.IsInside=function(t){return!!n.h9.IsInsideOfVecWithHeight(t,this.v,this.width,this.height)},e}(v),y=function(){var t=function(e,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])},t(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),M=function(){function t(t){this.ac=t}return t.prototype.MouseEventController=function(t){this.ac.mouse.x=t.x,this.ac.mouse.y=t.y,t.CLICK_TYPE!==i.LEFT?t.CLICK_TYPE!==i.MIDDLE?t.CLICK_TYPE!==i.DOWN_RIGHT?t.CLICK_TYPE!==i.DOUBLE?t.CLICK_TYPE!==i.MOVE?t.CLICK_TYPE!==i.DRAG?t.CLICK_TYPE!==i.DOWN?t.CLICK_TYPE!==i.WHEEL?t.CLICK_TYPE!==i.UP||this.MouseUpPre(t):this.MouseWheelPre(t):this.MouseDownPre(t):this.MouseDragPre(t):this.MouseMovePre(t):this.MouseDoubleClickPre(t):this.MouseRightClickPre(t):this.MouseMiddleClickPre(t):this.MouseLeftClickPre(t)},t.prototype.MouseDown=function(t){},t.prototype.MouseDownPre=function(t){var e=this.ac.implementation.geometryCommon.Pick(this.ac.mouse);e&&(this.ac.ablePan=!1,this.ac.capture=e),this.MouseDown(t)},t.prototype.MouseLeftClick=function(t){},t.prototype.MouseLeftClickPre=function(t){this.MouseLeftClick(t)},t.prototype.MouseMiddleClick=function(t){},t.prototype.MouseMiddleClickPre=function(t){this.MouseMiddleClick(t)},t.prototype.MouseRightClick=function(t){},t.prototype.MouseRightClickPre=function(t){this.MouseRightClick(t)},t.prototype.MouseUp=function(t){},t.prototype.MouseUpPre=function(t){this.ac.ablePan=!0,this.ac.capture=void 0,this.MouseUp(t)},t.prototype.MouseDoubleClick=function(t){},t.prototype.MouseDoubleClickPre=function(t){this.MouseDoubleClick(t)},t.prototype.MouseMove=function(t){},t.prototype.MouseMovePre=function(t){this.MouseMove(t)},t.prototype.MouseDrag=function(t){},t.prototype.MouseDragPre=function(t){this.ac.capture&&this.ac.capture.Translation(t),this.MouseDrag(t)},t.prototype.MouseWheel=function(t){},t.prototype.MouseWheelPre=function(t){this.MouseWheel(t)},t}(),P=function(t){function e(e){return t.call(this,e)||this}return y(e,t),e}(M),E=function(t){function e(e){return t.call(this,e)||this}return y(e,t),e.prototype.MouseLeftClick=function(t){new m(this.ac.implementation.scene,t.x,t.y)},e}(M),g=function(t){function e(e){return t.call(this,e)||this}return y(e,t),e.prototype.MouseEventController=function(t){this.ac.implementation.scene.drawingGraph.ac.MouseEventController(t)},e}(M);!function(t){t.SELECT="SELECT",t.REMOVE="REMOVE",t.RECT="RECT",t.DRAWING_BLOCK="DRAWING_BLOCK"}(h||(h={}));var L=function(){function t(t){this.mouse=new n.h9(0,0),this.capture=void 0,this._ablePan=!1,this.implementation=t,this.commands={SELECT:new P(this),RECT:new E(this),DRAWING_BLOCK:new g(this)},this.SetActiveCommand(h.DRAWING_BLOCK)}return t.prototype.SetActiveCommand=function(t){this.activeCommand=this.commands[t]},Object.defineProperty(t.prototype,"ablePan",{get:function(){return this._ablePan},set:function(t){this.implementation.implmentations.nBlock.core.canvas.ablePan=t,this._ablePan=t},enumerable:!1,configurable:!0}),t}(),D=function(){function t(t){this.implementation=t,this.divHost=t.implmentations.nBlock.hostDiv;var e=document.createElement("div");e&&(this.div=e,this.divHost.insertBefore(this.div,t.implmentations.nBlock.div),t.implmentations.nBlock.div.style.height="90%",this.Init())}return t.prototype.Init=function(){var t=this,e=document.createElement("button");e.type="button",e.innerText="select",e.onclick=function(){t.implementation.activeCommandController.SetActiveCommand(h.SELECT)},this.div.append(e),(e=document.createElement("button")).type="button",e.innerText="point",e.onclick=function(){t.implementation.activeCommandController.SetActiveCommand(h.RECT)},this.div.append(e)},t}(),I=function(){function t(t,e,o){this.renderer=new w(this),this.n0=t,this.n1=e}return t.prototype.Render=function(t){this.renderer.Render(t)},t.prototype.Translation=function(){},t}(),w=function(){function t(t){this.edge=t}return t.prototype.Render=function(t){var e=.5*Math.abs(this.edge.n1.v.x-this.edge.n0.v.x),o=.5*Math.abs(this.edge.n1.v.y-this.edge.n0.v.y),i=e>o?e:o;t.lineWidth=2,t.beginPath(),t.moveTo(this.edge.n0.v.x,this.edge.n0.v.y),t.bezierCurveTo(this.edge.n0.v.x+i,this.edge.n0.v.y,this.edge.n1.v.x-i,this.edge.n1.v.y,this.edge.n1.v.x,this.edge.n1.v.y),t.stroke()},t}(),k=function(){function t(t,e,o){this.type="",this.edgeIn=[],this.edgeOut=[],this.width=50,this.height=25,this.type=o,this.renderer=new R(this),this.v=new n.h9(t-.5*this.width,e-.5*this.height,0)}return t.prototype.Render=function(t){this.renderer.Render(t)},t.prototype.Translation=function(t){this.v.x+=t.x-t.preX,this.v.y+=t.y-t.preY},t.prototype.IsInside=function(t){return!!n.h9.IsInsideOfVecWithHeight(t,this.v,this.width,this.height)},t}(),R=function(){function t(t){this.fillStyle="#ff0000",this.node=t}return t.prototype.Render=function(t){t.fillStyle=this.fillStyle,t.beginPath(),t.fillRect(this.node.v.x,this.node.v.y,this.node.width,this.node.height),t.closePath(),t.fill()},t}(),T=function(){function t(t){this.nodes=[],this.edges=[],this.drawingGraph=t,this.utility=new _(this)}return t.prototype.AddNode=function(t,e,o){this.nodes.push(new k(t,e,o)),this.nodes.length>1&&this.AddEdge(this.nodes[this.nodes.length-2],this.nodes[this.nodes.length-1],"d")},t.prototype.AddEdge=function(t,e,o){this.edges.push(new I(t,e,o))},t.prototype.Render=function(t){var e=0;for(e=this.nodes.length;e--;)this.nodes[e].Render(t);for(e=this.edges.length;e--;)this.edges[e].Render(t)},t.prototype.Pick=function(t){return this.utility.Pick(t)},t}(),_=function(){function t(t){this.graph=t}return t.prototype.Pick=function(t){for(var e=0;e<this.graph.nodes.length;++e)if(this.graph.nodes[e].IsInside(t))return console.log("working"),this.graph.nodes[e]},t}(),b=function(){function t(t){this.mouse=new n.h9(0,0,0),this.capture=void 0,this.dbGraph=t}return t.prototype.MouseEventController=function(t){this.mouse.x=t.x,this.mouse.y=t.y,t.CLICK_TYPE!==i.LEFT?t.CLICK_TYPE!==i.MIDDLE?t.CLICK_TYPE!==i.DOWN_RIGHT?t.CLICK_TYPE!==i.DOUBLE?t.CLICK_TYPE!==i.MOVE?t.CLICK_TYPE!==i.DRAG?t.CLICK_TYPE!==i.DOWN?t.CLICK_TYPE!==i.WHEEL?t.CLICK_TYPE!==i.UP||this.MouseUpPre(t):this.MouseWheelPre(t):this.MouseDownPre(t):this.MouseDragPre(t):this.MouseMovePre(t):this.MouseDoubleClickPre(t):this.MouseRightClickPre(t):this.MouseMiddleClickPre(t):this.MouseLeftClickPre(t)},t.prototype.MouseDown=function(t){},t.prototype.MouseDownPre=function(t){var e=this.dbGraph.graph.Pick(this.mouse);e&&(this.dbGraph.scene.blockImplementation.activeCommandController.ablePan=!1,this.capture=e),this.MouseDown(t)},t.prototype.MouseLeftClick=function(t){},t.prototype.MouseLeftClickPre=function(t){this.dbGraph.graph.AddNode(t.x,t.y,"type"),this.MouseLeftClick(t)},t.prototype.MouseMiddleClick=function(t){},t.prototype.MouseMiddleClickPre=function(t){this.MouseMiddleClick(t)},t.prototype.MouseRightClick=function(t){},t.prototype.MouseRightClickPre=function(t){this.MouseRightClick(t)},t.prototype.MouseUp=function(t){},t.prototype.MouseUpPre=function(t){this.dbGraph.scene.blockImplementation.activeCommandController.ablePan=!0,this.capture=void 0,this.MouseUp(t)},t.prototype.MouseDoubleClick=function(t){},t.prototype.MouseDoubleClickPre=function(t){this.MouseDoubleClick(t)},t.prototype.MouseMove=function(t){},t.prototype.MouseMovePre=function(t){this.MouseMove(t)},t.prototype.MouseDrag=function(t){},t.prototype.MouseDragPre=function(t){this.capture&&this.capture.Translation(t),this.MouseDrag(t)},t.prototype.MouseWheel=function(t){},t.prototype.MouseWheelPre=function(t){this.MouseWheel(t)},t}(),x=function(){function t(t){this.scene=t,this.ac=new b(this),this.graph=new T(this)}return t.prototype.Render=function(t){this.graph.Render(t)},t}(),W=function(){function t(t){this.listBlocks=[],this.blockImplementation=t,this.InitDrawingGraph()}return t.prototype.InitDrawingGraph=function(){this.drawingGraph=new x(this)},t.prototype.Add=function(t){this.listBlocks.push(t)},t}(),Y=function(){function t(t){this.implmentations=t,this.Init()}return t.prototype.Init=function(){this.activeCommandController=new L(this),this.geometryCommon=new d(this),this.scene=new W(this),this.renderer=new f(this),this.view=new D(this)},t.prototype.MouseEventController=function(t){this.activeCommandController.activeCommand.MouseEventController(t)},t.prototype.Render=function(t){this.renderer.OnRender(t)},t}(),K=function(){function t(t){this.nBlock=t,this.implementation=new Y(this)}return t.prototype.MouseEventController=function(t){this.implementation.MouseEventController(t)},t.prototype.Render=function(t){this.implementation.Render(t)},t}(),O=function(){function t(t){void 0===t&&(t="SandBox"),this.id=t,this.Init(),this.InitPost(),window.app=this}return t.Init=function(e){void 0===e&&(e="SandBox"),new t(e)},t.prototype.Init=function(){var t=document.getElementById(this.id);if(t){this.hostDiv=t;var e=document.createElement("div");e&&(this.div=e,this.div.style.width="100%",this.div.style.height="100%",this.div.style.background="#dddddd",this.hostDiv.append(this.div)),this.core=new a(this,e),this.implmentations=new K(this)}},t.prototype.InitPost=function(){var t=this;this.core.InitPost(),this.core.canvas.Render=function(e){return t.implmentations.Render(e)}},t}(),B=function(){function t(t,e){void 0===t&&(t="SandBox"),void 0===e&&(e=1),this.version=1,this.id=t,this.version=e,this.Init()}return t.Init=function(e){void 0===e&&(e="SandBox"),new t(e,1)},t.prototype.Init=function(){switch(this.version){case 1:case 2:this.appV1=new O(this.id)}},t}()}}]);