"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8514],{8514:(t,e,o)=>{o.r(e),o.d(e,{Demo530ImageDrawing:()=>I});var i,r,n={normal:{filter:{sepia:0,contrast:1,brightness:1,saturate:1,hueRotate:0}},filter1977:{filter:{sepia:.5,contrast:1,brightness:1,saturate:1.4,hueRotate:-30}},aden:{filter:{sepia:.2,contrast:1,brightness:1.5,saturate:1.4,hueRotate:0},tint:{background0:"rgba(125, 105, 24, .1)",blendMode:"multiply"}},amaro:{filter:{sepia:.35,contrast:1.1,brightness:1.2,saturate:1.3,hueRotate:0},tint:{background0:"rgba(125, 105, 24, .2)",blendMode:"overlay"}},ashby:{filter:{sepia:.5,contrast:1.2,brightness:1,saturate:1.8,hueRotate:0},tint:{background0:"rgba(125, 105, 24, .35)",blendMode:"lighten"}},brannan:{filter:{sepia:.4,contrast:1.25,brightness:1.1,saturate:.9,hueRotate:-2}},brooklyn:{filter:{sepia:.25,contrast:1.25,brightness:1.25,saturate:1,hueRotate:5},tint:{background0:"rgba(127, 187, 227, .2)",blendMode:"overlay"}},charmes:{filter:{sepia:.25,contrast:1.25,brightness:1.25,saturate:1.35,hueRotate:-5},tint:{background0:"rgba(125, 105, 24, .25)",blendMode:"darken"}},clarendon:{filter:{sepia:.15,contrast:1.25,brightness:1.25,saturate:1,hueRotate:5},tint:{background0:"rgba(127, 187, 227, .4)",blendMode:"overlay"}},crema:{filter:{sepia:.5,contrast:1.25,brightness:1.15,saturate:.9,hueRotate:-2},tint:{background0:"rgba(125, 105, 24, .2)",blendMode:"multiply"}},dogpatch:{filter:{sepia:.35,contrast:1.1,brightness:1.5,saturate:1,hueRotate:0}},earlybird:{filter:{sepia:.25,contrast:1.25,brightness:1.15,saturate:.9,hueRotate:-5},tint:{background0:"rgba(0, 0, 0, 0)",background1:"rgba(125, 105, 24, .2)",blendMode:"multiply"}},gingham:{filter:{sepia:0,contrast:1.1,brightness:1.1,saturate:1,hueRotate:0},tint:{background0:"rgba(230, 230, 230, 1)",blendMode:"soft-light"}},ginza:{filter:{sepia:.25,contrast:1.15,brightness:1.2,saturate:1.35,hueRotate:-5},tint:{background0:"rgba(125, 105, 24, .15)",blendMode:"darken"}},hefe:{filter:{sepia:.4,contrast:1.5,brightness:1.2,saturate:1.4,hueRotate:-10},tint:{background0:"rgba(0, 0, 0, 0)",background1:"rgba(0, 0, 0, .25)",blendMode:"soft-light"}},helena:{filter:{sepia:.5,contrast:1.05,brightness:1.05,saturate:1.35,hueRotate:0},tint:{background0:"rgba(158, 175, 30, .25)",blendMode:"overlay"}},hudson:{filter:{sepia:.25,contrast:1.2,brightness:1.2,saturate:1.05,hueRotate:-15},tint:{background0:"rgba(0, 0, 0, 0)",background1:"rgba(25, 62, 167, .25)",blendMode:"multiply"}},inkwell:{filter:{sepia:0,contrast:.85,brightness:1.25,saturate:0,hueRotate:0},tint:{background0:"rgba(0, 0, 0, 0)",background1:"rgba(25, 62, 167, .25)",blendMode:"multiply"}},juno:{filter:{sepia:.35,contrast:1.15,brightness:1.15,saturate:1.8,hueRotate:0},tint:{background0:"rgba(127, 187, 227, .2)",blendMode:"overlay"}},kelvin:{filter:{sepia:.15,contrast:1.5,brightness:1.1,saturate:1,hueRotate:-10},tint:{background0:"rgba(128, 78, 15, .25)",background1:"rgba(128, 78, 15, .5)",blendMode:"overlay"}},lark:{filter:{sepia:.25,contrast:1.2,brightness:1.3,saturate:1.25,hueRotate:0}},lofi:{filter:{sepia:0,contrast:1.5,brightness:1,saturate:1.1,hueRotate:0}},maven:{filter:{sepia:.35,contrast:1.05,brightness:1.05,saturate:1.75,hueRotate:0},tint:{background0:"rgba(158, 175, 30, .25)",blendMode:"darken"}},mayfair:{filter:{sepia:0,contrast:1.1,brightness:1.15,saturate:1.1,hueRotate:0},tint:{background0:"rgba(0, 0, 0, 0)",background1:"rgba(175, 105, 24, .4)",blendMode:"multiply"}},moon:{filter:{sepia:.35,contrast:1.4,brightness:.95,saturate:0,hueRotate:0}},nashville:{filter:{sepia:.25,contrast:1.5,brightness:.9,saturate:1,hueRotate:-15},tint:{background0:"rgba(128, 78, 15, .5)",background1:"rgba(128, 78, 15, .65)",blendMode:"screen"}},perpetua:{filter:{sepia:0,contrast:1.1,brightness:1.25,saturate:1.1,hueRotate:0},tint:{background0:"rgba(0, 91, 154, .25)",background1:"rgba(230, 193, 61, .25)",blendMode:"multiply"}},poprocket:{filter:{sepia:.15,contrast:1,brightness:1.2,saturate:1,hueRotate:0},tint:{background0:"rgba(206, 39, 70, .75)",background1:"rgba(0, 0, 0, 0.8)",blendMode:"screen"}},reyes:{filter:{sepia:.75,contrast:.75,brightness:1.12,saturate:1.4,hueRotate:0}},rise:{filter:{sepia:.25,contrast:1.25,brightness:1.2,saturate:.9,hueRotate:0},tint:{background0:"rgba(0, 0, 0, 0)",background1:"rgba(230, 193, 61, .25)",blendMode:"lighten"}},sierra:{filter:{sepia:.25,contrast:1.5,brightness:.9,saturate:1,hueRotate:-15},tint:{background0:"rgba(128, 78, 15, .5)",background1:"rgba(0, 0, 0, .65)",blendMode:"screen"}},skyline:{filter:{sepia:.15,contrast:1.25,brightness:1.25,saturate:1.2,hueRotate:0}},slumber:{filter:{sepia:.35,contrast:1.25,brightness:1,saturate:1.25,hueRotate:0},tint:{background0:"rgba(125, 105, 24, .2)",blendMode:"darken"}},stinson:{filter:{sepia:.35,contrast:1.25,brightness:1.1,saturate:1.25,hueRotate:0},tint:{background0:"rgba(125, 105, 24, .45)",blendMode:"lighten"}},sutro:{filter:{sepia:.4,contrast:1.2,brightness:.9,saturate:1.4,hueRotate:-10},tint:{background0:"rgba(0, 0, 0, 0.1)",background1:"rgba(0, 0, 0, .5)",blendMode:"darken"}},toaster:{filter:{sepia:.25,contrast:1.5,brightness:.95,saturate:1,hueRotate:-15},tint:{background0:"rgba(128, 78, 15, 1.0)",background1:"rgba(0, 0, 0, .25)",blendMode:"screen"}},valencia:{filter:{sepia:.25,contrast:1.1,brightness:1.1,saturate:1,hueRotate:0},tint:{background0:"rgba(230, 193, 61, .1)",blendMode:"lighten"}},vesper:{filter:{sepia:.35,contrast:1.15,brightness:1.2,saturate:1.3,hueRotate:0},tint:{background0:"rgba(125, 105, 24, .25)",blendMode:"overlay"}},walden:{filter:{sepia:.35,contrast:.8,brightness:1.25,saturate:1.4,hueRotate:0},tint:{background0:"rgba(229, 240, 128, .5)",blendMode:"darken"}},willow:{filter:{sepia:.2,contrast:.85,brightness:1.2,saturate:.05,hueRotate:0}},xpro2:{filter:{sepia:.45,contrast:1.12,brightness:1.75,saturate:1.3,hueRotate:-5},tint:{background0:"rgba(0, 91, 154, .35)",background1:"rgba(0, 0, 0, .65)",blendMode:"multiply"}}},s=function(t,e,o,i,r){if(void 0===e&&(e="normal"),void 0===o&&(o=!0),void 0===i&&(i=""),void 0===r&&(r=""),t.globalCompositeOperation=e,t.setTransform(t.canvas.width,0,0,t.canvas.height,0,0),o){var n=t.createRadialGradient(.5,.5,.1,.5,.5,.5);n.addColorStop(0,i),n.addColorStop(1,r),t.fillStyle=n}else t.fillStyle=i;return t.fillRect(0,0,t.canvas.width,t.canvas.height),t},a=function(){function t(t,e){this.isActive=!1,this.isViewChanging=!1,this.loopNum=0,this.needRenderloop=!0,this.ablePan=!0,this.mousePre=[0,0],this.loopNeeded=!1,this.isFiltered=!1,this.core=t,this.div=e,this.loopNeeded=!1,this.init(),this.loopInit()}return t.prototype.init=function(){var t=document.createElement("canvas"),e=document.createElement("canvas"),o=document.createElement("canvas");if(t&&e){this.canvas=t,this.canvas.width=this.div.clientWidth,this.canvas.height=this.div.clientHeight,this.div.append(this.canvas),this.canvasOut=e,this.canvasOut.style.border="5px",this.ctxOut=this.canvasOut.getContext("2d"),this.core.app.divHost.append(this.canvasOut),this.canvasFilter=o,this.ctxFilter=this.canvasFilter.getContext("2d"),this.canvasFilter.width=this.div.clientWidth,this.canvasFilter.height=this.div.clientHeight;var i=this.canvas.getContext("2d");i&&(this.ctx=i,this.isActive=!0,this.initEvent())}},t.prototype.initEvent=function(){var t=this;this.canvas.addEventListener("keydown",(function(t){})),this.canvas.addEventListener("keyup",(function(t){})),this.canvas.addEventListener("mousedown",(function(e){t.core.controller.mouseInteraction.mouseDown(e)})),this.canvas.addEventListener("mouseup",(function(e){t.core.controller.mouseInteraction.mouseUp(e)}),!1),this.canvas.addEventListener("mousemove",(function(e){t.core.controller.mouseInteraction.mouseMove(e)}),!1),this.canvas.addEventListener("wheel",(function(e){return t.core.controller.mouseInteraction.mouseWheel(e,e.deltaY)}),!1),this.canvas.addEventListener("mouseout",(function(e){t.core.controller.mouseInteraction.mouseOut(e)}),!1),this.canvas.addEventListener("touchstart",(function(e){return t.core.controller.touchInteraction.touchstart(e)}),!1),this.canvas.addEventListener("touchmove",(function(e){return t.core.controller.touchInteraction.touchmove(e)}),!1),this.canvas.addEventListener("touchcancel",(function(e){return t.core.controller.touchInteraction.touchcancel(e)}),!1),this.canvas.addEventListener("touchend",(function(e){return t.core.controller.touchInteraction.touchend(e)}),!1)},t.prototype.capture=function(){var t=new Image;return t.crossOrigin="anonymous",t.src=this.canvasOut.toDataURL(),t},t.prototype.loopInit=function(){this.loop()},t.prototype.resize=function(){this.canvas.width=this.div.clientWidth,this.canvas.height=this.div.clientHeight},t.prototype.loop=function(){var t=this;if(requestAnimationFrame((function(){t.loop()})),this.loopNum++<130){var e=performance.now();this.renderPre(this.ctx);var o=performance.now();this.log="level: , total frames: "+this.loopNum+++" (FPS: ), a loop took: "+(o-e).toFixed(2)+" ms to execute."}},t.prototype.clear=function(t){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)},t.prototype.renderForce=function(){this.loopNum=0},t.prototype.renderPre=function(t){this.isActive&&(this.clear(this.ctx),this.isFiltered&&this.ctx.drawImage(this.canvasFilter,0,0),this.render(t))},t.prototype.render=function(t){},t.prototype.updateFilter=function(t){this.ctxFilter.canvas.width=this.core.imageWrapper.img.width,this.ctxFilter.canvas.height=this.core.imageWrapper.img.height;var e=function(t,e,o){var i=[];for(var r in n)i.push(r);var a=1/i.length,c=Math.floor(o/a),h=n[i[c]];return console.log(i[c]),function(t,e,o,i,r,n,s){void 0===o&&(o=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=1),void 0===s&&(s=0),t.filter="sepia("+o+") contrast("+i+") brightness("+r+") saturate("+n+") hue-rotate("+s+"deg)",t.drawImage(e,0,0)}(t,e,h.filter.sepia,h.filter.contrast,h.filter.brightness,h.filter.saturate,h.filter.hueRotate),h.tint&&(h.tint.background1?(s(t,h.tint.blendMode,!0,h.tint.background0,h.tint.background1),console.log(h.tint)):s(t,h.tint.blendMode,!1,h.tint.background0)),i[c]}(this.ctxFilter,this.core.imageWrapper.img,t);this.ctx.drawImage(this.canvasFilter,0,0),this.core.app.ui.divTextPresest.textContent="Filter: "+e},t}(),c=function(){function t(t,e,o){void 0===e&&(e=3),void 0===o&&(o=1),this.ncols=t,o<1&&(o=1),this.k=e,this.minDiff=o,this.init()}return t.prototype.init=function(){console.log("a");var t=l(10),e=[],o=[];for(console.log("b");e.length<this.k;){for(var i=Math.floor(t()*this.ncols.length),r=!1,n=0;n<o.length;n++)if(i===o[n]){r=!0;break}if(!r){o.push(i);var s=new h(this.ncols[i]);s.push(this.ncols[i]),e.push(s)}}console.log("c");for(var a=0;;){if(a++>1e4){console.log("braek");break}var c=[];for(n=0;n<this.k;n++)c.push([]);for(var u=0;u<this.ncols.length;u++){var d=this.ncols[u],p=Number.MAX_VALUE;for(i=0,n=0;n<this.k;n++){var g=this.euclidean(d,e[n].key);g<p&&(p=g,i=n)}c[i].push(d)}var v=0;for(n=0;n<this.k;n++){var f=e[n].key,m=this.calculateCenter(c[n],3),b=new h(m);b.values=c[n];var y=this.euclidean(f,m);console.log(y),isNaN(y)||(e[n]=b,v=v>y?v:y)}if(console.log("diff",v),v<this.minDiff)break}console.log("done!"),this.clusters=e},t.prototype.euclidean=function(t,e){var o=Math.pow(t.r-e.r,2)+Math.pow(t.g-e.g,2)+Math.pow(t.b-e.b,2);return Math.sqrt(o)},t.prototype.calculateCenter=function(t,e){for(var o=new u(0,0,0),i=0;i<t.length;i++)o.r+=t[i].r,o.g+=t[i].g,o.b+=t[i].b;return o.r/=t.length,o.g/=t.length,o.b/=t.length,o},t}(),h=function(){function t(t){this.values=[],this.key=t}return t.prototype.push=function(t){this.values.push(t)},t.prototype.getKey=function(){return[this.key.r,this.key.g,this.key.b]},t}(),u=function(t,e,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=0),this.r=0,this.g=0,this.b=0,this.r=t,this.g=e,this.b=o},l=function(t){return void 0===t&&(t=performance.now()),function(){return(t=(9301*t+49297)%233280)/233280}};!function(t){t.GetImage="GetImage"}(i||(i={})),function(t){t.Canvas="Canvas",t.WebGL2="WebGL2",t.WebGPU="WebGPU",t.WebAssembly="WebAssembly"}(r||(r={}));var d,p=function(t,e,o){var i,r,n;if(0===e)i=r=n=o;else{var s=function(t,e,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?t+6*(e-t)*o:o<.5?e:o<2/3?t+(e-t)*(2/3-o)*6:t},a=o<.5?o*(1+e):o+e-o*e,c=2*o-a;i=s(c,a,t+1/3),r=s(c,a,t),n=s(c,a,t-1/3)}return[Math.max(0,Math.min(Math.round(255*i),255)),Math.max(0,Math.min(Math.round(255*r),255)),Math.max(0,Math.min(Math.round(255*n),255))]},g=function(){function t(e,o,i,r){void 0===e&&(e=0),void 0===o&&(o=0),void 0===i&&(i=10),void 0===r&&(r=10),this.r=5,this._isInside=!1,this.x=e,this.y=o,this.width=i,this.height=r,t.list.push(this)}return t.prototype.mouseDown=function(t,e){console.log("down",t,e)},t.prototype.mouseUp=function(t,e){console.log("up",t,e)},t.prototype.mouseDrag=function(t,e){console.log("drag",t,e)},t.prototype.isInside=function(){},t.prototype.render=function(t){this._isInside&&(t.beginPath(),t.arc(this.x,this.y,this.r,0,Math.PI),t.closePath(),t.stroke()),t.lineWidth=2,t.strokeStyle="#999",t.beginPath(),t.rect(this.x,this.y,this.width,this.height),t.closePath(),t.stroke()},t.list=[],t}(),v=function(){function t(t){this.t=0,this.isCapture=!1,this.core=t}return t.prototype.render=function(t){this.core.img&&(t.save(),t.translate(.5*this.core.img.width,.5*this.core.img.height),t.rotate(this.core.controller.rotationRadian),t.scale(this.core.controller.zoomLevel,this.core.controller.zoomLevel),t.drawImage(this.core.img,.5*-this.core.img.width,.5*-this.core.img.height),g.list.forEach((function(e){e.render(t)})),t.restore()),this.captureImage();var e=1-this.t;e<0&&(e=0),t.beginPath();var o=this.core.controller.touchInteraction.touchPre[0],i=this.core.controller.touchInteraction.touchPre[1];t.arc(o,i,10*e,0,6.28),t.closePath(),t.fillStyle="rgba(255, 255, 255, "+e+")",t.fill(),t.restore(),this.t+=.025},t.prototype.captureImage=function(){this.core.controller.isDrag&&this.updateCanvasCapture(),this.isCapture},t.prototype.updateCanvasCapture=function(){},t}(),f=function(t,e){this.core=t,this.img=e},m=function(){function t(t){this.down=!1,this.touchPre=[0,0],this.zoom=1,this.controller=t}return t.prototype.touchstart=function(t){this.controller.core.renderer.t=0;var e=this.controller.core.canvs.canvas.getBoundingClientRect(),o=t.targetTouches[0].pageX-e.left,i=t.targetTouches[0].pageY-e.top;this.touchPre[0]=o,this.touchPre[1]=i,this.controller.touchStartRotation=!0,this.controller.touchStartScale=!0,this.controller.pointDown(o,i),t.preventDefault()},t.prototype.touchmove=function(t){if(t.targetTouches.length>1)return this.controller.rotationByTouch(t),void this.controller.scaleByTouch(t);var e=this.controller.core.canvs.canvas.getBoundingClientRect(),o=t.targetTouches[0].pageX-e.left,i=t.targetTouches[0].pageY-e.top;this.touchPre[0]=o,this.touchPre[1]=i,this.controller.pointDrag(o,i),t.preventDefault()},t.prototype.touchcancel=function(t){this.controller.touchStartRotation=!1,this.controller.touchStartScale=!1,t.preventDefault()},t.prototype.touchend=function(t){this.controller.pointUp(-1,-1),t.preventDefault()},t}(),b=function(){function t(t){this.controller=t}return t.prototype.mouseDown=function(t){this.controller.pointDown(t.offsetX,t.offsetY)},t.prototype.mouseUp=function(t){this.controller.isDrag=!1,this.controller.pointUp(t.offsetX,t.offsetY)},t.prototype.mouseWheel=function(t,e){this.controller.zoom(t.deltaY)},t.prototype.mouseMove=function(t){this.controller.isDown?this.controller.pointDrag(t.offsetX,t.offsetY):this.controller.pointMove(t.offsetX,t.offsetY)},t.prototype.mouseOut=function(t){this.controller.pointOut(t.offsetX,t.offsetY)},t}();!function(t){t.Default="default",t.Auto="audo",t.Crosshair="CROSSHAIR",t.Move="move",t.Pointer="pointer",t.Text="text",t.Wait="wait",t.Help="help",t.NWResize="nw-resize",t.NEResize="ne-resize",t.NSResize="ns-resize",t.EResize="e-resize"}(d||(d={}));var y=function(){function t(t){this.div=t}return t.prototype.default=function(){this.div?this.div.style.cursor!==d.Default&&(this.div.style.cursor=d.Default):document.body.style.cursor!==d.Default&&(document.body.style.cursor=d.Default)},t.prototype.auto=function(){this.div?this.div.style.cursor!==d.Auto&&(this.div.style.cursor=d.Auto):document.body.style.cursor!==d.Auto&&(document.body.style.cursor=d.Auto)},t.prototype.creating=function(){this.div?this.div.style.cursor!==d.Crosshair&&(this.div.style.cursor=d.Crosshair):document.body.style.cursor!==d.Crosshair&&(document.body.style.cursor=d.Crosshair)},t.prototype.dragging=function(){this.div?this.div.style.cursor!==d.Move&&(this.div.style.cursor=d.Move):document.body.style.cursor!==d.Move&&(document.body.style.cursor=d.Move)},t.prototype.hovering=function(){this.div?this.div.style.cursor!==d.Pointer&&(this.div.style.cursor=d.Pointer):document.body.style.cursor!==d.Pointer&&(document.body.style.cursor=d.Pointer)},t.prototype.texting=function(){this.div?this.div.style.cursor!==d.Text&&(this.div.style.cursor=d.Text):document.body.style.cursor!==d.Text&&(document.body.style.cursor=d.Text)},t.prototype.set_e_resize=function(){this.div?this.div.style.cursor!==d.EResize&&(this.div.style.cursor=d.EResize):document.body.style.cursor!==d.EResize&&(document.body.style.cursor=d.EResize)},t.prototype.set_ne_resize=function(){this.div?this.div.style.cursor!==d.NEResize&&(this.div.style.cursor=d.NEResize):document.body.style.cursor!==d.NEResize&&(document.body.style.cursor=d.NEResize)},t.prototype.set_ns_resize=function(){this.div?this.div.style.cursor!==d.NSResize&&(this.div.style.cursor=d.NSResize):document.body.style.cursor!==d.NSResize&&(document.body.style.cursor=d.NSResize)},t.prototype.set_nw_resize=function(){this.div?this.div.style.cursor!==d.NWResize&&(this.div.style.cursor=d.NWResize):document.body.style.cursor!==d.NWResize&&(document.body.style.cursor=d.NWResize)},t}(),k=function(){function t(t){var e=this;this.isDown=!1,this.isDrag=!1,this.mousePre=[0,0],this.zoomLevel=1,this.rotationRadian=0,this.scalePre=1,this.anglePre=0,this.touchStartRotation=!1,this.touchStartScale=!1,this.mouseDragRect=function(t,o){e.mousePre[0]=t,e.mousePre[1]=o},this.mouseDragPan=function(t,o){e.pan(t,o)},this.core=t,this.activeCursor=new y,this.touchInteraction=new m(this),this.mouseInteraction=new b(this)}return t.prototype.import=function(t){this.reset()},t.prototype.reset=function(){},t.prototype.rotate=function(t){this.rotationRadian=t,this.postUpdate()},t.prototype.pointDown=function(t,e){this.isDown=!0,this.mousePre[0]=t,this.mousePre[1]=e,g.list.forEach((function(o){o.mouseDown(t,e)})),this.postUpdate()},t.prototype.pointUp=function(t,e){this.isDown=!1,g.list.forEach((function(o){o.mouseUp(t,e)})),this.postUpdate()},t.prototype.pointOut=function(t,e){this.isDown=!1,this.isDrag=!1,this.postUpdate()},t.prototype.pointMove=function(t,e){this.mousePre[0]=t,this.mousePre[1]=e,this.postUpdate()},t.prototype.pointDrag=function(t,e){this.isDrag=!0,g.list.forEach((function(o){o.mouseDrag(t,e)})),this.postUpdate()},t.prototype.zoom=function(t){t<0?this.zoomLevel+=.19*this.zoomLevel:this.zoomLevel-=.19*this.zoomLevel,this.postUpdate()},t.prototype.pan=function(t,e){},t.prototype.postUpdate=function(){this.core.canvs.renderForce()},t.prototype.downloadImage=function(){this.core.canvs.canvasOut;var t=document.createElement("a");t.href=this.core.canvs.canvasOut.toDataURL(),t.download="image.png",document.body.appendChild(t),t.click(),document.body.removeChild(t)},t.prototype.rotationByTouch=function(t){var e,o;this.core.canvs.renderForce(),t.targetTouches[0].clientY<t.targetTouches[1].clientY?(e=t.targetTouches[0],o=t.targetTouches[1]):(e=t.targetTouches[1],o=t.targetTouches[0]);var i=Math.atan2(o.clientX-e.clientX,o.clientY-e.clientY),r=this.anglePre-i;if(this.touchStartRotation)return this.anglePre=this.rotationRadian,this.touchStartRotation=!1,void(this.anglePre=i);this.rotationRadian+=r,this.anglePre=i},t.prototype.scaleByTouch=function(t){var e,o;this.core.canvs.renderForce(),t.targetTouches[0].clientY<t.targetTouches[1].clientY?(e=t.targetTouches[0],o=t.targetTouches[1]):(e=t.targetTouches[1],o=t.targetTouches[0]);var i=Math.sqrt((o.clientX-e.clientX)*(o.clientX-e.clientX)+(o.clientY-e.clientY)*(o.clientY-e.clientY));if(this.scalePre>i?this.zoomLevel>.4&&(this.zoomLevel-=.015):this.zoomLevel<2&&(this.zoomLevel+=.015),this.touchStartScale)return this.scalePre=this.zoomLevel,this.touchStartScale=!1,void(this.scalePre=i);this.scalePre=i},t}(),x=function(){function t(t){this.app=t,this.initApp(),this.initCanvas(),this.importImage("https://raw.githubusercontent.com/NamjuLee/data/master/img/bg/zoom-James-River-Kayaking.jpg")}return t.prototype.initApp=function(){this.renderer=new v(this),this.controller=new k(this)},t.prototype.initCanvas=function(){var t=this,e=document.createElement("div");e.id="ExpressImageDivCanvas",e.style.overflow="hidden",e.style.textAlign="center",this.div=e,this.app.div.append(this.div),this.canvs=new a(this,e),this.canvs.render=function(e){t.renderer.render(e)}},t.prototype.importImage=function(t){var e=this,o=new Image;o.crossOrigin="anonymous",o.src=t,o.style.pointerEvents="none",this.renderer.isCapture=!1,o.onload=function(){e.imageWrapper=new f(e,o),e.canvs.canvasOut.width=o.width,e.canvs.canvasOut.height=o.height,e.canvs.canvas.width=o.width,e.canvs.canvas.height=o.height,e.div.style.height=o.height+"px",e.img=o,console.log(o);var t=function(t,e){void 0===e&&(e=1);var o=[];console.log("1"),console.log("2");var i=document.createElement("canvas").getContext("2d");i.drawImage(t,0,0,100,100),console.log("3");for(var r=i.getImageData(0,0,100,100).data,n=0,s=r.length;n<s;n+=4){var a=r[n],h=r[n+1],l=r[n+2];o.push(new u(a,h,l))}console.log("4");var d=new c(o,e,1);console.log("5");var p=[];for(n=0;n<d.clusters.length;n++)p.push(d.clusters[n].getKey());return p}(o),i=[t[0][0],t[0][1],t[0][2]],r=function(t,e,o){t/=255,e/=255,o/=255;var i=Math.max(t,e,o),r=Math.min(t,e,o),n=(i+r)/2,s=(i+r)/2,a=(i+r)/2;if(i===r)n=s=0;else{var c=i-r;switch(s=a>.5?c/(2-i-r):c/(i+r),i){case t:n=(e-o)/c+(e<o?6:0);break;case e:n=(o-t)/c+2;break;case o:n=(t-e)/c+4}n/=6}return[n,s,a]}(i[0],i[1],i[2]),n=function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<o;e++)for(var n=arguments[e],s=0,a=n.length;s<a;s++,r++)i[r]=n[s];return i}(r);r[0]+=0,r[1]+=-.05,r[1]<0&&(r[1]=0),r[2]+=0;var s=p(r[0],r[1],r[2]);console.log("col0",s),e.app.div.style.backgroundColor="rgb("+s[0]+","+s[1]+","+s[2]+")",e.app.ui.updateStyle(s[0],s[1],s[2]),e.app.divHost.style.backgroundColor="rgb("+s[0]+","+s[1]+","+s[2]+")",n[0]+=0,n[1]+=0,n[1]<0&&(n[1]=0),n[2]+=-.02;var a=p(n[0],n[1],n[2]);console.log("col1",a),e.renderer.isCapture=!0,e.canvs.renderForce()}},t}(),w=function(){function t(t){this.expreeImageTool=t;var e=document.createElement("p");e.textContent="Expree Image",e.style.fontSize="12px;",e.style.color="#afafaf",e.style.position="absolute",e.style.top="0px",e.style.left="20px",this.expreeImageTool.divHost.append(e);var o=document.createElement("div");this.divUI=o,this.divUI.style.width="100%",this.divUI.style.height="100px",this.divUI.style.backgroundColor="rgba(0,0,0,0)",this.expreeImageTool.divHost.append(this.divUI)}return t.prototype.updateStyle=function(t,e,o){this.divSizeFrameBG.style.backgroundColor="rgb("+t+","+o+","+e+")"},t.prototype.initPost=function(){var t=this;this.divSizeFrameBG=document.createElement("div"),this.divSizeFrameBG.style.textAlign="center",this.divSizeFrameBG.style.backgroundColor="#afafaf",this.divSizeFrameBG.style.padding="10px",this.divSizeFrameBG.textContent="Size ",this.divWidth=document.createElement("input"),this.divWidth.style.width="50px",this.divWidth.setAttribute("type","text"),this.divWidth.setAttribute("min","100"),this.divSizeFrameBG.append(this.divWidth),this.divWidth.oninput=function(){},this.divHeight=document.createElement("input"),this.divHeight.style.width="50px",this.divHeight.setAttribute("type","text"),this.divHeight.setAttribute("min","100"),this.divSizeFrameBG.append(this.divHeight),this.divHeight.oninput=function(){},this.divUI.append(this.divSizeFrameBG);var e=document.createElement("button");e.textContent="Reset",this.divUI.append(e),e.onclick=function(){t.expreeImageTool.core.controller.reset()},(e=document.createElement("button")).textContent="Rect",this.divUI.append(e),e.onclick=function(){var e=t.expreeImageTool.core.img.width-100,o=t.expreeImageTool.core.img.height-100;new g(.5*-e,.5*-o,e,o)},(e=document.createElement("button")).textContent="Download",this.divUI.append(e),e.onclick=function(){t.expreeImageTool.core.controller.downloadImage()},(e=document.createElement("button")).textContent="Capture",this.divUI.append(e),e.onclick=function(){var e=t.expreeImageTool.core.canvs.capture();t.divUI.append(e)};var o=document.createElement("input");o.style.width="500px",o.type="range",o.min="0",o.max="0.99",o.step="0.01",o.value="0",o.oninput=function(){t.expreeImageTool.core.canvs.updateFilter(+o.value)},this.divUI.append(o),this.divTextPresest=document.createElement("div"),this.divTextPresest.textContent="Filter: normal",this.divTextPresest.style.padding="10px",this.divUI.append(this.divTextPresest);var i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("value","https://raw.githubusercontent.com/NamjuLee/data/master/img/building%20footprint.png"),this.divUI.append(i),i.oninput=function(){console.log(i),t.expreeImageTool.core.controller.reset(),t.expreeImageTool.core.importImage(i.textContent)},i.addEventListener("keyup",(function(e){13===e.keyCode&&(e.preventDefault(),t.expreeImageTool.core.controller.reset(),t.expreeImageTool.core.importImage(i.value))}));var r=document.createElement("div");r.textContent="Offset: ",r.style.padding="10px";var n=document.createElement("input");n.style.width="30px",n.setAttribute("type","text"),n.setAttribute("min","-50"),n.setAttribute("max","50"),n.setAttribute("value","10"),r.append(n),this.divUI.append(r),n.addEventListener("keyup",(function(t){13===t.keyCode&&(t.preventDefault(),console.log("divInput.value",n.value))})),(e=document.createElement("button")).textContent="Rect",this.divUI.append(e),e.onclick=function(){var e=t.expreeImageTool.core.canvs.capture();t.divUI.append(e)}},t}(),R=function(){function t(t){this.param=t;var e=document.getElementById(this.param.id),o=document.createElement("div");e&&o&&(this.div=o,this.div.id="ExpressImage",this.div.style.padding="50px",this.divHost=e,this.divHost.append(this.div),void 0===this.param.ui&&(this.param.ui=!0),this.param.ui&&(this.ui=new w(this),this.ui.initPost()),this.core=new x(this))}return t.prototype.Dummy=function(){},t}(),I=function(){function t(t){this.expreeImageTool=new R(t)}return t.Init=function(e){new t({id:e,colorCover:"#ff0000"}).Dummy()},t.prototype.Dummy=function(){},t}()}}]);